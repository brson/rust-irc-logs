[00:00:13] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[00:00:29] <aatch> Especially since there are 19 approved PRs in the queue.
[00:00:46] <cmr> aatch: yeah but they take 3 hours to go through
[00:00:51] <strcat> 17 of which are probably going to break my vector pull ;p
[00:01:34] <cmr> rusti: static foo: uint = 10u; let x = [0, ..foo]; x
[00:01:35] -rusti- [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[00:02:57] *** Quits: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP) (Ping timeout)
[00:03:05] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[00:03:06] <graydon> probably not fully 3h.
[00:04:13] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Quit: ChatZilla 0.9.90 [Firefox 22.0/20130617145905])
[00:04:21] <graydon> (most interesting to me: the non-opt is slower than valgrind. that's amazing.)
[00:04:46] *** Joins: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP)
[00:05:36] *** Joins: andor (andor@moz-B1384951.neferty.in)
[00:05:52] *** Quits: Tad (Tom@moz-2036EE54.kimsufi.com) (Ping timeout)
[00:06:01] *** Quits: steven_is_false (user@moz-144077DE.bchsia.telus.net) (Ping timeout)
[00:06:05] *** Joins: Tad (Tom@moz-2036EE54.kimsufi.com)
[00:06:06] <aatch> graydon, yeah. Which is why I don't actually bother with non-opt builds locally, the amount of time saved from not optimizing is lost from how much slower the code in later stages is
[00:06:25] <bblum> best i can do with this is read bytes off the heap
[00:06:29] <bblum> can't even seem to get the stack
[00:06:47] <bblum> rusti: use std::task; use std::io; fn f() -> @io::Reader { let mut y = None; let x = ~[0xcdu8, ..64]; do io::with_bytes_reader(x) |r| { y = Some(r); }; y.unwrap() } let y = f(); do task::spawn {}; let mut z = [0, ..64]; y.read(z, 64); z
[00:06:49] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/jZLF
[00:07:01] <bblum> oops too long
[00:07:10] <bblum> rusti: use std::task; use std::io; fn f() -> @io::Reader { let mut y = None; let x = ~[0xcdu8, ..64]; do io::with_bytes_reader(x) |r| { y = Some(r); }; y.unwrap() } let y = f(); do task::spawn {}; let mut z = [0, ..32]; y.read(z, 32); z
[00:07:11] -rusti- [1, 0, 0, 0, 0, 0, 0, 0, 128, 207, 141, 113, 98, 127, 0, 0, 64, 27, 32, 104, 98, 127, 0, 0, 0, 9, 32, 104, 98, 127, 0, 0]
[00:07:29] <graydon> aatch: indeed
[00:07:53] <cmr> brson: new io/scheduler code does not regress rustc performance (on my platform), yay!
[00:08:14] <brson> cmr: glad to hear :)
[00:08:33] <aatch> graydon, also, do you mind looking into what appears to the bots hanging on master?
[00:08:39] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[00:08:43] <aatch> linux specifically
[00:08:45] *** Joins: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP)
[00:09:21] <graydon> sure, sec
[00:09:48] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[00:09:57] <graydon> aatch: build 125 on master-linux?
[00:10:08] <aatch> graydon, and 124
[00:10:30] <graydon> not hung. I killed buildbot when upgrading sqlite. sorry. they'll need to re-run :(
[00:10:36] <graydon> I'll trigger them
[00:10:49] <graydon> master-mac as well?
[00:10:52] <graydon> (124)
[00:11:42] <aatch> graydon, I dunno. But when I was trying to get the snapshot through, master-linux would just stop sometimes
[00:11:51] <graydon> huh
[00:11:57] *** Joins: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com)
[00:11:59] <graydon> they all go to the same machines
[00:12:05] <graydon> just like different directories
[00:12:58] <aatch> hmm, I guess I could have just been impatient.
[00:13:15] *** Joins: MaikKlein (maik@moz-280FF4C6.dip0.t-ipconnect.de)
[00:13:54] <graydon> understandable. master is a cross build + valgrind slowness smorgasbord
[00:14:03] <brson> cmr: do you have a bot producing those pr graphs automatically?
[00:14:24] <cmr> brson: yes. me typing `benchit.py repo/branch` :p
[00:14:41] <cmr> It does everything except get the branch and comment on the PR automatially
[00:14:42] <aatch> Especially since the tests had already passed on util-snap
[00:14:58] <cmr> brson: I'll be automating this last bit tomorrow.
[00:15:33] *** Joins: wuwei (wuwei@1A513F49.818D7924.FAA9ED67.IP)
[00:17:18] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[00:17:56] *** Quits: k00mi (koomi@moz-BE75DEBE.pools.arcor-ip.net) (Ping timeout)
[00:18:17] <aatch> I must admit, pushing straight to master was a bit of a power trip :D
[00:18:22] *** Joins: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP)
[00:19:42] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[00:20:06] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[00:22:09] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[00:24:12] *** Joins: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net)
[00:24:24] *** Joins: kemurphy (kemurphy@moz-7332FD74.hsd1.pa.comcast.net)
[00:26:02] *** Quits: _1126 (1126@moz-83D60E55.lileth.net) (Ping timeout)
[00:26:04] *** Joins: _1126 (1126@moz-83D60E55.lileth.net)
[00:26:45] *** Parts: mblbruce (mblbruce@moz-D00392B8.fagotten.org) ()
[00:28:01] <cmr> brson: so uh, how do I turn on the new scheduler? :p
[00:28:09] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90-rdmsoft [XULRunner 18.0.2/20130201065344])
[00:28:50] <brson> cmr: RUST_NEWRT=1
[00:29:04] <brson> i have no idea if rustc will work correctly under it
[00:29:08] <brson> but it might
[00:29:19] <cmr> Stderr:  | rustc: ../src/rt/rust_task.h:656: rust_task *rust_get_current_task(): Assertion `task != __null && "no current task"' failed.
[00:29:21] <cmr> nope
[00:29:30] <brson> i'll look at it. probably isn't hard to fix
[00:30:17] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[00:30:55] <brson> oh rustc uses a SharedChan. still needs some porting
[00:31:45] <brson> i'm mostly focused on fixing these incompatibilities. it will work soon
[00:32:55] *** Joins: k00mi (koomi@moz-D309F841.pools.arcor-ip.net)
[00:34:27] *** Joins: dbaupp (Thunderbir@moz-73E90475.lns20.syd6.internode.on.net)
[00:35:36] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[00:36:40] <graydon> brendanc: any guess about why max_builds wouldn't actually limit the max number of builds?
[00:37:14] <graydon> brendanc: I am using a custom nextSlave method
[00:40:01] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:41:05] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[00:43:02] <graydon> it looks like chooseSlave calls nextSlave but passes in a list only of those slaves that are not already past max_builds
[00:43:03] <graydon> hmm
[00:45:36] *** Quits: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net) (Client exited)
[00:46:45] <graydon> oh gosh. does it only consider max_builds in terms of ... max builds running for a single builder:slave pair?
[00:47:03] <graydon> I am trying to limit load _on a buildslave_. one shared between several builders.
[00:48:53] <graydon> I bet it is
[00:48:55] <graydon> that's bad
[00:51:51] <aatch> graydon, might that be the reason why we end up with cases like 1 mac slave running 7 builds while the other is idle?
[00:52:23] <graydon> yes
[00:52:25] <graydon> well
[00:52:37] <graydon> yes. sorta. there are 2 different things going on there, but yes.
[00:53:04] <graydon> I think I have fixed them but it means we'll probably see some breakage in the workspaces due to old / dead stuff (.so files with wrong names etc.)
[00:53:08] <graydon> I'll try to clean them out soon.
[00:53:39] <SiegeLord> Hmm... make -jn locks up on Windows
[00:53:53] <aatch> SiegeLord, known problem with make on Windows
[00:54:20] <SiegeLord> And rustc crashed >_<
[00:54:59] <graydon> brson: ping
[00:55:27] <graydon> brson: mac4 is about to re-enter service for the first time in a while. I suspect it will wedge due to stale artifacts. I don't have its IP address handy. can you clean out its slave workspaces?
[00:55:56] <SiegeLord> Oh, maybe this is where the MinGW version starts to matter
[00:56:42] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[00:56:59] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[00:58:50] <SiegeLord> Ok, replacing the libstdc++ dll fixed that crash...
[00:58:51] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[01:00:10] *** Quits: BitPuffin_ (quassel@moz-6A143E91.cust.tele2.se) (Ping timeout)
[01:00:30] <brendanc> graydon: only intermittently around, but I think the thing you want is to set the 'jobs' property in your buildslave
[01:00:53] <graydon> oh?
[01:01:04] <brendanc> oh no, I am wrong, taht was a custom thing I had
[01:01:06] <brendanc> sorry
[01:01:08] <graydon> ok
[01:01:27] <brendanc> I thought max_builds on the slave did the job too
[01:01:49] <graydon> it does per slave:builder pair
[01:01:54] <graydon> by the look of it
[01:01:58] <graydon> it's checked in AbstractSlaveBuilder
[01:02:02] <graydon> which has a single associated builder
[01:02:11] * graydon unsure exactly
[01:02:31] <graydon> anyway somehow a max_builds=2-limited slave is running 6 builds, one for each of 6 builders
[01:02:36] <graydon> so something's gone awry :(
[01:03:42] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[01:04:44] *** Joins: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com)
[01:05:49] <brson> graydon: i'll clean it, yes, but it should respond to rust-mac4.mv.mozilla.com
[01:06:05] <brendanc> something's confused, but reading buildslave.py it looks to me like max_builds is supposed to do what you think it should do
[01:06:24] *** Joins: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP)
[01:06:26] <aatch> graydon, just a quick note, the example on rust-lang.org is out-of date. As in, it won't compile with current master
[01:07:43] <dbaupp> aatch: it does compile with 0.6, I think
[01:08:00] * brson cleaning
[01:08:39] * brson cleaning
[01:10:33] *** Joins: eschweic1 (Adium@2557E599.66715431.D25A875A.IP)
[01:10:35] *** Quits: eschweic (Adium@2557E599.66715431.D25A875A.IP) (Connection reset by peer)
[01:12:00] * brson cleaning
[01:12:14] <aatch> dbaupp, yeah. I wonder if a new example is in order anyway.
[01:12:36] *** Quits: k00mi (koomi@moz-D309F841.pools.arcor-ip.net) (Ping timeout)
[01:15:06] * brson cleaning
[01:15:50] *** Quits: vk (chatzilla@F92596F.2DEF7520.EF7679FA.IP) (Quit: ChatZilla 0.9.90 [Firefox 22.0/20130617145905])
[01:17:14] <brson> strcat: how do i iterate over the chars of a string
[01:17:27] <strcat> brson: I think there's iter_char or something?
[01:17:30] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[01:17:44] <dbaupp> brson: .iter()
[01:17:54] *** Quits: MaikKlein (maik@moz-280FF4C6.dip0.t-ipconnect.de) (Ping timeout)
[01:18:16] <brson> so we switched to char iteration be default?
[01:18:36] <brson> i feel like we've changed that default several times
[01:18:52] <brson> strcat dbaupp: thanks
[01:19:19] * strcat thinks 'char' is a bad name for a code point anyway
[01:19:54] <strcat> I'd rather have it called char_iter so it's not considered a default, since we'll have graph_iter
[01:20:05] <brson> what's graph_iter?
[01:20:21] <strcat> iteration over glyphs (graphemes)
[01:20:29] <strcat> a glyph can be N code points
[01:20:41] <strcat> for stuff like alignment, char isn't useful
[01:20:58] <brson> do glyphs have any meaning outside of fonts?
[01:21:01] <strcat> (although there's also the complication of double-width things)
[01:21:02] <strcat> brson: yes
[01:21:12] <strcat> brson: http://www.unicode.org/reports/tr29/
[01:21:17] <strcat> graphemes are a unicode concept
[01:21:21] <strcat> closest thing to "character"
[01:21:56] <strcat> it's a character as perceived in a UI - a single unit
[01:21:57] <brson> strcat: i only see the word 'glyph' one time on that page
[01:22:15] <strcat> brson: well they say grapheme instead
[01:22:26] <brson> i don't think they are the same thing
[01:22:27] <aatch> brson, they're normally refered to a 'grapheme'
[01:22:56] <strcat> brson: I think they are, a glyph is just a visual representation of a grapheme
[01:23:08] <strcat> but they map 1:1
[01:23:55] <aatch> graphemes are the reason for zero-width spaces
[01:24:11] *** Quits: eschweic1 (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[01:27:05] <brson> sounds plausible, but the one use of 'glyph' on that page contradicts: 'For example, the sequence <f, i> may be displayed as a single glyph on the screen, but would still be two grapheme clusters'
[01:27:19] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[01:27:40] *** Parts: ecr (ereed@2557E599.66715431.D25A875A.IP) ()
[01:27:41] <strcat> brson: well with a monospace font, that wouldn't be done
[01:27:46] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[01:27:55] <strcat> proportional fonts can use ligatures wherever they like
[01:28:39] <strcat> you can't really know that without knowing the specific font + rendering stack + settings
[01:29:01] *** Joins: ssbr (ssbr@46B5412F.3597C859.3AF705F3.IP)
[01:29:22] <bstrie> I'm starting to think that maybe it *would* be better if str and int etc. were Str and Int for the sake of consistency... was there a good reason that's not the case, other than legacy reasons?
[01:29:32] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[01:30:54] <bstrie> because I'm reading tjc's slides and it does stick out that those types are lowercase unlike all other types
[01:31:18] <brson> bstrie: it stuck out to me too. that was one of the noob q's i asked him during his rehearsal
[01:31:26] <aatch> I'd prefer keeping all the primitive types as lower-case though
[01:31:30] <brson> Java and C# are precedents
[01:32:25] <aatch> I'm not too bothered about str though
[01:33:32] <strcat> what makes them a primitive type though?
[01:34:18] <dbaupp> strcat: hard-coded into the compiler & corresponding to machine operations?
[01:35:15] <aatch> Does the CPU itself have some notion of it? For most types, no, but it does understand about integers and floats.
[01:36:35] <Eridius> bstrie: I haven't read any backscroll, but I rather like the idea that intrinsic types are lowercased
[01:36:40] <Eridius> (not traits though)
[01:37:14] <strcat> aatch: LLVM represents signed/unsigned integers as the same type
[01:37:16] <brson> we could turn str and vec into lang items
[01:37:23] <steven_is_false> Java has the boxing reason for why int, and such are lower case. There is no such reason for Rust.
[01:37:31] <strcat> aatch: uint vs int is a distinction made by rust
[01:37:49] <brson> if str and vec were lang items they wouldn't have to have so many awkward traits to hold their impls
[01:37:55] <brson> since they would be user-defined types
[01:38:15] <strcat> brson: why not make everything a lang item then? ;p
[01:38:18] <aatch> strcat, so? LLVM does make a distinction between signed and unsigned versions of operations.
[01:39:27] <strcat> aatch: not the integer ops
[01:39:50] <dbaupp> brson: that would presumably require DST? (it sounds nice though! move more things to libraries.)
[01:39:59] <strcat> excluding whether unsigned/signed overflow is undefined via nsw/nuw
[01:41:51] <brson> graydon: oops, forgot the status updates. mac4 is clean
[01:42:16] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[01:44:08] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[01:44:14] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[01:44:30] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[01:44:51] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[01:45:39] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[01:46:46] <strcat> graydon: auto seems to be stuck or somethin
[01:46:57] <strcat> or just running for a long, long time...
[01:47:34] *** Joins: jensnockert (jensnocker@moz-8BE55278.customer.t3.se)
[01:47:46] <strcat> oh nvm it's just that one of them takes 3 hours now ;\
[01:51:02] <aatch> grr, stupid null byte strikes again
[01:53:01] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[01:53:57] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[01:55:56] *** Joins: azita (Azita@moz-8F25FD15.bdsl.verizon.net)
[01:56:30] <xenocons> hehe\0\he
[01:56:32] <xenocons> oops
[01:56:36] <xenocons> hehe\0he
[01:56:38] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Ping timeout)
[01:56:39] <xenocons> its error prone
[01:56:49] *** Joins: mark_edward (quassel@moz-4A9A2F15.dynamic.utc.edu)
[01:56:52] * xenocons now wonders what escape \h is
[01:58:42] <aatch> xenocons, actually its more this:
[01:58:55] <aatch> rusti: let a = "Foo"; a.char_at(3)
[01:58:59] -rusti- '\x00'
[01:59:11] <xenocons> right, 0 index start
[02:00:13] <xenocons> im not sure about the behaviour of this
[02:00:17] <xenocons> i mean, is it bad?
[02:00:24] <aatch> unexpected.
[02:00:34] <xenocons> yeah i suppose
[02:00:47] <xenocons> i like the idea of a string just being a char vector
[02:00:54] <xenocons> is there a need for \0 at the end if thats the case?
[02:01:02] <strcat> no
[02:01:06] <xenocons> (as length is kept in head of vector)
[02:01:17] <aatch> rusti: let a = "Foo"; (a.len(), a.char_at(a.len()))
[02:01:17] -rusti- (3, '\x00')
[02:01:32] <strcat> the built-in doesn't *need* \0 at the end either, it's just currently there
[02:01:36] <xenocons> ah
[02:01:36] <strcat> sometimes.
[02:01:48] <xenocons> i suppose for some interop stuff its needed too
[02:01:51] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[02:02:03] <xenocons> strcpy without a null could be fun
[02:02:16] <strcat> strcpy wouldn't be fun anyway because it's fundamentally unsafe/useless
[02:02:16] <aatch> rusti: let a = ~['F', 'o', 'o']; (a.len(), a[a.len()])
[02:02:17] -rusti- rust: task failed at 'index out of bounds: the len is 3 but the index is 3', <anon>:10
[02:02:17] -rusti- rust: domain main @0x1a711b0 root task failed
[02:02:18] -rusti- application terminated with error code 101
[02:02:19] <strcat> memcpy works fine
[02:02:19] <sp3d> strcpy without null is already fun, look at C :D
[02:02:32] *** Quits: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net) (Quit: Computer has gone to sleep.)
[02:02:36] <xenocons> yes, there is strncpy though
[02:02:46] <strcat> also useless/slow
[02:02:50] <xenocons> and a whole bunch of other str functions that rely on \0
[02:02:51] <strcat> memcpy > *cpy
[02:02:59] <strcat> xenocons: any useful one?
[02:03:16] <aatch> strcpy only exists because the length is carried around.
[02:03:18] <xenocons> strcat: ive seen people use strok\strcat etc quite nicely
[02:03:21] <aatch> s/is/isn't/
[02:03:27] <xenocons> i myself am terrible at using them
[02:03:28] <strcat> xenocons: why aren't they using memcpy?
[02:03:39] <xenocons> strcat: easy of use i guess, laziness?
[02:03:48] <strcat> strings that carry a length are easier to use
[02:03:53] <strcat> there are string libraries for C
[02:03:58] <xenocons> heh
[02:04:01] <aatch> bstring is really nice
[02:04:06] <xenocons> bstr?
[02:04:07] <strcat> much faster too
[02:04:11] <xenocons> as in the com interop stuff?
[02:04:25] <aatch> no, there's a C library called bstring
[02:04:35] <xenocons> i think pascal (or one of them) kept a dword for the strlen in the first 4 bytes too
[02:04:35] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[02:04:44] <strcat> plan9 C has real strings with a length
[02:04:46] <xenocons> i agree speed is much better
[02:04:52] <aatch> represents strings pretty much exactly the same way Rust does
[02:05:06] <aatch> {length, capacity, ptr}
[02:05:12] <strcat> aatch: http://man.cat-v.org/plan_9/2/string
[02:05:15] <strcat> part of the C stdlib in plan9
[02:05:22] <aatch> strcat, cool
[02:05:35] <strcat> it puts \0 at the end though
[02:05:38] <strcat> for compatibility
[02:05:56] <strcat> but Go is written by the same people and abandons that completely
[02:05:58] *** Quits: kimundi (kimundi@moz-364FCCA6.dip0.t-ipconnect.de) (Ping timeout)
[02:06:10] <xenocons> lol
[02:06:29] <xenocons> going from null terminated string to a length prefixed one is probably slow though
[02:06:35] <strcat> no
[02:06:40] <strcat> length is faster
[02:06:49] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[02:07:03] <xenocons> well, i mean converting a null term string to a LPS is , right? as the length needs to be calculated
[02:07:08] <strcat> memcpy/memcmp is very fast, it can use nice SSE/AVX instructions and you have no seeks to the end
[02:07:19] <xenocons> ah
[02:07:27] <strcat> xenocons: you're already seeking to the end millions of times with \0-suffixed ones
[02:07:28] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[02:07:33] <xenocons> yeh
[02:07:38] <strcat> anything perf critical isn't using them
[02:07:43] <strcat> anything with unicode support isn't using them
[02:07:49] <strcat> \0 is a valid unicode code point
[02:07:55] <pcwalton> my metadata/resolve refactoring bootstrapped \o/
[02:08:04] <xenocons> like while str not '\0' do blah, str++; i guess
[02:08:11] <xenocons> strcat: right yeh
[02:08:15] <xenocons> good point
[02:08:26] <xenocons> H.e.l.l.o. :>
[02:08:33] <strcat> if "foo\0bar" and "foo" compare equal, it's not unicode
[02:09:06] <strcat> at least with utf-8
[02:10:00] <xenocons> ive seen some epic bug with wcscmp come to think of it
[02:10:21] <xenocons> i generally dislike all that wcs stuff
[02:10:37] <strcat> well it's not very useful
[02:10:46] <xenocons> its tricky, confusing
[02:10:58] <strcat> because 1) it's not standardized as unicode or a specific encoding and 2) wide characters or code points aren't graphemes
[02:11:06] <xenocons> if you supply a normal string where its expecting wchar_t ur gona have a bad day
[02:11:22] <xenocons> s/normal string/char/
[02:11:27] <strcat> on windows wchar_t is 2-byte, on linux it's 4-byte
[02:11:33] <xenocons> ew
[02:11:36] <strcat> well, everywhere but windows it's 4-byte
[02:11:37] <dbaupp> xenocons: that's also a problem of having a crappy type system
[02:11:39] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[02:12:01] <xenocons> pcwstr pwstr lpwstr lpcwstr, let me sing u the song of my ppl
[02:12:01] <strcat> anyway it's a terrible thing to use ;p
[02:12:08] <xenocons> strcat: i agree
[02:12:18] <xenocons> dbaupp: yeah
[02:12:37] <strcat> utf-32 is still a variable length encoding of *graphemes*, which are pretty much the only useful unit to think about
[02:12:40] <SiegeLord> Could using a wrong mingw version produce a rustllvm.dll with missing symbols?
[02:13:03] <xenocons> graphemes? this concept is not familiar to me
[02:13:28] <xenocons> and variable length encoding sounds terrifying
[02:13:52] <dbaupp> xenocons: grapheme = unit that gets displayed
[02:13:57] *** Joins: zz_kimundi (kimundi@moz-386FFA95.dip0.t-ipconnect.de)
[02:14:07] <xenocons> hm
[02:14:08] <strcat> dbaupp: by a monospace font ;p
[02:14:17] <strcat> more complicated for non-monospace
[02:14:18] *** zz_kimundi is now known as kimundi
[02:14:25] <dbaupp> strcat: yup
[02:14:27] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[02:14:38] <strcat> grapheme -> semantic character unit used by languages and user interfaces
[02:14:43] <xenocons> ah
[02:14:52] <strcat> code point -> entirely artificial unit used by unicode to encode graphemes, no real world relevance
[02:15:12] <dbaupp> xenocons: e.g. ` + e can be two separate codepoints, but they should be displayed as Ã¨
[02:15:17] <xenocons> and a code page is a collection of code points?
[02:15:20] <dbaupp> (that's ignoring the details of valid unicode etc.)
[02:15:23] <strcat> xenocons: no
[02:15:35] <xenocons> dbaupp: right, i see
[02:15:40] *** Joins: Jesin (Jessin_@moz-C9F24054.eecs.lehigh.edu)
[02:15:40] <strcat> xenocons: that's just an obsolete term
[02:15:51] <xenocons> strcat: ah
[02:15:57] <xenocons> i see 'codepage' used a lot
[02:16:03] <strcat> microsoft uses it
[02:16:04] <xenocons> in specification docs by microsoft
[02:16:07] <strcat> but it's entirely obsolete
[02:16:08] <dbaupp> xenocons: (also, for reference, utf8 is a variable length encoding.)
[02:16:27] <xenocons> dbaupp: cool, ive never really understood the whole encoding circus
[02:16:40] <strcat> utf8 and utf16 are variable length encodings of code points
[02:16:43] <xenocons> i mostly just see the result in memory
[02:16:48] <xenocons> utf-32 is not?
[02:16:49] <strcat> but utf32 is still a variable length encoding of semantic characters ;p
[02:16:50] <dbaupp> xenocons: I don't blame you... it's pretty complicated.
[02:16:58] <strcat> xenocons: utf32 is a fixed-length encoding of code points
[02:17:04] <strcat> which are a variable length representation of characters
[02:17:48] <strcat> indexing a semantic character in a utf-32 array is O(n)
[02:18:20] <xenocons> hmm ok
[02:18:49] <xenocons> its probably not too required to know about unless you are implementing it within a language and care for compatibility right?
[02:18:54] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Quit: Computer has gone to sleep.)
[02:19:08] <strcat> you need to know about it to write correct code dealing with input/output of strings
[02:19:11] <xenocons> i usually just use whatever the spec says and it seems to work
[02:19:41] <xenocons> yeah, i guess i havent run into too many problems that wasnt solve by debugging so far
[02:19:50] <xenocons> solved*
[02:20:00] <xenocons> but i think it is a good thing to know about
[02:20:01] <strcat> probably because it's not tested with all kinds of input ;p
[02:20:07] <xenocons> yeh
[02:20:27] <strcat> non-trivial problems: reversing a string, using a string as a key, comparing/sorting strings, splitting a string
[02:21:03] <strcat> a == b
[02:21:07] <strcat> what kind of equality do you want?
[02:21:17] <strcat> http://unicode.org/reports/tr15/
[02:21:21] <strcat> multiple ways of representing the same text
[02:21:25] <xenocons> i think some of my fuzzing stuff could benefit from 
[02:21:26] <xenocons> brb
[02:27:53] *** Quits: azita (Azita@moz-8F25FD15.bdsl.verizon.net) (Quit: azita)
[02:28:32] <dbaupp> the buildbots appear to have crashed, or something?
[02:29:20] *** Joins: alisdair (textual@moz-EBE9F394.bchsia.telus.net)
[02:31:50] <pcwalton> yeah :(
[02:32:21] <roo> i've run into a wall trying to get a 'for' iterator to work, could some generous/bored person have a look at this? https://gist.github.com/jessopher/a6cba720dbaf06dfd262
[02:32:48] <Eridius> roo: what error do you get?>
[02:32:50] <dbaupp> roo: what's the error message?
[02:32:51] *** Quits: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP) (Quit: pcwalton)
[02:32:58] *** Quits: ssbr (ssbr@46B5412F.3597C859.3AF705F3.IP) (Ping timeout)
[02:33:03] <roo> its at the top of the gist
[02:33:09] <roo> the comment
[02:33:10] <Eridius> roo: btw you need `for room.iter().advance
[02:33:16] <dbaupp> roo: you need fn iter() -> bool
[02:33:47] <Eridius> ooh you defined your own iter()
[02:33:51] <Eridius> serves me right for not reading fully
[02:33:51] <roo> ok, so the actual iterator function needs to return bool? not just the closure it takes?
[02:33:55] <dbaupp> roo: and it should return false if the inner closure "broke", and true if the loop executes the whole way
[02:33:58] <Eridius> I was assuming you were using the external iterators
[02:34:00] <dbaupp> roo: yup
[02:34:09] <Eridius> roo: yes the iterator function itself returns a bool, which indicates whether it finished or was broken out
[02:34:14] <strcat> at least until 'for' switches to a new protocol ;p
[02:34:16] <Eridius> this allows you to "chain" your iterators
[02:34:19] <dbaupp> roo: it was changed to make for more composable
[02:34:37] <dbaupp> strcat: that's going to break so much code ;D
[02:34:43] <roo> ah ok. thanks guys
[02:34:47] <strcat> dbaupp: not in the rust codebase
[02:34:52] <strcat> dbaupp: they'll mostly be .advance ones already
[02:34:54] <Eridius> outer.iter(|inner| inner.iter(|x| doSomething(x) ) )
[02:35:07] <dbaupp> strca: yeah, I know, but everyone else
[02:35:13] <dbaupp> strcat*
[02:35:25] <Eridius> dbaupp: they deserve to have their code broken if they haven't been keeping up with the external iterator work ;)
[02:35:36] <dbaupp> Eridius: heh
[02:35:58] <dbaupp> Eridius: fixing code due to language changes is half the fun of using Rust
[02:36:17] <dbaupp> (each time you get a new rustc, you get an exciting new batch of errors!)
[02:36:43] *** Quits: jensnockert (jensnocker@moz-8BE55278.customer.t3.se) (Input/output error)
[02:40:33] <Eridius> ok what the heck is ${CXX.Flags} in llvm-config's Makefile?
[02:40:48] <Eridius> I taught llvm to build with -stdlib=libstdc++ but it's not being reflected in `llvm-config --cxxflags`
[02:42:29] <Eridius> hmm looks like CXX.Flags comes from the configure --switches, and ignores any CXXFLAGS passed in through the environment. which is kinda crap
[02:43:20] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[02:43:55] <strcat> gcc doesn't have a -stdlib switch though
[02:44:06] <Eridius> it doesn't? damn, so it's just a clang thing? that's going to make this more awkward
[02:44:21] <strcat> yep, just a clang thing
[02:44:25] <strcat> gcc makes it more awkward
[02:44:58] <strcat> much like -Wmost vs -Wall -Wextra -Wtwenty-other-things
[02:46:32] <Eridius> hmm llvm's configure has an option to enable libc++. if you're using gcc, does turning on that option just blow up?
[02:46:43] *** Quits: Jesin (Jessin_@moz-C9F24054.eecs.lehigh.edu) (Ping timeout)
[02:46:54] * dbaupp loves how -Wall doesn't enable all warnings
[02:47:12] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[02:47:16] <Eridius> strcat: huh, g++ just accepted -stdlib=libc++ on my system
[02:47:29] <Eridius> oh goddammit, this is faux-clang again
[02:47:34] <strcat> Eridius: it's not gcc if it does ;p
[02:47:35] <Eridius> I thought gcc on this system wasn't faux-clang, but I guess it is
[02:47:38] <strcat> gcc: error: unrecognized command line option â€˜-stdlib=â€™
[02:48:08] <Eridius> strcat: so if you run `./configure --enable-libcpp` in llvm and then try to build, it will fail?
[02:48:58] *** Joins: Jesin (Jessin_@moz-C9F24054.eecs.lehigh.edu)
[02:50:20] <strcat> Eridius: breaks
[02:50:23] <Eridius> damn
[02:50:24] <strcat> without CXX=clang++
[02:50:49] <strcat> but, also breaks with CXX=clang++ with libc++ if it's built with the libstdc++ abi
[02:50:52] <strcat> instead of libc++abi
[02:50:53] <strcat> ;\
[02:50:55] <strcat> need
[02:51:01] <strcat> clang++ -stdlib=libc++ -Wl,-lstdc++
[02:51:05] <strcat> if it's not using libc++abi
[02:51:13] <Eridius> not sure what you mean
[02:51:18] <strcat> libc++ has two parts
[02:51:28] <strcat> the C++ standard library and the low level exception and rtti abi bits
[02:51:39] <strcat> on linux it's usually built without the low level bits
[02:51:41] <strcat> and uses libstdc++
[02:51:48] <Eridius> hmm
[02:51:49] <strcat> but clang won't link against both by default
[02:51:55] <strcat> so -stdlib=libc++ isn't enough
[02:52:03] *** Quits: EXetoC (ex@moz-2DBEB1E4.customer.t3.se) (Quit: WeeChat 0.4.1)
[02:52:13] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[02:52:17] <Eridius> strcat: well I'm actually trying to force it to -stdlib=libstdc++ because rust can't handle libc++abi
[02:52:25] <strcat> ah
[02:52:28] <Eridius> but dev tools on 10.9 default to libc++
[02:52:42] <strcat> and on modern freebsd probably
[02:52:43] <Eridius> this is the reason why I can't use task::try, and can't run `make check` on any of my 10.9 machines
[02:53:06] <strcat> since I don't think freebsd uses GPLv3 stuff either, they switched to clang/libc++
[02:53:10] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[02:53:31] <strcat> Eridius: can you just check if CXX is clang++, and then pass it?
[02:54:04] <Eridius> strcat: well rust's configure takes --enable-clang, so I can do stuff if you pass that
[02:54:09] <strcat> yeah
[02:54:33] <Eridius> although it'd be nice to fix llvm to get -stdlib=libstdc++ into the llvm-config --cxxflags, the only way that seems reasonable to do that would be to change the configure script to add that to CXX.Flags, if and only if the compiler is clang*
[02:55:43] <strcat> once the C++ part of the runtime is gone we won't need to link against libstdc++
[02:55:48] <strcat> I think we could just be using libunwind
[02:55:57] <strcat> or maybe we could just define our own exception ABI stuff
[02:58:47] <steven_is_false> ../../src/rust/configure --prefix=~/.local --enable-ccache --enable-clang seems like a good configuration for building Rust. Am I missing any obvious ways to do better though?
[02:59:05] <steven_is_false> Any neat flags I can take advantage of?
[02:59:13] <strcat> steven_is_false: you shouldn't use prefix like that
[02:59:25] <strcat> you should use DESTDIR in make install
[03:00:03] <strcat> not a big deal if it works but...
[03:00:05] <strcat> it's not what it's for ;p
[03:00:44] <steven_is_false> strcat: Yeah, I guess what I really want is a --destdir option but it works well enough.
[03:01:17] <strcat> configure probably shouldn't have prefix at all though
[03:01:26] <strcat> building is supposed to be separate from installation
[03:01:34] <strcat> it's a weird autotools cruft thing
[03:01:37] <strcat> to be --prefix in configure
[03:01:53] <strcat> configure as a whole is autotools cruft though :(
[03:02:02] <strcat> the makefile could just have params
[03:02:31] <steven_is_false> strcat: What would be best would be to able to have a configuration file like Make.defaults or something.
[03:02:51] <strcat> yeah, config.mk is usually what it's called
[03:03:13] <strcat> and you can still just pass make a=foo b=bar
[03:03:39] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[03:03:44] <steven_is_false> strcat: Doesn't --prefix just set the default? I thought one could still do make PREFIX=etc.. anyways.
[03:04:08] <strcat> steven_is_false: rust assumes a build is for a single installation and assumes the build isn't done in a chroot (incorrectly)
[03:04:20] <steven_is_false> strcat: That's unfortunate.
[03:04:32] <strcat> CFG_PREFIX is used for rpath stuff
[03:04:44] <strcat> our build system is held together by rpath hacks apparently
[03:04:53] <steven_is_false> Of course, I'm not really one to talk. I have no idea how one'd set up a build system to work in a chroot.
[03:04:55] <strcat> and they stay on the final binaries and make them fail distro lint checks
[03:05:07] <strcat> steven_is_false: by using a package manager that does it for you
[03:05:21] *** Quits: SiegeLord (siege@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[03:05:52] <steven_is_false> strcat: I don't follow.
[03:06:07] <strcat> packages are usually built in a clean chroot
[03:06:13] <strcat> by the package manager
[03:06:19] <steven_is_false> Okay.
[03:06:23] *** Joins: enticeing (user@1983AA36.E4834407.EAAB5301.IP)
[03:06:32] <steven_is_false> This is a gentoo style package thingie right?
[03:06:35] <strcat> and then it's a clean package that can be installed anywhere, and won't have any missing deps
[03:06:50] <strcat> steven_is_false: well debian/arch/gentoo all build in a chroot with their devtools afaik
[03:07:05] <steven_is_false> okay
[03:07:35] <Eridius> strcat: what the heck happened with bors when testing my printf PR?
[03:07:42] <strcat> Eridius: he died ;\
[03:07:49] <Eridius> what was with all those unrelated test failures though?
[03:07:54] <strcat> Eridius: which?
[03:08:00] *** Quits: jrfeenst (jrfeenst@moz-F912484F.cpe.norwoodlight.com) (Quit: jrfeenst)
[03:08:20] <Eridius> strcat: oh they're not failures, they're just red because the task failed, but the test still succeeded
[03:08:23] <Eridius> (because the task was supposed to fail)
[03:08:28] <Eridius> I didn't think those expected failures were logged
[03:08:30] * strcat shrugs
[03:08:56] <Eridius> strcat: do I need to do anything about the fact that bors died?
[03:09:06] <strcat> Eridius: can you temporarily close the pull request? just want to see something
[03:09:50] <dbaupp> Eridius: it's unlikely to be caused by you (buildbot has been acting up a bit)
[03:10:03] <Eridius> strcat: ok, closed
[03:10:15] <strcat> Eridius: k lets see if it unjams on the next bors update
[03:10:25] <Eridius> nice time formatting, github: "kballard closed the pull request in a few seconds"
[03:10:33] <strcat> :D
[03:10:42] <strcat> Eridius: they probably format times on the client
[03:10:56] <Eridius> strcat: they should also tell the client what they think the time is then
[03:10:57] <strcat> so I guess the time on the server is desynced from what you have
[03:11:01] <Eridius> so it can format relative to that
[03:12:04] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[03:12:58] <strcat> dammit bors, what are you doing
[03:13:20] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[03:13:20] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1478fe9f6 to 14f348465: 02http://git.io/N3iJvQ
[03:13:20] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[03:13:22] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[03:13:22] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/t_AzNg
[03:13:22] <ghrust> 13rust/06auto 141a8969f 15Michael Sullivan: Get cross crate default methods working....
[03:13:22] <ghrust> 13rust/06auto 147560ae0 15bors: auto merge of #7203 : msullivan/rust/default-methods, r=graydon...
[03:13:22] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[03:13:24] <strcat> there
[03:13:26] <strcat> Eridius: worked
[03:13:41] <strcat> Eridius: oh, I can reopen it - didn't realize someone that wasn't the submitter could do that
[03:13:48] * strcat will r+ it again
[03:13:49] <Eridius> strcat: yeah. thanks
[03:14:01] <strcat> or just make it retry I guess
[03:14:33] <strcat> I don't understand why it got stuck.
[03:14:42] <strcat> I guess buildbot failed to report that all the builds finished
[03:14:48] <strcat> and that one failed ;\
[03:16:22] *** Quits: mleise (marco@moz-3468AB5B.pools.arcor-ip.net) (Quit: Leaving.)
[03:16:33] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[03:17:24] *** Quits: kini (kini@moz-92AA953A.members.linode.com) (Ping timeout)
[03:17:38] <strcat> yep buildbot is doing stuff again
[03:17:48] *** Joins: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net)
[03:17:57] <roo> is there a way to prevent dereferencing of an owned pointer? So that i can impose lifetimes on values of abstract types?
[03:18:13] *** Joins: kini (kini@moz-92AA953A.members.linode.com)
[03:18:28] <enticeing> so for a function like `fn DList<T>() -> @mut DList<T>`, how would i specify the type?
[03:19:38] *** Quits: jezi22 (Mibbit@342CB9.9E63A991.74DEF76E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:19:46] *** Quits: tikue (tkuehn@moz-A7CDB794.dia.static.qwest.net) (Quit: tikue)
[03:20:28] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[03:20:42] <strcat> roo: owned pointers are no different than other types with destructors
[03:21:00] <strcat> you can implement an alternate owned pointer
[03:21:37] <strcat> a file type with a destructor will act the same - the compiler will statically prevent ever calling a method on a closed file
[03:21:54] <roo> hmmmm!
[03:22:11] *** Joins: ssbr (ssbr@1527A0E8.C194AA38.4EA770CF.IP)
[03:23:33] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[03:25:13] <roo> so, i could have some type that is destroyed on reassignment, and then since it isnt a pointer, it cant be dereferenced. Does that about sum it up? (i know nothing about the concept of destruction in rust)
[03:26:27] <strcat> roo: yes, you can implement a destructor on any type
[03:26:46] <strcat> roo: you just implement the Drop trait, and it now moves ownership (like ~) instead of implicitly copying
[03:27:05] <strcat> impl Drop for File { fn finalize(&self) { unsafe { fclose(self.fp) } } }
[03:27:15] <roo> excellent
[03:27:18] <roo> thank you
[03:27:23] <strcat> roo: np
[03:28:10] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[03:29:56] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[03:31:39] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[03:33:06] <aatch> Rebasing, rebasing, rebasing. Woo!
[03:33:08] <aatch> -.-
[03:34:02] <dbaupp> aatch: has the wind slowed?
[03:34:19] <aatch> dbaupp, yep, we are now at gale-force instead of hurricane-force
[03:34:28] <dbaupp> and your house is approximately where it was yesterday?
[03:34:39] <strcat> no he lives in the ocean now
[03:35:06] <aatch> I'm on a boat!
[03:36:18] *** Joins: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au)
[03:37:13] <dbaupp> aatch: you should sail across to sydney, we could have a rust-hackday ;D
[03:41:27] <aatch> Well, that was suprisingly painless
[03:41:45] <roo> strcat: and borrowing semantics just use borrowed pointers for droppable types i am guessing? Like, to lend out your file handle, you would just use &file, or is there some other trait witchcraft i need to be aware of?
[03:42:14] <aatch> roo, no, that's pretty much it
[03:42:17] <strcat> roo: borrowed pointers are pretty much orthogonal to destructors
[03:42:24] <roo> ok
[03:42:28] <strcat> things without a destructor have a lifetime too, since they're memory
[03:43:00] <strcat> the destructor will just stop you from being able to copy it (resulting in more than 1 destructor call, use after it's destroyed, etc.)
[03:43:19] <strcat> ofc if it *is* copyable you can implement Clone
[03:43:23] *** Joins: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP)
[03:43:23] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 147560ae0 to 14f348465: 02http://git.io/N3iJvQ
[03:43:23] *** Parts: ghrust (ghrust@5FEF1C87.6A2AE50.F3114085.IP) ()
[03:43:25] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[03:43:25] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/TdxxWQ
[03:43:25] <ghrust> 13rust/06auto 14c1b1091 15Kevin Ballard: Support printf formats in terminfo strings...
[03:43:25] <ghrust> 13rust/06auto 1477ae7ec 15bors: auto merge of #7161 : kballard/rust/terminfo-parm-format, r=thestinger...
[03:43:25] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[03:44:43] <dbaupp> :( default methods failed... for a stupid reason
[03:45:00] <aatch> dbaupp, whats the pull?
[03:45:08] <dbaupp> `tail -n +2 /c/bot/slave/auto...` => `TAIL: can't open +2`
[03:45:25] <aatch> ugh
[03:45:38] <dbaupp> https://github.com/mozilla/rust/pull/7203
[03:46:04] <dbaupp> (for some reason that was recompiling LLVM?)
[03:46:25] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[03:47:08] <aatch> I saw that...
[03:48:13] <steven_is_false> Are there any plans to add concurrency primitives like concurrent hash tables, and concurrent queues to Rust?
[03:48:23] <strcat> steven_is_false: what do you mean by concurrent?
[03:48:26] <strcat> there's no global gc
[03:48:43] <strcat> channels are concurrent queues
[03:48:49] <steven_is_false> strcat: The hash table would be like a RWArc<HashMap> but faster.
[03:49:13] <aatch> hashtable is definitely not a primitive.
[03:49:21] <dbaupp> steven_is_false: presumably they can be implemented in libraries
[03:49:22] <steven_is_false> strcat: I was stupid. Yeah, the channels are concurrent queues.
[03:49:32] <dbaupp> (probably with an unhealthy does of unsafe)
[03:49:37] <dbaupp> *dose
[03:49:43] <steven_is_false> Right, I was thinking it'd be a cool thing to put in extra
[03:49:55] <dbaupp> ah, I see.
[03:49:58] <aatch> steven_is_false, it would, and we have the Atomic types for it
[03:50:07] <Eridius> screw concurrent hashtables. Just spin up a task that accepts queries and returns results
[03:50:08] <aatch> in std::unstable::atomics
[03:50:43] <aatch> I'm planning on fleshing out the operations.
[03:50:47] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[03:50:50] <steven_is_false> Eridius: that leads to a single point of contention (although it is very elegant in other respects.)
[03:50:52] <dbaupp> Eridius: the overhead of a channel to communicate might be too much
[03:50:53] <strcat> steven_is_false: it'd be difficult to make safe I think
[03:50:57] * dbaupp doesn't know
[03:50:58] <strcat> if it was mutable
[03:51:08] <Eridius> steven_is_false: are you asking for a lock-free hashtable?
[03:51:32] <dbaupp> strcat: presumably it'd be impossible to be made entirely statically safe
[03:51:39] <steven_is_false> Eridius: As much as possible with respects to portability, and ease of implementation, yes.
[03:51:43] <strcat> well RWArc is almost safe
[03:51:47] <Eridius> steven_is_false: good luck proving that it's safe
[03:52:16] <strcat> but RWArc can't coexist safely with assumptions that failing == memory can't be used anymore
[03:52:25] <strcat> RWArc means you have to worry about exception safety
[03:52:40] <strcat> so right now it's not safe.
[03:52:42] <steven_is_false> Eridius: Concurrency gives my brain more gas than Monadic burritos
[03:52:53] <strcat> either RWArc or functions like vec::consume have to be removed
[03:53:13] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[03:53:14] <steven_is_false> strcat: TIL that RWArc is unsafe with respect to exceptions.
[03:53:28] <strcat> steven_is_false: not unsafe
[03:53:36] <strcat> it means you have to worry about exception safety
[03:53:38] *** Joins: defaultUser (Mibbit@moz-F2E9405F.wireless.temple.edu)
[03:53:40] <strcat> it's the only place
[03:53:49] <strcat> and there are things that aren't exception safe
[03:53:57] <Eridius> steven_is_false: there's only two hard problems in computer science, coannd cnurrameningcy
[03:53:59] <strcat> they only provide the guarantee that resources are freed
[03:54:20] <dbaupp> Eridius: llo
[03:54:35] <steven_is_false> strcat: So, one would have to do expensive things such as keeping old copies of data around before commiting a result to make them exception safe?
[03:54:36] <Eridius> (that was concurrency and naming)
[03:54:42] <Eridius> although cache invalidation really ought to be there too
[03:54:51] <strcat> steven_is_false: yep
[03:54:53] <steven_is_false> Caches are an evil black art.
[03:54:54] <aatch> There are 2 hard problems with programming, naming, cache invalidation and off-by-one errors
[03:55:04] <strcat> Eridius: http://esolangs.org/wiki/Entropy :D
[03:55:06] <steven_is_false> :)
[03:55:39] <Eridius> strcat: hah
[03:55:43] *** Quits: defaultUser (Mibbit@moz-F2E9405F.wireless.temple.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[03:56:05] <steven_is_false> strcat: So something like STM would be needed to give an exception safe interface to RWArcs?
[03:56:20] <strcat> probably
[03:56:51] <strcat> or we can make everything exception safe and lose the benefits of failure only being catchable at task boundaries...
[03:56:55] * strcat doesn't think that will happen
[03:57:11] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[03:57:23] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[03:57:24] <steven_is_false> strcat: Why can't we have both the unsafe low level primitives, and the safe high level libraries?
[03:57:40] <strcat> because you can't build a safe type on top of it
[03:57:59] <strcat> there's no point of having pervasive unsafe stuff that you can't wrap into safe APIs
[03:58:10] <strcat> your whole program would have to be unsafe fns
[03:58:18] <strcat> at least main ;p
[03:58:25] * strcat shrugs
[03:59:20] <strcat> either we have to decide code has to be exception safe (not necessarily *correct* in the presence of unwinding, but not memory unsafe)
[03:59:22] <aatch> strcat, isn't the problem with exception safety mostly that you can end up with incomplete state?
[03:59:25] <strcat> or remove mutable shared memory
[03:59:34] <strcat> aatch: look at how vec::consume is implemented
[03:59:38] <xenocons> of overwrite the exception handler hoho
[03:59:49] <strcat> aatch: it replaces elements with init()
[03:59:57] <strcat> aatch: then, the function you passed in for iteration can fail
[04:00:06] <strcat> now consider what happens if the vector was in a RWArc
[04:00:52] <aatch> strcat, ok, so invalid state. My point is that lock-free datastructures are all about dealing with invalid state
[04:01:14] <aatch> either it can't happen, or you _have_ to account for it in your design.
[04:01:31] <strcat> the solution can be that the exclusive lock on RWArc doesn't get removed if failure happens
[04:02:09] <steven_is_false> strcat: That seems like one approach of handling it.
[04:02:27] <steven_is_false> strcat: One could also "poison" a rwarc variable that has an inconsistent state.
[04:02:38] <strcat> steven_is_false: you don't know it has an inconsistent state
[04:02:44] <strcat> you only know failure happened
[04:02:53] <aatch> steven_is_false, the issue there is that it's RWArc<T>
[04:02:55] <strcat> not why, or under what conditions
[04:03:19] <steven_is_false> strcat: A bit is 0 in an RWArc if it's not under exclusive access.
[04:03:53] <steven_is_false> Okay, actually now that I think of it I can't think of a way to implement my poisoning idea.
[04:04:49] <steven_is_false> And if it could be implemented it'd probable have to be implemented on top of the other approach anyways.
[04:05:07] <strcat> oh
[04:05:10] <strcat>      * Failing while inside the ARC will unlock the ARC while unwinding, so
[04:05:11] *** Quits: ssbr (ssbr@1527A0E8.C194AA38.4EA770CF.IP) (Client exited)
[04:05:12] <strcat>      * that other tasks won't block forever. It will also poison the ARC:
[04:05:14] <strcat>      * any tasks that subsequently try to access it (including those already
[04:05:16] <strcat>      * blocked on the mutex) will also fail immediately.
[04:05:18] <strcat> already dealt with
[04:05:23] <strcat> the lock just has 3 states
[04:05:25] <steven_is_false> strcat: Cool!
[04:05:30] <strcat> unlocked, locked, poisoned
[04:05:37] * strcat is happy that isn't actually an issue
[04:05:39] <strcat> :)
[04:05:47] <steven_is_false> :)
[04:06:05] <strcat> for once rust is sound
[04:06:40] <aatch> strcat, well bblum did all that work
[04:06:46] <strcat> meh, going to be evil and add o=1 to the vector one
[04:06:48] *** Quits: Jesin (Jessin_@moz-C9F24054.eecs.lehigh.edu) (Ping timeout)
[04:06:48] <strcat> p=1 *
[04:07:19] <strcat> stupid github killed my old pull so it ended up at the back ;[
[04:07:36] <aatch> in fact, he's got a PR open to fix an obscure 3-way race with writer downgrading.
[04:08:34] <steven_is_false> strcat: I had ONE flaw in my PR. A silly copyright mistake. brson had already r+ it. It was just my like that when I fixed my code, the bot was taken down!
[04:08:39] *** Quits: reed (reed@tech.monkey) (Ping timeout)
[04:09:18] <strcat> well github decided not to bother re-checking if my pull was mergeable after I rebased
[04:09:21] <strcat> opening it again fixed it
[04:09:34] <strcat> rebasing again might have fixed it too...
[04:09:50] * strcat has rebased that ~80 times now ;[
[04:10:02] <steven_is_false> wow
[04:10:17] <strcat> % git reflog | grep -c 'vec: rm old_iter implementations'
[04:10:18] <strcat> 172
[04:10:25] <strcat> I also amended it a bunch while fixing issues found during the compile ;p
[04:10:55] <aatch> Ok, so apparently that failure for default methods was a fluke
[04:11:10] <strcat> aatch: just a random failure?
[04:11:24] <aatch> strcat, well it certainly wasn't related to the pull
[04:11:31] <strcat> Eridius: looks like your pull is finally going to land, the error prone windows bots passed \o/
[04:11:50] <aatch> it made LLVM rebuild and that caused issues for some reason.
[04:12:13] <strcat> guess it just needs to be @bors: retry'ed then
[04:12:26] *** Joins: reed (reed@tech.monkey)
[04:12:43] <aatch> and done
[04:12:48] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[04:13:03] * strcat hopes it lands
[04:13:55] <aatch> graydon, I just rebased this: https://github.com/mozilla/rust/pull/7182
[04:18:24] <Eridius> strcat: yay
[04:18:34] <Eridius> hmm, llvm explicitly returns nothing from --ldflags. That's.. unfortunate
[04:20:12] <aatch> Wow, auto-linux-64-opt gets through compile in 15mins
[04:22:43] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[04:23:05] *** Joins: brson (brson@5F06B402.AD1E507F.3688B332.IP)
[04:23:05] *** ChanServ sets mode: +o brson
[04:23:47] <strcat> aatch: and the longest one takes nearly 3 hours :(
[04:24:04] <aatch> strcat, yeah... auto-linux-64-nopt
[04:24:10] * strcat really wants to get jemalloc working again
[04:24:13] <aatch> not the valgrind one.
[04:24:20] <aatch> the not-optimized one
[04:24:29] * aatch facepalms
[04:24:32] <dbaupp> does it run all the tests?
[04:24:48] <strcat> now that I think about it, I don't think initially adding jemalloc caused stack canary failures
[04:24:55] <strcat> probably worth checking
[04:25:31] <strcat> could bisect whatever started causing the failures in combination with it, if that's the case
[04:25:39] <steven_is_false> I don't think it'd be smart to implement a concurrent hash table using a single task but would it make sense to implement a concurrent hash table using multiple tasks?
[04:25:43] <aatch> strcat, probably. You should look at the stuff brson reverted and start there
[04:26:09] <dbaupp> at this rate, it's gonna take > 3 days just to clear bors' queue
[04:26:09] <aatch> steven_is_false, if one task owned all the data, then it's fine
[04:26:12] <dbaupp> :(
[04:26:27] <strcat> aatch: well I might just build the commit from the pull where jemalloc was added
[04:26:36] <strcat> if make check is fine there, can bisect
[04:26:45] <aatch> dbaupp, at least bors kills all the bots if one fails
[04:26:52] *** Quits: enticeing (user@1983AA36.E4834407.EAAB5301.IP) (Client exited)
[04:26:59] <aatch> so we still get fail-fast
[04:27:07] <strcat> aatch: it doesn't kill all the bots if one fails
[04:27:09] <strcat> aatch: I do ;p
[04:27:12] <aatch> strcat, oh.
[04:27:33] <aatch> graydon, you should make bors do that ^^^
[04:28:08] <aatch> strcat, kinda hard to tell what with there only being one user
[04:28:53] <brendanc> graydon was trying to get me to teach buildbot how to do that. I might have a look tomorrow
[04:29:07] <strcat> hm
[04:29:08] <strcat> you know what
[04:29:24] <strcat> oh nvm
[04:29:55] <strcat> aatch: yep it's back down to 12 mins for me
[04:30:02] <strcat> building all the stages
[04:30:08] <strcat> it was up to like 20-30 :[
[04:30:21] * dbaupp wishes he had strcat's computer
[04:30:29] <strcat> dbaupp: a modern dual core laptop? ;p
[04:30:32] <strcat> ivy bridge <3
[04:30:39] <aatch> I wish I had my work computer at home
[04:30:41] <dbaupp> strcat: oh, well, I basically have the same
[04:30:50] <strcat> dbaupp: my desktop is nicer but it doesn't work atm :[
[04:31:04] <dbaupp> strcat: mine is ULV though... maybe that's it?
[04:31:15] <strcat> has an i7 overclocked to 5.2GHz because of the nice double 120mm fan heatsink :)
[04:31:17] <strcat> dbaupp: probably
[04:31:32] <aatch> repurposed mac-mini, quad core ivy bridge, 8GB RAM and the HDD swapped out for a SSD
[04:31:43] <dbaupp> strcat: maybe you should fix your desktop?
[04:31:50] <aatch> replacement for my busted laptop courtesy of my boss
[04:31:51] <strcat> dbaupp: needs a new mobo I think, really annoying
[04:32:00] <dbaupp> strcat: build rust in 5 minutes ;P
[04:32:03] <strcat> dbaupp: and they don't sell the one I bought anymore
[04:32:09] <dbaupp> oh :(
[04:32:20] <strcat> too late to RMA and I am not 100% sure what the problem is
[04:32:32] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[04:32:36] <strcat> it kernel panics within ~5 seconds to a few minutes from mem corruption
[04:32:45] * dbaupp wishes he had aatch's work computer
[04:32:58] <dbaupp> strcat: work faster? :P
[04:33:00] <strcat> I can't run memtest because it crashes
[04:33:03] <strcat> dbaupp: heh
[04:33:15] * strcat doesn't think it's bad memory
[04:33:20] <strcat> because I put different known good memory in it
[04:33:54] <aatch> bad mem controller would do it though
[04:34:08] <strcat> I suspect the network controller though
[04:34:19] <strcat> why? I don't really know.
[04:34:20] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[04:34:21] <strcat> it's just evil
[04:34:34] <strcat> there was a known problem they released a bios fix for
[04:34:47] * strcat has the fix though :|
[04:35:03] <strcat> and now it's past the point where they care about fixing stuff ;p
[04:35:15] <strcat> early SNB cpu/mobo
[04:35:22] <aatch> Eridius, looks like your thing's gonna land for sure now
[04:35:28] <aatch> modulo stupid errors
[04:36:11] <aatch> strcat, my desktop has an early AMD Phenom, it has a race condition that can cause lock-up.
[04:36:25] <steven_is_false> Is using hashing, or random number generation to distribute requests to threads a sensible idea?
[04:36:55] <steven_is_false> I was thinking of having multiple threads that one could read from, and that a thread would be picked at random to read from for a concurrent hash map implementation.
[04:37:21] <steven_is_false> Or possible based off a hash of the reading thread's id.
[04:37:55] *** Joins: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net)
[04:38:03] <steven_is_false> So there wouldn't be a single point of contention for reading.
[04:38:21] <strcat> steven_is_false: the simplest scheduler just randomly schedules stuff
[04:38:24] <strcat> so sure
[04:38:31] <strcat> afaik that's what rust's scheduler does atm
[04:38:48] * dbaupp is looking forward to the new rt
[04:38:54] <Eridius> aatch: yay
[04:39:00] <steven_is_false> strcat: I thought task::yield literally just does context.change(context->next_context)?
[04:39:12] *** Joins: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP)
[04:39:17] *** Quits: carllerche (carllerche@6B070D22.7E6A0813.1428D117.IP) (Quit: carllerche)
[04:39:24] <strcat> steven_is_false: dunno. gnu pth does that
[04:39:30] <steven_is_false> Is the actual scheduling part in a different part of the program?
[04:39:49] <steven_is_false> Can random number generation cause locking?
[04:40:01] <strcat> there's a task-local rng
[04:40:05] <aatch> steven_is_false, no, yeilding contexts switches back to the scheduler
[04:40:18] <aatch> which picks the next task to run.
[04:40:46] <dbaupp> (the scheduler actually has it's own internal RNG)
[04:41:03] <steven_is_false> Did the new scheduler written in Rust just land recently?!
[04:41:11] <aatch> steven_is_false, kinda
[04:41:15] <dbaupp> it's not activated
[04:41:17] <strcat> steven_is_false: it's not used by default
[04:41:22] <aatch> brson pushed all his work onto master
[04:41:56] <steven_is_false> I'm confused, I can't find the source code for the task scheduling anymore.
[04:42:53] <strcat> bors is going to take forever to clear out the PR queue now ;\
[04:43:04] <strcat> at best it can do 8 pulls a day
[04:43:13] <dbaupp> strcat: 3 days minimum :(
[04:43:23] <strcat> yeah and we will have 50 in 3 days ;\
[04:43:32] <dbaupp> yup
[04:43:37] <steven_is_false> Anyways, so my plan is to randomly distribute reads among the different backing tasks.
[04:43:54] <dbaupp> strcat: (and that's not including any failures)
[04:44:05] <steven_is_false> And then have writes write to all tasks at once synchronously (which would be expensive.)
[04:45:20] <steven_is_false> So the actual hash table handle type would be struct HashMap { tasks: ~[(comm::Port<Input>, comm::Chan<output>)] }
[04:46:20] <strcat> dbaupp: + more conflicts :(
[04:46:39] <strcat> anyway will have to change because it's not sustainable
[04:46:55] <dbaupp> maybe nopt shouldn't test?
[04:46:57] <strcat> unless we massively slow down development or make huge pull requests only
[04:47:25] <dbaupp> (or just run check-lite)
[04:47:28] * strcat is tempted to collect all the small PRs into one PR
[04:47:37] <strcat> cherry-pick
[04:47:38] <steven_is_false> I'm not sure how I'd optimize writing to a task based HashMap.
[04:47:42] <strcat> going to do that
[04:48:36] <brendanc> cmr didn't like my parallel auto idea. but with more buildslaves I think it could help
[04:50:21] <dbaupp> definitely... there's one builder that's running both nopt linux builds and the linux-all build (i.e. the slowest ones)
[04:53:16] <brendanc> I was thinking (if there was enough horsepower), run the pending pull requests in parallel on auto-nnn branches merged with master, then take all the passes and merge them together on auto. if that one fails, then you can just pop one of the successful auto-nnn runs into master and start again
[04:53:58] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[04:53:59] <brendanc> if the octopus merge generally works, you keep up pretty well
[04:54:24] <strcat> dbaupp: https://github.com/mozilla/rust/pull/7270 well this will help
[04:54:32] <strcat> I think there are 2-3 more
[04:54:33] <brendanc> if it fails, you're worse off. But in general I think you'd win
[04:54:54] <dbaupp> brendanc: oh, I see!
[04:55:03] <dbaupp> that sounds nice
[04:55:07] *** Quits: alisdair (textual@moz-EBE9F394.bchsia.telus.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[04:55:35] <strcat> git fetch + cherry-pick FETCH_HEAD <3
[04:55:50] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[04:56:05] <dbaupp> strcat: nice
[04:57:45] <strcat> I think that's all of them
[04:58:07] <strcat> oh nvm more
[05:01:58] *** Quits: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP) (Quit: Instantbird 1.4 -- http://www.instantbird.com)
[05:02:25] <strcat> dbaupp: oh well that turns 18 hours into 3 hours
[05:02:27] <strcat> :)
[05:02:37] <dbaupp> strcat: :D
[05:02:42] *** Joins: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com)
[05:03:19] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[05:04:08] <xenocons> just noticed the rust tutorial thing on catamorphism.org
[05:04:35] <Eridius> llvm builds too slowly :/
[05:04:54] <strcat> Eridius: make -j16 !
[05:05:03] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[05:05:03] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[05:05:05] <Eridius> strcat: on my laptop? hell no. -4 is enough
[05:05:16] <Eridius> I don't think I can go higher tahn 400% CPU usage
[05:05:24] <strcat> Eridius: lots is I/O
[05:05:30] <strcat> Eridius: I use batch scheduling for builds
[05:05:36] <strcat> dunno if OS X has that concept
[05:05:48] <Eridius> strcat: my CPU load is close enough to 100% of available CPU as makes no difference
[05:05:51] <Eridius> (4 cores)
[05:05:56] <Eridius> I don't know what batch scheduling is
[05:06:00] <mark_edward> :-(
[05:06:02] <aatch> Eridius, also, make has a flag that says "keep load at about x"
[05:06:07] <mark_edward> i wish i could help
[05:06:12] <strcat> Eridius: gives them really long time slices but lets them have terrible latency
[05:06:18] <Eridius> huh
[05:06:20] <mark_edward> my desktop is goign to be sitting in a closet for 2 months
[05:06:26] <strcat> Eridius: maybe only a linux kernel feature
[05:06:28] <strcat>   -b | --batch         set policy to SCHED_BATCH
[05:06:30] <strcat> with chrt
[05:06:31] <mark_edward> wish there was someway you guys could use it
[05:06:58] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[05:06:59] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[05:07:16] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[05:07:29] <strcat> Eridius: usually there's a global tradeoff of latency vs throughput in the scheduler design, so it's a nice little switch for getting the best of both depending on what a process needs
[05:07:46] *** Quits: kaeso (kaeso@moz-F21FF626.unstable.it) (Ping timeout)
[05:07:46] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[05:07:46] *** Quits: glandium (glandium@moz-A09032B1.kimsufi.com) (Ping timeout)
[05:07:46] *** Quits: alexrp (zor@moz-180BED6.rfw.name) (Ping timeout)
[05:07:49] *** Joins: alexrp (zor@moz-180BED6.rfw.name)
[05:07:51] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[05:07:54] *** Joins: glandium (glandium@moz-A09032B1.kimsufi.com)
[05:08:02] *** Quits: dju (dju@moz-83BD5EC.dmz.me) (Ping timeout)
[05:08:05] *** Joins: kaeso (kaeso@moz-F21FF626.unstable.it)
[05:08:13] *** Quits: vermeille (vermeille@moz-436628F6.net) (Ping timeout)
[05:08:14] *** Joins: jez0990 (quassel@moz-3BA8545E.kimsufi.com)
[05:08:24] *** Joins: vermeille (vermeille@moz-436628F6.net)
[05:09:29] *** Joins: dju (dju@moz-83BD5EC.dmz.me)
[05:10:19] <strcat> anyway, <3 SCHED_BATCH
[05:11:10] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: WeeChat 0.4.1)
[05:20:06] <IRCMonkey56359> strcat: SCHED_BATCH is pretty much like SCHED_IDLE, but with less inversion problems
[05:20:26] *** IRCMonkey56359 is now known as heftig
[05:20:36] <heftig> i am not a monkey.
[05:21:19] <aatch> heftig, that is exactly what a monkey WOULD say!
[05:22:11] <Eridius> hell yes, I think I finally figured out the magic incantation to get librustllvm linking against libstdc++
[05:22:37] <Eridius> sadly it requires a tweak to the llvm submodule, to get it to pass -stdlib=libstdc++ if the compiler is clang, but then rust will just pick up the -stdlib= flag from llvm's cxxflags (since it reports nothing for ldflags)
[05:22:43] *** Quits: lahwran (lahwran@lahwran.net) (Ping timeout)
[05:24:05] <aatch> hmm, interesting.
[05:24:18] <aatch> strcat, look at the time on this: http://buildbot.rust-lang.org/builders/auto-linux-64-nopt/builds/14
[05:25:14] <aatch> Ok, so something happened to the bots
[05:25:39] <aatch> 1hr 40mins for auto
[05:25:43] <dbaupp> Eridius: it passed!
[05:25:50] <Eridius> dbaupp: \o/
[05:26:15] <aatch> I know graydon was fiddling with the bots, maybe he managed to make them faster
[05:26:31] *** Joins: lahwran (lahwran@209.236.121.166)
[05:27:06] <dbaupp> http://buildbot.rust-lang.org/builders/auto-mac-64-nopt appears to be the slowest one now
[05:28:10] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:28:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/TdxxWQ
[05:28:10] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:28:21] <xenocons> spamming the tjc rust tutorial around work :)
[05:28:32] <brson> gj, bors
[05:28:32] <xenocons> 1 guy seems quite interested
[05:28:51] <aatch> hurray!
[05:29:01] <steven_is_false> So the build bots use obvious flags like --enable-ccache right?
[05:29:09] <Eridius> yay bors
[05:29:22] <aatch> steven_is_false, no idea
[05:29:37] <Eridius> hrm, I should probably install ccache
[05:29:40] <steven_is_false> aatch: Where's the build bot source?
[05:29:53] <aatch> steven_is_false, what do you mean?
[05:30:11] <steven_is_false> aatch: I was going to double check the configurations, and stuff.
[05:30:32] <dbaupp> steven_is_false: you'll have to talk to graydon
[05:30:52] <aatch> steven_is_false, we use http://buildbot.net/
[05:30:52] <strcat> steven_is_false: I don't think they rebuild LLVM
[05:30:57] <steven_is_false> dbaupp: okay
[05:31:06] <aatch> strcat, they don't, unless they have to
[05:31:07] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[05:31:07] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/K7H2Gw
[05:31:07] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[05:31:08] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[05:31:08] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/G1UZCQ
[05:31:08] <ghrust> 13rust/06auto 141a8969f 15Michael Sullivan: Get cross crate default methods working....
[05:31:08] <ghrust> 13rust/06auto 14ba05af7 15bors: auto merge of #7203 : msullivan/rust/default-methods, r=graydon...
[05:31:09] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[05:31:11] <brendanc> you can read the build logs for that kind of thing
[05:31:15] <steven_is_false> strcat: that makes sense
[05:31:16] *** Quits: heftig (heftig@moz-1D217FC8.dip0.t-ipconnect.de) (Ping timeout)
[05:31:18] <brson> I think the bots do use ccache
[05:31:30] <aatch> Hopefully that passes this time
[05:31:44] <strcat> brson: doesn't support rust though :)
[05:31:50] <brson> no
[05:31:54] <steven_is_false> For what's it worth I personally didn't see much improvement with ccache anyways.
[05:32:23] <brendanc> eg http://buildbot.rust-lang.org/builders/auto-mac-all-opt/builds/16/steps/configure/logs/stdio the top (blue lines) show the environment and the configure args
[05:33:08] <steven_is_false> Would it be possible to do some virtual filesystem magic in the style of tup (an awesome make replacement) to make a generic ccache?
[05:34:05] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[05:34:24] <brendanc> don't see any evidence of ccache in the configure run
[05:34:40] <strcat> steven_is_false: if you have lots of files + incremental compilation, it's already pretty pointless
[05:35:22] *** Joins: heftig (heftig@moz-5E306FE6.dip0.t-ipconnect.de)
[05:35:47] <jld> LLVM uses the host's `unsigned int` for array sizes?  Well, so much for having a char[5000000000] compiled on a 32-bit host.
[05:35:49] <steven_is_false> strcat: incremental recompilation is still being worked on though but okay
[05:35:56] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[05:36:14] <aatch> jld, why.. what.. huh?
[05:37:14] <jld> aatch: I mean, I'm not entirely sure why one would do that, but I thought LLVM was careful about not using the host's types for the target's sizes.
[05:37:38] <aatch> jld, oh.
[05:37:53] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[05:37:53] <Eridius> wtf. I got librustllvm linking against libstdc++, but librustrt is still linking against libc++??
[05:40:39] *** Joins: pyrac (pyrac@moz-DAB0A516.w109-222.abo.wanadoo.fr)
[05:41:42] <strcat> Eridius: the runtime still has a lot of C/C++
[05:41:47] <strcat> src/rt
[05:42:52] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[05:44:42] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[05:45:32] <dbaupp> there is *so* much noise in the buildbot times :(
[05:46:54] <jld> ...and yet I can get 32-bit clang to emit [5000000000 x i8].
[05:47:03] *** Quits: anri (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net) (Quit: anri)
[05:48:05] *** Parts: steven_is_false (user@moz-144077DE.bchsia.telus.net) (ERC Version 5.3 (IRC client for Emacs))
[05:48:37] *** Joins: sankha93 (Instantbir@955BA158.B862774B.8B6C1D65.IP)
[05:48:53] <jld> Oh.  ArrayType::get  takes a uint64_t.
[05:49:04] <strcat> and it's C so it doesn't care about it being wrong
[05:49:26] <strcat> jld: what does it do if you compile it? ;\
[05:49:45] <jld> It looks like the `unsigned` is just in the llvm-c wrapper.
[05:49:52] *** Quits: kornholi (kornholi@moz-185F17B0.net) (Ping timeout)
[05:50:27] <strcat> ==23357== Warning: client switching stacks?  SP change: 0x7fefffc40 --> 0xfffffe35fefffc40
[05:50:29] <strcat> ==23357==          to suppress, use: --max-stackframe=2001454759936 or greater
[05:50:31] <strcat> ==23357== Warning: client switching stacks?  SP change: 0xfffffe35fefffc40 --> 0x7fefffc40
[05:50:33] <strcat> ==23357==          to suppress, use: --max-stackframe=2001454759936 or greater
[05:50:35] *** Quits: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net) (Ping timeout)
[05:50:35] <strcat> huh
[05:50:37] <strcat> that's from compiling
[05:50:39] <strcat> int main() {
[05:50:41] <strcat>     int a[500000000000];
[05:50:42] <jld> strcat: I just declared a huge array as an extern.
[05:50:43] <strcat>     int b = 5;
[05:50:45] <strcat>     return 0;
[05:50:47] <strcat> }
[05:50:56] <brson> strcat: there's a suppressions file in etc that should make valgrind not do that
[05:51:02] <strcat> brson: I mean C :)
[05:51:21] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[05:51:27] <brson> strcat: oh
[05:51:32] <jld> strcat: Uh... if this is Linux/amd64, how is Valgrind seeing stack pointers in the upper half?
[05:51:34] *** Joins: kornholi (kornholi@moz-185F17B0.net)
[05:51:51] <strcat> jld: yeah it's linux/amd64 and I don't know ;p
[05:52:00] <jld> Oh, wait.
[05:52:13] * strcat adds more zeroes
[05:52:29] <jld> It actually subtracts 500000000000 == 746A528800 from 7fefffc40.
[05:52:44] <strcat> ah yeah because stacks fill from the end
[05:53:17] <jld> There should be a fascinating explosion if it gets a signal in that state.
[05:53:31] <jld> Er, a signal with a handler.
[05:53:38] * strcat can arrange that
[05:55:00] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[05:55:25] <strcat> zsh: bus error  ./a.out
[05:55:26] <strcat> hrm
[05:55:32] <dbaupp> heh, `int a[1ull << 60];` doesn't trigger any warnings (with clang or valgrind) and it doesn't crash either
[05:55:38] <strcat> zsh: segmentation fault  ./a.out
[05:55:53] <strcat> ==23917== Invalid write of size 8
[05:55:55] <jld> I think that if you use sigaltstack (and control the code generation) you can safely put arbitrary bits in %esp/%rsp.
[05:55:55] <strcat> ==23917==    at 0x4A246B0: _vgnU_freeres (in /usr/lib/valgrind/vgpreload_core-amd64-linux.so)
[05:55:57] <strcat> ==23917==  Address 0xffffffd96e122b90 is not stack'd, malloc'd or (recently) free'd
[05:56:08] <strcat> I think I broke valgrind?
[05:56:10] <strcat> :p
[05:56:38] <dbaupp> strcat: valgrinding valgrind?
[05:56:41] <strcat> ==23981== Invalid write of size 8
[05:56:41] <jld> strcat: There may also be something in dmesg.
[05:56:43] <strcat> ==23981==    at 0x4005C2: main (in /home/strcat/a.out)
[05:56:44] <strcat> ==23981==  Address 0x7fefffba0 is on thread 1's stack
[05:56:50] <strcat> [33956.416376] traps: a.out[23788] trap stack segment ip:4005ea sp:ffb9721af7e9a4e0 error:0
[05:57:14] <strcat> [33971.769138] a.out[23845]: segfault at ffffca191c3a06a8 ip 00000000004005ea sp ffffca191c3a06b0 error 7 in a.out[400000+1000]
[05:57:16] <strcat> etc.
[05:57:43] <jld> Out of increasingly frivolous curiousity, what's the instruction at the reported ip?
[05:57:58] <strcat> as in addr2line?
[05:58:12] <jld> As in objdump -dr
[05:58:15] <strcat> oh
[05:58:33] *** Quits: ssalbiz (ssalbiz@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[05:58:33] *** Quits: mcpherrin (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca) (Ping timeout)
[05:58:33] *** Quits: jpf (jan@moz-A8C26A15.org) (Ping timeout)
[05:58:33] *** Quits: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[05:58:35] *** Joins: jpf (jan@moz-A8C26A15.org)
[05:58:42] *** Quits: cjh (chellmuth@moz-45C21C42.compute-1.amazonaws.com) (Ping timeout)
[05:58:47] <strcat>   4005ea:e8 71 fe ff ff       callq  400460 <sigaction@plt>
[05:58:53] <strcat> it died trying to set up
[05:58:54] *** Quits: Voomer (Voomer@moz-E97E8EB7.br.br.cox.net) (Connection reset by peer)
[05:58:56] *** Quits: nonehaxor (nonehaxor@BA9CBAE.4C3B0355.EE6E63A5.IP) (Ping timeout)
[05:59:05] *** Quits: indutny (indutny@moz-49D42D15.c.ircrelay.com) (Ping timeout)
[05:59:05] *** Quits: kemurphy (kemurphy@moz-7332FD74.hsd1.pa.comcast.net) (Ping timeout)
[05:59:05] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[05:59:05] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[05:59:05] *** Quits: strmpnk (strmpnk@moz-49D42D15.c.ircrelay.com) (Ping timeout)
[05:59:05] *** Quits: ircloggr (nodebot@moz-218B8E8E.compute-1.amazonaws.com) (Ping timeout)
[05:59:05] *** Quits: erick (erick@E1304535.2A7189BF.BE19388.IP) (Ping timeout)
[05:59:05] *** Quits: sfackler (sfackler@moz-316FE70F.compute-1.amazonaws.com) (Ping timeout)
[05:59:05] <strcat> I need to put the big array in a function I guess
[05:59:06] *** Quits: chandler (foo@moz-F990611.mastenbrook.net) (Ping timeout)
[05:59:06] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[05:59:06] *** Quits: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca) (Ping timeout)
[05:59:06] *** Quits: MX80 (MX80@moz-32BE33CD.dsl.g3telecom.net) (Ping timeout)
[05:59:06] *** Joins: nonehaxor (nonehaxor@BA9CBAE.4C3B0355.EE6E63A5.IP)
[05:59:07] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[05:59:09] *** Quits: dolphinling (andrew@moz-80A1E448.uvm.edu) (Ping timeout)
[05:59:10] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[05:59:13] *** Joins: ircloggr (nodebot@moz-218B8E8E.compute-1.amazonaws.com)
[05:59:13] *** Joins: strmpnk (strmpnk@moz-49D42D15.c.ircrelay.com)
[05:59:15] *** Quits: decoder (quassel@moz-D7023D7D.own-hero.net) (Ping timeout)
[05:59:16] *** Joins: cjh (chellmuth@moz-45C21C42.compute-1.amazonaws.com)
[05:59:23] *** Joins: sfackler (sfackler@moz-316FE70F.compute-1.amazonaws.com)
[05:59:23] *** Joins: jhark (jhark@moz-B9920504.jhark.net)
[05:59:23] *** Quits: reyre (rick@B2D8AB09.33EE9F8A.1139E686.IP) (Ping timeout)
[05:59:27] *** Joins: erick (erick@E1304535.2A7189BF.BE19388.IP)
[05:59:50] *** Joins: MX80 (MX80@moz-32BE33CD.dsl.g3telecom.net)
[05:59:55] <strcat> ugh...
[05:59:55] *** Quits: n0vember (n0vember@moz-690FFF9D.org) (Ping timeout)
[06:00:08] *** Quits: acrichto (acrichto@moz-B63D64BD.res.cmu.edu) (Ping timeout)
[06:00:11] <aatch> Yay! sully's commit builds on windows!
[06:00:11] <strcat> pause() uses stack ;p
[06:00:14] *** Joins: acrichto (acrichto@moz-B63D64BD.res.cmu.edu)
[06:00:14] *** Joins: dolphinling (andrew@moz-80A1E448.uvm.edu)
[06:00:15] *** Joins: reyre (rick@B2D8AB09.33EE9F8A.1139E686.IP)
[06:00:16] * strcat uses for (;;) {} instead
[06:00:20] *** Joins: decoder (quassel@moz-D7023D7D.own-hero.net)
[06:00:25] *** Quits: michaelgreene (michael@DA820AA2.17CD9887.F12515B4.IP) (Ping timeout)
[06:00:25] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Ping timeout)
[06:00:34] *** Joins: kemurphy (kemurphy@moz-7332FD74.hsd1.pa.comcast.net)
[06:00:35] <strcat> [34227.660004] traps: a.out[24267] trap stack segment ip:4005b6 sp:ffb9721a31b73e70 error:0
[06:00:38] *** Joins: michaelgreene (michael@DA820AA2.17CD9887.F12515B4.IP)
[06:00:41] *** Joins: pauls (pauls@moz-BFEF1F22.ccs.neu.edu)
[06:00:41] *** Joins: n0vember (n0vember@moz-690FFF9D.org)
[06:00:43] *** Joins: indutny (indutny@moz-49D42D15.c.ircrelay.com)
[06:00:57] <strcat> jld: it's not in objdump ;\
[06:01:09] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[06:01:16] <strcat> jld: http://ix.io/6iG
[06:01:18] * strcat shrugs
[06:01:43] <strcat> it succeeds at looping forever and segfaults when it gets a signal though
[06:04:30] *** Joins: chandler (foo@moz-F990611.mastenbrook.net)
[06:04:34] <jld> strcat: For what it's worth, that might not be the current a.out; compare /proc/uptime to the timestamp.
[06:04:37] *** Joins: ssalbiz (ssalbiz@moz-DCEF6040.csclub.uwaterloo.ca)
[06:04:38] *** Joins: mcpherrin (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca)
[06:04:41] * jld uh might have gotten confused the same way.
[06:04:42] *** Joins: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca)
[06:05:05] <strcat> jld: ah it's not logging these segfaults in dmesg
[06:05:10] *** Joins: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca)
[06:05:23] * strcat wonders why
[06:05:55] <jld> Well, the kernel has to push some stuff to the stack before it can call the signal handler.  And that probably fails by some kernel function returning -EFAULT.
[06:06:02] <jld> It's sort of the userlevel version of a double fault.
[06:06:37] <jld> I was hoping there'd be, like, a special message for managing to break things that much. (-:
[06:07:08] <strcat> ugh rusti still makes an error get logged for everything it evals
[06:07:13] <strcat> as in the bot
[06:07:20] <strcat> [  168.472997] cgroup: playpen (693) created nested cgroup for controller "memory" which has incomplete hierarchy support. Nested cgroups may change behavior in the future.
[06:07:22] <strcat> [  168.473002] cgroup: "memory" requires setting use_hierarchy to 1 on the root.
[06:07:34] * strcat doesn't really understand what it wants because trying to set use_hierarchy to 1 doesn't do anything
[06:07:51] <strcat> rusti: 2
[06:07:52] -rusti- 2
[06:08:05] <strcat> oh nvm it only logs an error when it makes the playpen cgroup
[06:08:14] <strcat> not the sub-cgroups for actual runs
[06:08:25] <strcat> even more mysterious.
[06:08:43] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[06:10:41] *** Joins: Blei (philipp@moz-96D25F7A.cust.bluewin.ch)
[06:12:28] *** Quits: Blei (philipp@moz-96D25F7A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[06:12:38] *** Joins: berak (chatzilla@3B7BA672.5291F4C0.16E13E53.IP)
[06:14:17] *** Joins: Blei (philipp@moz-650B9C6A.cust.bluewin.ch)
[06:15:58] *** Joins: nano (nano@moz-972880B.superkabel.de)
[06:17:01] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Ping timeout)
[06:18:09] <bblum> strcat: i am not sure why poisoning the RWARC is needed for soundness
[06:18:32] <bblum> i just chose to do that for... linked failure consistency
[06:18:44] <bblum> like, sharing an arc among threads implicitly links their failure together :P
[06:18:46] <strcat> bblum: because we have code depending on failure making memory unusable like vec::consume
[06:19:03] <bblum> hm well
[06:19:11] <bblum> you can't consume a vector that's in an RWARC!
[06:19:20] <strcat> true because you can't move out
[06:19:28] <bblum> vec::consume only needs to worry about local safety because the vector is on vec::consume's stack frame
[06:19:32] * strcat tries to think of something else ;p
[06:19:34] *** Joins: ramige (ramige@moz-28AD658E.dynamic.ip.windstream.net)
[06:19:36] <bblum> not, say, in an rwarc
[06:19:46] <strcat> bblum: yeah that makes sense
[06:19:56] <strcat> there's probably something doing the same trick with &mut though
[06:19:56] *** Quits: roo (Mibbit@moz-DE5F47DB.dynamic.ip.windstream.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:19:57] <bblum> i would like to hear of any case where poisoning the RWARC is necessary, but my bet is that it's not
[06:19:59] <brson> what's the best way to move T out of ~T?
[06:20:07] <strcat> brson: let ~x = y;
[06:20:19] <strcat> for some reason let x = *y; doesn't work
[06:20:31] <strcat> brson: err, but it's possible let only works because let is unsound
[06:20:38] <strcat> I'd try match first to make sure it's not that...
[06:20:47] <bblum> in the past, let ~x = y used to cause a linearity violation
[06:20:50] <bblum> would run the destructor twice
[06:20:52] <dbaupp> rusti: struct A; let x = ~A; let y = *x;
[06:20:53] -rusti- ()
[06:20:58] <dbaupp> bblum: still does
[06:21:11] <dbaupp> rusti: struct A; let x = ~A; let y = *x; let z = *x;
[06:21:11] *** Quits: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[06:21:12] -rusti- ()
[06:21:26] <bblum> rusti: extern mod extra; use extra::arc; let x = ~arc::ARC(()); let y = ~x;
[06:21:27] -rusti- <anon>:10:9: 10:26 error: "extern mod" declarations are not allowed here
[06:21:27] -rusti- <anon>:10          extern mod extra; use extra::arc; let x = ~arc::ARC(()); let y = ~x;
[06:21:27] -rusti-                    ^~~~~~~~~~~~~~~~~
[06:21:27] -rusti- error: aborting due to previous error
[06:21:27] -rusti- application terminated with error code 101
[06:21:31] <strcat> dbaupp: that's copying though
[06:21:33] <bblum> uh,
[06:21:37] <bblum> rusti: use extra::arc; let x = ~arc::ARC(()); let y = ~x;
[06:21:38] -rusti- ()
[06:21:44] <bblum> there, it's sound
[06:21:46] <dbaupp> strcat: I thought implicit copying was off?
[06:21:46] <bblum> that used to die
[06:21:58] <strcat> bblum: no, ~ just apparently zeroes in glue_drop
[06:22:08] <dbaupp> rusti: use extra::arc; let x = ~arc::ARC(()); let ~y = x;
[06:22:12] <strcat> dbaupp: there's still implicit copying 
[06:22:13] *** Parts: berak (chatzilla@3B7BA672.5291F4C0.16E13E53.IP) ()
[06:22:14] -rusti- rust: task failed at 'assertion failed: new_count >= 0', /build/rust-git/src/rust/src/libstd/unstable/sync.rs:83
[06:22:14] -rusti- timeout triggered!
[06:22:25] <bblum> strcat: good, that's what it should do
[06:22:41] <dbaupp> strcat: oh, right that was for Copy generics
[06:23:06] <strcat> bblum: I don't think so - it should zero in moves and never call glue_drop twice when it hasn't moved
[06:23:07] <dbaupp> rusti: struct A; impl Drop for A {fn finalize(&self){}} let x = ~A; let y = *x; let z = *x;
[06:23:09] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/ZDdP
[06:23:19] *** Quits: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net) (Ping timeout)
[06:23:29] <strcat> rusti: use extra::arc; let x = ~arc::ARC(()); let &y = &x;
[06:23:34] -rusti- rust: task failed at 'assertion failed: new_count >= 0', /build/rust-git/src/rust/src/libstd/unstable/sync.rs:83
[06:23:34] -rusti- timeout triggered!
[06:23:43] <strcat> rusti: use extra::arc; let x = ~arc::ARC(()); let &y = &*x;
[06:23:48] -rusti- rust: task failed at 'assertion failed: new_count >= 0', /build/rust-git/src/rust/src/libstd/unstable/sync.rs:83
[06:23:48] -rusti- timeout triggered!
[06:24:42] <strcat> rusti: struct Foo { x: int } impl Drop for Foo { fn finalize(&self) { println("drop") } } let a = Foo { x: 5 }; let &oops = &a;
[06:24:43] -rusti- drop
[06:24:44] -rusti- drop
[06:24:44] -rusti- ()
[06:24:48] <strcat> bblum: ^
[06:24:59] <bblum> oops indeed
[06:25:06] <Eridius> ok wtf, I got librustrt compiling with libstdc++ but task failure still doesn't work, I still get "libc++abi.dylib: terminating with uncaught exception of type rust_task*"
[06:25:25] <strcat> rusti: struct Foo { x: int } impl Drop for Foo { fn finalize(&self) { println("drop") } } let a = Foo { x: 5 }; let @oops = @a;
[06:25:26] -rusti- drop
[06:25:26] -rusti- drop
[06:25:26] -rusti- ()
[06:25:50] <strcat> hrm
[06:26:07] <strcat> rusti: struct Foo { x: int } impl Drop for Foo { fn finalize(&self) { println("drop") } } let a = Foo { x: 5 }; let (oop, ) = (a,);
[06:26:08] -rusti- drop
[06:26:08] -rusti- ()
[06:26:26] <strcat> rusti: struct Foo { x: int } impl Drop for Foo { fn finalize(&self) { println("drop") } } let a = Foo { x: 5 }; let (oops,) = (a,); let (oops,) = (a,);
[06:26:27] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/STSB
[06:26:38] <strcat> I wonder why & and @ get around it
[06:26:50] <dbaupp> rusti: struct Foo { x: int } impl Drop for Foo { fn finalize(&self) { println("drop") } } let a = Foo { x: 5 }; let ~oops = ~a;
[06:26:56] <strcat> rusti: struct Foo { x: int } impl Drop for Foo { fn finalize(&self) { println("drop") } } let a = Foo { x: 5 }; let ~oops = ~a; let ~oops = ~a;
[06:27:06] <strcat> .
[06:27:16] <dbaupp> :( we killed it?
[06:27:22] <strcat> no I think it got dc'ed
[06:27:24] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[06:27:34] <strcat> dbaupp: dunno
[06:27:42] <dbaupp> supposedly niko has a branch that fixes irrefutable patterns
[06:27:48] *** Joins: rusti (rusti@4FEAAB95.65F27C5.9334D275.IP)
[06:27:51] <strcat> dbaupp: I think he fixed ref
[06:27:54] <strcat> rusti: struct Foo { x: int } impl Drop for Foo { fn finalize(&self) { println("drop") } } let a = Foo { x: 5 }; let ~oops = ~a; let ~oops = ~a;
[06:27:55] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/bQUD
[06:28:07] <strcat> bblum: ah nvm ~ drop doesn't zero
[06:28:15] <strcat> bblum: it's just that ~ became sound in irrefutable patterns
[06:28:18] <strcat> & and @ didn't :)
[06:28:20] *** Quits: nano (nano@moz-972880B.superkabel.de) (Connection reset by peer)
[06:28:22] <dbaupp> rusti: struct Foo { x: int } impl Drop for Foo { fn finalize(&self) { println("drop") } } let a = Foo { x: 5 }; let ~oops = ~a;
[06:28:23] -rusti- drop
[06:28:23] -rusti- drop
[06:28:24] -rusti- ()
[06:28:29] <strcat> uh wat
[06:28:51] <strcat> it considers it moved though? ;\
[06:29:13] <Luqman> strcat: dbaupp niko's fix is not yet merged
[06:29:22] <dbaupp> Luqman: yup
[06:30:10] <aatch> In other news, default methods soon!
[06:30:31] <brson> implementing mutable static variables would be a really super project for an aspiring compiler hacker
[06:30:31] <aatch> soon being about an hour
[06:30:51] <brson> it would remove a bunch of C++ runtime glue
[06:31:24] <aatch> brson, I guess I don't count as "aspiring" anymore, heh
[06:31:36] <eevee> in light of #3794, how do i explicitly get a &T from a ~T where T is a trait?
[06:31:42] <Luqman> brson: i thought we had those
[06:31:54] <aatch> Luqman, not mutable
[06:31:54] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[06:32:04] <brson> https://github.com/mozilla/rust/issues/553
[06:32:12] <Luqman> aatch: oh nvm, i'm thinking of extern statics
[06:32:56] <dbaupp> eevee: it's possibly not possible
[06:33:43] *** Joins: Voomer (Voomer@moz-E97E8EB7.br.br.cox.net)
[06:35:01] <eevee> that would be unfortunate
[06:36:30] <graydon> brendanc: the bots use ccache
[06:36:45] *** Joins: mdz8292 (mitch@moz-CF8BEBEF.dia.static.qwest.net)
[06:36:46] <brendanc> hmm, how is it set up that it's invisible in the logs?
[06:36:55] <graydon> gcc and friends are symlinks
[06:36:59] <brendanc> oh
[06:37:16] <graydon> /usr/local/bin/gcc etc
[06:37:29] <graydon> also: configure: CFG_CCACHE           := /usr/local/bin/ccache (ccache version 3.1.8)
[06:37:29] <brendanc> looked at the kill whole buildset thing, looks like the nice way to do it is to create a new status object
[06:37:37] <graydon> ok
[06:37:44] <graydon> oh, and it kills off the builds?
[06:37:45] <graydon> clever
[06:37:58] <brendanc> well, someone has to write it. I'll try tomorrow if I have the time
[06:38:02] <brendanc> but it should be pretty short
[06:38:37] *** Quits: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net) (Quit: eholk)
[06:38:45] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[06:38:47] <graydon> ok. I don't mean to burden you; I will dig into that tomorrow if you have, y'know, a job or something to attend to :)
[06:38:51] <graydon> (this is in fact mine!)
[06:39:05] <brendanc> lucky :)
[06:39:13] <graydon> I know!
[06:39:18] <graydon> am I reading correctly that 20:41 -> 22:28 was the most recent cycle time?
[06:39:32] <brendanc> btw in scrollback you might see a scheme I had for parallelizing bors
[06:39:43] <graydon> if so that's ... better than I'd feared. 1:45?
[06:39:48] <graydon> reading back...
[06:39:53] <aatch> graydon, yep
[06:39:58] <aatch> down from ~3hrs
[06:40:03] <brendanc> probably doesn't make sense while build power is short, but might be nice if you get some more cpu/ram
[06:40:16] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[06:40:25] <brendanc> and I've since thought of some tweaks to make its worst case better
[06:40:26] <strcat> graydon: I cancelled all the builds from the last failed one, I think that's why it was taking 3 hours before
[06:40:48] <graydon> strcat: yeah. I think if we can get it spread over machines properly and not doing redundant builds, we might be able to keep it in the 1.5h range
[06:40:55] <graydon> which is still 3x worse than it was before, granted
[06:40:58] <graydon> and worryingly long
[06:41:19] <brendanc> I was thinking (if there was enough horsepower), run the pending pull requests in parallel on auto-nnn branches merged with master, then take all the passes and merge them together on auto. if that one fails, then you can just pop one of the successful auto-nnn runs into master and start again
[06:41:22] <graydon> brendanc: it's not so much absence of build horsepower as absence of ability to script it reliably. the logic is remarkably hard to get right.
[06:41:24] <brendanc> [9:51pm] brendanc: if the octopus merge generally works, you keep up pretty well
[06:41:35] <graydon> yeah, I saw that bit
[06:41:51] <brendanc> you can tweak it a bit to immediately merge the first successful auto-nnn into master
[06:44:21] <graydon> it's possible. I found it quite challenging to script bors in a way that it would do-no-wrong and be idempotent / reliable in the face of wonky servers, builders, changesets, etc.
[06:44:37] <strcat> graydon: it got stuck again earlier ;p
[06:44:38] <graydon> I feel like it'd be many times harder to come up with a variant that did more-complex batching
[06:44:42] <strcat> had to close/reopen a PR
[06:45:03] <graydon> hm. keep an eye on that. if it happens repeatedly I might try rolling back the sqlite "upgrade" or something.
[06:45:07] <graydon> stuck-bot is sad times
[06:45:07] <strcat> the one it was "testing", but I guess buildbot never informed it one failed
[06:45:21] <brendanc> aw, I thought we'd cured stuck bot
[06:45:23] <strcat> graydon: don't think it was related to that
[06:45:23] * graydon hopes we're not back to the bad times of lost sql alchemy transactions
[06:45:27] <graydon> ok
[06:45:31] * strcat has seen it happen previously
[06:45:57] *** Quits: sankha93 (Instantbir@955BA158.B862774B.8B6C1D65.IP) (Ping timeout)
[06:46:03] <strcat> at least buildbot doesn't seem to build the wrong thing anymore :)
[06:46:10] <strcat> or maybe I just haven't noticed
[06:46:18] <dbaupp> the linux builds seem to timeout occasionally too http://buildbot.rust-lang.org/builders/master-linux/builds/127
[06:46:29] *** Joins: fabiand (fabiand@moz-9067042C.adsl.alicedsl.de)
[06:46:47] <brendanc> I haven't thought super hard about that scheme but it seems fairly simple to me. might be worth thinking harder about if the pending queue starts getting long :)
[06:48:52] <strcat> rusti: ~[1, ..1000000]
[06:48:58] -rusti- line longer than 10000 characters, bailing out
[06:49:02] <strcat> rusti: ~[1, ..100000000];
[06:49:03] -rusti- application terminated abnormally with signal 9 (Killed)
[06:49:33] <bblum> rusti: ~[0, ..100000000];
[06:49:34] -rusti- application terminated abnormally with signal 9 (Killed)
[06:49:36] <graydon> brendanc: so you'd wind up with (say) branches called auto-1 through auto-8, and 8x as many builders?
[06:49:41] * strcat likes looking at those oom messages too much
[06:49:43] <bblum> shoot, i was hoping it would auto-zero on that one
[06:49:45] <strcat> [37183.101498] Task in /playpen/26025 killed as a result of limit of /playpen/26025
[06:49:48] <strcat> [37183.101501] memory: usage 131072kB, limit 131072kB, failcnt 25
[06:49:49] <brendanc> graydon: yeah
[06:50:03] *** Quits: mdz8292 (mitch@moz-CF8BEBEF.dia.static.qwest.net) (Ping timeout)
[06:50:16] *** Joins: Palmik (palmik@moz-5CA3F354.pks.muni.cz)
[06:50:16] <strcat> bblum: mmap actually auto-zeroes lazily, but I don't think rust is smart enough to use calloc and take advantage :(
[06:50:34] <strcat> perhaps llvm can do it if it could see the malloc call
[06:50:34] <brendanc> (or the builders are allowed to run concurrent jobs)
[06:50:53] <graydon> brendanc: oh, can they do that? I guess so. huh.
[06:51:01] <brendanc> sure
[06:51:02] <bblum> strcat: it would have to fault trying to read it to print it out at least
[06:51:08] <graydon> I have no idea what the display would look like
[06:51:26] <graydon> I currently put segregate columns by branch
[06:51:31] <graydon> s/put//
[06:51:34] * strcat should forbid it from using swap
[06:52:05] <brendanc> yeah, it's a bit harder to read the waterfall when concurrent jobs are running
[06:52:08] <strcat> or maybe I can't do that ;p
[06:52:24] <brendanc> tradeoff versus having tons of columns
[06:52:32] <strcat> # CONFIG_MEMCG_SWAP_ENABLED is not set
[06:52:34] <strcat> nooooooo
[06:52:47] * strcat isn't going to start compiling kernels for that
[06:53:07] <brendanc> IIRC the watefall page generator is enormous, partly for this problem
[06:53:29] <strcat> 'Memory Resource Controller Swap Extension comes with its price in a bigger memory consumption.' uh, nvm that's why it's off by default
[06:53:43] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[06:54:32] <strcat> bblum: and it might use huge pages if it's really big, I'm not sure
[06:55:45] <strcat> mmap has cool stuff on linux ;p
[07:01:50] *** Quits: dcoates (dcoates@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[07:02:10] *** Quits: devbug (quassel@moz-E1DE087C.bchsia.telus.net) (Client exited)
[07:04:50] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[07:06:26] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[07:08:13] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[07:08:31] *** Joins: tristram (tristram@moz-C498CC41.eu)
[07:08:31] *** Joins: keruspe (keruspe@moz-F2539FEC.imagination-land.org)
[07:11:48] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[07:12:03] <strcat> rusti: 2
[07:12:04] -rusti- 2
[07:14:10] *** Quits: pyrac (pyrac@moz-DAB0A516.w109-222.abo.wanadoo.fr) (Quit: pyrac)
[07:17:17] <strcat> setting up a loopback interface is a huge pain :(
[07:17:20] <graydon> I wonder if a nice(r) way to batch changes would be to have manually merged (and manually reconciled) staging branches that we gather up a bunch of PRs into, and then submit as a unit.
[07:17:48] <graydon> strcat collecting together all the pending doc changes was cute. I'm wondering if there's a way to do that more-regularly.
[07:18:29] <brson> graydon: do you have a repo history from before the public repo was made?
[07:18:33] <graydon> maybe a batch=<symbolicname> modifier, wherein bors merges _all_ the ones marked with a given symbolic name when one of them comes to the head of the queue
[07:19:01] <graydon> then you could put "batch=doc" on all the ones you're pretty sure are just doc changes that will merge cleanly with one another
[07:19:05] <graydon> brson: um, kinda
[07:19:08] <graydon> brson: why?
[07:19:21] <strcat> graydon: that'd be cool
[07:19:22] <brson> graydon: I'd like it
[07:19:31] <strcat> it's somewhat annoying to fetch + cherry-pick FETCH_HEAD for them all
[07:19:32] <brson> for posterity
[07:19:43] <strcat> if only github put a link to the repo+branch on a PR
[07:20:08] <graydon> brson: I have a monotone database which I started this lineage in, then a mercurial repo that I converted that to and carried on from, then I think I either restarted by copying into git or maybe converted
[07:20:16] <graydon> and at some point I refounded that
[07:20:54] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[07:21:07] <dbaupp> strcat: only mac-all-opt left until default methods!
[07:21:10] * strcat wishes systemd was MIT/BSD-licensed
[07:21:22] <strcat> so much useful code I want to steal :(
[07:21:36] <graydon> jun 16 2010 is the origin of the current lineage by the look of it
[07:21:41] <graydon> or the lineage I have marked as "historical"
[07:22:17] <graydon> then uh .. 06-07-23 02:21:28 PM is the origin of the lineage I have marked as "ancient"
[07:22:24] <brson> that's the same date as the git commit but you did a big code dump in d6b7c96c3eb29b9244ece0c046d3f372ff432d04
[07:22:28] <strcat> my vector pull is sure to fail, I should probably push it to try
[07:22:47] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[07:22:59] <graydon> the monotone database goes until 07-11-15 10:42:27 AM
[07:23:34] <strcat> heh it already broke
[07:23:45] *** Quits: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP) (Ping timeout)
[07:23:52] <brson> graydon: maybe you could share them sometime
[07:24:24] <graydon> Sat Jan 26 17:30:48 2008 -0800 is the origin of the hg repo marked merely "old"
[07:24:36] <graydon> and it runs till ...
[07:24:36] <graydon> Wed Dec 16 12:43:01 2009 -0800
[07:25:13] <graydon> Wed Dec 16 14:03:47 2009 -0800 starts the one marked 'dev'
[07:25:23] <graydon> and that runs until .. the jun 2010 git founding
[07:25:24] <graydon> so yeah
[07:26:03] <graydon> looks like I have pretty good records, but there's a gap from nov 2007 til jan 2008
[07:26:14] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[07:26:15] *** Joins: rubber-duck (rubber-duc@moz-9BB75FBE.dsl.iskon.hr)
[07:26:18] <graydon> but um, actually, knowing how things were in my life back then I suspect I just didn't commit anything over that time period
[07:26:39] <graydon> very grumpy winter
[07:26:42] <rubber-duck> are '<->' '<-' tokens actually used in rust or is it legacy in parser ?
[07:26:53] <strcat> legacy (swap and move)
[07:27:03] <brson> everything's great now though
[07:27:21] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[07:27:21] <ghrust> 01[13rust01] 15thestinger 04force-pushed 06try from 14a036f46 to 1406bec77: 02http://git.io/k471pw
[07:27:21] <ghrust> 13rust/06try 1462dc4e0 15Daniel Micay: vec: remove each_const...
[07:27:21] <ghrust> 13rust/06try 14cbad1da 15Daniel Micay: vec: remove eachi...
[07:27:21] <ghrust> 13rust/06try 1449c7452 15Daniel Micay: vec: rm old_iter implementations, except BaseIter...
[07:27:22] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[07:28:05] *** kimundi is now known as zz_kimundi
[07:29:46] *** Joins: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP)
[07:29:58] <strcat> graydon: hm, it doesn't seem like the try-win bot is able to work anymore
[07:30:03] <strcat> it's just waiting
[07:31:05] <graydon> huh
[07:31:08] <graydon> I don't know what's up there
[07:31:22] <strcat> I'll try master-win
[07:31:33] <graydon> my guess is it's bringing up a latent buildslave
[07:31:45] <graydon> (I just re-enabled EC2 for linux and windows)
[07:31:50] <strcat> nope that just waits too
[07:32:03] <graydon> win3 and win3, linux3 and linux4 are EC2
[07:32:54] <graydon> hm hm
[07:32:59] <graydon> I don't know, off hand
[07:33:09] <strcat> graydon: doesn't seem like those are connected
[07:33:10] <graydon> and it's kinda late. mind if I dig into it tomorrow morning?
[07:33:20] <graydon> yeah. EC2 means buildbot turns them on and off as it likes
[07:33:24] <graydon> "latent"
[07:33:32] <strcat> ah
[07:33:40] <strcat> there it goes
[07:33:50] <graydon> there, it brought win4 online
[07:33:52] <graydon> right
[07:33:53] <graydon> (phew)
[07:34:09] <graydon> normally it takes ~2-5 minutes to bring an EC2 host up
[07:34:17] <graydon> but it keeps them around for like 10 minutes after a build ends
[07:34:27] <graydon> which is often (when heavily loaded) long enough to get another build to pick it up
[07:34:33] <graydon> we can also expand that idle time if necessary
[07:34:49] <graydon> I can rent as many of those machines as we need. macs are the bottleneck.
[07:35:06] <graydon> brson ordered a couple more minis though. so we should smooth this out.
[07:35:31] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[07:36:21] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[07:37:07] *** Joins: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP)
[07:37:07] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/G1UZCQ
[07:37:07] *** Parts: ghrust (ghrust@614D05BD.6A2AE50.F3114085.IP) ()
[07:37:14] <strcat> default methods!
[07:37:18] <dbaupp> yay!
[07:37:18] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[07:37:24] *** Joins: z0w0 (zack@FDF4EF6A.2CA5CD8.5F93A189.IP)
[07:37:38] <Luqman> brson: re: https://github.com/mozilla/rust/issues/5248 should it be that for use to resolve successfullt, everything along the way must also be pub 
[07:37:38] *** Joins: doener (doener@moz-121949B3.unitymediagroup.de)
[07:37:59] * dbaupp builds himself a new rustc
[07:38:03] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[07:39:07] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[07:40:07] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[07:40:07] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/UQXuGA
[07:40:07] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[07:40:08] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:40:08] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/q_mvWQ
[07:40:08] <ghrust> 13rust/06auto 14ad799f2 15Erick Tryzelaar: std: allow vec::bytes::memcmp to work on slices
[07:40:08] <ghrust> 13rust/06auto 141f4eddb 15Erick Tryzelaar: std: group the option tests inside a module
[07:40:09] <ghrust> 13rust/06auto 1448312a5 15Erick Tryzelaar: minor cleanup
[07:40:10] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[07:42:18] <strcat> graydon: huh, and why does it put 2 builds on mac4 instead of distributing them over both? I guess that's not really a big deal but...
[07:42:53] <strcat> oh nvm it's because it had a whole bunch starting up :)
[07:43:55] *** Quits: graydon (graydon@3853DDD.39EEDBB3.D758B1AA.IP) (Ping timeout)
[07:43:55] *** Quits: brendanc (brendan@moz-CA4BEC19.cs.ubc.ca) (Ping timeout)
[07:44:02] *** Joins: brendanc (brendan@moz-CA4BEC19.cs.ubc.ca)
[07:44:28] *** Joins: graydon (graydon@3853DDD.39EEDBB3.D758B1AA.IP)
[07:44:28] *** ChanServ sets mode: +qo graydon graydon
[07:44:33] <graydon> strcat: because the default assignment function is random-selection
[07:44:51] <graydon> I used to have a custom function there (first assigned, until max builds per slave)
[07:45:08] <graydon> but apparently it interpreted "max per slave" as "(-per builder)"
[07:45:13] <graydon> which meant they overloaded
[07:45:17] <hoelzro> &[&str] is a borrowed vector of borrowed pointers, right?
[07:45:23] <graydon> so in the interests of doing the least harm, I set it back to the random rule
[07:45:33] <graydon> maybe we can put together a better rule later
[07:45:37] <strcat> hoelzro: well it's a vector slice of string slices
[07:45:50] *** Joins: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP)
[07:45:52] <strcat> slices are a bit special but they mostly act like borrowed pointers
[07:46:11] <hoelzro> hmm
[07:46:57] <hoelzro> well, I ask because I was trying to implement a function that works on a generic vector of strings
[07:47:21] <hoelzro> so I'd like it to work on [~str], [@str], etc
[07:47:24] <strcat> hoelzro: I'd suggest using Iterator<&str>
[07:47:24] <hoelzro> is that possible?
[07:47:30] <dbaupp> hoelzro: you want S: Str
[07:47:37] <hoelzro> oh, I see
[07:47:41] <brson> Luqman: ie. it should only work if `mod foo` is pub?
[07:47:53] <dbaupp> hoelzro: it provides a single method .as_slice() -> &str
[07:48:13] <strcat> hoelzro: if you use an iterator, it will work for any container of any kind of string
[07:48:16] <Luqman> brson: is that how use should behave?
[07:48:21] <hoelzro> ok
[07:48:27] <strcat> although the caller might have to .transform &~str to &str
[07:48:31] <strcat> but that's not very painful
[07:48:59] <dbaupp> hoelzro: as strcat says, <S: Str, Iterator<S>> is the most general you can get
[07:49:36] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[07:52:40] <brson> Luqman: no, I don't think so. the contents of `foo` are visible to its siblings even though `foo` isn't exported
[07:54:30] *** Quits: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP) (Ping timeout)
[07:54:49] *** Quits: graydon (graydon@3853DDD.39EEDBB3.D758B1AA.IP) (Quit: Leaving.)
[07:54:57] *** zz_kimundi is now known as kimundi
[07:55:27] *** Joins: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP)
[08:02:19] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[08:03:37] *** Quits: rusti (rusti@4FEAAB95.65F27C5.9334D275.IP) (Ping timeout)
[08:03:41] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:04:00] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[08:04:35] *** Quits: fairfieldt (fairfieldt@moz-D8998E1C.xen.prgmr.com) (Ping timeout)
[08:05:35] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[08:05:46] *** Quits: eakuefner (eakuefner@moz-9EDCAF3.com) (Ping timeout)
[08:06:13] *** Quits: jst (quassel@2557E599.66715431.D25A875A.IP) (Ping timeout)
[08:06:13] *** Quits: johns (johns@2557E599.66715431.D25A875A.IP) (Ping timeout)
[08:06:14] *** Joins: johns (johns@2557E599.66715431.D25A875A.IP)
[08:06:15] *** Joins: jst (quassel@2557E599.66715431.D25A875A.IP)
[08:06:50] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[08:07:38] <strcat> uh something terrible happened to buildbot ;\
[08:07:42] *** Joins: fairfieldt (fairfieldt@moz-D8998E1C.xen.prgmr.com)
[08:07:46] <strcat>  Build successful exception slave lost 
[08:07:47] * strcat sighs
[08:08:05] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[08:09:03] *** Joins: eakuefner (eakuefner@moz-9EDCAF3.com)
[08:09:32] *** Quits: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP) (Ping timeout)
[08:09:47] *** Joins: Benvie_ (brandon@5FD20F9A.53D07D95.EFF8B7BF.IP)
[08:12:57] *** Quits: brson (brson@5F06B402.AD1E507F.3688B332.IP) (Quit: leaving)
[08:13:02] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[08:13:02] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14545baaa to 14ba05af7: 02http://git.io/N3iJvQ
[08:13:02] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[08:13:05] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[08:13:05] <ghrust> 01[13rust01] 15bors pushed 1 new commit to 06auto: 02http://git.io/bcmTbA
[08:13:05] <ghrust> 13rust/06auto 142777c17 15bors: auto merge of #7263 : thestinger/rust/iterator, r=graydon
[08:13:05] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[08:13:54] <rubber-duck> is it possible to describe something like struct Foo<'s> { src: ~'s str, srcRefs: ~[&'s str] } with lifetimes ?
[08:14:25] <strcat> rubber-duck: well you can't have a lifetime on an ~str
[08:14:29] <strcat> the struct owns it
[08:14:49] <rubber-duck> strcat, I know but I hope the intent is clear 
[08:14:54] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[08:14:56] <strcat> struct Foo<'self> { src: ~'self str, src_refs: ~[&'self str] }
[08:14:59] <strcat> err
[08:15:03] <strcat> struct Foo<'self> { src: &'self str, src_refs: ~[&'self str] }
[08:15:06] <strcat> I think that should work
[08:15:24] <rubber-duck> strcat, but I need src to be owned :|
[08:15:34] <strcat> well it doesn't need a lifetime then
[08:15:43] <strcat> struct Foo<'self> { src: ~str, src_refs: ~[&'self str] }
[08:15:58] <rubber-duck> sure - but can I bind src_refs 'self then ?
[08:16:09] <rubber-duck> is 'self special ?
[08:16:21] <rubber-duck> for struct lifetime ?
[08:16:41] <dbaupp> rusti: struct Foo<'self> { src: ~str, src_refs: ~[&'self str] } let mut a = Foo { src: ~"foo", src_refs: ~[] }; a.src_refs.push(src.slice(0,1))
[08:16:44] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/YeXZ
[08:17:12] <dbaupp> rusti: struct Foo<'self> { src: ~str, src_refs: ~[&'self str] } let mut a = Foo { src: ~"foo", src_refs: ~[] }; a.src_refs.push(a.src.slice(0,1)); println(fmt!("%?",a))
[08:17:15] -rusti- {src: ~"foo", src_refs: ~["f"]}
[08:17:16] -rusti- ()
[08:17:23] <strcat> rubber-duck: it's not really special
[08:17:38] <strcat> rubber-duck: but the compiler will currently force you to name a struct parameter lifetime "'self"
[08:17:49] <dbaupp> rusti: struct Foo<'self> { src: ~str, src_refs: ~[&'self str] } let mut a = Foo { src: ~"foo", src_refs: ~[] }; a.src_refs.push(a.src.slice(0,1)); a.src_refs.push(a.src.slice(1,2)); a
[08:17:51] <strcat> rubber-duck: in the future that restriction will be lifted, and 'self won't mean anything
[08:17:51] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/SEUh
[08:18:14] <dbaupp> rusti: struct Foo<'self> { src: ~str, src_refs: ~[&'self str] } let mut a = Foo { src: ~"foo", src_refs: ~[] }; a.src_refs.push(a.src.slice(0,1)); a.src_refs.push(a.src.slice(1,2)); println(fmt!("%?", a))
[08:18:16] -rusti- {src: ~"foo", src_refs: ~["f", "o"]}
[08:18:16] -rusti- ()
[08:18:57] *** Joins: pyrac (pyrac@moz-C4B13AD4.math.u-bordeaux1.fr)
[08:22:59] *** Joins: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com)
[08:25:38] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:26:19] <aatch> We have default methods!
[08:28:15] *** Quits: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[08:29:59] <hoelzro> is the 0.7 release going out soon?
[08:30:09] <aatch> hoelzro, end of month
[08:30:10] <aatch> ish
[08:30:14] <hoelzro> ah ha
[08:30:20] <pyrac> aatch: great. Thanks !!
[08:30:45] *** Quits: indirect (indirect_m@moz-770AB053.hsd1.ca.comcast.net) (Ping timeout)
[08:30:45] *** Quits: kemurphy (kemurphy@moz-7332FD74.hsd1.pa.comcast.net) (Ping timeout)
[08:31:20] *** Joins: kemurphy (kemurphy@moz-7332FD74.hsd1.pa.comcast.net)
[08:31:25] *** Quits: marc (marc@E31B39DA.F9D61A8.416A0103.IP) (Ping timeout)
[08:31:25] *** Quits: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net) (Ping timeout)
[08:31:27] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[08:31:50] <hoelzro> if I wanted to submit doc patches, would they have to in by that release? or are doc patches from development cherry-picked to rebuild what's on rust-lang.org?
[08:31:55] *** Joins: roo (Mibbit@moz-4B501CF5.dynamic.ip.windstream.net)
[08:32:33] <aatch> hoelzro, the trunk documentation is built from master
[08:32:43] <aatch> whenever master gets updated
[08:32:51] <aatch> which, now, is fairly often
[08:32:52] <hoelzro> is master the stable branch? or where new dev happens?
[08:32:59] <aatch> hoelzro, kinda both
[08:33:03] <hoelzro> heh
[08:33:18] <aatch> we have an integration bot that makes sure everything stays mostly stable
[08:33:30] *** Joins: k00mi (koomi@moz-D309F841.pools.arcor-ip.net)
[08:33:31] <hoelzro> well, I have Rust 0.6 installed on my machine, so I've been consulting the 0.6 docs
[08:33:38] <hoelzro> I'm guessing those are snapshotted?
[08:33:43] <aatch> hoelzro, yes.
[08:33:46] <dbaupp> yep
[08:33:48] <hoelzro> hmm
[08:33:56] *** Joins: marc (marc@E31B39DA.F9D61A8.416A0103.IP)
[08:34:02] *** Joins: indirect (indirect_m@moz-770AB053.hsd1.ca.comcast.net)
[08:34:07] <hoelzro> I better hurry up with my patches then =)
[08:34:16] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[08:34:36] <dbaupp> you can go back and see the 0.3 docs... http://static.rust-lang.org/doc/0.3/core/index.html how it's change!
[08:34:57] <aatch> We really need to fix up the versioning.
[08:35:31] <aatch> 0.7 should be released, then the version number on master should be 0.8pre
[08:35:33] <dbaupp> hoelzro: (there has been a lot of changes since 0.6, so any patches based on 0.6 may've been fixed or are no longer relevant.)
[08:36:01] <aatch> As in, when you go rustc --version, you'd see 0.8pre
[08:36:07] <dbaupp> yeah
[08:36:08] <hoelzro> dbaupp: well, I'd like to submit some doc improvements
[08:36:19] <hoelzro> based on some things I've encountered in my experimentation
[08:36:33] <aatch> hoelzro, that's fine, but have you been doing the changes against the current master?
[08:36:43] *** Quits: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP) (Ping timeout)
[08:36:44] <dbaupp> hoelzro: that's brilliant! but, you should double check that they are still applicable :)
[08:36:44] <hoelzro> I haven't started yet, but I would do
[08:37:17] <aatch> hoelzro, if you plan to contribute, even just documentation, I suggest building from source off of master
[08:37:31] <hoelzro> aatch: trying that =)
[08:37:35] <hoelzro> dbaupp: indeed
[08:37:43] <aatch> You've picked a decent time, we just had a new snapshot compiler.
[08:37:56] <hoelzro> the first thing would probably be talking about destructuring binds
[08:38:04] * hoelzro doesn't know what a snapshot compiler is
[08:38:23] <aatch> Rust is written in Rust
[08:38:37] <aatch> Theres a bit of a dependency problem there.
[08:38:46] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[08:39:16] <aatch> so we occasionally make snapshots of the current development and use that to build the compiler
[08:39:23] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[08:39:27] <aatch> the first compiler was written in ocaml
[08:39:28] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[08:39:40] <hoelzro> ah, ok
[08:39:41] <aatch> but was explicitly for bootstrapping purposes
[08:39:52] <aatch> It was actually called "rustboot"
[08:40:25] <aatch> Unfortunately, making a snapshot isn't always that easy, as it has to be at a fairly stable point.
[08:40:34] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[08:40:50] <aatch> So we actually stopped taking patches for about 2 days while we stabilised the tree
[08:41:46] *** Joins: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP)
[08:41:48] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:41:56] <strcat> nooooooo stupid windows bot
[08:42:27] <aatch> Why!?!!?!???!?!??!
[08:42:45] <aatch> It must be a specific slave
[08:43:04] <strcat> yep
[08:43:06] *** Joins: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP)
[08:43:06] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 142777c17 to 14ba05af7: 02http://git.io/N3iJvQ
[08:43:06] *** Parts: ghrust (ghrust@FD7BC443.6A2AE50.F3114085.IP) ()
[08:43:08] *** Joins: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP)
[08:43:08] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/xDFdxw
[08:43:08] <ghrust> 13rust/06auto 14ad799f2 15Erick Tryzelaar: std: allow vec::bytes::memcmp to work on slices
[08:43:08] <ghrust> 13rust/06auto 141f4eddb 15Erick Tryzelaar: std: group the option tests inside a module
[08:43:08] <ghrust> 13rust/06auto 1448312a5 15Erick Tryzelaar: minor cleanup
[08:43:10] *** Parts: ghrust (ghrust@CFE85B59.6A2AE50.F3114085.IP) ()
[08:43:26] <strcat> win2
[08:43:29] <aatch> yep.
[08:43:43] <aatch> Think graydon would get mad if we turned it off?
[08:44:09] <aatch> Or can we not do that from here?
[08:44:51] <strcat> don't know if we can
[08:45:02] <strcat> he's not going to get mad at us for trying to fix it ;p
[08:45:11] <dbaupp> looks like it http://buildbot.rust-lang.org/buildslaves/win2
[08:46:05] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[08:46:15] <strcat> dammit going to fail again
[08:46:24] <aatch> I'm gonna live on the edge
[08:47:01] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[08:47:39] <strcat> can you just force it to build that again
[08:47:42] <strcat> on a less crappy builder
[08:48:08] <aatch> I think it did it automatically...
[08:49:22] <aatch> Oh, nope
[08:49:30] <aatch> just the same PR
[08:49:41] <aatch> but an earlier version
[08:49:58] *** Quits: ssiloti (steve@moz-4B8C4631.oc.oc.cox.net) (Ping timeout)
[08:50:30] *** Joins: ssiloti (steve@moz-4B8C4631.oc.oc.cox.net)
[08:50:32] <strcat> dammit bors ;p
[08:50:37] <strcat> well, buildbot*
[08:50:43] <strcat> but I blame bors for buildbot's problems
[08:51:50] <aatch> strangely, the build that win3 is doing, #17, apparently already failed.
[08:51:55] *** Joins: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com)
[08:52:05] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[08:52:05] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 148072331 to 14ba05af7: 02http://git.io/N3iJvQ
[08:52:05] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[08:52:07] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[08:52:07] <ghrust> 01[13rust01] 15bors pushed 1 new commit to 06auto: 02http://git.io/Q-a6SQ
[08:52:07] <ghrust> 13rust/06auto 14b0e3ffd 15bors: auto merge of #7263 : thestinger/rust/iterator, r=graydon
[08:52:07] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:52:24] *** Joins: sk (sk@1335CD0E.81A8C295.D066974A.IP)
[08:52:35] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[08:52:47] <aatch> Ok, now I'm confused
[08:53:24] <aatch> Oh, it was you
[08:54:37] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[08:54:38] <aatch> pity we can't leave a note for graydon on IRC
[08:55:29] <strcat> dammit that one won't stop
[08:56:04] <aatch> the win-32-opt?
[08:56:15] <aatch> Don't worry about it.
[08:56:35] <strcat> ok there
[08:57:01] <aatch> That run could probably go through two or three times in the time it takes a linux build to go through.
[08:57:21] <aatch> Man I'm starting to get sick of purple
[08:57:52] <strcat> oh nice you killed win2, so hopefully it's all okay now
[08:58:14] <strcat> it's possible win3 is broken too...
[08:58:20] <strcat> oh nvm
[08:58:32] <strcat> win1 is definitely fine though
[08:58:35] <strcat> we'll see if win3 is
[08:59:43] <aatch> strcat, yeah, it said "gracefully shut down when idle", as in "When this has finished what it is doing, shutdown"
[09:00:57] <dbaupp> aatch: maybe open an issue?
[09:01:17] <aatch> dbaupp, good idea!
[09:01:41] <aatch> strcat, r? https://github.com/mozilla/rust/pull/7272
[09:01:55] <aatch> if you're ok with it
[09:02:16] <strcat> huh, why did we make that closure? ;\
[09:02:29] <strcat> rustc is weird.
[09:03:29] <aatch> strcat, because we passes ident_interners around.
[09:03:38] <aatch> passed*
[09:03:43] <strcat> aatch: seems there's a merge marker left in it
[09:03:49] <strcat> https://github.com/mozilla/rust/pull/7272/files#L3R36
[09:03:53] <aatch> strcat, really? dammit
[09:04:08] <strcat> aatch: cp .git/hooks/pre-commit.sample .git/hooks/pre-commit ;p
[09:04:16] <strcat> it catches leftover merge markers + whitespace errors
[09:05:21] <strcat> aatch: also, is https://github.com/mozilla/rust/pull/7272/files#L1R1199 supposed to be part of this?
[09:06:32] <aatch> strcat, I did it deliberately, yes.
[09:06:40] <aatch> It's a tiny change.
[09:06:56] <aatch> basically just saying that if any of the parent blocks are unreachable, this one is too
[09:07:16] <strcat> so it was inserting N unreachable instructions before?
[09:07:20] <aatch> strcat, yep
[09:07:33] <aatch> fortunately in 99% of cases, N=0
[09:07:51] <doomlord> so default methods have been added, anythingn else new recently?
[09:08:02] <aatch> doomlord, define recently.
[09:08:12] <strcat> thestinger/rust-git  release.0.6.2442.gf348465-1  release.0.6.2446.gba05af7-1    0.01 MiB
[09:08:14] <strcat> ;p
[09:08:20] <strcat> cross-crate default methods!
[09:08:22] <doomlord> past 4weeks perhaps;  
[09:08:36] <aatch> Hmm, drop is no longer a keyword.
[09:08:37] <strcat> RELEASES.txt ;p
[09:08:53] <strcat> rusti: trait Foo { fn foo(&self) { println("foo") } }
[09:08:54] -rusti- <anon>:10:9: 10:55 error: default methods are experimental [-D default-methods (default)]
[09:08:54] -rusti- <anon>:10          trait Foo { fn foo(&self) { println("foo") } }
[09:08:54] -rusti-                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[09:08:54] -rusti- error: aborting due to previous error
[09:08:54] -rusti- application terminated with error code 101
[09:09:10] <strcat> rusti: trait Foo { fn foo(&self) { println("foo") } }
[09:09:10] -rusti- ()
[09:09:24] <strcat> rusti: trait Foo { fn foo(&self) { println("foo") } } impl Foo for int {} 5i.foo()
[09:09:24] -rusti- foo
[09:09:25] -rusti- ()
[09:09:27] <strcat> :D
[09:09:57] <dbaupp> :D
[09:10:35] <strcat> rusti: trait Foo { fn foo(&self) { println("foo") } } impl Foo for int { fn foo(&self) { println("nope") } } 5i.foo()
[09:10:36] -rusti- nope
[09:10:37] -rusti- ()
[09:10:45] * strcat should add a size hint to Iterator now
[09:10:49] * dbaupp is happy
[09:12:04] <strcat> rusti: 2
[09:12:05] -rusti- 2
[09:13:47] <strcat> rusti: 2
[09:13:47] -rusti- Error: non-existent syscall setsocketopt
[09:13:49] <strcat> oops
[09:13:53] <strcat> oops
[09:13:55] <strcat> rusti: 2
[09:13:56] -rusti- 2
[09:13:58] <strcat> ugh
[09:14:24] <aatch> Seriously, people suck at cleaning up warnings...
[09:15:06] <strcat> oh wat
[09:15:09] <strcat> there *is* a loopback
[09:15:29] * strcat was about to write 300 LOC to set one up
[09:15:57] <strcat> rusti: print(std::str::from_utf8(std::run::process_output("ip", [~"a"]).output))
[09:15:57] -rusti- <anon>:9:15: 9:34 error: unresolved name `std::str::from_utf8`.
[09:15:57] -rusti- <anon>:9          print(std::str::from_utf8(std::run::process_output("ip", [~"a"]).output))
[09:15:58] -rusti-                         ^~~~~~~~~~~~~~~~~~~
[09:15:58] -rusti- error: aborting due to previous error
[09:15:58] -rusti- application terminated with error code 101
[09:16:05] <strcat> err
[09:16:12] <strcat> rusti: print(std::str::from_bytes(std::run::process_output("ip", [~"a"]).output))
[09:16:13] -rusti- 1: lo: <LOOPBACK> mtu 65536 qdisc noop state DOWN 
[09:16:13] -rusti-     link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
[09:16:13] -rusti- ()
[09:16:17] <strcat> yay
[09:18:19] <strcat> rusti: print(std::str::from_bytes(std::run::process_output("ss", [~"-a"]).output))
[09:18:20] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/jCBX
[09:19:03] * strcat kills off those syscalls again ;p
[09:19:11] <strcat> rusti: 2
[09:19:12] -rusti- 2
[09:19:33] <strcat> rusti: 2
[09:19:34] -rusti- 2
[09:20:23] <aatch> strcat, hey, I fixed up the commit. I'm just running a build to make sure I didn't miss anything else.
[09:20:49] <strcat> r+'ed
[09:23:05] <aatch> hmm, win3 is either very slow, or broken.
[09:23:26] <aatch> master is green though.
[09:23:55] <aatch> which is a nice sight
[09:25:20] <strcat> aatch: it's EC2
[09:25:21] <dbaupp> aatch: yeah... I want alexchricto's #[deny(everything)] patch to land
[09:25:32] <strcat> aatch: win3/win4 and linux3/linux4 are EC2
[09:25:43] <strcat> so they are going to take forever ;p
[09:25:44] <aatch> strcat, that explains it.
[09:26:13] <aatch> dbaupp, it's been like 3 PRS and there were 4 import warnings.
[09:26:40] <dbaupp> aatch: i know :(
[09:26:43] <aatch> It doesn't take much to just delete the line!
[09:30:17] <strcat>     /// Return an estimate of the remaining length of the iterator, if possible. It can be smaller
[09:30:19] <strcat>     /// than the actual size of the iterator, but should not be larger.
[09:30:21] <strcat>     ///
[09:30:23] <strcat>     /// The estimate can be used to pre-allocate space in a vector, hash table or file.
[09:30:25] <strcat>     fn size_hint(&self) -> Option<uint> { None }
[09:30:27] * strcat thinks that'll be fine
[09:30:35] <strcat> python allows length_hint to be larger but that seems bad
[09:30:51] * strcat doesn't think you'd want to fallocate more than necessary
[09:30:53] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: sk (sk@1335CD0E.81A8C295.D066974A.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: k00mi (koomi@moz-D309F841.pools.arcor-ip.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: pyrac (pyrac@moz-C4B13AD4.math.u-bordeaux1.fr) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: jst (quassel@2557E599.66715431.D25A875A.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: johns (johns@2557E599.66715431.D25A875A.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: doener (doener@moz-121949B3.unitymediagroup.de) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: z0w0 (zack@FDF4EF6A.2CA5CD8.5F93A189.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: rubber-duck (rubber-duc@moz-9BB75FBE.dsl.iskon.hr) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: tristram (tristram@moz-C498CC41.eu) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: keruspe (keruspe@moz-F2539FEC.imagination-land.org) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Palmik (palmik@moz-5CA3F354.pks.muni.cz) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Blei (philipp@moz-650B9C6A.cust.bluewin.ch) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: chandler (foo@moz-F990611.mastenbrook.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: decoder (quassel@moz-D7023D7D.own-hero.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: MX80 (MX80@moz-32BE33CD.dsl.g3telecom.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: jhark (jhark@moz-B9920504.jhark.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: jpf (jan@moz-A8C26A15.org) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: kornholi (kornholi@moz-185F17B0.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: heftig (heftig@moz-5E306FE6.dip0.t-ipconnect.de) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: dju (dju@moz-83BD5EC.dmz.me) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: vermeille (vermeille@moz-436628F6.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: jez0990 (quassel@moz-3BA8545E.kimsufi.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: glandium (glandium@moz-A09032B1.kimsufi.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: alexrp (zor@moz-180BED6.rfw.name) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: kaeso (kaeso@moz-F21FF626.unstable.it) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: kini (kini@moz-92AA953A.members.linode.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: kimundi (kimundi@moz-386FFA95.dip0.t-ipconnect.de) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: dbaupp (Thunderbir@moz-73E90475.lns20.syd6.internode.on.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: _1126 (1126@moz-83D60E55.lileth.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: barosl (barosl@E287D94F.C81E10FB.7544CABF.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: wuwei (wuwei@1A513F49.818D7924.FAA9ED67.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Tad (Tom@moz-2036EE54.kimsufi.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: andor (andor@moz-B1384951.neferty.in) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: KindOne (KindOne@E313C970.A337191.EC6A1518.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: mixi (mixi@moz-DBD8904A.org) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: cr (anonymous@moz-32725F28.dip0.t-ipconnect.de) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Thiez (thiez@moz-BF669398.student.utwente.nl) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: smvv (smvv@moz-A397289C.xlshosting.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: DasIch (dasich@moz-5EDA591.de) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: pcdummy (quassel@moz-CF4CA865.page4me.ch) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: prudhvi (prudhvi@moz-154A460A.supr.io) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: monk (monk@moz-99849335.compsoc.warwick.ac.uk) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: cdidd (cdidd@moz-A994150B.broadband.corbina.ru) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: igl1 (igl@moz-A1A13B61.adsl.alicedsl.de) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: txdv (quassel@966F3542.3BA477DA.14C26596.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: doomlord_ (walter@moz-6651F8D4.range86-145.btcentralplus.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: xenocons (otk@moz-C675529E.members.linode.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: hansjorg (hansjorg@moz-EECB5F79.static.cust.telenor.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: zootm (calum@moz-DCC1F9C3.sgyl.cable.virginmedia.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Boreeas (Boreeas@moz-F35C832D.boreeas.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: tedh (tedh@moz-CE9B2F5A.cinci.res.rr.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: cscott (cscott@moz-2577C94A.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: jeltz (andreas@moz-7C6B0B72.tn.glocalnet.net) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: Aetherspawn_BNC (uid6924@moz-A588D045.irccloud.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: gazoombo (uid6629@moz-C944F5EC.irccloud.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: geomyidae__ (uid214@moz-C944F5EC.irccloud.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Quits: wilfred (uid159@moz-C944F5EC.irccloud.com) (sand.mozilla.org gravel.mozilla.org)
[09:30:53] *** Joins: johns (johns@2557E599.66715431.D25A875A.IP)
[09:30:54] *** Joins: kornholi (kornholi@moz-185F17B0.net)
[09:30:54] *** Joins: chandler (foo@moz-F990611.mastenbrook.net)
[09:30:54] *** Joins: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca)
[09:30:55] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[09:30:55] *** Joins: jst (quassel@2557E599.66715431.D25A875A.IP)
[09:30:59] *** Joins: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com)
[09:31:00] *** Joins: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca)
[09:31:00] *** concrete.mozilla.org sets mode: +R 
[09:31:32] *** Joins: KindOne (KindOne@E313C970.A337191.EC6A1518.IP)
[09:31:39] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[09:31:49] <aatch> yay netsplit
[09:32:06] * strcat finds hopping between sides of the netsplit amusing
[09:32:19] <strcat> aatch: I think the other server actually died :\
[09:32:28] <aatch> strcat, ouch
[09:32:47] <strcat> rusti: 2
[09:32:48] -rusti- 2
[09:32:58] *** Joins: decoder (quassel@moz-D7023D7D.own-hero.net)
[09:33:07] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[09:33:10] *** Joins: sk (sk@1335CD0E.81A8C295.D066974A.IP)
[09:33:15] *** Joins: heftig (heftig@moz-5E306FE6.dip0.t-ipconnect.de)
[09:33:24] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[09:33:28] <strcat> aatch: I think those are automatic reconnects ;p
[09:33:39] *** Joins: Tad (Tom@moz-2036EE54.kimsufi.com)
[09:33:45] *** Joins: Blei (philipp@moz-650B9C6A.cust.bluewin.ch)
[09:33:50] <aatch> strcat, seems legit
[09:33:56] <Blei> huh, what was that
[09:33:59] *** Joins: dju (dju@moz-83BD5EC.dmz.me)
[09:35:59] *** concrete.mozilla.org sets mode: -R 
[09:36:00] *** Joins: kimundi (kimundi@moz-386FFA95.dip0.t-ipconnect.de)
[09:36:04] *** Joins: jhark (jhark@moz-B9920504.jhark.net)
[09:36:10] *** Joins: kaeso (kaeso@moz-F21FF626.unstable.it)
[09:36:10] *** Joins: cr (anonymous@moz-32725F28.dip0.t-ipconnect.de)
[09:36:12] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[09:36:42] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[09:37:24] *** Joins: pyrac (pyrac@moz-C4B13AD4.math.u-bordeaux1.fr)
[09:37:32] *** Joins: Boreeas (Boreeas@moz-F35C832D.boreeas.net)
[09:37:56] *** Joins: txdv (quassel@966F3542.3BA477DA.14C26596.IP)
[09:38:54] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[09:39:12] <aatch> strcat, looks like your vec stuff is gonna get through!
[09:39:29] <strcat> /home/strcat/projects/rust/src/libextra/treemap.rs:215:18: 215:49 error: missing method `size_hint`
[09:39:42] <strcat> doesn't seem to work cross-crate...
[09:39:44] <strcat> oh
[09:39:46] <strcat> stage0
[09:39:48] <strcat> dammit stage0
[09:39:51] *** Quits: pyrac (pyrac@moz-C4B13AD4.math.u-bordeaux1.fr) (Quit: pyrac)
[09:39:53] *** Joins: xenocons (otk@moz-C675529E.members.linode.com)
[09:39:56] <xenocons> weird
[09:40:06] *** Joins: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP)
[09:40:38] <aatch> strcat, I've gotten a taste for making snapshots, I'm gonna try to aim for one each week or so.
[09:40:42] <strcat> :D
[09:40:54] *** Joins: prudhvi (prudhvi@moz-154A460A.supr.io)
[09:40:54] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[09:40:55] *** Joins: DasIch (dasich@moz-5EDA591.de)
[09:40:57] *** Joins: Palmik (palmik@moz-5CA3F354.pks.muni.cz)
[09:41:24] *** Joins: mixi (mixi@moz-DBD8904A.org)
[09:41:56] <aatch> there was also surprisingly little that needed to be fixed up to get the snapshot working
[09:43:05] *** Quits: mixi (mixi@moz-DBD8904A.org) (sand.mozilla.org gravel.mozilla.org)
[09:43:05] *** Quits: Palmik (palmik@moz-5CA3F354.pks.muni.cz) (sand.mozilla.org gravel.mozilla.org)
[09:43:05] *** Quits: DasIch (dasich@moz-5EDA591.de) (sand.mozilla.org gravel.mozilla.org)
[09:43:05] *** Quits: prudhvi (prudhvi@moz-154A460A.supr.io) (sand.mozilla.org gravel.mozilla.org)
[09:43:05] *** Quits: txdv (quassel@966F3542.3BA477DA.14C26596.IP) (sand.mozilla.org gravel.mozilla.org)
[09:43:05] *** Quits: Boreeas (Boreeas@moz-F35C832D.boreeas.net) (sand.mozilla.org gravel.mozilla.org)
[09:43:23] <aatch> We're not using any LLVM's GC stuff, right?
[09:44:12] <strcat> aatch: I think graydon might be using some
[09:44:15] <strcat> dunno
[09:44:24] <strcat> at least he needs to flush registers, maybe he's doing it himself
[09:44:24] *** Quits: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP) (Ping timeout)
[09:44:52] <aatch> Hmm, but no need for LLVM's GC strategy stuff, right?
[09:45:13] <strcat> aatch: not yet
[09:45:29] <strcat> until it becomes precise on the stack
[09:45:38] *** Joins: mixi (mixi@moz-DBD8904A.org)
[09:45:51] *** Joins: Boreeas (Boreeas@moz-F35C832D.boreeas.net)
[09:45:54] *** Joins: prudhvi (prudhvi@moz-154A460A.supr.io)
[09:45:56] *** Joins: DasIch (dasich@moz-5EDA591.de)
[09:45:59] *** Joins: Palmik (palmik@moz-5CA3F354.pks.muni.cz)
[09:46:06] *** Joins: txdv (quassel@966F3542.3BA477DA.14C26596.IP)
[09:46:20] <aatch> well then it doesn't need to be in the compiler at the moment.
[09:46:37] *** Joins: ruediger (quassel@moz-C9B8D8D0.org)
[09:49:02] *** Joins: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP)
[09:49:05] *** Joins: MaikKlein (maik@moz-280FF4C6.dip0.t-ipconnect.de)
[09:49:05] *** Joins: rubber-duck (rubber-duc@moz-9BB75FBE.dsl.iskon.hr)
[09:49:15] <rubber-duck> fn get_mtime(&self) -> Option<(i64, int)> in Path - docs don't say what (i64, int) are :|
[09:49:59] *** Joins: geomyidae__ (uid214@moz-C944F5EC.irccloud.com)
[09:50:54] *** Joins: Aetherspawn_BNC (uid6924@moz-A588D045.irccloud.com)
[09:52:39] <nmatsakis> cmr: grrr re: librustpkg
[09:52:49] <nmatsakis> cmr: well I have to make a few edits anyhow
[09:55:22] * strcat wants pointer arithmetic ;p
[09:55:48] <nmatsakis> strcat: no reason we couldn't overload + for *T---
[09:55:57] <nmatsakis> strcat: we've talked about doing it many times, not sure why we haven't.
[09:56:04] <strcat> will it actually let us overload it for both *T and uint though?
[09:56:18] <nmatsakis> why not?
[09:56:20] <aatch> strcat, yeah, they're different types
[09:56:28] * strcat though that was broken for some reason
[09:56:29] <nmatsakis> *T is castable to uint,
[09:56:32] <strcat> thought*
[09:56:38] <nmatsakis> but it's not the same thing afaik
[09:56:44] <nmatsakis> well, there might be a bug, idk
[09:57:14] <aatch> I think of *T as a uint that you can dereference though
[09:57:29] <aatch> makes it easier to think about what you can and can't do with it
[09:58:38] <strcat> well
[09:58:42] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[09:58:48] *** Quits: Aetherspawn_BNC (uid6924@moz-A588D045.irccloud.com) (sand.mozilla.org gravel.mozilla.org)
[09:58:48] *** Quits: geomyidae__ (uid214@moz-C944F5EC.irccloud.com) (sand.mozilla.org gravel.mozilla.org)
[09:58:48] *** Quits: MaikKlein (maik@moz-280FF4C6.dip0.t-ipconnect.de) (sand.mozilla.org gravel.mozilla.org)
[09:58:48] *** Quits: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP) (sand.mozilla.org gravel.mozilla.org)
[09:58:48] *** Quits: txdv (quassel@966F3542.3BA477DA.14C26596.IP) (sand.mozilla.org gravel.mozilla.org)
[09:58:48] *** Quits: Boreeas (Boreeas@moz-F35C832D.boreeas.net) (sand.mozilla.org gravel.mozilla.org)
[09:59:07] <strcat> ptrdiff_t diff = (ptr_a + 4) - ptr_a;
[09:59:14] <strcat> will give 4 in C
[09:59:29] <strcat> terrible example...
[09:59:44] * strcat 's point is that +1 will do +(sizeof(T))
[09:59:56] <nmatsakis> aatch: that's fine, but thats'...not what it is.
[10:00:02] <nmatsakis> aatch: or at least that's not how it works in C :)
[10:00:10] <nmatsakis> aatch: in particular with respect to +
[10:00:12] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[10:01:00] <aatch> nmatsakis, Oh, I know. I meant more like whether you're allowed to copy it into closures etc.
[10:01:04] <nmatsakis> I see
[10:01:08] *** Joins: MaikKlein (maik@moz-280FF4C6.dip0.t-ipconnect.de)
[10:01:10] *** Joins: victorporof (victorporo@70DEDDA.9004F55.9B1E38F4.IP)
[10:01:15] <nmatsakis> yeah, the rules are otherwise the same
[10:01:22] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[10:01:44] <aatch> I don't have to worry about what pointer arithmetic does because we don't have it at the moment.
[10:02:21] *** Joins: geomyidae__ (uid214@moz-C944F5EC.irccloud.com)
[10:02:25] <strcat>             fn size_hint(&self) -> Option<uint> {
[10:02:27] <strcat>                 Some(((self.end as uint) - (self.ptr as uint)) / sys::size_of::<$elem>())
[10:02:29] <strcat>             }
[10:02:31] <strcat> oh well
[10:02:33] <strcat> PITA though :)
[10:02:50] *** Joins: Aetherspawn_BNC (uid6924@moz-A588D045.irccloud.com)
[10:02:58] <aatch> strcat, which one is that for?
[10:03:01] <strcat> vec
[10:03:03] <nmatsakis> strcat: seriously, we should implement pointer arith :)
[10:03:13] <nmatsakis> I always want it too
[10:03:15] <strcat> VecIterator goes out of the way to avoid overhead
[10:03:58] <strcat> slices would be ptr.offset(1); len -= 1; and a check for 1 iteration
[10:04:05] <strcat> and it doesn't optimize away ;[
[10:04:33] <nmatsakis> Sodel_the_V: btw you can see my commits at https://github.com/nikomatsakis/rust/tree/dralston-5762-dev
[10:04:48] <nmatsakis> Sodel_the_V: in particular this one https://github.com/nikomatsakis/rust/commit/c21214edd6ea6698991ab9821f35d7bafef9a0c3
[10:05:01] *** Joins: hansjorg (hansjorg@moz-EECB5F79.static.cust.telenor.com)
[10:05:04] <aatch> "This branch is 11943 commits ahead and 1 commit behind master"
[10:05:07] <aatch> What
[10:05:08] <Sodel_the_V> nmatsakis: Ah, thank you! I'll browse through them now. :)
[10:05:33] <nmatsakis> Sodel_the_V: though there is one slight bug in that commit, I think I added a fixme later,
[10:05:43] <nmatsakis> Sodel_the_V: basically that it's not using the helper routines that exist,
[10:06:01] <nmatsakis> Sodel_the_V: which means that it misses out on some important dynamic checks regarding @mut,
[10:06:07] <nmatsakis> Sodel_the_V: I'll patch that up later, it's easy enough to fix.
[10:06:20] <nmatsakis> Sodel_the_V: your code was basically right in spirit, but you were missing some Loads() and a few other details.
[10:06:44] <nmatsakis> Sodel_the_V: oh, and ~Objects are just pairs now. Not triples.
[10:06:57] <Sodel_the_V> nmatsakis: I suspected I'd miss a few of the detail. At least I wasn't *completely* off in La-La-Land
[10:07:15] <Sodel_the_V> nmatsakis: That's right, I remember hearing about that change a few weeks ago.
[10:07:17] *** Joins: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP)
[10:07:22] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[10:07:34] <nmatsakis> Sodel_the_V: I guess the main thing that was missing is that when we convert from @T or ~T to &T, it's not a no-op today
[10:07:39] <nmatsakis> Sodel_the_V: we have to skip over the box header
[10:07:50] <nmatsakis> Sodel_the_V: though arguably we should store that at a negative offset. I was always opposed to that,
[10:07:57] <nmatsakis> Sodel_the_V: but this patch made me realize my opposition was incorrect.
[10:08:02] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[10:08:04] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:08:22] <nmatsakis> Sodel_the_V: basically because in this case we know we have an @T box, but we don't know what T is,
[10:08:26] <strcat> we shouldn't have box headers at all for ~ and @ once graydon's gc lands
[10:08:31] <strcat> just @mut
[10:08:38] <strcat> pain to fix
[10:08:39] <nmatsakis> Sodel_the_V: so the header must have a fixed size independent of the type T,
[10:08:50] <nmatsakis> Sodel_the_V: whereas before I thoght we could shrink the header if T's alignment permitted it.
[10:08:54] <nmatsakis> and yes, what strcat said,
[10:09:03] <nmatsakis> this will hopefully become mostly irrelevant soon
[10:09:09] <strcat> closures use the allocator and put their length in the header
[10:09:21] <strcat> and some glue touches it, couldn't figure that out
[10:09:44] <strcat> maybe trait objects
[10:09:53] <nmatsakis> strcat: whatever we do, we'll need a way to recover the type descriptor from an @T or ~T
[10:09:59] <nmatsakis> strcat: sorry, not ~T
[10:10:01] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:10:03] *** Joins: gazoombo (uid6629@moz-C944F5EC.irccloud.com)
[10:10:05] <nmatsakis> ah, wait, I remember.
[10:10:07] <strcat> nmatsakis: don't we know that statically for everything but traits?
[10:10:09] <nmatsakis> my plan was this:
[10:10:16] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[10:10:18] <strcat> seems like we should put the tydesc in the vtable
[10:10:20] <nmatsakis> if we drop ~fn and @fn, then yes we know it statically fo reverything but traits
[10:10:24] <nmatsakis> and yes in traits we put it in the vtable
[10:10:26] <aatch> strcat, we do
[10:10:31] <nmatsakis> except for ~fn and @fn, yes.
[10:10:43] <nmatsakis> in those cases, if we keep them or something like them, we can store it in the closure env
[10:10:46] <nmatsakis> at a known loc
[10:11:06] <nmatsakis> in which case we only need it for @T to be around *somewhere*,
[10:11:07] <strcat> nmatsakis: seems like we can just make ~fn and @fn use a different allocator at first
[10:11:12] <nmatsakis> because the GC needs it while tracing
[10:11:16] <nmatsakis> strcat: that sounds much harder
[10:11:22] <xenocons> ive noticed rustc errors on pattern exhaustiveness , i realise rustc isn't a ML, but it seems most langs warn instead of error, is there an interesting rational behind this? is it to help have a 'proovable safety' within the runtime?
[10:11:24] <strcat> it looked easy ;p
[10:11:52] <kimundi> nmatsakis: A question, what exactly is the typedescriptor, and where is it used for what?
[10:12:02] <strcat> xenocons: well you can use an _ case
[10:12:22] <nmatsakis> xenocons: basically we think the other language have it wrong,
[10:12:24] <strcat> haskell errors by default
[10:12:33] <aatch> xenocons, and most languages that have it don't have such low-level data types
[10:12:33] <xenocons> oh haskell does? hm
[10:12:38] <xenocons> aatch: right yeh
[10:12:38] <strcat> well it has to
[10:12:38] <nmatsakis> xenocons: it makes things somewhat simpler in that we never need to generate code for failure to match,
[10:12:44] <xenocons> right
[10:12:44] <strcat> it has to know it's exhaustive
[10:13:01] <strcat> you put 'otherwise' at the end by convention
[10:13:07] <strcat> otherwise is just 'True'
[10:13:16] <xenocons> yeah, i dont mind it, coming from F# and ocaml and sml ive always had a love for pattern exhaustiveness (and cheating with _ )
[10:13:26] <xenocons> so haskell does error, F# and ocaml definetly warn
[10:13:30] <xenocons> interesting
[10:13:46] <nmatsakis> I've found that writing out the cases (rather than using _) is almost always the right thing to do
[10:13:50] <strcat> haskell has to know it's exhaustive because of how flow control works
[10:13:53] <strcat> if has to have 'else' too
[10:13:56] <nmatsakis> a bit tedious at first, but catches many bugs
[10:14:12] <xenocons> nmatsakis: yeah, but _ is useful when you are prototyping
[10:14:21] <nmatsakis> sure.
[10:14:24] <nmatsakis> _ => fail!()
[10:14:25] <strcat> [size_hint 25f0261] iterator: add a size_hint default method
[10:14:27] <strcat>  2 files changed, 28 insertions(+), 6 deletions(-)
[10:14:29] <xenocons> for example, writing out a protocol, you know there are other cases to handle but you want a working model to play with
[10:14:29] <strcat> the first default method :)
[10:14:30] <Sodel_the_V> I *love* the "safe by default" attitude that rust takes toward everything.
[10:14:41] <aatch> nmatsakis, btw, you still having issues with address spaces?
[10:14:55] <nmatsakis> aatch: no, it's fine, I added a non_gc_Box_cast(), I was just hoping I could avoid it
[10:15:11] <Blei> haha, having typos in the keyword tables is thanked with pages upon pages of errors
[10:15:20] <xenocons> Sodel_the_V: if rust can adequately balance stability, speed and safety together in future releases, i will quite literally force people to use it ;)
[10:15:48] <xenocons> i have some ideas around this, specifically militant denial of receiving proof of concepts unless theyre in rust, haha
[10:16:00] <strcat> speed is easy, we just need to paint it red and add flame decals
[10:16:00] <nmatsakis> cmr: if I patch up rustpkg, can you run another timing test?
[10:16:12] <xenocons> strcat: yeah, heh
[10:16:23] <aatch> nmatsakis, I was going to say, I'm about to add a commit to https://github.com/mozilla/rust/pull/7182 that gets rid of the last of the address space stuff
[10:16:25] <Sodel_the_V> xenocons: I would gun for ARM in all of the embedded products I work on for that very reason.
[10:16:34] <xenocons> oh yeh strcat i had a question that might be offtopic
[10:16:39] <xenocons> Sodel_the_V: nice! arm is gewd
[10:16:39] <nmatsakis> aatch: exciting!
[10:17:04] <strcat> xenocons: ask away
[10:17:48] <xenocons> strcat: say you have source code A and test cases B, whats the way\method\practice for determining that B covers A 100% (and this kinda applies to rust)
[10:18:18] <nmatsakis> a weighty question...
[10:18:19] <aatch> nmatsakis, and done.
[10:18:24] <strcat> depends a lot on the meaning of 100%
[10:18:24] <aatch> Code coverage!
[10:18:32] <strcat> sqlite has 100% branch coverage in tests - they exercise every branch
[10:18:36] <strcat> ofc they don't test every input
[10:19:02] <strcat> I guess they have a tool to measure that all code is used during tests
[10:19:08] <aatch> Why not test the infinite space of SQL queries
[10:19:12] <strcat> they try
[10:19:14] <strcat> ;p
[10:19:15] <xenocons> heh
[10:19:25] <strcat> aatch: https://www.sqlite.org/testing.html
[10:19:27] <xenocons> its interesting when thinking about code coverage vs correctness etc
[10:19:47] <xenocons> how does one have confidence that their test cases are covering the code adequately
[10:19:57] <strcat> 91 million lines of tests
[10:20:08] <aatch> strcat, I was just about to comment on that
[10:20:27] <xenocons> i refuse to believe there is not an automated way for doing this heh
[10:20:37] <aatch> xenocons, there are tools that help, but generally you just have to trust it.
[10:20:54] <xenocons> i dont >:(
[10:21:04] <strcat> anyway sqlite is cool
[10:21:08] <aatch> and maintain the idea that if something slips through the tests, you're first reaction is to fix the tests.
[10:21:19] <xenocons> i want, to put in A source and B test, and output C that tells me what B missed 
[10:21:20] <strcat> they've also never broken the ABI in sqlite3
[10:21:22] <strcat> ever
[10:21:25] <strcat> or the file format
[10:21:31] <xenocons> strcat: ill check that out, it sounds like a good basis
[10:21:56] <nmatsakis> http://en.wikipedia.org/wiki/Modified_condition/decision_coverage
[10:21:57] <nmatsakis> also relevant
[10:22:10] <xenocons> ty, will look
[10:22:18] <aatch> there's GCov
[10:22:25] <aatch> I think it requires instrumentation though
[10:22:34] <xenocons> ah
[10:22:37] *** Quits: MaikKlein (maik@moz-280FF4C6.dip0.t-ipconnect.de) (Ping timeout)
[10:22:39] * strcat just wishes sqlite4 was done
[10:22:46] <xenocons> ive done some instrumentation stuff with intels PIN
[10:22:50] <xenocons> but only basic block coverage
[10:22:55] <nmatsakis> you could presumably use perf to get a statistical guess at line coverage
[10:22:59] <xenocons> ugly ugly C++ api
[10:23:07] <strcat> I guess sqlite4 from trunk is still more trustworthy than 99% of projects ;p
[10:23:08] <aatch> nmatsakis, so I pushed that commit now
[10:23:29] <aatch> `non_gc_box_cast` doesn't even exist now :D
[10:23:57] <xenocons> strcat: i think itd be interesting from a security perspective to develop a tool that can build call graphs statically for source A, and tests B, diff the graphs and work out unreached parts of A
[10:24:06] <nmatsakis> aatch: this PR looks great, I am skimming it now
[10:24:56] <xenocons> test cases seem really ad-hoc and unformalised in most cases ive seen them (sqlite may be the exception though)
[10:25:11] <nmatsakis> aatch: wait, the printing of type parameters---
[10:25:16] <nmatsakis> aatch: are you just using arbitrary capital letters?
[10:25:22] <nmatsakis> aatch: or are you actually using the names the user gave?
[10:25:31] <aatch> nmatsakis, abitrary
[10:25:42] * strcat would like having the actual name very much
[10:25:53] <aatch> I couldn't see a decent way to get them from there.
[10:25:58] <strcat> I absolutely hate how it uses 'a atm since it looks like a lifetime
[10:25:59] <nmatsakis> I agree it's a separate PR,
[10:26:06] <nmatsakis> though it's really not very hard to fix.
[10:26:11] <xenocons> strcat: that sql fuzz stuff in tcl for sqlite is pretty nice
[10:26:20] <nmatsakis> aatch: still I think i'd prefer to use something that's obviously bogus, like %T
[10:26:27] <strcat> the sqlite dev really likes tcl ;p
[10:26:43] <nmatsakis> aatch: I feel like it'd be pretty confusing if I wrote "fn foo<U,T>" and I get back an error message with T and U reversed :)
[10:26:48] <strcat> a "stringly typed language" :)
[10:27:05] <nmatsakis> aatch: though that does seem, admittedly, somewhat unlikely.
[10:27:09] <xenocons> strcat: a ruxcon guy i know really likes it too, and hes very switched on so im sure there is something in it
[10:27:16] *** Joins: Boreeas (Boreeas@moz-F35C832D.boreeas.net)
[10:27:41] <aatch> nmatsakis, well how much work would be involved getting the actual name?
[10:27:41] <strcat> xenocons: it's very good at dealing with stuff like events and async
[10:28:07] <xenocons> mm makes sense
[10:28:09] <strcat> my experience with tcl involves trying and failing to fix a gitk bug
[10:28:09] <nmatsakis> aatch: not too much, I just nevre decided on the best way to do it :)
[10:28:21] <nmatsakis> aatch: I was just thinking "oh I should fix that instead of introducing yet another hack"
[10:28:34] <xenocons> strcat: heh
[10:28:37] <nmatsakis> but not at this second, gotta go, bbl...
[10:28:42] <roo> xenocons: I just read something about this IRT languages (like haskell, and go) that have a current parser in the std library. You have a test coverage tool that randomizes part of the library code in a way that still parses (within some parameters), and you can judge the coverage of the tests based on the pass rate (passing is bad)
[10:28:48] <xenocons> kinda like my experience with forth, ends in sadness 
[10:29:06] <xenocons> roo: ahh, interesting
[10:29:35] *** Quits: roo (Mibbit@moz-4B501CF5.dynamic.ip.windstream.net) (Quit: http://www.mibbit.com ajax IRC Client)
[10:29:50] *** Joins: roo (Mibbit@moz-4B501CF5.dynamic.ip.windstream.net)
[10:29:57] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[10:30:12] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[10:30:27] <xenocons> this is a huge area of research
[10:30:45] *** Quits: cr (anonymous@moz-32725F28.dip0.t-ipconnect.de) (Quit: cr)
[10:30:46] <xenocons> but i digress
[10:32:23] * xenocons scratches chin and thinks of next rust project
[10:32:48] <strcat> rusti: Some(5) + None
[10:32:51] -rusti- Some(5)
[10:32:55] <strcat> rusti: Some(5) + Some(2)
[10:32:56] -rusti- Some(7)
[10:33:08] *** Joins: thiez (thiez@moz-BF669398.student.utwente.nl)
[10:33:20] * strcat doesn't really like that we have that ;p
[10:33:32] <strcat> even though it'd be useful for what I want atm...
[10:33:33] <xenocons> polymorphic `+' is kinda my pet hate
[10:33:33] <xenocons> heh
[10:33:52] <strcat> well it's kind of a weird thing to have since the implementation isn't obvious
[10:33:54] <strcat> Some(2) + None
[10:33:57] <strcat> None, or 2?
[10:34:00] <xenocons> cause of many (imo) unncessery type annotations
[10:34:08] <xenocons> yeah
[10:34:16] <xenocons> thats kinda like javascripts = [] thingy
[10:34:17] <kimundi> strcat: I
[10:34:43] <xenocons> (but ill admit polymorphic `+' over vector and matrix types is somewhat desirable)
[10:35:09] <kimundi> I'd argue it should be None, cause you
[10:35:32] <kimundi> grr damn tiny keyboard
[10:35:38] <xenocons> heh
[10:36:05] <xenocons> im gona need to hear your explanation of why 2 + 0 should equal 0  ;)
[10:36:22] <Blei> i'd argue against + on Option
[10:36:34] <xenocons> agree
[10:36:41] <strcat> xenocons: not 0, but None
[10:36:48] <kimundi> anyway, Some(0) !=None, so why should it result in the same value
[10:36:59] <xenocons> strcat: shall we launch into '0 is not a number' :)
[10:37:20] <strcat> anyway our + impl on Option is MonadPlus
[10:37:22] <strcat> but...
[10:37:24] <strcat> that's not obvious
[10:37:32] <xenocons> but yeh, if i had to guess about Some 4 + None, i would have guessed type error
[10:37:36] <strcat> there are other possible definitions ;p
[10:37:42] <strcat> xenocons: same type though
[10:37:46] <strcat> Option<int>
[10:37:47] *** Joins: MaikKlein (maik@B9A7424F.3D69E65D.A6DC652B.IP)
[10:38:01] <xenocons> true, but Option<int> probably shouldnt support + operator
[10:38:02] <xenocons> but...
[10:38:09] <xenocons> this is just based on my bias
[10:39:21] <strcat> hrm
[10:39:31] <strcat> I wonder if size_hint should just return 0 by default
[10:39:35] <strcat> instead of being an Option
[10:39:36] <xenocons> should be forced to decompose optiontype before use _always_
[10:39:38] <strcat> it's just a minimum size
[10:39:54] <xenocons> (another bias from ML)
[10:40:01] * strcat will just use 0 by default
[10:40:03] <strcat> Option is silly here
[10:40:08] <kimundi> strcat: Didn
[10:40:41] <strcat> didn't?
[10:40:41] <kimundi> t you describe it as a maximum size before?
[10:40:47] <xenocons> heh
[10:40:49] <strcat> no, minimum
[10:40:56] <strcat> maximum isn't very useful since it's for reserving space
[10:41:11] <strcat> you don't want to over-reserve, especially with fallocate
[10:41:18] <xenocons> rusti: [1,2,3,4].max()
[10:41:19] -rusti- <anon>:9:9: 10:5 error: failed to find an implementation of trait std::iterator::Iterator<<V5>> for [int, .. 4]
[10:41:19] -rusti- <anon>:9          [1,2,3,4].max()
[10:41:19] -rusti- <anon>:10     };
[10:41:19] -rusti- application terminated with error code 101
[10:41:33] <xenocons> rusti: ([1,2,3,4]).max()
[10:41:34] -rusti- <anon>:9:9: 10:5 error: failed to find an implementation of trait std::iterator::Iterator<<V5>> for [int, .. 4]
[10:41:34] -rusti- <anon>:9          ([1,2,3,4]).max()
[10:41:34] -rusti- <anon>:10     };
[10:41:34] -rusti- application terminated with error code 101
[10:41:42] <strcat> rusti: [1, 2, 3, 4].iter().max()
[10:41:43] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/CPiH
[10:41:49] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[10:41:52] <strcat> rusti: fmt("%?", [1, 2, 3, 4].iter().max())
[10:41:53] -rusti- <anon>:9:9: 9:12 error: unresolved name `fmt`.
[10:41:53] -rusti- <anon>:9          fmt("%?", [1, 2, 3, 4].iter().max())
[10:41:53] -rusti-                   ^~~
[10:41:53] -rusti- error: aborting due to previous error
[10:41:53] -rusti- application terminated with error code 101
[10:41:57] <strcat> rusti: fmt!("%?", [1, 2, 3, 4].iter().max())
[10:41:58] * strcat sighs
[10:41:58] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/RceE
[10:42:08] <xenocons> i like seeing strcat fight with his own creation
[10:42:21] <strcat> rusti: let xs = [1, 2, 3, 4]; fmt!("%?", xs.iter().max())
[10:42:22] -rusti- ~"Some(&4)"
[10:42:26] <strcat> rvalues don't work well atm
[10:42:31] <xenocons> heh, nice
[10:42:32] <strcat> it doesn't like rvalue.iter().foo()
[10:42:45] <strcat> rvalue.iter() ? that's fine
[10:42:46] <xenocons> also your choice of xs as a binding name... i smell haskell
[10:42:56] * strcat likes that convention
[10:43:01] * xenocons does too
[10:43:11] <aatch> it's also (maybe originally) as Prolog convention
[10:43:12] <xenocons> i even use xss 
[10:43:20] <xenocons> aatch: really?
[10:43:21] <strcat> well
[10:43:22] <aatch> s/as/a
[10:43:26] <strcat> I use 'animals' and 'animal'
[10:43:30] <strcat> so why not 'xs' and 'x'? ;p
[10:43:40] <xenocons> strcat: x for value, xs for sequence
[10:43:41] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[10:43:45] <xenocons> xss for sequence of sequences
[10:43:46] <xenocons> etc
[10:43:48] <xenocons> (imo)
[10:43:52] <aatch> xenocons, yeah, though it's X and XS/Xs
[10:44:01] <xenocons> ah
[10:44:09] <xenocons> so my colleagues really hate when i do this in code
[10:44:17] <aatch> but that's because capitalisation matters in Prolog
[10:44:17] <xenocons> 'fucking put names on ur variables' etc
[10:44:34] <aatch> xenocons, depends on the context.
[10:44:39] <strcat> sometimes things don't have names, especially in generic code
[10:44:41] <strcat> generic_thing?
[10:44:46] <strcat> generic_sequence_of_things? ;p
[10:44:52] <xenocons> also, theyre very easy to type on the keyboard, also xs have symmetry i cant find elsewhere
[10:45:16] <xenocons> i hate the letters j l q y etc
[10:45:57] <aatch> xenocons, i and j have their roots in mathematics though
[10:46:08] <strcat> rusti: std::vec::with_capacity(0)
[10:46:09] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/QQiH
[10:46:20] <xenocons> yeah aatch especially vector\matrix stuff
[10:46:25] <strcat> rusti: std::vec::with_capacity::<~[u8]>(0)
[10:46:26] -rusti- ~[]
[10:46:32] <xenocons> i dislike though, i prefer to use 'n' instead of 'i'
[10:46:39] <xenocons> it makes more sense mathematically too imho
[10:46:47] <aatch> xenocons, again, it's in maths.
[10:47:02] <xenocons> i think 'n' is an acceptable substitution for 'i'
[10:47:09] <aatch> xenocons, not always though
[10:47:19] <xenocons> aatch: but symmetry :(
[10:47:21] <aatch> and i is often a decent shorthand for "index"
[10:47:25] <xenocons> yeah
[10:47:29] <xenocons> i use idx sometimes
[10:47:30] <aatch> xenocons, "symmetry"?
[10:47:53] <xenocons> aatch: the letters themselves, i dont know how to explain this
[10:47:55] <strcat>     /// Return an lower bound on the remaining length of the iterator.
[10:47:57] <strcat>     ///
[10:47:59] <strcat>     /// The common use case for the estimate is pre-allocating space to store the results.
[10:47:59] <xenocons> 'o' is perfectly symmetrical
[10:48:01] <strcat>     fn size_hint(&self) -> uint { 0 }
[10:48:03] * strcat likes that better
[10:48:14] <aatch> xenocons, but that depends entirely on the font
[10:48:24] <xenocons> fn size_hint(&self) -> { 0u } ?
[10:48:25] <kimundi> strcat: It might make sense to have it be none instead of 0
[10:48:29] <strcat> kimundi: why?
[10:48:29] <xenocons> is return type ncessary
[10:48:37] <xenocons> aatch: yeah true
[10:48:38] <strcat> kimundi: I had it as None but I think this makes more sense
[10:48:46] <strcat> they're allowed to make an under-estimate and 0 is the lowest under-estimate
[10:48:52] <xenocons> aatch: ive got a horrible verticle alignment + symmetry issue
[10:48:58] <kimundi> no hint != hint 0
[10:49:05] <strcat> what's the difference?
[10:49:17] <aatch> kimundi, but that doesn't affect the operation of the iterator
[10:49:36] <strcat> hint 1 means they say they're at least 1
[10:49:40] <strcat> they could be 200
[10:49:56] <strcat> and it shouldn't be worse to make a conservative under-estimate than making none
[10:50:08] *** Quits: MaikKlein (maik@B9A7424F.3D69E65D.A6DC652B.IP) (Ping timeout)
[10:50:09] <aatch> what would it do differently? "Oh, they didn't hint, I'll just allocate all the memory, just in case"
[10:50:42] <strcat> I was only going to use None because python has that but.... it seems silly
[10:50:52] <strcat> they make it throw NotImplemented
[10:51:11] <kimundi> well 'no hint' tells the collection 'use defaults', 'hint 0' say 'I'll probably return no element, optimise for that'
[10:51:20] <strcat> kimundi: no, it doesn't mean that
[10:51:29] <strcat> if you say '5', it means *at least* 5
[10:51:41] <strcat> saying '5' should reserve at least as much as None
[10:51:56] <strcat> otherwise it encourages never hinting unless you know the exact #
[10:52:01] <strcat> it shouldn't ever be worse to hint
[10:52:28] <kimundi> but None might reserve more than 0
[10:52:36] <strcat> 0 might reserve more than 0
[10:52:42] <strcat> it's not "reserve this much"
[10:52:47] <strcat> it's "I will be at least this big"
[10:53:03] <strcat> there's no reason they'd change their default reserve to be below it
[10:53:06] <strcat> I could add exact_hint
[10:53:11] <strcat> but I don't know what's going to want to use it
[10:53:30] <kimundi> strcat: that isn't even what I mean
[10:54:21] * strcat thinks Option<uint> is not enough information to do anything more useful than uint
[10:54:35] <strcat> it could be
[10:54:43] <strcat> -> (Option<uint>, Option<uint>)
[10:54:45] <strcat> with a min and max
[10:54:55] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:55:02] * strcat will do that instead
[10:55:25] <strcat>     /// Return a lower bound and upper bound on the remaining length of the iterator.
[10:55:37] <strcat>     fn size_hint(&self) -> (Option<uint>, Option<uint>) { (Some(0), Some(0)) }
[10:58:50] *** Quits: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org) (Ping timeout)
[10:59:42] *** Joins: dbaupp (Thunderbir@moz-73E90475.lns20.syd6.internode.on.net)
[11:00:00] <aatch> strcat, one down!
[11:00:41] * strcat wonders if there's ever a valid reason to check if an iterator might be infinite
[11:00:43] <aatch> I mean, to go.
[11:00:50] <strcat> s/might/certainly is/
[11:01:02] <strcat> for now just this size hint
[11:01:39] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[11:01:42] *** Quits: sankha93 (Instantbir@403EB97.7C989436.8B6C1D65.IP) (Quit: Instantbird 1.4 -- http://www.instantbird.com)
[11:01:54] <strcat> kimundi: anyway lower and upper bound is a nice set of information
[11:02:02] <strcat> filter can give an upper bound, not a lower bound
[11:02:21] <aatch> strcat, your vec thing landed!
[11:02:27] <strcat> yay!
[11:03:31] <aatch> Come on bors
[11:03:35] <aatch> wakey wakey
[11:04:10] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[11:05:04] <strcat>     fn size_hint(&self) -> (Option<uint>, Option<uint>) {
[11:05:06] *** Joins: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org)
[11:05:06] <strcat>         let (_, upper) = self.iter.size_hint();
[11:05:08] <strcat>         (None, upper)
[11:05:10] <strcat>     }
[11:05:12] <strcat> that works well (filter).
[11:05:32] <roo> I see these chain functions/methods in std::option, but is there a tricky way to use them that minimizes nesting? (thinking maybe monad type stuff)
[11:06:04] <aatch> roo, example?
[11:06:37] <aatch> most of them are able to be chained like iter().transform(|x| ...).filter(|x| ...)
[11:07:10] *** Joins: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP)
[11:07:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/8F8xaw
[11:07:10] *** Parts: ghrust (ghrust@AD60B2E3.6A2AE50.F3114085.IP) ()
[11:09:46] <dbaupp> aatch: that's iterators, not .chain
[11:10:06] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[11:10:06] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/GxjI4Q
[11:10:06] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[11:10:07] <aatch> dbaupp, oh right.
[11:10:18] <aatch> NEVERMIND ME
[11:10:46] <dbaupp> roo: not really, although it's slightly possible to implement haskell-style do notation as a macro/syntax extensions
[11:10:51] <strcat> rusti: Some(5).chain(|x| Some(2 + x))
[11:10:52] -rusti- Some(7)
[11:10:58] <strcat> rusti: None.chain(|x| Some(2 + x))
[11:10:59] -rusti- None
[11:11:21] <roo> yeah, I was thinking a macro that expanded to a big knotted mess of match statements/chains
[11:11:44] <cmr> nmatsakis: yes
[11:12:31] <dbaupp> roo: you write a macro like `chain!(Some(foo), |x| ..., |y| ..., |z| ... )`
[11:12:37] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[11:12:46] <cmr> nmatsakis: loopks like you already patched it up, I'll run it through
[11:12:47] <aatch> strcat, your vec stuff had suprisingly few conflicts with my big PR
[11:13:08] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[11:13:08] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/GxjI4Q
[11:13:08] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[11:13:10] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[11:13:10] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/AgKNJQ
[11:13:10] <ghrust> 13rust/06auto 14474bd60 15Young-il Choi: rt: fix jemalloc android cross-compile for mac
[11:13:10] <ghrust> 13rust/06auto 1445f588e 15bors: auto merge of #7200 : yichoi/rust/fix_je_mac_cross, r=brson...
[11:13:11] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[11:13:42] <roo> dbaupp: is there actually a chain macro? that would be great
[11:13:58] <dbaupp> roo: something like `macro_rules! chain ( ($opt:expr) => { $opt }, ($opt:expr, $func:expr, $($rest:expr),*) => { chain!(($opt).chain($func), $(rest),*) } )`
[11:14:20] <dbaupp> (that's unlikely to work straight out...)
[11:14:27] <roo> lol, right
[11:14:34] *** Joins: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com)
[11:14:34] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[11:15:00] <dbaupp> rusti: macro_rules! chain ( ($opt:expr) => { $opt }; ($opt:expr, $func:expr, $($rest:expr),*) => { chain!(($opt).chain($func), $(rest),*) } ) chain!(None::<int>, |x| x + 1, |y| y * 2)
[11:15:01] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/OSfX
[11:15:17] <dbaupp> rusti: macro_rules! chain ( ($opt:expr) => { $opt }; ($opt:expr, $func:expr, $($rest:expr),*) => { chain!(($opt).chain($func), $($rest),*) } ) chain!(None::<int>, |x| x + 1, |y| y * 2)
[11:15:18] -rusti- line longer than 150 columns, pastebinned: http://sprunge.us/OWAf
[11:16:38] *** Quits: Blei (philipp@moz-650B9C6A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[11:17:23] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[11:17:27] <dbaupp> roo: hmm, it might not be easily possible... I can't seem to get it to work because of trailing/missing commas :(
[11:18:24] <strcat> aatch: my chain size_hint is cleverer than I thought one of these would be ;p
[11:18:47] <strcat> aatch: http://ix.io/6iO
[11:19:19] <aatch> strcat, heh, that's pretty cool
[11:19:25] <roo> dbaupp: That it is questionably possible is good enough for me atm. I needed a good reason to get more familiar with rust macros
[11:19:46] <aatch> roo, fair warning, some things that should work, don't
[11:21:30] <aatch> I'm hoping the failures on this are unrelated to it: https://github.com/mozilla/rust/pull/7259
[11:21:54] <dbaupp> strcat: that's pretty neat!
[11:21:57] *** Joins: doener (doener@moz-121949B3.unitymediagroup.de)
[11:22:27] <doener> aatch: can you revoke the @retry? 32bit builds fail locally for me, too
[11:22:55] <aatch> doener, oh. Not sure if I can revoke it.
[11:22:57] <doener> aatch: the ABIInfo for X86 seems to differ
[11:23:13] *** Quits: fabiand (fabiand@moz-9067042C.adsl.alicedsl.de) (Quit: Verlassend)
[11:23:23] <aatch> but I think that if you push a commit it'll stop it.
[11:23:33] <aatch> so you have like, an hour.
[11:23:44] <doener> k
[11:23:51] *** Joins: fabiand (fabiand@moz-9067042C.adsl.alicedsl.de)
[11:23:57] <aatch> or 2, depending on what bots get the builds
[11:25:04] <aatch> doener, it's just that I'm pretty that PR is from before the tree closure.
[11:25:46] <doener> it's from yesterday
[11:25:51] *** kimundi is now known as zz_kimundi
[11:26:09] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[11:26:30] <doener> I just never tested it on 32bit before
[11:26:37] <aatch> doener, oh yeah. I mis-read the logs
[11:26:42] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[11:26:51] <aatch> though it still had all the warnings that I cleaned up
[11:26:58] <aatch> s/thought/though
[11:26:58] <strcat> aatch: heh, all of them are a bit clever ;p
[11:27:08] <doener> based on an old version I guess
[11:27:09] <aatch> strcat, cool.
[11:27:13] <strcat> zip, for example
[11:27:21] * strcat didn't expect them all to be able to return something useful :)
[11:30:16] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[11:30:51] *** Quits: novabyte (Instantbir@moz-3E0F9699.cable.virginmedia.com) (Quit: bye bye)
[11:32:15] *** Joins: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net)
[11:33:01] *** Quits: dylukes (dylukes@moz-E4DF3FED.pitbpa.fios.verizon.net) (Quit: Computer has gone to sleep.)
[11:34:59] *** zz_kimundi is now known as kimundi
[11:36:46] <dbaupp> who's gonna go through and remove all the *Util traits? ;P
[11:37:00] <strcat> dbaupp: some should stay, I think
[11:37:04] <strcat> when overriding doesn't make sense
[11:37:14] <dbaupp> strcat: sure
[11:37:23] <cmr> Did default methods land!?
[11:37:31] <strcat> yep they work
[11:37:33] <cmr> sully: <333
[11:37:34] <aatch> cmr, yep a few hours ago
[11:37:36] <strcat> adding an iterator size hint right now
[11:37:46] <cmr> twir is going to be so awesome
[11:38:01] *** Joins: EXetoC (ex@moz-2DBEB1E4.customer.t3.se)
[11:38:34] <strcat> rusti: let xs: ~[int] = std::vec::with_capacity(0); vec::capacity(&xs)
[11:38:34] <aatch> has anybody fixed method lookup yet?
[11:38:36] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/SIJX
[11:38:41] <strcat> rusti: let xs: ~[int] = std::vec::with_capacity(0); std::vec::capacity(&xs)
[11:38:43] -rusti- 4
[11:38:51] <strcat> rusti: let xs: ~[int] = ~[1]; std::vec::capacity(&xs)
[11:38:52] -rusti- 4
[11:39:05] <cmr> I think vec should probably be reexported in the prelude, its free functions are pretty useful.
[11:39:21] <doener> aatch: ok, the x86 ABI was missing the case where there's no return value defined. Fixed that and pushed a new version
[11:39:29] <aatch> doener, cool
[11:40:00] <doener> i.e. kind of an existing bug that was uncovered by my changes
[11:40:25] <doener> lunch time
[11:40:34] <aatch> I'm not sure if bors will handle it properly, but I can kill the build if things go wrong
[11:40:34] <strcat> error: internal compiler error: ty::Region#subst(): Reference to self region when given substs with no self region: substs(self_r=None, self_ty=None, tps=[char])
[11:40:37] <strcat> ;[
[11:40:59] * strcat isn't referring to the self region!
[11:41:05] <dbaupp> aatch: #5898? you mean?
[11:41:31] <dbaupp> strcat: um, is that only happening cross crate?
[11:41:35] <cmr> ty::Region#subst()? what does that even mean?
[11:41:38] <strcat> dbaupp: no
[11:41:47] <strcat> in libstd
[11:41:50] <rubber-duck> what's the simplest way to read in a text file from Path in to a ~str
[11:42:08] <dbaupp> rubber-duck: read_whole_file_str (or something)
[11:42:10] * dbaupp checks
[11:42:13] <cmr> rubber-duck: io::read_whole_file_str
[11:43:25] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[11:43:25] <rubber-duck> wtf is wrong with me - I was watching io.html and I somehow missed the function name that exactly spells my problem :(
[11:43:41] *** Joins: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de)
[11:43:44] <cmr> try reading instead of watching :p
[11:44:02] <aatch> cmr, but what if it attacks!
[11:44:05] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:44:25] *** Joins: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net)
[11:44:40] <strcat> error: internal compiler error: unexpected failure
[11:44:41] <strcat> heh
[11:45:10] <dbaupp> rubber-duck: rust's documentation basically sucks... it's not your fault :)
[11:45:16] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[11:45:18] <dbaupp> (the formatting especially)
[11:46:33] <aatch> I should probably go to bed soon, I saw this: "Avoid unnecessary scratch datums for by-copy function arguments", and read "scratch datums" as "scrotums"
[11:47:12] <strcat> aatch: http://www.peereboom.us/scrotwm/html/scrotwm.html
[11:47:16] <cmr> heh
[11:47:28] <dbaupp> aatch: I guess having unnecessary scrotums would be suboptimal
[11:49:30] <strcat> huh
[11:49:32] <strcat> stupid closures
[11:49:49] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Ping timeout)
[11:50:47] *** Joins: BitPuffin (quassel@moz-C9229CA7.cust.tele2.se)
[11:51:39] *** Joins: roo2 (Mibbit@moz-AAAACAA9.dynamic.ip.windstream.net)
[11:52:48] *** Quits: roo (Mibbit@moz-4B501CF5.dynamic.ip.windstream.net) (Quit: http://www.mibbit.com ajax IRC Client)
[11:52:52] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[11:53:06] *** roo2 is now known as roo
[11:56:11] *** Joins: colm (Mibbit@ACCB1FA5.56D08FB8.27B55A41.IP)
[11:56:44] *** Quits: colm (Mibbit@ACCB1FA5.56D08FB8.27B55A41.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:56:49] *** Joins: moslemfromegypt (muslimmasr@4B086B47.12C09493.563BE9DB.IP)
[11:56:52] *** Quits: moslemfromegypt (muslimmasr@4B086B47.12C09493.563BE9DB.IP) (User has been banned from Mozilla (abuse))
[12:01:08] <roo> I want to look at what some macro is expanding to. How would I go about that?
[12:01:30] <dbaupp> roo: pass `--pretty expanded` to rustc
[12:01:43] <roo> dbaupp: thanks
[12:03:30] <strcat> dbaupp: http://ix.io/6iT this part doesn't work ;[
[12:03:33] <strcat> the rest does
[12:03:44] <strcat> FromIterator::from_iterator(&mut it) // works
[12:04:47] <dbaupp> strcat: so it's just the `Self`?
[12:04:55] <strcat> dunno
[12:04:57] <strcat> dbaupp: 'self region
[12:04:59] <strcat> not Self
[12:05:26] <dbaupp> where's the self region?
[12:05:41] <strcat> from VecIterator, it's not there
[12:06:10] <strcat> it's from IteratorUtil for VecIterator<'self, A>
[12:06:11] <dbaupp> oh... file a bug, I guess :(
[12:06:42] <dbaupp> are you not removing VecIterator?
[12:07:41] <dbaupp> err, sorry, IteratorUtil
[12:07:41] *** Quits: BitPuffin (quassel@moz-C9229CA7.cust.tele2.se) (Connection reset by peer)
[12:07:45] <strcat> dbaupp: not yet
[12:07:53] <strcat> dbaupp: I'll rm bits of it
[12:08:00] <strcat> ones that can actually be usefully overrided
[12:08:12] <strcat> but...
[12:08:13] <strcat> can they?
[12:08:48] <strcat> you could observe a different between a `len` not consuming the iterator and one consuming it
[12:08:50] <strcat> would be weird
[12:09:08] * strcat doesn't want to think about that yet
[12:10:59] *** Joins: BitPuffin (quassel@moz-2886C88C.cust.tele2.se)
[12:11:09] *** Joins: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[12:11:58] <strcat> dbaupp: have to rebase it a bit
[12:12:01] <strcat> forgot stage0 stuff
[12:12:28] <dbaupp> strcat: ah right
[12:13:18] *** Joins: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au)
[12:13:19] *** Quits: BitPuffin (quassel@moz-2886C88C.cust.tele2.se) (Connection reset by peer)
[12:13:35] *** Joins: BitPuffin (quassel@moz-A9E6864F.cust.tele2.se)
[12:14:12] <strcat> dbaupp: https://github.com/mozilla/rust/pull/7274 there, that should be good
[12:14:13] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[12:15:28] *** kimundi is now known as zz_kimundi
[12:15:44] <engla> so default methods are finally real?
[12:15:57] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[12:16:04] <aatch> engla, yes
[12:16:20] <aatch> don't expect them to work in every case, but they do work.
[12:16:31] *** Quits: fabiand (fabiand@moz-9067042C.adsl.alicedsl.de) (Quit: Verlassend)
[12:16:52] *** Joins: pyrac (pyrac@EDE6BD92.73C89388.AD05C589.IP)
[12:16:54] <engla> great
[12:16:55] * aatch has been putting off llvm-rs for this
[12:16:59] <doener> what are default methods?
[12:17:01] *** Joins: mleise (marco@moz-3468AB5B.pools.arcor-ip.net)
[12:17:08] <strcat> doener: https://github.com/mozilla/rust/pull/7274/files example
[12:17:14] <engla> doener: default implementations of methods in traits
[12:17:19] <strcat> doener: it's a method with an impl provided by the trait but you can override it
[12:17:21] <aatch> doener, providing an implemention for a method in a trait
[12:17:24] <cmr> aatch: a proper llvm wrapper?
[12:17:30] <aatch> cmr, yes
[12:17:33] <cmr> delicious
[12:17:49] <doener> ah
[12:20:08] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[12:20:48] * dbaupp thinks aatch should finish llvm-rs and port rustc to use it
[12:20:58] <dbaupp> (preferably by the end of the weekend. ;P) 
[12:21:02] *** Quits: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de) (Ping timeout)
[12:21:32] <cmr> heh
[12:21:39] <aatch> Working on trans has given me some decent ideas on what the wrapper needs though.
[12:21:42] <aatch> Which is nice
[12:22:08] <dbaupp> yeah, it's good to have some field experience
[12:22:17] <strcat> so many things we can make into default methods though
[12:22:51] <cmr> Is anyone handy with web design? I'm probably going to need lots of help working on a rustdoc mockup
[12:23:10] <dbaupp> strcat: I've been waiting for default methods since I started using rust!
[12:23:13] * dbaupp is very happy
[12:23:21] <aatch> cmr, I could probably do a bit, at least in terms of UX
[12:23:37] <bjz_> cmr: I can give design critique
[12:23:38] <aatch> not so much with actual design, like colors and shit
[12:23:40] *** Quits: BitPuffin (quassel@moz-A9E6864F.cust.tele2.se) (Connection reset by peer)
[12:23:50] <cmr> I can do colors and shit, but I can't implement stuff
[12:23:54] <aatch> But my day job is a web developer
[12:23:58] * bjz_ 's background is in graphic design
[12:24:02] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[12:24:11] <dbaupp> cmr: you have a whole team!
[12:24:28] <dbaupp> (I'd be happy to help with bits and pieces, I don't have much to offer though.)
[12:24:46] <aatch> cmr, I don't mind helping out with javascript and stuff too.
[12:25:02] <cmr> js I can do, it's the css bits that give me nightmares
[12:25:15] <dbaupp> cmr: css is awesome
[12:25:26] <dbaupp> (now that it's turing complete)
[12:25:35] <aatch> dbaupp, spoken like somebody that has spent enough time with CSS
[12:25:36] <bjz_> I noticed some of the colours have changed in the docs
[12:25:56] <rubber-duck> do I have to write a custom iterator to get char iterator + byte offset of char (ie. str.iter -> Iterator<(char, uint)>) ?
[12:26:02] <cmr> dbaupp: that may be, but the current box model is not something I like tot hink about
[12:26:13] <dbaupp> rubber-duck: no, you can use .scan
[12:26:49] *** Joins: BitPuffin (quassel@moz-59B5FDEC.cust.tele2.se)
[12:26:49] <dbaupp> rubber-duck: (which creates a new iterator... char::len_utf8_bytes is probably helpful)
[12:26:52] <cmr> flexbox and grid and regions will make it better, hopefully
[12:26:54] <aatch> cmr, how much in terms of functionality do you have specced out so far?
[12:27:01] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[12:27:12] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[12:27:23] <cmr> aatch: right now I'm mostly working out presentation. What is the best way to present rust source in documentation?
[12:27:28] <cmr> And what I currently think is:
[12:27:28] <dbaupp> rubber-duck: I forgot about implementing that when I was doing the str iterators :(
[12:27:52] <strcat> dbaupp: the vec module is starting to be clean now
[12:27:56] <strcat> at least, of internal iterators
[12:28:02] <strcat> still tons of free function duplication
[12:28:05] <dbaupp> strcat: yay!
[12:28:13] <cmr> Structs are the main documented unit. A struct's documentation will be its documentation plus documentation of any impls for it. The trait impls will link to the trati's documentation, which will also list everything it can see that implements it, as well as docs for it and its default methods
[12:28:21] <strcat> dbaupp: the only big offender left is 'each' (there are more but... they aren't as bad)
[12:28:25] * strcat will tackle that next
[12:28:29] <strcat> break *all* the code ;p
[12:28:37] <cmr> Generic impls will be attached to the trait (ie, implt<T:Foo> Trait for T)
[12:28:40] <dbaupp> strcat: it'll be awesome!
[12:28:55] <rubber-duck> dbaupp, I can't find .scan - what module is it in ?
[12:29:02] <cmr> Not sure how well this will work out yet, just an idea I had over my tea
[12:29:05] <dbaupp> rubber-duck: it should be in std::iterator
[12:29:09] * dbaupp checks
[12:29:18] <rubber-duck> yea
[12:29:21] <rubber-duck> I was looking at str
[12:29:44] <strcat> dbaupp: I killed extendediter in vec
[12:29:46] <strcat> so...
[12:29:48] <strcat> baseiter can go now
[12:29:50] <strcat> ;p
[12:30:19] <aatch> cmr, hmmm, sounds ok. I might mock-up something tomorrow
[12:30:29] <dbaupp> rubber-duck: something like `str_iter.scan(0, |pos, c| { let ret = (*pos, c); *pos += std::char::len_utf8_bytes(c); ret })`
[12:30:36] <aatch> right now though, bed
[12:30:40] *** aatch is now known as aatch|bed
[12:30:50] <dbaupp> strcat: sweet!
[12:31:01] <dbaupp> does anything else use baseiter?
[12:31:06] <strcat> old_iter
[12:31:10] <strcat> free fns
[12:31:13] <dbaupp> (anything that doesn't have an external iterator?)
[12:31:13] <strcat> opt vec
[12:31:14] <strcat> etc
[12:31:19] <strcat> dbaupp: maybe
[12:31:28] <strcat> optvec
[12:31:49] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[12:32:03] <dbaupp> bitv
[12:32:24] <strcat> anyway this is the big thing blocking updating 'for'
[12:32:29] <dbaupp> yeah
[12:32:38] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[12:36:26] *** Joins: cr (anonymous@moz-32725F28.dip0.t-ipconnect.de)
[12:36:38] *** Joins: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se)
[12:46:08] <strcat> dbaupp: libstd (not tests) done ;p
[12:46:14] * strcat sighs
[12:46:38] <dbaupp> strcat: with sed?
[12:46:59] <strcat> dbaupp: no, there are too many things with each :(
[12:47:14] <dbaupp> eurgh :(
[12:49:09] <engla> i'm sending the hashmap iterator pull req now soon
[12:49:27] <engla> but it will be simple, no cross tree replacements of .each, just the iterator impl
[12:51:01] *** Quits: cowboyd (cowboyd@moz-DD0FF83.lightspeed.austtx.sbcglobal.net) (Client exited)
[12:51:41] <dbaupp> strcat: I just checked, `clang -std=c11 -O3 -x c - <<< 'int main() { main(); return 0; }' && ./a.out` works fine
[12:52:23] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:52:26] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Connection reset by peer)
[12:52:29] *** Joins: maxli1 (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:52:31] <strcat> heh
[12:52:39] <dbaupp> it compiles to `main:       xorl    %eax, %eax        ret`
[12:52:56] <strcat> dbaupp: what if it's not main?
[12:52:58] *** Quits: maxli1 (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[12:52:59] <dbaupp> it seems that llvm can eliminate infinite recursion?
[12:53:03] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[12:53:04] <cmr> is calling main undef behavior?
[12:53:10] <strcat> dbaupp: well it has TCO so it turns into an infinite loop
[12:53:20] <strcat> and I guess it can eliminate infinite loops...
[12:53:41] <dbaupp> same thing
[12:54:06] <strcat> dbaupp: it doesn't rm a loop
[12:54:08] <strcat> ;\
[12:54:10] <strcat> only infinite recursion
[12:54:37] <strcat> weird
[12:55:00] <strcat> dbaupp: http://llvm.org/bugs/show_bug.cgi?id=965
[12:55:10] <strcat> Reported: 2006-10-22 19:33 CDT by Nikhil Patil 
[12:55:49] <dbaupp> cool
[12:57:03] <dbaupp> (it appears Rust does the same thing to `fn main() { main() }`, which isn't surprising)
[12:57:20] <dbaupp> I guess aatch's diagnosis is correct?
[12:57:36] *** Quits: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se) (Quit: threecreepio)
[12:57:41] <strcat> dbaupp: but it's an LLVM bug
[12:57:47] <strcat> they don't consider it correct
[12:58:01] <dbaupp> strcat: yeah, but there's not much we can do about it
[12:58:05] <strcat> right
[12:59:35] *** Joins: roo2 (Mibbit@moz-2C2F6B6F.dynamic.ip.windstream.net)
[13:01:40] *** Quits: roo (Mibbit@moz-AAAACAA9.dynamic.ip.windstream.net) (Quit: http://www.mibbit.com ajax IRC Client)
[13:02:54] *** Joins: sw17ch (sw17ch@moz-39D8564F.wndsny.tds.net)
[13:08:34] <nmatsakis> cmr: there are various annoying test failures (e.g., pretty-printer) in that branch still, fixing them...not sure if that'll disrupt your measurement.
[13:11:13] *** Joins: RMF (RMF@moz-8C13D5A2.dsl.telepac.pt)
[13:11:24] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[13:11:40] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[13:13:35] <cmr> nmatsakis: nah I don't run tests
[13:14:09] <nmatsakis> cmr: I thought that was likely
[13:14:24] *** Joins: pnkfelix|rcirc (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[13:14:35] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[13:14:44] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[13:15:13] <nmatsakis> strcat: I had a question for you about jemalloc...
[13:15:22] <strcat> hm?
[13:15:23] <nmatsakis> strcat: we used to have this env var RUST_POISON_ON_FREE that would overwrite freed memory
[13:15:32] <nmatsakis> strcat: I see that there is a jemalloc option for this,
[13:15:46] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[13:15:46] <nmatsakis> strcat: that you can switch on dynamically,
[13:16:09] <nmatsakis> strcat: I was thinking we should expose some runtime call like "enable_malloc_debugging()"
[13:16:28] <nmatsakis> strcat: that could be invoked by the various tests that currently are setup to use RUST_POISON_ON_FREE
[13:17:01] <nmatsakis> strcat: some of which are tied to ref-counting anyhow and will need to be adapted once GC lands...
[13:17:07] <nmatsakis> ...or removed.
[13:17:14] <cmr> A RUST_HEAP_INSTRUMENTATION=... that turns on mallctl options would be handy for that
[13:17:30] <strcat> nmatsakis: it also has stuff like heap profiling we could be using
[13:17:38] <strcat> first... need to fix the problem it was triggering though
[13:17:38] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[13:17:40] <strcat> it's disabled atm
[13:17:57] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[13:21:18] *** Joins: fabiand (fabiand@EE0093B4.3A27401E.16E13E53.IP)
[13:25:43] *** Joins: dylukes (dylukes@moz-B5418F79.hsd1.pa.comcast.net)
[13:26:04] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[13:31:07] <nmatsakis> strcat: oh. ok.
[13:31:23] <strcat> nmatsakis: it was triggering that stack canary failure
[13:31:33] <strcat> perhaps because it was overrunning the red zone, maybe something else
[13:33:12] <cmr> Blei was hunting it down, they thought it might have been incorrect stack allocation iirc
[13:33:34] *** Joins: monk (monk@moz-17CD0811.sunion.warwick.ac.uk)
[13:36:08] <cmr> They did it by having the stack canary its own page and mproctecting it. Would probably be able to run the testsuite under gdb with reverse debugging and pin it down exactly
[13:36:31] * dbaupp wonders if #[inline] works with default methods
[13:37:32] <strcat> error: internal compiler error: no type for node 42426: unknown node (id=42426) in fcx 7f4545cfce90
[13:37:35] <strcat> wat
[13:39:01] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[13:40:18] <dbaupp> error: internal compiler error: method not found in AST map?!
[13:40:25] *** Quits: dylukes (dylukes@moz-B5418F79.hsd1.pa.comcast.net) (Quit: ["Textual IRC Client: www.textualapp.com"])
[13:41:35] <dbaupp> error: internal compiler error: unimplemented type_of: ty_self
[13:41:35] <dbaupp> leaked memory in rust main loop (1 objects)
[13:41:40] <strcat> ?
[13:41:44] * dbaupp thinks default methods aren't quite ready
[13:41:58] <strcat> they're as ready as the rest of the language
[13:42:02] <dbaupp> heh
[13:42:03] <strcat> ;p
[13:42:12] *** Quits: BitPuffin (quassel@moz-59B5FDEC.cust.tele2.se) (Ping timeout)
[13:42:15] <strcat> not going to find bugs in default methods if we don't use them
[13:42:31] <dbaupp> yup
[13:42:43] <cmr> nmatsakis: yeah you caused a huge performance regression, sorry man
[13:43:06] <dbaupp> cmr: graph?
[13:43:13] <cmr> it's going, wait for it :p
[13:43:17] <cmr> (my internet upload is really slow)
[13:43:23] <dbaupp> heh
[13:43:38] <dbaupp> (aren't they only a few kilobytes?)
[13:43:44] <cmr> http://i.imgur.com/dGulvP5.png
[13:43:50] <strcat> https://github.com/thestinger/rust/commit/1512663a326f468be7f6ae6438cb331b79e4f82c somehow broke the compiler ;\
[13:43:55] <strcat> meh
[13:44:03] <dbaupp> cmr: "huge"?
[13:44:18] <dbaupp> strcat: :(
[13:44:22] <cmr> dbaupp: ok, so it's not as huge as aatch's optimization catch
[13:44:28] <cmr> dbaupp: but it's pretty significant
[13:46:11] <cmr> nmatsakis: The slowdown is all in llvm, looks like probably during codegen or the later optimization phases, so check the IR I guess, if you want to fix it
[13:46:33] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[13:46:46] <strcat> dbaupp: heh, isrustfastyet got screwed over ;\
[13:46:56] <strcat> because it's running many builds at the same time
[13:47:13] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[13:47:48] <strcat> maybe I didn't break libsyntax
[13:47:51] <strcat> maybe I just found a bug ;\
[13:47:52] <cmr> dbaupp: fwiw if the graphs where swapped, it's the kind of speedup pcwalton says "whoa" too. *shrug*
[13:48:12] <dbaupp> strcat: it's not *that* bad... before I set it to filter to only the opt ones, that was horrible
[13:48:28] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[13:48:30] <dbaupp> cmr: heh, I guess.
[13:49:01] <engla> strcat: what's the error?
[13:49:20] <strcat> sec
[13:49:55] <strcat> it's gone
[13:49:57] <strcat> ;\
[13:50:02] <strcat> but anyway was
[13:50:04] <Aetherspawn> Leaving this here since it's the coolest thing I've read in months: http://repetae.net/recent/out/classalias.html
[13:50:08] <strcat> error: internal compiler error: no type for node 42426: unknown node (id=42426) in fcx 7f4545cfce90
[13:50:20] <engla> hm ok
[13:50:37] <Aetherspawn> I know it says Haskell, but pretend it says Rust :)
[13:50:37] *** Joins: orshem (orshem@3545E24A.588A166C.E3D28531.IP)
[13:50:39] <Aetherspawn> hehe.
[13:51:15] <dbaupp> Aetherspawn: that is pretty nice
[13:51:26] * dbaupp wants it in Rust already
[13:51:29] <dbaupp> ;P
[13:51:32] <Aetherspawn> lol
[13:51:49] <Aetherspawn> ooh! tree is OPEN
[13:51:52] <Aetherspawn> how exciting.
[13:54:58] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Quit: Leaving)
[13:56:27] <orshem> hi fellas. how do i take a slice of a string? say a string without the first and the last letter
[13:56:54] <cmr> rusti: let s = "fooob"; s.slice(1, s.len()-1)
[13:56:55] *** Quits: dbaupp (Thunderbir@moz-73E90475.lns20.syd6.internode.on.net) (Ping timeout)
[13:56:57] -rusti- "ooo"
[13:57:42] <orshem> thanks cmr.
[13:57:54] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[13:58:06] <orshem> i thought there'd be a fancy syntax, like in python
[13:58:50] <cmr> Thread at https://mail.mozilla.org/pipermail/rust-dev/2012-April/001762.html has discussion of slice syntax
[13:58:59] <engla> rust is beautiful inside
[14:00:11] <orshem> engla: on the outside as well. i quite like rust syntax. though it is a bit heavy
[14:00:12] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[14:00:29] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[14:01:15] *** Joins: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw)
[14:01:20] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: WeeChat 0.4.1)
[14:02:00] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[14:02:19] <strcat> [iterator 3bf428e] vec: remove BaseIter implementation
[14:02:20] <strcat>  113 files changed, 558 insertions(+), 562 deletions(-)
[14:02:22] <strcat> nearly done librustc
[14:02:24] <cmr> orshem: what do you feel is heavy about it?
[14:02:24] <strcat> ...
[14:03:28] <orshem> just that compared to python, js or java there is more of it
[14:04:00] <orshem> not that there anything wrong with that
[14:04:03] <orshem> ...
[14:05:50] <engla> obviously it's much more noisy than Python and Haskell because there are sigils like ~ and & and &'self 
[14:05:50] <bstrie> orshem: though imo doing negative-indexing for counting from the end of the array probably wouldn't be accepted in rust, just because it might mask errors
[14:06:05] <engla> much simpler if everything is a gc box
[14:06:25] *** Quits: roo2 (Mibbit@moz-2C2F6B6F.dynamic.ip.windstream.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:06:31] <orshem> i'm actually kind of afraid to speak about the language here. last time i spoke about the problems i had with 3 types of pointers and pcwalton said he wanted to remove one. now i'm just afraid to speak :)
[14:07:02] *** Joins: roo (Mibbit@moz-5CBA6C47.dynamic.ip.windstream.net)
[14:07:07] <cmr> heh
[14:07:17] <bstrie> orshem: joke's on you, pcwalton just wants to shove one of our current pointers into a library so that we can have MORE pointers in the long run!
[14:08:35] <strcat> depends on what you consider a "pointer"
[14:08:42] <strcat> every type of object in python is a pointer type
[14:08:51] <engla> strcat: I couldn't remove the BaseIter impl for HashSet, it meets an unexpected failure. http://paste.debian.net/plain/11789
[14:09:10] <bstrie> strcat: you should write a blog post bashing python for its hundreds of pointer types
[14:10:45] <cmr> I don't feel like pointer is the correct name for the concept in rust (except unsafe pointers), I feel like reference or box is much more apt
[14:11:20] <strcat> and python always passes by reference, it builds an illusion of value semantics per type
[14:12:08] <bstrie> cmr: c++ users are used to calling smart pointers pointers and would probably balk at the word "box" per its use in java
[14:12:09] <strcat> based on whether it mutates or mutates+returns in stuff like +=
[14:12:17] *** Joins: mblbruce (mblbruce@moz-D00392B8.fagotten.org)
[14:12:37] <orshem> what the tutorial should make clear(er) is the difference between declaring pointer and pattern binding them. i'm still not completely clear on that
[14:12:59] <cmr> orshem: I don;'t even know what you just said
[14:13:20] <orshem> well you have fn(&self) 
[14:13:29] <monk> e.g. "for vs.each |&n| { ... }" looks like the parameter n is a pointer, but n refers to the value pointed to?
[14:13:34] <orshem> and then in the function you use self.something
[14:13:37] *** Joins: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP)
[14:13:42] <strcat> monk: it's a pattern
[14:13:43] <orshem> so self is a pointer right?
[14:13:48] <strcat> patterns are destructuring
[14:13:53] <strcat> they are the inverse of construction
[14:13:59] <strcat> let (a, b) = (1, 2)
[14:14:11] <orshem> but you declare it &self so i thought it must be the object itself not a pointer
[14:14:19] <strcat> (a, b) either builds a tuple (in an expression area) or destructures it (in a pattern area)
[14:14:29] <strcat> orshem: 'self' isn't a pointer, &self is
[14:14:31] <Aetherspawn> Slicing syntax?
[14:14:32] <cmr> orshem: &self is a borrowed pointer to the object
[14:14:41] <cmr> orshem: you can have fn foo(self) where self is passed by value
[14:14:42] <orshem> sorry if i'm unclear english is not my first language
[14:14:43] <Aetherspawn> Why not [a, b.., c]
[14:14:56] <Aetherspawn> (or for that matter, [_, b.., _])
[14:15:08] <cmr> Aetherspawn: As in python, foo[start:end:step]
[14:15:14] <strcat> Aetherspawn: it exists but it's not an irrefutable pattern
[14:15:30] <Aetherspawn> Not sure I understood, so I'm going to mute my suggestion.
[14:15:31] <Aetherspawn> :P
[14:15:37] <monk> strcat: sure, I'm used to pattern matching, but I'm also used to C++ style &x meaning "x is a reference" or *x for x is a pointer. I was thinking it might be what orshem was talking about.
[14:15:38] <orshem> cmr, but when you have fn(&self) and you use self in a the body of the function is it a pointer?
[14:16:07] <bstrie> Aetherspawn: we have that pattern today in rust, but you can't use it in assignment because of the possibility that the source vector is empty. it should eventually work for fixed-width vectors
[14:16:08] <strcat> orshem: yes, the type is &Self
[14:16:20] <Aetherspawn> Oh, you'd need to match
[14:16:26] <cmr> rusti: struct Foo {a: int, b: int}; let x: &Foo = ~Foo {a: 5, b: 10}; (x.a, x.b)
[14:16:27] -rusti- (5, 10)
[14:16:58] <bstrie> rusti: let foo = [1,2,3]; match foo { [a, ..b] => b }
[14:16:59] -rusti- <anon>:9:28: 9:55 error: non-exhaustive patterns: vectors of length 0 not covered
[14:16:59] -rusti- <anon>:9          let foo = [1,2,3]; match foo { [a, ..b] => b }
[14:16:59] -rusti-                                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~
[14:17:00] -rusti- error: aborting due to previous error
[14:17:00] -rusti- application terminated with error code 101
[14:17:05] <bstrie> so you need
[14:17:09] <cmr> Aetherspawn: >>> x = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
[14:17:15] <cmr> >>> x[3:7:2]
[14:17:17] <cmr> [4, 6]
[14:17:17] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[14:17:18] <strcat> bstrie: that should actually work for fixed-size vecs though
[14:17:19] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[14:17:20] <bstrie> rusti: let foo = [1,2,3]; match foo { [] => [0], [a, ..b] => b }
[14:17:20] -rusti- <anon>:9:63: 9:64 error: mismatched types: expected `[<VI3>, .. 1]` but found `&[<VI2>]` ([] storage differs: expected & but found 1)
[14:17:20] -rusti- <anon>:9          let foo = [1,2,3]; match foo { [] => [0], [a, ..b] => b }
[14:17:20] -rusti-                                                                         ^
[14:17:21] -rusti- error: aborting due to previous error
[14:17:21] -rusti- application terminated with error code 101
[14:17:23] <mblbruce> cmr: While playing around with modules yesterday I ran into an ICE on 0.6. Just now I tested it on master and the same thing sent rustc into what looks like an eternal loop, consuming quite some CPU and paging out a couple of GB of stuff before I killed it. The example does contain circular "mod <file>" references, so that may be it. Do you want me to create an issue or does anyone else want to confirm it first?
[14:17:25] <bstrie> you get the idea
[14:17:27] <strcat> it's a bug that it doesn't
[14:17:29] <bstrie> strcat: yes I know
[14:17:30] *** Joins: kini (kini@moz-92AA953A.members.linode.com)
[14:17:30] <Aetherspawn> rusti: let foo = [1,2,3]; match foo { [a, ..b] => b; [] => 1 }
[14:17:31] -rusti- <anon>:9:53: 9:54 error: expected `,` but found `;`
[14:17:31] -rusti- <anon>:9          let foo = [1,2,3]; match foo { [a, ..b] => b; [] => 1 }
[14:17:31] -rusti-                                                               ^
[14:17:31] -rusti- application terminated with error code 101
[14:17:39] <bstrie> I think I'm the one who filed the bug?
[14:17:46] <cmr> mblbruce: go ahead and create an issue
[14:17:58] <Aetherspawn> rusti: let foo = [1,2,3]; match foo { [a, ..b] => a, [] => 1 }
[14:17:58] -rusti- <anon>:9:46: 9:47 warning: unused variable: `b` [-W unused-variable (default)]
[14:17:59] -rusti- <anon>:9          let foo = [1,2,3]; match foo { [a, ..b] => a, [] => 1 }
[14:17:59] -rusti-                                                        ^
[14:17:59] -rusti- 1
[14:18:09] <mblbruce> cmr: Ok, will do.
[14:18:14] <monk> argh, that being a notification causes my client to ping :\
[14:18:16] <Aetherspawn> rusti: let foo = [9..12]; match foo { [a, ..b] => a, [] => 1 }
[14:18:17] -rusti- <anon>:9:21: 9:23 error: expected `]` but found `..`
[14:18:17] -rusti- <anon>:9          let foo = [9..12]; match foo { [a, ..b] => a, [] => 1 }
[14:18:17] -rusti-                               ^~
[14:18:17] -rusti- application terminated with error code 101
[14:18:25] <cmr> mblbruce: mind @mentioning me in it?
[14:18:26] <Aetherspawn> monk, I have the same complaint
[14:18:28] <cmr> (@cmr)
[14:18:36] <Aetherspawn> it pings my phone! D:
[14:18:54] <strcat> so use a client implementing the irc spec and not something else
[14:18:58] <cmr> Aetherspawn: monk: http://tools.ietf.org/html/rfc1459.html#section-4.4.2
[14:19:03] <mblbruce> cmr: Sure. Just including @cmr in the issue text is enough?
[14:19:04] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[14:19:07] <cmr> mblbruce: yes
[14:19:13] <Aetherspawn> Ideally yes, practically no.
[14:19:23] <Aetherspawn> I use IRCCloud for "BNC" and it pings me.
[14:19:29] <Aetherspawn> I don't have much of a choice.
[14:19:32] <Aetherspawn> It's a free service.
[14:20:13] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[14:20:25] <Sodel_the_V> Why does rusti send its responses as NOTICEs?
[14:20:39] <monk> I wonder why irssi pings when there's a notice
[14:20:44] <Sodel_the_V> Ah.
[14:20:47] <strcat> Sodel_the_V: read the link above
[14:20:55] <strcat> https://tools.ietf.org/html/rfc1459.html#section-4.4.2
[14:20:56] <Sodel_the_V> Just got to that part
[14:21:07] <monk> the rfc doesn't suggest that notices should be particularly alerting
[14:21:27] <Aetherspawn> could rusti instead /me ?
[14:21:31] <strcat> they misinterpreted it based on the name instead of the meaning
[14:21:34] * Aetherspawn 1
[14:21:35] * Aetherspawn 2
[14:21:38] <monk> strcat: yeah, I guess so.
[14:21:46] <strcat> Aetherspawn: no, can still bot loop that way via automated responses
[14:21:56] <strcat> lots of bots have inline request syntax
[14:22:13] <strcat> like a special !!
[14:22:38] <strcat> anyway I'm happy with using NOTICE as it's supposed to be used
[14:22:46] <Aetherspawn> can rust do this; [a, b.., c] ?
[14:22:56] <strcat> Aetherspawn: yes
[14:23:09] <Aetherspawn> [a, b.., c.., d] ? :P
[14:23:28] <bstrie> Aetherspawn: that doesn't make sense :P
[14:23:28] <strcat> no
[14:23:37] <strcat> just on .. thing
[14:23:40] <strcat> it gets the "rest"
[14:23:41] <Aetherspawn> I know it doesn't :P that's the point
[14:23:56] <bstrie> Aetherspawn: well now we have to add it just to spite you
[14:24:05] <Aetherspawn> wait, so [1..5] -> [a, b.., c]
[14:24:11] <Aetherspawn> a = 1, c = 5, b = [2,3,4] ?
[14:24:33] <strcat> yes
[14:24:38] <Aetherspawn> sweet
[14:24:39] <strcat> ..b
[14:25:01] <Aetherspawn> Why are the dots before?
[14:25:18] <strcat> because that's the syntax used for initialization/types/destructuring
[14:25:20] <bstrie> Aetherspawn: because we use the "dots before" idiom elsewhere
[14:27:11] <bstrie> iirc ecmascript also puts the dots before for rest parameters
[14:27:17] <bstrie> er, ec6
[14:27:33] *** Joins: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net)
[14:28:46] *** zz_kimundi is now known as kimundi
[14:29:16] *** Quits: eholk (eholk@moz-9AB4D52F.hsd1.ut.comcast.net) (Ping timeout)
[14:29:53] <strcat> so close to no more 'each'
[14:30:24] <bstrie> strcat: you said something was blocking the extension of for loops to work with iterators?
[14:30:42] <strcat> bstrie: the massive amount of internal iterator usage
[14:30:54] <strcat> s/extension/replacement/
[14:31:06] <bstrie> ah, I thought the original plan was to have them live side-by-side
[14:31:18] <bstrie> no big deal, we still have `do` for that
[14:31:23] <strcat> simpler to just have one, and internal ones aren't really useful
[14:31:37] <strcat> they aren't going to be in the stdlib since external ones are always more useful
[14:31:50] <strcat> so... why have syntax? ;p
[14:31:50] <bstrie> strcat: you can't just mass-replace for with do? I can't imagine that there's really that many places that made use of the break
[14:31:50] *** Joins: msingle2 (yaaic@moz-930E5D97.hr.hr.cox.net)
[14:31:57] *** Joins: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de)
[14:32:03] <strcat> bstrie: well I'm just converting them to external ones
[14:32:04] <strcat> better that way
[14:32:11] <bstrie> that works too
[14:32:17] <strcat> and then we can convert .advance to a no-op when we make the new for loop
[14:32:23] <strcat> and then after a snapshot, remove it
[14:32:28] <MaikKlein> new for loop?
[14:33:03] <bstrie> strcat: so is the idea that it will work on anything that has a .next method, or anything that implements Iterator?
[14:33:11] <strcat> anything implementing Iterator
[14:33:11] <engla> what's the probability of changing it to   for $x:pat in $it:expr
[14:33:14] <strcat> it will have a lang item
[14:33:38] *** Quits: fabiand (fabiand@EE0093B4.3A27401E.16E13E53.IP) (Ping timeout)
[14:33:53] <bstrie> engla: I think that's a conversation to have once we finish the actual conversion
[14:34:03] <cmr> engla: I would so be up for that
[14:34:16] *** Joins: fabiand (fabiand@EE0093B4.3A27401E.16E13E53.IP)
[14:34:22] <bstrie> I like how the current syntax looks just like a closure
[14:34:27] <MaikKlein> what is a pat?
[14:34:43] <bstrie> though I guess technically it won't really be a closure any more
[14:34:48] <bstrie> in which case I wouldn't care either way
[14:35:01] <cmr> MaikKlein: pattern
[14:35:15] <cmr> MaikKlein: stuff used in match arms, let, etc
[14:35:17] *** Joins: illissius (illissius@moz-19397A63.catv.broadband.hu)
[14:35:29] <bstrie> strcat: how much of this do you think you'll have done for 0.7?
[14:35:34] <MaikKlein> cmr,  ah okay thanks
[14:35:47] <strcat> bstrie: it won't all be converted
[14:35:47] <bstrie> iterators would be a neat thing to highlight in the release notes
[14:35:52] <strcat> bstrie: they are
[14:36:01] <orshem> can the compiler optimize away something like &Option<~A> into **A?
[14:36:01] <strcat> bstrie: the only missing piece is 'for'
[14:36:08] <strcat> orshem: it does
[14:36:09] <engla> bstrie: good point
[14:36:21] <strcat> orshem: Option<~T> compiles to a nullable ptr
[14:36:23] <strcat> always
[14:36:36] <strcat> rusti: std::sys::size_of::<(int, int)>
[14:36:40] <strcat> rusti: std::sys::size_of::<(int, int)>()
[14:36:41] -rusti- 16
[14:36:43] <strcat> rusti: std::sys::size_of::<~(int, int)>()
[14:36:44] -rusti- 8
[14:36:47] <orshem> strcat: good to hear because i find myself using it a lot
[14:36:48] <strcat> rusti: std::sys::size_of::<Option<~(int, int)>>()
[14:36:49] -rusti- 8
[14:36:54] <strcat> rusti: std::sys::size_of::<Option<&(int, int)>>()
[14:36:55] -rusti- 8
[14:36:58] <strcat> rusti: std::sys::size_of::<Option<@(int, int)>>()
[14:36:59] -rusti- 8
[14:37:09] <strcat> raw pointers are nullable so Option<*T> won't, since that's doubly nullable
[14:37:13] <strcat> rusti: std::sys::size_of::<Option<*(int, int)>>()
[14:37:14] -rusti- 16
[14:37:25] <bstrie> strcat: does it do that even for Option<u8> and other small types?
[14:37:31] <strcat> bstrie: no
[14:37:37] <strcat> bstrie: that's a hard problem
[14:37:42] <MaikKlein> is * a raw pointer in this context?
[14:37:43] <strcat> because you can take references to the contained type
[14:37:47] <strcat> MaikKlein: yes
[14:37:47] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:38:04] <strcat> potentially dangling/nullable raw pointer
[14:38:10] <strcat> for FFI stuff
[14:38:53] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:43:22] <bstrie> strcat: what external iterator is replacing range(0, 10) ?
[14:43:33] <bstrie> or are those just moving to do
[14:43:37] <strcat> haven't made one yet because I want to do it properly and handle overflow right
[14:43:53] <strcat> range doesn't
[14:44:12] <strcat> there's Counter
[14:44:26] <strcat> but it's not meant as a replacement for that
[14:44:51] <strcat> rusti: use std::iterator::Counter; let xs: ~[int] = Counter::new(0, 2).take_(10).collect(); xs
[14:44:52] -rusti- ~[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
[14:45:08] <strcat> rusti: use std::iterator::Counter; let xs: ~[int] = Counter::new(0, 2).skip(5).take_(10).collect(); xs
[14:45:09] -rusti- ~[10, 12, 14, 16, 18, 20, 22, 24, 26, 28]
[14:45:27] <MaikKlein> uh
[14:45:49] <MaikKlein> are those "infinite" counters like in haskell?
[14:45:53] <strcat> yes
[14:46:33] <cmr> rusti: use std::iterator::Counter; let xs: ~[int] = Counter::new(0, 2).collect(); xs
[14:46:34] <kimundi> strcat: What exactly is the problem with being able to take references to ints in Option<int> etc?
[14:46:34] -rusti- application terminated abnormally with signal 9 (Killed)
[14:46:58] <MaikKlein> rusti: use std::iterator::Counter; let xs: @[int] = Counter::new(0, 2).take_(10).collect(); xs
[14:46:58] -rusti- <anon>:9:54: 9:93 error: failed to find an implementation of trait std::iter::FromIter<int> for @[int]
[14:46:59] -rusti- <anon>:9          use std::iterator::Counter; let xs: @[int] = Counter::new(0, 2).take_(10).collect(); xs
[14:46:59] -rusti-                                                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[14:46:59] -rusti- application terminated with error code 101
[14:47:09] <strcat> not implemented for @[] vecs yet
[14:47:14] <MaikKlein> ah ok
[14:47:16] <strcat> just ~[]
[14:47:30] <strcat> anyway it's being thrown out and replaced with FromIterator now that I made a size hint
[14:47:36] <strcat> and std::iter can go to extra
[14:47:59] <kimundi> what's getting thrown out?
[14:48:01] <strcat> but FromIterator still hits a lifetime bug ;[
[14:48:06] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[14:48:07] <strcat> kimundi: FromIter, once the lifetime bug is fixed
[14:48:33] <strcat> collect can't be implemented with FromIterator yet
[14:48:37] <strcat> hits a really strange ICE
[14:49:51] <kimundi> No, I mean what is getting removed that you're replacing with FromIterator
[14:49:58] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[14:50:02] <strcat> I'm replacing FromIter with FromIterator
[14:50:08] <kimundi> Ah, okay
[14:50:11] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Quit: WeeChat 0.4.2-dev)
[14:50:11] *** Quits: orshem (orshem@3545E24A.588A166C.E3D28531.IP) (Quit: Leaving)
[14:50:22] <kimundi> Those two are confusing names
[14:50:38] <strcat> kimundi: https://github.com/mozilla/rust/pull/7274
[14:50:55] <MaikKlein> :D
[14:51:08] <kimundi> I'd demand that we standarize on Externator and Internator, but seeing how you'r throwing out internal ones completly... ;)
[14:51:39] <strcat> kimundi: well when I'm done throwing out internal iterators we can rename them to ranges and extend them with more traits
[14:51:45] <strcat> but one thing at a time
[14:51:53] <strcat> Iterator becomes ForwardRange, next becomes pop_front
[14:52:08] <strcat> everything else stays the same
[14:52:12] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:52:12] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/AgKNJQ
[14:52:12] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[14:52:19] <strcat> but then we can add BidirectionalRange: ForwardRange with pop_back
[14:52:20] <bstrie> kimundi: you can still make internal iterators with do
[14:52:29] <strcat> and add .reverse to BidirectionalRange as a default method
[14:52:41] <strcat> among other things
[14:53:03] <strcat> .reverse can just wrap it in an iterator swapping pop_front and pop_back
[14:53:36] <strcat> and we can merge the concept of slices and iterators (ranges).... but that means changing the slice representation
[14:53:38] <strcat> anyway.
[14:53:39] <kimundi> Sure, but that's not going to be a canonical way to iterate anymone, just 'something you can do because it's easier'
[14:53:40] <strcat> future things ;p
[14:53:58] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[14:54:01] <strcat> kimundi: only easier to implement one for a recursive data type
[14:54:12] <strcat> otherwise external is easier
[14:54:22] <strcat> and anyway with closures you have to deal with all the lifetime/move issues ;p
[14:54:36] <kimundi>  'something you can do IF it's easier and'
[14:54:37] <strcat> (that's why I gave up on std::iter - it's hopeless)
[14:54:57] <strcat> fold_ref, fold_ref_ref, fold_ref_ref_ref
[14:55:00] <strcat> nope. just nope
[14:55:10] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[14:55:11] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/wDxuEg
[14:55:11] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[14:55:13] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[14:55:13] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/tQU9XA
[14:55:13] <ghrust> 13rust/06auto 14dc262d9 15BjÃ¶rn Steinbrink: Avoid unnecessary scratch datums for by-copy function arguments...
[14:55:13] <ghrust> 13rust/06auto 144fb2c09 15BjÃ¶rn Steinbrink: Avoid pointless allocas for "nil" return values...
[14:55:15] <ghrust> 13rust/06auto 14544f615 15bors: auto merge of #7259 : dotdash/rust/ir_improvement, r=graydon...
[14:55:16] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[14:55:28] <strcat> stage1 done
[14:55:33] <strcat> goodbye each
[14:58:31] <kimundi> strcat: I'm curious, what exactly is the difference between using a closure and external ones that makes lifetimes a non-issue? The fact that you don't have to pass them throug two layers of function calls?
[14:58:51] <strcat> kimundi: the function call passed in by the caller with an & param
[14:59:34] <kimundi> Ah, you mean the problems of nesting them?
[14:59:46] <strcat> kimundi: no, just that you have a function as a parameter taking &
[15:00:04] <MaikKlein> .each is gone?
[15:00:11] <strcat> MaikKlein: it will be
[15:00:14] <strcat> work in progress
[15:01:08] *** Quits: fabiand (fabiand@EE0093B4.3A27401E.16E13E53.IP) (Connection reset by peer)
[15:01:21] <MaikKlein> how do we replace it? I know with iterators but how will it look like? v.each(|x| x*2) -> ?
[15:01:22] <strcat> and I just mean on vectors
[15:01:49] <strcat> MaikKlein: for v.each |x| { } will become for v.iter |x| { } with a new for loop
[15:01:54] <strcat> for now it has .advance on the end
[15:02:04] <strcat> but anyway
[15:02:09] <strcat> they are composable iterator objects now
[15:02:30] <strcat> for loop bodies won't be closures, return/break will actually return/break
[15:02:52] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[15:02:59] <MaikKlein> okay 
[15:03:38] *** Joins: fabiand (fabiand@moz-9067042C.adsl.alicedsl.de)
[15:04:25] <strcat> rusti: let xs = [1, 2, 3, 9, 12, 40, 90, 122, 134, 135, 135]; for xs.iter().fold(0, |a, b| a + b)
[15:04:25] -rusti- <anon>:10:4: 10:5 error: expected `{` but found `}`
[15:04:25] -rusti- <anon>:10     };
[15:04:26] -rusti-               ^
[15:04:26] -rusti- application terminated with error code 101
[15:04:28] <bstrie> strcat: if for loop bodies aren't actually closures, then maybe it would be better to do `for foo in bar`
[15:04:32] <strcat> rusti: let xs = [1, 2, 3, 9, 12, 40, 90, 122, 134, 135, 135]; xs.iter().fold(0, |a, b| a + b)
[15:04:32] -rusti- <anon>:9:93: 9:94 error: mismatched types: expected `<VI11>` but found `&int` (expected &-ptr but found integral variable)
[15:04:32] -rusti- <anon>:9          let xs = [1, 2, 3, 9, 12, 40, 90, 122, 134, 135, 135]; xs.iter().fold(0, |a, b| a + b)
[15:04:32] -rusti-                                                                                                       ^
[15:04:33] -rusti- error: aborting due to previous error
[15:04:33] *** concrete.mozilla.org sets mode: +M 
[15:04:34] -rusti- application terminated with error code 101
[15:04:38] <strcat> rusti: let xs = [1, 2, 3, 9, 12, 40, 90, 122, 134, 135, 135]; xs.iter().fold(0, |a, b| a + *b)
[15:04:39] -rusti- 683
[15:04:45] <strcat> rusti: let xs = [1, 2, 3, 9, 12, 40, 90, 122, 134, 135, 135]; xs.iter().skip(4).fold(0, |a, b| a + *b)
[15:04:45] -rusti- 668
[15:04:59] <strcat> rusti: let xs = [1, 2, 3, 9, 12, 40, 90, 122, 134, 135, 135]; xs.iter().skip_while(|&x| *x < 30).fold(0, |a, b| a + *b)
[15:05:00] -rusti- 656
[15:05:14] <bstrie> then again, if we set a precedent of making things look like closures when they're not, we could at last resolve the age-old question of referencing variables in match patterns by putting them in a faux-argument list
[15:05:31] *** Quits: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de) (Ping timeout)
[15:07:02] <strcat> but anyway 'vec' was the hardest since everything uses it
[15:07:15] <strcat> and it's mostly converted now
[15:08:18] <strcat> iter, rev_iter, mut_iter and mut_rev_iter is the full interface
[15:08:22] <strcat> + we can add consume, maybe
[15:09:09] *** Quits: pyrac (pyrac@EDE6BD92.73C89388.AD05C589.IP) (Quit: pyrac)
[15:09:19] <strcat> bstrie: I dunno about the 'for' syntax
[15:09:26] <strcat> don't really have a strong opinion either way ;p
[15:09:29] *** concrete.mozilla.org sets mode: -M 
[15:09:35] <kimundi> strcat, bstrie: The problem with 'for pattern in expr' is how to leave of the pattern? compare 'for 5.times {}' and 'for () in 5.times {}'
[15:09:46] <strcat> kimundi: by special casing Option<()>
[15:09:49] <strcat> if we care.
[15:09:55] <strcat> just like we special case 0 arguments right now
[15:10:07] <kimundi> but would the syntax be unambigious?
[15:10:14] <strcat> oh I dunno about syntax
[15:10:20] <strcat> I thought you meant with the current syntax
[15:10:31] *** Quits: msingle2 (yaaic@moz-930E5D97.hr.hr.cox.net) (Quit: Yaaic - Yet another Android IRC client - http://www.yaaic.org)
[15:10:45] <strcat> anyway I'll let other people worry about that
[15:10:47] <strcat> ;p
[15:11:22] <engla> hashmap iterators https://github.com/mozilla/rust/pull/7277
[15:12:12] <strcat> thanks!
[15:12:13] <strcat> sec
[15:13:07] <strcat> engla: r+'ed
[15:13:25] <engla> thanks
[15:13:26] <engla> exciting
[15:14:56] <bstrie> kimundi: also times isn't going away, it's just moved to `do`
[15:15:01] <bstrie> at least it better not be going away :P
[15:15:14] <strcat> bstrie: for 5.times { } can be an external iterator
[15:15:28] <bstrie> that's fine, it just needs to exist as a convenience form
[15:15:43] <bstrie> very important for making small examples and easing people into the language
[15:15:54] <strcat> bstrie: yep
[15:16:10] <strcat> bstrie: I really wanted to make str/vec smaller and much more manageable, so this is part of that
[15:16:15] <cmr> kimundi: for omitting the pattern couldn't the `in` just be left out too?
[15:16:50] <strcat> bstrie: also with an eventual Iterable trait....
[15:16:58] <strcat> for xs.iter |x| { }
[15:16:59] <strcat> becomes
[15:17:01] <strcat> for xs { }
[15:17:05] <strcat> for xs |x| { } *
[15:17:18] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[15:17:58] *** Quits: Aetherspawn (Aetherspaw@moz-8811D9F0.static.tpgi.com.au) (Quit: Leaving)
[15:18:02] <bstrie> so both xs and the iterator from xs.iter() implement iter?
[15:18:06] <bstrie> er, implement Iterable
[15:18:32] <strcat> bstrie: iterators can either implement Iterable or we can teach 'for' to fall back to Iterator if they aren't Iterable (or the other way)
[15:18:43] <bstrie> ok, wasn't sure if there were going to be separate mechanisms
[15:18:55] <strcat> both would need to be lang items
[15:19:03] <strcat> (either way)
[15:19:07] <cmr> what is a lang item exactly?
[15:19:18] <bstrie> cmr: bits of the compiler that users can swap out
[15:19:36] <strcat> a trait/function blessed by the standard library to be the implementation of a compiler feature
[15:19:48] <strcat> like Add is #[lang = "add"]
[15:20:10] <cmr> fancy
[15:20:33] <strcat> cmr: look at zero.rs's source
[15:20:40] <strcat> it just redefines the lang items
[15:21:02] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[15:21:23] <strcat> since if you compile without libstd, they're missing and can be implemented
[15:21:29] <strcat> s/can/have to be/
[15:24:12] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[15:26:15] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:28:07] *** Quits: sk (sk@1335CD0E.81A8C295.D066974A.IP) (Quit: Leaving)
[15:32:09] *** Quits: hansjorg (hansjorg@moz-EECB5F79.static.cust.telenor.com) (Quit: Leaving.)
[15:33:40] *** Quits: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com) (Input/output error)
[15:33:40] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (Connection reset by peer)
[15:34:53] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[15:37:12] <kimundi> Syntax idea for for: 'for expr |pattern|' -> 'for expr (pattern)', and then special case unit and tuples so that instead of 'for as.zip(bs) ((a, b))' you can write 'for as.zip(bs) (a, b)'
[15:37:54] <bstrie> I don't want it to be too magical
[15:38:22] <bstrie> might as well just do `for pattern in expr` with that route
[15:38:32] <cmr> What's wrong with `for pat in expr` and `for expr` as special case for unit?
[15:39:11] <cmr> (genuine question, I do not know the particulars of patterns still..)
[15:39:12] *** Joins: threecreepio (jdp@moz-DB3FA00C.tbcn.telia.com)
[15:40:40] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[15:40:58] <bstrie> cmr: new syntax, another keyword, more things to learn
[15:41:05] <bstrie> it could still be worth it
[15:41:13] <bstrie> but again, we can discuss this once all the other machinery is in place
[15:41:36] <cmr> bstrie: well it doesn't have to be a new keyword, only in that specific spot in the grammar?
[15:43:05] <bstrie> cmr: we currently have a policy against contextual keywords, although I'm not sure if this would really be a contextual keyword
[15:43:24] <hoelzro> how much memory does it take to compile Rust? I'm having issues building it on a VM with 2GB RAM
[15:43:37] <cmr> hoelzro: ~1.5GB right now
[15:43:43] <hoelzro> yikes
[15:43:46] <bstrie> hoelzro: don't build in parallel, you'll save a lot ofram
[15:43:56] <bstrie> hoelzro: are you also compiling llvm?
[15:44:02] * hoelzro checks
[15:44:06] <bstrie> because I can get up to 5gb usage when compiling llvm with -j8
[15:44:15] <hoelzro> how do you specify to not build in parallel?
[15:44:17] <cmr> I don't know memory usage of llvm
[15:44:23] <cmr> hoelzro: just a `make` is serial build
[15:44:24] <bstrie> hoelzro: if you just type "make", it's not in parallel
[15:44:39] <bstrie> you have to add the -j flag for that
[15:44:48] <bstrie> btw who picked "j" for that
[15:44:53] <engla> j for jobs
[15:44:53] <bstrie> what a random letter
[15:44:55] <cmr> bstrie: j for jobs
[15:45:06] <bstrie> I have never heard them called jobs
[15:45:17] <bstrie> at least not on anything that's not a mainframe
[15:45:21] <bstrie> then again, unix
[15:45:25] <cmr> you've never heard them called make jobs?
[15:45:28] <bstrie> no
[15:45:31] <bstrie> I don't use make :P
[15:45:37] <bstrie> rather, I *try* not to use make
[15:46:22] <bstrie> reason #457 why I've never tried to learn C/C++
[15:46:28] *** Joins: tiffany (kawaii@moz-1E0FE6E8.dhcp.embarqhsd.net)
[15:46:38] <bjz_> rusti: let foo: u8 = "hiya"[2];
[15:46:42] -rusti- <anon>:9:13: 9:16 warning: unused variable: `foo` [-W unused-variable (default)]
[15:46:42] -rusti- <anon>:9          let foo: u8 = "hiya"[2];
[15:46:42] -rusti-                       ^~~
[15:46:42] -rusti- ()
[15:46:46] <cmr> I usually just roll up my Ghetto Build System, aka, build.sh :p
[15:46:47] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[15:46:59] <cmr> elsewise I use cmake
[15:47:27] <EXetoC> there aren't a million better alternatives for those languages, really? :>
[15:47:30] *** Joins: snearch (snearch@moz-6CB2F6A0.pool.mediaways.net)
[15:47:50] <bjz_> bstrie: tbh, it's worth knowing abit of C and C++
[15:47:54] *** Joins: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com)
[15:48:39] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[15:48:41] <bstrie> bjz_: right, that's not fair, I own K&R and I can stumble around C++. but I'd never try to devote myself to a serious project in them
[15:48:59] <bstrie> life's too short
[15:49:05] <bjz_> bstrie: yeah, i'm the same
[15:49:36] <hoelzro> crap, I'm just doing 'make' =(
[15:49:56] <bstrie> hoelzro: do you have anything else gobbling up your ram?
[15:50:06] <bstrie> 2GB should barely be enough
[15:50:32] <strcat> make some swap ;p
[15:51:01] <strcat> fallocate -l 2G swap && mkswap swap && swapon swap
[15:51:02] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[15:51:21] <hoelzro> ah, apparently I have some other programs that aren't exactly sipping RAM.
[15:54:34] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[15:55:25] *** Joins: cstrahan (cstrahan@E8551FC6.D607B8C4.F5F9A4BE.IP)
[15:55:39] <hoelzro> ok, trying again
[15:57:23] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[15:57:57] *** Joins: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP)
[15:58:26] <hoelzro> so far so good...
[15:58:30] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[15:59:51] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[16:00:28] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[16:03:32] *** Joins: pyrac (pyrac@moz-9180E00E.w86-201.abo.wanadoo.fr)
[16:04:26] *** Joins: tcsc (tcsc@moz-ADC0ED45.hsd1.ct.comcast.net)
[16:04:37] *** Quits: threecreepio (jdp@moz-DB3FA00C.tbcn.telia.com) (Quit: threecreepio)
[16:04:49] *** Joins: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com)
[16:06:56] *** Joins: eholk (eholk@moz-932584F0.uconnect.utah.edu)
[16:08:58] *** Quits: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com) (Input/output error)
[16:09:35] *** Joins: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com)
[16:09:44] *** Quits: fabiand (fabiand@moz-9067042C.adsl.alicedsl.de) (Quit: Verlassend)
[16:11:08] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[16:18:01] *** Quits: roo (Mibbit@moz-5CBA6C47.dynamic.ip.windstream.net) (Quit: http://www.mibbit.com ajax IRC Client)
[16:19:44] *** Quits: vk (chatzilla@3E9D68F2.B1163E0C.2A6693DD.IP) (Quit: ChatZilla 0.9.90 [Firefox 23.0a2/20130620004019])
[16:20:27] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[16:22:15] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[16:23:06] *** Quits: bytbox (s@moz-D83E9B31.wireless.umd.edu) (Ping timeout)
[16:23:11] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[16:24:42] <jack> there's no way to get a C sizeof from rust is there?
[16:25:08] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[16:25:40] <cmr> rusti: use libc::c_int; std::sys::size_of::<c_int>()
[16:25:42] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/BjDN
[16:25:57] <cmr> rusti: use std::libc::c_int; std::sys::size_of::<c_int>()
[16:25:59] -rusti- 4
[16:26:14] <cmr> jack: like that? I don't understand the question
[16:26:23] <jack> exactly like that :)
[16:26:36] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[16:26:54] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[16:28:02] <jack> of course, teh problem is that i need the size of jmp_buf. i supose i'll have to link a C shim
[16:28:32] *** Joins: eschweic (Adium@2557E599.66715431.D25A875A.IP)
[16:28:39] <cmr> if you want the size of a C structure without porting it to rust, that isn't possible.
[16:28:47] *** Quits: eschweic (Adium@2557E599.66715431.D25A875A.IP) (Connection reset by peer)
[16:28:47] *** Joins: eschweic (Adium@2557E599.66715431.D25A875A.IP)
[16:30:35] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[16:34:27] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[16:34:48] *** Quits: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com) (Ping timeout)
[16:37:51] *** Joins: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com)
[16:39:46] <mblbruce> Going from 0.6 to master, a lot seems to be happening wrt to iteration. If one previously used str::each_word, what is the new idiomatic way of achieving the same?
[16:39:51] *** Quits: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net) (Quit: jorendorff)
[16:40:03] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[16:40:56] *** Joins: Blei (philipp@moz-650B9C6A.cust.bluewin.ch)
[16:40:58] <bstrie> mblbruce: I'm not sure, honestly. strcat would be the one to ask, but he just left :\
[16:41:05] <bstrie> we're all still learning the new idioms
[16:41:12] <engla>  mblbruce word_iter
[16:41:16] <cmr> mblbruce: word_iter method
[16:41:31] <cmr> rusti: "foo bar baz".word_iter().collect()
[16:41:32] -rusti- <anon>:9:9: 10:5 error: cannot determine a type for this bounded type parameter: unconstrained type
[16:41:32] -rusti- <anon>:9          "foo bar baz".word_iter().collect()
[16:41:32] -rusti- <anon>:10     };
[16:41:32] -rusti- application terminated with error code 101
[16:41:34] <bstrie> well I'm glad someone in here knows what they're doing :P
[16:41:47] <cmr> rusti: let x:  ~[&str] = "foo bar baz".word_iter().collect(); x
[16:41:48] -rusti- ~["foo", "bar", "baz"]
[16:42:07] <cmr> rusti: for "foo bar baz".word_iter().advance |x| { println(x); }
[16:42:08] -rusti- foo
[16:42:08] -rusti- bar
[16:42:08] -rusti- baz
[16:42:08] -rusti- ()
[16:42:19] <cmr> bstrie: I had to look in the source though :p
[16:42:21] <engla> yeah .collect() needs a "hint" to know which type of container to return (even if it's only impl for ~[] now)
[16:42:45] <bstrie> what else could it return?
[16:43:04] <engla> there will be a trait that containers can implement
[16:43:05] <bstrie> a @[], I guess?
[16:43:14] <engla> so I guess any collection, including HashSet etc
[16:43:19] <bstrie> ah ok
[16:43:23] <engla> it's going to be awesome.
[16:43:27] <kimundi> bstrie: Sets, linked lists etc
[16:44:24] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[16:45:00] *** Joins: anri (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net)
[16:45:00] <mblbruce> Thanks everyone.
[16:46:20] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[16:48:41] <mblbruce> Ah, it was in the StrSlice trait. It's not really super-easy to get a birds eye view of all functions in a module when trait functions are not listed in the top TOC.
[16:49:17] <cmr> mblbruce: yeah I'm working on a rustdoc rework
[16:49:30] <cmr> the docs are basically impossible to decipher right now, I suggest using the source
[16:51:10] *** Joins: tedh (tedh@moz-CE9B2F5A.cinci.res.rr.com)
[16:52:09] <cmr> doener: that's unfortunate, your ir_improvement pull hit a new linux bot, it needed to rebuild llvm
[16:52:13] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: Blei (philipp@moz-650B9C6A.cust.bluewin.ch) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: pyrac (pyrac@moz-9180E00E.w86-201.abo.wanadoo.fr) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: snearch (snearch@moz-6CB2F6A0.pool.mediaways.net) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: illissius (illissius@moz-19397A63.catv.broadband.hu) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: mblbruce (mblbruce@moz-D00392B8.fagotten.org) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: pnkfelix|rcirc (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: RMF (RMF@moz-8C13D5A2.dsl.telepac.pt) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: cr (anonymous@moz-32725F28.dip0.t-ipconnect.de) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: mleise (marco@moz-3468AB5B.pools.arcor-ip.net) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: EXetoC (ex@moz-2DBEB1E4.customer.t3.se) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (sand.mozilla.org gravel.mozilla.org)
[16:52:13] *** Quits: Boreeas (Boreeas@moz-F35C832D.boreeas.net) (sand.mozilla.org gravel.mozilla.org)
[16:53:45] *** Joins: mschifer (Adium@2557E599.66715431.D25A875A.IP)
[16:54:04] <cmr> doener: it *just* started the first stage0 :(
[16:56:27] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[16:56:27] *** Joins: Blei (philipp@moz-650B9C6A.cust.bluewin.ch)
[16:56:27] *** Joins: pyrac (pyrac@moz-9180E00E.w86-201.abo.wanadoo.fr)
[16:56:27] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[16:56:27] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[16:56:27] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[16:56:27] *** Joins: snearch (snearch@moz-6CB2F6A0.pool.mediaways.net)
[16:56:27] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[16:56:27] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[16:56:27] *** Joins: mblbruce (mblbruce@moz-D00392B8.fagotten.org)
[16:56:27] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[16:56:27] *** Joins: pnkfelix|rcirc (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[16:56:27] *** Joins: RMF (RMF@moz-8C13D5A2.dsl.telepac.pt)
[16:56:27] *** Joins: cr (anonymous@moz-32725F28.dip0.t-ipconnect.de)
[16:56:27] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[16:56:27] *** Joins: mleise (marco@moz-3468AB5B.pools.arcor-ip.net)
[16:56:27] *** Joins: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net)
[16:56:27] *** Joins: EXetoC (ex@moz-2DBEB1E4.customer.t3.se)
[16:56:27] *** Joins: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org)
[16:56:27] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[16:56:27] *** Joins: Boreeas (Boreeas@moz-F35C832D.boreeas.net)
[16:56:30] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[16:56:32] *** Joins: Amanieu (amanieu@moz-D5D10CA8.halls.manchester.ac.uk)
[16:56:44] *** Joins: illissius (illissius@moz-19397A63.catv.broadband.hu)
[16:56:55] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[16:56:58] *** Quits: illissius (illissius@moz-19397A63.catv.broadband.hu) (Quit: )
[16:57:13] *** Quits: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com) (Ping timeout)
[17:01:08] *** Joins: Ralith (ralith@moz-768BBE2B.wireless.sfu.ca)
[17:03:52] *** Joins: carllerche (carllerche@moz-BF6CB667.hsd1.ca.comcast.net)
[17:07:18] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[17:07:21] *** Quits: pyrac (pyrac@moz-9180E00E.w86-201.abo.wanadoo.fr) (Quit: pyrac)
[17:09:51] *** Joins: tgt (tgt@moz-D59EE478.aztw.cable.virginmedia.com)
[17:11:36] *** Joins: brendan (brendaneic@6CE790D5.927818F1.82490606.IP)
[17:13:01] *** Joins: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net)
[17:13:20] <doener> :-/
[17:15:41] *** Joins: pyrac (pyrac@moz-9180E00E.w86-201.abo.wanadoo.fr)
[17:17:11] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[17:17:47] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[17:18:12] *** Quits: eholk (eholk@moz-932584F0.uconnect.utah.edu) (Quit: eholk)
[17:18:35] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[17:20:39] *** Joins: bytbox (s@moz-D83E9B31.wireless.umd.edu)
[17:21:59] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[17:22:30] *** Quits: eschweic (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[17:23:47] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[17:24:43] <doener> wow, isrustfastyet looks funny
[17:25:21] *** Quits: Ralith (ralith@moz-768BBE2B.wireless.sfu.ca) (Ping timeout)
[17:26:05] <cmr> yeah... because the buildbots share slaves and llvm rebuilds and such, whole thing is kinda fubar
[17:26:30] *** Joins: Ralith (ralith@moz-768BBE2B.wireless.sfu.ca)
[17:26:48] <cmr> especially old slaves coming online to service a build
[17:30:38] *** Joins: eschweic (Adium@2557E599.66715431.D25A875A.IP)
[17:34:13] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[17:34:45] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[17:34:49] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[17:37:35] *** Joins: ecr (ereed@2557E599.66715431.D25A875A.IP)
[17:37:49] *** Joins: thatfreakingguy (Mibbit@moz-29E9833A.pool.mediaways.net)
[17:38:02] <brendanc> builders should run under time(1) or something
[17:38:18] <brendanc> that'd probably take out a lot of the noise
[17:38:36] <cmr> yeah. afaik graydon is working on better reporting.
[17:38:41] *** Joins: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP)
[17:38:41] *** ChanServ sets mode: +o pcwalton
[17:40:16] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Ping timeout)
[17:40:36] *** Quits: Palmik (palmik@moz-5CA3F354.pks.muni.cz) (Ping timeout)
[17:41:03] <thatfreakingguy> If i have a type "rsfml::system::clock::Clock" and write "pub use rsfml::system::clock::*" in crate called "sf", then I should be able to use the type as "sf::Clock" using that crate, right?
[17:41:43] <cmr> thatfreakingguy: aiui, yes
[17:42:40] <thatfreakingguy> I get "error: not a module `Clock`" though
[17:42:50] <cmr> How are you using it?
[17:42:59] <thatfreakingguy> extern mod sf;  fn main() {     let timer = sf::Clock::new(); }
[17:43:50] <thatfreakingguy> The longer variant, "extern mod rsfml;  fn main() {     let timer = rsfml::system::clock::Clock::new(); }" works
[17:43:54] <cmr> There's probably some trickiness / bugs surrounding that that I don't know about... I'm still not too sure of the module system myself
[17:43:58] *** Joins: Palmik (palmik@moz-B14BB007.vpn.muni.cz)
[17:44:14] <thatfreakingguy> That's not the rust system module btw
[17:44:34] <cmr> hm?
[17:44:36] <thatfreakingguy> nvm
[17:44:56] <thatfreakingguy> Have been switching too much between languages
[17:45:39] *** Joins: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com)
[17:46:56] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[17:46:56] *** ChanServ sets mode: +qo graydon graydon
[17:47:31] *** Quits: eschweic (Adium@2557E599.66715431.D25A875A.IP) (Connection reset by peer)
[17:47:31] *** Joins: eschweic (Adium@2557E599.66715431.D25A875A.IP)
[17:47:52] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[17:49:19] <Blei> cmr: cool, you're part of the r+ group now?
[17:49:41] <cmr> Blei: yup
[17:50:36] <graydon> "5 hrs, 25 mins, 29 secs"
[17:50:39] <graydon> good lord
[17:50:43] *** Joins: eholk (eholk@moz-932584F0.uconnect.utah.edu)
[17:50:43] <graydon> (sorry)
[17:52:48] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[17:53:59] <nmatsakis> cmr: :( ok
[17:54:38] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[17:55:47] <pcwalton> graydon: is that the cycle time?
[17:56:02] <graydon> pcwalton: on one of the EC2 bots
[17:56:13] <pcwalton> yeah, this was releng's concern about the bors model
[17:56:19] <pcwalton> I'm not saying bors' model is bad
[17:56:21] <graydon> pcwalton: best cycle time yesterday was 1:40 when everthing lined up
[17:56:24] <pcwalton> just that this is something to keep in mind
[17:56:25] <pcwalton> 1:40 is good
[17:56:27] <graydon> yeah
[17:56:51] <graydon> I think that's the "actual" cycle time. I think 5h is what happens when an EC2 machine gets too many jobs assigned to it and swaps or something
[17:57:04] <graydon> I want to fix things so that does not happen again, obviously
[17:57:21] <pcwalton> bors has a rather long queue; is it working?
[17:57:24] <graydon> yes
[17:57:25] <cmr> pcwalton: yes
[17:57:27] <graydon> very slowly
[17:57:28] <pcwalton> ok
[17:57:29] <cmr> that's the sad part
[17:57:40] <graydon> we turned on valgrind and no-opt and cross
[17:57:43] <graydon> these things come with costs
[17:57:45] <graydon> we're trying to get them down
[17:57:47] <pcwalton> all the stuff in the queue is very exciting
[17:57:48] <pcwalton> ok
[17:57:54] <pcwalton> as long as it's on someone's radar
[17:58:13] <graydon> it's #1 on my radar
[17:58:22] <graydon> since GC won't land in 0.7 anyways, no point trying at this point
[17:58:23] *** Quits: pyrac (pyrac@moz-9180E00E.w86-201.abo.wanadoo.fr) (Quit: pyrac)
[17:58:49] *** Joins: Guest (textual@moz-BB21156B.dynamic.csail.mit.edu)
[17:59:28] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Ping timeout)
[18:02:04] <cmr> graydon: GC still blocked on 32bit memory usage?
[18:02:34] <graydon> that, and using too much memory in general, and being probably too unstable to land this late in a release cycle
[18:02:53] <graydon> I have been trying the whole time but haven't got it nailed down. too much else going on, and too many elusive gc bugs that won't die
[18:03:37] <pcwalton> I'll split out trans when I get some cycles, but I still have some backwards compat things to fix
[18:03:49] <graydon> ah right. that will help with the peak.
[18:03:56] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[18:11:43] <pcwalton> oh come on
[18:11:49] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[18:11:53] <pcwalton> rewrote much of metadata and it didn't fix a single failing test
[18:12:13] <graydon> does it run faster? :)
[18:12:19] <pcwalton> not really
[18:12:23] <pcwalton> it paves the way to run faster in the future
[18:12:32] <graydon> repaying debt isn't always fun
[18:12:34] <pcwalton> but I didn't make the changes to make it run faster
[18:12:41] <graydon> you're doing the right thing
[18:12:42] <pcwalton> yeah, this is mostly repaying debt
[18:12:48] * graydon applauds and encourages
[18:12:49] *** Quits: thatfreakingguy (Mibbit@moz-29E9833A.pool.mediaways.net) (Quit: http://www.mibbit.com ajax IRC Client)
[18:15:05] *** Quits: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net) (Quit: jorendorff)
[18:15:36] *** Parts: Guest (textual@moz-BB21156B.dynamic.csail.mit.edu) (Textual IRC Client: www.textualapp.com)
[18:17:08] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[18:17:43] <cmr> graydon: why do I sometimes get a 502 from buildbot?
[18:17:47] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[18:17:49] <graydon> because I'm mucking with it
[18:17:50] <cmr> actually it just seems to be down right now
[18:17:53] <graydon> I'm sorry
[18:17:58] <cmr> it does happen intermittenly though
[18:18:04] <cmr> or however that is spelled
[18:18:10] <graydon> because I'm usually mucking with it
[18:18:17] <brendanc> extra cache seems to have helped quite a bit with load times though :)
[18:18:18] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[18:18:19] <cmr> heh, ok :)
[18:18:32] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Input/output error)
[18:18:47] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[18:19:48] <graydon> dammit!~
[18:20:02] <graydon> very sorry, lost one very close to completion there
[18:21:00] <brendanc> are you using reconfig or restart? it's surprising how often reconfig works
[18:21:50] <graydon> this time I typed restart when I meant to type reconfig
[18:21:52] <cmr> I'm using https://github.com/huonw/rust-rand to create an basic prototype of the information and structure I want from rustdoc2 at file:///home/cmr/entropy/rdoc-proto/index.html
[18:21:54] <graydon> and thus lost us 2h work
[18:21:56] <graydon> I'm very sorry
[18:21:57] <cmr> (all links are dead)
[18:22:15] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: Leaving)
[18:22:17] <cmr> graydon: 4h actually :p
[18:22:22] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[18:22:37] <cmr> one of the linux builds needed an llvm rebuild and was going slowly in general
[18:23:19] <graydon> yeah. the problem with the latent slaves is that they wind up often having to rebuild LLVM since they were shut down when offline
[18:23:28] <graydon> we really need a solution to LLVM rebuilding
[18:23:35] <cmr> ccache?
[18:23:54] <graydon> they are re-initialized from an AMI
[18:24:01] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[18:24:01] *** ChanServ sets mode: +o brson
[18:24:01] <graydon> there's a bit of a catch 22
[18:24:05] <cmr> merging with upstream llvm is a pipedream but would be a great project for someone
[18:24:30] <graydon> I put a warm ccache in the AMI but it becomes perma-stale after the first LLVM update
[18:24:45] <graydon> if I put a warm builddir, it's worse: first LLVM upgrade perma-breaks the slave
[18:24:53] <graydon> stateless builds are great. we just don't support them well.
[18:25:14] <graydon> maybe I should. guh. I don't know. this is awful.
[18:26:19] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[18:26:36] <bstrie> graydon: are aws buildbots really more viable than just having some leftover box running linux on mozillap property?
[18:27:14] <graydon> they have the advantage that I can provision them without a song and dance
[18:27:26] <graydon> but .. it is hard to say.
[18:27:30] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[18:28:13] <bstrie> graydon: by provision do you mean get the money to pay for them? surely we could get some hardware donations, linux runs on anything
[18:28:40] <graydon> bstrie: no, I mean get authority to use them in this capacity.
[18:28:44] <bstrie> ok
[18:29:10] <bstrie> it seems like you already do something similar with the mac minis
[18:30:03] <graydon> this is a difficult argument to have and I don't really want to have it today.
[18:30:13] <graydon> please believe me when I say there are reasons for the current strategy
[18:30:26] <bstrie> suresure, I don't intend to inflame
[18:30:59] <graydon> s'ok. there are a lot of competing tensions.
[18:31:17] <graydon> the most useful thing anyone can do for any of these problems is to _work on codegen_
[18:31:23] <graydon> (myself included)
[18:31:29] <bstrie> just wanted to know if there was any way that I could contribute, my gaming rig sits dark for most of the day
[18:32:07] <graydon> I wish it were that simple. if we (re) decide to pursue that approach, we can throw hardware at problems.
[18:32:31] <graydon> it's just that "use EC2" _is_ the current strategy for "throw hardware at the problem"
[18:32:57] <friggle> what class of ec2 machines do the bors builders use?
[18:33:00] <cmr> Are there any lowhanging fruit in trans?
[18:33:01] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[18:33:14] <graydon> c1.xlarge presently
[18:33:21] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[18:33:23] <brendanc> put a builder on a periodic scheduler that keeps the ec2 slaves alive :)
[18:33:25] <graydon> and ebs. I might try ephemeral storage on the next few.
[18:33:31] <doener> graydon: since your last proposal (the landing pads) was so successful, do you happen to have a suggestion for something to work on specifically?
[18:33:38] <graydon> brendanc: I think I'lll just set the disconnect timeout really high
[18:33:40] <pcwalton> cmr: "get rid of landing pads in rustc" is semi-low-hanging fruit
[18:33:48] <cmr> pcwalton: already in the queue
[18:33:53] <pcwalton> possibly controversial but I think it is worth it
[18:34:00] <graydon> I'm ok with it for now
[18:34:08] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[18:34:14] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[18:34:17] <cmr> pcwalton: or maybe not, did it already land?
[18:34:32] <pcwalton> no, I'm talking about something more radical
[18:34:37] <pcwalton> just call abort() if rustc fails
[18:34:40] <pcwalton> via a condition handler
[18:34:51] <pcwalton> print out the ICE message and abort, don't throw an exception
[18:34:54] <bstrie> wasn't there are stale PR for that?
[18:34:56] <pcwalton> there was
[18:35:03] <pcwalton> it wasn't fully done though, graydon had an objection
[18:35:04] <pcwalton> which was valid
[18:35:11] <pcwalton> it needs to actually print out the ICE message
[18:35:25] <pcwalton> that would probably be a 20% win or so
[18:35:27] *** Quits: Ralith (ralith@moz-768BBE2B.wireless.sfu.ca) (Ping timeout)
[18:35:28] <pcwalton> maybe more
[18:35:31] <cmr> What are landing pads exactly?
[18:35:37] <pcwalton> exception handlers
[18:35:38] <pcwalton> finally blocks
[18:35:42] <pcwalton> auto-generated by the compiler
[18:36:05] <cmr> what are they used for?
[18:36:23] <pcwalton> cleaning up exchange heap allocations
[18:36:24] <cmr> Alternatively, where in the source do I start looking? :)
[18:36:26] <pcwalton> when a task fails
[18:36:41] <pcwalton> you will need to do several things:
[18:36:47] <pcwalton> add a #[no_unwind] switch;
[18:37:04] <pcwalton> look for no_landing_pads and turn that on when you see #[no_unwind] at the crate level
[18:37:22] <pcwalton> add a fail condition handler;
[18:37:25] <bstrie> would the stale PR be a good starting place?
[18:37:31] <bstrie> or is it too rotted
[18:37:32] <pcwalton> yes
[18:37:41] <pcwalton> have libstd call the fail condition handler on fail
[18:38:04] <graydon> cmr: https://mail.mozilla.org/pipermail/rust-dev/2013-January/002877.html was the last time I wrote up codegen problems
[18:38:05] <pcwalton> then is the hard part: have some mechanism for libstd to know whether no_unwind is on
[18:38:23] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[18:38:40] <graydon> I think it's important to start _measuring_ a lot of these things too
[18:38:48] <pcwalton> about half of these are fixed in PRs
[18:38:48] <graydon> rather than speculating
[18:38:50] <bblum> can someone tell me what the purpose of maybe_whole! is?
[18:38:53] <pcwalton> but yes
[18:39:02] <pcwalton> there is a lot of stuff that you can just look at the IR and see "well that is bad"
[18:39:06] <pcwalton> I don't know off the top of my head
[18:39:15] <pcwalton> the "ret {}" thing is bad for example
[18:39:17] <pcwalton> and that was a 10% win
[18:39:26] <pcwalton> (when and if bors merges it)
[18:39:53] <graydon> I would also highly recommend trying to correct the LLVM-lint errors
[18:40:38] *** Joins: BitPuffin (quassel@moz-49828767.cust.tele2.se)
[18:40:58] *** Joins: eholk_ (eholk@moz-932584F0.uconnect.utah.edu)
[18:41:07] *** Quits: eholk (eholk@moz-932584F0.uconnect.utah.edu) (Connection reset by peer)
[18:41:07] *** eholk_ is now known as eholk
[18:41:08] <sully> LLVM-lint?
[18:41:21] <cmr> sully: -Z lint-llvm
[18:41:38] <doener> hm, quite a few warnings there
[18:41:50] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[18:41:52] *** Joins: igl (igl@moz-82BF5F31.adsl.alicedsl.de)
[18:41:58] <bblum> pauls: ping
[18:44:43] *** Joins: roo (Mibbit@moz-97A935F1.dynamic.ip.windstream.net)
[18:47:37] <cmr> Blei: Are you still hunting down ~ headers?]
[18:48:00] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[18:48:08] <graydon> So far I think my most productive adventures in fixing codegen have been by sorting symbol sizes. i.e. start with the question "why are we generating $GIANT_FUNCTION, for some giant function"
[18:48:45] * pcwalton wants to ban ~"" from rustc
[18:48:58] <pcwalton> there are so many useless allocations due to people sprinkling ~ until it compiles
[18:49:07] <Blei> cmr: i gave up :(
[18:49:16] <cmr> Blei: did you make any progress on it?
[18:49:25] <Blei> it's probably not _that_ complicated, but very tedious
[18:49:32] <graydon> hunting down ~ headers?
[18:49:47] <cmr> graydon: figuring out where the headers on ~ are read and fixing it
[18:49:48] <Blei> not much besides reading where boxes are used (and they are used everywhere XD)
[18:49:56] <cmr> all ~ have a 32 byte header
[18:50:01] <graydon> yes I know
[18:50:06] <graydon> it has to retain that until the GC lands
[18:50:13] <cmr> oh, ok.
[18:50:18] <pcwalton> wait, it does?
[18:50:20] <graydon> unless you want to make the heaps physically incompatible
[18:50:27] <pcwalton> that seems OK to me
[18:50:28] <graydon> in which case "convert ~ to @" will be .. problematic
[18:50:41] <pcwalton> I'm confused
[18:50:43] *** Parts: steven_is_false (user@moz-144077DE.bchsia.telus.net) (ERC Version 5.3 (IRC client for Emacs))
[18:50:45] <Blei> isn't it already impossible without a copy?
[18:50:53] <graydon> only because we don't permit it
[18:50:57] <graydon> we have a bug open to permit it
[18:51:05] <graydon> it's a harmless thing to permit, in that direction
[18:51:19] <pcwalton> I wouldn't block a major perf issue on something we can't do today
[18:51:28] <pcwalton> given that we know how to fix it post-GC landing
[18:51:36] <sully> hm, is there a way to make the runtime not spawn any new threads?
[18:51:37] <bstrie> pcwalton: the ~ sprinkling is just a legacy thing, I've never felt the need to sprinkle them just to get things to compile. I have, however, sometimes wrapped whole programs in unsafe blocks...
[18:51:49] <thiez> the isrustfastyet website looks hilarious :D
[18:51:59] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[18:52:31] <graydon> pcwalton: *shrug* if you like
[18:53:04] <cmr> graydon: can you restart the auto-linux-64-opt-vg build?
[18:53:12] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[18:53:27] <graydon> cmr: I did
[18:53:33] <graydon> it's running on linux6
[18:53:42] <graydon> half hour ago
[18:53:47] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[18:53:50] <cmr> oh. the console shows the build as "exception"
[18:54:12] <graydon> most recent result was, yes
[18:54:31] <graydon> console's not always so bright about showing _current_ build :(
[18:54:37] <pauls> bblum: pong
[18:54:54] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[18:55:21] <bblum> pauls: can you tell me about maybe_whole!?
[18:55:22] <Blei> heh, lint warnings that disappear without running passes
[18:55:29] <bblum> i am getting maybe-wholed
[18:55:35] <pauls> bblum: ahhh, lemme swap it in.
[18:55:43] <pauls> It's part of the parser, right?
[18:55:43] <Blei> llvm is making its own problems!
[18:55:47] <bblum> yes
[18:56:11] <bblum> pauls: it's a bunch of matterns of match copy *($p).token { INTERPOLATED ... return x }
[18:56:19] <pauls> Okay, it's what allows the parser to handle the weird pre-parsed tokens that the macro system puts into the token stream.
[18:57:04] <sully> hm, is there a way to make strace trace threads that get cloned, but not processes?
[18:57:14] <sully> I am aware that the distinction is a little fuzzy in linux, but.
[18:57:19] <bblum> pauls: hmm, so, if there's "maybe_whole!(self, nt_path);", that's like, "Check if the macro system already emitted an INTERPOLATED(nt_path(some_path)); if so, return it?
[18:57:19] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[18:57:28] <pauls> bblum: exactly
[18:57:31] <pnkfelix> pcwalton: am I wrong in thinking that Rust is too unstable to use in an OS course this fall?
[18:57:38] <bblum> i see
[18:57:41] <bblum> hmm
[18:57:50] <pnkfelix> (that was really a more general note)
[18:57:51] <pcwalton> pnkfelix: depends on the course
[18:57:57] <pcwalton> but probably
[18:57:59] <bstrie> pnkfelix: depends on how adventurous your students are
[18:58:04] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[18:58:08] <pnkfelix> pcwalton: maybe I'll let graydon respond to the David Evans email
[18:58:12] <pnkfelix> pcwalton: he's better at being nice
[18:58:22] <pnkfelix> pcwalton: than I am
[18:58:51] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[18:59:05] <pnkfelix> (I guess his email did explicitly say that caveats would be welcome too.)
[18:59:14] <pauls> bblum: it's a bit tricky to put them in the parser, because they need to go before any tokens ever get consumed off the front of the thing, because that will balk at an INTERPOLATED token
[18:59:34] <cmr> sully: I don't think so.
[18:59:38] <bblum> pauls: which is presumably why it's at the start of every function
[19:01:13] <pauls> bblum: yeah. there's some reason why it's supposed to be late... oh, because of things like "1 + INTERPOLATED(...)"
[19:01:34] <cmr> rustc build time is down to 12 minutes on my box from 19 when I first tried rust.
[19:02:20] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[19:02:22] <bblum> pauls: can you tell me where to find the code that parses, e.g., a path in a macro?
[19:02:24] *** Quits: eschweic (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[19:02:37] <pcwalton> somebody added ~ until it compiles in Servo just now
[19:02:44] <indutny> just curious
[19:02:48] <pauls> bblum: like, handles `$something:path`?
[19:02:49] <indutny> what's up with bors?
[19:02:49] <pcwalton> causing layout to spend 100% of its time doing allocations
[19:03:01] <bblum> pauls: i think so. but i also think i found it
[19:03:04] <pcwalton> this is not a theoretical problem :(
[19:03:08] <bblum> macro_parser.rs: parse_nt
[19:03:13] <bblum> pcwalton: busted.
[19:03:34] <pauls> bblum: yeah.
[19:03:36] <indutny> it doesn't seem to be picking https://github.com/mozilla/rust/pull/7257 ...
[19:03:39] <indutny> or am I missing something?
[19:03:49] <cmr> indutny: it's in the queue
[19:03:53] <indutny> oh
[19:03:55] <cmr> indutny: http://buildbot.rust-lang.org/bors/bors.html
[19:03:59] <indutny> thanks!
[19:04:54] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[19:04:57] <indutny> I'm just curious when I'll be able to continue developing masm.rs :)
[19:05:08] <thiez> pnkfelix: an OS course in Rust might be doable
[19:05:11] <indutny> this should be quite exciting
[19:05:18] <thiez> it's not like they'll be using most of the library
[19:05:23] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[19:05:30] <cmr> indutny: you can develop off a local copy of rustc with your patch, no?
[19:05:38] * indutny is too lame :)
[19:07:17] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[19:08:02] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[19:09:04] <bblum> arghhh
[19:09:20] <SiegeLord> Hmm... can you pattern match a struct with private members?
[19:10:13] *** Joins: jviereck (Adium@moz-BAA57285.ethz.ch)
[19:11:00] <bblum> no
[19:11:03] <SiegeLord> And can you even instantiate a struct with private members?
[19:11:12] <SiegeLord> Using the S{} notation
[19:11:27] <doener> did the way RUST_LOG is used change?
[19:11:29] <bblum> no
[19:11:33] <doener> I'm not getting any output anymore 
[19:11:34] <SiegeLord> Sweet, thanks
[19:11:54] <doener> using RUST_LOG=rustc::middle
[19:12:12] <bblum> alright, git question
[19:12:14] <cmr> doener: I get tons of output
[19:12:18] <cmr> on latest master
[19:12:32] <doener> nevermind, I actually wrote rustc::trans::middle
[19:12:39] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[19:12:48] <bblum> i have a branch in my github repo with an open PR that has commits ABC on top of a master branch whose most recent commits are PQR, so the history is PQRABC
[19:13:02] <bblum> i have since rebased my local branch onto a more recent master, so i have PQRSTABC
[19:13:10] <sully> does anybody know to what extent rustpkg actually works/is used?
[19:13:20] <bblum> i added a commit locally that i want to add to the new pull request, so i have PQRSTABCD
[19:13:25] <bblum> and i want to push D to my pull request
[19:13:31] <bblum> without push -f
[19:13:33] <bblum> what do i do
[19:13:54] <cmr> bblum: create a new branch identical to the one in your github repo, `git cherry-pick D`
[19:13:54] <doener> bblum: so you want to push PQRABCD?
[19:13:55] <bblum> i feel like i should somehow get a mirror of the PQRABC branch, and cherry-pick D onto it?
[19:14:03] <bblum> doener: correct
[19:14:05] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Quit: eatkinson)
[19:14:08] <bblum> cmr: yes, how can i do the first step
[19:14:34] <cmr> bblum: `git fetch origin; git checkout -b whatever origin/that_branch` ?
[19:14:41] <bblum> ah, excellent
[19:15:04] <cmr> sully: afaik mostly unused, works but isn't all-there yet
[19:17:04] <bblum> cmr: it won't let me do it :(
[19:17:23] <bblum> it says non-fast-forward and that i should git pull
[19:17:24] <cmr> bblum: because it would blow over your local branch which is probably tracking origin/that_branch, yeah?
[19:17:26] <cmr> yeah
[19:17:34] <bblum> no, i already made the mirror branch just fine
[19:17:37] <bblum> it won't let me push
[19:17:39] <cmr> oh
[19:17:47] <cmr> are you pushing the right thing?
[19:17:54] <cmr> git push origin mirror_branch
[19:18:01] <cmr> Otherwise it will try and push the other one I think
[19:18:08] <bblum> oops, hm
[19:18:32] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[19:18:49] <bblum> okay, but so, i have a local branch of the same name as the remote branch, but that's the one that got rebased to a more recent master
[19:19:05] <cmr> yup
[19:19:14] <bblum> should i rename it?
[19:19:16] <cmr> oh uh
[19:19:25] <cmr> git push origin mirror_branch:origin_branch
[19:19:27] <doener> bblum: you can do: gi tpush origin local_name:remote_name
[19:19:28] <cmr> I think
[19:19:33] <bblum> oh, good, brilliant
[19:19:35] <sully> one of the rustpkg tests pollutes the build directory
[19:19:44] <sully> and I am looking at the tests and it is clear that they aren't really testing anything
[19:20:11] <sully> so, the idea is that they make a package, then do a build, then do something to modify the package, do a rebuild, and make sure that the package has been rebuilt
[19:20:33] <sully> but, they are screwing up directory manipulation, so they aren't actually updating the package
[19:20:39] <sully> but... the tests are still passing
[19:20:44] * bblum succeeded, made a mess in the process, goes to clean up after himself
[19:20:48] <cmr> sully: you found a bug, yay!
[19:20:53] <cmr> sully: :p
[19:21:51] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[19:21:57] <sully> so I think that the rustpkg thing just always rebuilds?
[19:22:28] <sully> ah, this seems to be known
[19:22:43] *** Joins: steven_is_false (user@1E3F14AE.29819A33.115CE8E4.IP)
[19:22:44] <sully> there are tests that test that it *doesn't* rebuild when it shouldn't
[19:22:46] <sully> that are ignored
[19:23:20] *** Joins: ssbr (ssbr@moz-141F89C6.block0.gvtc.com)
[19:24:39] <bblum> how long does it usually take bors to notice open r+'ed pull requests?
[19:24:57] <cmr> it wakes up and checks every 3 min afaik
[19:25:12] <bblum> hmm it's been since last night that i got an r+ on this
[19:25:20] <cmr> graydon: Did tuple-like structs predate typedefs/
[19:25:26] <graydon> no
[19:25:44] <cmr> They seem to be used a lot where typedefs would be better, unless I misunderstand how and why they work
[19:26:09] <engla> newtype structs means you can implement new traits on them
[19:26:27] <cmr> Ah, that might be it
[19:26:31] <doener> bblum: cycles take a few hours atm
[19:26:53] <bblum> ok i see
[19:27:22] <bblum> so, i pushed an extra cleanup commit since the r+; will it take that or will it need me to go in and r= or something?
[19:27:45] *** Quits: jviereck (Adium@moz-BAA57285.ethz.ch) (Quit: Leaving.)
[19:27:48] <doener> needs a new r+ / r=
[19:28:08] <steven_is_false> There's a config option to enable using an existing rust installation to compile rust right?
[19:28:17] <bblum> graydon: am i on bors's r= list?
[19:28:19] <cmr> steven_is_false: yeah, --local-rust or something like that
[19:28:25] *** Quits: eholk (eholk@moz-932584F0.uconnect.utah.edu) (Quit: eholk)
[19:29:13] <steven_is_false> cmr: Thanks.
[19:29:26] <steven_is_false> Will it be faster?
[19:29:29] <cmr> No
[19:29:45] <cmr> And most of the time it doesn't even work, since the snapshot is too old.
[19:30:10] <cmr> The option is really only there for debugging snapshots I think
[19:30:16] <cmr> not really sure why it would exist elsewise
[19:30:20] <steven_is_false> cmr: --enable-local-rust appears not to detect my locally installed rust
[19:30:30] <cmr> steven_is_false: you need to set --rust-root
[19:30:51] <steven_is_false> cmr: --rust-root=~/.local ?
[19:31:01] <cmr> steven_is_false: I think so!
[19:32:34] <steven_is_false> cmr: It's --local-rust-root
[19:32:46] <SiegeLord> Do people get their own emails on the mailing list?
[19:33:18] <cmr> steven_is_false: so close :(
[19:33:34] <steven_is_false> --local-rust-root will still be useful for me because it means I don't need to download the rust snapshot right?
[19:33:43] <cmr> steven_is_false: if it works, yes.
[19:33:51] <cmr> there are already PRs in the queue that will break that though
[19:34:08] <steven_is_false> cmr: oh
[19:34:44] <cmr> SiegeLord: fwiw in gmail it lists my own emails. not sure if it's actually receiving one from the list or just adding it to thread locally
[19:34:47] <steven_is_false> cp: cannot stat `/home/steven/.local/lib/libcore*.so': No such file or directory 
[19:35:21] <steven_is_false> I don't think it's going to work :(
[19:35:29] <cmr> steven_is_false: see, it's so generally useless it looks like noone even bothered to port it during the great renaming :p
[19:36:16] <steven_is_false> cmr: The rust compiler should be written in Python, Scheme, Lisp, or JavaScript.
[19:36:38] <steven_is_false> That way the rust compiler wouldn't need to be compiled.
[19:36:49] <bstrie> SiegeLord: in gmail I do get my own mails, but it automatically marks them as read
[19:37:11] <SiegeLord> I wonder why I am not getting them...
[19:37:16] *** Joins: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de)
[19:37:19] <thiez> I automatically mark them all as read and just read in on the online archive
[19:37:24] <bstrie> SiegeLord: have you posted to the list before
[19:37:26] <SiegeLord> I get them on other mailing lists, but not rust-dev
[19:37:53] <SiegeLord> bstrie: Yes
[19:39:10] <steven_is_false> I'm thinking about using some of the Debian packaging utilities to make configuring, and compiling Rust easier for me http://www.debian.org/doc/manuals/maint-guide/first.en.html#workflow
[19:40:09] *** Joins: youknowone (youknowone@A826BD81.8A0DEF81.38747683.IP)
[19:41:35] <sully> there are so many outstanding pull requests
[19:41:36] <sully> wow
[19:42:52] <sully> hm, who all is allowed to r+ pull requests?
[19:43:22] <bblum> are you on the servo mailing list
[19:43:27] <bblum> graydon sent a message to it with the current list
[19:43:36] <bblum> (you are on it)
[19:44:05] <bblum> oops, i forgot to triage this week; i should do this
[19:44:19] *** Quits: pnkfelix|rcirc (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (Input/output error)
[19:45:03] *** Quits: pnkfelix (pnkfelix@moz-801E009D.vlan502.asr1.cdg2.gblx.net) (Quit: Leaving.)
[19:48:06] <cmr> nmatsakis: You were the person that added useful type names to the emitted IR right? Where does that happen/what are the rules of how it's emitted? For example, I'm looking at a %"~struct Foo[#0]", which is a tuple-stuct containing 13 uints
[19:48:17] <cmr> Or rather, how it's generated
[19:49:20] *** Joins: vodik (simon@moz-85CCF3E9.dynamic.uwaterloo.ca)
[19:49:40] <Blei> cmr: middle/trans/type_of.rs:295
[19:49:55] <cmr> Blei: thanks
[19:50:52] <Blei> hmm, the only lint output i get pertains to bitcasts of functions
[19:51:05] <Blei> according to #llvm, this is likely a false positive
[19:52:11] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[19:53:07] *** Joins: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com)
[19:54:05] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[19:54:27] <sully> ok, so, if I have a handful of minor fixes and refactors to a bunch of different places
[19:54:42] <sully> is it reasonable to bundle them into one PR to expediate bors testing?
[19:54:48] <cmr> sully: yes, please do
[19:54:48] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[19:55:15] <steven_is_false> configure: error: Option '--build=x86_64-linux-gnu' is not recognized . How far along is support for cross compiling?
[19:55:55] <cmr> steven_is_false: cross compiling works fine. I think it's x86_64-unknown-linux-gnu though
[19:56:43] <sully> what does orange mean on the buildbots?
[19:56:49] <steven_is_false> okay
[19:57:21] <cmr> sully: failed-again
[19:57:34] <cmr> sully: as in, this build is not the one that caused the breakage
[19:57:58] <sully> oh, I mean in the log part, not hte top part
[19:58:05] <sully> oh, looks like it means that it had warnings?
[19:58:10] <sully> which of course everything does
[19:59:54] *** Parts: steven_is_false (user@1E3F14AE.29819A33.115CE8E4.IP) (ERC Version 5.3 (IRC client for Emacs))
[20:00:05] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[20:00:33] *** Quits: ramige (ramige@moz-28AD658E.dynamic.ip.windstream.net) (Quit: Leaving)
[20:06:00] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[20:06:03] <nmatsakis> cmr: I didn't do that, I did add code to label allocas, but it hasn't landed yet. I think that was part of an aatch refactoring.
[20:06:20] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[20:06:56] <cmr> nmatsakis: ah
[20:07:27] <MaikKlein> I can't call rust code from c++ yet right? 
[20:07:41] <nmatsakis> MaikKlein: you can do that
[20:07:49] <nmatsakis> MaikKlein: you can declare an extern fn, it is callable from C.
[20:07:59] <nmatsakis> MaikKlein: e.g., "extern fn callback(v: uint) { ... }"
[20:08:14] <nmatsakis> MaikKlein: when you access the fn `callback`, it will currently have type `*u8`
[20:08:38] <doomlord> C style functions for cross over between languages i think
[20:08:47] <MaikKlein> nmatsakis, hm okay thanks
[20:09:07] *** Quits: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net) (Ping timeout)
[20:09:25] *** Joins: steven_is_false (user@moz-144077DE.bchsia.telus.net)
[20:10:50] *** Joins: jorendorff (jorendorff@moz-1747FB68.hsd1.tn.comcast.net)
[20:10:59] <bblum> pcwalton: how does spaghetti stacking interact with zero.rs?
[20:12:27] <jack> if i hav ea create foo.rc containing foo.rs and bar.rs, how do i bring bar into scope in foo.rs? `use bar;` and `use super::bar;` and `use self::bar;` etc all fail
[20:13:23] <SiegeLord> Are there mod statements in foo.rc?
[20:13:34] <jack> use. mod foo; and pub mod bar;
[20:14:59] <jack> s/use/yes/
[20:16:26] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[20:16:31] *** Joins: eschweic (Adium@2557E599.66715431.D25A875A.IP)
[20:16:37] <pcwalton> bblum: it just ends up being disabled
[20:17:19] <SiegeLord> jack: Just use bar; works for me
[20:17:30] <mblbruce> jack: cmr made me a gist yesterday that may help you: https://gist.github.com/cmr/5827532
[20:17:54] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[20:18:24] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[20:18:24] *** ChanServ sets mode: +o brson
[20:22:07] *** Quits: KindOne (KindOne@E313C970.A337191.EC6A1518.IP) (Ping timeout)
[20:22:13] <jack> i have a crate called png, defined in png.rc. the public stuff is in png.rs and the libpng binding glue is in ffi.rs. this all works (use ffi from png.rs) except if i put `pub use png::*;` in png.rc. then both that line and the use ffi a broken
[20:22:44] <nmatsakis> https://github.com/mozilla/rust/pull/7280 makes type parameters print as their actual name instead of 'a...
[20:22:49] <nmatsakis> ...if someone would care to r? :)
[20:22:53] *** Joins: eholk (eholk@moz-61CBCD5E.uconnect.utah.edu)
[20:23:21] <jack> if i don't use '*' but import the symbols by name, it works.
[20:23:33] <SiegeLord> jack: Maybe the issue is that you have png.rs and png.rc
[20:24:05] <SiegeLord> .rc files don't do anything special these days anyway
[20:24:27] <jack> i suppose the new style is to call it lib.rs
[20:25:06] *** Joins: jjr (jeffrey@moz-2A1ACF92.cpe.cableone.net)
[20:25:16] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[20:25:40] <rubber-duck> there doesn't seem to be a from_iter in vec ?
[20:26:02] <cmr> rubber-duck: call .collect on the iterator
[20:26:38] <cmr> rusti: use std::iterator::Counter; let xs: ~[int] = Counter::new(0, 2).take_(10).collect(); xs 
[20:26:39] -rusti- ~[0, 2, 4, 6, 8, 10, 12, 14, 16, 18]
[20:27:25] <rubber-duck> that's very unintuitive but OK :P
[20:27:38] *** Quits: eschweic (Adium@2557E599.66715431.D25A875A.IP) (Connection reset by peer)
[20:27:38] *** Joins: eschweic1 (Adium@2557E599.66715431.D25A875A.IP)
[20:28:20] <MaikKlein> rusti: use std::iterator::Counter; let xs: ~[int] = Counter::new(0, 2).skip(5).take_(10).collect(); xs
[20:28:20] -rusti- ~[10, 12, 14, 16, 18, 20, 22, 24, 26, 28]
[20:28:32] <MaikKlein> rusti: use std::iterator::Counter; let xs: ~[int] = Counter::new(0, 2).take_(10).skip(5).collect(); xs
[20:28:32] -rusti- ~[10, 12, 14, 16, 18]
[20:29:08] <MaikKlein> hm
[20:29:22] <MaikKlein> this doesn't seem right
[20:30:05] <MaikKlein> shouldn't it output [20, 22, 24, 26, 28]
[20:30:25] <rubber-duck> no ? take takes from start ?
[20:30:26] <cmr> No. You take 10, then you skip 5 from the iterator that take returns.
[20:31:05] <MaikKlein> ah right
[20:31:07] <MaikKlein> I am stupid
[20:31:08] <MaikKlein> :D
[20:31:31] <EXetoC> MaikKlein: only a little though, it's ok!
[20:31:38] <MaikKlein> :)
[20:35:00] <jack> i thought extern fns were considered *u8? however if my FFI type sig has a *u8, i can't seem to pass an extern fn to it.
[20:35:35] <cmr> jack: maybe transmute the fn?
[20:36:25] <jack> i'm curious why it's not complaining here: https://github.com/mozilla-servo/rust-glut/blob/master/glut.rs#L147
[20:36:38] <jack> is ti simply because the extern fn takes no parameters?
[20:36:38] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[20:37:25] <SiegeLord> rusti: extern fn test(a: int) { } let t : *u8 = test;
[20:37:26] -rusti- more than 5 lines of output, pastebinned: http://sprunge.us/fPgZ
[20:38:14] <jack> oh, maybe the issue is that in my case, the extern fn is a c call
[20:38:54] <jack> pub extern { pub fn foobar(â€¦); }
[20:38:54] *** Quits: vodik (simon@moz-85CCF3E9.dynamic.uwaterloo.ca) (Ping timeout)
[20:39:29] *** Joins: vodik (simon@moz-85CCF3E9.dynamic.uwaterloo.ca)
[20:41:10] *** Quits: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com) (Ping timeout)
[20:41:28] <roo> I think it is time for me to give up on this macro. https://gist.github.com/jessopher/5834120
[20:42:18] <pauls> roo: you're correct, the macro system doesn't accept unpaired parens.
[20:42:28] <roo> :((((((((
[20:42:35] <bblum> too bad we don't have $
[20:42:40] <bblum> "too bad"
[20:42:42] <pauls> It's a compromise we had to make to make it possible to parse a Rust file without expanding the macros.
[20:43:31] *** Joins: Nisstyre (wes@moz-FD86289.netflash.net)
[20:43:38] <seth> bblum: what, you don't like '$'? =)
[20:43:52] <bblum> i do when i am writing haskell
[20:44:04] <bblum> i don't think it would be remotely appropriate for rust
[20:44:15] <pauls> roo, you can do with with a recursive macro.
[20:44:29] <pauls> Lemme see if I can conjure it up...
[20:44:33] <bstrie> I don't know what a recursive macro is, but it sounds frightening
[20:44:36] <bstrie> maybe I should leave...
[20:44:41] <seth> doesn't really fit in with rust, no
[20:44:42] <roo> lol
[20:44:43] <bblum> our macro system is turing complete? :O
[20:44:50] <pauls> bstrie: recursive macros want to be your friend!
[20:44:51] <bblum> i guess that makes sense
[20:44:55] <bblum> does it have like a timeout or something
[20:45:10] <pauls> bblum: eholk wrote a lambda calculus interpreter in the macro system.
[20:45:18] <bblum> oh yeah, i remember that
[20:45:27] <pauls> macro_rules! chain(
[20:45:51] *** Joins: dew (Instantbir@moz-66796D51.dhcp.stls.mo.charter.com)
[20:45:56] <roo> your irc client dropped most of that i think (i hope)
[20:46:00] <bblum> speaking of eholk, eholk: i was assigned one of your old pipe issues for triage, and i don't get what send_all/send_any mean
[20:46:01] <pauls>   ($root:expr) => ($root)
[20:46:11] <pauls>   //roo: nope, still working on it
[20:46:44] <nmatsakis> pcwalton: so i've been thinking more about requiring that the T in @T meet 'static---I think I am in favor
[20:46:55] <pcwalton> yeah, I like that idea
[20:47:09] <nmatsakis> loosening up the rules on dtors would be nice.
[20:47:11] <doomlord> are multi-block macros still broken 
[20:47:18] *** Quits: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de) (Ping timeout)
[20:47:38] <pauls>   ( $body_car:expr, $head_car:expr; $($body_cdr:expr, $head_cdr:expr);* $root:expr) => (
[20:47:56] <pauls>     //doomlord: multi-item? yes, last I heard
[20:48:09] <bblum> nmatsakis: does that help for having @T in dtors, or dtors in @T? neither seems right to me...
[20:48:13] <doomlord> ok (was wondering what thats called..)
[20:48:23] <doomlord> looking forward to that
[20:48:26] <cmr> I hope trans code gets easier to read with time. I'm spending an inordinate amount of time trying to figure out what trans_tuple_struct does and how
[20:48:31] <bstrie> pauls: this is an amusing way to compose a macro
[20:48:36] <steven_is_false> rusti: quote!(fn main() { })
[20:48:36] -rusti- <anon>:9:9: 9:14 error: macro undefined: 'quote'
[20:48:36] -rusti- <anon>:9          quote!(fn main() { })
[20:48:36] -rusti-                   ^~~~~
[20:48:36] -rusti- application terminated with error code 101
[20:48:49] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[20:48:54] <cmr> rusti: stringify!(fn main() { })
[20:48:56] -rusti- "fn main ( ) { }"
[20:48:58] <cmr> steven_is_false: that?
[20:49:07] *** Quits: brendan (brendaneic@6CE790D5.927818F1.82490606.IP) (Ping timeout)
[20:49:12] <sully> hm
[20:49:20] <nmatsakis> bblum: it would mean that dtors could access region data
[20:49:22] <sully> does anybody have a good understanding of how inlining works?
[20:49:30] <nmatsakis> sully: I do, more or less.
[20:49:32] <sully> and what code to look at?
[20:49:48] <nmatsakis> sully: what are you trying to figure out?
[20:49:53] <cmr> sully: doesn't llvm do all the inlining?
[20:50:33] <sully> what is the deal with node_id/def_ids of code that gets inlined
[20:50:37] <nmatsakis> sully: the overall strategy is that we decode the AST into a new item, compile it, and then LLVM does the actual inlining
[20:50:44] <pauls>     $body . chain ( |$head|  chain!($($body_cdr:expr, $head_cdr:expr);* $root:expr ) )
[20:50:46] <pauls>   )
[20:50:47] *** Joins: brendan (brendaneic@6CE790D5.927818F1.82490606.IP)
[20:50:57] <sully> do we rerun the analysis passes on the stuff?
[20:51:00] <nmatsakis> sully: when code gets inlined, we remap the external defids into local ids
[20:51:04] <nmatsakis> sully: no, we encode the maps.
[20:51:11] <nmatsakis> sully: and decode their contents.
[20:51:13] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Ping timeout)
[20:51:25] <nmatsakis> sully: that is all in librustc/middle/astencode.rs
[20:51:43] <sully> ok, hm.
[20:51:52] <nmatsakis> sully: decode_inlined_item() being the entry point
[20:51:56] <pauls> P.S. `${}*` is not allowed, nor does it have an obvious meaning, because `$()*`does not transcribe any parentheses; it just repeats.
[20:52:45] <nmatsakis> sully: basically for the defids we remember the min/max of the inlined code, and we allocate a range of fresh ids with same length, and just convert...
[20:52:58] * sully nod
[20:53:05] <sully> so, what I am trying to do right now
[20:53:15] *** Quits: eholk (eholk@moz-61CBCD5E.uconnect.utah.edu) (Quit: eholk)
[20:53:25] <bblum> nmatsakis: in what way? issue #3167 didn't use any GC
[20:53:52] <sully> is properly handling vtable bounds on traits when you implement them
[20:54:03] <roo> pauls: right, it was a stab in the dark to get unmatched parenthesis in that repeating block
[20:54:07] <sully> and I have it so that I can do the bound resolution, but need to figure out where to store the vtables
[20:54:26] <nmatsakis> bblum: no mut fields anymore, for one thing, but let me re-read the example in a bit and ponder, make sure my reasoning's not off
[20:54:30] *** Joins: tav (tav@moz-5ED3AF3C.range86-152.btcentralplus.com)
[20:54:49] <bblum> sully: what is a 'vtable bound'?
[20:54:53] <roo> since {x} => [foo] is valid, i thought it might also work for $()* s
[20:55:03] <sully> er, trait bounds
[20:55:06] <Blei> what is a ast::def_arg?
[20:55:13] <sully> because I will need to use them for translating default methods
[20:55:26] <bblum> oh, the issue you filed earlier
[20:55:30] <nmatsakis> sully: I am confused, wen are you doing this resolution?
[20:55:32] <Blei> a function argument?
[20:55:32] <sully> and so I need to figure out how to do this in a way that will work in the cross crate situation
[20:55:47] <sully> I am doing the resolution during typechecking
[20:56:15] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[20:56:28] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[20:56:32] <nmatsakis> sully: are you making a new map for this?
[20:56:39] <nmatsakis> sully: or does this fit one of the existing maps?
[20:56:39] <pauls> roo: Oh, I see what you mean; yes, it would be possible to relax parsing that way. 
[20:56:48] <sully> that is what I am trying to figure out
[20:56:57] <sully> there is vtable_map, which I could shove it in
[20:57:22] <rubber-duck> so, if I'm reading it correctly - a borrowed pointer isn't actually a pointer it's a tuple of pointer and size ?
[20:57:30] <sully> but I'm not sure this would end up working right in the cross crate situation
[20:57:52] <kimundi> rubber-duck: Only for vectors
[20:58:05] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[20:58:38] <kimundi> &[T] == (*T, uint); &T == *T
[20:58:58] <rubber-duck> yea that's actually quite smart I like it
[20:59:13] <nmatsakis> sully: what would be the key
[20:59:31] <kimundi> rubber-duck: The same is true for a &str
[20:59:57] <rubber-duck> kimundi, yeah I know I got to it by looking at str, because I was confused how slicing could work if & is only a pointer
[21:00:18] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[21:00:26] <bstrie> graydon: btw http://haacked.com/archive/2013/06/18/semver-2-0-released.aspx
[21:00:49] <bstrie> graydon: apparently they were focusing on clarifying ambiguities
[21:00:52] <bblum> and the no-asserts LLVM build pulls ahead during stage1
[21:01:07] <sully> nmatsakis: node id of the impl, I suppose
[21:01:35] <graydon> good
[21:01:37] <nmatsakis> sully: yeah so I'm trying to remember what these maps do, the vtable map currently maps from a call site to the set of vtables to be provided to the callee, right?
[21:01:49] <sully> yeah
[21:04:03] <SiegeLord> Reading this: http://www.reddit.com/r/rust/comments/1gs93k/rust_for_game_development/ Are there rust 2.0 ideas for metaprogramming?
[21:04:10] *** Joins: KindOne (KindOne@E313C970.A337191.EC6A1518.IP)
[21:04:35] *** Quits: Blei (philipp@moz-650B9C6A.cust.bluewin.ch) (Quit: WeeChat 0.4.1)
[21:04:36] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Quit: msingle)
[21:04:47] *** Joins: cscottnet (cscott@moz-2577C94A.net)
[21:05:26] <nmatsakis> sully: so we make these synthetic ids for default methods,
[21:06:27] <nmatsakis> sully: it seems like what we would want to do is to create a struct that represents the default method call,
[21:06:35] <roo> pauls: is there a way to add in a non-delimiter token? since $body_cdr and $root can parse the same things, there is some ambiguity that needs to be resolved.
[21:06:36] <nmatsakis> sully: er, the default method impl,
[21:06:46] <nmatsakis> sully: perhaps it already xists, probably, in any case it would contains the substs needed,
[21:06:51] <nmatsakis> sully: along with the def-id of the method in the trait,
[21:06:52] *** Joins: muslimmasry (muslimmasr@41204384.3DA546B.563BE9DB.IP)
[21:06:59] *** Quits: muslimmasry (muslimmasr@41204384.3DA546B.563BE9DB.IP) (User has been banned from Mozilla (abuse))
[21:07:04] <nmatsakis> sully: this could be its own case for inlined_item 
[21:07:05] <bblum> brson: where in the new runtime code do i find the current fail implementation?
[21:07:22] <pauls> roo: Oh, yes. It may be necessary to throw in other tokens to disambiguate. The macro parser is finiky.
[21:07:31] <nmatsakis> sully: in that way, when we decode it, everything would basically just work I should think
[21:07:45] <pauls> roo: just put them in; there's no quoting needed.
[21:07:49] <brson> bblum: sys::begin_unwind_ and Unwinder in rt::task
[21:08:17] <roo> pauls: Ok
[21:08:30] *** Joins: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de)
[21:08:34] <nmatsakis> sully: however, let me look a bit in the code to try and map this vision onto what's there :)
[21:09:00] *** Joins: eholk (eholk@moz-61CBCD5E.uconnect.utah.edu)
[21:09:07] <sully> ok
[21:09:10] <cmr> Does -Z count-llvm-insns work for anyone?
[21:09:16] <sully> so, the reason I need this
[21:10:03] <cmr> I get an ICE, "rust: task failed at 'borrowed', /home/cmr/hacking/rust/src/librustc/middle/trans/build.rs:50"
[21:10:19] <sully> is that for static calls to default methods, the information we have from the call site has the substitutions and vtables for the actual impl that is being called through
[21:10:37] *** Parts: steven_is_false (user@moz-144077DE.bchsia.telus.net) (ERC Version 5.3 (IRC client for Emacs))
[21:10:40] <eholk> bblum: i think send_all is basically broadcast,
[21:10:49] <doener> cmr: same here
[21:10:53] <bblum> eholk: i mean, what does broadcast even mean
[21:11:16] <eholk> i think it means "send the same value to every channel in the vector"
[21:11:18] <sully> that impl then implements the trait under some substitution (and vtable resolution), and to compile the default method, we need to compose the substitutions (and vtables) in order to get the proper substs/vtables for the default method
[21:11:45] <eholk> bblum: and send_any is probably pick one of these channels and send it there, probably for load balancing or something
[21:12:06] <bblum> i see
[21:12:34] <bblum> my feeling about them is the library shouldn't bother to provide it since it'd be so easy for the user to implement
[21:12:43] <sully> I have this being done properliy for the type substs, and need to figure out how to get it working for the vtables
[21:12:55] <sully> I could just like, add another table, and add it to metadata...
[21:12:55] *** Quits: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net) (Input/output error)
[21:12:56] <eholk> but if every user is going to write it, then we might as well put it in the library
[21:13:57] <eholk> also, adding send_any and send_all probably takes less time than discussing whether to have it :)
[21:14:08] <nmatsakis> sully: right, I follow. So, unfortunately I have to run, it's dinner time over here and I have some plans for the evening.
[21:14:23] <sully> ok
[21:14:37] <sully> I need to spend the rest of the day doing my bug triage for this week anyways
[21:14:37] <nmatsakis> sully: however it should be possible to have the decoding match up the def-ids properly,
[21:15:01] <nmatsakis> sully: ok, let's discuss later.
[21:15:38] <nmatsakis> sully: I still feel like if we set this stuff up properly, this will fall out. And it seems like it's not *that* far, from the reading of the code I just did...
[21:16:53] <sully> ok
[21:16:57] *** Quits: snearch (snearch@moz-6CB2F6A0.pool.mediaways.net) (Quit: Verlassend)
[21:17:08] *** Joins: snearch (snearch@moz-6CB2F6A0.pool.mediaways.net)
[21:17:16] <bblum> eholk: well, i see
[21:17:23] *** Quits: Excureo (c@moz-B0B6F5C3.static.knwc.wa.charter.com) (Input/output error)
[21:18:46] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[21:19:08] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[21:20:18] *** Quits: Palmik (palmik@moz-B14BB007.vpn.muni.cz) (Ping timeout)
[21:21:32] <bblum> brson: is the unwind token still caught in the c++ runtime? or... what?
[21:21:54] *** Joins: infynyxx (infynyxx@moz-B75C70D1.hsd1.md.comcast.net)
[21:22:01] *** Quits: sw17ch (sw17ch@moz-39D8564F.wndsny.tds.net) (Quit: sw17ch)
[21:22:54] <cmr> graydon: is http://buildbot.rust-lang.org/builders/auto-linux-64-opt-vg/builds/22 wedged? it hasn't moved in a while
[21:23:26] <graydon> cmr: checking
[21:23:29] *** Quits: lmandel (lmandel@F2D29657.F60B0462.67AC9B1.IP) (Quit: lmandel)
[21:24:48] <graydon> cmr: it's still going. just sloooooowly.
[21:25:00] <cmr> graydon: is it swapping or something? What's up with that :s
[21:25:08] <graydon> I'll go check on the machine
[21:26:10] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[21:26:12] *** Joins: illissius (illissius@moz-19397A63.catv.broadband.hu)
[21:26:42] <bblum> brson: i guess what i mean is, where do i find the task killing code in the new runtime
[21:26:50] <graydon> (sorry, it's mildly difficult for me to find the machine)
[21:26:57] *** Quits: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de) (Ping timeout)
[21:27:03] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[21:27:15] *** Quits: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) (Quit: Leaving.)
[21:28:10] *** Quits: vodik (simon@moz-85CCF3E9.dynamic.uwaterloo.ca) (Ping timeout)
[21:28:53] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[21:29:10] <graydon> it's not swapping
[21:30:09] <graydon> there is a single valgrind process running
[21:30:15] *** Joins: vodik (simon@moz-85CCF3E9.dynamic.uwaterloo.ca)
[21:30:26] <graydon> it's on to rustitest presently
[21:30:38] <cmr> well, it's almost done then at least.
[21:30:45] <brson> bblum: there is no task killing code in the new runtime
[21:30:58] <cmr> and the neverending cycle will be complete :p
[21:31:06] <brson> yet
[21:32:03] *** Quits: vodik (simon@moz-85CCF3E9.dynamic.uwaterloo.ca) (Ping timeout)
[21:32:09] <bblum> brson: so the place for me to start would be to implement that?
[21:33:23] <bblum> is there some special branch to work off of or is it just master
[21:33:25] <sully> hm, so, I was assigned https://github.com/mozilla/rust/issues/3367 to triage
[21:35:28] <graydon> cmr: I am .. not really convinced it's making progress
[21:36:55] <graydon> oh
[21:37:33] <graydon> yeah, it is
[21:37:35] <sully> but don't we have runtime stuff to simulate task blocking on top of nonblocking wrappers?
[21:37:44] <graydon> moved on to core map benchmark (under valgrind)
[21:37:45] <graydon> gosh
[21:37:51] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[21:38:08] <toddaaro> sully: it works for things like IO, but if you use a C function through the FFI that blocks a thread we have to give a pthread for it
[21:38:11] <toddaaro> or everything dies
[21:38:28] <brson> bblum: work off of brson/io. I would not expect failure propagation to work the same in this scheduler. In the old one failure propagation happens on `yield`, which is the only way to defer to the scheduler. I'd expect this one to be different, with various concurrency types explicitly checking whether they need to fail at strategic places
[21:38:30] <sully> ok
[21:38:47] <sully> but the bug is asking for a library that wraps the blocking IO calls that we have in the library, right?
[21:39:11] <brson> is anybody working on a good mailing list response to David Evans re: teaching rust?
[21:39:14] <bblum> brson: well sure, because yield() was the common point of all concurrency primitives in the old runtime
[21:39:19] <toddaaro> true, so we sort of cheat by making it so rust doesn't support blocking system calls like that
[21:39:43] <toddaaro> by simulating them with libuv, but we still have the exact usecase for "other" blocking
[21:40:14] <sully> right, but I'm not really sure what the bug is suggesting we do this for
[21:40:23] <sully> bblum: 
[21:40:39] <bblum> sup sully
[21:40:48] <sully> see discussion about https://github.com/mozilla/rust/issues/3367
[21:40:50] <brson> sully: I think that issue is irrelevant
[21:40:51] <bblum> yes
[21:40:53] <sully> what is it you think should be in this library?
[21:40:58] <sully> yeah, I think I am going to just close it
[21:41:04] <bblum> when i created the bug i didn't really have any specific ideas
[21:41:06] <bblum> it's more like,
[21:41:16] <bblum> make sure there isn't anything anybody might want to do that would block in kernel
[21:41:22] <bblum> that we don't have userspace scheduler support for
[21:41:46] <bblum> if the claim is we have userspace scheduler support for every such call now, then yeah, close it
[21:41:48] <cmr> So afaict literally the only place ast::pure_fn is used besides metadata and typeck is in middle/ty.rs, mk_ctor_fn... but does it need to be a pure_fn? I thought purity was removed from the language.
[21:42:25] <cmr> (and mk_ctr_fn is only used in typeck, btw)
[21:42:26] <bblum> but i think we might also want some sort of generic interface so if someone comes along with a new custom blocking system call or whatever that they can implement userspace sched suppor for it too
[21:42:37] <toddaaro> brson: yea, I think I agree, the "pthreads when you want to do that sort of thing via FFI" is a fairly distinct issue
[21:42:38] <sully> I mean, we have a generic interface, right
[21:42:46] * cmr makes it impure and sees what breaks
[21:42:48] <sully> it is called "task::task().sched_mode(manual_threads(1)).spawn"
[21:43:07] <sully> or at least was when you filed the bug
[21:43:16] <bblum> hmm
[21:43:24] <toddaaro> I don't think it looks like that anymore
[21:43:42] *** Quits: igl (igl@moz-82BF5F31.adsl.alicedsl.de) (Ping timeout)
[21:43:47] <bblum> right
[21:43:52] <toddaaro> closing it in favor of a new issue that accurately describes the issue in the context of the runtime is ideal
[21:44:07] <cmr> pcwalton: ping
[21:44:09] *** Joins: igl (igl@moz-93307E43.adsl.alicedsl.de)
[21:44:12] <pcwalton> cmr: pong
[21:44:20] <bblum> i guess i must have meant "make sure nothing in std::os calls a blocking syscall stupidly"
[21:44:39] *** Joins: threecreepio (jdp@moz-DB2D70E9.cust.bredbandsbolaget.se)
[21:44:54] <cmr> pcwalton: Did you touch... enc_purity, item_to_def_like, or purity_fn_family in your metadata reworking?
[21:45:01] <pcwalton> no
[21:45:15] <cmr> ok
[21:45:20] * cmr rips out pure_fn for good
[21:47:24] *** Quits: snearch (snearch@moz-6CB2F6A0.pool.mediaways.net) (Quit: Verlassend)
[21:47:25] *** Joins: sw17ch (sw17ch@moz-CFD227BC.tmodns.net)
[21:49:03] *** Joins: vcl (chatzilla@1137E56D.76F9E272.DA40C4B3.IP)
[21:49:23] *** Quits: igl (igl@moz-93307E43.adsl.alicedsl.de) (Ping timeout)
[21:50:09] *** Joins: igl (igl@moz-3D1826C9.adsl.alicedsl.de)
[21:51:31] *** Quits: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[21:52:58] <brson> graydon: how are the new bots doing?
[21:53:04] *** Joins: eatkinson (eatkinson@2557E599.66715431.D25A875A.IP)
[21:53:24] <graydon> brson: slow
[21:53:24] <cmr> holy poop that build is finally finished
[21:53:32] *** Joins: vk (chatzilla@moz-685BB999.googlewifi.com)
[21:54:03] <graydon> brson: I'm unsure about the cause. it's possible I should try to constrain valgrind to run only on real hardware.
[21:54:31] <vcl> I am curious - why does Rust use cc/gcc to produce executables instead of using ld directly?
[21:54:38] <graydon> build 22 there was too slow because it was priming the llvm build again
[21:54:41] <cmr> graydon: the console still shows that commit's build as purple but auto is all-green. is bors going to kick in? (it finished 6 minutes ago)
[21:54:42] *** Quits: igl (igl@moz-3D1826C9.adsl.alicedsl.de) (Ping timeout)
[21:54:57] <pcwalton> vcl: no good reason, I believe.
[21:55:16] <graydon> cmr: good question. checking.
[21:55:23] *** Quits: sw17ch (sw17ch@moz-CFD227BC.tmodns.net) (Ping timeout)
[21:55:29] <cmr> vcl: I thought it was because the cc handles the linker in an easier more cross-platform manner than using ld directly does
[21:55:33] *** Joins: igl (igl@moz-960CE228.adsl.alicedsl.de)
[21:56:11] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[21:56:21] <vcl> cmr: that may be true, but it creates dependency on gcc, at least on Windows
[21:56:22] *** Joins: vodik (simon@moz-85CCF3E9.dynamic.uwaterloo.ca)
[21:56:39] *** Quits: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[21:56:41] <graydon> vcl: code to use link.exe would be welcome
[21:56:46] <brson> cmr vcl: that's right, operating the linker is just fiddly and cc already knows how. i don't think anybody is in favor of having an external gcc dependency long term
[21:57:04] <graydon> vcl: though we .. were going to try to approach this via using clang's driver, which can be library-operated and knows quite a few other linkers
[21:57:13] <graydon> llvm will eventually finish growing a linker too
[21:57:27] *** Quits: jjr (jeffrey@moz-2A1ACF92.cpe.cableone.net) (Quit: jjr)
[21:57:48] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[21:58:03] <vcl> graydon: using link.exe would create a dependency on Visual Studio...
[21:58:19] <cmr> vcl: Well you have to have a dependency on *some* toolchain!
[21:58:26] <cmr> Unless there's a linker besides link.exe
[21:58:33] <graydon> vcl: until llvm ships with its own linker, there's not much else we can do except depend on an external one
[21:59:00] <graydon> vcl: we're well aware of the unfortunate dependency problems of the platforms we're targeting. need constructive suggestions, not just restating them.
[21:59:37] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[21:59:38] <vcl> Would it be acceptable to ship mingw's ld in the box with rustc?
[22:00:11] <cmr> vcl: rust on windows already requires a complete mingw installation, just shipping the linker isn't going to help
[22:00:19] <vcl> graydon: I am just trying to explore current thinking among Rust  devs
[22:00:23] <graydon> sure, np
[22:00:25] <graydon> we could do that
[22:00:38] <graydon> it would take a bunch of different work to untangle and package ld
[22:01:17] <graydon> and for most of _us_ (rustc-developers), we need gcc there anyways to build the other library  bits
[22:01:39] <graydon> I grant it'd be useful for people who wanted to do windows rust development w/o a C compiler
[22:01:45] *** Quits: cowboyd (cowboyd@moz-1BD02A1E.sw.biz.rr.com) (Client exited)
[22:01:53] <graydon> but that scenario hasn't risen to the top of anyone's priority list so far, seemingly
[22:02:20] <lkuper> brson: curious, by "two entire runtimes" in your email on the list earlier, did you mean that both rt and core are complete working runtimes now?
[22:02:39] <vcl> graydon: ok, so there are technical reasons.   what about legal.  I mean, ld is GPL
[22:02:51] <graydon> vcl: wouldn't be a legal problem
[22:03:11] <lkuper> or, uh, s/core/std/
[22:03:13] <graydon> just used in linkage. no connection to the runtime artifacts.
[22:03:25] <brson> lkuper: Yes, there is an entire green thread task scheduler (which accounts for most of 'the runtime') in rt and another in std
[22:03:49] <brson> also some reimplementations of other runtime parts
[22:04:02] <vcl> graydon: ok, so say, if I figured out ld's and rustrt's dependencies, you guys would not mind shipping them with rustc?
[22:04:21] *** Joins: SimonSapin (simon@moz-5E08E9F8.zone5.bethere.co.uk)
[22:04:34] <vcl> ... so as not to require mingw installation to use rust and, more importantly, compiled rust binaries.
[22:04:48] <brson> lkuper: but the one in std isn't quite 'complete and working' yet
[22:04:50] <bblum> pauls: have we ever thought about a "curry!" macro before? i feel like it must have come up
[22:04:52] <rubber-duck> would it be possible to implement a "dummy" rust RT that maps tasks to OS threads and uses native stacks, etc. and have it be transparent to the rust code (aside from performance differences) ? is there some logic that couldn't be mapped 1:1 ?
[22:05:21] <graydon> vcl: I think you'd also need crt0.o and possibly libgcc.o, but maybe.
[22:05:28] <cmr> brson: the one in std is the RUST_NEWRT rt right?
[22:05:31] <bblum> pauls: i'm wondering if such a macro could be smarter than needing to have N*M different versions for N captured arguments and M expected further arguments
[22:05:57] <graydon> vcl: I'd prefer the energy was spent on a dozen other possible things, but I can't choose how you spend your time. that might be a scenario we'd be into. I doubt it'd be permanent.
[22:06:47] <brson> rubber-duck: part of the newsched plan is to make it possible to back tasks by threads and not use the green thread scheduler at all, but it's a long way off. I'm also skeptical that some of the nice abstractions we're going to have in green-thread land will be able to map with perfect fidelity to pthreads
[22:07:03] *** Quits: SimonSapin (simon@moz-5E08E9F8.zone5.bethere.co.uk) (Ping timeout)
[22:07:36] <cmr> brson: *possible*, but not remove greenthreads altogether, right?
[22:07:38] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:07:40] <brson> so in some situations you won't be able to transparently flip back and forth between os scheduling and green thread scheduling
[22:07:44] <brson> cmr: that's right
[22:07:49] <cmr> *whew*
[22:07:51] <brson> cmr: yes, RUST_NEWRT
[22:08:01] *** Joins: SimonSapin (simon@moz-AC44AFD0.threembb.co.uk)
[22:08:05] <graydon> cmr: combination of github API barfing and us ignoring changes that have interrupted status. I fixed the latter. now github just has to answer a full run worth of API queries
[22:08:13] <graydon> which it _really_ has a hard time doing
[22:08:24] <vcl> graydon: I was reviewing issues tagged "A-windows", and this one seemed important (#3459).   It could also lead to fixing other issues caused by incompatible mingw.
[22:08:54] <vcl> graydon: what would be your favorite Windows issue to fix?
[22:08:55] <cmr> vcl: iirc Aetherspawn_BNC was going to try and work on getting rust running under an msvc toolchain
[22:09:51] <brson> vcl: unwinding
[22:10:03] <brson> task failure doesn't work on windows
[22:10:04] <vcl> cmr: AFAIK, link.exe is not redistributable, so I am not sure how that would help in removing external dependencies...
[22:10:10] *** Joins: Ralith (ralith@moz-1D643576.wireless.sfu.ca)
[22:11:08] *** Joins: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de)
[22:11:32] <cmr> vcl: ah
[22:13:13] <MaikKlein> doener, did you had Loviscach in math :) ?
[22:13:18] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[22:13:19] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/tQU9XA
[22:13:19] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[22:13:22] <vcl> brson: ok, I'll see what can be done about unwinding
[22:13:32] <cmr> 8 hours and a handful of minutes later!
[22:14:11] *** Quits: vodik (simon@moz-85CCF3E9.dynamic.uwaterloo.ca) (Ping timeout)
[22:14:47] *** Quits: vk (chatzilla@moz-685BB999.googlewifi.com) (Quit: ChatZilla 0.9.90 [Firefox 22.0/20130617145905])
[22:15:17] <graydon> cmr: maybe kinda sorta
[22:15:29] <graydon> cmr: still trying to fix bors ability to cope with github API flakiness
[22:15:29] <doener> MaikKlein: no, I was at Bielefeld University, not University of Applied Science
[22:15:31] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[22:16:15] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:16:15] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/RAz-wg
[22:16:15] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[22:16:26] <graydon> for anyone who's interested in "making bors smarter", allow me to point out: github API just randomly lies or fails every 100-or-so-calls. so any algorithm you come up with has to handle "eventual consistency" on github's side, or whatever their problem is
[22:17:07] <graydon> also: it has to issue half dozen API calls * number of pulls in the queue
[22:17:14] <graydon> bors does
[22:18:16] *** Joins: lmandel (lmandel@556E85CD.E855F8D7.412CF160.IP)
[22:18:19] *** Quits: vcl (chatzilla@1137E56D.76F9E272.DA40C4B3.IP) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130511120803])
[22:18:24] <bjz_> :(
[22:18:44] <bblum> oh good, in fixing stack closure soundness, another function pops up that wants 1shot stack closures
[22:19:19] *** Joins: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP)
[22:19:19] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/RAz-wg
[22:19:20] *** Parts: ghrust (ghrust@AC22872E.6A2AE50.F3114085.IP) ()
[22:19:28] <bblum> basically something that's trying to do "let f = some_closure; do option.map |val| { foo(f); }"
[22:20:06] *** Joins: mdz1 (mitch@BF257960.A0327521.8FE103B.IP)
[22:20:09] <graydon> erick: ping
[22:20:32] <brendanc> I don't think parallel auto builds would be particularly more affected by github problems than the current system
[22:21:17] <cmr> pub fn int_ty_to_str(t: int_ty) -> ~str {
[22:21:20] <cmr>     match t {
[22:21:22] <cmr>       ty_char => ~"u8", // ???
[22:21:38] *** Quits: echristo (echristo@D423593A.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[22:21:42] <cmr> Can anyone constructively comment on why that... is?
[22:21:46] <graydon> brendanc: are you sure? you need every state transition judgment that the thing can perform to fail safely (i.e. do something that converges to either harmless or improvement) when provided bogus information about the state of the world
[22:22:08] <mdz1> hey guys, is there a webpage or something somewhere that lists rust bindings for various libraries?
[22:22:08] <graydon> cmr: no, I have no idea. need to dig into the logs. which file is that in?
[22:22:18] <cmr> graydon: libsyntax/ast_util.rs
[22:22:25] *** Quits: doomlord (doomlod@moz-6651F8D4.range86-145.btcentralplus.com) (Ping timeout)
[22:22:33] <mdz1> I want to contribute, and I think I could do some by writing up some bindings, but I dont want to duplicate work
[22:22:39] <cmr> mdz1: no, but one of those would probably be helpful in the wiki
[22:22:40] <bblum> cmr: i'm more confused by the line immediately below it!
[22:22:53] <cmr> bblum: hah, I completely missed that one
[22:23:04] <brendanc> haven't done a proof
[22:24:55] <cmr> bblum: that should output "int" I think
[22:24:59] *** Quits: lmandel (lmandel@556E85CD.E855F8D7.412CF160.IP) (Quit: lmandel)
[22:25:01] <cmr> bblum: that's what pprint does
[22:25:09] <graydon> brendanc: sorry, I'm frustrated and feel like sensible integration system is being blamed for lousy codegen in the compiler. anyway, all I mean is it's .. been remarkably hard to get bors to be harmless-when-lied-to and I'm very nervous embarking on a great expansion of its logic.
[22:25:36] <brendanc> I think bors is great!
[22:25:50] <cmr> graydon: all I want to see is bors stop processing the queue when master turns red, which seems perfectly sensible :p
[22:25:53] <brendanc> it would be neat if it could do things in parallel
[22:26:16] <brendanc> so that any queue problem could be trivially solved by throwing more hardware at it
[22:26:34] <graydon> cycle time is cycle time
[22:26:48] <graydon> people still wait for the 1h cycle time regularly, one way or another
[22:27:05] <brendanc> would be nice to make the queue delay O(1) instead of O(n) :)
[22:27:14] <brendanc> even if the constant is 1 or 2 hours
[22:27:37] *** Quits: roo (Mibbit@moz-97A935F1.dynamic.ip.windstream.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:27:43] <graydon> yes it'll help with the queue but I just .. again, I feel like I'm the only person who finds "2h of build" outrageous, but it _is_ outrageous. we all have workspace cycle time problems. newcomers are put off. etc. etc.
[22:28:10] <graydon> https://gist.github.com/graydon/72791a0f7cb3efdcc614 <-- time spent in trans
[22:28:12] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[22:28:12] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14bfaa305 to 14544f615: 02http://git.io/N3iJvQ
[22:28:12] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[22:28:13] <graydon> does this look right?
[22:28:15] *** Joins: ghrust (ghrust@C621748.6A2AE50.F3114085.IP)
[22:28:15] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/LVz0OQ
[22:28:15] <ghrust> 13rust/06auto 1491fbdac 15Philipp BrÃ¼schweiler: Fix take glue of owned trait objects...
[22:28:15] <ghrust> 13rust/06auto 1430ac7c6 15bors: auto merge of #7214 : Blei/rust/fix-owned-traits, r=brson...
[22:28:15] *** Parts: ghrust (ghrust@C621748.6A2AE50.F3114085.IP) ()
[22:28:21] <brendanc> I take an interest in the bors part because I don't have any ability to work on the build time :)
[22:28:32] <graydon> almost every easy measurement you can make of rustc behavior shows off-the-charts pathological wrongness
[22:28:39] *** Quits: tikue (tkuehn@2557E599.66715431.D25A875A.IP) (Quit: tikue)
[22:28:57] <graydon> brendanc: ok, sorry. this is, I guess, just reminiscent of a lot of conversations I've had over the past couple years
[22:29:02] <graydon> wherein we sweep away technical debt
[22:29:16] <graydon> I know it's not your fault nor what you're suggesting
[22:29:21] <graydon> trying to take it in stride
[22:29:26] <doener> graydon: what unit are those numbers in?
[22:29:38] <doener> ms?
[22:29:38] *** Quits: ion (ion@heh.fi) (Ping timeout)
[22:29:40] <engla> developer cycle time is even more important than bors cycle time of course
[22:30:13] <graydon> doener: ms, yes
[22:30:20] *** Quits: SimonSapin (simon@moz-AC44AFD0.threembb.co.uk) (Ping timeout)
[22:30:21] <cmr> engla: well they're often related, especially when you have breaking changes or big refactors queued up
[22:30:27] <graydon> but as a proxy for "where are we generating code"
[22:30:45] <graydon> (nobody's done function-by-function instruction measurement yet, I'm doing that next)
[22:31:09] <brendanc> shorter cycle time -> more pull requests -> pending queue stays long
[22:31:31] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[22:31:44] <brendanc> but I will drop the subject unless I happen to get a chance to hack up bors to try my idea
[22:32:06] <doener> still, more stuff gets done in the same time, higher throughput, same latency
[22:32:20] <graydon> it's fair. I'm sorry I'm testy today. waiting hours to see improvements land annoys me too.
[22:33:43] *** Joins: roo (Mibbit@moz-97A935F1.dynamic.ip.windstream.net)
[22:34:08] <graydon> brendan: sorry
[22:34:11] *** Joins: tikue (tkuehn@2557E599.66715431.D25A875A.IP)
[22:34:15] <brendanc> no problem, I understand
[22:34:25] <brendanc> If I had the time and the chops I'd work on cycle time :)
[22:35:05] *** Joins: ion (ion@heh.fi)
[22:35:59] <cmr> graydon: bblum: afaict the only place that function (int_ty_to_str) is used is during printing of *error messages*, but I don't even know what cases that happens in: you'd think someone would notice if they saw an error with a u8 instead of char, or *nothing* instead of int
[22:36:16] <cmr> Is there any instrumentation (even hacky or slow) for finding dead code?
[22:36:16] <bblum> well a u8 is a char
[22:36:20] <graydon> no it's noto
[22:36:23] <graydon> not
[22:36:28] <graydon> chars are u32
[22:36:28] <cmr> bblum: no, char is a 32bit unicode codepoint
[22:36:31] <bblum> oh yeah, right
[22:37:57] <cmr> Some of this code is blatently wrong
[22:40:39] <brson> vcl: unwinding is a hairy topic. graydon had a patch for this a few months ago that implemented a custom unwinding scheme
[22:41:06] <graydon> it's still in a branch. it's pretty easy to (re)implement even after all the drift
[22:41:12] <graydon> it's just not entirely cheap
[22:41:17] <graydon> (but then, neither are landing pads)
[22:41:28] <brson> imo we should maintain two strategies
[22:41:46] * brson fond of dwarf
[22:42:43] <bblum> fun_treemap
[22:42:48] <bblum> why don't we have a boring_treemap
[22:43:06] *** kimundi is now known as zz_kimundi
[22:43:33] <engla> the implication is clear, the present treemap is boring
[22:47:56] <graydon> brson: there's a more-elaborate 3rd strategy I was always kinda fond of trying too, which is SEH-like: sj-lj plus an easily-found cleanup-list argument threaded through the frames.
[22:48:03] <mblbruce> I don't know the first thing about your code base or build setup, but I can definitely empathize with the pain of long turnaround time for builds and regression testing. Some guys where I work spent some quality time with Jenkins and got us down to incremental builds of 10-15 minutes. It really changes things, getting the waiting times down to where you can keep your mental context.
[22:48:22] <sully> hm, have we put any thought into how to handle internationalization in rust programs?
[22:48:35] <graydon> sully: yes. but it's not collected in one place.
[22:48:51] <graydon> sully: fmt!()-variant-for-message-catalogs more or less
[22:49:08] <sully> one of my triage bugs (https://github.com/mozilla/rust/issues/4630) is asking about internationalization
[22:49:09] <graydon> it hinges somewhat on how much we want to adopt ICU. which is still a discussion to have. sadly.
[22:49:20] <sully> ICU?
[22:49:35] <graydon> libicu, the unicode library
[22:49:44] <graydon> which also has a fancy message catalog system
[22:49:49] <graydon> which we'd either be binding to or copying
[22:50:38] <sully> ok
[22:50:47] <sully> is there anything to put a link to in the bug?
[22:50:58] <graydon> sec
[22:51:19] *** Joins: jjr (jeffrey@moz-2A1ACF92.cpe.cableone.net)
[22:51:23] <sp3d> i.e. icu for rustc, not rust?
[22:51:53] *** Quits: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de) (Ping timeout)
[22:52:02] <graydon> sully: https://mail.mozilla.org/pipermail/rust-dev/2013-May/003999.html and https://github.com/Aatch/rust-fmt
[22:52:26] <graydon> sully: if you'd be so kind as to collect that and every other bug on fmt! into a cluster hanging on to some metabug
[22:52:27] <sully> ok, thanks
[22:52:37] <graydon> (if there's a most-appropriate central bug, do that, else open a new one)
[22:52:41] <graydon> we need to redo fmt!
[22:53:11] <graydon> aatch and dbaupp (huon) were both interested / hacking on it
[22:53:16] <graydon> don't know how far they got
[22:53:19] <sully> ok, also, the milestone is marked as #2, which seems wrong
[22:53:31] <graydon> I think it's right. it'll break a ton of code when we redo fmt!
[22:53:45] *** Quits: Ralith (ralith@moz-1D643576.wireless.sfu.ca) (Ping timeout)
[22:53:52] <sully> oh, we are changing fmt itself in a non backward compatible way?
[22:54:02] <graydon> quite possibly
[22:54:17] <graydon> currently it produces a ~str, which is .. a very undesirable interface
[22:54:28] <sully> what should it produce, though?
[22:55:02] <graydon> not sure. some sort of integration with an io::Writer
[22:55:46] <graydon> (i.e. not "produce" a value in its simplest form at all. maybe the resulting fmt! macro winds up being a variant that feeds a string writer and then returns the string..)
[22:55:54] * sully nod
[22:56:11] *** Quits: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP) (Ping timeout)
[22:56:16] <sully> yeah, I think it is important to have the case of "and then give me the string" be convenient
[22:56:27] <sully> but being able to not build an allocated string when you don't want to is also important
[22:56:44] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[22:56:51] <brson> there is also a lot of interest in redesigning the way format specifiers work
[22:57:08] <brson> printf is old
[22:57:28] *** Quits: mleise (marco@moz-3468AB5B.pools.arcor-ip.net) (Quit: Leaving.)
[22:57:41] <graydon> also link in https://github.com/mozilla/rust/wiki/Lib-fmt
[22:57:57] <graydon> I linked the main other-PL formatter systems in there
[22:58:57] <sully> I could use https://github.com/mozilla/rust/issues/3571 as the meta bug, if I drop the "for performance" from the title
[22:59:21] <sully> ok, what is the best way to link the bugs together
[22:59:24] <graydon> yeah
[22:59:31] <sully> I can just mention all of the other bugs in a comment on the metabug
[22:59:31] <graydon> you just mention them in one another's comments
[22:59:35] <graydon> "see also #1234"
[22:59:36] *** Joins: Earnestly (earnest@6A917A59.5E1FD793.39C00A7A.IP)
[22:59:42] <graydon> it makes the back-link automatically
[22:59:42] <sully> or I can reference the metabug in each of the bugs
[22:59:49] <graydon> usually we make the link from meta -> sub
[22:59:58] <graydon> so that they can be crossed-off in the meta while it's worked-on
[23:00:10] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[23:00:15] <graydon> but github will automatically comment in the sub-bugs when they get mentioned elsewhere
[23:00:41] <graydon> examples: https://github.com/mozilla/rust/issues/4707
[23:00:53] *** Quits: mschifer (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[23:00:58] <graydon> https://github.com/mozilla/rust/issues/4419
[23:01:00] <graydon> etc.
[23:01:50] *** Quits: eholk (eholk@moz-61CBCD5E.uconnect.utah.edu) (Quit: eholk)
[23:03:40] <rubber-duck> what am I missing here : https://gist.github.com/rubber-duck/5834958 :|
[23:04:09] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Ping timeout)
[23:04:13] <bblum> who's responsible for the iterbytes deriving implementation? i will have some questions for such a person shortly
[23:04:13] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[23:04:13] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1430ac7c6 to 14544f615: 02http://git.io/N3iJvQ
[23:04:14] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:04:16] *** Joins: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP)
[23:04:16] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/_dbBkQ
[23:04:16] <ghrust> 13rust/06auto 14b8efa2e 15Steven Stewart-Gallus: Cleanup src/librustc/back
[23:04:16] <ghrust> 13rust/06auto 14f886520 15bors: auto merge of #7219 : sstewartgallus/rust/cleanup, r=graydon
[23:04:16] *** Parts: ghrust (ghrust@E7A4CCE2.6A2AE50.F3114085.IP) ()
[23:04:20] <rubber-duck> shouldn't foo.bar move in to -> append_one and then new value get moved back to it
[23:05:23] <graydon> rubber-duck: no, we don't support moving-out of structures that way
[23:05:35] <graydon> rubber-duck: move-out happens on local variables
[23:06:38] <rubber-duck> graydon, so you can't move a owned pointer out of a structure ? I guess it makes sense otherwise you couldn't guarantee owned member lifetime is same as struct lifetime so internal refs wouldn't work
[23:07:27] <graydon> yeah
[23:07:38] <sully> oh, actually, I think https://github.com/mozilla/rust/issues/2249 makes a better metabug for fmt!
[23:07:38] <graydon> you can move out of a structure by destructuring it
[23:07:47] <graydon> in an irrefutable binding
[23:08:08] <graydon> like "let Foo { bar } = ... "
[23:08:18] <graydon> this will move the value out
[23:08:35] <mblbruce> In what situations are option preferable to result? The latter looks like the former on steroids.
[23:08:38] <graydon> and I think that _might_ happen automatically if you use foo.bar as the final expression in a block that owns foo
[23:09:17] <graydon> sully: mhm! thanks btw, handling this tangle of bugs is on my list
[23:10:14] *** Joins: Ralith (ralith@moz-1D643576.wireless.sfu.ca)
[23:10:44] <rubber-duck> graydon, it turns out that I was looking at wrong function anyway - foo.bar.push(1) does what I want :)
[23:10:57] <bblum> who's huon wilson
[23:11:02] <graydon> dbaupp
[23:11:14] <bblum> shoot, not in channel
[23:11:35] *** Quits: cr (anonymous@moz-32725F28.dip0.t-ipconnect.de) (Ping timeout)
[23:11:41] <bblum> i need to get my fingers dirty in the iterbytes deriving implementation
[23:13:17] <bblum> anyone else around who knows deriving internals?
[23:13:22] <acrichto> bblum: I was modifying that stuff recently, so I may be able to provide a little help at least
[23:13:48] <bblum> acrichto: alright, so, i'm trying to make stack closures noncopyable unless they have a :Copy bound
[23:14:09] <bblum> acrichto: in the case of patterns like IterBytes, where you go "a.iter_byes(f) && b.iter_bytes(f)",
[23:14:29] <acrichto> ah that could cause problems...
[23:14:38] <bblum> that would be illegal, so you're gonna need to write "a.iter_bytes(|x| f(x)) && ..."
[23:14:53] <bblum> now i just need to figure out how to make the deriving implementation emit this
[23:15:15] <bblum> but i am worried, since it's built on this generic structure traversal code and i'm not sure if i can make it emit that in the specific case i want
[23:15:25] <acrichto> bblum: you just want to change https://github.com/mozilla/rust/blob/master/src/libsyntax/ext/deriving/iter_bytes.rs#L53
[23:15:37] <acrichto> you can check what you're emitting via `rustc --pretty expanded`
[23:15:46] <sully> ok, https://github.com/mozilla/rust/issues/2249#issuecomment-19845650
[23:15:54] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[23:16:00] <bblum> acrichto: oh, i see, hmm
[23:16:13] <bblum> just replace copy lsb0_f
[23:16:20] <acrichto> bblum: where it says `copy lsb0_f`, you'll have to regenerate the second argument `f`, src/libsyntax/ext/build.rs has a lot of useful things
[23:16:26] <bblum> good, i am glad that wasn't buried in the generic code
[23:16:37] <acrichto> bblum: I poked around the other deriving implementations to get a good idea on how to build stuff
[23:17:12] *** Quits: brendan (brendaneic@6CE790D5.927818F1.82490606.IP) (Quit: brendan)
[23:17:12] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[23:19:45] <bblum> acrichto: do you know the difference between all these lambda forms
[23:20:00] <acrichto> bblum: take a look at deriving/encodable.rs
[23:20:05] <bblum> we got fn lambda{,_expr,_stmts}{,_0,_1}
[23:20:09] <acrichto> bblum: I built up a lot of lambdas there
[23:20:13] <bblum> thanks
[23:20:23] <acrichto> bblum: they're all just sugar around the same thing, the only difference is what arguments they take
[23:20:29] <acrichto> the return value should all be the same
[23:20:37] <rubber-duck> I feel like unique_ptr - owned ptr analogy is very misleading because of move/mutability semantics
[23:22:13] *** Joins: eholk (eholk@moz-61CBCD5E.uconnect.utah.edu)
[23:23:24] *** Parts: mdz1 (mitch@BF257960.A0327521.8FE103B.IP) (WeeChat 0.4.1)
[23:23:57] *** Parts: mblbruce (mblbruce@moz-D00392B8.fagotten.org) ()
[23:23:59] <cmr> Btw, if anyone was curious, I was still experimenting with alternate compression for metadata but I kind of gave up because it is dwarfed by other things which are much worse off.
[23:25:12] <cmr> Also my DSL router is very flakey, so I'll be in-and-out
[23:29:05] *** Joins: echristo_ (echristo@60A74940.D6CCE4AE.77834EAA.IP)
[23:29:16] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Ping timeout)
[23:29:16] *** echristo_ is now known as echristo
[23:29:48] <cmr> graydon: btw, the libstatgrab people are still discussing a possible relicense/license exception for inclusion into rust's runtime
[23:30:13] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[23:31:19] <graydon> cmr: oh nice
[23:31:55] <cmr> graydon: they didn't actually realise that the LGPL required replacement, they picked it because they thought it was a very liberal license
[23:32:00] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[23:32:11] <graydon> yeah, it's a little known quirk
[23:37:46] *** Joins: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de)
[23:38:56] *** Joins: jeltz (andreas@moz-7C6B0B72.tn.glocalnet.net)
[23:42:56] *** Quits: MaikKlein (maik@moz-4F2BCF6C.dip0.t-ipconnect.de) (Ping timeout)
[23:44:43] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[23:44:45] <cmr> 7e4cd09e src/libsyntax/ast.rs     (John Clements             2013-04-03 10:28:14 -0700 1137) /* hold off on tests ... they appear in a later merge.
[23:45:10] <cmr> It's been a while...
[23:45:15] <bblum> acrichto: i'm getting kind of lost here
[23:45:45] <acrichto> bblum: how so?
[23:46:08] <bblum> having trouble figuring out which of each lambda function does what because even though i can look at your code i don't have a notion of what your code is trying to do
[23:46:13] <bblum> so i can't backsolve for what they are
[23:46:37] *** Joins: pyrac (pyrac@moz-9180E00E.w86-201.abo.wanadoo.fr)
[23:46:59] <bblum> oh wait hmm
[23:47:10] <acrichto> did you run --pretty expanded for a #[deriving(Encodable)] ?
[23:47:20] <acrichto> that'll at least give you an idea of what's being generated
[23:47:30] <bblum> oh, i didn't try that yet, yeah
[23:49:19] *** Quits: pyrac (pyrac@moz-9180E00E.w86-201.abo.wanadoo.fr) (Quit: pyrac)
[23:50:56] *** Quits: rubber-duck (rubber-duc@moz-9BB75FBE.dsl.iskon.hr) (Quit: Leaving)
[23:51:20] <brson> somebody needs to publish an article explaining very simply how semicolons interact with block expressions. the internet is hysterical thinking it's very complex when in practice it's nbd. unfortunately, I still don't actually understand what the rules are
[23:52:07] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[23:52:12] <brson> but, the person who publishes that article should be very careful to make sure it's accurate. don't need to spread more disinformation
[23:53:19] <tikue> the only semi-strange part, imo, is that blocks which would return () don't need a semicolon to prevent returning
[23:54:57] <SiegeLord> Well, if you don't know, then it means it /is/ complicated :P
[23:55:07] <cmr> I was thinking the same thing...
[23:55:24] <tikue> SiegeLord: he said in practice it's nbd, which doesn't necessitate fully comprehending the rules in theory
[23:55:28] <cmr> I've never run into any problems with it, though
[23:55:33] <cmr> It always works just like I expect it to
[23:55:36] <SiegeLord> I don't think that's a valid argument
[23:55:47] <tikue> SiegeLord: it's not an argument, it's simply a statement of truth
[23:56:08] <tikue> SiegeLord: unless you disagree that something can be intuitively easy even if you don't quite understand all the exact details?
[23:56:43] <tikue> SiegeLord: i.e. the rules are complex, but the application of those rules is generally not complex
[23:56:53] <SiegeLord> None of that makes sense to me
[23:58:13] <tikue> SiegeLord: let me put it this way. I've never encountered a situation where I thought, "gee, I really have no idea what to do about these semicolons." At the same time, I'm positive I don't know all of the rules 
[23:58:29] <SiegeLord> I've had the opposite experience
[23:58:44] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[23:58:56] <SiegeLord> The rule that that lwn article suggested was a complete surprise to me
[23:59:00] <cmr> SiegeLord: so what are the rules?
[23:59:09] <SiegeLord> I don't know them either
[23:59:19] <SiegeLord> I use semicolons and hope I don't get a bug
[23:59:23] <Eridius> which lwn article?
[23:59:27] <SiegeLord> I don't know whether or not I am using them properly
[23:59:39] <Eridius> oh huh, there's a new lwn article on rust
[23:59:57] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
