[00:00:05] <graydon> (they have no comments, so no point wasting space)
[00:00:07] *** Quits: echristo (echristo@CFC3C6C3.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[00:00:20] <graydon> it also elides comments that are just "r+"
[00:00:21] *** Joins: joshua_ (joshua@moz-45967CBE.emarhavil.com)
[00:01:06] <aatch> graydon, that reminds me, who is and isn't allowed to approve pull requests?
[00:01:59] <graydon> um, a random set of people wired into bors' local configuration
[00:02:37] <aatch> graydon, cool.
[00:02:50] <pcwalton> ooh, the compiler tells you how to turn off warnings like clang does
[00:03:07] <aatch> pcwalton, landed today(?)
[00:03:10] <graydon> I think everyone in the rust and rust-push groups? or less? or more? I don't remember the exact mapping. I think it was like "anyone in those groups who actually _wanted_ to review things"
[00:03:20] <nmatsakis> graydon: I am inlined to agree with tjc that UNREVIEWED should come before DISCUSSING (but in general, very nice)
[00:03:45] <aatch> graydon, just curious because I wasn't sure if I'm allowed to approve pull requests
[00:03:55] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[00:03:59] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[00:04:08] *** Quits: Jesse (jruderman@moz-C03D0C61.vlan426.asr1.sfo1.gblx.net) (Quit: Jesse)
[00:04:31] <nmatsakis> graydon: what is considered "DISCUSSING"? Anything with comments at all?
[00:04:44] <graydon> nmatsakis: with-comments and not otherwise classified
[00:04:53] <graydon> (as approved, stale, bad, etc.)
[00:05:30] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[00:05:32] <graydon> aatch: sec, I'll check
[00:06:26] <graydon> ok, moved UNREVIEWED up
[00:07:01] <graydon> aatch: no, looks like it's a shorter list.
[00:07:01] <aatch> I'm not bothered either way, but I'm often on when very few other devs are and people still ask for the pulls to be approved
[00:07:07] <aatch> Ah, ok
[00:07:10] <aatch> nevermind then.
[00:07:24] <Jeaye> Damn, there's a new ICE for me on incoming.
[00:07:48] <graydon> aatch: probably an oversight. you have direct push access. I'll add you.
[00:08:31] <aatch> graydon, thanks. I'll probably stick to trivial requests anyway.
[00:09:42] *** Joins: blitter (blitter@moz-7C98731E.dyn.centurytel.net)
[00:10:45] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[00:10:45] *** ChanServ sets mode: +o dherman
[00:11:22] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[00:11:30] <mdu> pcwalton, so I'm recompiling rustc to check if the error message changes as expected. What should I do next ? I was thinking of running tests and filing a pull request
[00:11:41] <pcwalton> mdu: I would add a compile-fail test
[00:11:49] <pcwalton> see some of the compile-fail tests for examples of how the format works
[00:12:04] <mdu> yeah, i've looked at some of them
[00:12:12] <pcwalton> you can run the entire test suite if you like (they take a while and will be automatically run so you don't have to)
[00:12:17] <pcwalton> and then file a PR
[00:13:01] <mdu> ok, nice
[00:13:07] <mdu> about the compile-fail tests
[00:13:17] <strcat> rusti: extern { foo }
[00:13:18] <rusti> error: internal compiler error: unexpected failure
[00:13:18] <rusti> note: the compiler hit an unexpected failure path. this is a bug
[00:13:18] <rusti> note: try running with RUST_LOG=rustc=1,::rt::backtrace to get further details and report the results to github.com/mozilla/rust/issues
[00:13:19] <mdu> is there a computer-readable pattern in comments like //error-pattern: unreachable
[00:13:31] <mdu> ?
[00:13:40] <strcat> mdu: yes
[00:13:41] <pcwalton> mdu: that's the old pattern, I would suggest using //~ ERROR error message here
[00:13:43] <pcwalton> on the line
[00:13:46] <mdu> ah, ok
[00:14:07] <aatch> I find adding stage-protected features annoying. Gotta wait for the entire compiler to get through stage0, then stage1
[00:14:29] <strcat> https://github.com/mozilla/rust/issues/6342 oh
[00:15:54] <mdu> strcat: that's what I'm working on :)
[00:19:55] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Quit: Leaving.)
[00:22:46] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:23:45] *** Joins: thelivingded (thelivingd@moz-9453CC48.austin.res.rr.com)
[00:23:54] *** Quits: jclements (jclements@2557E599.66715431.D25A875A.IP) (Quit: jclements)
[00:23:55] *** Quits: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net) (Quit: This computer has gone to sleep)
[00:26:46] *** Quits: an0nymous (an0nymous@moz-A6B0CE4.tx.res.rr.com) (Input/output error)
[00:28:28] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[00:28:34] <steven_is_false> I know there is size_of::<T>() for getting the size of a type T. Is there a similar thing for getting the name of a type?
[00:28:49] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[00:29:05] *** Quits: KindOne (KindOne@moz-1436D8AE.dynamic.ip.windstream.net) (Ping timeout)
[00:29:08] <aatch> steven_is_false, reflection is the only way as far as I know
[00:29:11] <pcwalton> steven_is_false: no
[00:29:42] <aatch> (Actually, do you even get the name that way?)
[00:30:25] <ssbr> not reflection either, the other one, uhhhh, the type walker thing
[00:30:28] <ssbr> in intrinsics
[00:30:28] <steven_is_false> I was thinking of making a trait Introspectable, and using size_of, and the hypothesized type_name function to implement the Any type talked about in this issue https://github.com/mozilla/rust/pull/6348
[00:32:18] <geomyidae__> whats the latest on io and net/http work?
[00:32:58] <tjc> steven_is_false: wouldn't that duplicate what the visitor code already does?
[00:33:14] <tjc> ssbr: I think you mean the visitor
[00:33:31] <ssbr> Probably. Grk.
[00:33:37] <steven_is_false> tjc: I guess.
[00:33:43] *** Joins: KindOne (KindOne@moz-81777182.dynamic.ip.windstream.net)
[00:33:46] <aatch> tjc, doesn't the visitor work on the ast?
[00:33:48] <ssbr> I honestly should've just opened the intrinsics code to look for what I wanted to say, rather than spitting out gibberish.
[00:33:58] <steven_is_false> tjc: The reflection stuff seems kind of messy.
[00:34:08] <ssbr> aatch: shouldn't; the reflection stuff is implemented in terms of it
[00:34:11] <steven_is_false> tjc: I just need something simple, and not complicated.
[00:34:33] <tjc> aatch: hmm, maybeâ€¦ I thought it visited types too, but I could be wrong
[00:34:36] *** Joins: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com)
[00:35:36] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[00:36:16] <Thad> brson: Hi Brian, well my build didn't work out completely with new updates... LLVM-config causes an error.  Using 4.7.2 ... do you think I should spend time trying to find the issue within Rust's build system for it ? or is there something else I should try ?
[00:36:37] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:37:02] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[00:38:29] <strcat> tjc: I think it just visits the built-ins
[00:40:46] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[00:44:53] <brson> Thad: what is it that you updated and what's at version 4.7.2? what error are you seeing?
[00:45:14] <Thad> LLVM-config causes a fatal exception in Windows 7
[00:45:27] <Thad> during Rust building against i686-pc-mingw32
[00:46:01] *** Joins: bEcker (Thunderbir@moz-90785708.resnet.ucsc.edu)
[00:46:07] <Thad> Does the Rust build "download" LLVM and then compile it ?
[00:46:20] <Thad> if so, then I think I know where the problem is at.
[00:46:31] <brson> Thad: it does, as a git submodule
[00:46:33] <aatch> Thad, it checks out the git submodule
[00:46:54] <Thad> Ah... that's the problem then... OK... I'll remove my manual build of LLVM and delete the symlink.
[00:47:07] <Thad> and then try to build again... ok, thanks !
[00:47:32] <cmr> Thad: I admire your dedication :)
[00:47:42] <Thad> cmr: lolol...
[00:48:25] <Thad> cmr: at least the community helped fix the Libuv issues that have been bugging everyone on Windows side.
[00:48:45] <Thad> thanks for everyone's dedication, I guess.
[00:48:54] <steven_is_false> How do I unsafely increment a pointer by a few bytes?
[00:48:55] *** Joins: mschifer1 (Adium@moz-C03D0C61.vlan426.asr1.sfo1.gblx.net)
[00:48:57] *** Quits: mschifer (Adium@moz-BE33DA21.fw1.sfo1.mozilla.net) (Connection reset by peer)
[00:49:02] <strcat> ptr::offset
[00:49:18] <steven_is_false> strcat: Thank you.
[00:49:53] <aatch> There is also ptr::mut_offset (I think)
[00:50:30] *** Quits: bnicholson (bnicholson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[00:51:48] *** Quits: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP) (Quit: Leaving.)
[00:51:56] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[00:51:56] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145b0cb01 to 14f547a67: 02http://git.io/N3iJvQ
[00:51:56] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[00:51:57] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[00:51:57] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/Tk193w
[00:51:57] <ghrust> 13rust/06auto 14dc2ca9d 15Niko Matsakis: Refactor representation of bounds to separate out BuiltinBounds into...
[00:51:57] <ghrust> 13rust/06auto 147852086 15Niko Matsakis: rustc: Add EnumSet tests
[00:51:57] <ghrust> 13rust/06auto 14ad8e236 15bors: auto merge of #6336 : nikomatsakis/rust/issue-6308-closure-bounds, r=nikomatsakis...
[00:51:58] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[00:53:17] <steven_is_false> So if I call to_str on a &T I'd get the string representing the type T. How do I get a string representing the pointer data?
[00:53:31] *** Quits: jorendorff (jorendorff@moz-30F4FB9E.hfc.comcastbusiness.net) (Quit: jorendorff)
[00:54:06] *** Quits: drguildo (drguildo@moz-D4255ABE.drguildo.com) (Quit: Leaving)
[00:54:26] <strcat> steven_is_false: you mean the address?
[00:54:38] <steven_is_false> strcat: Yes, but I think I figured it out.
[00:54:47] <steven_is_false> I should just do to_uint then print that out
[00:54:53] <strcat> yeah
[00:57:13] *** Quits: mschifer1 (Adium@moz-C03D0C61.vlan426.asr1.sfo1.gblx.net) (Quit: Leaving.)
[00:57:59] <steven_is_false> So how would I get the name of a type using reflection?
[01:01:14] <aatch> steven_is_false, I'm not sure if you can at runtime.
[01:01:33] <aatch> I could be wrong though.
[01:01:49] <steven_is_false> aatch: Fair enough.
[01:01:51] <cmr> how could you, at runtime?
[01:02:08] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[01:02:15] <aatch> cmr, well a lot of the type data is stored in the binary
[01:02:24] <aatch> similar to C++ rtti
[01:02:27] <aatch> (I think)
[01:02:50] <steven_is_false> cmr: I'm working on something, and it shows the general idea. Let me get a link setup.
[01:03:28] <strcat> aatch: only if it works on objects.
[01:03:34] <strcat> otherwise it's just compile-time reflection
[01:03:41] <strcat> (and by objects I mean trait objects
[01:04:01] *** Joins: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net)
[01:04:03] *** Quits: tjc (tjc@A5087023.2354C43D.D8E68FF6.IP) (Quit: Places to go, people to annoy)
[01:04:22] <steven_is_false> I thought trait objects only had a vtable?
[01:04:43] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[01:04:46] <strcat> steven_is_false: yes so it doesn't know what the type of the object is at compile-time
[01:04:50] <strcat> it does everywhere else
[01:04:58] <strcat> trait objects have a ptr to the object and a ptr to the vtable
[01:05:04] <strcat> it needs the object or it can't do anything
[01:05:23] <cmr> I could see the vtable also storing an index into some type-informatino table that's in a ro segment or something
[01:05:24] <steven_is_false> But suppose there was a trait object giving such info https://gist.github.com/sstewartgallus/5551770 ?
[01:06:10] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[01:07:33] <steven_is_false> This is the little thing I was working on that needed the type name.
[01:07:39] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[01:08:11] *** Joins: int3_ (int3_@89E728B9.C181C765.20F9FC3E.IP)
[01:08:14] <Thad> aatch:  damn... that's not it.. .still crashing LLVM-CONFIG.exe during build..right here -> http://pastebin.mozilla.org/2389219
[01:09:17] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[01:09:59] <aatch> Thad, that doesn't look like a rust issue
[01:10:11] <Thad> hmm.
[01:10:19] <cmr> Thad: According to http://llvm.org/docs/GettingStarted.html only gcc 4.5.x is supported on mingw?
[01:10:24] <steven_is_false> Now as well as having the type name I might also want to get any pointers to subdata. Anyways does anyone think this sort of thing would be useful?
[01:10:30] <Thad> cmr: SERIOUSLY ?
[01:10:58] <cmr> it says for x64, but you're using i686
[01:11:14] <aatch> steven_is_false, a lot of the repr stuff does that.
[01:11:41] <steven_is_false> aatch: Okay, but again I just wanted something simpler.
[01:11:48] <Thad> yeah, it used to compile with i686 on this machine...hmm.. but now I'm wondering if that was always with 4.5.x
[01:11:57] <aatch> steven_is_false, I mean using it as a starting point
[01:12:37] <Thad> cmr: ooo... mingw pulled down 4.7.2 automatically when I did a mingw-get update... AH !
[01:12:42] <steven_is_false> aatch: It probable is the right way to do this sort of thing.
[01:13:03] <cmr> I wonder why they need the older gcc
[01:13:31] <steven_is_false> I still wish I could get the type name. Still even without that there is a lot I could do.
[01:13:39] *** Quits: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP) (Ping timeout)
[01:13:42] <geomyidae__> Hi, how is the new scheduler/io/net stuff going?
[01:13:57] <aatch> geomyidae__, ask brson
[01:14:01] <engla> steven_is_false: shouldn't the type name be available statically? From T.
[01:14:20] <aatch> engla, doesn't mean you can get at it.
[01:14:38] <steven_is_false> engla: It should but apparently there is no such thing as sys::type_name () to complement sys::size_of::<T>
[01:14:50] <cmr> steven_is_false: there should be, I think
[01:15:06] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.0)
[01:15:07] <steven_is_false> engla: I have no idea how hard it'd be to create a type_name template function.
[01:15:07] <aatch> It also doesn't mean that the data isn't available.
[01:15:16] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:15:41] <steven_is_false> aatch: It doesn't seem like the repr or the reflect module exposes it.
[01:15:44] <geomyidae__> last updated 16 mins ago, no less: https://github.com/brson/rust-sched-bench
[01:16:32] <engla> aatch: I agree with you :)
[01:17:12] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:17:38] <geomyidae__> god that go syntax is so much cleaner :P
[01:18:29] *** Joins: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[01:19:34] <cmr> except some boilerplate that I'm not convinced is necessary, the're almost identical!
[01:19:46] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[01:20:02] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Input/output error)
[01:20:49] <aatch> I'm not convinced that syntax is necessary at all. Just look at LISP
[01:21:01] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[01:21:43] <engla> rust has nice syntax for creating the vector and the loop.. but the type noise is much larger of course
[01:21:43] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[01:22:03] *** Quits: inolen (Adium@moz-9F4F17DF.tourcaster.com) (Quit: Leaving.)
[01:22:03] *** Quits: mdu (mdu@moz-9962C9F4.rev.numericable.fr) (Quit: mdu)
[01:22:48] *** Parts: bEcker (Thunderbir@moz-90785708.resnet.ucsc.edu) ()
[01:23:14] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:23:42] <SiegeLord> The two programs do slightly different things, so it's meaningless to compare them as a whole
[01:24:17] <SiegeLord> E.g. if you stuck the statics inside main like they are in Go, you'd lose the type annotations
[01:24:43] <steven_is_false> So I have to implement Repr for all my types to use write_repr on them?
[01:25:54] <aatch> steven_is_false, it's automatically implemented
[01:25:59] <aatch> (as far as I know)
[01:26:33] <aatch> But repr is used for generating the output of "%?"
[01:26:35] <steven_is_false> aatch: It doesn't appear to be.
[01:26:59] <steven_is_false> Failed to find an implemention of trait &core::repr::Repr for MyStruct
[01:27:43] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[01:27:47] *** Quits: HOLYCOWBATMAN (Mibbit@moz-AB722A1C.mc.videotron.ca) (Quit: http://www.mibbit.com ajax IRC Client)
[01:29:43] <pcwalton> the rtdebug macro is the ugly part
[01:30:02] <pcwalton> also there are some unnecessary semicolons
[01:30:03] <aatch> steven_is_false, you can call ::repr::write_repr() on anything
[01:30:56] <steven_is_false>  aatch Got it working.
[01:32:34] <brson> geomyidae__: what don't you like about the rust version?
[01:32:48] <geomyidae__> after looking at it more, nothing really I guess
[01:32:59] <pcwalton> here's what it should look like https://gist.github.com/pcwalton/5551839
[01:33:04] <pcwalton> once all the boilerplate is gone
[01:33:05] <steven_is_false> It very slightly annoys me that it has the field names but not the type names. Is this a holdover from when Rust didn't have nominal structs?
[01:33:14] <geomyidae__> probably familiarity bias. 
[01:34:12] <pcwalton> vec::from_fn is so common that maybe it should be in the prelude and should just be called make_vec
[01:34:22] <pcwalton> make_vector
[01:34:24] <pcwalton> or something like that
[01:34:42] <pcwalton> heck, we could even make Go's make() directly with typeclasses
[01:35:15] <geomyidae__> brson: is that 'rt' in trunk or do I need a special branch or something if I wanted to poke around docs for it?
[01:35:50] *** Quits: int3_ (int3_@89E728B9.C181C765.20F9FC3E.IP) (Client exited)
[01:35:51] <brson> geomyidae__: i would use my io branch. it's usually a week or two ahead of incoming https://github.com/brson/rest/tree/io
[01:36:09] <brson> SiegeLord: do you think the differences between the Rust and Go versions have a perf impact?
[01:36:22] <brson> that is my first Go program ever so I just wrote what worked
[01:36:37] <pcwalton> how about https://gist.github.com/pcwalton/5551839
[01:38:23] <pcwalton> brson: actually if you had done the error handling right the Go code would look significantly uglier ;P
[01:38:34] <SiegeLord> I only know Rust, so I've no clue XD
[01:41:39] *** Joins: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP)
[01:42:04] <geomyidae__> pcwalton: yeah, but the rust ex uses unwrap, that's sorta similar isn't it?
[01:42:15] <pcwalton> in Go it's swallowing the error
[01:42:21] <pcwalton> there is no error handling
[01:42:32] <pcwalton> that's part of the problem with Go's error handling, it's easier to swallow the error than to handle it
[01:42:47] <aatch> in rust it's often easier to handle the error
[01:42:56] <geomyidae__> but in rust you have to expicitly unwrap(), yeah
[01:43:04] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[01:43:05] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/Tk193w
[01:43:05] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[01:43:07] <pcwalton> in Rust the easy thing to do is to use .get() and that fails if there's an error
[01:43:09] <pcwalton> instead of continuing
[01:43:26] <geomyidae__> oops, I thought thats what unwrap did
[01:44:04] <pcwalton> there'd be no way for it to work that way
[01:44:08] <aatch> geomyidae__, almost nothing in Rust "just keeps going"
[01:44:09] <pcwalton> you can't write the function that continues anyway
[01:44:13] <pcwalton> what value would it return?
[01:44:17] <pcwalton> in Go you just return nil
[01:44:21] <pcwalton> in Rust... there's no nil :)
[01:44:43] <aatch> Which is why we have Option<T>
[01:44:46] <geomyidae__> right right I'm up on all that :)
[01:44:54] <geomyidae__> I certainly enjoy that aspect a lot
[01:44:56] <pcwalton> I guess you could do get_continue<T:Monoid>
[01:45:02] <pcwalton> or in Rust-speak
[01:45:04] <engla> geomyidae__: unwrap moves, get copies.. they are almost the same
[01:45:05] <pcwalton> <T:Zero>
[01:45:14] <pcwalton> get_or_zero<T:Zero>(Option<T>) would work
[01:45:17] <geomyidae__> engla: gotcha
[01:45:19] <pcwalton> that'd give you the Go behavior
[01:45:24] <pcwalton> which to be fair is convenient
[01:45:40] <brson> I thought there was a pull request at one point to make `get` move as well
[01:45:47] <pcwalton> yeah, I want to do that
[01:45:54] <pcwalton> I recall one too
[01:45:55] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[01:45:56] <ghrust> 01[13rust01] 15bors pushed 27 new commits to 06auto: 02http://git.io/39qBbQ
[01:45:56] <ghrust> 13rust/06auto 14d20956a 15Brian Anderson: core::rt: Remove Close trait...
[01:45:56] <ghrust> 13rust/06auto 14e010ec5 15Brian Anderson: core::rt: Fix a warning about unnecessary mutable variable
[01:45:56] <ghrust> 13rust/06auto 149c84294 15Brian Anderson: core::rt: Begin implementing TcpStream...
[01:45:58] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[01:46:00] <geomyidae__> well, those aren't really zero values usually when its (ret, err) being returned
[01:46:02] <aatch> pcwalton, but (and this is good) would only work for types that have a sensible Zero value
[01:46:02] <brson> erick: ^ what happened to that?
[01:46:16] <pcwalton> when you return err you have to return a zero value for ret
[01:46:16] <brson> erick: the 'get' changes that is
[01:46:20] <pcwalton> which the caller might use
[01:46:20] <geomyidae__> or not generally usable zero values, unless I'm misunderstanding what you're saty
[01:46:40] <geomyidae__> most times its just (*ret, err) and (nil, err) is returned
[01:47:03] <geomyidae__> in which case I think Option<T> seems cleaner and more explicit as you initially noted
[01:47:15] <pcwalton> well, somebody could go on to use the nil
[01:47:17] <pcwalton> and blow up later
[01:47:30] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Input/output error)
[01:47:50] <geomyidae__> mhm
[01:48:23] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[01:49:33] <aatch> Is it worth keeping incredibly-well-known issues about rusti open?
[01:50:10] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[01:50:23] <cantsin> i think so; i was asked to put that issue in, via the mailing list.
[01:50:47] <cantsin> i'm trying to figure out what exactly is wrong so any help is appreciated :)
[01:50:55] <cmr> cantsin: it's broken
[01:50:57] <cmr> :p
[01:51:00] <cantsin> :P
[01:51:14] <aatch> cantsin, rusti was an experiment, then it was more-or-less abandoned.
[01:51:32] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[01:51:44] <cmr> Does the JIT even work?
[01:51:46] <aatch> "What is wrong" is that it still actually compiles!
[01:51:49] <aatch> cmr, it does
[01:51:51] <cantsin> is there official developer support behind rusti? or should it be moved off rust proper?
[01:52:04] <cmr> Well that's one step
[01:52:11] <aatch> if you look at the output it will print the result of the expression
[01:52:15] <cantsin> right.
[01:52:25] <aatch> cantsin, there is motivation to keep it in.
[01:52:40] <aatch> There is also an effort to get it back into working order
[01:53:09] <cmr> it'd be nice if rusti was all working in time for 0.7
[01:53:13] <cantsin> aatch: sure, at this point i'm only familiar with some people from the mailing list trying to get tests in.
[01:53:26] <aatch> cantsin, thats the one
[01:53:36] <cmr> at least, no more broken than 0.6
[01:53:39] <aatch> They have also been discussing wider changes
[01:53:53] *** Joins: carter (carter@moz-12C317EF.nyc.res.rr.com)
[01:54:51] <cantsin> aatch: yes, i was one of the people who replied to the original "call to action for rusti" post :) i want to help, don't see any discussion of wider changes yet.
[01:55:31] <aatch> cantsin, it was on IRC
[01:55:48] <cantsin> ok, i'll search the logs.
[01:57:38] <cantsin> wish rusti wasn't also the name of the bot :P
[01:58:31] <cmr> heh, yea
[01:59:15] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[02:00:29] *** Quits: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se) (Client exited)
[02:01:01] *** Quits: carter (carter@moz-12C317EF.nyc.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[02:02:03] *** Joins: cdidd (cdidd@moz-6E84D9A.broadband.corbina.ru)
[02:02:04] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:02:06] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:02:08] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:05:20] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[02:06:36] *** Joins: inolen (Adium@moz-FA2406D8.socal.res.rr.com)
[02:07:52] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[02:10:42] <Thad> brson: Updated the Wiki for Windows users ! -->https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust
[02:11:26] <cmr> Thad: I take it you got it wroking?
[02:12:14] <Thad> :)
[02:13:13] <Thad> cmr: Tomorrow I will work on the cross-compiling for x86_64 ... nite all !
[02:17:42] *** pcwalton changes topic to 'http://www.rust-lang.orgÂ | ICE to meet you | Tree is OPEN, please be gentle | logs at https://botbot.me/irc.mozilla.org/rust/ and http://irclog.gr/#browse/irc.mozilla.org/rust'
[02:18:55] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:19:19] *** Quits: Thad (chatzilla@moz-C35F90AE.tx.res.rr.com) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130430204233])
[02:20:08] *** Quits: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net) (Client exited)
[02:20:26] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[02:23:33] *** Quits: naq (naq@D5C2D2DF.E4265FCD.E481B5B.IP) (No route to host)
[02:26:39] *** Joins: naq (naq@D5C2D2DF.E4265FCD.E481B5B.IP)
[02:29:03] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[02:29:50] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:30:06] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:34:23] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[02:35:43] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:36:26] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:38:07] <strcat> rusti: 1
[02:38:08] <rusti> 1
[02:39:19] <cantsin> as an aside, i'm using emacs' rust-mode, is there any way to quickly jump to definitions while browsing source code? something akin to tags, maybe?
[02:41:28] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:41:57] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:45:45] *** Quits: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP) (Quit: pcwalton)
[02:46:07] <seth> what's an "ICE"?
[02:46:12] <seth> i assume the e is for exception
[02:46:16] <strcat> internal compiler error
[02:46:20] <seth> oh, i see
[02:47:12] <jack> cantsin: there is some ctags/etags support somewhere in the rust tree that Niko added
[02:47:39] <cantsin> jack: thanks!
[02:48:44] <jack> cantsin: i played with it enough to verify that it works. though i'm not sure how useful it is in practice.
[02:49:21] <cantsin> jack: anything's better than doing it manually. i'm looking at his tree -- do you remember offhand which branch it was?
[02:50:00] <jack> https://github.com/mozilla/rust/blob/master/src/etc/ctags.rust
[02:50:00] <cantsin> predictably niko has like 100 branches :P
[02:50:23] <jack> i think i had to add .rc for crates to it.
[02:50:57] <cmr> yeah niko's da man
[02:51:07] <cantsin> jack: perfect, i'll try that. thanks once again.
[02:51:09] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:53:31] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:53:48] <cantsin> hrm, i see there's also an open issue for proper ctags support
[02:56:02] *** Joins: sully (sully@moz-45967CBE.emarhavil.com)
[02:57:45] <jack> cantsin: i might have missed that. bug #?
[02:57:58] <cantsin> jack: https://github.com/mozilla/rust/issues/1731
[03:00:09] *** Quits: kimundi (kimundi@moz-88B5CFB8.dip0.t-ipconnect.de) (Ping timeout)
[03:03:30] *** Joins: kimundi (kimundi@moz-22B719B7.dip0.t-ipconnect.de)
[03:05:26] *** kimundi is now known as zz_kimundi
[03:08:14] *** Quits: RMF (RMF@moz-A559AD33.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[03:09:05] *** Joins: RMF (RMF@moz-A559AD33.dsl.telepac.pt)
[03:14:10] *** Quits: thelivingded (thelivingd@moz-9453CC48.austin.res.rr.com) (Ping timeout)
[03:16:02] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:16:33] <steven_is_false> I might be missing something but apparently the tag stuff can't distinguish between modules, and functions?
[03:17:09] <steven_is_false> Like I can do M-. in emacs, and can't go to the file named main because I have a module named main.
[03:17:21] *** Joins: thelivingded (thelivingd@moz-9453CC48.austin.res.rr.com)
[03:18:19] <cantsin> steven_is_false: yea. the ctags.rust file is just a bunch of regexes.
[03:18:54] *** Joins: catpigger (catpig@moz-E2E35BC8.dip0.t-ipconnect.de)
[03:19:02] <steven_is_false> cantsin: And there's no way to for example prepend all the matches with the type of thing? For example, instead of searching for main one would search for fn main or mod main.
[03:19:26] *** Joins: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net)
[03:20:00] *** Quits: catpig (catpig@moz-42667BF1.dip0.t-ipconnect.de) (Ping timeout)
[03:20:03] <cantsin> steven_is_false: it looks like that should be possible, i'm not sure why it's working. messing around with it myself.
[03:20:14] <steven_is_false> cantsin: Cool.
[03:22:32] <steven_is_false> cantsin: Good luck with improving it.
[03:22:39] *** Quits: ksev (DrunkenPan@5688B28D.841F5BFE.B9B3705E.IP) (Ping timeout)
[03:25:57] <cantsin> steven_is_false: i'll try :P
[03:26:20] <steven_is_false> Thank you.
[03:29:25] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Ping timeout)
[03:31:01] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[03:32:32] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Quit: leaving)
[03:34:50] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[03:35:38] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[03:38:47] *** Joins: heftig (heftig@CD90F606.D483D23B.172227A7.IP)
[03:39:08] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[03:43:35] *** Joins: an0nymous (an0nymous@moz-A6B0CE4.tx.res.rr.com)
[03:46:36] *** Quits: thelivingded (thelivingd@moz-9453CC48.austin.res.rr.com) (Ping timeout)
[03:47:19] *** Parts: judder (maradukewa@DABDEEA3.F2C0D0AC.78E362FE.IP) ()
[03:51:29] *** Joins: ksev (DrunkenPan@5688B28D.841F5BFE.B9B3705E.IP)
[03:53:31] *** Quits: erick (erick@E1304535.2A7189BF.BE19388.IP) (Ping timeout)
[03:55:09] *** Joins: erick (erick@E1304535.2A7189BF.BE19388.IP)
[03:55:19] *** Quits: enticeing (user@40584768.29B601FE.5037098C.IP) (Client exited)
[03:57:06] *** Joins: thelivingded (thelivingd@moz-9453CC48.austin.res.rr.com)
[03:57:27] *** Quits: ksev (DrunkenPan@5688B28D.841F5BFE.B9B3705E.IP) (Ping timeout)
[03:57:35] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[03:59:55] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[04:07:28] *** Quits: jgilbert (jgilbert@2557E599.66715431.D25A875A.IP) (Ping timeout)
[04:08:23] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[04:12:26] *** Quits: Diablo-D3 (diablo@moz-F06B3F31.port.east.myfairpoint.net) (Ping timeout)
[04:13:06] *** Quits: cstrahan (cstrahan@moz-F976BC85.hsd1.va.comcast.net) (Ping timeout)
[04:13:08] *** Joins: brson (brson@E9CDE21E.991753BB.CA4D1600.IP)
[04:13:08] *** ChanServ sets mode: +o brson
[04:16:52] *** Joins: Diablo-D3 (diablo@moz-28CF78D6.port.east.myfairpoint.net)
[04:19:55] *** Quits: SiegeLord (sl@moz-56D7E78.bstnma.fios.verizon.net) (Quit: It's a joke. It's all a joke.)
[04:23:41] *** Quits: heftig (heftig@CD90F606.D483D23B.172227A7.IP) (Ping timeout)
[04:26:21] *** Quits: thelivingded (thelivingd@moz-9453CC48.austin.res.rr.com) (Ping timeout)
[04:26:33] *** Joins: heftig (heftig@moz-2F4A1158.dip0.t-ipconnect.de)
[04:27:54] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[04:28:17] *** Joins: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net)
[04:29:19] *** Quits: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:29:40] <thomaslee> is there an easy way to determine if a given def_id is for an item in the same module as another def_id (am working in in librustc/metadata/encoder.rs)? Am I best off looking at paths?
[04:31:37] *** Joins: thelivingded (thelivingd@moz-9453CC48.austin.res.rr.com)
[04:32:28] *** Quits: catpigger (catpig@moz-E2E35BC8.dip0.t-ipconnect.de) (Quit: Verlassend)
[04:34:27] <dbaupp> nmatsakis: ping
[04:37:09] *** Quits: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net) (Ping timeout)
[04:37:21] *** Joins: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net)
[04:40:36] *** Joins: noam_ (noam@F6B530A7.720527A7.416762B.IP)
[04:41:19] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[04:46:53] *** Joins: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[04:53:28] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Client exited)
[04:55:53] *** Quits: thelivingded (thelivingd@moz-9453CC48.austin.res.rr.com) (Ping timeout)
[04:58:24] *** Quits: yong (chatzilla@74DA0C97.4E87ADC2.263D9828.IP) (Ping timeout)
[04:59:02] *** Quits: igl1 (igl@moz-6225A211.adsl.alicedsl.de) (Ping timeout)
[04:59:44] *** Joins: igl (igl@moz-21D8C29B.adsl.alicedsl.de)
[05:09:14] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Input/output error)
[05:10:20] *** Joins: Erik (Erik_S@moz-252DBA2.hsd1.co.comcast.net)
[05:10:43] *** Parts: Erik (Erik_S@moz-252DBA2.hsd1.co.comcast.net) ()
[05:16:24] *** Joins: bEcker (Thunderbir@moz-3F74B132.resnet.ucsc.edu)
[05:18:10] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[05:18:37] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[05:21:40] *** Joins: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[05:21:40] *** ChanServ sets mode: +o pcwalton
[05:21:41] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Quit: .)
[05:22:22] *** Joins: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[05:22:22] *** ChanServ sets mode: +o pcwalton
[05:22:24] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Quit: .)
[05:22:42] *** Quits: inolen (Adium@moz-FA2406D8.socal.res.rr.com) (Ping timeout)
[05:22:58] <aatch> strcat, Hey, would you mind if I added a note about your daily build to wiki?
[05:23:39] <strcat> aatch: I added it to https://github.com/mozilla/rust/wiki/Doc-packages,-editors,-and-other-tools :)
[05:23:44] *** Joins: inolen (Adium@moz-FA2406D8.socal.res.rr.com)
[05:24:15] <aatch> strcat, Ahh, theres nothing mentioning it on https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust
[05:24:32] <strcat> ah that should link to the page with packages
[05:24:55] <strcat> hm
[05:25:07] <strcat> or it could just be sections
[05:25:07] * strcat shrugs
[05:25:15] <aatch> Though I guess it's not necessarily the right place..
[05:26:58] *** Quits: blitter (blitter@moz-7C98731E.dyn.centurytel.net) (Ping timeout)
[05:29:15] *** Joins: blitter (blitter@moz-7C98731E.dyn.centurytel.net)
[05:29:59] <dbaupp> aatch: you have r+ powers? :)
[05:30:11] <aatch> dbaupp, I'm pretty sure
[05:30:16] <aatch> I talked to graydon earlier
[05:30:42] <aatch> He said it was probably an oversight that I have commit access but not approve access
[05:31:16] <aatch> I'm not confident enough to touch anything that isn't trivial though...
[05:32:26] <naq> the nightly build for arch doesn't conflict with rust from the official community repo
[05:32:37] *** zz_kimundi is now known as kimundi
[05:33:25] <strcat> naq: whoops, fixed (well, when it builds again tommorow)
[05:33:39] *** Quits: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net) (Quit: Leaving)
[05:33:53] <jack> i want to punch someone every time i need to search rust issues
[05:33:56] <jack> wtf github
[05:34:14] <aatch> jack, I know. But the unified search more-or-less works
[05:34:19] * strcat doesn't find it that bad now that they added open/closed tags
[05:34:21] <naq> strcat: thanks for the build
[05:34:25] <strcat> naq: np
[05:34:39] <jack> how does it work? i search for"borrow" and i get 2 issues. that's it.
[05:34:53] <strcat> I get 122
[05:34:55] <jack> sorry. 4. 
[05:34:56] *** Parts: inolen (Adium@moz-FA2406D8.socal.res.rr.com) ()
[05:35:16] <jack> ah, you have to hit enter. i see now
[05:35:27] <jack> the old autocomplete had many more issues
[05:35:37] <jack> i suppose i had just internalized using that
[05:35:37] <strcat> yeah they ruined auto-complete
[05:35:43] <strcat> jack: at first it had no filter for open/closed too
[05:35:53] <strcat> I reported it and they fixed it quickly
[05:36:04] <strcat> could probably just send in reports for the other issues
[05:36:17] <strcat> apparently they really like restyling the site on a daily basis ;\
[05:36:32] <jack> strcat: where do you report it. i sent feedback aobut it but i get a form response pretty much.
[05:36:42] <aatch> strcat, they're cargo-culting facebook?
[05:36:52] <strcat> jack: just with https://github.com/contact
[05:36:55] <strcat> jack: well
[05:37:00] <strcat> often they send a form response
[05:37:04] <strcat> sometimes they don't ;p
[05:37:26] <strcat> afaik someone does read it
[05:37:43] <strcat> sometimes I have email conversations with them
[05:37:54] <strcat> ofc it could be a clever AI :)
[05:38:14] <jack> can the new borrow checker not handle this? https://github.com/mozilla/servo/blob/master/src/servo-net/image_cache_task.rs#L375-L391
[05:38:32] <jack> the immutable borrow of wait_map prevents the wait_map.insert
[05:38:41] <jack> but why does it need to borrow for the whole match clause?
[05:38:53] <aatch> dbaupp, well, the bors queue says approved. So I guess graydon added me now
[05:39:04] <strcat> jack: it's flow sensitive now but I think the borrows are still entirely based on scope.
[05:39:45] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[05:39:49] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Eaten by a grue)
[05:40:36] <jack> even scoping it with `let res = { self.wait_map.find(&url) };` didn't help :(
[05:40:48] <strcat> jack: well it returns a borrowed ptr
[05:40:58] <strcat> it doesn't care about the &self borrow from find
[05:41:13] <dbaupp> aatch: yup, nice :)
[05:43:35] *** Joins: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net)
[05:44:05] *** Quits: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[05:44:25] <jack> strcat: ah. well this makes hashmaps kind of clunky :(
[05:45:11] <strcat> jack: well you can't have the result borrowed when you modify it and it's not very clever at automatically finding the end of life of the borrow
[05:45:36] <strcat> with flow-sensitivity it's at least possible to express things in somewhat convoluted ways ;p
[05:45:37] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[05:45:39] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[05:45:52] <strcat> just not as convenient as it could be
[05:46:33] *** Quits: bEcker (Thunderbir@moz-3F74B132.resnet.ucsc.edu) (Ping timeout)
[05:48:49] *** Quits: rfw (rfw@moz-C65A114.rfw.name) (Ping timeout)
[05:48:54] *** Joins: rfw (rfw@moz-C65A114.rfw.name)
[05:49:16] <jack> i changed it to pp
[05:49:17] <jack> pop
[05:49:22] <jack> hopefully that works.
[05:49:42] <jack> yay
[05:50:15] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[05:50:16] *** Joins: bEcker (Thunderbir@moz-90785708.resnet.ucsc.edu)
[05:52:07] *** Quits: bEcker (Thunderbir@moz-90785708.resnet.ucsc.edu) (Quit: bEcker)
[05:55:57] <jack> hmm. there's no get_mut
[05:56:37] <jack> or find_or_insert_mut
[05:57:46] <strcat> jack: there's find_mut
[05:58:03] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[05:58:04] <strcat> get is just find(&k).unwrap()
[05:59:13] *** Quits: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi) (Ping timeout)
[06:00:06] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[06:00:06] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14b476af5 to 14ad8e236: 02http://git.io/N3iJvQ
[06:00:06] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[06:00:08] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[06:00:08] <ghrust> 01[13rust01] 15bors pushed 9 new commits to 06auto: 02http://git.io/zHuUVQ
[06:00:08] <ghrust> 13rust/06auto 14fc9ff24 15Alex Crichton: Implement a new protocol for `for` loops that's much more easily composable
[06:00:08] <ghrust> 13rust/06auto 1473c1397 15Alex Crichton: core: Use the new `for` protocol
[06:00:08] <ghrust> 13rust/06auto 149d07076 15Alex Crichton: std: Use the new `for` protocol
[06:00:11] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[06:00:11] <jack> that's what i ended up using.
[06:05:06] *** Joins: ahsanulhaque (Adium@moz-D2744CF6.banglalionwimax.com)
[06:05:43] <benh> Why is destructuring structs with a destructor not allowed?
[06:05:57] <aatch> benh, bug
[06:06:12] <dbaupp> benh: I've got a branch with a fix for it
[06:06:20] <dbaupp> benh: but it's entirely broken for let's
[06:06:21] <dbaupp> :(
[06:06:29] <aatch> https://github.com/mozilla/rust/issues/6344
[06:07:54] <benh> I don't understand why it's a problem in the first case, why rust-sdl doesn't compile with tht error pointing at deriving(Eq) bits and why destructuring structs with a destructor is okay if it's a enum-like struct :)
[06:08:36] <aatch> benh, if it made sense, it wouldn't be a bug
[06:08:38] <benh> It's a problem with moves because moving a struct into a destructuring escapes the destructor?
[06:08:57] <benh> well, at some point it made enough sense for someone to write an error message and a testcase :/
[06:09:37] <aatch> benh, theres probably some weird set of cases that make it hard to fix
[06:09:45] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130506154904])
[06:09:51] <aatch> Or at least harder than adding an error message and test case
[06:10:19] <aatch> Would you rather have an explanatory error message or an ICE?
[06:12:19] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[06:12:19] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14a5a801b to 14ad8e236: 02http://git.io/N3iJvQ
[06:12:19] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[06:12:20] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[06:12:20] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/cXfcbg
[06:12:20] <ghrust> 13rust/06auto 14f24dce2 15Alex Crichton: Implement util::swap without the '<->' operator
[06:12:20] <ghrust> 13rust/06auto 148d1e09a 15Alex Crichton: Stop using the '<->' operator
[06:12:21] <ghrust> 13rust/06auto 14f259503 15Alex Crichton: Remove the '<->' operator from the language
[06:12:23] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[06:13:03] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.0)
[06:15:50] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Connection reset by peer)
[06:16:15] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[06:20:52] <otters> oh dam
[06:21:18] <aatch> otters, no, beavers have dams
[06:21:39] <otters> ehehehe
[06:24:18] *** Quits: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[06:24:27] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[06:24:35] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[06:24:48] *** Joins: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[06:26:47] *** Quits: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[06:27:01] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[06:27:03] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[06:27:03] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14a87273f to 14ad8e236: 02http://git.io/N3iJvQ
[06:27:03] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[06:27:06] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[06:27:06] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/_--PdQ
[06:27:06] <ghrust> 13rust/06auto 14c8e93ed 15Youngsoo Son: Move core::task::local_data to core::local_data
[06:27:06] <ghrust> 13rust/06auto 14fa8a5cc 15bors: auto merge of #6329 : sonwow/rust/issue-6306, r=sanxiyn...
[06:27:06] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[06:27:08] *** Quits: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP) (Connection reset by peer)
[06:27:11] *** Joins: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP)
[06:29:33] <dbaupp> benh, aatch: https://github.com/mozilla/rust/pull/6385
[06:30:48] <aatch> dbaupp, cool
[06:31:49] <dbaupp> aatch: pattern matching in let is so generally broken at the moment :(
[06:32:27] <aatch> dbaupp, isn't that because let uses mostly different code to match?
[06:32:43] <aatch> Or have they been unified now and are still broken?
[06:32:50] <dbaupp> aatch: sort of... it does call the "check moves are valid" code that match does
[06:33:19] <dbaupp> aatch: but doesn't ever execute the actual useful part of that function
[06:33:30] <dbaupp> for reasons I can't divine :(
[06:33:56] <aatch> dbaupp, lol. I guess that's core dev territory there.
[06:34:04] <dbaupp> i.e. it goes through and decides that there are no moves for every let pattern, even though there clearly are
[06:34:33] <dbaupp> aatch: yup... hence my approach of "throw the code online and hope someone else knows what's up" :)
[06:34:35] *** Joins: EXetoC (ex@moz-C741B177.customer.t3.se)
[06:36:41] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[06:40:00] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[06:42:37] *** Joins: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP)
[06:44:04] *** Joins: Palmik (palmik@moz-DADC71F0.pks.muni.cz)
[06:49:04] *** Quits: brson (brson@E9CDE21E.991753BB.CA4D1600.IP) (Quit: leaving)
[06:49:05] *** Quits: ahsanulhaque (Adium@moz-D2744CF6.banglalionwimax.com) (Ping timeout)
[06:56:04] *** Joins: berak (chatzilla@D06C6CA0.5E545589.16E13E53.IP)
[06:56:05] *** Joins: ahsanulhaque (Adium@moz-5E74BAB7.banglalionwimax.com)
[06:56:24] *** Parts: berak (chatzilla@D06C6CA0.5E545589.16E13E53.IP) ()
[07:00:28] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[07:00:29] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14fa8a5cc to 14ad8e236: 02http://git.io/N3iJvQ
[07:00:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[07:00:29] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[07:00:29] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/1ma1Wg
[07:00:29] <ghrust> 13rust/06auto 14d6efbad 15Alex Crichton: Mark c_vec functions as unsafe again
[07:00:29] <ghrust> 13rust/06auto 143e106cf 15bors: auto merge of #6339 : alexcrichton/rust/unsafe-cvec, r=catamorphism...
[07:00:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[07:02:17] *** Joins: wunki (wunki@moz-D4C0427D.cm-6-7d.dynamic.ziggo.nl)
[07:06:43] *** Joins: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net)
[07:09:41] *** Joins: yong (chatzilla@74DA0C97.4E87ADC2.263D9828.IP)
[07:10:36] *** Quits: blitter (blitter@moz-7C98731E.dyn.centurytel.net) (Ping timeout)
[07:11:38] *** Quits: yong (chatzilla@74DA0C97.4E87ADC2.263D9828.IP) (Ping timeout)
[07:11:59] *** Joins: dr_bibble (Mibbit@71943B54.501E5C87.931D0F89.IP)
[07:13:45] *** Parts: dr_bibble (Mibbit@71943B54.501E5C87.931D0F89.IP) ()
[07:16:08] *** Joins: Blub\w (wry@moz-361A7B5D.wireless.dyn.drei.com)
[07:16:52] *** Joins: yong (chatzilla@74DA0C97.4E87ADC2.263D9828.IP)
[07:21:04] *** Joins: ksev (DrunkenPan@5688B28D.841F5BFE.B9B3705E.IP)
[07:23:04] *** Quits: ksev (DrunkenPan@5688B28D.841F5BFE.B9B3705E.IP) (Ping timeout)
[07:23:45] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Ping timeout)
[07:30:13] *** Joins: ysuzuki (ysuzuki@moz-F333A8C8.st.keio.ac.jp)
[07:31:37] *** kimundi is now known as zz_kimundi
[07:35:54] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[07:36:38] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[07:43:07] <jyyou> win 11
[07:49:08] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[07:49:10] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Max SendQ exceeded)
[07:49:40] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[07:49:45] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Max SendQ exceeded)
[07:50:14] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[07:50:17] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Max SendQ exceeded)
[07:50:41] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[07:50:42] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Max SendQ exceeded)
[07:51:07] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[07:51:09] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Max SendQ exceeded)
[07:51:29] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[07:51:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/1ma1Wg
[07:51:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[07:51:34] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[07:51:53] *** Quits: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzzZZZzzz)
[07:52:04] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[07:52:11] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:54:27] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[07:54:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/HgX3fA
[07:54:27] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[07:54:28] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[07:54:28] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/yT0dTA
[07:54:28] <ghrust> 13rust/06auto 14d3ca9c6 15Corey Richardson: Better error message for certain classes of unresolved imports
[07:54:28] <ghrust> 13rust/06auto 14fa5baf3 15Corey Richardson: Tweak error message...
[07:54:28] <ghrust> 13rust/06auto 140afcd34 15Corey Richardson: compile-fail test for new unresolved import error
[07:54:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[07:56:36] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[07:57:15] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[08:06:38] *** Joins: fabiand (fabiand@moz-946E65F8.adsl.alicedsl.de)
[08:07:36] *** Quits: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net) (Ping timeout)
[08:09:00] *** zz_kimundi is now known as kimundi
[08:13:23] *** Joins: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr)
[08:23:39] *** Joins: Axord (xord@moz-C3CCF156.lsanca.dsl-w.verizon.net)
[08:26:30] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Quit: Textual IRC Client: www.textualapp.com)
[08:28:37] *** Joins: true_droid (Adium@moz-123FD9B8.beck.volia.net)
[08:29:44] *** Quits: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net) (Ping timeout)
[08:31:54] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:39:27] *** Quits: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu) (Ping timeout)
[08:41:08] *** Quits: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu) (Ping timeout)
[08:42:19] *** Quits: thou (thou@moz-1C1CA9F7.fasttrackcomm.net) (Ping timeout)
[08:43:00] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[08:43:20] *** Joins: rpearl (rpearl@78547FDF.7E6163D9.E7C4E1DA.IP)
[08:43:51] *** Quits: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu) (Ping timeout)
[08:44:19] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Connection reset by peer)
[08:44:39] *** Quits: recrack (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:47:22] *** Quits: rpearl (rpearl@78547FDF.7E6163D9.E7C4E1DA.IP) (Ping timeout)
[08:48:51] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:48:52] *** Joins: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu)
[08:49:02] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[08:50:05] *** Joins: rntz (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[08:50:24] *** Joins: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu)
[08:51:31] *** Quits: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[08:53:27] <dbaupp> is there a way to detect processor features in rust yet? (e.g. #[arch(sse3)] fn foo() {} #[arch(not(sse3))] fn foo() {})
[08:53:41] <aatch> dbaupp, I don't think so
[08:53:47] *** Quits: lerc (quassel@121.75.155.67) (Client exited)
[08:53:56] <aatch> llvm exposes it though? right?
[08:54:00] <dbaupp> aatch: yeah, thought so...
[08:54:03] <dbaupp> aatch: does it?
[08:54:22] <dbaupp> (I've got no idea...)
[08:54:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[08:54:32] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/yT0dTA
[08:54:32] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[08:54:46] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[08:54:53] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:56:04] *** Joins: haard (fredrik@moz-379B5613.cust.telenor.se)
[08:57:29] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[08:57:29] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/BpVyIg
[08:57:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[08:57:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[08:57:32] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/cDckzg
[08:57:32] <ghrust> 13rust/06auto 141393c3a 15BjÃ¶rn Steinbrink: Use a specialized string interner to reduce the need for owned strings...
[08:57:32] <ghrust> 13rust/06auto 14e9d0018 15bors: auto merge of #6356 : dotdash/rust/strinterner, r=pcwalton...
[08:57:32] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[08:58:04] <aatch> woo!
[08:58:42] <doener> :-)
[09:00:00] *** Quits: haard (fredrik@moz-379B5613.cust.telenor.se) (Ping timeout)
[09:00:03] <dbaupp> doener: did you happen to measure/notice a performance improvement?
[09:01:13] *** Quits: victorporof (victorporo@B86E46F.1B500F07.6A4F8DA2.IP) (Ping timeout)
[09:01:59] *** Joins: victorporof_ (victorporo@B86E46F.1B500F07.6A4F8DA2.IP)
[09:02:41] <doener> dbaupp: libcore compilation was about 1% faster, but that was with just two measurements, so it might have been noise.
[09:02:41] *** Quits: giselher (Mibbit@moz-17BE0554.adsl.highway.telekom.at) (Quit: http://www.mibbit.com ajax IRC Client)
[09:04:02] <doener> dbaupp: OTOH, I measured the full compilation, which is dominated by LLVM.
[09:04:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[09:07:17] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[09:07:22] <dbaupp> doener: oh... so not a huge gain. (Not like the regression you found a few days ago)
[09:07:48] *** victorporof_ is now known as victorporof
[09:08:10] <dbaupp> in other news, rust is faster than C https://gist.github.com/huonw/5553335
[09:09:02] <aatch> dbaupp, awesome
[09:11:21] <sp3d> dbaupp: cool; did you look at assembly to see where the difference lies?
[09:11:36] <dbaupp> sp3d: I haven't investigated much yet
[09:13:19] <ssbr> man, I am not in the mood to do regexp stuff today. I want to write a game or something.
[09:13:23] <sp3d> it seems like most "X compiled language is faster than Y compiled language" comparisons ignore the distinction between things like optimizations limited by semantics, e.g. aliasing concerns, and language-design-independent implementation details like instruction selection
[09:13:49] <ssbr> But it looks like rust only has OpenGL ES bindings ;___; -- I've never tried using GLES from the desktop. (There's some weird stuff with EGL, right? blegh.)
[09:13:58] <sp3d> not to accuse of any shoddiness, just clarifying my curiosity
[09:15:49] <dbaupp> sp3d: that was compiled with gcc, but just testing with clang (which uses the llvm backend that rust uses) it seems it's slower
[09:15:56] *** Joins: z0w0 (zack@D1D2DBCB.806EA3ED.2CE63F58.IP)
[09:16:05] <sp3d> mm
[09:16:08] <ssbr> ahahaha. That makes some sense.
[09:16:19] <aatch> Grrr, stupid algorithm relies on garbage collection for correctness
[09:16:20] *** Joins: spider-mario (spidermari@moz-2BC095A6.rev.sfr.net)
[09:16:49] <EXetoC> ssbr: there's glcore-rs and glfw-rs
[09:17:31] <aatch> Actually, I tell a lie, it doesn't
[09:17:44] <EXetoC> glLoadGen is in the works I think
[09:17:55] <ssbr> GLFW is something I'd use instead of GLEW, right? (I'm not that experienced with OpenGL)
[09:18:39] <ssbr> I like how glcore only implements the core profile. Lazy, but good. Deprecated APIs suck anyway.
[09:18:58] <EXetoC> I think so. it does have support for window creation and window events (callbacks)
[09:18:59] <ssbr> EXetoC: sincere thanks, I'd been doing some googling but couldn't find anything
[09:19:08] <ssbr> Yeah, that's the important thing.
[09:19:12] <ssbr> I do not want to have to call xlib.
[09:19:49] <dbaupp> aatch: what's the algorithm? :)
[09:20:05] <aatch> Chase & Lev work stealing algorithm
[09:20:49] <aatch> I figured I help brson out and fill out the stub
[09:21:03] <sammykim> Do you guys know why I got failure "net_tcp::test::tcp_ipv4_server_and_client_test::impl64::test_gl_tcp_server_and_client_ipv4", when I make check for rust?
[09:21:47] <ssbr> haha, there's even a port of the open.gl tutorial! https://github.com/bjz/open.gl-tutorials
[09:21:58] *** Joins: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP)
[09:21:59] <sammykim> My environment is 64bit ubuntu 12.10
[09:22:13] <ssbr> As soon as bjz comes back in this channel I'm giving him a huge hug
[09:26:16] *** Quits: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr) (Quit: pyrac)
[09:26:22] <dbaupp> aatch: does rust have CAS?
[09:26:48] <dbaupp> (for context: i'm reading the paper)
[09:28:08] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[09:31:14] *** Quits: wunki (wunki@moz-D4C0427D.cm-6-7d.dynamic.ziggo.nl) (Quit: Bye)
[09:31:37] *** Joins: trapni (trapni@moz-DD991BA4.web.vodafone.de)
[09:32:41] <aatch> dbaupp, yep
[09:33:09] <aatch> dbaupp, it's atomic_cxchg
[09:34:19] <dbaupp> aatch: oh cool
[09:35:40] *** Quits: trapni (trapni@moz-DD991BA4.web.vodafone.de) (Quit: Leaving)
[09:35:51] <aatch> I have some experience with lock-and-wait free algorithms so it doesn't look too hard to implement.
[09:35:57] <aatch> At least a basic version.
[09:36:26] <dbaupp> nmatsakis: I just pushed a commit with the issue number on the xfail-test on https://github.com/mozilla/rust/pull/6385
[09:39:20] <dbaupp> aatch: yeah, the code seems quite clear in that paper
[09:40:24] <dbaupp> does it actually work without a GC?
[09:40:51] <aatch> dbaupp, yeah, it just takes a little more work
[09:41:22] <dbaupp> is the shrinking the hard part?
[09:42:12] <aatch> dbaupp, well the basic version of just copying isn't too hard
[09:46:09] <aatch> Also, I'm not sure if it should store items, or owned pointers to items
[09:47:09] *** Joins: kha (user@E02A343F.9F695E04.78636264.IP)
[09:48:56] *** Quits: z0w0 (zack@D1D2DBCB.806EA3ED.2CE63F58.IP) (Quit: Leaving.)
[09:50:11] *** Joins: z0w0 (zack@D1D2DBCB.806EA3ED.2CE63F58.IP)
[09:50:34] *** Quits: KindOne (KindOne@moz-81777182.dynamic.ip.windstream.net) (Ping timeout)
[09:53:33] *** Joins: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr)
[09:54:25] *** Joins: KindOne (KindOne@moz-9CC5F2DE.dynamic.ip.windstream.net)
[09:56:34] <aatch> The interesting thing will be battling Rust's memory safety
[09:56:41] *** kimundi is now known as zz_kimundi
[09:57:39] <dbaupp> aatch: I'm probably missing some subtlety, but doesn't the store-previous-buffers work fine with ~ pointers?
[09:58:12] <aatch> dbaupp, actually, that should work fine
[09:58:13] <dbaupp> i.e. the pointer is moved into/out of the larger array as the larger array is grown/shrunk?
[09:58:35] <aatch> I was just thinking about the steal
[09:59:27] <aatch> since you can't take the array, you have to slice
[09:59:47] *** Quits: ysuzuki (ysuzuki@moz-F333A8C8.st.keio.ac.jp) (Client exited)
[10:01:20] <dbaupp> aatch: for the shared pool steal?
[10:01:45] <aatch> dbaupp, nah just the "keep the old buffers around" one
[10:02:48] <aatch> basically making sure that a thread that is stealing doesn't cause too many issues
[10:03:03] <dbaupp> oh, really? doesn't plain old `self.buffer[i]` work?
[10:03:30] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[10:03:30] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/cDckzg
[10:03:30] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[10:04:15] <dbaupp> (or, `self.activeArray[i]`, in the terminology of the paper)
[10:04:56] *** Joins: mdu (mdu@moz-9962C9F4.rev.numericable.fr)
[10:05:37] <aatch> dbaupp, actually, just realised something from the paper that means a grow/shrink causes a steal to abort if it is half-way through
[10:05:55] <aatch> so my worry is unfounded
[10:06:16] <dbaupp> yaay :D
[10:06:26] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[10:06:27] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/-z97BQ
[10:06:27] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[10:06:27] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[10:06:27] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/57dP0A
[10:06:27] <ghrust> 13rust/06auto 14c8e93ed 15Youngsoo Son: Move core::task::local_data to core::local_data
[10:06:27] <ghrust> 13rust/06auto 144400bbd 15Youngsoo Son: A test file is fixed
[10:06:27] <ghrust> 13rust/06auto 146da2c98 15bors: auto merge of #6329 : sonwow/rust/issue-6306, r=ILyoan...
[10:06:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[10:06:37] <aatch> And I can just do a swap into the array to deal with the fact that I won't /actually/ be adding and removing from the ends
[10:07:09] *** Joins: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp)
[10:07:31] <dbaupp> aatch: using intrinsics::uninit, maybe? ;)
[10:07:41] <aatch> dbaupp, yep lol
[10:12:29] *** zz_kimundi is now known as kimundi
[10:18:18] <nmatsakis> dbaupp: ok, r+'d (shouldn't have done it before until you made those changes)
[10:18:46] <aatch> rusti: (~[~[]]).len()
[10:18:47] <rusti> foo.rs:5:9: 5:18 error: internal compiler error: borrow-vec associated with bad sty: &ty_err
[10:18:47] <rusti> foo.rs:5          (~[~[]]).len()
[10:18:48] <rusti>                   ^~~~~~~~~
[10:18:48] <rusti> note: in expansion of fmt!
[10:18:48] <rusti> foo.rs:4:12: 6:7 note: expansion site
[10:19:32] <aatch> rusti: let a : ~[~[int]] = ~[~[]]; a.len()
[10:19:33] <rusti> 1
[10:19:59] <dbaupp> nmatsakis: thanks :)
[10:31:25] *** Quits: Blub\w (wry@moz-361A7B5D.wireless.dyn.drei.com) (Quit: back in a few hours)
[10:38:46] *** Joins: lerc (quassel@6174E42B.BEFA2430.788638A4.IP)
[10:39:15] *** Quits: thou (thou@moz-1C1CA9F7.fasttrackcomm.net) (Input/output error)
[10:46:33] *** Joins: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net)
[10:48:30] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[10:52:39] *** Quits: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr) (Quit: pyrac)
[11:00:46] <aatch> I really hope I'm interpreting this algorithm correctly
[11:01:00] <aatch> Otherwise this queue is majorly unsound
[11:02:17] <dbaupp> aatch: did it require `unsafe`?
[11:02:26] <aatch> dbaupp, yes
[11:02:42] <dbaupp> a lot/
[11:02:43] <dbaupp> ?
[11:02:58] <aatch> dbaupp, depends on how you interpret a lot.
[11:03:17] <aatch> Not many instances, but the instances are the bits that get called the most
[11:03:35] <aatch> I'm also not sure if the assumptions regarding concurrent access are right.
[11:05:01] <dbaupp> ah, yeah... concurrency is hard :(
[11:05:06] <dbaupp> have you got it running?
[11:05:11] <aatch> dbaupp, not yet
[11:05:27] <aatch> I haven't done much work with this style of rust code
[11:06:14] <aatch> (lots of unsafe and thinking about invariants)
[11:06:25] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[11:06:25] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/57dP0A
[11:06:25] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[11:09:26] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[11:09:26] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Q1lE_Q
[11:09:26] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[11:09:28] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[11:09:28] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/B6KPoQ
[11:09:28] <ghrust> 13rust/06auto 14c2bf9bf 15Jyun-Yan You: improve MIPS backend and implement segmented stacks
[11:09:28] <ghrust> 13rust/06auto 14fdf601e 15bors: auto merge of #6358 : crabtw/rust/mips-segstk, r=brson...
[11:09:28] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[11:10:09] <Flibo> why does that bot always part
[11:11:50] <dbaupp> aatch: neither... that sort of code requires so much care
[11:12:17] <cmr>  Flibo because that's just how it works. ease of implementation mostly.
[11:12:36] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[11:12:36] <aatch> dbaupp, fortunately I spend much of my day job in C, so some of it just requires switching gears
[11:13:00] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[11:13:18] <aatch> The rest is figuring out how to convince Rust that I know what I'm doing (even if I don't)
[11:13:52] <dbaupp> hehe, `unsafe { unsafe { self.trust_me_on_this_one() } }`
[11:14:05] <cmr> lol
[11:14:16] <aatch> I wonder if it would complain about the outer unsafe block?
[11:14:59] <dbaupp> rusti: unsafe fn f() {} unsafe { unsafe { f() } }
[11:15:00] <rusti> foo.rs:5:26: 5:51 warning: unnecessary `unsafe` block [-W unused_unsafe]
[11:15:00] <rusti> foo.rs:5          unsafe fn f() {} unsafe { unsafe { f() } }
[11:15:00] <rusti>                                    ^~~~~~~~~~~~~~~~~~~~~~~~~
[11:15:01] <rusti> note: in expansion of fmt!
[11:15:01] <rusti> foo.rs:4:12: 6:7 note: expansion site
[11:15:20] <aatch> Though so
[11:16:44] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[11:17:49] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[11:26:09] *** Quits: mdu (mdu@moz-9962C9F4.rev.numericable.fr) (Quit: mdu)
[11:30:18] <aatch> problem with referencing Java code: I keep typing `this` instead of `self`
[11:32:08] <dbaupp> does putting `let this = self` at the top of each function pass the borrow checker? :P
[11:32:19] <aatch> lol, it might
[11:34:00] <aatch> dbaupp, so the thing I thought might be broken, was
[11:34:44] <dbaupp> aatch: I guess it's good to know that your intuition/code-sense is working...
[11:34:50] <dbaupp> is it fixable?
[11:34:55] <aatch> dbaupp, oh yeah
[11:35:10] <aatch> I was just replacing too early
[11:35:22] <aatch> moved it to where it was supposed to be
[11:35:29] <aatch> yay unsafe_mut_ref!
[11:36:17] <dbaupp> the .unsafe_ vector methods are really useful
[11:36:26] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[11:36:44] *** Joins: quvarxa (chatzilla@moz-AEA6914D.lns21.adl2.internode.on.net)
[11:36:45] *** Joins: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr)
[11:38:27] *** Joins: judder (maradukewa@DABDEEA3.F2C0D0AC.78E362FE.IP)
[11:38:42] <aatch> I get a reference, then replace the contents with uninit() after I know the steal succeeded
[11:38:49] <aatch> rather than replacing when I get.
[11:46:30] *** Quits: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net) (Ping timeout)
[11:49:04] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[11:49:15] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[11:50:27] *** Joins: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net)
[11:52:16] *** Quits: haard (fredrik@moz-6A86987C.dynamic.se.alltele.net) (Ping timeout)
[11:53:17] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Quit: Ex-Chat)
[11:55:44] *** Quits: sonwow (sonwow@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[11:59:05] <aatch> rusti: for u64::range(0,5) |i| { io::println(fmt!("%d", i));}
[11:59:07] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/fKCE
[11:59:24] <aatch> rusti: for u64::range(0,5) |i| { io::println(fmt!("%u", i));}
[11:59:25] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/dTRW
[11:59:38] <aatch> rusti: for u64::range(0,5) |i| { io::println(fmt!("%?", i));}
[11:59:39] <rusti> 0
[11:59:39] <rusti> 1
[11:59:40] <rusti> 2
[11:59:40] <rusti> 3
[11:59:40] <rusti> 4
[12:05:53] *** Quits: ssbr_ (ssbr@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[12:10:22] *** Quits: kha (user@E02A343F.9F695E04.78636264.IP) (Ping timeout)
[12:12:27] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:12:27] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/B6KPoQ
[12:12:27] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:15:24] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:15:24] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/l_-mFg
[12:15:24] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:15:25] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:15:25] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/g_F6RA
[12:15:25] <ghrust> 13rust/06auto 1468015e1 15Niko Matsakis: rustc: Add new graph library, based on code from region_infernece
[12:15:25] <ghrust> 13rust/06auto 14d83805a 15Niko Matsakis: rustc: Port region_inference to use the newly introduced graph library
[12:15:25] <ghrust> 13rust/06auto 14bca0ab4 15bors: auto merge of #6363 : nikomatsakis/rust/issue-6298-dataflow-graph-1, r=pcwalton...
[12:15:28] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:18:30] *** Joins: mdu (mdu@moz-9962C9F4.rev.numericable.fr)
[12:19:31] *** Quits: KindOne (KindOne@moz-9CC5F2DE.dynamic.ip.windstream.net) (Connection reset by peer)
[12:19:58] *** Joins: KindTwo (KindOne@moz-9CC5F2DE.dynamic.ip.windstream.net)
[12:20:04] *** Joins: cstrahan (cstrahan@moz-4C7E5789.hsd1.dc.comcast.net)
[12:21:14] *** KindTwo is now known as KindOne
[12:25:01] *** Joins: ssbr_ (ssbr@moz-6A5A684C.wireless.utoronto.ca)
[12:26:41] *** Quits: mdu (mdu@moz-9962C9F4.rev.numericable.fr) (Quit: mdu)
[12:33:01] *** Quits: ahsanulhaque (Adium@moz-5E74BAB7.banglalionwimax.com) (Ping timeout)
[12:34:12] *** Joins: samebchase (samuel@moz-7519FE69.net)
[12:38:16] *** Quits: cstrahan (cstrahan@moz-4C7E5789.hsd1.dc.comcast.net) (Ping timeout)
[12:38:44] <ssbr_> Eck, ugly code. Is there a better way of doing the following? "let (a, b) = foo(); c = a;"
[12:41:07] <tristram> rusti: let(a,_) = (1,2); a
[12:41:08] <rusti> 1
[12:41:40] <ssbr_> tristram: sure sure, but consider this:
[12:41:43] <dbaupp> rusti: fn f() -> (u8,u8) {(1,2)} let a,b; (a, b) = f(); (a,b)
[12:41:44] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/SQXe
[12:41:44] <ssbr_> rusti: let mut c = 1; if true {let (c, _) = (2, 3); }  io::println(fmt!("%d", c));
[12:41:46] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/RAaG
[12:41:54] <samebchase> Hello Everyone, Can someone please take a look at this: https://pastee.org/xx4j3 I'm basically trying to fill a LinearMap with the elements of a vector and its occurrences. element -> occurrences
[12:42:16] *** Joins: ahsanulhaque (Adium@moz-7FA7EEDA.banglalionwimax.com)
[12:42:29] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[12:42:33] <ssbr_> the problem is that let introduces a new variable, but I want to rebind an old variable
[12:42:53] <dbaupp> samebchase, try 'let count = occurences.get(&element) + 1; occurences.insert(element, count);'
[12:42:57] <aatch> ssbr_, then you need to make them mutable
[12:42:57] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[12:43:08] <ssbr_> aatch: sure, but that doesn't change that "let" won't rebind it
[12:43:23] <samebchase> dbaupp: cool. I'll try that
[12:43:39] <tristram> rusti: let mut c = 1; (c, _) = (2,3); c  // I don't think it'll work
[12:43:40] <rusti> foo.rs:5:28: 5:29 error: unexpected token: `_`
[12:43:40] <rusti> foo.rs:5          let mut c = 1; (c, _) = (2,3); c  // I don't think it'll work
[12:43:40] <rusti>                                      ^
[12:43:55] <tristram> rusti: let mut c = 1; (c, moo) = (2,3); c  
[12:43:57] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/OSjN
[12:44:09] <ssbr_> right. and then even if that did work, how would you deal with a pattern where some should be given new variables, and some should rebind?
[12:44:14] <aatch> you can't assign to patterns.
[12:44:22] *** Joins: mib_6az017 (Mibbit@moz-729859ED.contextvision.se)
[12:44:22] <samebchase> hmm... same error as before
[12:44:43] <ssbr_> I'll stick with "let (a, b) = f(); c = a"
[12:44:47] <ssbr_> then
[12:44:51] <aatch> ssbr_, why can't you rebind?
[12:44:56] <dbaupp> samebchase: using `match occurences.find_mut(&element) { Some(count) => count += 1, None => <something> }` might work better/be more efficient
[12:44:56] <kimundi> ssbr_: Yeah some things in pattern sadly dont compose so well
[12:45:05] <ssbr_> aatch: let doesn't do that
[12:45:05] <dbaupp> (give me a second to work out what <something> should be)
[12:45:17] <ssbr_> I have to rebind as a separate step
[12:45:33] <ssbr_> AFAIK
[12:45:53] <samebchase> dbaupp: I remember seeing something like 'fail()'
[12:46:05] <dbaupp> samebchase: sorry, `*count += 1`
[12:46:11] <kimundi> ssbr_: try c = tup.fst()
[12:46:30] <kimundi> or first()
[12:46:39] <ssbr_> kimundi: yeah, that'd work if I didn't need everything from the pattern :(
[12:46:43] <samebchase> dbaupp: https://github.com/mozilla/rust/issues/5982
[12:46:56] <kimundi> ah, tricky then
[12:47:09] <dbaupp> samebchase: that would fail any time a key didn't exist in the map... is that the correct behaviour at that point of the code?
[12:47:20] <dbaupp> samebchase: you're on rust 0.6?
[12:47:27] <samebchase> trunk
[12:47:32] <ssbr_> Well, not so tricky. Just an extra LOC. Although I don't like that I have to introduce a new variable that I might accidentally use instead
[12:47:49] <aatch> ssbr_, just prefix it with _
[12:47:51] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[12:48:20] <dbaupp> samebchase, master or incoming? because the flow-sensitive borrowck that niko was referring to on that issue has landed on incoming
[12:48:44] <dbaupp> (does it still not work?)
[12:48:58] <aatch> dbaupp, my implementation seems to work
[12:49:11] <dbaupp> aatch: no explosions?
[12:49:15] <aatch> Though my tests are quite trivial "does it function as a queue" tests
[12:49:21] <ssbr_> aatch: hmmmm. Other than telling rust not to worry about unused variables, do "_"-prefixed variables have any special meaning?
[12:49:26] <dbaupp>  /segfaults?
[12:49:31] <aatch> nope
[12:49:33] <ssbr_> it does make it obvious to me the human that I shouldn't be using it, of course :)
[12:49:35] <aatch> which is good.
[12:49:37] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Ping timeout)
[12:49:41] <ssbr_> Yes.
[12:49:51] <ssbr_> well, uhhhhh
[12:50:01] <aatch> ssbr_, just tells the compiler to ignore it.
[12:50:02] <ssbr_> rusti: let (a, a) = (1, 2)
[12:50:02] <rusti> foo.rs:6:4: 6:5 error: expected `;` but found `}`
[12:50:03] <rusti> foo.rs:6     });
[12:50:03] <rusti>              ^
[12:50:17] <aatch> Without it being a '_'
[12:50:17] <dbaupp> rusti: let (a, a) = (1, 2); a
[12:50:19] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/ebEE
[12:50:28] <ssbr_> rusti: let (_, _) = (1, 2); 1
[12:50:30] <rusti> 1
[12:50:36] <dbaupp> well that's a bit peculiar
[12:50:37] <ssbr_> sweet. It's all the best parts of prolog. ;)
[12:51:12] <ssbr_> Oh, nevermind, it's let*
[12:51:18] <ssbr_> well, that's OK too
[12:51:41] <ssbr_> (well, not let*. Something weird. But it's OK too.)
[12:51:42] <aatch> dbaupp, I'm gonna need to talk to brson though.
[12:51:47] <dbaupp> rusti: match (1i,2i) { (a,a) => a }
[12:51:49] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/dGFU
[12:52:03] <ssbr_> Oh dear, that's weird.
[12:52:07] <aatch> the existing scheduler code assumes that there is a push_front method
[12:52:20] <aatch> which defeats the point of this algorithm.
[12:52:24] <ssbr_> another let/match incongruence I guess.
[12:53:00] <dbaupp> ssbr_: yeah... it's getting annoying
[12:53:05] <ssbr_> rusti: match (1i,2i) { (_,_)) => 1 }
[12:53:05] <rusti> foo.rs:5:30: 5:31 error: incorrect close delimiter: `)`
[12:53:06] <rusti> foo.rs:5          match (1i,2i) { (_,_)) => 1 }
[12:53:06] <rusti>                                        ^
[12:53:12] <ssbr_> ugh
[12:53:14] <samebchase> dbaupp: turns out that I was using an older build of trunk, even though I built rust today. I just did a 'make install'
[12:53:15] <ssbr_> rusti: match (1i,2i) { (_,_) => 1 }
[12:53:17] <rusti> 1
[12:53:23] <ssbr_> OK, at least _ does work the right way
[12:53:37] <aatch> samebchase, did you checkout the incoming branch?
[12:53:37] <samebchase> I'll paste more code in a min.
[12:53:38] <dbaupp> ssbr_: I added another incongruence today :( https://github.com/mozilla/rust/pull/6385
[12:53:54] <ssbr_> dbaupp: stop that!
[12:54:11] <dbaupp> (an extremely unsound incongruence too... the let code basically sucks)
[12:54:23] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:54:23] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14bca0ab4 to 14fdf601e: 02http://git.io/N3iJvQ
[12:54:23] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:54:25] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[12:54:25] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/ORur-A
[12:54:25] <ghrust> 13rust/06auto 14646f16d 15Tim Chevalier: core: Make intrinsics::init unsafe...
[12:54:25] <ghrust> 13rust/06auto 14cd235d4 15Tim Chevalier: core: Make intrinsics::forget unsafe, too
[12:54:27] <ghrust> 13rust/06auto 14ca18ed8 15Tim Chevalier: testsuite: Test that init and forget are both unsafe
[12:54:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[12:54:32] <ssbr_> Why is let its own code? I would've expected it to be a special case of match that only works on unfalsifiable patterns
[12:54:34] <samebchase> aatch: I'm on master. Should I be on incoming?
[12:54:45] <ssbr_> or I guess maybe there's some weird scoping things
[12:55:03] <aatch> samebchase, if you want the borrow checker fixes, yes
[12:55:04] <kimundi> ssbr_: leqacy
[12:55:20] <dbaupp> PSA, don't use any pattern matching in let other than (a,b,...,c). It can do arbitrarily bad things.
[12:55:25] <samebchase> oh, I'll build the incoming branch then
[12:55:35] <aatch> samebchase, good idea :D
[12:55:39] <ssbr_> dbaupp: :(
[12:55:40] <dbaupp> samebchase: all development happens on incoming, master is (up-to) a month or more behind
[12:55:57] <ssbr_> I want my let ~ref x = y; that would be so great
[12:56:00] <aatch> And development recently has been screaming
[12:56:09] <ssbr_> (pff at &*)
[12:56:54] <dbaupp> ssbr_: I think you'd break your rust permanently with that let :P
[12:57:25] <dbaupp> rusti: let y = ~1; let ~ref x = y; fmt!("%?", x)
[12:57:27] <rusti> line longer than 150 columns, pastebinned: http://sprunge.us/BQbi
[12:57:51] <aatch> dbaupp, nice LLVM assertion!
[12:57:57] <Boreeas> What is the meaning of 'item' in "`use` and `extern mod` declarations must precede items"?
[12:58:05] <ssbr_> dbaupp: I noticed :(
[12:58:10] <kimundi> PSA: No need to put an fmt!("%?", value) at th end of a rusti request, it does that automatically
[12:58:13] <ssbr_> I tried it once and things exploded just as so
[12:58:22] <samebchase> aatch, dbaupp: thanks. :-) I'll try the new build and paste my results/errors, if any.
[12:58:35] <aatch> Boreeas, items are anything other than use and extern mod
[12:58:48] <aatch> so struct definitions, impl's, fns
[12:58:53] <dbaupp> aatch: it's an antique error https://github.com/mozilla/rust/issues/3874 :P
[12:58:57] <ssbr_> Boreeas: If you look at the rust manual, everything at the top level (other than ^) is an item; so fn declarations, mod declarations, enums, structs, etc.
[12:59:09] <kimundi> Boreeas: items are mod statements, function declarations, etc. basically the top level constructs in a rs file
[12:59:25] <aatch> `use` and `extern mod` are "view items"
[12:59:36] <dbaupp> kimundi: region pointers ;)
[13:00:11] <dbaupp> rusti: let y = ~1; let x: &int = y; x
[13:00:12] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/RNMa
[13:00:21] <kimundi> dbaupp: Ah, right. The way strcat implemented it that would be necessary.
[13:00:31] <kimundi> Nevermind then :)
[13:01:11] <Boreeas> So the error is telling me that I can't have source files that only contain imports?
[13:01:33] <kimundi> Boreeas: No, it just means you have to follow an order
[13:01:41] <aatch> Boreeas, no, it's saying that all of your `use`s need to come first
[13:01:45] <ssbr_> Boreeas: it's telling you that you put your `use` or `extern mod` declarations too late in the file; they should be the first things
[13:01:56] <ssbr_> too late in the module, rather
[13:02:08] <kimundi> wich comes first extern mod or use?
[13:02:12] <dbaupp> Boreeas: the order is "extern mod; use; mod(?) everything else"
[13:02:29] *** Quits: mib_6az017 (Mibbit@moz-729859ED.contextvision.se) (Quit: http://www.mibbit.com ajax IRC Client)
[13:02:29] <aatch> dbaupp, after use it's a free-for all
[13:02:42] <dbaupp> aatch: ok, thought so
[13:02:46] <ssbr_> has anyone considered switching the order of use and extern mod :(
[13:02:56] <Boreeas> Huh. It seems weird to use "use" before "mod".
[13:02:59] <aatch> in fact, the only reason for the ordering is to match shadowing
[13:03:07] <kimundi> Boreeas: That also means that it gets funky with module intern uses: 'use foo; mod foo { ... }'
[13:03:11] *** Joins: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net)
[13:03:18] *** Quits: RMF (RMF@moz-A559AD33.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[13:03:25] <aatch> (and I answered Boreeas's and ssbr's questions at once)
[13:03:29] <dbaupp> Boreeas: i agree... I always smile a bit at importing from the future ;)
[13:03:35] *** bhearsum|afk is now known as bhearsum
[13:03:53] <kimundi> ssbr_: The order has been choosen because itmes shadow uses. But I'm not happy with how it looks in practice either
[13:04:14] <aatch> Fortunately, you don't often use extern mod
[13:04:32] <aatch> extern mod std; // rest of code
[13:04:37] <kimundi> But you often use mod, and there it looks strange :(
[13:04:56] <ssbr_> The issue I had was that I wanted to be able to do "extern mod { fn foo(a: SomeType) -> SomeOtherType }", where SomeType or SomeOtherType were defined by my code
[13:04:59] <ssbr_> or something like that
[13:05:03] <ssbr_> but that's impossible as far as I know
[13:05:17] <ssbr_> since you can't declare a type beforehand, and you can't use it from somewhere defined elsewhere
[13:05:20] <kimundi> ssbr_: extern mod doesn'T work like that
[13:05:33] <aatch> ssbr_, extern mod isn't a thing you can do anymore (I think)
[13:05:39] <kimundi> ssbr_: That use of extern mod is deprectaed, no idea what It used to mean
[13:06:00] <aatch> kimundi, used to be for exporting rust code with a C abi
[13:06:06] <aatch> Or something like that
[13:06:30] <kimundi> ssbr_: Only legal things are 'extern mod foo;', 'mod foo;' and 'mod foo { ... }' afaik. And there is also just 'extern { ... }' I think
[13:06:34] <ssbr_> importing C code with a C ABI
[13:06:41] <ssbr_> and it's legal in rust 0.6 man
[13:06:53] <ssbr_> but OK; given that, my complaint no longer has any meaning
[13:06:58] <kimundi> ssbr_: The manual is outdated ;)
[13:07:07] <aatch> kimundi, 0.6 is outdated
[13:07:18] <ssbr_> I think the manual is also outdated, aside from 0.6
[13:07:29] <aatch> but in incoming, you can do extern mod foo { } at all.
[13:07:32] <ssbr_> well, it's good anyway
[13:07:39] <aatch> pcwalton killed it.
[13:07:40] <ssbr_> extern mod foo {...} was broken / useless because of this
[13:08:01] <dbaupp> aatch: s/killed/is killing/
[13:08:18] <dbaupp> 5th on bors' queue
[13:08:25] <aatch> dbaupp, meh, he's landing the patch, it counts as done.
[13:08:31] <kimundi> Undead syntax features! Beware! BEWARE!
[13:08:33] <aatch> (assuming it passes)
[13:08:55] <aatch> pcwalton's been on a bit of a rampage recently
[13:09:27] <samebchase> Are there instructions anywhere to help me build rust using ccache?
[13:09:33] <dbaupp> kill old things?
[13:09:35] <aatch> samebchase, on the wiki
[13:09:43] <samebchase> okay I'll take a look
[13:10:13] <dbaupp> samebchase: https://github.com/mozilla/rust/wiki/Note-ccache
[13:10:37] <aatch> bah! dbaupp making me look bad.
[13:11:02] <dbaupp> aatch: clearly I'm the better person :P
[13:12:16] <dbaupp> aatch: going back a bit, is the push_front method required? or is it just using that instead of push_back?
[13:12:23] *** Joins: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP)
[13:12:47] <aatch> dbaupp, I'm not sure. both push_back and push_front are used
[13:13:01] <aatch> it seems to be a way to get a task to run next
[13:13:08] *** Quits: ysuzuki (ysuzuki@moz-A563888C.ics.keio.ac.jp) (Client exited)
[13:14:25] <dbaupp> ah
[13:14:41] <dbaupp> so it's not (necessarily) a trivial fix
[13:14:52] <aatch> dbaupp, exactly
[13:15:24] <aatch> but it might not be necessary, so I need to talk to brson
[13:15:39] <dbaupp> what timezone's he in?
[13:15:55] <aatch> US Pacific I think
[13:16:08] *** Joins: BitPuffin (quassel@moz-8370D1B9.bredband.comhem.se)
[13:16:24] <aatch> So he's like 20 hours behind me
[13:17:35] <dbaupp> or 4 hrs - 1 day ahead
[13:18:18] *** Joins: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[13:18:18] *** ChanServ sets mode: +o pcwalton
[13:18:19] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Quit: .)
[13:18:24] <aatch> meh
[13:18:52] <dbaupp> hehe :P
[13:19:00] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[13:20:54] *** Joins: thelivingded (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:24:23] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:24:31] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:24:40] <ssbr_> Is there any trick to using gdb with rust? I don't see a -g option to rustc, and running gdb on the test harness executable doesn't appear to let me step through rust code
[13:24:42] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:25:20] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:25:24] <bstrie> ssbr_: is -g for debuginfo?
[13:25:28] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:25:29] *** Quits: thelivingded (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:25:34] <bstrie> because I think there's a flag hiding under -Z for that
[13:25:39] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:25:52] <ssbr_> bstrie: if I remember my cc arguments right (I probably don't)
[13:25:57] <bstrie> no idea about running gdb on the test harness
[13:26:05] <bstrie> usually it's just `gdb foo`
[13:26:19] <bstrie> for me at least, but I'm no gdb expert
[13:26:27] <ssbr_> right, I assume that'd work where foo is the test harness as well as if foo is an executable
[13:26:29] <ssbr_> although maybe not
[13:26:37] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:26:39] <ssbr_> I don't have much interest debugging things that aren't encoded as test cases...
[13:26:58] <ssbr_> -Z debug-llvm, you think?
[13:27:09] <dbaupp> bstrie: debug-info was (and probably still is?) broken
[13:27:13] *** Joins: zakora (NC@moz-8EAF945F.fbx.proxad.net)
[13:27:18] <ssbr_> Oh. Well then.
[13:27:33] <ssbr_> I'll just use more io::println
[13:27:58] <aatch> println debugging is a time-honored tradition
[13:28:05] <dbaupp> ssbr_: yup :( you can step through assembler, but that's basically your only option
[13:28:25] <ssbr_> dbaupp: sad panda.
[13:28:53] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:28:56] <aatch> pad sander
[13:29:01] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:29:12] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:29:40] <ssbr_> It's kind of exciting that rust is so great and yet so incomplete
[13:29:58] <ssbr_> It's cool that I can take two steps in any direction and find something to do.
[13:30:03] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:30:03] <ssbr_> (to help.)
[13:30:14] <aatch> ssbr_, same
[13:30:20] * ssbr_ is writing a list of things he might want to fix
[13:30:25] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:30:33] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:30:44] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:30:45] <Sodel_the_V> ssbr_: It'd probably be pretty useful if you eventually posted that list online somewhere.
[13:30:47] *** Quits: quvarxa (chatzilla@moz-AEA6914D.lns21.adl2.internode.on.net) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130506154904])
[13:31:01] <Sodel_the_V> ssbr_: What you don't get to, someone else might!
[13:31:06] <ssbr_> Sodel_the_V: I wouldn't want it to be taken the wrong way
[13:31:08] <dbaupp> Sodel_the_V: but then ssbr_ doesn't get the pleasure of fixing it!
[13:31:20] <ssbr_> There's also the kinds of people that write lists about things that could be better, but in bad faith
[13:31:41] <Sodel_the_V> Mmm, good point.
[13:31:55] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:32:32] *** Joins: trapni (trapni@moz-6A0EA166.dawanda.com)
[13:33:23] <dbaupp> Python just got (C-style) enums
[13:33:44] <dbaupp> https://news.ycombinator.com/item?id=5685903
[13:34:07] <aatch> dbaupp, maybe they'll have variant enums by 2060!
[13:34:18] <ssbr_> They bikeshedded that proposal for like a year on the ML
[13:34:26] <ssbr_> they'll never get ML-style enums
[13:34:39] <ssbr_> uh, two different ML (mailing list, ML-the-language)
[13:36:19] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:36:27] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:36:38] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:37:31] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:37:49] <aatch> I do like how the PEP number for that one is an anagram of it's predecessor 354 -> 435
[13:38:06] *** Joins: thelivingded (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:38:31] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:38:39] *** Joins: jviereck (Adium@moz-340574DC.dclient.hispeed.ch)
[13:39:49] <ssbr_> Is there a way to only run one particular test case?
[13:39:57] *** Joins: ksev (DrunkenPan@5688B28D.841F5BFE.B9B3705E.IP)
[13:40:20] <ssbr_> I'm actually not sure of the terminology here -- I have a single function annotated with #[test], which demonstrates a problem. I only want to run that test case (so as to not get so much noise from my printlns)
[13:40:36] *** Joins: cstrahan (cstrahan@12405AA6.ED659C99.2C87C8BD.IP)
[13:40:54] <dbaupp> ssbr_: yes, ./test-executable foo will only run test than have foo in the name
[13:41:08] <ssbr_> dbaupp: aha, thank you
[13:41:49] <bstrie> is it weird to anyone else that python's enumerators are iterable?
[13:41:55] *** Quits: ksev (DrunkenPan@5688B28D.841F5BFE.B9B3705E.IP) (Ping timeout)
[13:42:22] <Sodel_the_V> Whaaaa?
[13:42:54] <bstrie> >>> class Shake(Enum):
[13:42:54] <bstrie> ...   vanilla = 7
[13:42:54] <bstrie> ...   chocolate = 4
[13:42:58] <bstrie> >>> for shake in Shake:
[13:42:59] <bstrie> ...   print(shake)
[13:43:23] <bstrie> ^ like, there's no instance there, you're just iterating over a class, which feels weird to me
[13:43:46] <Sodel_the_V> Weeeird
[13:43:52] <bstrie> unless this is already possible and I'm just oblivious
[13:43:54] <ssbr_> it's not that weird from a python perspective
[13:44:04] <ssbr_> bstrie: it's possible with metaclasses
[13:44:10] <ssbr_> (define an __iter__ on the metaclass)
[13:44:13] <bstrie> ok, I've never used those
[13:44:19] <bstrie> that does makes sense though
[13:44:37] <bstrie> I'm curious if the implementations is going to be pure python
[13:45:12] <ssbr_> namedtuple is, so I don't see why not
[13:45:50] * aatch is running the tests, his computer is not happy about this.
[13:45:50] *** kimundi is now known as zz_kimundi
[13:46:54] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:47:02] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:47:12] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:47:53] *** Quits: thelivingded (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:47:55] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:47:58] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[13:48:03] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:48:14] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:49:06] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:51:24] *** zz_kimundi is now known as kimundi
[13:53:18] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:53:26] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:53:37] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:54:06] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[13:54:31] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:55:02] *** Joins: thelivingded (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:55:29] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:55:30] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:55:37] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[13:55:48] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[13:57:01] *** Quits: thelivingded (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[13:57:44] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Ping timeout)
[13:59:14] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[13:59:20] *** Quits: Excureo (c@moz-DE8C33F1.static.yakm.wa.charter.com) (Ping timeout)
[13:59:23] *** Joins: Excureo (c@moz-DE8C33F1.static.yakm.wa.charter.com)
[13:59:52] <aatch> dbaupp, I got a segfault!
[14:00:34] <engla> python's namedtuple was implemented using eval() last I saw
[14:00:41] *** Joins: ysuzuki (ysuzuki@moz-4E096651.au-net.ne.jp)
[14:00:41] <jack> nmatsakis: with the new borrow check landed i've been cleaning up servo. this code still fails: `self.clump.reset(self.clump.end(), 0)`
[14:00:53] <dbaupp> aatch: oh, exciting! :D
[14:01:04] <engla> bstrie: types are objects too in Python so there is an instance.
[14:01:10] <dbaupp> do you know the problem?
[14:01:23] <aatch> I think it's a double free
[14:01:31] <aatch> I'm investigating.
[14:02:35] <ssbr_> engla: Yes, but that's because Raymond Hettinger is a little loony
[14:02:39] <ssbr_> he did it for "performance reasons"
[14:03:24] <samebchase> I'm now using the build of the incoming branch. https://pastee.org/drr7u What should the first line be changed to?
[14:03:24] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Connection reset by peer)
[14:03:37] *** Quits: ysuzuki (ysuzuki@moz-4E096651.au-net.ne.jp) (Client exited)
[14:03:38] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[14:03:49] <aatch> core::hashmap::HashMap
[14:04:05] <dbaupp> engla: wow, it is! https://github.com/jonashaag/cpython/blob/master/Lib/collections/__init__.py#L235 (specifically, https://github.com/jonashaag/cpython/blob/master/Lib/collections/__init__.py#L363)
[14:04:30] <engla> dunno, that part of Python is pretty consistent.  The best part is that 'type' is an instance of 'object' and vice versa
[14:04:36] <samebchase> aatch: same error
[14:05:14] <dbaupp> samebchase, you'll need to remove the *-0.6.so files where ever they get installed to
[14:05:34] <samebchase> manually?
[14:05:52] *** Joins: darkf (darkf@moz-F9058B8A.net)
[14:05:54] <dbaupp> if you're on linux /usr/local/lib/rustc/<arch>/lib
[14:05:58] <dbaupp> samebchase: yup
[14:06:02] <samebchase> okay
[14:06:42] *** Quits: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr) (Quit: pyrac)
[14:06:44] <darkf> hi - I get "Makefile:124: /home/darkf/rust/mk/platform.mk: No such file or directory" (among other .mks) when trying to make on Windows/msys, but the files clearly exist. What's wrong here?
[14:07:13] <engla> one thing to learn from Python's mistakes is don't put unrelated things in the same module. Might seem fine with the first exception but then you add on to your std lib
[14:07:19] *** Quits: KindOne (KindOne@moz-9CC5F2DE.dynamic.ip.windstream.net) (Ping timeout)
[14:07:34] *** Quits: ahsanulhaque (Adium@moz-7FA7EEDA.banglalionwimax.com) (Quit: Leaving.)
[14:07:35] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[14:07:45] <bstrie> darkf: what version of msys do you have?
[14:07:53] <samebchase> dbaupp: nice. It works. :-)
[14:07:57] <bstrie> iirc rust only targets a very specific version
[14:08:13] <darkf> bstrie: well from the directory I'm guessing \msys\1.0 :)
[14:08:19] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:08:26] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[14:08:31] <Sodel_the_V> In the compiler source, are `substs` only used for type parameters? That's the impression I'm getting.
[14:08:37] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:08:47] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:09:01] <aatch> Sodel_the_V, I thought it covered type aliases too?
[14:09:24] <bstrie> darkf: have you read https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust#3-quick-steps-for-environment-setup
[14:09:30] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[14:09:41] <Sodel_the_V> aatch: Ah yes. Thanks.
[14:10:07] *** Joins: thelivingded (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:10:27] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:10:34] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[14:10:35] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[14:10:45] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:11:54] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:11:55] <darkf> bstrie: hm, well I don't think having a later GCC would cause makefiles to not work, would it? :) maybe slightly older msys? (which is weird because it isn't *that* old)
[14:12:00] *** Quits: thelivingded (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[14:12:02] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[14:12:13] *** Joins: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:12:32] <dbaupp> aatch: is it a double free?
[14:12:41] <aatch> dbaupp, nope
[14:12:42] *** Joins: KindOne (KindOne@5CB1B25D.B11A32F.EC6A1518.IP)
[14:12:50] <aatch> dangling allocations
[14:12:58] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[14:13:15] <aatch> or at least, that's what I get from the tests I've just done.
[14:14:44] <bstrie> darkf: I can't say, I ain't a windows expert :) also, are you on a 64-bit machine? because last I checked rust only supported 32-bit when on windows
[14:14:54] <bstrie> wonder if that's changed yet
[14:14:56] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:15:04] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Connection reset by peer)
[14:15:15] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[14:15:37] <aatch> Hmm, I think that using uninit is the issue
[14:15:45] <aatch> I'm trying init() instead
[14:15:59] *** Quits: thelivingdedx (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[14:16:03] <ssbr_> I feel pretty dumb. I wrote a lexer for regexps, and then I ended up deleting everything I wrote.
[14:16:28] *** Joins: skchrko__ (sk@61A494B3.BA40E8A.AAC02D62.IP)
[14:16:28] *** Quits: skchrko_ (sk@61A494B3.BA40E8A.AAC02D62.IP) (Connection reset by peer)
[14:16:28] <aatch> ssbr_, isn't that how everybody writes code?
[14:16:31] <ssbr_> it turns out there's no real advantage when you're writing a LL(1) parser by hand anyway.
[14:16:47] <ssbr_> aatch: yes, but doesn't it feel terrible every time?
[14:17:01] <aatch> No, feels cathartic
[14:17:20] <ssbr_> OK, there's "deleting code because I can simplify it", and "deleting code because that was stupid"
[14:17:30] <ssbr_> the former is cathartic, the latter is me hitting myself on the head
[14:17:48] <darkf> bstrie: yeah I'm on 64-bit - that's strange because I compiled rust last year and it worked
[14:18:11] <darkf> and it probably *should* build for 32-bit
[14:18:20] <aatch> darkf, are you using 64 bit mingw?
[14:18:31] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[14:19:16] <darkf> IIRC I used the msys-get installer, so I don't know - but gcc -v gives Target: mingw32 (as opposed to mingw64 whatever), so I don't think so
[14:20:15] <dbaupp> aatch: i see...
[14:20:18] <aatch> I dunno.
[14:21:29] <Sodel_the_V> I'm working on trait object method lookup, specifically auto coercion from e.g. @Teait to &Trait. Is setting substs.self_ty to a ty_trait the appropriate way to do that?
[14:21:30] <aatch> dbaupp, I think my assumptions about how rust handles data wer flawed, so I'm gonna head to bed because it's far too late for an excursion into the runtime
[14:21:58] *** aatch is now known as aatch|bed
[14:22:03] <Sodel_the_V> s/Teait/Trait
[14:22:06] <bstrie> darkf: very weird, I've never heard of anyone getting windows rust to work on 64-bit hardware, maybe nobody had tried using 32-bit mingw? seems odd that it would just work by accident, though
[14:22:10] <dbaupp> aatch: yes, it's late here, so it must be really late there... g'night :)
[14:22:56] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[14:23:09] <darkf> bstrie: yep. I think that was with 0.2, 0.3 and 0.4. I never had issues there beyond some runtime problems, and I can't get the rust binaries to work either, so this is fun!
[14:23:26] <Sodel_the_V> whois nmatsakis
[14:23:36] <Sodel_the_V> Whoops
[14:23:51] <Sodel_the_V> Must be tired. Sheesh.
[14:24:54] <darkf> bstrie: I am quite annoyed that it fails to include a file that doesn't exist though :( I don't like make
[14:25:15] <darkf> er, does exist
[14:25:40] <darkf> maybe I will try tomorrow with gcc 4.6 or something
[14:25:40] <jack> is there some reason breaking on rust_task_fail doesn't work?
[14:25:43] <bstrie> pauls_: re: the macro delimiter discussion from yesterday (parens vs braces around macro invocations), I just realized: you *can* use either () or {}, but *only* with item macros :)
[14:25:55] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[14:26:19] <bstrie> darkf: yes, we're hoping to transition away from make once our built-in package manager is mature enough
[14:26:35] *** Joins: akashj87 (akash@8F911EC2.F644F425.35E3DDC8.IP)
[14:26:39] <bstrie> though it remains to be seen if it will be powerful enough to handle building a bootstrapping compiler
[14:27:10] <darkf> excellent :) ha, i would hope it works!
[14:27:58] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[14:28:53] <ssbr_> bstrie: you've never heard of anyone using rust in 64 bit windows?
[14:29:00] <bstrie> no, never
[14:29:01] <bstrie> never ever
[14:29:04] <bstrie> I thought it was impossible
[14:29:08] <bstrie> at this juncture
[14:29:10] <ssbr_> I downloaded and used the 32 bit rust on my 64 bit windows
[14:29:19] <darkf> witch, burn him!
[14:29:23] <bstrie> can you build rust from source?
[14:29:30] <ssbr_> bstrie: it failed with mysterious errors
[14:29:37] <darkf> ssbr_: what errors?
[14:30:00] <ssbr_> darkf: sorry, don't have them memorized offhand, and I'm away from my windows computer. If you show me what you're getting, I might be able to tell you if that's what I had.
[14:30:41] <darkf> ssbr_: I am getting "Makefile:124: /home/darkf/rust/mk/platform.mk: No such file or directory" despite the file existing.
[14:30:42] <ssbr_> is everyone from #python moving to rust now?
[14:30:57] <ssbr_> darkf: Sorry, that doesn't ring any bells :(
[14:31:00] <darkf> nah, I occasionally come here to try Rust, and then fail due to some Windows bug
[14:31:04] <ssbr_> (not that it'd help you much either way)
[14:31:11] <ssbr_> darkf: I recommend trying the prebuilt binary
[14:31:12] *** Quits: true_droid (Adium@moz-123FD9B8.beck.volia.net) (Quit: Leaving.)
[14:31:15] <ssbr_> rust 0.6 isn't that bad
[14:31:17] <ssbr_> sort of.
[14:31:27] <ssbr_> (there's apparently some more recent snapshots as well?)
[14:31:45] <darkf> ssbr_: I have - it has a runtime error, but that may well be because I am using GCC 4.7. (Why doesn't that work on 4.7? I don't know :|)
[14:32:05] <ssbr_> Doop.
[14:32:15] <ssbr_> darkf: uh, so, linux VMs...
[14:32:41] <bstrie> darkf: even if your more-recent GCC isn't causing the error, you'd probably have to downgrade anyway in order to get rust to work. so it couldn't hurt to downgrade and then try again
[14:32:42] <darkf> ssbr_: heh, what's the fun in that? :)
[14:32:57] <darkf> bstrie: will do later
[14:33:11] <ssbr_> darkf: using rust is definitely more fun than not using rust
[14:33:16] <darkf> I'll have to see if you can separate msys instances
[14:33:43] <darkf> ssbr_: I dunno man, its pointers make me feel like I'm a 10 year old learning C++
[14:34:14] <ssbr_> darkf: in fairness, I think all the pointer types do come from C++
[14:34:14] <darkf> I haven't used 0.6 but 0.5's explicit moving certainly was a headache
[14:34:24] <ssbr_> implicit moving is also a headache
[14:34:57] <ssbr_> I wonder if explicit pointer management in the style of rust can reduce bugs, or if it's only a benefit to performance?
[14:35:01] <darkf> this is probably why I eagerly await 1.0
[14:35:12] <ssbr_> darkf: you can also use managed pointers everywhere
[14:35:23] <ssbr_> in which case it's like OCaml but with more sigils
[14:35:31] <darkf> ssbr_: don't I have to worry aout stdlib stuff taking in owned pointers then?
[14:35:35] <darkf> (or & pointers)
[14:35:47] <ssbr_> darkf: @ pointers can be casted to & pointers
[14:35:52] <cyndis> i love implicit moves..especially after doing moves in c++11
[14:35:57] <darkf> on indeed
[14:36:01] <ssbr_> for ~, well, those only happen for good reasons
[14:36:09] <ssbr_> I think
[14:36:09] <bstrie> ssbr_: it should abet both correctness and performance
[14:36:28] <ssbr_> bstrie: yeah, that was my feeling too, but I hadn't thought too deeply about it.
[14:36:32] <darkf> ssbr_: well, IMO OCaml is much clearer since there is only one `ref` type and it is really clearly marked. Rust draws in a lot from C++ 
[14:36:46] <ssbr_> The feeling of moving from C to Rust for memory management, is a lot like moving from Python to Haskell for types
[14:36:53] <ssbr_> so I want to believe it has the same result, too
[14:37:16] <ssbr_> darkf: ref is for mutable boxes, not for pointers
[14:37:25] <ssbr_> well. but pointers are also a kind of mutable box, when they're mutable.
[14:37:27] <ssbr_> Well.
[14:37:37] <ssbr_> darkf: anyway yes, Rust is definitely more complex than OCaml in this respect
[14:38:08] <ssbr_> (on the plus side, Rust has traits, and OCaml has a demented object system that's semi-useless)
[14:38:10] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[14:38:21] <ssbr_> but there is a sort of shared feeling between them anyway
[14:38:30] * bstrie wonders if ocaml stands for "objective caml"
[14:38:50] <bstrie> it does! delightful
[14:38:50] <ssbr_> bstrie: it used to. Now it just stands for ocaml.
[14:38:59] <darkf> well, on the bright side, once the Windows issues are cleared up (heh), Rust should be *nicer* to use than OCaml. It only took me 2 hours to compile rust-sdl! I couldn't get sdl-ocaml to even compile!
[14:39:12] <ssbr_> darkf: hahaha :)
[14:39:51] <bstrie> I propose that "Rust" become an acronym for "Rust ust st t"
[14:40:02] *** kimundi is now known as zz_kimundi
[14:40:04] <ssbr_> I second this proposal
[14:40:13] <darkf> I don't get this proposal
[14:40:20] *** zz_kimundi is now known as kimundi
[14:40:30] <ssbr_> kimundi: having trouble sleeping? ;)
[14:40:47] <darkf> presumably splitting into tails
[14:42:38] <ssbr_> god regexp syntax is so stupid. '{12' parses fine, '{12}' does not, because the former is an incomplete quantifier (which parses fine), and the latter is a complete quantifier on nothing. Whereas '[ab' fails because it's an incomplete character class. There is this demented and baffling notion of error handling, where sometimes you bonk, and sometimes you try to parse it as text.
[14:42:54] <ssbr_> and there's no real rhyme or reason to it.
[14:44:44] <bstrie> ssbr_: are you saying that regexes aren't themselves regular? :)
[14:44:51] <darkf> oh snap
[14:45:11] <kimundi> ssbr_: Sleeping? It's 5 pm here :)
[14:45:16] <ssbr_> bstrie: they aren't regular in any sense
[14:45:16] <darkf> oh I just got the backronym I'm dumb
[14:45:22] <ssbr_> kimundi: no wonder you're having trouble getting to bed
[14:45:28] <bstrie> darkf: haha
[14:45:42] <ssbr_> kimundi: (what does zz_kimundi mean then?)
[14:45:45] <darkf> in my defence, it's 8am and i should sleep
[14:46:16] <ssbr_> man, you're up late.
[14:46:19] <kimundi> ssbr_: THat propagates to here? Urgh... I thought that's just what anchat does if it looses connection to my bouncer...
[14:46:25] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:46:34] <ssbr_> kimundi: eep :)
[14:46:34] <bstrie> kimundi must have that one condition, whassit called.. necrophilia? nepotism?
[14:46:37] <ssbr_> (yes, it does)
[14:46:37] * kimundi looks how to disable it
[14:47:01] <darkf> bstrie: insomnia?
[14:47:07] <bstrie> narcolepsy, that's it
[14:47:10] <darkf> ha
[14:48:12] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[14:48:25] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[14:48:27] <darkf> ok i have to sleep then - goodnight everyone :)
[14:48:56] <bstrie> good night
[14:49:02] <Sodel_the_V> G'night!
[14:49:08] <ssbr_> Good night
[14:50:34] <kimundi> Okay I have no idea how to disable that nickname change... Don't see an option for it in andchat...
[14:50:47] *** Quits: z0w0 (zack@D1D2DBCB.806EA3ED.2CE63F58.IP) (Quit: Leaving.)
[14:51:42] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[14:51:43] <bstrie> kimundi: permanently change your name to zz_kimundi, that'll solve it :)
[14:52:03] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[14:52:15] <ssbr_> or maybe we'll have zz_zz_kimundi
[14:52:15] <kimundi> bstrie: I think that will just elevate the problem to zz_zz_kimundi xD
[14:52:27] <bstrie> hm, good point
[14:52:29] <bstrie> ok, new plan
[14:52:40] <bstrie> figure out what the maximum allowed nick length is
[14:52:46] <bstrie> and pad your nick out to that
[14:52:48] <sp3d> take maxlen (cycle "zz_")
[14:52:52] <bstrie> kimundi_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
[14:52:59] <ssbr_> Oh damn it.
[14:53:02] <bstrie> then when it tires to rename you it will fail
[14:53:08] <ssbr_> I should've kept the lexing step. This isn't possible without it. Derrrrr.
[14:53:08] <kimundi> but... that would result in zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_zz_....
[14:53:23] <sp3d> max length is usually around 30 chars
[14:53:27] <bstrie> a small price to pay for... whatever we were attempting to achieve here.
[14:53:31] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[14:53:40] <sp3d> the fixed point of the kimundi's-client function
[14:54:31] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[14:54:54] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[14:59:10] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Quit: Lost terminal)
[14:59:59] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[15:03:11] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[15:05:29] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[15:06:34] <ssbr_> Egh, is there some convenient way to get an external &'foo Iterator<char> from a &'foo str ?
[15:06:59] <dbaupp> doesn't char_iter (?) work?
[15:07:12] <dbaupp> (a method)
[15:07:51] <ssbr_> I don't see that in http://static.rust-lang.org/doc/core/str.html
[15:08:17] <dbaupp> ssbr_: https://github.com/mozilla/rust/blob/incoming/src/libcore/str.rs#L2537
[15:08:39] <dbaupp> (the docs are behind, I guess)
[15:08:48] <ssbr_> That looks like it should work.
[15:08:53] <ssbr_> But I guess that isn't in 0.6?
[15:09:26] <dbaupp> yes
[15:09:33] <kimundi> ssbr_: Are you running 0.6?
[15:09:41] <ssbr_> kimundi: yeah, it was convenient...
[15:09:47] <ssbr_> (lets me dev on both windows and linux)
[15:10:31] <kimundi> He, yeah. I just gave up on windows for rust development, have a vm just because of rust.
[15:10:40] <ssbr_> I can't do that
[15:10:48] <ssbr_> for whatever reason, virtualbox is incredibly slow on my machine
[15:10:53] <ssbr_> building LLVM takes 22 hours
[15:11:04] <kimundi> ufgh :)
[15:11:14] <kimundi> urgh*
[15:11:48] <kimundi> Not enough ram?
[15:11:50] <bstrie> forget the VM, dual booting is really easy :)
[15:12:14] <ssbr_> bstrie: well, the point of windows for me is being able to easily switch between video games and work
[15:12:30] <ssbr_> you know, for when my code is compiling
[15:12:43] <bstrie> ssbr_: for me, *not* being able to easily switch between video games and work is the point of dual-booting :) but steam for linux is slowly killing me
[15:12:45] <ssbr_> (or for when I don't feel like working)
[15:13:14] <dbaupp> ssbr_: well you get at least 22 hrs of games with incoming :P
[15:13:15] <ssbr_> bstrie: I guess the trick is to get a computer with a terrible graphics card, and develop a taste in AAA games maybe?
[15:13:16] <bstrie> "hmm... I should go work on rust... or, I could play tf2"
[15:13:36] <ssbr_> or maybe you can switch to developing on BSD
[15:13:39] <bstrie> haha
[15:13:40] <ssbr_> or even MINIX!
[15:13:40] <kimundi> bstrie: I actually tried to switch to linux last week, the problem was... Apparently no desktop environment supports a vertical taskbar that works like in win7 :(
[15:13:51] <bstrie> keep shifting to ever-obscurer operating systems
[15:13:59] <bstrie> to escape the onslaught of video game delights
[15:14:02] <ssbr_> exactly
[15:15:11] <kimundi> He, sadly I don't need videeo games to procrastinate... Access to a webbrowser is more than enough...
[15:16:01] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[15:16:14] <ssbr_> right, so, MINIX
[15:16:18] *** Parts: bhearsum (bhearsum@moz-FBAE94.members.linode.com) ()
[15:16:19] <ssbr_> it doesn't have web browsers either
[15:16:48] <ssbr_> (but can rust compile without threads?)
[15:17:22] <bstrie> ssbr_: pffft, you think rust even attempts to compile concurrently? you silly
[15:17:36] <kimundi> rusti: if true {fail!("static");}
[15:17:37] <ssbr_> I was more worried that std depended on threads or something
[15:17:37] <rusti> rust: task failed at 'static', foo.rs:4
[15:17:38] <rusti> rust: domain main @0x14561b0 root task failed
[15:17:59] <kimundi> rusti: if true {let x = ~"owned"; fail!(x);}
[15:18:00] <rusti> rust: task failed at 'owned', foo.rs:4
[15:18:00] <rusti> rust: domain main @0x23051b0 root task failed
[15:18:16] <kimundi> rusti: if true {let x = ~"owned"; let x: &str = x; fail!(x);}
[15:18:18] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/ONMK
[15:18:27] <dbaupp> ssbr_: I think there are two threads spawned for each rust program always at the moment
[15:18:55] <ssbr_> dbaupp: that would do it.
[15:19:02] <ssbr_> OK, so MINIX isn't an option yet, but... :)
[15:20:17] *** Joins: FrozenCow_ (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[15:20:17] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Connection reset by peer)
[15:23:24] *** Joins: blitter (blitter@moz-7C98731E.dyn.centurytel.net)
[15:24:45] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[15:24:48] *** Quits: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net) (Ping timeout)
[15:26:42] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[15:27:03] *** Joins: reedlepee (Mibbit@B0086DF7.8853942F.411C023F.IP)
[15:27:27] <reedlepee> hi
[15:27:50] <jdm> hey
[15:32:14] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[15:33:08] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[15:33:20] *** Quits: reedlepee (Mibbit@B0086DF7.8853942F.411C023F.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:35:48] *** Quits: FrozenCow_ (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[15:35:49] *** Joins: mdu (mdu@moz-9962C9F4.rev.numericable.fr)
[15:36:51] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[15:37:49] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[15:38:25] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[15:38:56] *** Joins: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net)
[15:41:12] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[15:43:43] *** Quits: fabiand (fabiand@moz-946E65F8.adsl.alicedsl.de) (Quit: Verlassend)
[15:43:45] <nmatsakis> jack: yes, I didn't get to nested method calls. those are extremely tricky to get right.
[15:43:49] <nmatsakis> jack: there's an issue open on it
[15:43:53] <nmatsakis> Sodel_the_V: ping
[15:44:25] <Sodel_the_V> Sodel_the_V: pong
[15:44:43] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[15:44:44] <nmatsakis> Sodel_the_V: looking for me?
[15:45:39] <Sodel_the_V> nmatsakis: I managed to answer my own question. :-) I didn't know if `substs` was the right way to do coercion.
[15:45:47] <Sodel_the_V> (It is not.)
[15:45:50] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[15:46:08] <nmatsakis> Sodel_the_V: ok. Sorry, I haven't had a chance to check out your branch, do you want me to take a look at some point?
[15:46:47] <Sodel_the_V> nmatsakis: No worries. I'd appreciate it, whenever you get the chance.
[15:47:15] <Sodel_the_V> I'm doing a bit of work on it today, now that I have a better understanding of some things.
[15:49:30] *** Joins: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP)
[15:50:42] <nmatsakis> Sodel_the_V: send me the link again?
[15:51:04] <Sodel_the_V> nmatsakis: https://github.com/mozilla/rust/issues/5762
[15:52:01] <Sodel_the_V> The most recent commit is the only relevant one.
[15:52:31] <nmatsakis> Sodel_the_V: thanks.
[15:53:19] <Sodel_the_V> nmatsakis: np :-)
[15:53:21] *** Joins: Jesse (jruderman@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:53:40] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[15:55:49] <Sodel_the_V> nmatsakis: Oh, you mentioned that objects are represented as a (T, vtable) pair at runtime. For boxed and borrowed objects, it's a (vtable, T) pair. Unique objects actually seem to be a (vtable, T, type_descriptor) triple.
[15:56:18] *** Quits: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net) (Input/output error)
[15:57:09] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Connection reset by peer)
[15:57:28] *** Joins: Sodel_the_V (user@moz-853663E1.va.shawcable.net)
[15:59:12] <ssbr_> Does anyone know offhand what rust glfw-rs and coregl-rs are meant to be built with? (glfw-rs fails in 0.6)
[15:59:30] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[15:59:31] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[16:01:24] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[16:02:04] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[16:02:58] <nmatsakis> Sodel_the_V: yes, I had forgotten that; however, we will be changing it shortly
[16:03:03] <nmatsakis> Sodel_the_V: moving the type_descriptor into the vtable
[16:03:29] <Sodel_the_V> nmatsakis: Sensible. And thanks for the heads-up.
[16:04:27] *** Quits: cstrahan (cstrahan@12405AA6.ED659C99.2C87C8BD.IP) (Ping timeout)
[16:05:26] <jack> nmatsakis: is there an open bug for that i can watch?
[16:05:37] <kimundi> ssbr_: What do you mean with that?
[16:05:49] <kimundi> glfv-rs needs glfw 3 installed
[16:06:16] <jack> nmatsakis: i've now gottten my first dynamic borrow check failure. but i have no idea where the second mutable borrow is.
[16:06:19] <ssbr_> kimundi: ./src/glfw.rs:78:17: 78:42 error: type `~fn()` does not implement any method in scope named `finally`
[16:06:30] <ssbr_> 0.6 doesn't have that
[16:06:32] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:06:42] <kimundi> ssbr_: for gl bindings I know that bjz has one that I know of to work
[16:06:52] <ssbr_> Right, coregl-rs. It compiles in 0.6
[16:06:53] <kimundi> ssbr_: Need to upgrade to incoming
[16:07:12] <ssbr_> OK, hope that works!
[16:07:23] <ssbr_> Actually, since incoming finished building, I'm back to working on regexp stuff :(
[16:07:39] <kimundi> He, sorry ;)
[16:08:02] <nmatsakis> jack: are you compiling with optimizations on
[16:08:08] <nmatsakis> jack: if so, don't.
[16:08:14] <nmatsakis> jack: if not, it SHOULD be in the error message---
[16:08:24] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[16:08:33] *** Quits: trapni (trapni@moz-6A0EA166.dawanda.com) (Quit: Leaving)
[16:08:41] <nmatsakis> jack: (also, how up to date is your rustc? in particular, I pushed a fix yesterday related to this)
[16:09:00] <jack> rust: task failed at 'borrowed', /Users/jack/src/servo/src/servo/layout/flow.rs:101
[16:09:14] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[16:09:16] <jack> that gives me one of the borrows, i assume the second one.
[16:09:29] <nmatsakis> jack: yes. so, are you compiling with optimizations on?
[16:09:41] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:09:44] <jack> is that -O?
[16:09:46] <nmatsakis> yes
[16:09:49] <jack> then yes
[16:09:54] <nmatsakis> yeah, don't do that.
[16:09:57] <nmatsakis> :)
[16:10:06] <nmatsakis> if you don't optimize, it will instrument the borrows
[16:10:14] <nmatsakis> and then it should give you a second line numebr...
[16:10:19] <jack> will try that quick
[16:10:21] <nmatsakis> ...but otherwise, it must be in some enclosing stack frame
[16:10:23] *** Joins: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr)
[16:13:38] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:15:23] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[16:17:29] <jack> nmatsakis: and there's my second borrow line. awesome!
[16:17:43] <nmatsakis> jack: great! glad it worked for you.
[16:18:47] <nmatsakis> jack: I hope someday we can make borrow tracking zero cost (certainly doable in principle, given a GC-like stack map)---but for now it has overhead, so I opted to turn it off with -O
[16:18:55] *** Quits: mdu (mdu@moz-9962C9F4.rev.numericable.fr) (Quit: mdu)
[16:19:03] *** Joins: jclements (jclements@2557E599.66715431.D25A875A.IP)
[16:19:11] <jack> nmatsakis: so i'm loving the new borrow check so far, except for the nested method calls and HashMap operations which are still slightly clunky
[16:19:12] *** Joins: mdu (mdu@moz-9962C9F4.rev.numericable.fr)
[16:19:24] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[16:19:33] <nmatsakis> jack: yeah, I will tackle nested calls next I think, after I do some cleanup
[16:19:50] <nmatsakis> jack: hashmap operations are clunkier than I would like but I haven't figured out if that's fixable yet or not... find_or_insert_with helps a lot :)
[16:20:06] <nmatsakis> jack: (I presume that's the case you're talking about---but if not, I'd like to see some examples)
[16:20:35] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:20:54] <nmatsakis> jack: nested method calls are surprisingly subtle and hard to handle.
[16:21:12] <jack> nmatsakis: the HashMap example is here https://gist.github.com/metajack/5555485
[16:21:32] <jack> sounds like we're talking about the same thing
[16:21:51] <nmatsakis> jack: yeah, I was disappointed to realize that just making everything flow sensitive didn't quite fix that
[16:22:10] *** Joins: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net)
[16:22:10] *** ChanServ sets mode: +o pcwalton
[16:22:24] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[16:22:31] *** Quits: pcwalton (pcwalton@moz-481A040C.hsd1.ca.comcast.net) (Quit: .)
[16:22:45] <jack> nmatsakis: arguably, the code was wrong in the first place in a few cases. but the find_or_insert_with is not so nice
[16:22:54] <nmatsakis> jack: or, really? I prefer it actually
[16:23:00] <jack> i sort of wanted a find_or_insert_mut
[16:23:20] <jack> because i needed to mutate the result whether it was found or inserted
[16:23:38] <nmatsakis> jack: I see. I think maybe the best answer is just to add such a method---there are really just a few common cases...
[16:23:50] <nmatsakis> jack: though you *can* write such code by returning early
[16:24:05] <jack> you can see it in that last diff. i have to do contains_key, then find_mut
[16:24:23] <nmatsakis> jack: oh, I didn't realize there were multuiple
[16:24:52] <nmatsakis> jack: yeah, you could do it the original way (right now) by breaking that out into a fn
[16:24:56] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:25:10] <nmatsakis> jack: kind of awkward though, I'd rather add another accessor for that pattern
[16:25:19] <jack> part of this is just more examples of that blog post you wrote where it really is unsafe and we're just used to it :)
[16:25:43] <jack> nmatsakis: i'll file a bug for the hashmap method then
[16:25:55] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:25:56] <nmatsakis> jack: I was pleased to see that most (though not all) of the dynamic borrow checker errors I found in rustc were buggy code
[16:26:09] <nmatsakis> jack: that was exploiting undefined behavior in the hashtable
[16:26:15] *** Joins: Jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[16:26:19] <nmatsakis> jack: and the interactions were quite nonobvious
[16:26:38] <jack> also, your explanation in vancouver of the borrow check rules have made it really easy for me to fix things when it complains.
[16:26:57] <nmatsakis> oh, good. I want to try and writeup a more user-friendly explanation now that I've had some experience talking about it
[16:27:19] <nmatsakis> I like the new errors pcwalton suggested too
[16:27:29] <nmatsakis> much nicer to see `a.b.c` than "immutable captured local variable" or whatever
[16:28:03] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:28:11] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[16:29:25] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[16:29:42] <jack> almost all the errors i had to fix in servo were workarounds for hte old borrow check which are now invalid
[16:31:42] <nmatsakis> jack: yeah, dealing with the fact that many of the workarounds we had for the old borrow checker were invalid in the new one was part of why it was a pain to land that branch...
[16:31:53] <nmatsakis> you can see whole modules just #[cfg(stage0)]'d in rustc
[16:31:56] <nmatsakis> e.g., resolve_stage0
[16:32:07] <nmatsakis> I found that was easier in the end
[16:32:09] <jack> does that mean those workarounds were all unsound/unsafe?
[16:32:32] <nmatsakis> often, yeah, the rules it was enforcing were just incoherent. 
[16:32:46] <nmatsakis> it took me a little while to realize the full implications of the INHTAWAMA changes
[16:33:02] <nmatsakis> (did those changes predate you?)
[16:33:12] <nmatsakis> hopefully I won't say the same of the new rules... :)
[16:33:29] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:33:36] <nmatsakis> I'm feeling much better about them though, I reformulate and I think they're much clearer, I have to write up a big explanation
[16:33:41] <nmatsakis> I've started it but it takes a lot of time
[16:34:37] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:35:29] *** Joins: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP)
[16:35:29] *** ChanServ sets mode: +qo graydon graydon
[16:35:31] *** Joins: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net)
[16:35:56] <jack> nmatsakis: is it possible for the dynamic error to tell me what exactly was borrowed, not just the line the borrow happens on?
[16:36:21] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[16:37:07] <nmatsakis> jack: we have the precise expr id, so I could in theory give you a span, 
[16:37:14] <nmatsakis> jack: or at least we could give you the columns
[16:37:14] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[16:37:27] <ssbr_> How come I can do `let a = "x".char_iter();`? Since iterators mutate their state, shouldn't I have to do "let mut a = ..."?
[16:37:28] <nmatsakis> jack: pretty printing the span would be a bit of a trick :)
[16:37:52] <nmatsakis> ssbr_: I think that just *creates* the iterator?
[16:38:04] <ssbr_> oh, sure
[16:38:07] <kimundi> ssbr_: Well, have you tried actially iterating over an immutable iterator? ;)
[16:38:17] <ssbr_> right right, I'm dumb.
[16:38:19] <nmatsakis> jack: would that be helpful?
[16:38:26] <nmatsakis> jack: shouldn't be very hard
[16:38:36] <jack> let me show you what i'm having trouble with:
[16:38:37] <jack> https://github.com/mozilla/servo/blob/master/src/servo/layout/box_builder.rs#L387-L411
[16:38:42] <ssbr_> OK, glad I'm not missing something. Woo!
[16:38:46] <ssbr_> Thanks for pointing that out :)
[16:39:12] <jack> nmatsakis: you can see theo ld workaround there. the issue is that remove_child() borrows an interior pointer mutably
[16:40:03] <ssbr_> Is there a pastebin that syntax-highlights rust code? I'd like to post something up real quick for feedback
[16:40:14] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[16:40:19] <nmatsakis> jack: is it the borrow of `boxes` you're referring to?
[16:40:28] <nmatsakis> ssbr_: github will do it
[16:40:33] <jack> no, remove_child borrows common
[16:40:34] <ssbr_> oh right, gist
[16:40:42] <jack> which is the first field of the enum variant.
[16:40:54] <jack> boxes is the second field :)
[16:41:07] <nmatsakis> jack: no, I mean, it's the borrow boxes that is causing you trouble, no?
[16:41:17] <jack> it's that line it fails on yes
[16:41:29] <jack> if i change it to a non-mutable borrow (which should be fine) it also fails.
[16:41:36] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:41:44] <nmatsakis> jack: so I think the problem is because the borrow of boxes extends to the entire scope of that variable
[16:41:55] <nmatsakis> it's a bit awkward, but try this:
[16:42:03] <ssbr_> Does this look like a reasonable implementation of an iterator with peeking? I'm a little weirded out that I can't put trait bounds on the struct: https://gist.github.com/ssbr/d7a4db95612a764b818d
[16:42:29] <jack> but why is there a conflict? boxes is an interior poitner that does not overlap the mutable borrow that remove_child needs
[16:42:29] <nmatsakis> "let should_remove = { let boxes = &mut ...; boxes.len() == 1 && boxes[0].is_whitespace_only() }; if should_remove { ... }"
[16:42:37] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[16:42:41] <nmatsakis> jack: borrows are at the resolution of the @mut
[16:42:51] <nmatsakis> jack: dynamic borrows anyhow
[16:43:02] <nmatsakis> so you can also introduce more @muts in there to break it up
[16:43:14] <heftig> hm, i heard @[T] and @str are going away? 
[16:43:19] <jack> so if i borrow some field immutable that's inside an @mut, that conflicts with all other borrows even fi they don't overlap?
[16:43:21] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[16:43:21] <nmatsakis> ssbr_: yeah, there's no...good reason you can't, except that they don't actually serve much purpose.
[16:43:33] <nmatsakis> jack: right, the entire box is frozen.
[16:43:38] <nmatsakis> heftig: not that I know of.
[16:43:56] <jack> nmatsakis: that kind of makes sense now
[16:44:02] <nmatsakis> heftig: it has been sometimes discussed, but I think we agreed to keep them, and instead (eventually) permit ~[] to be coerced to @[]
[16:44:07] <nmatsakis> jack: otherwise the runtime overhead would be very hig
[16:44:18] <nmatsakis> jack: well, in principle we could use bitfields or something.
[16:44:24] <jack> so this would be fixed if the borrow was scoped to before the if block
[16:44:24] <nmatsakis> jack: but it'd still be higher for certain
[16:44:50] <ssbr_> If a struct has a private field, does that mean that it can't be constructed outside the module using a struct expression? (so if I don't provide a pub fn foo(...) -> MyStruct, the struct can't be constructed at all?)
[16:45:11] <nmatsakis> jack: yes, I've encountered this before, it may be that if we reformulated the way the region hierarchy such that the scope of the "if" did not include the condition, we could avoid this problem, or something
[16:45:12] *** Joins: mzabaluev (mzabaluev@moz-91FFD755.dhcp.inet.fi)
[16:45:22] <nmatsakis> jack: it's somewhat similar to the match problem with the case of None
[16:45:22] <jack> mentally, after the if test, the borrow is done. so it seems weird that i'm still borrowing inside teh block. but this is exactly the same as those matches and the nested function call in my mind
[16:45:42] <nmatsakis> jack: yeah, the scopes are really based on the lexical structure of the code, which doesn't always match up with your mental model.
[16:45:49] <nmatsakis> ssbr_: yes.
[16:46:02] <ssbr_> OK, that's perfect. Thank you :)
[16:46:07] <jack> nmatsakis: is there a bug filed for this? it seems like match and if are going to be common problems
[16:46:42] <jack> although since i've only hit it twice so far in all of servo probably means it's not as bad as it would seem
[16:46:42] <nmatsakis> jack: no bug is filed to my knowledge. feel free if you like (put my name in it)
[16:46:59] <nmatsakis> it may be something we have to live with, but it does seem...potentially finessable
[16:47:04] <nmatsakis> if we are very careful with our definition of region scopes
[16:48:33] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:48:52] <nmatsakis> jack: I hit it one or two times in rustc. Besides the kind of awkward workaround I just mentioned, another is to add a method or function encapsulating the test you are performing...
[16:48:55] <nmatsakis> ...that reads a bit better
[16:49:20] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[16:50:06] <Jesse> nmatsakis: would '~' coerce to '@' or to '@mut' ?
[16:50:20] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[16:50:37] <nmatsakis> Jesse: presumably.
[16:50:44] <samebchase> I just did a simple exercise using rust: https://pastee.org/rtxx9 What are better ways of (using rust for) doing this?
[16:51:02] <Jesse> nmatsakis: both would be allowed?
[16:51:07] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[16:51:17] <nmatsakis> Jesse: I don't see why not.
[16:51:38] <Jesse> cool
[16:52:26] <ssbr_> rusti: match 1 { Some(1 | 2 | 3) => "yes", _ => "no"}
[16:52:26] <rusti> foo.rs:5:26: 5:27 error: expected `,` but found `|`
[16:52:27] <rusti> foo.rs:5          match 1 { Some(1 | 2 | 3) => "yes", _ => "no"}
[16:52:27] <rusti>                                    ^
[16:52:29] <ssbr_> Boo.
[16:52:49] <bstrie> samebchase: are you just looking for general tips?
[16:53:39] <samebchase> bstrie: yeah, kinda
[16:53:57] <bstrie> samebchase: let me take a look at it
[16:56:04] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[16:56:43] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[16:56:49] *** Joins: fabiand (fabiand@moz-946E65F8.adsl.alicedsl.de)
[16:56:53] *** Joins: inolen (Adium@moz-FA2406D8.socal.res.rr.com)
[16:56:56] *** Quits: inolen (Adium@moz-FA2406D8.socal.res.rr.com) (Client exited)
[16:57:09] <heftig> rusti: match 1 { Some(1) | Some(2) | Some(3) => "yes", _ => "no"
[16:57:10] <rusti> foo.rs:6:5: 6:6 error: incorrect close delimiter: `)`
[16:57:10] <rusti> foo.rs:6     });
[16:57:10] <rusti>               ^
[16:57:14] <heftig> rusti: match 1 { Some(1) | Some(2) | Some(3) => "yes", _ => "no"}
[16:57:15] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/gRJO
[16:57:26] *** Joins: ssbr (scorchsabe@moz-8457D09A.cable.teksavvy.com)
[16:57:41] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[16:57:45] <kimundi> rusti: match None { Some(1) | Some(2) | Some(3) => "yes", _ => "no"}
[16:57:46] <rusti> "no"
[16:57:59] <kimundi> rusti: match Some(2) { Some(1) | Some(2) | Some(3) => "yes", _ => "no"}
[16:58:00] <rusti> "yes"
[16:58:16] <bstrie> samebchase: take a look at https://gist.github.com/bstrie/5555715/revisions
[16:58:37] <samebchase> thank, I'll have a look at that now
[16:58:55] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[16:58:55] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[17:01:01] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[17:01:23] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[17:01:31] <ssbr_> kimundi: it gets more annoying with ten of them ('0'-'9')
[17:01:34] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[17:01:49] <kimundi> ssbr_: Oh, definitly :)
[17:01:53] <ssbr_> although maybe there's some fancy is_digit predicate for char, hmmm
[17:02:06] <kimundi> actually there is :)
[17:02:06] <ssbr_> (then I could do Some(c) if c.is_digit() or whatever)
[17:02:28] <samebchase> bstrie: okay. didn't know of vec.to_str(). The HashMap related code looks alright? Thanks! :-)
[17:02:33] *** Quits: ssbr (scorchsabe@moz-8457D09A.cable.teksavvy.com) (Ping timeout)
[17:02:58] <bstrie> samebchase: I actually got sidetracked trying to figure out if rust has a built-in .mode() method for vecs :P
[17:03:15] <bstrie> it doesn't appear to...
[17:03:17] <bstrie> maybe it should
[17:03:32] <ssbr_> Isn't there that one special statistics trait for f32 vecs?
[17:03:37] <bstrie> in any case I'm not the master of containers
[17:03:41] <samebchase> what would a .mode() method do?
[17:03:56] <bstrie> same as it does in math... pick the most common element of a set
[17:04:06] <bstrie> if I'm remembering 7th-grade math correctly
[17:04:08] <samebchase> oh, stats. okay
[17:04:21] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[17:04:22] <bstrie> I never did figure out why anyone would want the mode of something :P
[17:05:44] *** Quits: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net) (Ping timeout)
[17:05:45] *** Quits: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr) (Quit: pyrac)
[17:06:19] <samebchase> are there plans for a C++/Python like "table[key]" syntax for HashMaps?
[17:07:01] *** Quits: jviereck (Adium@moz-340574DC.dclient.hispeed.ch) (Quit: Leaving.)
[17:07:11] <bstrie> samebchase: I believe so
[17:07:28] <samebchase> nice
[17:07:31] *** Joins: Ralith (ralith@moz-95DA29C.wireless.sfu.ca)
[17:08:01] *** Joins: mschifer (Adium@2557E599.66715431.D25A875A.IP)
[17:08:46] <bstrie> iirc there are some issues with the current operator overloading so people have put it off
[17:09:26] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[17:09:32] <ssbr_> What should I do if there's a non-public interface I want to call from a separate module? Do I make it pub and not document it?
[17:09:36] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:09:37] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[17:10:05] <ssbr_> aw crap, ICE
[17:10:12] <kimundi> ssbr_, that, or refactor the codebase :)
[17:10:31] <ssbr_> kimundi: this came from refactoring the codebase (I put some of my tests in a submodule)
[17:11:08] <kimundi> ah, submoduls should in theory see the content of their parents
[17:11:20] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[17:11:35] <kimundi> might have to put a 'use super::*' at the top of the submodule
[17:12:07] *** Quits: a__ (a__@moz-250D9B4.nycmny.fios.verizon.net) (Quit: I haz left.)
[17:12:59] <ssbr_> I'll toy around with that and also working around this ICE after I get lunch. :S
[17:13:09] <ssbr_> (and reporting this ICE, obviously)
[17:14:10] *** Joins: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr)
[17:14:34] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[17:14:34] *** Joins: sdh_ (sdh@BCD0EF3B.8A554927.FD6A0EFF.IP)
[17:16:05] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:16:07] *** Joins: ljrmorgan (Mibbit@10DE4E3D.84C11B46.A3649FCA.IP)
[17:17:52] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[17:18:19] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[17:18:29] *** Quits: sdh_ (sdh@BCD0EF3B.8A554927.FD6A0EFF.IP) (Quit: Konversation terminated!)
[17:18:58] *** Joins: jviereck (Adium@moz-A25A336C.dclient.hispeed.ch)
[17:19:49] *** Joins: erickt (Adium@moz-296E9E30.hsd1.ma.comcast.net)
[17:20:02] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[17:22:07] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[17:22:07] *** ChanServ sets mode: +o dherman
[17:23:03] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:23:04] *** Joins: solancile (solancile@moz-A1CFFAE5.hsd1.wa.comcast.net)
[17:24:35] *** Quits: Ralith (ralith@moz-95DA29C.wireless.sfu.ca) (Ping timeout)
[17:25:17] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[17:25:30] *** Joins: sdh_ (sdh@8557E3E0.AAC4A127.9105FBCF.IP)
[17:26:35] *** Joins: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP)
[17:26:35] *** ChanServ sets mode: +o pcwalton
[17:26:52] <pcwalton> graydon: bors has been stuck since last night
[17:26:59] <pcwalton> and the queue is a mile long
[17:28:36] <graydon> grrrrr
[17:29:06] <bstrie> on the bright side, the status page now looks very pretty :)
[17:29:17] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[17:29:27] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[17:29:59] <graydon> it seems to have gotten _worse_ with my recent attempts to make it stick less often
[17:30:00] <graydon> :(((((
[17:30:53] *** Quits: jviereck (Adium@moz-A25A336C.dclient.hispeed.ch) (Quit: Leaving.)
[17:30:57] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[17:30:57] *** Quits: erickt (Adium@moz-296E9E30.hsd1.ma.comcast.net) (Connection reset by peer)
[17:30:57] *** Joins: erickt (Adium@moz-296E9E30.hsd1.ma.comcast.net)
[17:31:01] <graydon> brendanc: ping
[17:31:03] *** Quits: erickt (Adium@moz-296E9E30.hsd1.ma.comcast.net) (Connection reset by peer)
[17:31:04] *** Joins: erickt (Adium@moz-296E9E30.hsd1.ma.comcast.net)
[17:31:06] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:31:12] <brendanc> graydon: uh oh :)
[17:31:12] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:31:19] <ssbr_> Is there anything wrong with this function definition? `fn foo<'self>(s: &'self str) -> str::StrCharIterator<'self> {s.char_iter()}`
[17:31:28] <graydon> brendanc: what do you think the odds are that it's related to the tree stable timer?
[17:31:53] <graydon> brendanc: or the fact that bors is force-pushing the auto tree around randomly
[17:31:55] <ssbr_> (I'm wondering if maybe it's bad in a way the compiler doesn't expect, so an ICE, or if it should actually work)
[17:32:08] <ssbr_> (it causes an internal compiler error)
[17:32:10] <graydon> (it rewinds it after every failed push)
[17:32:13] <graydon> er, failed build
[17:32:19] *** Joins: mschifer1 (Adium@2557E599.66715431.D25A875A.IP)
[17:32:24] *** Quits: mschifer (Adium@2557E599.66715431.D25A875A.IP) (Connection reset by peer)
[17:32:28] *** Joins: ssbr (scorchsabe@moz-8457D09A.cable.teksavvy.com)
[17:32:32] *** Quits: fabiand (fabiand@moz-946E65F8.adsl.alicedsl.de) (Quit: Verlassend)
[17:32:36] <brendanc> well, the thing that seems to be happening is the scheduler isn't firing at all
[17:32:45] <graydon> yeah
[17:32:54] <brendanc> I don't think the scheduler cares about any kind of forwards or backwards in time thing, so I doubt it's force pushing
[17:33:01] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[17:33:06] <graydon> I mean, is there any way to force it like .. "if you haven't built in an hour, build?"
[17:33:29] <graydon> just add a periodic scheduler to the mix?
[17:33:34] <ssbr_> oh, I _wasn't_ supposed to say "'self"
[17:33:35] <graydon> would that be worse or better? hmm
[17:33:50] <brendanc> could do that I suppose
[17:34:06] <brendanc> the twistd.log for around the time the last auto change that didn't fire a build would be maybe helpful
[17:34:26] <graydon> do you think it'd interfere? if multiple builds get queued up on a single branch, it doesn't seem to me like it'd do harm
[17:34:35] <brendanc> 5:52:48 this morning should have fired auto
[17:35:13] <brendanc> I don't know anything about bors, I imagine it's looking for specific revisions
[17:35:27] <graydon> it's looking for specific revs, yes
[17:35:38] <brendanc> random builds might not give it the revisions it wants, depending on how it scans the results
[17:35:44] <graydon> but it looks in "the last dozen or so builds that auto did"
[17:35:55] <graydon> I think it's actually 20-back now
[17:36:10] <graydon> and auto only ever assumes the state of one of the revs it's looking for
[17:36:28] <graydon> (or, transiently, incoming -- for like 10s at a time when auto is being rewound)
[17:37:22] <brendanc> I still vaguely suspect all the gitpollers on the same repo might be triggering some bug
[17:37:25] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[17:37:25] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[17:37:34] <brendanc> I think the twistd.log would have clues
[17:37:40] <graydon> ok. I'm reading presently.
[17:37:41] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[17:37:47] <graydon> what should I look for?
[17:38:10] *** Quits: ssbr (scorchsabe@moz-8457D09A.cable.teksavvy.com) (Ping timeout)
[17:38:16] *** Quits: erickt (Adium@moz-296E9E30.hsd1.ma.comcast.net) (Quit: Leaving.)
[17:38:19] <graydon> ooh. there's a traceback due to ..
[17:38:25] <brendanc> I'd look for what happens when changes arrive in auto :) sometimes auto-sched will fire sometimes it wont
[17:38:33] <graydon> sqlalchemy.exc.OperationalError: (OperationalError) database is locked u'INSERT INTO sourcestamps (branch, revision, patchid, repository, project) VALUES (?, ?, ?, ?, ?)' (u'incoming', u'
[17:38:33] <graydon> fdf601eaf3f6fcc727819f8c0ae2b44b30770a8a', None, u'git://github.com/mozilla/rust.git', u'')
[17:38:39] <brendanc> uhuh
[17:38:41] <graydon> database is locked!
[17:38:49] <brendanc> yeah, I bet that would go away if you had one poller
[17:38:59] <brendanc> it's probably dropping the changes on the floor there
[17:39:28] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[17:39:37] <graydon> we get those .. a lot :(
[17:39:43] <graydon> reading the logs
[17:40:02] <graydon> yeah, there was one at 5:53
[17:40:41] <graydon> ok. you previously suggested a way for me to consolidate pollers. I'm all ears.
[17:40:51] *** Quits: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[17:40:58] *** Joins: seth (seth@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:41:27] <brendanc> I thought I replied by email about that?
[17:41:35] <graydon> checking
[17:41:52] <brendanc> basically, set up a git mirror internally where you can install a post-receive hook
[17:42:04] <graydon> (apologies for my dim witted ness on this. I just keep wanting easy answers, it's just sloth)
[17:42:18] <graydon> that hook fires on all changes to all branches?
[17:42:22] <brendanc> http://trac.buildbot.net/ticket/2005
[17:42:24] <brendanc> yes, it does
[17:42:30] <graydon> huh, ok.
[17:44:07] <graydon> hm
[17:44:12] <graydon> I can't quite tell what that ticket is suggesting
[17:44:33] <brendanc> well, it has a fix (retry for a long time) but I don't know what version it landed in
[17:44:38] <kimundi> ssbr_: Re you lifetmie issues, does it also ice with a different name than 'self?
[17:44:40] <brendanc> otherwise, I think it's suggesting not using sqlite :)
[17:44:44] <graydon> brendanc: hah
[17:44:49] <ssbr_> kimundi: no, it worked fine as soon as I changed the lifetime name
[17:44:57] <graydon> if we use postgres or something, does it work better?
[17:44:59] <ssbr_> (I spent the time until now verifying that)
[17:45:04] <graydon> (generally, in your experience)
[17:45:13] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:45:13] <ssbr_> I only named it 'self because someone told me once that that's the only valid lifetime name <_<
[17:45:18] <ssbr_> (other than 'static)
[17:45:31] <ssbr_> anyway, I'll file a bug report then
[17:45:33] <graydon> maybe I'll work on upgrading buildbot today.
[17:45:53] <kimundi> ssbr_: Ah, okay. I guess its still legacy from when 'self was a special lifetime name
[17:45:59] <brendanc> I've actually never had trouble with sqlite.
[17:46:27] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[17:46:51] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[17:47:01] <brendanc> consolidating the pollers might help avoid tickling the bug, but probably only if the tracebacks occur around the time that a bunch of changes are arriving
[17:47:28] <brendanc> yeah, this fix landed in 0.8.6
[17:47:33] <graydon> I suspect two changes arrive in short succession
[17:47:33] <brendanc> https://github.com/buildbot/buildbot/commit/95deef27d7c531ead19e0ac86a9aa1546d4ee7f9
[17:47:37] <graydon> auto moves, then auto moves again
[17:47:49] <graydon> it would have to be polling right when that happens
[17:49:20] <brendanc> the individual poller won't see that I don't think, since it's on a timer
[17:49:31] <brendanc> it'd be more having multiple branches changing at the same time
[17:49:42] <cantsin> ah. i figured out how to fix rusti crashing. it's a two line fix, should i submit a PR?
[17:49:59] <ssbr_> kimundi: https://github.com/mozilla/rust/issues/6396
[17:50:01] <Jesse> https://twitter.com/tirsen/statuses/332847561293561859
[17:50:07] <graydon> hm. no, single branches tend to move on their own, only.
[17:50:42] <brendanc> ?
[17:51:17] <graydon> I mean, we don't tend to move multiple branches between polls, I don't think
[17:51:18] <graydon> maybe.
[17:51:32] <graydon> on a successful change, incoming advances to auto then auto moves to the next merge.
[17:51:37] <graydon> so I guess that's possibly the cause.
[17:51:37] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:51:41] <ssbr_> Jesse: https://bitbucket.org/devin.jeanpierre/pyrite
[17:51:53] <ssbr_> I don't use twitter so I can't respond.
[17:52:03] <brendanc> so incoming and auto will tend to change within the same poll interval, and the two gitpollers are probably polling concurrently
[17:52:04] <ssbr_> but the above works with Rust 0.6 and has examples.
[17:52:13] *** Quits: bnicholson (bnicholson@moz-E98974C1.hsd1.ca.comcast.net) (Ping timeout)
[17:52:14] <graydon> brendanc: can I make them not-concurrent?
[17:52:16] <Jesse> lol "Ready for production? No. Use it anyway!"
[17:52:19] <ssbr_> (FSVO works -- it has the limitations described (and more?))
[17:52:37] *** Joins: cstrahan (cstrahan@12405AA6.ED659C99.2C87C8BD.IP)
[17:53:23] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[17:53:29] <brendanc> can't think of a reliable way to serialize those pollers
[17:53:36] <graydon> huh. ok.
[17:53:41] <brendanc> possibly the simplest thing is to import this patch into your buildbot
[17:53:54] <brendanc> I've never had trouble with the pb poller either
[17:54:02] <graydon> even if there are multiple concurrent changes?
[17:54:13] <graydon> you figure it'll queue one up then the next, not try to queue both at the same time?
[17:54:14] <brendanc> sure, it gets batches regularly
[17:54:18] <graydon> ok
[17:54:34] <graydon> I'm tempted to _try_ upgrading buildbot anyways. I don't like being ... 3 years behind?
[17:54:38] <brendanc> heh
[17:54:52] <Jeaye> 2010 was a good year.
[17:54:55] <brendanc> I think my masters are all still at 0.8.5 too
[17:54:59] <graydon> I have a patch of my local changes for buildbot
[17:55:11] <graydon> huh. ok. maybe I will just try this pbchangesource thing
[17:55:29] <brendanc> there were some cosmetic nuisances, like I think it stopped putting the builders up in the order they were declared
[17:55:30] <graydon> can you possibly mail me the relevant bits of your crontab and the wiring to the hook?
[17:55:39] <brendanc> sure
[17:56:12] *** Joins: catpig (catpig@moz-E2E35BC8.dip0.t-ipconnect.de)
[17:56:39] <brendanc> you could try pulling that patch, if it applies cleanly you're probably done
[17:57:19] <graydon> yeep! maybe. I'll check.
[17:57:55] *** noam_ is now known as noam
[17:58:14] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[17:58:24] <Jesse> ssbr_: i replied with https://twitter.com/jruderman/status/332917024781119489 thanks!
[17:59:07] *** Joins: inolen (Adium@moz-9F4F17DF.tourcaster.com)
[17:59:24] <graydon> huh. this is lame but I actually don't know how to get a patch out github. fetch the whole repo? I guess
[17:59:27] *** Quits: ljrmorgan (Mibbit@10DE4E3D.84C11B46.A3649FCA.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:59:53] <nmatsakis> does anyone know if there is a "build LLVM" makefile target?
[18:00:15] <Sodel_the_V> graydon: I clone the whole repo, yeah.
[18:00:18] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:00:54] *** Quits: BizarreCake (BizarreCak@32C9829A.151E84E7.561471F8.IP) (Ping timeout)
[18:02:01] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[18:02:57] <ssbr_> Jesse: awesome, thanks :)
[18:03:03] <brendanc> huh. boo github
[18:03:14] <ssbr_> I actually found my old twitter account I never said anything on, but too late to say anything I guess :)
[18:03:41] <brendanc> oh
[18:03:45] <brendanc> stick .patch at the end of the url
[18:03:50] <graydon> haha
[18:03:50] <brendanc> https://github.com/buildbot/buildbot/commit/95deef27d7c531ead19e0ac86a9aa1546d4ee7f9.patch
[18:03:53] <graydon> it's ok I already got it
[18:04:09] <graydon> I'm curious .. does this mean that buildbot is multithreaded?
[18:04:19] <graydon> or just interleaving database actions?
[18:04:40] <brendanc> I always assumed the latter
[18:04:40] <graydon> the patch applies. slight offset. hmm
[18:04:57] <brendanc> db pool might go off and thread itself
[18:06:13] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:06:24] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[18:06:44] *** Joins: bnicholson (bnicholson@2557E599.66715431.D25A875A.IP)
[18:06:46] <Sodel_the_V> nmatsakis: Doesn't look like it
[18:07:09] <brendanc> yeah, looking at the patch twistd is going off into thread land for the db queries
[18:07:29] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:07:58] *** Joins: erickt (Adium@moz-296E9E30.hsd1.ma.comcast.net)
[18:10:02] <Sodel_the_V> Yowza. Anyone know a good way to debug exceptions in LLVM?
[18:10:35] <Sodel_the_V> I can't get a backtrace. :/
[18:10:37] <steven_is_false> Currently clone doesn't let one clone a value into another thread right now right? So there should be a deep copy trait which does let one do that eventually right?
[18:11:03] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[18:13:31] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[18:13:36] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:14:13] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:14:20] *** Quits: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr) (Quit: pyrac)
[18:15:12] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[18:15:37] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[18:17:10] *** Joins: RMF (RMF@moz-A559AD33.dsl.telepac.pt)
[18:19:15] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:19:25] <nmatsakis> Sodel_the_V: eh?
[18:19:40] <nmatsakis> Sodel_the_V: oh, you mean the target? yeah, I couldn't find one
[18:20:25] *** Quits: erickt (Adium@moz-296E9E30.hsd1.ma.comcast.net) (Quit: Leaving.)
[18:21:18] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:22:02] <Sodel_the_V> nmatsakis: Yeah.
[18:22:17] *** Joins: tjc (tjc@A5087023.2354C43D.D8E68FF6.IP)
[18:22:17] *** ChanServ sets mode: +o tjc
[18:22:24] <bstrie> do hashmaps have any sort of method that takes both a key and a closure, so that I can update a value with only a single lookup?
[18:23:44] <nmatsakis> Sodel_the_V: btw I read over your diff, it looks about right so far
[18:23:50] <nmatsakis> Sodel_the_V: nice work
[18:23:59] <nmatsakis> bstrie: perhaps you mean find_or_insert_With?
[18:24:02] <Sodel_the_V> nmatsakis: Thanks! Glad I'm on the right track.
[18:24:43] <nmatsakis> bstrie: though I think we are missing a find_mut_or_insert_with (as jack and I were saying earlier)
[18:24:46] <Sodel_the_V> nmatsakis: Though, I've managed to crash LLVM, and I don't know how to get beat any kind of backtrace out of it.
[18:25:03] <nmatsakis> Sodel_the_V: ok, I can also check out the branch and take a look if you like
[18:25:16] <nmatsakis> Sodel_the_V: I've...all-together too much experience with those problems
[18:25:32] <Sodel_the_V> nmatsakis: Haha, I'd appreciate that. I'll push my latest.
[18:25:33] <steven_is_false> In other words I want something like trait DeepClone <T : Owned> { pub deep_copy () -> T;
[18:27:10] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:28:14] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:31:06] <nmatsakis> steven_is_false: I think the current best answer is to serialize and deserialize.
[18:31:14] <nmatsakis> steven_is_false: eventually we may want something else.
[18:31:22] <steven_is_false> nmatsakis: Okay.
[18:31:41] <samebchase> bstrie: can you please take a look at this: https://gist.github.com/samebchase/5556406
[18:31:51] <nmatsakis> steven_is_false: (though that is not clear to me---I think pcwalton was tossing around some ideas for a hyper-optimized serializer/deserializer though that relied on using in-memory representations, that may be an option)
[18:32:08] <nmatsakis> steven_is_false: also I think brson packaged up serializer/deserializer into a nice-ish API?
[18:32:13] <steven_is_false> nmatsakis: That doesn't seem simple.
[18:32:41] <samebchase> bstrie: I'm trying to write a to_str() for HashMap
[18:33:22] <graydon> pcwalton: I've applied a patch to buildbot that _might_ make it get stuck less often
[18:33:41] <graydon> pcwalton: if that doesn't seem to help, brendanc has given me some further hints to try in the polling layer
[18:34:09] <pcwalton> ok
[18:34:15] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:34:21] <bstrie> nmatsakis: I'm somewhat baffled at the intended use cases of find_or_insert_with... what's the use of making the "default" value into a closure?
[18:34:45] <brendanc> I think we've probably got a handle on the bug now (changes getting dropped so the scheduler doesn't see them)
[18:35:15] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:35:20] <graydon> brendanc: hopefully, yeah
[18:35:58] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Client exited)
[18:37:02] <nmatsakis> bstrie: so that you can compute it only if the key is missing
[18:37:08] <nmatsakis> bstrie: it's in fact what you *usually* want
[18:37:37] <nmatsakis> bstrie: (personally, I think I'd remove `find_or_insert` and just rename `find_or_insert_with` to `find_or_insert`)
[18:37:58] <nmatsakis> bstrie: (and similarly elsewhere in the libraries that take "default" values, e.g., option::get_default)
[18:38:30] <nmatsakis> bstrie: I guess I should say 'it's in fact what *I* usually want'... your needs may vary :)
[18:38:45] <bstrie> nmatsakis: that sounds good, but also I don't think it helps my use case, which is when I know that a bucket exists and I want to increment its value by one :P
[18:39:02] <nmatsakis> bstrie: then you want find_mut
[18:39:18] <bstrie> a big problem is that I can't find a lot of these in the web docs...
[18:40:11] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:40:20] <bstrie> find_or_insert is just totally absent
[18:40:22] *** Joins: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr)
[18:41:16] <nmatsakis> bstrie: perhaps that is...well, I have no idea why that is :) 
[18:41:27] <nmatsakis> bstrie: maybe the #[cfg(stage1)] problem
[18:42:19] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:42:41] <jclements> nmatsakis: you remind me; I had a crazy to solve all cfg(stageN) renaming problems foreverâ€¦ 
[18:42:49] <jclements> s/to/idea to/
[18:42:57] <jclements> to wit:
[18:43:07] <jclements> never re-use a stage number.
[18:43:45] <nmatsakis> jclements: that is ... sort of brilliant? but doesn't that suggest that all this old code will hang around?
[18:43:52] <jclements> Instead of "stage0" meaning "the current snapshot", you let the counter increase forever, like a timestamp. What changes, then, is that the snapshot is associated with a particular stage.
[18:43:53] <nmatsakis> jclements: I rather like the #[cfg(not(stage0))] 
[18:44:20] <jclements> You get to clear out any code that refers to a stage that precedes the current snapshot.
[18:44:22] <nmatsakis> I mean, we do *want* to remove the old crappy if-def'd code
[18:44:25] <jclements> But there's no hurry about it.
[18:44:41] <nmatsakis> right, I See the advantage, but I think I kind of like there being a hurry to do it
[18:45:02] <nmatsakis> I'd also like to at some point make warnings-as-errors in rustc
[18:45:07] <nmatsakis> for similar reasons...
[18:45:22] <jclements> I can see thatâ€¦ but getting a new snapshot seems to require a huge amount of work on brson's part, and this would alleviate it.
[18:45:26] <jclements> Like I said, just a goofy idea.
[18:45:37] <nmatsakis> well, it doesn't have to be brson :)
[18:45:41] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[18:45:41] *** ChanServ sets mode: +o brson
[18:45:51] <nmatsakis> but yeah, it's a clever idea.
[18:45:55] <tjc> making a snapshot isn't usually a lot of work in general
[18:46:03] <tjc> not sure what happened recently to make it more work, was it general build breakage?
[18:46:10] <nmatsakis> yes.
[18:46:24] <tjc> Yeah, so, what we should do is stop breaking the build ;-)
[18:46:41] <brson> graydon: after further reflection on our conversation yesterday I had an epiphinay about how the runtime wants to be structured, and I think it will make you happy
[18:47:40] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:48:01] <graydon> ok!
[18:48:25] <brson> graydon: I think I've been so involved in the current implementation that I haven't been able to 'see the forest for the trees'. It never really occurred to me that tasks themselves could be separated from the coroutine scheduler
[18:48:37] * nmatsakis perks up
[18:49:07] <brson> graydon: so I've been trying to extract this minimum set of capabilities that the language demands, and what I ended up with, `LocalServices`, is actually `Task'. I think this was probably your immediate reaction to the convo yesterday
[18:49:11] <graydon> *shrug* I have no idea if they can be :)
[18:49:11] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:49:30] <graydon> oh. yeah, I suspect that's as good a restatement of what I was feeling as any.
[18:50:04] <brson> so once you have this set of services completely operating outside of the scheduler you are a stone's throw away from a very efficient 1:1 scheduling mode
[18:50:14] <brson> with no user-mode scheduler at all
[18:50:42] <nmatsakis> brson: this sounds great.
[18:50:55] <samebchase> bstrie: added the whole error list: https://gist.github.com/samebchase/5556406 I mean, would a to_str() for HashMap be useful? I'm trying to print it like this "[(key => value), (key2 => value)]" in to_str.rs
[18:51:21] <brson> the big complication is that it makes large parts of core have to dynamically code with two very different scheduling environments, but I already have designs to make this possible for `io`, and `comm`
[18:51:27] <brson> it just needs to be extended to *everything*
[18:51:36] <brson> *cope
[18:51:51] <brson> spawn, ARCs, etc.
[18:52:13] <brson> so you'll be able to start the runtime without the scheduler, and io, spawn, pipes, everything will work nearly the same as with coroutines
[18:52:49] <brson> there will be cracks in the implementation though where things do behave observably different
[18:52:59] *** Joins: steven_is_false (quassel@moz-144077DE.bchsia.telus.net)
[18:52:59] <brson> io especially
[18:53:27] <bstrie> samebchase: ah, sorry, missed your earlier message
[18:53:27] <brson> it will take a long time to get there, but i'll start refactoring things in that direction now
[18:53:51] <bstrie> samebchase: I think a to_str for hashmap would definitely be useful
[18:54:13] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[18:54:20] <bstrie> samebchase: in truth I'm the wrong person to ask about this though, strcat is the one with all the ideas about hashmaps and such
[18:54:30] *** Quits: sdh_ (sdh@8557E3E0.AAC4A127.9105FBCF.IP) (Ping timeout)
[18:54:48] <samebchase> bstrie: does the general idea seem correct?
[18:54:52] <brson> it does mean that there really is no such thing as 'freestanding rust'
[18:55:10] <brson> just different ways to implement core
[18:55:36] <nmatsakis> brson: this seems...like a distinction without a difference.
[18:56:05] <bstrie> samebchase: at first glance yes, though I'm also not sure how you're supposed to iterate over a hash table
[18:56:19] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[18:56:31] *** Joins: sdh_ (sdh@C957F273.8BDB8EF1.A76F6622.IP)
[18:56:34] <nmatsakis> samebchase: I would avoid using the `+` operators on strings...
[18:56:41] <nmatsakis> samebchase: it'll be much more efficient if you call push_str repeatedly
[18:56:55] <nmatsakis> samebchase: but otherwise that looks good
[18:56:59] <bstrie> nmatsakis: we need some kind of dynamic string interpolation that can do that for you :)
[18:57:14] <samebchase> nmatsakis: it doesn't compile, though
[18:57:27] <bstrie> nmatsakis: can you explain the error message there about not implementing each? does it need more trait bounds on the generic types?
[18:57:46] <nmatsakis> samebchase: did you import the container trait?
[18:57:46] <brson> nmatsakis: probably. i was trying to carve out a much smaller subset of core for freestanding mode, but it's not going to happen
[18:57:54] *** Quits: mdu (mdu@moz-9962C9F4.rev.numericable.fr) (Connection reset by peer)
[18:58:04] *** Joins: mdu (mdu@moz-9962C9F4.rev.numericable.fr)
[18:58:06] <nmatsakis> samebchase: in particular, I think the each method is defined on container::Map?
[18:58:09] <cmr> What does freestanding imply?
[18:58:16] <cmr> No underlying OS dependance/
[18:58:18] <nmatsakis> samebchase: so to invoke it you must have a `use container::Map` or something like that
[18:58:37] <nmatsakis> brson: in particular, one can probably define a "dummy" local services that just fails
[18:58:51] <bstrie> samebchase: you can also try changing "A:ToStr" to "A:ToStr+Hash+Eq"
[18:59:10] <samebchase> I have a use hashmap::HashMap at the top of to_str.rs
[18:59:23] <samebchase> bstrie: ok will try that
[18:59:34] <bstrie> it's true that that's a bad error message
[18:59:44] <brson> nmatsakis: yes, I think most every service will be optional. I'm already using tasks without unwinding capability in tests
[19:00:33] *** Parts: maxli (maxli@F2D29657.F60B0462.67AC9B1.IP) ()
[19:02:20] *** Joins: thomaslee_ (thomaslee@moz-6C3931E3.static.twtelecom.net)
[19:02:24] *** Joins: jgilbert (jgilbert@2557E599.66715431.D25A875A.IP)
[19:02:26] * brson lunch
[19:02:37] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:03:13] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[19:03:16] <thomaslee_> tjc: are you catamorphism/Tim by any chance? :)
[19:03:32] <tjc> thomaslee_: yes, I am
[19:04:18] <cmr> Given that each unresolved import reports its own error, is "error: failed to resolve imports" necessary? from my perspective it just adds additional noise ("7 errors? where is the 7th? oh")
[19:04:48] *** Joins: SiegeLord (sl@moz-56D7E78.bstnma.fios.verizon.net)
[19:05:36] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[19:06:15] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[19:06:26] <thomaslee_> ah, awesome -- welcome back. :) I noticed late last night before I went to bed that my pull request for https://github.com/mozilla/rust/issues/4202 doesn't seem to fix stuff like "pub use Path = WindowsPath" (as seen in src/libcore/path.rs)
[19:06:36] <thomaslee_> relates to brson's ticket here: https://github.com/mozilla/rust/issues/5389
[19:06:36] *** Quits: wilkie (wilkie@moz-57D49853.pitbpa.fios.verizon.net) (Quit: Lost terminal)
[19:07:25] <tjc> thomaslee_: it's ok to land it without fixing that, if you document that it's still not fixed
[19:07:32] <samebchase> bstrie, nmatsakis: updated version. https://gist.github.com/samebchase/5556406 . Normally it is possible to iterate over a hash_table by: hash_table.each |&key, &value| . What could be the reason it's not allowing me to do so here?
[19:07:36] <tjc> a partial solution is definitely better than none at all :-)
[19:08:00] <thomaslee_> I'm guessing it winds up with a slightly different AST structure that my patch doesn't grok when it goes poking around trying to sniff out whether it's a trait or not.
[19:08:19] <nmatsakis> samebchase: as I wrote before, you have to add `use container::Map`---the `each` method is defined on the *trait Map*, not on the hashtable type
[19:08:34] <nmatsakis> samebchase: Rust requires that if you call a method defined in a trait, you must `use` the trait
[19:08:38] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:08:54] <nmatsakis> Sodel_the_V: did you push your latest changes?
[19:09:17] <samebchase> nmatsakis: oh when you said "something like that", I thought you meant "something else like that" heh. okay
[19:09:39] <nmatsakis> samebchase: sorry, I meant I wasn't sure what the name of the trait was :) but I double checked
[19:09:47] <thomaslee_> tjc: awesome. Happy to keep digging into that so we can sort out #5389, but if I can land that it'll make me feel better about the hours I've lost figuring this stuff out lol
[19:10:10] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[19:10:11] <tjc> thomaslee_: I know the feeling. Small incremental commits are good both from a project perspective and for your morale, generally :-)
[19:10:44] <thomaslee_> great. well, I best get back to the day job. Thanks again & maybe talk soon when I'm losing more hair over this stuff ;)
[19:10:49] <Sodel_the_V> nmatsakis: Yup. GitHub has my most recent stuff.
[19:10:52] <nmatsakis> Sodel_the_V: ok.
[19:11:56] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:12:12] <nmatsakis> Sodel_the_V: cloning now, I presume it's the branch with 5762 in the name
[19:12:35] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[19:12:35] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/ORur-A
[19:12:35] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[19:13:04] <samebchase> bstrie: what should I "use" to get Eq
[19:13:24] <strcat> it's always in scope because it's in core::prelude
[19:13:32] <strcat> but the ops module defines it
[19:14:32] *** Quits: eevee (eevee@moz-C02C240F.evrt.wa.frontiernet.net) (Ping timeout)
[19:15:11] <Sodel_the_V> nmatsakis: Correct.
[19:15:51] *** Joins: wilkie (wilkie@moz-57D49853.pitbpa.fios.verizon.net)
[19:16:12] <samebchase> strcat: found it in cmp
[19:16:16] *** Joins: eevee (eevee@moz-C02C240F.evrt.wa.frontiernet.net)
[19:16:44] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:16:47] <samebchase> It's building now. Thanks everyone! I'll paste the diff soon.
[19:16:52] <strcat> oh right it's not in ops.
[19:16:56] <bstrie> strcat: samebchase is working on implementing to_str for hashmaps: https://gist.github.com/samebchase/5556406
[19:17:13] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[19:18:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[19:18:32] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/5dqfig
[19:18:32] <ghrust> 13rust/06auto 14632a16b 15Alex Crichton: Implement util::swap without the '<->' operator
[19:18:32] <ghrust> 13rust/06auto 14ddf420b 15Alex Crichton: Stop using the '<->' operator
[19:18:33] <ghrust> 13rust/06auto 14d0c3b2c 15Alex Crichton: Remove the '<->' operator from the language
[19:18:34] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[19:19:10] <jack> what's the url for the bors queue?
[19:19:21] <bstrie> http://buildbot.rust-lang.org/bors/bors.html
[19:19:49] <Jeaye> Woah, new ui
[19:19:59] <jack> what's the avg turnaround for an approved patch? 1hr?
[19:19:59] <Jeaye> Guess those PRs landed?
[19:20:34] <graydon> jack: cycle time is about 1h currently. queue also has about 12 alread-approved entries in it though.
[19:20:39] <bstrie> jack: depends on the length of the queue. could be 1hr per patch ahead of you
[19:20:40] <graydon> (it's been stalling too much recently)
[19:20:52] <samebchase> bstrie: https://gist.github.com/samebchase/5556406#file-gistfile1-diff
[19:20:56] <graydon> (I'm trying to fix that)
[19:21:02] <jack> graydon: i am just trying to estimate when one of the things in the approved queue will land.
[19:21:05] <graydon> we can also speed cycle time if we're willing to run check-fast
[19:21:37] <jack> i'm updating servo to latest rust, but it needs #6380 before it can land.
[19:21:47] <graydon> it runs a _lot_ faster due to the current bug on high per-small-testcase compile time
[19:21:50] <jack> so in about 6-7 hours :)
[19:21:53] *** Joins: ljrmorgan (Mibbit@moz-63C2D615.sgyl.cable.virginmedia.com)
[19:21:56] <graydon> jack: you can add a priority to it
[19:22:04] <graydon> it'll move up in the queue
[19:22:13] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:22:32] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.0)
[19:22:36] <jack> are there docs for this? bors doesn't have a readme :)
[19:22:36] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[19:22:50] <graydon> no, there aren't. I'm sorry. I'll write some up today.
[19:22:58] <jack> how do i bump prirotiy?
[19:23:01] <graydon> short version is, go to the page with the pull req
[19:23:13] <jack> and secondly, does that seem reasonable to do in this instance? :)
[19:23:17] <graydon> then click through to the commit at the head of the pull
[19:23:20] <graydon> yes, sure
[19:23:20] <bstrie> graydon: if today's a bors today, mabye today can be the day when master/incoming get merged? :)
[19:23:22] <nmatsakis> jack: (definitely reasonable)
[19:23:38] <bstrie> so many todays in the sentence
[19:23:52] <graydon> bstrie: incoming is still on fire
[19:23:55] <bstrie> samebchase: would you like to submit that as a pull request?
[19:23:55] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:24:20] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[19:24:24] <graydon> jack: then once you're looking at the head commit (not the pull, but the head-commit-in-the-pull)
[19:24:34] <graydon> jack: add a comment of the form "p=10" or such
[19:24:39] <samebchase> bstrie: I'll test it and then do that.
[19:24:40] <graydon> higher priorities move higher
[19:24:44] <bstrie> samebchase: awesome, thanks
[19:25:20] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:25:20] <jack> graydon: thanks
[19:26:19] <nmatsakis> strcat: I haven't looked into the iterator library too much...is it possible to create a "lazy mapping iterator" at this point?
[19:26:30] <strcat> nmatsakis: yes
[19:26:39] <nmatsakis> strcat: any pointers?
[19:26:40] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[19:26:44] <samebchase> nmatsakis, strcat, bstrie: Thanks for the help! :-)
[19:26:45] <nmatsakis> strcat: also, do iterators implement BaseIter?
[19:27:03] <nmatsakis> strcat: (ps, nice work)
[19:27:22] <strcat> rusti: use core::iterator::*; let xs = ~[1, 2, 3, 4]; let mut it = xs.iter().transform(|&x| x * 2); for it.advance |x| { println(x.to_str()); }
[19:27:27] <rusti> 2
[19:27:27] <rusti> 4
[19:27:27] <rusti> 6
[19:27:27] <rusti> 8
[19:27:40] <strcat> (or with .next())
[19:27:50] <strcat> rusti: use core::iterator::*; let xs = ~[1, 2, 3, 4]; let mut it = xs.iter().transform(|&x| x * 2).chain(xs); for it.advance |x| { println(x.to_str()); }
[19:27:51] <rusti> line longer than 150 columns, pastebinned: http://sprunge.us/HQCF
[19:27:52] <nmatsakis> strcat: so they don't implement BaseIter? :)
[19:27:56] <nmatsakis> or do they
[19:27:56] <strcat> nmatsakis: no
[19:28:05] <strcat> just Iterator, from which they get a next() method
[19:28:13] <nmatsakis> ok... is there a good reason that they do not?
[19:28:13] <strcat> and then they get all the adaptors from IteratorUtil without doing anything
[19:28:18] <strcat> nmatsakis: they need &mut self
[19:28:20] <nmatsakis> yeah
[19:28:22] <nmatsakis> that's what I was just thinking
[19:28:26] <nmatsakis> ok, that's a good reason.
[19:28:37] <nmatsakis> strcat: is there an iterator for option types?
[19:28:48] <strcat> not yet
[19:28:51] <nmatsakis> ok. thanks.
[19:29:04] <strcat> nmatsakis: there's also the start of a composable internal iterator lib in iter.rs now
[19:29:06] <bstrie> strcat: how about an iterator for hashmaps?
[19:29:09] *** Quits: ljrmorgan (Mibbit@moz-63C2D615.sgyl.cable.virginmedia.com) (Quit: http://www.mibbit.com ajax IRC Client)
[19:29:10] <strcat> bstrie: nope ;p
[19:29:15] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:29:19] <strcat> I just made a treemap/treeset one (from before) and a vector one
[19:29:25] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[19:29:32] <strcat> the vector one was really to see what kind of code it compiled to
[19:29:43] <strcat> LLVM nicely merges them all into one loop
[19:29:43] <bstrie> do treemap and hashmap have a different api?
[19:29:53] <nmatsakis> strcat: nice! I hope we can make iterators be the default approach.
[19:29:59] <strcat> bstrie: yes because treemap is ordered
[19:30:04] *** Joins: ljrmorgan (Mibbit@moz-63C2D615.sgyl.cable.virginmedia.com)
[19:30:15] <strcat> bstrie: well
[19:30:19] <strcat> they mostly implement the same stuff
[19:30:32] * nmatsakis ponders a syntax extension akin to Python's yield
[19:30:34] <strcat> but treemap's iterator is in-order and it uses it to implement in-order set methods, etc.
[19:30:52] <strcat> nmatsakis: C# has it too
[19:30:53] <bstrie> strcat: by ordered do you mean it's like a binary heap?
[19:31:02] <strcat> but it works in a way more like how rust could do it (compiles to a state machine)
[19:31:09] <strcat> bstrie: binary tree, smallest to largest
[19:31:13] <engla> will BaseIterator remain?
[19:31:15] <bstrie> cool
[19:31:20] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[19:31:27] <strcat> engla: well, it might
[19:31:30] <nmatsakis> strcat: yeah, and JS,...
[19:31:37] <strcat> the size_hint method is in the wrong place though
[19:32:22] <strcat> nmatsakis: well, python relies on the VM essentially doing context switches
[19:32:54] <nmatsakis> strcat: sure but that's an impl detail...
[19:33:16] <ssbr_> how else would you do it?
[19:33:18] <engla> strcat: it could stay with a default implementation
[19:33:19] <jack> graydon: how often does buildbot status page update? i thought it was 3m, but i guess that's just bors
[19:33:39] <graydon> buildbot status refreshes as often as you click on it
[19:33:50] <strcat> engla: it's still the wrong place to put size_hint though
[19:33:54] <strcat> .each enforces &self
[19:33:57] <strcat> not everything can do that
[19:34:06] <graydon> jack: you are now at the head of the bors queue after the currently-testing change, though
[19:34:18] <strcat> probably better for stuff to implement Container, which has length and is_empty
[19:34:24] <strcat> len*
[19:34:35] <jack> graydon: ah. for some reason Cmd-Shift-R doens't force reload firefox anymore. or maybe that's a chrome keybinding i internalized.
[19:34:47] <strcat> jack: ctrl-f5
[19:34:53] <engla> strcat: size_hint is only a performance thing anyway, so.. it goes wherever is pragmatic
[19:35:02] <graydon> wfm
[19:35:12] <strcat> engla: it doesn't work with generic iterators though
[19:35:30] <strcat> all of the iterators built on BaseIter are going to go away, they will work on the generic for loop protocol
[19:35:37] <engla> sounds good
[19:35:45] <jack> graydon: it reloads the page fine but doesn't get new content.
[19:36:36] <jack> cache-control: no-cache. firefox hates me i guess
[19:36:39] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:36:40] <strcat> engla: https://github.com/mozilla/rust/blob/incoming/src/libcore/iter.rs for the internal iterators
[19:36:48] <strcat> not very complete yet :)
[19:36:55] <nmatsakis> strcat: I'm really excited about this. I have to say, our collection library seems to be working out better than I'd hoped.
[19:37:03] <strcat> nmatsakis: :)
[19:37:16] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[19:37:40] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130506154904])
[19:38:10] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[19:38:44] <strcat> nmatsakis: iterator.rs was pleasantly easy to write too
[19:38:57] <strcat> it just has very generic types and it all works out fine with regions
[19:39:03] <strcat> just hits some type inference bugs now and then.
[19:40:39] <nmatsakis> strcat: yeah, I still haven't had time to look into the bug(s) you reported
[19:41:16] <strcat> well I care more about the new awesome borrowck :)
[19:41:17] <nmatsakis> strcat: though the type inference does have some known limits in that sort of closure-heavy code, partially due to the need for a revamped trait algorithm, but also partly just due to inherent limits
[19:41:37] <strcat> no more unsafe code needed in any of the maps/sets
[19:41:39] <nmatsakis> nice
[19:41:49] <nmatsakis> yeah, that pleased me.
[19:44:32] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[19:46:47] <brson> nmatsakis: I have a use case for `&fn:Owned`. Is that going to be possible?
[19:49:03] *** Joins: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP)
[19:49:24] <strcat> hmm, apparently the buildbot didn't feel like regenerating docs when master moved last time
[19:49:38] <strcat> oh it actually failed to build
[19:50:14] <strcat> graydon: it seems like the doc buildbot needs a make clean, if that makes sense
[19:50:25] <strcat> multiple matching crates for core
[19:50:28] <graydon> it does. I have to get some food first. back in a bit.
[19:50:30] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:50:38] <nmatsakis> brson: yes.
[19:50:45] <nmatsakis> brson: very soon now, actually.
[19:51:15] *** Quits: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net) (Ping timeout)
[19:51:49] *** Joins: Jesin (Jessin_@moz-5654D37.washdc.fios.verizon.net)
[19:52:20] *** Quits: Jesse (jruderman@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: Jesse)
[19:52:22] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[19:52:38] *** Joins: Jesse (jruderman@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:53:33] *** Quits: thelivingdedx_ (thelivingd@3F425D5D.187F07D0.274BF680.IP) (Ping timeout)
[19:54:41] *** Joins: lmandel (lmandel@FE1F74.86ED00A7.971E19F6.IP)
[19:55:01] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[19:55:43] *** Joins: gfan (bzlandfill@37E020AF.15F2CAE9.AE5E6562.IP)
[19:57:03] <tristram> I was wondering if there is a priority queue  implemented
[19:57:09] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:57:15] *** Quits: Jesse (jruderman@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: Jesse)
[19:57:18] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[19:57:27] <strcat> tristram: yeah, std::priority_queue
[19:57:32] <strcat> that was one of my first contributions ;p
[19:57:45] <gfan> Hi, new to rust. what does #[deriving(Eq)] mean in Rust codes
[19:57:47] <tristram> okâ€¦ so I just blindâ€¦
[19:58:07] <Ralith> gfan: it means the obvious implementation of the equality operator is automatically defined
[19:58:22] *** Quits: zakora (NC@moz-8EAF945F.fbx.proxad.net) (Quit: Textual IRC Client: www.textualapp.com)
[19:58:33] <tristram> I thought I double-checked before asking here. Useless precaution
[19:59:05] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[19:59:57] <tristram> thanks strcat. I can now jump to a dijkstra implementation and see how many hundred times Iâ€™m slower than boost graph
[19:59:59] *** Joins: jviereck (Adium@moz-A25A336C.dclient.hispeed.ch)
[20:00:34] <strcat> tristram: I think dijkstra's needs a indexed priority queue to be really fast
[20:00:45] <strcat> std::priority_queue is just a binary heap
[20:00:59] <strcat> need to thread the binary heap into a hash table for it to compete with boost afaik
[20:01:35] <tristram> I donâ€™t really expect to compete. I want to learn rust
[20:02:11] <samebchase> Which representation of HashMap looks the best?: https://gist.github.com/samebchase/5556973 I like #7, #5 and #2 (in that order)
[20:02:11] *** Joins: wilsonk|2 (kvirc@moz-39EFBFC2.cg.shawcable.net)
[20:02:35] <tristram> but Iâ€™m curious if using tasks a bi-directionnal dijkstra coulb be easily implemented
[20:02:48] *** Quits: wilsonk-laptop (kvirc@moz-39EFBFC2.cg.shawcable.net) (Ping timeout)
[20:03:02] <strcat> samebchase: maybe {1: 2, 3: 5} like python
[20:03:05] <strcat> and {1, 2} for a set
[20:03:24] <bstrie> samebchase: yes, I was just going to suggest doing it like python
[20:03:36] <Flibo> i like #1 or python-like
[20:04:15] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:05:00] <samebchase> Is there a literal syntax for HashMaps?
[20:05:32] <strcat> samebchase: no
[20:05:42] <samebchase> so that you can HashMap foo = { (1 , 4), (3, 4)} 
[20:05:49] <samebchase> okay
[20:05:57] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[20:06:04] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[20:06:04] *** ChanServ sets mode: +o brson
[20:06:04] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[20:06:07] <strcat> it could have a function for building it from an iterator and you could do from_iterable([(1, 2), (4, 5)]) eventually
[20:06:10] *** Quits: jviereck (Adium@moz-A25A336C.dclient.hispeed.ch) (Ping timeout)
[20:06:16] <nmatsakis> samebchase: would be simple (and maybe a nice) to make a convenience helper like
[20:06:22] <samebchase> the to_str representation should probably be that same as the literal syntax, right?
[20:06:25] <nmatsakis> HashMap([(k, v), (k2, v2)])
[20:06:28] <samebchase> s/that/the
[20:06:37] <nmatsakis> samebchase: not necessarily, to_str() doesn't really serve that role 
[20:06:37] <steven_is_false>  I wonder if a macro could be made?
[20:06:39] *** Quits: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP) (Quit: pcwalton)
[20:06:51] <nmatsakis> steven_is_false: yes, certainly, should be fairly straightforward
[20:06:54] <strcat> http://trac.webkit.org/browser/trunk/WebCore/html/canvas/CanvasRenderingContext2D.cpp?rev=54137#L1273
[20:07:03] <strcat>     memset(data->data()->data()->data(), 0, data->data()->data()->length());
[20:07:05] <strcat> ;p
[20:07:21] <steven_is_false> But would it have any advantages over a function?
[20:07:34] *** Joins: jviereck (Adium@moz-340574DC.dclient.hispeed.ch)
[20:07:48] <strcat> I think it just needs a conversion from any iterable
[20:07:52] *** Joins: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP)
[20:07:52] *** ChanServ sets mode: +o pcwalton
[20:08:18] <strcat> could make a temporary one using an internal iterator
[20:08:19] <nmatsakis> steven_is_false: no, except that you could use `->`
[20:08:20] <samebchase> strcat: so to work best with a from_iterable() function when it exists, what representation would you like? Python's?
[20:08:37] <nmatsakis> e.g., HashMap!(k->v, k->v)
[20:08:40] <nmatsakis> which is much prettier
[20:08:47] <steven_is_false> nmatsakis: I was wondering if one could have a macro that would let one make a constant hash map.
[20:08:54] <strcat> steven_is_false: syntax ext
[20:08:55] <ssbr_> nmatsakis: Wow, issue #4846 is very long :O
[20:08:55] <samebchase> nmatsakis: harder to type arrows, right?
[20:09:26] <steven_is_false> EG) static x : HashMap <Key, Value> = HashMap! (etc..
[20:09:59] <samebchase> okay I'll go with Python's for now. It can be changed very easily later on, if necessary
[20:10:32] *** Joins: themgt (themgt@moz-F5F3FFDF.dhcp.gnvl.sc.charter.com)
[20:10:36] <nmatsakis> steven_is_false: oh, that'd be much harder---you'd have to hash it at compile time :)
[20:10:51] <steven_is_false> nmatsakis: Oh right.
[20:11:13] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:12:30] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[20:12:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 144c821f4 to 14dba9337: 02http://git.io/N3iJvQ
[20:12:30] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[20:12:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[20:12:32] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/_XsIlg
[20:12:32] <ghrust> 13rust/06auto 14923450d 15Patrick Walton: librustc: Fix ICE in core-text resulting from dynamic borrowing. rs=blocking-servo
[20:12:32] <ghrust> 13rust/06auto 14d546493 15bors: auto merge of #6380 : pcwalton/rust/core-text-ice, r=pcwalton
[20:12:33] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[20:12:46] <samebchase> Python's syntax seems to have the least visual noise
[20:12:59] <steven_is_false> Honestly in many cases I prefer |key| match key { etc.. to hash maps.
[20:13:05] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[20:13:29] <samebchase> I just tested my code, after building. It works. Now I'll make it Python-like.
[20:14:00] <pcwalton> graydon: bors just lost a commit for some reason
[20:14:17] *** Joins: echristo (echristo@CFC3C6C3.D6CCE4AE.77834EAA.IP)
[20:14:36] <graydon> pcwalton: which?
[20:14:55] <pcwalton> <-> swap operator https://github.com/mozilla/rust/pull/6260
[20:15:04] <graydon> it's still on the page
[20:15:52] *** Joins: akashj87_ (akash@C94538B6.311ED440.35E3DDC8.IP)
[20:16:02] <pcwalton> but it just tested it
[20:16:09] <graydon> those tests failed
[20:16:18] <graydon> then it got refreshed, or something
[20:16:20] <pcwalton> oh I see, tests failed
[20:16:25] <acrichto> oh I just updated it right after it failed
[20:16:27] <pcwalton> bah o
[20:16:32] *** Quits: bnicholson (bnicholson@2557E599.66715431.D25A875A.IP) (Quit: Ex-Chat)
[20:16:33] <graydon> I don't know what happened on github's side. it's been displaying odd things. maybe you re-pushed?
[20:16:34] <pcwalton> aha
[20:16:37] <pcwalton> he repushed
[20:16:40] *** Quits: akashj87 (akash@8F911EC2.F644F425.35E3DDC8.IP) (Ping timeout)
[20:16:43] <pcwalton> never mind, mystery solved :)
[20:16:43] <acrichto> yeah rebase + push -f
[20:16:50] <graydon> k
[20:16:50] <acrichto> thanks for the quick r+ anyway thoug h:)
[20:17:07] <pcwalton> acrichto: I really want it to land since it's been on my plate and you came out of nowhere and saved me a bunch of work :)
[20:17:09] *** Quits: gfan (bzlandfill@37E020AF.15F2CAE9.AE5E6562.IP) (Quit: CGI:IRC)
[20:17:14] <pcwalton> very appreciated btw
[20:17:28] <acrichto> no problem :)
[20:17:55] <bblum> c.c
[20:17:58] <bblum> acrichto: what did you do?
[20:18:15] <acrichto> bblum: remove the <-> operator
[20:18:17] <bblum> oh remove <->
[20:18:42] <bblum> i remember when i first wrote util::swap thinking someday someone might change it
[20:18:43] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:19:13] *** Quits: KindOne (KindOne@5CB1B25D.B11A32F.EC6A1518.IP) (Ping timeout)
[20:19:24] <bblum> wow swap_ptr us so unsafe
[20:19:32] <bblum> that is frighteningly unsafe
[20:19:35] <pcwalton> so is <-> :)
[20:19:43] <nmatsakis> what is unsafe about <->?
[20:19:48] <pcwalton> rustc lowers it to unsafe LLVM :)
[20:19:56] <pcwalton> what I mean is
[20:19:57] *** Joins: KindOne (KindOne@5CB1B25D.B11A32F.EC6A1518.IP)
[20:20:04] <nmatsakis> oh
[20:20:04] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[20:20:09] <pcwalton> there's no safety difference between implementing something in trans and implementing something unsafely in the library
[20:20:12] <pcwalton> it's unsafe and unsafe
[20:21:57] <Luqman> i kinda liked <->
[20:24:06] <strcat> pcwalton: I wanted to start tagging &mut parameters as noalias, but I don't really know where that stuff is generated
[20:24:21] <pcwalton> strcat: trans_fn, decl_cdecl_fn, etc
[20:25:14] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:25:35] <nmatsakis> pcwalton: certainly
[20:25:40] *** Quits: KindOne (KindOne@5CB1B25D.B11A32F.EC6A1518.IP) (Ping timeout)
[20:26:35] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[20:26:36] *** Joins: froystig (froystig@4AB93A85.352137A1.BCED17D.IP)
[20:27:07] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[20:27:55] <cmr> r? https://github.com/mozilla/rust/pull/6400 should be quick
[20:28:37] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:29:00] <graydon> pthread_create(&thread, &attr, rust_thread_start, (void *) this) failed in /home/graydon/src/rust6/src/rt/sync/rust_thread.cpp at line 54, result = 11 (Resource temporarily unavailable)
[20:29:02] <graydon> ooh
[20:29:08] <graydon> we get all the most exciting errors
[20:29:11] *** Quits: cstrahan (cstrahan@12405AA6.ED659C99.2C87C8BD.IP) (Ping timeout)
[20:29:35] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[20:30:59] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[20:31:14] <bblum> graydon: ulimit max threads?
[20:31:40] *** Joins: froystig (froystig@4AB93A85.352137A1.BCED17D.IP)
[20:32:01] *** Quits: thou (thou@moz-1C1CA9F7.fasttrackcomm.net) (Ping timeout)
[20:32:10] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:33:22] <graydon> no idea! watching from htop, let's see what's getting maxed out
[20:33:32] *** Joins: thou (thou@moz-1C1CA9F7.fasttrackcomm.net)
[20:34:02] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[20:34:16] *** Quits: ljrmorgan (Mibbit@moz-63C2D615.sgyl.cable.virginmedia.com) (Quit: http://www.mibbit.com ajax IRC Client)
[20:34:55] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[20:35:56] *** Joins: KindOne (KindOne@5CB1B25D.B11A32F.EC6A1518.IP)
[20:37:41] <strcat> rusti: 1
[20:37:42] <rusti> 1
[20:37:51] <strcat> rusti: core::run::run_program("dmesg", []);
[20:37:54] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/CSZe
[20:37:59] <strcat> heh.
[20:39:48] <strcat> rusti: core::run::run_program("sysctl", [~"kernel.dmesg_restrict"]);
[20:39:48] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:39:49] <rusti> rust: task failed at 'failure in execvp: No such file or directory', /build/rust-incoming-git/src/rust/src/libcore/run.rs:418
[20:39:49] <rusti> rust: domain main @0x12ce1b0 root task failed
[20:41:04] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[20:41:30] <strcat> oh there's lxc.seccomp
[20:41:43] <strcat> I can just restrict syscalls beyond what capabilities already do
[20:41:47] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[20:42:19] *** Joins: froystig (froystig@4AB93A85.352137A1.BCED17D.IP)
[20:43:42] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:43:56] *** Quits: jviereck (Adium@moz-340574DC.dclient.hispeed.ch) (Quit: Leaving.)
[20:44:15] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[20:45:36] <graydon> libgit2 bindings = highly desirable
[20:47:20] *** Joins: froystig (froystig@4AB93A85.352137A1.BCED17D.IP)
[20:47:27] <strcat> and hopefully good ones unlike the pygit2 bindings I've used ;p
[20:48:00] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Connection reset by peer)
[20:48:02] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[20:48:30] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[20:49:46] *** Joins: charmander (Mibbit@moz-19BAF9A2.pools.arcor-ip.net)
[20:50:35] *** Quits: brson (brson@2557E599.66715431.D25A875A.IP) (Ping timeout)
[20:52:35] <strcat> ugh lxc irritates me
[20:52:45] <graydon> writing a dtor presently means writing a function called finalize, not drop, right?
[20:52:45] <strcat> it wasn't built with seccomp support so using a seccomp whitelist *silently fails*
[20:52:48] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[20:52:57] <strcat> graydon: yeah, but drop blocks are gone now so afaik it could be changed
[20:53:05] *** Joins: froystig (froystig@4AB93A85.352137A1.BCED17D.IP)
[20:53:13] <strcat> it's 'trait Drop { fn finalize(&self); } atm
[20:53:21] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[20:53:26] <strcat> would be nice if it was drop(self) or at least drop(&mut self).
[20:53:50] *** Joins: brson (brson@2557E599.66715431.D25A875A.IP)
[20:53:50] *** ChanServ sets mode: +o brson
[20:54:05] *** Joins: azita (Azita@2557E599.66715431.D25A875A.IP)
[20:54:09] *** Quits: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP) (Quit: pcwalton)
[20:55:00] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[20:55:11] *** Joins: pcwalton (pcwalton@43CB6079.66715431.D25A875A.IP)
[20:55:11] *** ChanServ sets mode: +o pcwalton
[20:55:32] *** Quits: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca) (Quit: Lost terminal)
[20:57:46] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[20:57:52] *** Joins: libertas (libertas@2D228712.FAA7B709.593B3862.IP)
[20:58:17] <nmatsakis> strcat: we discussed this at the last meeting...
[20:58:35] <nmatsakis> strcat: the general plan was fn drop(self) with some special rules about not being able to move self
[20:58:39] <nmatsakis> strcat: I need to writeup the plan...
[20:58:57] <nmatsakis> strcat: (though you could move away parts of self)
[21:00:21] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[21:00:25] *** Joins: froystig (froystig@4AB93A85.352137A1.BCED17D.IP)
[21:01:05] *** Quits: azita (Azita@2557E599.66715431.D25A875A.IP) (Quit: azita)
[21:01:17] <ssbr_> Is it just me, or are nested loops a little painful? https://gist.github.com/ssbr/d33694b7af69fe6a3c7d
[21:01:19] *** Parts: jclements (jclements@2557E599.66715431.D25A875A.IP) ()
[21:02:00] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[21:02:06] <strcat> ssbr_: use a do loop
[21:02:27] <strcat> well
[21:02:32] <strcat> not really much less painful ;p
[21:02:33] <strcat> but slightly!
[21:02:39] <ssbr_> I don't even know
[21:02:44] <strcat> do block, rather
[21:03:02] <ssbr_> I'm a little confused by the semantics of loops
[21:03:07] <ssbr_> can I return out of a for loop?
[21:03:11] <ssbr_> (if so... how?)
[21:03:17] <strcat> 'return'
[21:03:25] <ssbr_> I mean, how does that make sense
[21:03:39] <ssbr_> how can a closure stop execution of the function it's being called in
[21:03:51] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[21:03:58] <kimundi> ssbr_: The for loop protocol is that the closure returns an boolean
[21:04:13] <ssbr_> kimundi: OK, so the return acts as a break, and then once the loop is broken it returns?
[21:04:23] <ssbr_> but then the calling function can just ignore your return if i doesn't obey the protocol
[21:04:53] <kimundi> ssbr_: in closure: break; -> early return false | loop; early return true | return -> return out of the closure
[21:05:27] <kimundi> ssbr_: Right, the function that takes the closure has to be coded right
[21:05:39] <ssbr_> kimundi: well, return makes the closure return false, right?
[21:05:42] <ssbr_> I should test this
[21:05:46] <nmatsakis> ssbr_: yes, the calling function can ignore your return.
[21:05:57] <nmatsakis> ssbr_: if the protocol is implemented incorrectly, the flow isn't what you expect
[21:06:08] <ssbr_> (it does)
[21:06:12] <nmatsakis> ssbr_: this sometimes leads to surprising errors, because we must be more conservative
[21:06:16] <nmatsakis> ssbr_: in the static analysis
[21:06:21] <ssbr_> OK, at least nothing magical happens.
[21:06:27] <ssbr_> (ish)
[21:06:29] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[21:06:29] <ghrust> 01[13rust01] 15bors merged 06auto into 06incoming: 02http://git.io/_XsIlg
[21:06:29] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[21:06:34] <kimundi> ssbr_: return directly returns out of the outer function afaik. You can't use return for the closure itself
[21:06:44] *** Joins: froystig (froystig@4AB93A85.352137A1.BCED17D.IP)
[21:07:07] <ssbr_> kimundi: it doesn't; it returns false in the closure. And then once the for loop returns, I'd expect it does the return out of the outer function.
[21:07:08] <nmatsakis> ssbr_: there has been talk of implementing an analysis to check that the calling fn implements the protocol correctly (i.e., it stops when you return false) --- but that's deferred till after Rust 1.0 (if ever)
[21:07:23] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[21:07:36] <nmatsakis> it's never been a problem in practice, to my knowledge, though I'm sure someday someone will spent a long time debugging an error related to this.
[21:07:40] <kimundi> ssbr_: Sure? I don't see a way to pass the return value that way
[21:08:09] <ssbr_> this discussion is unclear
[21:08:14] <ssbr_> kimundi: https://gist.github.com/ssbr/d33694b7af69fe6a3c7d
[21:08:20] <ssbr_> ^ is what I mean
[21:09:00] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[21:09:32] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[21:09:32] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Jlqa6Q
[21:09:32] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[21:09:33] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[21:09:33] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/e-rg2w
[21:09:33] <ghrust> 13rust/06auto 14a033e77 15Alex Crichton: Implement util::swap without the '<->' operator
[21:09:33] <ghrust> 13rust/06auto 14459521d 15Alex Crichton: Stop using the '<->' operator
[21:09:33] <ghrust> 13rust/06auto 14f9efd77 15Alex Crichton: Remove the '<->' operator from the language
[21:09:36] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[21:09:42] <kimundi> hmm... strang I though it worked otherwise. oh well
[21:09:48] <graydon> n_boxes_swept: 1134 curr, 1419 total
[21:09:55] <graydon> 32bit gc is working
[21:09:57] <graydon> (ish)
[21:10:06] <brson> graydon: \o/
[21:10:23] *** Quits: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl) (Client exited)
[21:10:42] <strcat> ugh svn
[21:10:54] <tjc> Yay GC!
[21:11:03] * Sodel_the_V cheers
[21:11:03] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[21:11:04] *** Quits: dan_johnsin (dan_johnsi@6902762D.11B071D.FB9A45AF.IP) (Quit: Leaving)
[21:12:35] <graydon> we can possibly try landing it now. I'm not sure. performance is bad but rustc performance is normally bad. I should measure. hmm
[21:12:54] <pcwalton> I vote landing it
[21:14:20] <graydon> gosh
[21:14:34] <graydon> n_bytes_marked_from_tls: 385673015 curr, 561400308 total
[21:14:43] <Sodel_the_V> Oy vey!
[21:14:44] <graydon> 300 megs retained from TLS roots
[21:15:29] <pcwalton> that's weird
[21:15:34] *** Joins: froystig (froystig@4AB93A85.352137A1.BCED17D.IP)
[21:16:11] <Sodel_the_V> I used to be really intrigued by garbage collection algorithms and such. I might have to dig around that code sometime. :)
[21:16:14] <graydon> small boxes
[21:16:19] <graydon> n_boxes_marked_from_tls: 3682193 curr, 4690683 total
[21:16:28] <pcwalton> strings in the interner maybe?
[21:16:31] <graydon> yes
[21:16:40] <graydon> that's "3 million identifiers"
[21:16:52] <graydon> each with _amazing_ amounts of allocation overhead
[21:17:07] <strcat> we really need a vec type in the stdlib with small string optimization ;p
[21:17:16] <graydon> we really need a better interner!
[21:17:28] * graydon looks in the incoming queue
[21:17:30] <strcat> I bet 99% of them are under 23 characters
[21:17:31] <graydon> there's an interner there!
[21:17:35] <strcat> so they could all be unboxed.
[21:17:49] * graydon scuttles off to review it
[21:18:21] <graydon> wait, did it land?
[21:18:28] <pcwalton> something about the interner land
[21:18:29] <pcwalton> ed
[21:18:31] *** Quits: pyrac (pyrac@moz-B95F505.w92-156.abo.wanadoo.fr) (Quit: pyrac)
[21:18:32] *** Quits: froystig (froystig@4AB93A85.352137A1.BCED17D.IP) (Ping timeout)
[21:18:36] <pcwalton> but it's not a big improvement, just some allocation removal in rustc
[21:18:44] <graydon> oh
[21:18:54] <pcwalton> I like strcat's idea of small string optimization
[21:19:04] <jack> is it possible that we can build an interner appropriate for both servo and rust?
[21:19:33] <graydon> considering that we keep source maps ...
[21:19:36] <pcwalton> let's compress small lowercase identifiers with 5-bit Baudot code :)
[21:19:50] <graydon> it seems reasonable to me to just make the interned "value" a file:offset pair
[21:20:01] <graydon> er, file:offset:len triple
[21:20:35] <graydon> we could save the GC a lot of time if I could mark allocations as atomic
[21:20:38] <graydon> (i.e. "no pointers")
[21:20:46] <pcwalton> suppose our pointers are 8 bytes, then we could fit small lowercase identifiers of 12 characters into a pointer
[21:21:06] <strcat> well
[21:21:06] <graydon> oh don't start :(
[21:21:13] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[21:21:24] <strcat> libc++ string is 3 words (ptr, len, capacity) and they reuse 23 bytes (on x86_64) for SSO
[21:21:27] <pcwalton> I'm mostly kidding
[21:21:37] <graydon> hm hm hm
[21:21:53] <graydon> so running the gc in 32bit mode appears to ... possibly exhaust process address space?
[21:22:04] <graydon> I think that's what is going wrong
[21:22:08] <graydon> we gotta fix our memory use
[21:22:16] <graydon> time to bust out some massif
[21:22:18] <pcwalton> yes
[21:22:24] <strcat> graydon: remove the headers ;p
[21:22:27] <pcwalton> those profiling tools work now
[21:22:29] <pcwalton> with fast-ffi
[21:22:38] <graydon> strcat: yeah yeah
[21:22:42] <strcat> graydon: btw tcmalloc works too for heap profiling
[21:22:46] *** Quits: charmander (Mibbit@moz-19BAF9A2.pools.arcor-ip.net) (Quit: http://www.mibbit.com ajax IRC Client)
[21:22:48] <strcat> and it doesn't make everything dog slow
[21:22:54] <ldlework>  ssbr` | cadgu`a: no, there is no for loop that works correctly
[21:22:57] <graydon> you realize that if I even _correct_ the size of vecheaderrepr, the thing crashes?
[21:23:01] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[21:24:08] <strcat> except by default tcmalloc generates too much info and rustc makes me go OOM
[21:26:48] <strcat> graydon: did you try fixing the doc builder?
[21:27:14] <graydon> strcat: no, I did not. there's a clean step you can force. sec.
[21:27:46] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[21:28:14] <graydon> jack: your change landed, incidentally
[21:28:48] <strcat> I'm going to run out of disk space soon with all of these linux roots 
[21:29:10] <jack> graydon: because bors is awesome.
[21:29:40] <graydon> :)
[21:29:43] <strcat> I think bors should have commit access to himself
[21:29:54] <strcat> what could go wrong?
[21:29:58] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[21:30:05] <graydon> _everything_
[21:30:10] <graydon> that's like turning on skynet. don't do it!
[21:31:18] <libertas> sorry for this beginner question, but saw this line:  fail #fmt("usage: %s <filename>", args[0]);   that fails in Rust 0.6
[21:31:25] <pcwalton> use fmt!
[21:31:27] <pcwalton> instead of #fmt
[21:31:35] <libertas> ok thanks!
[21:31:40] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:34:44] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[21:35:14] *** Quits: Sodel_the_V (user@moz-853663E1.va.shawcable.net) (Quit: Back later)
[21:36:57] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[21:39:17] *** Quits: sdh_ (sdh@C957F273.8BDB8EF1.A76F6622.IP) (Quit: Konversation terminated!)
[21:40:49] *** Joins: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca)
[21:40:49] <EXetoC> I don't know how I'm supposed to be able to reference f32::ApproxEq
[21:41:05] <steven_is_false> libertas: Also use fail!(
[21:41:25] <pcwalton> EXetoC: this may not be it, but call the method under the trait, e.g. ApproxEq::approx_eq(1.0f32)
[21:41:35] <pcwalton> ApproxEq::approx_eq(1.0f32, 1.01f32) rather
[21:41:37] <graydon> brson: ping
[21:41:45] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[21:41:50] <steven_is_false> I have I question. Should Zero really have is_zero in it? It seems kind of sketchy to have that for floating point numbers for example.
[21:42:09] *** Quits: catpig (catpig@moz-E2E35BC8.dip0.t-ipconnect.de) (Quit: Verlassend)
[21:42:21] <ssbr_> steven_is_false: it's still useful for floating pointnumbers
[21:42:38] <steven_is_false> It's kind of weird to have -0.0, and +0.0 both satisfy is_zero
[21:42:39] <ssbr_> in that zero has very different behavior from other number, regardless of why it's zero (inaccuracies or whatever)
[21:42:49] <graydon> ohhh
[21:42:54] <graydon> I think we need to snapshot
[21:42:54] <strcat> steven_is_false: that doesn't really seem weird
[21:42:54] <steven_is_false> rusti -0.0
[21:43:03] <steven_is_false> rusti: -0.0
[21:43:10] <strcat> I'm operating on rusti
[21:43:12] *** Joins: cstrahan (cstrahan@moz-4C7E5789.hsd1.dc.comcast.net)
[21:43:14] <strcat> seccomp sandboxing
[21:43:16] <steven_is_false> strcat: Oh.
[21:43:20] <strcat> which means packaging seccomp ;p
[21:43:26] <graydon> nmatsakis: you didn't land a snap after that fix to the extra rooting / taking / strdup'ing, eh?
[21:43:39] <graydon> I think that misbehavior is actually in stage0
[21:43:41] <steven_is_false> The thing is Zero::zero can only return one of two values which is a zero.
[21:43:57] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[21:44:14] <strcat> steven_is_false: well it doesn't seem like it would be any worse without is_zero
[21:44:21] <strcat> it can still only return one
[21:44:24] <steven_is_false> strcat: Fair enough.
[21:44:55] <brson> graydon: pong
[21:45:11] *** Quits: lmandel (lmandel@FE1F74.86ED00A7.971E19F6.IP) (Quit: lmandel)
[21:45:52] <graydon> brson: massif is only noticing a small fraction of allocations. like 20% or so. any guess if we have .. "other" allocators at work anywhere?
[21:45:59] <graydon> other than malloc and operator new
[21:46:24] * strcat doesn't think so
[21:46:24] *** Quits: steven_is_false (quassel@moz-144077DE.bchsia.telus.net) (Client exited)
[21:46:33] <graydon> yeah. kinda interesting.
[21:46:57] <brson> it's only malloc
[21:47:07] <EXetoC> pcwalton: I actually wanted to call approx_epsilon, which is static. the others are invoked with the instance.member syntax and that works
[21:47:45] <brson> maybe context switches or stack switches confuse it as they do other tools
[21:48:05] <graydon> I'll run with 1 thread
[21:48:40] <strcat> brson: is there an env var to flip on mapping tasks to OS threads?
[21:48:57] <brson> i was thinking the ucontext switches, not the kernel switches
[21:49:07] <brson> strcat: no, but I have a solid plan for how to do it now
[21:49:16] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[21:49:26] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[21:51:01] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[21:55:51] *** Joins: tcsc (tcsc@moz-A838B260.dhcp.nwtn.ct.charter.com)
[21:55:58] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[21:56:07] *** Quits: tcsc (tcsc@moz-A838B260.dhcp.nwtn.ct.charter.com) (Quit: bye!)
[21:56:07] <pcwalton> EXetoC: just use ApproxEq::approx_epsilon
[21:56:13] <pcwalton> remember, static methods are under the crate
[21:56:13] *** Joins: tcsc (tcsc@moz-A838B260.dhcp.nwtn.ct.charter.com)
[21:56:31] <pcwalton> err
[21:56:32] <pcwalton> under the trait
[21:57:52] <EXetoC> oh. getting this though "error: unresolved name: `ApproxEq::approx_epsilon`."
[21:57:55] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[21:58:23] <pcwalton> that's odd
[21:58:23] *** Quits: Palmik (palmik@moz-DADC71F0.pks.muni.cz) (Quit: Lost terminal)
[22:02:27] <EXetoC> yeah? ok I'll just return 1.0e-6 in my impls of the same trait. simple workaround
[22:03:22] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:03:40] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[22:03:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 140e7c99b to 14d546493: 02http://git.io/N3iJvQ
[22:03:40] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[22:03:41] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[22:03:41] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/yYrY1Q
[22:03:41] <ghrust> 13rust/06auto 14a033e77 15Alex Crichton: Implement util::swap without the '<->' operator
[22:03:41] <ghrust> 13rust/06auto 14e90a6dd 15Alex Crichton: Stop using the '<->' operator
[22:03:41] <ghrust> 13rust/06auto 14dd1c0a5 15Alex Crichton: Remove the '<->' operator from the language
[22:03:43] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[22:04:43] <pcwalton> acrichto: now you see the pain I go through every day removing stuff from the language :)
[22:05:02] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[22:05:08] <pcwalton> no matter how terrible the feature is (today's feature: naming a variable 'self' that isn't 'self'), someone will use it
[22:05:44] <strcat> pcwalton: I've used it as a workaround ;p
[22:05:50] <pcwalton> it's about to go
[22:05:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:06:09] <strcat> can have 'mut' on parameters now which is what I used it for
[22:06:15] <strcat> don't know if it works on self though.
[22:06:40] <pcwalton> it doesn't, it should though
[22:07:18] <acrichto> haha, I see what you mean, I just feel bad about taking up bors all day :(
[22:07:29] <pcwalton> it's no problem, language feature removals are #1 priority as far as I'm concerned
[22:07:36] <pcwalton> they tend to be disruptive
[22:07:47] <acrichto> yeah I can imagine
[22:08:11] <pcwalton> the for loop protocol bounced
[22:08:14] <pcwalton> if you didn't see
[22:08:46] <acrichto> yeah, I'll try to get that fixed before <-> finishes
[22:08:54] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[22:09:32] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[22:09:46] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:10:25] <graydon> hm
[22:10:26] <acrichto> ah, turns out when you duplicate code, git will happily merge the original code and you'll never know about the changes...
[22:10:29] <graydon> I do not understand ast_map
[22:10:35] <graydon> anyone want to enlighten me?
[22:10:46] <pcwalton> graydon: it just stores a mapping from def_id to various boxes in the ast
[22:10:48] <pcwalton> from def_ids
[22:11:32] <strcat> acrichto: yeah it doesn't play well with the cfg(stage0) stuff.
[22:11:52] <graydon> pcwalton: what is node_callee_scope()? 
[22:11:56] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[22:11:57] <pcwalton> uh, no idea
[22:12:22] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Quit: Leaving)
[22:12:27] <graydon> "expressions which are or might be calls"
[22:12:45] <graydon> hm. looks like we store a callee-id (def id) for every such node?
[22:13:39] *** Quits: cdidd (cdidd@moz-6E84D9A.broadband.corbina.ru) (Input/output error)
[22:15:40] *** Joins: ysuzuki (ysuzuki@moz-60FA9D06.net119083145.t-com.ne.jp)
[22:17:19] *** Joins: bEcker (Thunderbir@moz-20F755D7.resnet.ucsc.edu)
[22:18:26] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:18:53] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[22:20:47] *** Joins: Jesse (jruderman@moz-BE33DA21.fw1.sfo1.mozilla.net)
[22:20:52] <EXetoC> pcwalton: I can't reference Float/f32::epsilon either. do they not have to be public?
[22:21:00] *** Parts: bEcker (Thunderbir@moz-20F755D7.resnet.ucsc.edu) ()
[22:21:21] <pcwalton> not sure what you mean
[22:23:14] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[22:23:23] <acrichto> pcwalton: r? https://github.com/mozilla/rust/pull/6223
[22:23:54] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:24:36] <EXetoC> pcwalton: I can't access those trait members either. I don't know if protection attributes are relevant in this case (pub etc)
[22:24:52] <pcwalton> I'm confused then
[22:25:01] <pcwalton> protection attributes are not relevant for traits
[22:25:20] <EXetoC> ok. not sure what's going on then
[22:25:57] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:25:57] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[22:26:06] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[22:30:53] *** Joins: raisin (Mibbit@moz-E9973F34.dynamic.qsc.de)
[22:31:22] <graydon> if I have a struct, and it contains a ~str, is it possible for me to say anything about the lifetime of slices taken from that ~str?
[22:31:22] <pcwalton> nmatsakis: r? https://github.com/mozilla/rust/pull/6412
[22:31:22] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:31:32] <graydon> (like, that they are a sub-lifetime of the lifetime of the struct?)
[22:31:37] <pcwalton> graydon: yes, precisely that
[22:31:44] <graydon> how do I denote that?
[22:31:59] <graydon> struct foo { buf: ~str; slice: ??? }
[22:32:14] <pcwalton> struct Foo<'a> { buf: ~str; slice: &'a str }
[22:33:03] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[22:33:13] <EXetoC> "assert!(Float::NaN::<float>().clamp(&2f, &4f).is_NaN())" that's in float.rs, but I can't access those symbols myself
[22:33:13] <graydon> and when I take a slice of buf, it'll just normally have that?
[22:33:38] <strcat> graydon: the slices point into the buf?
[22:33:43] <strcat> I think they have to be stored separately
[22:33:58] <graydon> they're being stored separately. how separately?
[22:34:18] *** Quits: raisin (Mibbit@moz-E9973F34.dynamic.qsc.de) (Quit: http://www.mibbit.com ajax IRC Client)
[22:34:51] <strcat> graydon: well you need to be able to construct the buffer first and then the slices without touching the buffer again
[22:35:01] <graydon> yeah
[22:35:10] <graydon> how would I go about doing that?
[22:35:23] <strcat> maybe Option<&'self str>
[22:35:30] <strcat> and then add it post-construction
[22:35:32] <strcat> not sure...
[22:35:36] <graydon> hm
[22:35:44] <jack> pcwalton: what is the syntax keyword for?
[22:35:50] <graydon> and the fact that I want to extend the buffer while it's going .. probably kills this idea dead
[22:35:55] <strcat> graydon: yeah
[22:36:07] <pcwalton> jack: syntax keyword?
[22:36:16] <pcwalton> oh oops
[22:36:17] <pcwalton> I meant static.
[22:36:22] <pcwalton> syntax was a keyword in very early rust.
[22:36:41] <strcat> heh, static isn't a keyword right now?
[22:36:44] <jack> ok. i thougth it was something i hadn't heard about yet :)
[22:37:17] <acrichto> ugh, the <-> pr failed again 
[22:37:38] <EXetoC> whatever, minor issue. cya!
[22:37:40] *** Quits: EXetoC (ex@moz-C741B177.customer.t3.se) (Quit: WeeChat 0.4.0)
[22:38:22] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:39:42] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[22:39:42] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145d149cd to 14d546493: 02http://git.io/N3iJvQ
[22:39:42] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[22:39:45] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[22:39:45] <ghrust> 01[13rust01] 15bors pushed 10 new commits to 06auto: 02http://git.io/X9lkvA
[22:39:46] <ghrust> 13rust/06auto 140cde8ba 15Alex Crichton: Implement a new protocol for `for` loops that's much more easily composable
[22:39:46] <ghrust> 13rust/06auto 142825605 15Alex Crichton: core: Use the new `for` protocol
[22:39:46] <ghrust> 13rust/06auto 143ce9dba 15Alex Crichton: std: Use the new `for` protocol
[22:39:48] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[22:40:02] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[22:40:58] <jdm> so tempted to ask for someone to tell me how D compares to Rust in the comment thread on tagged unions on proggit
[22:41:09] <graydon> let it go ::(
[22:41:17] <jdm> I kid, I kid
[22:43:36] <jack> jdm: in that comment thread, the D code looks a lot denser than rust.
[22:43:46] <jack> they also appear to use way more ALLCAPS
[22:44:40] <tjc> well, all caps is cruise control for cool, so
[22:44:46] <tjc> clearly, Rust needs more of it
[22:45:00] <jdm> I don't know what that sentence means, but it sounds really quotable
[22:45:09] <jack> let's call it RUSTC :)
[22:45:18] <jack> it'll be right at home on windows :)
[22:45:22] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:45:25] <tjc> RUSTC.EXE
[22:45:31] <jdm> RUSTC~1.EXE
[22:45:42] <tjc> heh
[22:46:01] *** jack is now known as JACK
[22:46:13] * JACK is cooler than you lowercase peeps
[22:46:14] <tjc> see
[22:46:18] <tjc> you're 95% cooler already
[22:46:47] <ion> The nick change reminds me of CAPS LOCK DAY.
[22:46:52] *** JACK is now known as jack
[22:47:02] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[22:47:06] <tjc> CAPS LOCK DAY ALWAYS LIVES ON IN OUR HEARTS
[22:47:09] <jack> ion: hahahah http://capslockday.com/
[22:47:17] <jack> i had no idea this was a thing
[22:47:24] <tjc> excellent
[22:47:27] <jdm> this is beautiful
[22:47:34] <jdm> I miss my old IRC hangouts which were caps-only
[22:47:49] <jack> oh man. i should file a bug against servo. i cannot wait until it can render this page
[22:47:51] <acrichto> pcwalton: r? https://github.com/mozilla/rust/pull/6260 hopefully this is the last one unless it conflicts with the `for` patch
[22:48:14] <pcwalton> r+ thanks
[22:49:54] *** Joins: FrozenCow (FrozenCow@moz-9DF5D010.dynamic.upc.nl)
[22:51:47] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:52:23] *** Quits: Jesse (jruderman@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: Jesse)
[22:53:07] *** Quits: mdu (mdu@moz-9962C9F4.rev.numericable.fr) (Quit: mdu)
[22:53:58] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[22:54:10] <graydon> does anyone know how to make rust-mode.el happy with 'a region bounds?
[22:54:49] <tjc> graydon: no, but if you figure out how, I'll be thrilled
[22:55:02] <strcat> graydon: run vim inside it :D
[22:55:13] <jdm> wah wah
[22:55:49] <ssbr_> I absolutely in no way understand the errors I am getting: https://gist.github.com/ssbr/49f9db3be773efecc8a7
[22:55:58] <ssbr_> also this is the ugliest rust code I have ever written, or seen
[22:56:09] <ssbr_> (a2peekit is)
[22:58:40] <ssbr_> It says it's inferring the lifetime of a based on the expression "a", and comes up with two different lifetimes and fails. I don't get it at all.
[22:58:44] <ssbr_> egh
[22:58:48] <ssbr_> the lifetime of a.iter()
[22:59:07] <tjc> nmatsakis: ssbr_ needs some help deciphering some borrowck errors ^
[22:59:09] <ssbr_> Maybe I should do something less clever.
[22:59:25] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[22:59:30] <ssbr_> (that generic is... damn.)
[22:59:40] <ssbr_> "pub fn a2peekit<'life, T>(a: &'life [T]) -> PeekIterator<T, MapIterator<'static, &T, T, vec::VecIterator<'life, T>>>"
[22:59:42] <ssbr_> tee hee.
[23:00:46] *** Joins: devbug (quassel@moz-E1DE087C.bchsia.telus.net)
[23:00:47] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:01:03] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[23:02:38] <brson> bors should count how many times a patch bounces
[23:02:51] <tjc> and we should give an award to the patch that lands after the most bounces
[23:02:58] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:03:08] <strcat> rusti: core::run::run_program("dmesg", []);
[23:03:11] <rusti> more than 5 lines of output, pastebinned: http://sprunge.us/CchU
[23:03:17] <strcat> thanks for nothing seccomp
[23:03:19] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[23:03:54] <libertas> in let r = file_reader(args[1]);    what's the current version of    if result::failure(r) { ... ?
[23:04:00] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:04:03] <strcat> rusti: core::run::run_program("dmesg", []);
[23:04:04] <rusti> dmesg: read kernel buffer failed: Too many links
[23:04:10] <strcat> well...
[23:04:14] <brson> libertas: r.is_err()
[23:04:17] <strcat> close enough.
[23:04:46] <libertas> thanks brson
[23:04:46] *** Joins: lmandel (lmandel@FE1F74.86ED00A7.971E19F6.IP)
[23:06:13] <strcat> lxc's seccomp support was definitely not designed for humans
[23:06:55] <strcat> http://ix.io/5A4 container.cfg, http://ix.io/5A5 seccomp.txt
[23:07:10] <strcat> you have to manually whitelist the allowed syscalls by their number....
[23:07:46] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[23:07:56] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[23:10:14] <mcpherrin> If all you want to allow is read/write/exit, it's not that bad...
[23:10:32] <mcpherrin> (I used seccomp for programming contest isolation)
[23:10:45] <ssbr_> OH
[23:10:47] <ssbr_> duh
[23:11:03] <ssbr_> it's because I go from &'life T to T, not &T to T
[23:11:15] <ssbr_> (this is not what the error seemed to say at all, to me)
[23:11:19] <strcat> awk '{ print $3 }' /usr/include/asm/unistd_64.h | tail -n +4 | head -n -2 | grep -v 103 for now ;p
[23:11:31] <ssbr_> nmatsakis: ^
[23:11:34] <strcat> mcpherrin: yeah just slowly making rusti's container saner
[23:11:41] <strcat> maybe one day I can take it out of the VM
[23:12:09] <strcat> rust uses a fair bit of syscalls
[23:12:16] <strcat> I guess I could strace it and start with those
[23:12:22] <strcat> just add them until it runs...
[23:12:29] <strcat> you don't get sane errors though
[23:12:38] *** Quits: bbrittain (ben@moz-632384CB.dr02.roch.ny.frontiernet.net) (Quit: Leaving)
[23:12:44] *** Joins: maxli (maxli@C03F2759.C70D537E.2FA4EA88.IP)
[23:12:55] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[23:13:15] <mcpherrin> are you using straight up seccomp or the -bpf stuff
[23:13:30] <strcat> mcpherrin: lxc, which uses libseccomp
[23:13:37] <strcat> which is seccomp2, I guess the bpf stuff
[23:13:59] <strcat> rusti: core::run::run_program("ps", [~"ax"]);
[23:14:00] <rusti>   PID TTY      STAT   TIME COMMAND
[23:14:00] <rusti>     1 ?        S+     0:00 su -lc cd /home/rust && rustc foo.rs && exec ./foo rust
[23:14:00] <rusti>     3 ?        Ssl    0:00 ./foo
[23:14:00] <rusti>    14 ?        R      0:00 ps ax
[23:14:41] <strcat> it uses namespaces, cgroups, a read-only / and now a bit of seccomp ;p
[23:14:58] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[23:15:09] <strcat> all wrapped in qemu for now.... but I have the bot itself running in qemu instead of spinning up a new one each time
[23:16:59] * strcat would love it in nspawn learned to do this stuff instead of lxc
[23:17:05] <strcat> s/in/if/
[23:17:37] <strcat> oh and it drops basically all the capabilities.
[23:17:51] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Quit: ChatZilla 0.9.90 [Firefox 21.0/20130506154904])
[23:18:37] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:18:37] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f45d36a to 14d546493: 02http://git.io/N3iJvQ
[23:18:37] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:18:39] *** Joins: ghrust (ghrust@moz-4EF5B6E5.rs.github.com)
[23:18:39] <ghrust> 01[13rust01] 15bors pushed 27 new commits to 06auto: 02http://git.io/ECOMfg
[23:18:39] <ghrust> 13rust/06auto 14b68c464 15Brian Anderson: core::rt: Remove Close trait...
[23:18:39] <ghrust> 13rust/06auto 1497d54b5 15Brian Anderson: core::rt: Fix a warning about unnecessary mutable variable
[23:18:39] <ghrust> 13rust/06auto 14e523d14 15Brian Anderson: core::rt: Begin implementing TcpStream...
[23:18:41] *** Parts: ghrust (ghrust@moz-4EF5B6E5.rs.github.com) ()
[23:19:59] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[23:20:29] *** Joins: dbaupp (Thunderbir@moz-856B3C14.lns20.syd6.internode.on.net)
[23:21:58] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[23:23:27] <brson> I'm thinking about whether I want to copy the libuv doc comments into the rust bindings. I think the only legal requirement there would be to reproduce their license headers in our source files. Does this seem disirable, undesirable?
[23:26:55] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[23:27:29] <ssbr_> Why is assert_eq! a macro/syntax-extension and not a function, by the way?
[23:27:47] <ssbr_> It seems like the sort of thing that could be a function fairly easily (and is, in Java/Python/etc.)
[23:27:49] <brson> ssbr_: being a macro gives it access to info about line numbers, files, etc.
[23:28:05] <brson> as a function it can't tell you where the assertion was
[23:28:05] <ssbr_> brson: ahhhh, right
[23:28:12] <ssbr_> python/java do that via exceptions
[23:28:14] <ssbr_> makes sense
[23:28:18] <strcat> ssbr_: if we had tracebacks by default in debug builds it wouldn't really be needed
[23:28:47] <ssbr_> I was just considering that I might want to replace it with something with prettier output, for my own usage, but then I can't have a library that exports a macro.
[23:28:58] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[23:29:03] <ssbr_> so I can't _really_ replace it.
[23:29:49] <strcat> ssbr_: I think a library can export a macro now
[23:30:03] <ssbr_> strcat: well that wasn't true this morning!
[23:30:10] <ssbr_> (I mean a crate)
[23:31:00] *** Joins: dherman (dherman@moz-BE33DA21.fw1.sfo1.mozilla.net)
[23:31:00] *** ChanServ sets mode: +o dherman
[23:32:56] *** aatch|bed is now known as aatch
[23:33:00] <aatch> brson, ping
[23:34:48] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[23:35:25] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[23:35:47] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[23:36:59] <graydon> did we switch back to capturing values taken from enum-bodies by ref again?
[23:37:12] <graydon> Some(x) in a pattern means x is a &?
[23:37:12] <brson> aatch: pong
[23:37:35] <graydon> oic. hashmap returns Option<&>
[23:37:37] <graydon> nm
[23:37:37] <strcat> graydon: no that's a move
[23:38:09] <aatch> brson, I was looking at implementing the work-stealing deque mentioned in #4877
[23:38:53] <aatch> I noticed that the scheduler uses push_front, but the algorithm relies on that not being option for correctness
[23:39:46] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[23:40:24] *** Quits: dherman (dherman@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[23:40:35] *** Quits: nass (nass@4F314BB3.5408CE6B.B38D1DE0.IP) (Ping timeout)
[23:40:36] <brson> aatch: it depends on which end you consider front. we should use the terminology from the paper, but either push_front or push_back should not exist
[23:40:41] <brson> aatch: so it's fine to remove one
[23:40:54] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[23:40:56] <aatch> brson, I'm using the push_bottom, pop_bottom and steal from the paper
[23:41:13] <brson> aatch: ok
[23:41:29] <brson> aatch: are you doing the lock-free version?
[23:41:36] <aatch> (not that my implementation works at all atm, but that's besides the point)
[23:41:39] <aatch> brson, yep
[23:41:46] <brson> awesome!
[23:42:06] <aatch> I'm assuming you have some way for the schedulers to steal from each other?
[23:42:19] <aatch> (or some idea for it)
[23:42:52] <thiez> aatch: I was wondering if you had made any progress on the atomic types (#5042)?
[23:42:59] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[23:43:09] <aatch> thiez, unfortunately no.
[23:43:23] <aatch> I'm not really sure how to proceed either
[23:44:45] <thiez> you mind if I give it a shot?
[23:44:52] <aatch> thiez, go for it.
[23:45:09] <thiez> will do :)
[23:45:33] <aatch> LLVM implements the atomic load and store as options to the regular load and store btw
[23:45:50] *** Quits: mschifer1 (Adium@2557E599.66715431.D25A875A.IP) (Quit: Leaving.)
[23:45:51] <aatch> and there is no llvm-c binding for it, so you'll have to add it.
[23:46:15] *** Quits: lmandel (lmandel@FE1F74.86ED00A7.971E19F6.IP) (Quit: lmandel)
[23:46:27] <thiez> I think I have a pull-request from Luqman lying around somewhere that shows how to add intrinsics
[23:47:07] <thiez> should be able to figure it out
[23:47:17] <aatch> thiez, it might be easier to handle atomic type as special though, like C++ does
[23:47:18] *** Joins: jyasskin_w (jyasskin@DAF66858.C60FE7DC.4065847B.IP)
[23:47:32] <aatch> even if it means marking them as #[atomic]
[23:47:36] *** Quits: spider-mario (spidermari@moz-2BC095A6.rev.sfr.net) (Input/output error)
[23:48:01] <thiez> what would be the advantage of that?
[23:48:27] *** Quits: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP) (Ping timeout)
[23:48:47] <thiez> as far as I'm aware only the llvm backand optimizes, so as long as we emit the correct instructions for some library-defined atomic type it should be okay
[23:49:08] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[23:49:16] * thiez knocks on wood.
[23:49:45] <brson> aatch: there's no code in place for it yet but I have lots of ideas about various things. some major components: 1) there's a shared, fixed-sized list of Option<WorkQueueHandle> that contains active schedulers, and that stealing schedulers look through to find candidates, 2) schedulers that look into their work_queue and find nothing to do start stealing. the hard part I think will be efficiently waking up schedulers that previously decided there w
[23:49:45] <graydon> there. I have an interner that just stuffs all the strings in one buffer and gives you indexes into it
[23:49:46] *** Joins: ssbr (scorchsabe@A9D9D38C.B6F034AC.72A31D6.IP)
[23:49:47] <aatch> thiez, I guess it depends on how they are implemented I suppose
[23:50:12] <strcat> graydon: now *that* would be a perfect place to use an SSO type :)
[23:50:19] <brson> aatch: operations on the shared WorkQueueHandle list need to be randomized
[23:50:32] <graydon> strcat: hm?
[23:50:45] <brson> aatch: so schedulers that add themselves to it put their handle in a random slot, and stealers start stealing at a random slot
[23:51:42] <thiez> no organized crime in our runtime, all theft is random
[23:51:53] <strcat> graydon: if the strings were 24-byte instead of 8-byte pointers and most of them could store the strings in-place in the array without any boxes, it would probably be a big win
[23:52:04] <thiez> graydon: I like the new bors status page
[23:52:19] <graydon> strcat: there are no boxes in this thing. it's a concatenation of all the bytes from within all the strings.
[23:52:22] <nmatsakis> ssbr_: sorry that was so cryptic; I have some ideas how to improve those messages, but nothing drastic
[23:52:26] <strcat> graydon: ah
[23:52:40] <graydon> strcat: with a single null byte between each. and an "interned value" is an offset to the beginning.
[23:52:44] <graydon> of each byte-span
[23:53:04] <graydon> the hashmap stores (hashcode,offset)
[23:53:14] <aatch> brson, if I open an issue, do you mind putting some of these notes on it? Just to remind me of the considerations I need to take
[23:53:20] <graydon> and if there's a miss, we increment the hashcode (making it a manually-arranged multimap)
[23:53:38] <aatch> Or possibly adding to #4877?
[23:53:56] <graydon> it's crude but ... possibly the easiest fix for a memory-win. and we need some memory wins. I literally can't land the gc until we're using less memory on 32bit.
[23:54:10] <graydon> "it uses more than 2gb" starts to be a "it can't run" problem
[23:54:47] <brson> aatch: I've been meaning to write up a plan for this. I'll make a note to myself to do so over the weekend.
[23:54:51] <strcat> graydon: we're compiling much bigger translation units than people do in C so LLVM probably uses a lot too
[23:54:54] *** Quits: ssbr_ (ssbr@moz-6A5A684C.wireless.utoronto.ca) (Ping timeout)
[23:55:00] <graydon> I know
[23:55:05] <graydon> but I can't change that in one day
[23:55:08] <graydon> I can fix the interner
[23:55:08] <strcat> well I guess people do have really big .c files...
[23:55:12] <graydon> and it's eating ~300mb
[23:55:23] <strcat> ugh my internet is barely working
[23:55:39] <strcat> chugging along at 20KiB/s instead of 20MiB/s ;\
[23:55:48] <strcat> err, Mib ;p
[23:55:50] <graydon> I may also phase the GC landing and do a "remove the headers" step after the trie is tracking allocations
[23:56:04] <graydon> but I'm not sure that'll help. the trie uses just as much.
[23:56:48] <strcat> will help for ~
[23:57:00] <graydon> yeah. but .. removing 3 million boxes will help all these.
[23:57:04] <graydon> (the interner)
[23:57:15] <strcat> the trie uses ~ ;p
[23:57:23] <graydon> I know
[23:57:29] <graydon> and currently we're paying _both_ to get the gc working
[23:57:31] <graydon> trie and headers
[23:57:51] <strcat> I need to make an array-based map to use for suffix buckets in the trie
[23:57:52] <graydon> unfortunately I think there's a snap in there required
[23:58:08] <graydon> to switch stage0 from expecting-headers to not
[23:58:10] <strcat> got annoyed last time by LLVM asserts from tuples
[23:58:17] <graydon> (namely, switching the annihilator from list to trie)
[23:58:30] <graydon> getting that snap through requires (I think) at least one build that's using both
[23:58:46] <graydon> so again: time to get rid of the 3m boxes I can, first :)
[23:58:54] *** Joins: ssbr_ (ssbr@moz-6A5A684C.wireless.utoronto.ca)
