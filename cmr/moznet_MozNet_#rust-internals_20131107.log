[00:03:59] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[00:05:08] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[00:09:22] <acrichto> brson: hm, I'm going to take some more time and add tests for all this
[00:09:32] <acrichto> brson: is it safe to say that linked failure will stick around in some fashion?
[00:09:51] <acrichto> b/c if we just want to guarantee that I/O is cancellable then I think we need to do this anyway
[00:11:17] <brson> acrichto: i'm not sure what will happen to linked failure. i would like to remove it completely and see what doesn't work, then re-add features in small increments
[00:12:00] <acrichto> ok, I think that these tests may just be good for completeness anyway
[00:12:10] <acrichto> you ok if I add a bunch of tests and get it working for now at least?
[00:14:59] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[00:15:27] <brson> sure
[00:17:30] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[00:17:30] *** ChanServ sets mode: +o tjc
[00:23:07] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[00:27:03] <tjc> acrichto: ping
[00:27:08] <acrichto> tjc: pong
[00:27:25] <tjc> acrichto: Hey, if I pull changes now, ought I to expect that that uv_support problem will be fixed?
[00:27:30] <tjc> the one where I had to manually change the link args
[00:27:35] <acrichto> sadly no, the snapshot never got made
[00:27:36] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Ping timeout)
[00:27:39] <acrichto> (it's trying again now)
[00:27:54] <tjc> ok, that's fine, I'll just keep making the change manually
[00:28:01] <tjc> Just wanted to make sure something wasn't fundamentally wrong with the universe :-)
[00:29:41] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[00:34:53] <acrichto> brson: hm, it appears that handling linked failure at all correctly involves modifying the scheduler
[00:35:33] <acrichto> brson: when a task is awoken for linked failure, it appears to be enqueued in the scheduler of the task invoking the failure originally (and is then available for work stealing as well), but the task *must* be awoken on the home I/O scheduler
[00:36:41] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[00:37:27] <brson> acrichto: can it just re-home during unwinding?
[00:37:46] <acrichto> brson: I hope so, otherwise homing will get real expensive
[00:38:22] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[00:41:47] *** Quits: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net) (Quit: Leaving.)
[00:42:03] <acrichto> brson: hm, so I had that original patch when optimizing homing I/O which would pin the task to the I/O scheduler temporarily
[00:42:09] *** Joins: lbergstrom (Adium@moz-5D8E4B14.lightspeed.cicril.sbcglobal.net)
[00:42:09] <acrichto> I think that may be the best solution
[00:43:51] <acrichto> brson: although instead of creating a uv_async_t every time, we could make creation of SchedHandles super-cheap (with the Clone implementation I added)
[00:44:07] <acrichto> which believe would make this re-homing issue moot
[00:54:01] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[00:59:00] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[01:00:23] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[01:05:57] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[01:07:59] *** Quits: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP) (Ping timeout)
[01:19:40] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[01:20:58] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[01:29:57] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[01:32:02] *** Joins: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP)
[01:32:38] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:36:23] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[01:36:57] *** Joins: brson (brson@6A848D32.C1B840DD.76F66111.IP)
[01:36:57] *** ChanServ sets mode: +qo brson brson
[01:38:19] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[01:46:38] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[01:48:47] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[01:57:24] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:57:41] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:57:53] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:58:01] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:58:21] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:58:26] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:00:23] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:00:27] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:01:26] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:01:35] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Ping timeout)
[02:01:35] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:04:18] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:04:22] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:04:33] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:04:42] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:07:25] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[02:08:40] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Quit: Leaving...)
[02:11:01] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[02:17:22] <Luqman> er, what decides if a symbol is external?
[02:18:57] <dbaupp> Luqman: I believe everything in an executable is internal (except for `main` presumably), and "reachable" things in a library are external
[02:19:14] <dbaupp> i.e. publically accessible, or used in an #[inline] or generic function.
[02:19:45] <Luqman> well that explains why my SDL_main function wasn't being found :/
[02:20:19] <strcat> Luqman: there's no way to expose symbols from a binary atm
[02:20:26] <strcat> s/binary/executable/
[02:20:35] <strcat> other than the entry point
[02:21:47] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[02:22:42] <Luqman> well that's really annoying :/
[02:24:22] <Luqman> i guess i can try writing sdl's pre-main setup stuff in rust
[02:24:37] <strcat> Luqman: doesn't sdl2 not need that anymore?
[02:25:03] <Luqman> that's right!
[02:25:17] <Luqman> so scratch that, no to just find/make bindings for that
[02:25:23] <strcat> http://wiki.libsdl.org/MigrationGuide#Overview_of_new_features
[02:25:27] <strcat> Luqman: yeah it's a lot better
[02:25:42] <strcat> the steam linux stuff is pretty much all sdl2... valve has devs working on it
[02:25:52] *** Quits: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP) (Ping timeout)
[02:25:56] <strcat> they were shipping stuff with it before it was released ;p
[02:27:21] <Luqman> i wonder if sdl2 has been ported to most of the platforms 1 supported
[02:29:22] <dbaupp> Luqman: https://github.com/AngryLawyer/rust-sdl2
[02:29:47] <Luqman> strcat: haha the migration guide even mentions steam xD "...which means you'll get faster blits, a working Steam Overlay, and scaling for free. "
[02:36:14] <brson> somebody rewrote our thread bindings while i wasn't looking. i'm so happy
[02:37:30] <klutzy> I'm trying to build rust on mingw-w64-32bit then I found it is broken for funny reason
[02:37:59] <klutzy> latest mingw (not mingw-w64) contains some new functions but they forgot to add new structs it use
[02:38:23] <klutzy> so it just fails to build.. so we have patched rust to define them outside of mingw
[02:38:52] <klutzy> but mingw-w64 has them, so duplicated struct error has found
[02:39:19] <klutzy> it's quite ridiculus
[02:44:13] <Luqman> klutzy: :( i guess for now that means sprinkling __MINGW64__
[02:46:34] <klutzy> Luqman: seems like __MINGW64__ is not defined on 32-bit mingw64
[02:50:08] <Luqman> klutzy: what does ` echo "" | gcc -E -dM - | find /i "mingw" ` show?
[02:52:04] <klutzy> Luqman: grep -i "mingw"? `#define __MINGW32__ 1` only
[02:52:42] <Luqman> oh right, grep works in msys
[02:52:54] <Luqman> but yea, that's unfortunate :/
[02:54:33] <klutzy> maybe we can play with __MINGW32_MAJOR_VERSION
[02:54:38] <Luqman> try asking in #mingw-64 on OFTC
[02:54:43] <klutzy> ..and __MINW64_VERSION_MAJOR
[02:56:05] <Luqman> er, i meant mingw-w64
[02:56:14] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[02:56:41] <klutzy> I didn't know it exists. thanks :D
[02:57:28] <klutzy> anyway we have to check __MINGW32_VERSION since mingw bugs are likely to be fixed soon
[02:58:23] <Luqman> if there is a fixed version we could just say that's the minimum requirement we want
[02:58:55] <strcat> or we could just drop mingw support and use mingw-w64 ;p
[02:59:40] <Luqman> well we need it in the meantime at least till we have w64 builds
[03:00:15] <strcat> mingw-w64 has 32-bit support
[03:00:26] <strcat> there's no reason to use mingw
[03:00:32] <strcat> afaik at least ;p
[03:01:03] <Luqman> yes, really we just need to bootstrap a build
[03:01:18] <klutzy> one downside is mingw-w64 provide no msys out of the box, so we have to teach users how to set up
[03:01:56] <strcat> klutzy: won't rustc run fine without msys?
[03:02:22] <Luqman> afaik you only need msys if you're building rust yourself
[03:02:39] <klutzy> ah right
[03:03:11] <klutzy> well, anyway we have to teach how-to since mingw's msys is also broken when they upgraded installer
[03:03:47] <klutzy> they forgot to run some script which sets /etc/fstab
[03:06:16] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[03:07:08] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[03:11:00] *** Joins: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP)
[03:24:53] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[03:29:03] *** Quits: brson (brson@6A848D32.C1B840DD.76F66111.IP) (Ping timeout)
[03:31:35] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[03:32:06] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[03:35:18] *** Quits: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP) (Ping timeout)
[03:44:58] <strcat> dbaupp: there's still 3 cases of 'staticant' >.<
[03:47:32] <benh> :D
[03:48:22] *** Quits: zz_kimundi (kimundi@moz-4392BF18.dip0.t-ipconnect.de) (Ping timeout)
[03:48:49] *** Quits: StarLight (StarLight@moz-93E2906B.dynamic.avangarddsl.ru) (Connection reset by peer)
[03:52:02] *** Joins: zz_kimundi (kimundi@moz-C83B8CEE.dip0.t-ipconnect.de)
[03:52:03] *** zz_kimundi is now known as kimundi
[03:53:49] *** Joins: StarLight (StarLight@moz-8EAA71F9.dynamic.avangarddsl.ru)
[03:59:45] <dbaupp> strcat: hahaha :D
[03:59:54] *** Joins: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP)
[04:04:19] *** Quits: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP) (Ping timeout)
[04:05:12] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[04:08:13] *** Joins: pcwalton (pcwalton@moz-B51927E9.hsd1.ca.comcast.net)
[04:08:13] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:08:52] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Quit: Leaving...)
[04:10:21] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[04:15:11] *** Joins: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP)
[04:31:14] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:31:14] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/xu4bPQ
[04:31:14] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:31:16] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[04:31:16] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ze9V3w
[04:31:16] <ghrust> 13rust/06auto 144b77044 15Alex Crichton: Register new snapshots
[04:31:16] <ghrust> 13rust/06auto 147fc6893 15bors: auto merge of #10328 : alexcrichton/rust/snapshots, r=thestinger
[04:31:17] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[04:33:45] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[04:35:53] *** Joins: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[04:48:42] *** Joins: jdm (jdm@moz-36808BF3.dsl.teksavvy.com)
[04:56:12] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[04:56:56] *** Quits: tikue (tikue_star@61D9B7A5.CD72397.689607DE.IP) (Ping timeout)
[04:58:21] *** Quits: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb_)
[05:02:29] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[05:17:15] *** Joins: eddyb (eddy@717B0165.D51DAF03.FB866788.IP)
[05:27:25] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[05:30:34] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Ping timeout)
[05:32:21] <sfackler> acrichto: does the monospace font in rustdoc show up really big to you in OSX?
[05:32:44] <acrichto> sfackler: yes
[05:33:15] <strcat> isn't it using @font-face?
[05:33:50] <sfackler> do you know if that's filed?
[05:34:03] <cmr> sfackler: the one used in headers?
[05:34:11] <cmr> ie, the trait impls?
[05:35:01] <sfackler> cmr: yeah. it's also used in inline stuff `like this` where the size difference is more noticable
[05:35:16] <cmr> ah
[05:36:07] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[05:36:07] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ze9V3w
[05:36:07] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[05:36:21] <sfackler> cmr: http://imgur.com/6SAMsSq
[05:36:28] <cmr> oh yikes
[05:37:33] <strcat> sfackler: is it a high DPI laptop?
[05:37:42] <sfackler> yeah
[05:38:07] <strcat> it looks like the docs are using px, and px is defined in terms of 'cm' which is totally unrelated to actual centimeters and afaik should be avoided ;p
[05:38:16] * strcat isn't a web dev though
[05:48:46] *** Joins: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[05:54:16] *** Joins: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk)
[06:39:59] <klutzy> https://github.com/mozilla/rust/issues/10329#issuecomment-27941124
[06:40:01] <klutzy> this was horrible
[06:40:35] <cmr> that's... curious
[06:40:37] <dbaupp> klutzy: o_O ... mingw sounds like an absolute mess.
[06:45:18] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[06:45:53] *** Quits: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb_)
[06:51:06] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[06:51:06] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/4ethEg
[06:51:06] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[06:51:07] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[06:51:07] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/C5mYag
[06:51:07] <ghrust> 13rust/06auto 14d83027f 15Daniel Micay: add `from_send` to Rc, since #9509 is fixed
[06:51:07] <ghrust> 13rust/06auto 143b430f5 15bors: auto merge of #10322 : thestinger/rust/no_freeze, r=alexcrichton
[06:51:08] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[06:51:12] <klutzy> dbaupp: ah, seems that msvc is the source of mess in this case
[06:51:28] <klutzy> they changed it from vc++2005
[06:51:35] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[06:52:14] <klutzy> it is still horrible mingw not following newer crt though
[06:57:06] *** Joins: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net)
[06:57:49] *** Quits: pcwalton (pcwalton@moz-B51927E9.hsd1.ca.comcast.net) (Quit: pcwalton)
[06:59:29] <klutzy> I also want to give a discredit for libuv.. it prints too many warnings on build so I didn't see the proper one :p
[07:00:37] <klutzy> lots of casting issues, and even a /* slash-star found /* inside comment */ warnings
[07:01:59] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[07:02:37] <cmr> klutzy: you are a saint for doing all this windows work
[07:24:00] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[07:36:07] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[07:36:07] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143b430f5 to 147fc6893: 02http://git.io/N3iJvQ
[07:36:07] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[07:36:14] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:36:14] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/_7jPkQ
[07:36:14] <ghrust> 13rust/06auto 148662141 15Daniel Micay: add `from_send` to Rc, since #9509 is fixed
[07:36:14] <ghrust> 13rust/06auto 14a5f6f85 15bors: auto merge of #10322 : thestinger/rust/no_freeze, r=alexcrichton
[07:36:15] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[08:00:46] *** Joins: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP)
[08:01:16] <nuts> Hello, I'm looking to build rust from master.
[08:01:25] <Luqman> hi nuts 
[08:01:31] <nuts> I ran ./configure and everything are ok.
[08:01:37] <nuts> but when I execute make
[08:01:45] <nuts> I've a lot of error related to llvm
[08:02:00] <nuts> like this one : ARMTargetMachine.cpp:(.text+0x186): undefined reference to `llvm::TargetPassConfig::addPass(llvm::Pass*)'
[08:02:04] <nuts> Hi Luqman 
[08:02:56] <Luqman> maybe try `make clean-llvm`
[08:03:00] <Luqman> and then run make again
[08:04:04] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[08:04:50] <nuts> I try that, thanks :)
[08:07:31] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[08:09:52] *** Quits: jeffdb_ (jeff@moz-ED35AD97.hsd1.ca.comcast.net) (Quit: jeffdb_)
[08:12:36] <dbaupp> https://github.com/mozilla/rust/pull/10333 r?
[08:16:44] *** Quits: jdm (jdm@moz-36808BF3.dsl.teksavvy.com) (Ping timeout)
[08:21:16] *** Quits: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP) (Ping timeout)
[08:41:13] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[08:41:13] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/_7jPkQ
[08:41:13] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[08:50:22] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[09:19:46] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Ping timeout)
[09:20:12] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[09:20:16] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[09:28:38] *** Joins: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP)
[09:28:58] <nuts> Luqman: Thanks for your help, that's build fine :)
[09:29:21] <Luqman> nuts: great :)
[09:42:01] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[09:46:50] *** Quits: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP) (Connection reset by peer)
[10:15:06] *** Joins: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP)
[10:21:05] <KokaKiwi> Hi, Anyone know if there is a way to get the type (ty::t) of an @ast::Expr during phase2/3 of compilation? :o
[10:34:44] *** kimundi is now known as zz_kimundi
[10:36:20] <dbaupp> KokaKiwi: look up the NodeId in some table on a ty::ctxt, I'd guess.
[10:38:52] <KokaKiwi> dbaupp: I used the function ty::expr_ty, but I found that I can't call this function before types has been collected :o
[10:39:24] <KokaKiwi> (I got error "no type for node `expr Some (id=315)`" if I use directly ty::expr_ty)
[10:40:10] <dbaupp> KokaKiwi: oh... when are you calling this?
[10:41:14] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[10:41:14] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/IVSTtw
[10:41:14] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[10:41:14] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[10:41:15] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/PLFcbQ
[10:41:15] <ghrust> 13rust/06auto 14f1cbb4d 15sh8281.kim: fix rpass core-run-destroy for android
[10:41:15] <ghrust> 13rust/06auto 1403f3051 15bors: auto merge of #10336 : ksh8281/rust/fix_rpass_core-run-destroy_for_android, r=yichoi...
[10:41:15] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[10:41:15] <KokaKiwi> In librustc/driver/driver.rs, after ty_cx is created, and before types checking
[10:48:05] <dbaupp> well, if you're calling it before typeck, there's no way it can know the type.
[10:52:00] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[10:52:28] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:52:47] <KokaKiwi> Yep, but, If I want to do tidy code, I need to know items type when I'm modifying the AST :/
[10:53:10] <KokaKiwi> Because actually, I'm modifying the AST in the analysis phase, and...Well x)
[10:53:39] <dbaupp> modifying the AST after the NodeIds have been assigned will be... tricky.
[10:53:50] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[10:54:21] <KokaKiwi> Yep I know :/ But this is the only way I know to do what I want with clean code :(
[10:54:28] <dbaupp> :(
[10:55:11] <dbaupp> you could try running typeck, running your modifications and then rerunning all the analysis (i.e. throw away the ty::ctxt and start again)
[10:55:37] <dbaupp> that seems quite likely to break anything/everything though
[10:55:41] <KokaKiwi> As I just want to modify an ExprCall (in fact, modifying arguments passed to the callee), I thought it could be easy, but... :(
[10:56:07] <KokaKiwi> Meh :(
[10:58:28] <KokaKiwi> Maybe I can just modifying how the ExprCall checker and translator run, but it seems to me to be a little messy :/
[10:58:53] <KokaKiwi> Instead of creating an additionnal step
[10:59:21] *** Quits: pauls (pauls@moz-7140CF01.ccs.neu.edu) (Ping timeout)
[11:10:32] *** zz_kimundi is now known as kimundi
[11:46:10] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[11:46:10] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/PLFcbQ
[11:46:10] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:18:24] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[12:33:34] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[12:34:53] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[12:54:46] *** Quits: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP) (Ping timeout)
[12:58:11] *** kimundi is now known as zz_kimundi
[12:59:07] *** Joins: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP)
[13:00:00] *** Joins: pauls (pauls@moz-7140CF01.ccs.neu.edu)
[13:16:55] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[13:23:12] *** Parts: a_m0d (dschoof@moz-A861BB8.coyotecorp.com) ()
[13:40:34] *** zz_kimundi is now known as kimundi
[13:47:32] <zokier`> any hope for issue #10091?
[13:50:24] <dbaupp> zokier`: it's hard to say, without an isolated testcase. :(
[13:56:58] *** Joins: jdm (jdm@moz-36808BF3.dsl.teksavvy.com)
[13:58:52] <zokier`> its bit tricky to isolate when i don't have a clue what in my code is triggering the error
[13:59:48] <dbaupp> yup... that's usually the hardest part of these bugs, working out exactly what's going wrong :(
[14:00:46] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[14:01:58] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[14:35:07] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Client exited)
[14:48:44] *** Joins: tautologico (lymph@703660AA.CFE755C8.C27E1635.IP)
[15:30:17] <zokier`> im trying to reduce the code and it seems like removing any line is enough to make the error go away
[15:39:49] *** Quits: Kxepal832 (Miranda@moz-37B13CF.pppoe.mtu-net.ru) (Ping timeout)
[15:41:59] *** Joins: mib_wuepej (Mibbit@moz-25CAE55E.zoral.com.ua)
[15:42:46] *** Quits: mib_wuepej (Mibbit@moz-25CAE55E.zoral.com.ua) (Quit: http://www.mibbit.com ajax IRC Client)
[15:43:08] *** Joins: Kxepal (Miranda@moz-95B10DEC.pppoe.mtu-net.ru)
[16:31:53] <pnkfelix> nmatsakis: ping
[16:32:21] <pnkfelix> nmatsakis: nm
[16:36:33] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[16:38:42] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[16:39:46] <nmatsakis> pnkfelix: ok
[16:48:06] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Client exited)
[16:51:51] *** fredy is now known as williamq__
[16:51:57] *** williamq__ is now known as fredy
[16:59:13] *** Joins: lkuper (lkuper@moz-54129201.dhcp-bl.indiana.edu)
[17:16:02] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[17:34:08] *** Joins: notmatt (notmatt@9EE269E.F9CD85DB.47C41102.IP)
[17:46:56] *** Quits: notmatt (notmatt@9EE269E.F9CD85DB.47C41102.IP) (Ping timeout)
[17:47:18] *** Joins: notmatt (notmatt@9EE269E.F9CD85DB.47C41102.IP)
[17:47:21] *** Quits: eddyb (eddy@717B0165.D51DAF03.FB866788.IP) (Ping timeout)
[17:47:22] *** Joins: _eddyb_ (eddy@336E3A7F.D51DAF03.FB866788.IP)
[17:56:41] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[18:00:48] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:01:57] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[18:02:33] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[18:02:33] *** ChanServ sets mode: +o tjc
[18:02:42] *** Quits: notmatt (notmatt@9EE269E.F9CD85DB.47C41102.IP) (Client exited)
[18:03:02] <tjc> acrichto nmatsakis : do you know if we're triaging?
[18:03:12] <acrichto> tjc: we are
[18:04:27] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:04:28] *** ChanServ sets mode: +qo brson brson
[18:08:08] <nmatsakis> coming, I'm having network issues
[18:10:02] <acrichto> brson: how reliable is linked failure in general right now? (disregarding the state of I/O)
[18:11:44] <brson> acrichto: it's not. it has a race condition that causes segfaluts
[18:11:49] <brson> *segfalutes
[18:12:50] <acrichto> brson: hm, upon scrutinizing I/O code for linked failure weaknesses there were more than I thought, but it's difficult to test if linked failure in general is unreliable
[18:28:00] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[18:29:00] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[18:34:13] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:34:13] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:35:31] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[18:39:12] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[18:53:18] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[19:04:23] <acrichto> brson: do you have a sec to talk about linked failure now?
[19:08:27] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[19:08:52] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[19:11:59] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[19:19:02] <brson> acrichto: ok
[19:19:25] <acrichto> so I guess the first thing is how closely we want to scrutinize I/O for linked failure when in general it's not working
[19:19:44] <acrichto> I removed one linked failure assertion and I'm getting some linked failure tests to reliably pass with I/O, but I'm not sure how critical the assertion was
[19:20:03] <acrichto> I also tried to figure out what the assertion was asserting, but I was unable to figure it out (or figure out why it was tripping in the first place)
[19:20:16] *** _eddyb_ is now known as eddyb
[19:20:29] <acrichto> in general if linked failure is flaky, I don't think we can really strive to make linked failure bulletproof when it comes to I/O
[19:20:42] <acrichto> I can try real hard by re-scrutinizing everything again, but without tests we won't have any guarantees
[19:21:15] <acrichto> I like the idea of implementing linked failure with I/O in order to have some semblance of I/O cancellation implemented
[19:21:53] <brson> my preference is to make tasks unkillable for the duration of I/O and revisit linked failure seperately
[19:22:00] <brson> what does it mean to implement linked failure with I?O?
[19:22:20] <acrichto> we have utilities like uv_read_stop along with general making sure there's no use-after-free
[19:22:32] <acrichto> my rewrite makes libuv make heavy use of borrowed pointers to the stack
[19:22:44] <acrichto> and unwinding past those would be difficult (callbacks need to know to not use the pointers)
[19:23:11] <brson> right
[19:23:49] <brson> we could try to fix the linked failure race, but it's really nasty, and I don't like anything about the current impl
[19:23:52] <acrichto> although you're right in that I could just add task::unkillable everywhere
[19:24:02] <acrichto> I'm starting to lean towards just doing that
[19:24:34] <acrichto> this'll be a little difficult with homing not using a closure
[19:24:46] <acrichto> but I imagine that I can just copy whatever task::unkillable is doing
[19:24:50] <brson> if you wanted to test fail-safety you could just add some instrumentation to make tasks fail, apart from linked failure
[19:24:57] <brson> that would give us the appropriate future-proofing
[19:25:13] <acrichto> yeah I'm going to keep writing tests that have fail!() to make sure that we don't segfault or leak memory
[19:26:16] <acrichto> brson: ok, so the second issue I think I've found is that our udp tests are all incredibly unreliable
[19:26:37] <acrichto> and the only conclusion that I've come to is that if one side is not inside of 'recvfrom' when the other one completes the 'sendto', the packet is lost
[19:26:59] <acrichto> if I just run the udp tests thousands of times back to back they deadlock incredibly frequently
[19:27:10] <acrichto> deadlock in the sense of one task is still waiting for a message (but never receives it)
[19:28:41] <brson> nice find
[19:28:56] <acrichto> the only real solution I can think of though is to have a Tube
[19:29:09] <acrichto> which is opened as soon as you bind a udp socket
[19:29:16] <brson> at one point some of our networking tests relied on specific scheduler semantics to make sure that some things happened before others
[19:29:27] <acrichto> that's terrifying
[19:29:36] <brson> i.e. they used a single-threaded scheduler and knowledge of how the scheduler worked
[19:29:43] <acrichto> :(
[19:29:51] <brson> the problem is you can't *do* anything after blocking on recvfrom
[19:29:55] <brson> what do you propose?
[19:30:08] <acrichto> when you bind a socket you create a Tube
[19:30:17] <acrichto> also when you bind a socket we start the uv callbacks for reading data
[19:30:28] <acrichto> and we never run uv_udp_read_stop until it closes
[19:30:37] <acrichto> so recvfrom() == tube.recv()
[19:30:46] <brson> this sounds like how the tcp reader works?
[19:30:51] <acrichto> tcp listeners
[19:31:10] <acrichto> tcp streams work just fine (I think, I was seeing weirdness but it's gone now)
[19:31:57] <brson> oh but general tcp readers (the client) don't work like this? is there a problem there as well?
[19:32:11] <Luqman> acrichto: as in the way tcp listeners were split into listener and acceptor? 
[19:32:27] <brson> like, do all streams just need to be constantly reading and buffering?
[19:32:32] <brson> that sounds kind of wrong
[19:32:34] <acrichto> Luqman: I believe so, the listener.listen() function starts up the uv callback of accepting sockets
[19:32:39] <acrichto> brson: I sure hope not
[19:33:01] <acrichto> brson: I've had tests where the server receives a connection, writes multiple times, then closes their half, then the client sees the connection, and the client reads all the data successfully
[19:33:29] <Luqman> oh that reminds me, what's the best way of emulating select on 2 TcpStream's right now?
[19:33:37] <acrichto> brson: I would expect the OS to have an internal buffer and when extra data comes in over TCP it sends a message back asking for a retry later
[19:33:47] <acrichto> Luqman: streams -> channels
[19:34:30] <brson> acrichto: so if we aren't listening for udp packets at the exact moment they are recieved then they are dropped?
[19:34:53] <acrichto> brson: that's my guess, although that's just an educated guess based on the semantics of udp in general
[19:34:55] <brson> i wonder what about libuv gives us those semantics. surely that's not how bsd sockets work
[19:35:14] <acrichto> sockets are different in that you can ask the other end to retry though
[19:35:30] <acrichto> so the OS would possibly have a buffer for a tcp stream which we periodically empty 
[19:35:45] <acrichto> udp on the other hand would have no buffering and if no one is there to receive the packet it's just dropped on the ground
[19:35:53] <acrichto> I should confirm this with the uv folks though
[19:36:21] <brson> sure. but the bsd socket api recieves udp packets, and it doesn't require you to always be blocked listening for packets
[19:36:26] <brson> i should really just read some man pages
[19:36:38] * acrichto should learn any c api about networking at all
[19:37:02] <brson> anyway, I'm wondering if the uv_udp_read_start call puts the socket into some kind of listening mode for which there isn't a discreet step in libuv
[19:37:26] <brson> and if libuv expects us to just read continually or if we're missing something
[19:39:26] <brson> so anyway, your proposal sounds plausible, but maybe you can ping the #libuv people and see if our understanding is correct. so you would be buffering packets or bytes?
[19:39:42] <acrichto> whatever the callback gives
[19:39:51] <acrichto> each time the callback is invoked I would intepret that as a packet
[19:40:09] <acrichto> and then I'll also slap a task::unkillable around pretty much everything
[19:40:25] <acrichto> or rather all homing operations + all IoFactory operations
[19:40:31] <acrichto> which should be enough
[19:43:31] <brson> sounds good
[19:43:50] <acrichto> man I was getting really excited about linked failure
[19:43:56] <acrichto> it was so cool when things were getting canceled
[19:44:05] <acrichto> but then everything was incredibly unreliable and always dying and I was sad
[20:06:14] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[20:06:14] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Sh716g
[20:06:14] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[20:06:22] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[20:06:23] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/TwVlfQ
[20:06:23] <ghrust> 13rust/06auto 14519b86b 15Matt Carberry: Added octal literal support.
[20:06:23] <ghrust> 13rust/06auto 1466abb92 15Matt Carberry: Grammar error and vim syntax highlighting mistake fixed.
[20:06:23] <ghrust> 13rust/06auto 146eba332 15Matt Carberry: Added positive tests for integer literal base interpretation.
[20:06:25] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[20:10:44] *** Joins: tikue (tikue_star@moz-FEADCD38.hsd1.pa.comcast.net)
[20:11:04] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[20:17:05] *** Joins: andrew-__ (andrew-d_w@moz-5A92CAFF.dsl.static.sonic.net)
[20:17:11] *** Quits: andrew-__ (andrew-d_w@moz-5A92CAFF.dsl.static.sonic.net) (Input/output error)
[20:17:31] *** Joins: andrew-__ (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[20:17:50] *** tikue__ is now known as tikue_
[20:17:57] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[20:21:03] <tikue_> acrichto: is linked failure off the table or something?
[20:21:18] <acrichto> tikue_: it is for interrupting I/O
[20:21:26] <acrichto> at least right now
[20:23:59] *** Quits: tikue (tikue_star@moz-FEADCD38.hsd1.pa.comcast.net) (Ping timeout)
[20:29:18] *** Joins: andrew-d_w (andrew-d_w@moz-5A92CAFF.dsl.static.sonic.net)
[20:30:28] *** Quits: andrew-__ (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[20:31:28] *** Quits: andrew-d_w (andrew-d_w@moz-5A92CAFF.dsl.static.sonic.net) (Input/output error)
[20:31:48] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[20:39:22] *** Joins: andrew-__ (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[20:40:29] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[20:42:04] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:42:25] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:42:25] *** ChanServ sets mode: +o tjc
[20:44:08] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:48:24] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[20:48:24] *** ChanServ sets mode: +o tjc
[21:05:00] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[21:08:23] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:11:44] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[21:17:39] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[21:17:39] *** ChanServ sets mode: +o tjc
[21:38:29] <acrichto> klutzy: ping
[21:42:19] <acrichto> brson: also ping
[21:45:19] <Luqman> acrichto: what did you mean by streams -> channels?
[21:45:44] <acrichto> Luqman: you'd have to have a stream in its own task which then sends data to a channel
[21:45:47] <acrichto> and then you select over the channels
[21:47:06] <brson> acrichto: pong
[21:47:16] <acrichto> brson: so I forgot one other thing about linked failure and I/O
[21:47:19] <Luqman> acrichto: hmmm, that's a bit annoying since i have the streams in a struct i'm accessing through &mut self
[21:47:30] <acrichto> brson: it's not enough to just have task::unkillable, a linked failure can awaken you on any scheduler
[21:48:02] <acrichto> brson: and right now the homing code doesn't lock you to a scheduler, it only assumes that once you're on the I/O scheduler you don't leave it
[21:49:07] <acrichto> brson: so one possible solution for this is to actually lock you to the scheduler, but that means that *all* I/O operations are going to be creating a SchedHandle, so that needs to be cheap (right now it allocates a uv watcher)
[21:49:12] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:49:16] <brson> acrichto: even unkillable tasks get woken up on the wrong scheduler?
[21:49:25] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[21:49:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:49:58] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[21:50:01] <acrichto> brson: hm wait no I may be going crazy, 
[21:50:04] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:51:43] <acrichto> brson: ah, I'm just not doing this correctl, nvmd
[22:01:12] <cmr> Maybe it's justme but it seemslike libuv is a lot more trouble than it's worth for our purposes
[22:02:36] <brson> cmr: the alternative is to not use green threads I think, which is a valid strategy and may be a better default for systems programming
[22:03:02] <cmr> brson: Wait, why does not using libuv imply no green threads?
[22:03:16] <acrichto> we need nonblocking I/O for green threads somehow
[22:03:34] <cmr> Right, but libuv doesn't have to give that.
[22:03:38] <cmr> Every OS has native APIs.
[22:03:48] <acrichto> well, libuv is what abstracts that
[22:03:55] <cmr> It seems like libuv's scheduler abstraction limits our flexibility
[22:03:59] <acrichto> if we implemented the same thing, we'd just be reimplementing libuv
[22:04:01] <cmr> slash event loop
[22:04:54] <cmr> We don't need a single event loop per thread, not on linux
[22:05:06] <acrichto> that's a good point
[22:05:24] <strcat> cmr: linux doesn't have async I/O or non-blocking I/O really, for anything but sockets, it just relies on page cache
[22:05:36] <strcat> glibc's implementation of POSIX AIO just spawns a thread for each one
[22:06:12] <cmr> strcat: epoll?
[22:06:25] <strcat> epoll doesn't work on normal files, just sockets
[22:06:38] <acrichto> libuv just farms the work out to a pool of worker threads
[22:06:40] <cmr> hm, I thought it worked on most/all fd's
[22:06:44] <strcat> you can use inotify with regular files but it's really not meant to be used that way
[22:06:52] <strcat> cmr: epoll tells you when something is ready to read/write from
[22:06:58] <strcat> local files are *always* ready
[22:07:17] <acrichto> although what if it's a network filesystem?
[22:07:24] <cmr> My disk isn't infinitely fast
[22:07:35] <strcat> acrichto: network filesystems are regarded as broken
[22:07:48] <strcat> they don't implement stuff like file locking properly anyway
[22:07:58] <strcat> cmr: sure, but there's page cache
[22:08:55] <strcat> cmr: the linux model is 1:1 threading, with epoll as a necessary evil for socket servers
[22:09:03] <strcat> but ideally epoll will become unnecessary
[22:10:30] <strcat> linux used to do N:M threading because it was faster before all the magical stuff like futex
[22:12:27] <strcat> acrichto: memory-mapped files are inherently blocking too, since you block on the page faults
[22:14:10] <strcat> there's obviously a use case for having a thread pool for maximum throughput with batch jobs
[22:15:49] <cmr> On an unrelated aside, I don't think http://static.rust-lang.org/doc/master/std/rt/io/struct.FileStat.html is a good abstraction.
[22:15:57] <cmr> You can't change the "unstable" part without affecting ABI
[22:16:55] <strcat> we don't have a stable ABI anyway ;p
[22:17:07] <strcat> you can't really write idiomatic rust with a stable ABI
[22:17:12] <acrichto> brson: what would you expect this program to do https://gist.github.com/alexcrichton/7362822 ?
[22:17:13] <strcat> C++ has the same issue
[22:17:32] <acrichto> oh whoops, mixed up the addresses...
[22:17:45] <acrichto> brson: hm nvmd
[22:24:59] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[22:49:43] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[22:50:28] *** Quits: jdm (jdm@moz-36808BF3.dsl.teksavvy.com) (Quit: Lost terminal)
[22:52:20] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[22:54:13] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[22:55:54] <pcmattman> acrichto: ping
[22:56:19] <acrichto> pcmattman: pong
[22:56:37] <pcmattman> nice work on landing that libuv fix :)
[22:56:42] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[22:56:51] <pcmattman> well, enhancement
[22:56:57] <acrichto> :), so it looks like we should definitely upgrade now
[22:57:10] <acrichto> although right now I'm in the middle of rewriting pretty much all of them
[22:57:24] <acrichto> bindings*
[22:57:31] <pcmattman> good fun
[22:57:44] <acrichto> would you be ok holding off til around monday?
[22:57:54] <acrichto> I should be able to land this by then
[22:58:02] <acrichto> actually no nvmd
[22:58:03] <pcmattman> yeah, not a problem. I'm travelling this weekend so that actually works perfectly
[22:58:11] <acrichto> whatever's easiest for you
[22:58:20] <acrichto> I'll r+ an upgrade right now if you've got it
[22:58:32] <acrichto> I can deal with the rebasings :P
[22:58:40] <acrichto> no rush of course
[23:00:20] <pcmattman> No upgrade handy yet - it'd be to latest libuv master?
[23:02:06] <acrichto> should be yeah
[23:02:14] <acrichto> I know that at least one of their apis changed though
[23:02:21] <acrichto> so you may want to watch out for others as well
[23:03:12] <pcmattman> good to know
[23:04:55] <pcmattman> is all that reasonably well-covered by tests, that'll break when the api changes?
[23:05:03] <acrichto> in theory
[23:05:11] <acrichto> although all the breakage will probably show up as segfault
[23:05:14] <acrichto> segfaults*
[23:05:17] <acrichto> which may be hard to diagnose
[23:06:33] <pcmattman> exciting
[23:08:19] <acrichto> brson: I think that my thoughts about udp being weird were all a hoax, I found other bugs which probably looked like things weren't getting received
[23:08:54] <pcmattman> well, I'll probably look at getting that done after this weekend (if it hasn't been done already), I don't think there's any point rushing it through :)
[23:09:11] <acrichto> pcmattman: cool, and thanks again for being patient with it
[23:10:19] <pcmattman> no worries :)
[23:18:20] <dbaupp> kimundi: ping
[23:18:31] <kimundi> pong
[23:18:52] <dbaupp> https://github.com/mozilla/rust/pull/10333#issuecomment-27970356 I can't find any mention of `null` in ascii.rs?
[23:19:22] <dbaupp> oh, wait, "Take ownership and cast to an ascii vector without trailing zero element." there we go
[23:19:40] <kimundi> yeah that. :)
[23:20:08] <kimundi> zero, null, nil, all the same :P
[23:20:33] * kimundi always asked himself why english has so many words for the number 0
[23:20:52] <dbaupp> https://github.com/mozilla/rust/pull/10333 r?
[23:35:15] *** kimundi is now known as zz_kimundi
[23:40:23] <brson> I'm restarting the bots to change which android ndk we use
[23:46:14] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[23:46:14] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145619c46 to 1403f3051: 02http://git.io/N3iJvQ
[23:46:14] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[23:46:21] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[23:46:21] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/lf02lQ
[23:46:21] <ghrust> 13rust/06auto 1496ec3c1 15sh8281.kim: update for ndk r9b
[23:46:21] <ghrust> 13rust/06auto 14a0593e5 15bors: auto merge of #10335 : ksh8281/rust/update_for_ndk_r9b, r=brson...
[23:46:21] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[23:55:50] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
