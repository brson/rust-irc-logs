[00:02:43] <ChrisMorgan> Yes, I'm glad someone managed to come up with something people are liking. Eridius, congratulations! You managed to start a thread that came up with a good solution.
[00:03:10] <ChrisMorgan> Meanwhile, my `do` thread was immediately hijacked for discussing &once fn, something I mentioned I *didn't* want to be discussed in that thread :-(
[00:04:15] <dbaupp> ChrisMorgan: you shouldn't've mentioned it at all :P
[00:04:44] <ChrisMorgan> dbaupp: no, I should have mentioned it thoroughly at the end, saying PLEASE DO NOT hijack this thread to talk about &once fn.
[00:05:26] <ChrisMorgan> And then you end up with "well, couldn't we make do support both closures and procs?"‚Äîwhich is *exactly* what I had suggested in the first place. Yes, I definitely lost control of that thread immediately.
[00:06:40] * dbaupp kinda just wants to remove `do` entirely so we can have a completely fresh discussion.
[00:07:07] * cmr agrees
[00:07:16] <cmr> but I also recognize the pain people feel with the change
[00:07:26] <cmr> Only ever so slightly sympathetic to it though :p
[00:09:25] <ChrisMorgan> I do hate having closure syntax and proc semantics. That's just silly.
[00:09:46] <ChrisMorgan> ... Especially when speaking of concealing allocations.
[00:25:36] <benh> just turn task::spawn into go! { implicit proc body goes here } and be done with it ;)
[00:27:29] <strcat> or... don't hardcode any more macros into the compiler
[00:29:22] <sfackler> and fix macro lookup so it works like everything else!
[00:36:41] *** Joins: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net)
[00:56:36] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[01:00:32] <ChrisMorgan> use std::task::spawn!; spawn! { task_body; }
[01:01:05] <strcat> won't work
[01:01:11] <strcat> macros expand before resolve
[01:01:16] <strcat> by necessity afaik
[01:01:48] <ChrisMorgan> Of course. You'd need to shift `use` handling much earlier than is feasible.
[01:01:51] <dbaupp> they basically expand in the parser
[01:03:39] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[01:05:03] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[01:06:48] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[01:10:51] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[01:21:58] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[01:21:58] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/2IKvMg
[01:21:58] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[01:25:13] *** Quits: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[01:26:52] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[01:26:52] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/pv46dw
[01:26:52] <ghrust> 13rust/06auto 14391d811 15Alex Crichton: Update LLVM and jettison jit support...
[01:26:52] <ghrust> 13rust/06auto 14dafad98 15Alex Crichton: Remove unused upcalls...
[01:26:53] <ghrust> 13rust/06auto 149844282 15bors: auto merge of #10758 : alexcrichton/rust/upgrade-llvm, r=thestinger...
[01:26:55] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[01:27:48] *** Joins: aatch (James@moz-B437F499.pocketrent.com)
[01:29:55] *** Joins: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net)
[01:38:47] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[01:41:54] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[01:46:39] *** Quits: canhtak (canhtak@moz-A13A68C3.wl.t.ulaval.ca) (Ping timeout)
[01:46:53] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[01:46:53] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149844282 to 1461443dc: 02http://git.io/N3iJvQ
[01:46:53] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:46:59] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[01:46:59] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/xvICKw
[01:46:59] <ghrust> 13rust/06auto 14391d811 15Alex Crichton: Update LLVM and jettison jit support...
[01:46:59] <ghrust> 13rust/06auto 14dafad98 15Alex Crichton: Remove unused upcalls...
[01:47:00] <ghrust> 13rust/06auto 149454f77 15bors: auto merge of #10758 : alexcrichton/rust/upgrade-llvm, r=thestinger...
[01:47:02] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[01:53:12] *** Joins: canhtak (canhtak@moz-A13A68C3.wl.t.ulaval.ca)
[02:07:23] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[02:07:23] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 149454f77 to 1461443dc: 02http://git.io/N3iJvQ
[02:07:23] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[02:07:24] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[02:07:24] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/3tW-_Q
[02:07:24] <ghrust> 13rust/06auto 14391d811 15Alex Crichton: Update LLVM and jettison jit support...
[02:07:24] <ghrust> 13rust/06auto 14dafad98 15Alex Crichton: Remove unused upcalls...
[02:07:25] <ghrust> 13rust/06auto 142364b32 15bors: auto merge of #10758 : alexcrichton/rust/upgrade-llvm, r=thestinger...
[02:07:27] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[02:09:35] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[02:09:51] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:10:23] *** kimundi is now known as zz_kimundi
[02:12:31] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[02:14:58] *** Quits: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[02:28:17] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[02:37:13] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:37:13] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 142364b32 to 1461443dc: 02http://git.io/N3iJvQ
[02:37:13] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[02:37:18] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:37:18] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/9Pp-9g
[02:37:18] <ghrust> 13rust/06auto 14391d811 15Alex Crichton: Update LLVM and jettison jit support...
[02:37:18] <ghrust> 13rust/06auto 14dafad98 15Alex Crichton: Remove unused upcalls...
[02:37:18] <ghrust> 13rust/06auto 14f66f344 15bors: auto merge of #10758 : alexcrichton/rust/upgrade-llvm, r=thestinger...
[02:37:20] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[02:49:51] *** Quits: canhtak (canhtak@moz-A13A68C3.wl.t.ulaval.ca) (Quit: canhtak)
[02:56:48] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:56:48] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14f66f344 to 1461443dc: 02http://git.io/N3iJvQ
[02:56:48] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[02:56:49] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[02:56:49] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/hiT8lQ
[02:56:49] <ghrust> 13rust/06auto 14391d811 15Alex Crichton: Update LLVM and jettison jit support...
[02:56:49] <ghrust> 13rust/06auto 14dafad98 15Alex Crichton: Remove unused upcalls...
[02:56:49] <ghrust> 13rust/06auto 1441c63ae 15bors: auto merge of #10758 : alexcrichton/rust/upgrade-llvm, r=thestinger...
[02:56:51] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:06:06] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[03:11:35] *** Joins: canhtak (canhtak@moz-A13A68C3.wl.t.ulaval.ca)
[03:12:11] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[03:12:23] *** vfetwnuncszu is now known as dcrewi
[03:17:16] *** Quits: zz_kimundi (kimundi@moz-BA49E2B1.dip0.t-ipconnect.de) (Ping timeout)
[03:20:44] *** Joins: zz_kimundi (kimundi@moz-9888D3CE.dip0.t-ipconnect.de)
[03:20:45] *** zz_kimundi is now known as kimundi
[03:23:51] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[03:32:28] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[03:32:28] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1441c63ae to 1461443dc: 02http://git.io/N3iJvQ
[03:32:28] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[03:32:35] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[03:32:35] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/B1vg-w
[03:32:35] <ghrust> 13rust/06auto 14391d811 15Alex Crichton: Update LLVM and jettison jit support...
[03:32:35] <ghrust> 13rust/06auto 14b7a4f47 15Alex Crichton: Remove unused upcalls...
[03:32:36] <ghrust> 13rust/06auto 1401afc58 15bors: auto merge of #10758 : alexcrichton/rust/upgrade-llvm, r=thestinger...
[03:32:38] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[03:40:21] *** Joins: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net)
[03:51:03] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Ping timeout)
[03:52:30] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[03:53:19] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:53:26] *** Quits: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP) (Quit: Lost terminal)
[04:08:47] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[04:40:02] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[04:48:29] *** Quits: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[04:50:40] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[04:50:55] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[04:52:03] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[04:52:04] *** ChanServ sets mode: +qo brson brson
[04:54:20] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[05:00:10] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[05:02:02] *** Joins: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net)
[05:20:04] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[05:21:58] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[05:22:12] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[05:22:49] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[05:23:29] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[05:23:29] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14c482800 to 1481f98fe: 02http://git.io/k471pw
[05:23:29] <ghrust> 13rust/06try 1461716e0 15Alex Crichton: Continue tightening holes in reachability...
[05:23:29] <ghrust> 13rust/06try 1481f98fe 15Alex Crichton: Crack down on symbol exports from dylib/bin files...
[05:23:30] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[05:27:56] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[05:29:33] <acrichto> brson: did the try/snap config change recently? I just pushed to try and it seems to have triggered a build per commit instead of a build per push
[05:30:05] <acrichto> I also remember that after resurrecting snap-stage3 for linux it was swamped in builds for a day for things that I'm not sure how they were triggered
[05:31:36] <brson> acrichto: no it hasn't changed but I've seen that behavior before too
[05:32:08] <acrichto> huh, oh well
[05:32:45] <acrichto> I suppose the good news is that I have --gc-sections/-dead_trip working, just need to test it out now
[05:36:08] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[05:40:19] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[05:40:19] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 1481f98fe to 145959e2c: 02http://git.io/k471pw
[05:40:19] <ghrust> 13rust/06try 145959e2c 15Alex Crichton: Crack down on symbol exports from dylib/bin files...
[05:40:19] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[05:43:58] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:50:21] *** Quits: canhtak (canhtak@moz-A13A68C3.wl.t.ulaval.ca) (Quit: canhtak)
[05:58:12] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[05:58:12] *** ChanServ sets mode: +ao pcwalton pcwalton
[05:58:15] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[06:03:23] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Ping timeout)
[06:18:58] *** Joins: brson (brson@6A848D32.C1B840DD.76F66111.IP)
[06:18:58] *** ChanServ sets mode: +qo brson brson
[06:32:24] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[06:32:39] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[06:39:14] *** Quits: dbaupp (Thunderbir@348FADA7.D5A1DCF.37681C44.IP) (Ping timeout)
[06:43:12] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:43:16] *** Quits: twb (textual@moz-5DE8950B.hsd1.ga.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[06:43:43] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[06:43:43] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 145959e2c to 14aed5717: 02http://git.io/k471pw
[06:43:43] <ghrust> 13rust/06try 14aed5717 15Alex Crichton: Crack down on symbol exports from dylib/bin files...
[06:43:43] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[06:56:32] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[06:56:54] *** Quits: brson (brson@6A848D32.C1B840DD.76F66111.IP) (Quit: leaving)
[06:57:55] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[06:59:07] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[07:00:31] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[07:01:06] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[07:12:02] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[07:17:08] <acrichto> klutzy: ping
[07:17:11] <klutzy> acrichto: pong
[07:17:15] <acrichto> nm unping
[07:17:24] <acrichto> wrong k-nick :(
[07:17:42] <klutzy> klutzy: unpong
[07:44:50] *** Quits: bjz (bjz@moz-DD4A2A91.lnse2.cha.bigpond.net.au) (Ping timeout)
[07:48:00] *** Joins: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net)
[07:55:49] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[08:05:31] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:15:08] *** flaper87|afk is now known as flaper87
[08:21:53] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[08:21:53] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1401afc58 to 1461443dc: 02http://git.io/N3iJvQ
[08:21:53] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[08:21:57] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[08:21:57] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/4puttA
[08:21:57] <ghrust> 13rust/06auto 14055ddbe 15Alex Crichton: Register new snapshots
[08:21:57] <ghrust> 13rust/06auto 141bf00b2 15Alex Crichton: Link rustllvm statically to librustc...
[08:21:58] <ghrust> 13rust/06auto 14521c76d 15Alex Crichton: Distribute a unified binary for snapshots...
[08:22:00] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:23:12] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[08:37:24] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[08:37:24] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c1e49b9 to 1461443dc: 02http://git.io/N3iJvQ
[08:37:24] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:37:31] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[08:37:31] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/lPDt5w
[08:37:31] <ghrust> 13rust/06auto 14d80986d 15Guillaume Pinot: rename MutableVector::mut_split(at) to MutableVector::mut_split_at(at)
[08:37:31] <ghrust> 13rust/06auto 149a86b90 15Guillaume Pinot: add MutableVector::mut_split(self, pred) -> DoubleEndedIterator<&mut [T]>...
[08:37:32] <ghrust> 13rust/06auto 1479ac7a2 15bors: auto merge of #10757 : TeXitoi/rust/mut-split-iter, r=cmr...
[08:37:34] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[08:49:00] <eddyb> I thought the snapshots had the * => .. change
[08:58:16] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[08:58:16] *** ChanServ sets mode: +o pnkfelix
[09:01:11] <eddyb> maybe I broke it, I don't know
[09:07:23] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[09:07:23] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/RiGjbQ
[09:07:23] <ghrust> 13rust/06auto 14391d811 15Alex Crichton: Update LLVM and jettison jit support...
[09:07:23] <ghrust> 13rust/06auto 14b7a4f47 15Alex Crichton: Remove unused upcalls...
[09:07:23] <ghrust> 13rust/06auto 14ebe15ea 15bors: auto merge of #10758 : alexcrichton/rust/upgrade-llvm, r=thestinger...
[09:07:25] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[09:08:45] <eddyb> that means more work for someone trying to make a JIT work. but LLVM is probably the easiest part of that :P
[09:14:01] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[09:19:12] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[09:22:11] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[09:22:12] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14ebe15ea to 1461443dc: 02http://git.io/N3iJvQ
[09:22:12] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[09:22:14] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[09:22:14] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/bxFrGg
[09:22:14] <ghrust> 13rust/06auto 14a3aa325 15SiegeLord: Add placeholder text to the search bar in the documentation.
[09:22:14] <ghrust> 13rust/06auto 14e73d506 15SiegeLord: Add a type="search" to the search bar in the documentation.
[09:22:15] <ghrust> 13rust/06auto 14752e99c 15bors: auto merge of #10759 : SiegeLord/rust/placeholder, r=cmr...
[09:22:17] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[09:33:22] *** Quits: Kxepal (Miranda@moz-B3E59235.pppoe.mtu-net.ru) (Ping timeout)
[09:35:28] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[09:36:00] *** Joins: Kxepal (Miranda@moz-BFDF5C72.pppoe.mtu-net.ru)
[09:39:47] *** Quits: b (b@moz-55CA322E.org) (Ping timeout)
[09:43:59] *** Joins: b (b@moz-55CA322E.org)
[09:52:56] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[09:54:42] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[09:56:35] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[09:58:22] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[10:24:28] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[10:27:09] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[10:30:37] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[10:32:16] <nmatsakis> kimundi: pong
[10:32:29] <eddyb> nmatsakis: good to see you around :D
[10:32:59] <nmatsakis> thanksgiving.
[10:33:48] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[10:34:55] <eddyb> nmatsakis: I hope it was great :). check this out http://huonw.github.io/isrustfastyet/mem/#c470184,b2aa00b
[10:35:06] <kimundi> nmatsakis: Ah, It was not me who wanted something from you, but someone else in the channel who wanted to know how to contact you, which I demonstrated with a "ping" :)
[10:36:06] <kimundi> Don't remember who or what exactly it was about though... It's in the backlog where I pinged you
[10:36:18] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Ping timeout)
[10:38:53] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[10:45:42] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[10:47:35] <nmatsakis> ok. I havne't gotten around to checking the backlog for context yet.
[10:48:14] <nmatsakis> eddyb: nice.
[10:49:58] <nmatsakis> eddyb: you do know we have an actual arena in stdlib? I had hoped to convert the code to use it sometime, but to do it properly would require some work on lifetime annotations
[10:50:08] <nmatsakis> eddyb: by which I just mean propagating th eannotations throughout compiler ,not extending language
[10:50:52] <nmatsakis> eddyb: but also see this comment https://github.com/mozilla/rust/issues/7929?source=c#issuecomment-28055011
[10:51:19] <eddyb> nmatsakis: I tried using no-free &'static T for the 4 types I boxed, that didn't go well
[10:51:46] <nmatsakis> eddyb: no, you will want to have multiple arenas so that we can trash the old AST after expansion
[10:51:58] <eddyb> unless you mean Rc+arena, that's doable but not without smart ptr deref and borrow traits
[10:52:14] <nmatsakis> no, I do not.
[10:52:41] <nmatsakis> I mean starting with an arena that holds output of parsing, then during expansion creating nodes into a different arena, and freeing the original.
[10:52:51] <nmatsakis> We might need more than 2, but same idea.
[10:53:15] <nmatsakis> though I think I'd ultimately prefer the first idea (move AST nodes into an array and use index into array as id)
[10:53:26] <nmatsakis> not sure
[10:53:37] <nmatsakis> but thta'd be a lot more refactoring
[10:53:59] <eddyb> nmatsakis: hmm, I see, that could solve the problem. my naive implementation was peaking at 2GB ^_^
[10:56:08] <eddyb> with smart pointers, refactoring could be very mechanical, and before seeing your post, I did think of per-type indexes (without explicitly distinguishing between the types. P<Expr> and P<Stmt> would use different arrays)
[10:56:32] *** Joins: bjz (bjz@moz-DD4A2A91.lnse2.cha.bigpond.net.au)
[10:57:05] <eddyb> nmatsakis: that is, with the P<T>-as-a-less-painful-move-away-from-@ I introduced in that PR, I'm not sure you've taken a look at that yet
[11:01:37] <eddyb> someone would have to pick my brain to get anything useful, it's a mess after last week :P
[11:06:05] <nmatsakis> eddyb: I read your comments, yeah, the main downside to P<T>=&'static T is that you can't (safely) free the data -- anyway gotta go for a bit, bbl
[11:06:34] * nmatsakis approximatley 10% of the way through the e-mail that's accumulated.
[11:06:42] <nmatsakis> or maybe 5%
[11:06:55] <dbaupp> nmatsakis: ping
[11:11:25] <eddyb> nmatsakis: I really hope that munmap+mmap(with no perms and NORESERVE) trick works
[11:27:33] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Ping timeout)
[11:27:41] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[11:29:26] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[11:32:17] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[11:33:50] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[11:34:42] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[11:42:54] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[11:44:44] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[11:46:47] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[11:48:36] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[11:56:53] <friggle> eddyb: what is the trick?
[11:58:48] <eddyb> friggle: make the freed pages always page fault when accessed, it's safer than allowing then to be reallocated (and have old references point to new data, corruptions, etc.)
[11:59:35] <dbaupp> eddyb: page fault or segfault?
[12:00:03] <pcmattman> segfault, I'd imagine
[12:00:05] <eddyb> page fault which triggers SIGSEGV (segfault)
[12:00:54] <pcmattman> (completely invalidate released heap memory, reuse of freed memory region doesn't hit a reallocated area but instead crashes)
[12:00:54] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[12:01:08] <cmr> why munmap+mmap? just mprotect it.
[12:01:14] <cmr> (it won't be racy)
[12:01:17] <pcmattman> (the word heap is not necessary in that sentence)
[12:01:29] <eddyb> cmr: that wouldn't release the physical memory
[12:01:41] <cmr> you can't release it or you're going to have races.
[12:01:55] <eddyb> hmpf. spinlocks?
[12:01:59] <cmr> on what?
[12:02:16] <pcmattman> cmr: races to what?
[12:02:32] <cmr> pcmattman: allocs using the memory region
[12:02:37] <eddyb> pcmattman: another thread could grab the virtual space
[12:02:56] <pcmattman> oh, between the munmap and the next mmap
[12:03:15] * pcmattman thinks that's a sign it's sleep time
[12:04:04] <cmr> eddyb: you can use madvise anyway
[12:04:20] * eddyb googles
[12:04:28] <cmr> google? man :P
[12:04:58] <eddyb> oh, syscall. weird name
[12:05:20] <pcmattman> super handy syscall though
[12:06:36] <eddyb> MADV_DONTNEED + mprotect could work, I guess
[12:07:12] <eddyb> but this really needs tests to make sure you actually get that RAM back, otherwise it's pointless
[12:17:52] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[12:30:56] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[12:32:10] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[12:43:11] * eddyb is trying to figure out a safe way to allow ..T (with T being a generic type param) in middle::ty
[12:44:02] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[12:44:05] <dbaupp> nmatsakis: unping (I think I resolved it)
[12:46:40] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[12:46:40] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14752e99c to 1461443dc: 02http://git.io/N3iJvQ
[12:46:40] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[12:46:41] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[12:46:41] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/4kMc4g
[12:46:41] <ghrust> 13rust/06auto 14e41c331 15Seo Sanghyeon: Fix type inference for proc expressions
[12:46:41] <ghrust> 13rust/06auto 14d4f3771 15bors: auto merge of #10728 : sanxiyn/rust/proc, r=cmr...
[12:46:42] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[12:46:59] <cmr> that can't be right
[12:49:30] <cmr> I think the world is exploding
[12:49:35] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[12:50:02] <dbaupp> cmr: "can't be right"?
[12:50:15] <cmr> nothing is landing at all
[12:50:39] <cmr> and thatmost recent one was a tidy failure about missing license, on an entirely unrelated PR
[12:51:45] <dbaupp> yeah, weird
[12:52:10] <cmr> klutzy: Luqman: ping
[12:52:20] <klutzy> cmr: pong
[12:52:39] <cmr> klutzy: do you have working cross-compilation with mingw-w64?
[12:53:25] <cmr> I'm getting https://gist.github.com/cmr/ca29e275b16e71386740
[12:53:55] <cmr> (updated with source file)
[12:55:08] <klutzy> cmr: I have no experience of linux->win cross build, but it seems that you should use --linker=x86_64-w64-mingw32-g++
[12:55:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:55:46] *** kimundi is now known as zz_kimundi
[12:56:02] <cmr> hm, that got me further
[12:56:17] <cmr> acrichto: we're not running ranlib on rlibs, should we be?
[12:58:04] <cmr> or it might be running the *wrong* one for the cross build.
[13:00:29] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:05:38] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[13:10:34] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[13:13:43] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Ping timeout)
[13:14:16] <eddyb> oh, I can't change middle::ty::ty_param/param_ty because that's the actual type parameter
[13:14:28] <eddyb> s/actual/formal
[13:16:05] <eddyb> maybe ty_param
[13:35:01] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[13:39:05] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[13:42:36] *** Joins: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP)
[13:42:41] <sanxiyn> Is Buildbot busted?
[13:47:54] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[13:49:24] <eddyb> let input_tys = decl.inputs.iter().enumerate().to_owend_vec().flat_map(|(i, a)| { // someone will kill me for this ^_^
[13:53:02] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[13:53:27] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[13:54:05] <Seldaek> seems like both rust and go look at each other and say "contiguous stacks are best, and the others do it!" http://blog.gopheracademy.com/day-02-go-1.2-performance-improvements (last sentence)
[13:55:58] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[13:57:23] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[13:59:37] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[14:01:53] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[14:02:02] <cmr> Seldaek: heh
[14:02:07] <cmr> A self-perpetuating cycle
[14:02:18] <cmr> sanxiyn: I think it is, yes.
[14:03:43] <sanxiyn> Seldaek: Heh indeed
[14:04:06] <sanxiyn> I remember Intel posting to gcc mailing list, saying, please merge this patch, LLVM is considering merging this already
[14:04:18] *** Quits: tedh (tedh@moz-A5D1CAB7.public.wayport.net) (Ping timeout)
[14:04:20] <sanxiyn> and posting to LLVM mailing list, saying, please merge this patch, GCC is considering merging this already
[14:04:29] <sanxiyn> And someone actually caught this and replied this is not welcome
[14:04:46] <sanxiyn> (It was OpenMP related)
[14:05:32] <sanxiyn> cmr: I mean, tidy error where it works for me...
[14:05:53] <cmr> sanxiyn: yes, that.
[14:06:17] <sanxiyn> Rust: Go folks are doing this!
[14:06:22] <sanxiyn> Go: Rust folks are doing this!
[14:06:23] <sanxiyn> ...
[14:07:36] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[14:07:51] * eddyb can't wait for post-mem-shrink snapshots
[14:08:14] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[14:08:40] <sanxiyn> eddyb: You mean AST boxing one?
[14:08:56] <eddyb> yeah
[14:08:56] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[14:11:32] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[14:12:57] <nmatsakis> dbaupp: ok
[14:13:00] <nmatsakis> dbaupp: I'm back now in any case
[14:13:11] *** Joins: tedh (tedh@moz-A5D1CAB7.public.wayport.net)
[14:14:10] <eddyb> nmatsakis, cmr: https://gist.github.com/eddyb/fa60028cea6787437d8f
[14:15:17] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[14:15:21] <eddyb> the compile-fail is just using a cheap trick to display the types
[14:20:32] <eddyb> / FIXME(#5723) --- turn this check on once &Objects are usable
[14:20:49] <eddyb> I'm finding skeletons in the closet
[14:21:04] <cmr> don't look under the rug
[14:22:07] *** Joins: jensnockert (jensnocker@moz-96B9881.wireless.lu.se)
[14:23:27] <eddyb> cmr: I don't understand what some of these checks do
[14:23:52] <eddyb> let's just hack the expansion support in subst and hope it works
[14:24:39] *** Joins: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca)
[14:33:18] *** Quits: jensnockert (jensnocker@moz-96B9881.wireless.lu.se) (Input/output error)
[14:34:01] *** Joins: jensnockert (jensnocker@moz-96B9881.wireless.lu.se)
[14:34:25] <nmatsakis> pnkfelix: re: https://github.com/mozilla/rust/issues/5922#issuecomment-29621567, try to resist the urge to say I told you so
[14:35:24] *** Joins: jensnock_ (jensnocker@moz-96B9881.wireless.lu.se)
[14:35:26] *** Quits: jensnockert (jensnocker@moz-96B9881.wireless.lu.se) (Connection reset by peer)
[14:35:41] <pnkfelix> nmatsakis: you mean mean about err'ing on the side of explicitness rather than inference?
[14:35:54] <nmatsakis> pnkfelix: or at least having the means to have some explicit notation, but yes
[14:36:11] <nmatsakis> pnkfelix: (though I was...nevre opposed to that, I'd just prefer it to be inferred by default)
[14:36:16] <nmatsakis> or maybe I was, I can't remember ;)
[14:36:18] <nmatsakis> but I'm not now
[14:36:38] <eddyb> ouch, I can't error from a type folder :(
[14:36:48] *** Quits: jensnock_ (jensnocker@moz-96B9881.wireless.lu.se) (Input/output error)
[14:37:20] *** Joins: jensnockert (jensnocker@moz-96B9881.wireless.lu.se)
[14:37:34] <nmatsakis> eddyb: yes, it sucks. I've been meaning to change that to a Result<T> monad... 
[14:37:35] <pnkfelix> nmatsakis: well, I've always acknowledged that I am a very odd duck when I've put forward my preferences for enabling explicitness
[14:37:48] <nmatsakis> pnkfelix: I think you are correct, ultimately, that *enabling* explicitness is the right thing
[14:37:55] <nmatsakis> pnkfelix: just not *requiring* it
[14:37:57] <eddyb> nmatsakis: I guess I can always ICE and do the actual check in a substitution type folder
[14:38:20] <nmatsakis> eddyb: what we do elsewhere is generate a dummy result and pass along a bool or something
[14:39:01] *** Quits: jensnockert (jensnocker@moz-96B9881.wireless.lu.se) (Ping timeout)
[14:40:12] <pnkfelix> nmatsakis: what would the point be of having an explicit syntax for bivariance when you also report an error for it?  Just so that you could write out the syntax that your type inference created, even though it does not type check?
[14:40:32] <pnkfelix> nmatsakis: or is it that you only get an error from bivariance at the point where you attempt to instantiate it?
[14:40:43] <pnkfelix> nmatsakis: I'll put that question on the ticket instead.
[14:41:58] <nmatsakis> pnkfelix: the point of having an explicit syntax would be in case you wanted it
[14:42:22] <nmatsakis> pnkfelix: it wouldn't be an error if you wrote it explicitly
[14:42:30] <pnkfelix> OH
[14:42:40] <pnkfelix> nmatsakis: that is *not* clear from your post, IMO
[14:42:58] <cmr> What do all these strange "variant" terms mean, and where do they come from?
[14:43:26] *** Joins: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP)
[14:43:50] <cmr> http://en.wikipedia.org/wiki/Variance_%28computer_science%29 ?
[14:44:16] <nmatsakis> cmr: yes, sorry, I didn't feel like explaining background in that comment ;)
[14:44:21] <cmr> no it's fine
[14:44:24] * cmr is just curious
[14:44:38] *** Quits: summerlight_ (summerligh@327FC32B.2C956A45.501EFF44.IP) (Quit: Ï†Ñ Ïù¥Îßå Í∞ëÎãàÎã§.)
[14:45:24] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[14:45:44] <cmr> Is bivariant "anything goes"?
[14:46:32] <cmr> Ah the article even has a whole section on variance inference!
[14:46:34] * cmr has much to learn
[14:48:04] <nmatsakis> cmr: yeah, bivariance is basically anything goes -- not of much use, but I can imagine a scenario or two
[14:48:17] <nmatsakis> well, maybe. maybe not.
[14:50:00] <pnkfelix> nmatsakis: I still think it is only an artifact of the lattice
[14:50:13] <pnkfelix> nmatsakis: Its very natural, but not necessarily useful
[14:50:32] <pnkfelix> nmatsakis: much like Top in an pure OO system.
[14:50:37] <nmatsakis> pnkfelix: I'm not sure; the case I'm thinking of is if you have a supertype that has a parameter and some specific variance,
[14:50:56] <nmatsakis> pnkfelix: and you have a subtype that could be used for any variance because it contains no borrowed pointers at all,
[14:51:15] <eddyb> Top is like Any?
[14:51:33] <nmatsakis> pnkfelix: you can do "Foo<*'a>" extends or implements Bar<'a> or something. It may not be necessary; usually Foo extends Bar<'static> is probably what you want
[14:51:40] <pnkfelix> eddyb: yeah, I think so.
[14:51:53] <nmatsakis> pnkfelix: I was thinking of how in Scala you have "case class None extends Option<Any>" (which is a case where top is needed in an OO system)
[14:51:56] <pnkfelix> eddyb: (not our Any, that actually carries a typedesc, though.)
[14:52:05] <nmatsakis> pnkfelix: or rather "case object None extends Option<Any>"
[14:52:21] <nmatsakis> eddyb: top is like `Object` in Java
[14:52:32] <pnkfelix> nmatsakis: I was trying to avoid saying that
[14:52:34] <nmatsakis> eddyb: and bottom like the type of a `null` pointer
[14:52:43] <pnkfelix> nmatsakis: because Java makes `Object` actually have utlity
[14:52:45] *** Joins: jensnockert (jensnocker@moz-96B9881.wireless.lu.se)
[14:52:47] <nmatsakis> eddyb: (ignoring primitive types, just looking at object types, which is probably why pnkfelix was avoiding that)
[14:53:01] <pnkfelix> nmatsakis: e.g. equals() method, hashCode(), etc.
[14:53:07] <nmatsakis> pnkfelix: yes, and Any (in general) has utility :)
[14:53:17] <eddyb> nmatsakis: a JS value can be primitive or object, that's better
[14:53:27] <nmatsakis> pnkfelix: e.g. scala has Any (which is a true top) and it also has equals etc
[14:53:39] <eddyb> but it's not typed enough for a type theory discussion >_<
[14:53:58] <nmatsakis> pnkfelix: or rather Any *can* have utility, I guess I should say...
[14:54:21] <nmatsakis> but it's also useful even without that, as in that example I gave (None extends Option<Any>)
[14:54:30] <nmatsakis> note though that bivariance is not required there,
[14:54:33] <nmatsakis> just the fact that Option is covariant,
[14:54:38] <nmatsakis> and hence Option<Any> is perfectly general
[14:55:47] *** Quits: jensnockert (jensnocker@moz-96B9881.wireless.lu.se) (Input/output error)
[14:57:20] <pnkfelix> nmatsakis: well, I still contend that *bivariance* strikes me as an artifact ‚Ä¶ of the variance lattice, and perhaps also of syntactic weaknesses
[14:57:48] <pnkfelix> nmatsakis: i.e. the need to artificially generate a lifetime for a trait even though your implementing type does not use that lifetime at all
[14:57:48] <nmatsakis> pnkfelix: syntactic weaknesses? 
[14:58:06] <pnkfelix> nmatsakis: (I struggled with that phrase, its poor-word-choice)
[14:58:10] <nmatsakis> pnkfelix: I guess I just...disagree. The point is that the trait would be also implemented by things for which the lifetime may be relevant
[14:58:42] <pnkfelix> nmatsakis: let me look at your example again
[14:59:07] <nmatsakis> pnkfelix: e.g., imagine a trait like `trait GetSet<='a> { fn get(&self) -> &'a int; fn set(&mut self, &'a int); }`
[14:59:12] <nmatsakis> pnkfelix: this is invariant with respect to 'a
[14:59:18] <nmatsakis> pnkfelix: now imagine an implementation that ignores sets:
[14:59:53] <eddyb> uhm, where should I ask this: can we replace ty_nil with ty_tup(~[])? the main reason to not do that atm is the heap allocation. but changes to vectors would make ~[] be just (0u, 0u)
[14:59:56] <nmatsakis> pnkfelix: struct Foo; impl<'a> GetSet<'a> for Foo { fn get(&self) -> &'a int { /* return some &'static thing */ } fn set(&mut self, &'a int) { } }`
[15:00:09] <nmatsakis> pnkfelix: admittedly, we don't need bivariance here, since we don't consider variance on impl type parameters :)
[15:00:20] <nmatsakis> pnkfelix: still I suspcet I can come up with some example :)
[15:02:24] <nmatsakis> eddyb: I don't know what you mean by "heap allocation" -- oh, in the representation itself? that doesn't matter, it's interned.
[15:02:33] <nmatsakis> eddyb: I expect we could, that'd be a nice simplification.
[15:03:05] <eddyb> nmatsakis: yeah, I don't want to write double the code for ty_tup and ty_nil
[15:06:06] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[15:10:15] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[15:11:59] <eddyb> hmm, need to get a span from a ty::t
[15:12:52] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[15:16:15] <nmatsakis> that is not possible and doesn't make sense
[15:16:32] <nmatsakis> that is, `ty::t`s are interned and not specific to any particular source location
[15:17:36] <eddyb> nmatsakis: what about param_ty?
[15:18:43] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:21:36] <nmatsakis> eddyb: what about it?
[15:22:00] <nmatsakis> eddyb: you want the span of the parameters declaration, is that what you mean?
[15:23:01] <eddyb> nmatsakis: there's no way I could get the span of a type parameter use, is there? declaration could do, I guess
[15:23:11] <eddyb> I just want to provide as much info as possible and not screw this up in any way
[15:24:43] <nmatsakis> eddyb: you generally get the spans by walking the AST, it doesn't make sense to go from a ty::t to a span
[15:25:00] <eddyb> right, I get that
[15:26:01] <eddyb> wait, TypeFolder can output errors, it has a tcx method /facepalm
[15:26:59] <eddyb> yay I don't need to duplicate code
[15:35:37] *** Joins: jensnockert (jensnocker@moz-96B9881.wireless.lu.se)
[15:36:32] *** Quits: jensnockert (jensnocker@moz-96B9881.wireless.lu.se) (Input/output error)
[15:42:08] <eddyb> if param_def.bounds.builtin_bounds.contains_elem(BoundSized) {
[15:42:16] <eddyb> huh, what's that about?
[15:53:32] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[15:55:32] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[15:55:35] *** Joins: tikue (quassel@moz-FEADCD38.hsd1.pa.comcast.net)
[15:56:42] *** Quits: tikue (quassel@moz-FEADCD38.hsd1.pa.comcast.net) (Connection reset by peer)
[15:57:13] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[15:58:34] *** Joins: tikue (quassel@moz-FEADCD38.hsd1.pa.comcast.net)
[15:59:25] *** Joins: jensnockert (jensnocker@moz-96B9881.wireless.lu.se)
[15:59:56] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[16:05:38] <pnkfelix> eddyb: ‚Ä¶ are you talking about the line of code that has a reference to https://github.com/mozilla/rust/issues/6308 two lines above it?  Or is grep failing me?
[16:06:34] <pnkfelix> eddyb: (this is an area of the type system design that is under heavy revision/redesign right now)
[16:07:02] *** Parts: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP) (Leaving)
[16:07:02] <eddyb> pnkfelix: oh wow, didn't realize the DST talk was around for that long, should've checked the issue, I was just passing by that part of the code
[16:07:43] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[16:08:39] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[16:11:56] *** Joins: twb (textual@moz-C0B32516.lawn.gatech.edu)
[16:17:28] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[16:22:18] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[16:25:44] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[16:26:38] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[16:31:46] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[16:36:07] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[16:38:15] *** Quits: jensnockert (jensnocker@moz-96B9881.wireless.lu.se) (Connection reset by peer)
[16:38:37] *** Joins: jensnockert (jensnocker@moz-96B9881.wireless.lu.se)
[16:57:13] *** Joins: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net)
[16:57:43] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[16:59:34] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[17:00:36] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[17:01:24] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[17:02:04] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[17:03:48] *** Joins: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro)
[17:04:15] <pnkfelix> nmatsakis: finishing part II.  I am amazed you were at a loss to come up with an acronym
[17:04:39] <pnkfelix> nmatsakis: after all, Existentially Sized Types (EST) seems obvious enough to me.
[17:05:00] <pnkfelix> nmatsakis: and it certainly passes our confusion quota.
[17:06:04] *** Quits: canhtak (canhtak@moz-A53E1151.wl.t.ulaval.ca) (Quit: canhtak)
[17:06:44] <acrichto> cmr: ranlib? I don't know much about ranlib
[17:07:21] <benh> pnkfelix: in that case i hope we eventually arrive at a system that can be acronym'd as UTC
[17:07:45] <benh> universal... type... calculus!
[17:08:29] <eddyb> benh: terrible. ship it!
[17:09:00] * eddyb takes another sip of wine juice and goes back to waiting for a build to finish
[17:09:14] <nmatsakis> pnkfelix: the problem is that EST applies equally well to DST...
[17:09:20] <cmr> acrichto: it's ar -s I think. just makes a symbol index. you need to do it to link to a static lib
[17:09:21] <nmatsakis> pnkfelix: ...but I agree it's plenty confusing :)
[17:10:13] <nmatsakis> eddyb: when reviewing old blog posts, i realized we've been talking about DST for ... at least a year. In fact, if you stretch it to include closures and things, we've basically been talking around the issue since I started 2 years ago :)
[17:10:20] <acrichto> cmr: so in theory https://github.com/mozilla/rust/blob/master/src/librustc/back/archive.rs#L118 should be "rs" as an argument to ar?
[17:10:31] <nmatsakis> though the unknowns are much more narrow at this point, and the context has clearly changed dramatically
[17:10:39] <cmr> acrichto: that's only true for GNU
[17:10:49] <acrichto> what goes wrong if we don't do that?
[17:11:03] <eddyb> now there's some danger of fn foo<T, U>(_: (T, ..U, T)) {} compiling, I really hope I nailed that
[17:11:05] <cmr> you can't link to it at all.
[17:11:15] <cmr> at least, that's what I experienced with cross-compiling with mingw-w64
[17:11:24] <cmr> I needed to run the proper ranlib manually on all the things.
[17:11:31] <acrichto> interesting... is this something that's just not covered by the test suite?
[17:11:37] <cmr> seems so.
[17:11:57] <acrichto> we do have a test that generates a staticlib and then uses gcc to link to it?
[17:12:18] <cmr> I think the build system is just not using the proper ranlib when cross compiling.
[17:12:32] <cmr> wait
[17:12:36] <cmr> no, it would be rustc doing it.
[17:12:42] <cmr> sec
[17:13:18] <eddyb> nmatsakis: I am running blind through rustc with these tuple extensions, and I still could be done in a couple of days - but I dread the amount of testing that will be required >_>
[17:15:42] <cmr> acrichto: I also need to manually use --linker when cross compiling, is this expected?
[17:16:20] <cmr> gah, I cannot reproduce
[17:16:23] <acrichto> cmr: for now yes, otherwise we'd have to know that the target != host and just assume that "$target-ld" and "$target-ar" are binaries
[17:18:38] <eddyb> nmatsakis, cmr: it works as expected! https://gist.github.com/eddyb/fa60028cea6787437d8f
[17:23:58] <cmr> acrichto: I cannot reproduce the ranlib errors at all, but they definitely happened :(
[17:24:26] <acrichto> hm, well if you run across them again let me know, I'm wary of adding various flags without tests to make sure that they're there
[17:24:33] <cmr> yeah
[17:25:15] *** Quits: jensnockert (jensnocker@moz-96B9881.wireless.lu.se) (Ping timeout)
[17:25:47] *** Quits: notmatt (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[17:26:08] *** Joins: notmatt (notmatt@75AC61E6.68FFFFA3.47C41102.IP)
[17:26:53] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[17:26:53] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d4f3771 to 1461443dc: 02http://git.io/N3iJvQ
[17:26:53] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[17:26:58] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[17:26:58] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/IlCi2g
[17:26:58] <ghrust> 13rust/06auto 14055ddbe 15Alex Crichton: Register new snapshots
[17:26:58] <ghrust> 13rust/06auto 141bf00b2 15Alex Crichton: Link rustllvm statically to librustc...
[17:26:58] <ghrust> 13rust/06auto 149232d3b 15Alex Crichton: Distribute a unified binary for snapshots...
[17:27:00] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[17:30:15] *** Quits: twb (textual@moz-C0B32516.lawn.gatech.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[17:33:05] <SimonSapin> Does "warning: value assigned to `longest_length` is never read" not account for reads in a macro expansion?
[17:33:16] *** Joins: twb (textual@moz-C0B32516.lawn.gatech.edu)
[17:34:07] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[17:36:46] <eddyb> cmr: https://github.com/mozilla/rust/pull/10769 any idea who else I should poke about it?
[17:37:08] <cmr> holy crap does it actually, like, fully work?
[17:37:17] <benh> :D
[17:37:24] <benh> eddyb does amazing work~
[17:37:39] <eddyb> cmr: only types
[17:38:23] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[17:38:47] <eddyb> cmr: it's quite limited in what you can do with it, but it's required for my variadic generics proposal
[17:40:07] <eddyb> the next part would be ..tuple_value in values, then ..tuple_binder in patterns and only then <..T> in generics
[17:40:12] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[17:40:54] <cmr> eddyb: probably pnkfelix and/or pcwalton too
[17:41:38] <eddyb> cmr: gotta make sure pcwalton doesn't give me another enthusiastic-but-premature r+ :P
[17:44:17] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[17:46:49] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[17:46:49] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14b38907d to 1461443dc: 02http://git.io/N3iJvQ
[17:46:49] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[17:46:50] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[17:46:50] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/tyTRTQ
[17:46:50] <ghrust> 13rust/06auto 14a3aa325 15SiegeLord: Add placeholder text to the search bar in the documentation.
[17:46:50] <ghrust> 13rust/06auto 14e73d506 15SiegeLord: Add a type="search" to the search bar in the documentation.
[17:46:50] <ghrust> 13rust/06auto 143ae7fcc 15bors: auto merge of #10759 : SiegeLord/rust/placeholder, r=cmr...
[17:46:52] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[17:48:49] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Ping timeout)
[17:50:55] <eddyb> error: expected type, found token DOTDOT // oops, no struct support yet
[17:52:17] <jack> acrichto: how do you set the linking type in a crate now?
[17:52:30] <acrichto> jack: what do you mean by linking type?
[17:52:34] <jack> i'm starting to worry that your static linking will be a bit difficult to rebase my pkgid stuff over
[17:52:45] <jack> how does it determine how to link staticly or not?
[17:52:55] <acrichto> hehe, that's a bit of a tricky question
[17:53:18] <jack> or maybe a mroe direct question, do you add stuff to the link metadata?
[17:53:30] <acrichto> jack: I wrote up documentation for the whole system in https://github.com/mozilla/rust/pull/10742 which you may want to read, but there's nothing in the link metadata
[17:53:38] <jack> oh good
[17:53:54] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[17:54:19] <cmr> Can attribute be applied to `extern mod`?
[17:55:23] <eddyb> working on structs and enums right now https://gist.github.com/eddyb/fa60028cea6787437d8f#file-tuple-expansion-compile-fail-rs-L9
[17:55:35] <eddyb> those might require some kind of type inference
[17:58:01] *** zz_kimundi is now known as kimundi
[18:00:09] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[18:00:36] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[18:10:03] <pnkfelix> acrichto: https://github.com/mozilla/rust/pull/10771
[18:20:09] <cmr> nmatsakis: really working through that email queue eh?
[18:21:27] <nmatsakis> cmr: spent all morning on it, but man there's a lot on rust-dev
[18:21:38] <cmr> yeah
[18:21:41] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[18:21:41] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 143ae7fcc to 1461443dc: 02http://git.io/N3iJvQ
[18:21:41] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[18:21:42] <nmatsakis> haven't even touched those threads yet
[18:21:42] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[18:21:42] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/z7GmRw
[18:21:42] <ghrust> 13rust/06auto 14f9d6fd2 15Alex Crichton: Support OSX frameworks...
[18:21:42] <ghrust> 13rust/06auto 144ecdd23 15Alex Crichton: Bring the linkage documentation up-to-date...
[18:21:42] <ghrust> 13rust/06auto 14bd71546 15bors: auto merge of #10742 : alexcrichton/rust/frameworks, r=cmr...
[18:21:44] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[18:21:45] <pnkfelix> acrichto: oh duh, I need to generalize this to apply beyond just the LLVM build, don't I
[18:22:04] * pnkfelix was wondering why his commit didn't actually fix the `make check` issue
[18:22:06] <acrichto> pnkfelix: did that not work? I would have expected it to get propagated correclty?
[18:22:19] <pnkfelix> acrichto: no I don't think so, I think it only applies to the LLVM build itself.
[18:22:23] <acrichto> you don't have a CC env-var do you?
[18:22:32] <pnkfelix> when I call configure I do
[18:22:46] <pnkfelix> acrichto: but not when I call make
[18:22:46] <acrichto> pnkfelix: oh wait, mk/platform.mk
[18:22:51] <acrichto> that's where -Qunused-arguments are added
[18:23:18] <pnkfelix> acrichto: ah, and there's the same problem there, okay
[18:23:41] <acrichto> I removed r+ for now, but r=me with the additions
[18:24:00] <pnkfelix> acrichto: thx, was just about to attmpt to do that.  You beat me to it.  :)
[18:26:08] <cmr> bjz: ping
[18:28:28] <eddyb> pnkfelix: most of compile-fail actually abuses errors to show the types (let _: T = ();). I guess I'll use any::TypeId::of::<T> or something like that
[18:28:50] <pnkfelix> eddyb: I don't mind that you included compile-fail output
[18:29:27] <eddyb> all that is manual testing right now, I'm still adding support in typeck :D
[18:29:45] <pnkfelix> eddyb: I just meant 1. It would be nice to know that the feature actually works (as opposed to just enabling some extra syntax that never actually type checks), when it does work and 2. it would give you a chance to illustrate the value of this change on its own.
[18:30:13] <pnkfelix> hmm.  I don't understand this pattern of putting up Pull Requests that are not actually Pull Requests
[18:30:26] <eddyb> oh, sure, all those errors will become asserts
[18:30:27] <pnkfelix> I mean, I understand the desire to advertise and get feedback
[18:30:50] <pnkfelix> but it just seems like it makes the bors queue more confusing
[18:31:08] <eddyb> ouch, I forgot about that. sorry :(
[18:31:15] *** Joins: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net)
[18:31:23] <pnkfelix> eddyb: its okay, I don't think you are the only person to do this
[18:31:57] <pnkfelix> eddyb: For all I know it may be a practice sanctioned by other core team members.
[18:32:07] <pnkfelix> eddyb: I'm just expressing my own confusion w.r.t. to it.
[18:32:19] <benh> It's probably the best place in the github architecture to deposit code to be reviewed, whether it's already good to be merged or not
[18:33:36] <cmr> I really don't think github is scaling to our needs.
[18:33:38] <pnkfelix> benh: is that really true?  Can one not just go directly to the branch?
[18:33:49] <pnkfelix> benh: and leave comments on commits there?
[18:34:12] <cmr> pnkfelix: how do you find said branches, though?
[18:34:30] <pnkfelix> cmr: I was assuming someone would be advertising them to particular individuals
[18:34:30] <cmr> Maybe we just need an extra tool or few for this.
[18:34:38] <pnkfelix> cmr: that, or you can post them *onto* an issue
[18:34:44] <cmr> yeah, that's true.
[18:35:10] <pnkfelix> cmr: i.e. post links to your branch from an issue.  I think we were doing this back when many of us were independently attempting ast visitor refactorings.
[18:35:41] <cmr> yeah
[18:35:48] *** Joins: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se)
[18:36:28] <eddyb> ast visitor? heh, I was thinking of touching that (make it use only borrowed pointers). should start a discussion first, though
[18:36:34] <acrichto> pnkfelix: nmatsakis: is there a reason that #10506 shouldn't land? looks like it was just a spurious failure that prevented it the first time
[18:38:01] <acrichto> cmr: want me to rebase #10665 for you?
[18:38:13] <acrichto> (I'm in "clean the queue" mode)
[18:38:31] <cmr> acrichto: I didn't even realize that was still open
[18:38:38] * cmr tends to forget about things after the r+
[18:38:45] <cmr> I'll do it.
[18:38:50] <acrichto> cool
[18:38:51] <acrichto> thanks!
[18:39:12] *** Quits: twb (textual@moz-C0B32516.lawn.gatech.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzz‚Ä¶)
[18:39:39] *** Parts: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) ()
[18:40:03] <cmr> acrichto: r?
[18:42:23] <nmatsakis> acrichto: it could land
[18:42:28] <acrichto> I wonder if we should just auto-close anything with something like 2 weeks of inactivity
[18:42:41] <nmatsakis> I marked it retry
[18:43:02] <Eridius> acrichto: would be nicer to comment in anything that old suggesting that there should be some activity or it will be closed
[18:43:13] <Eridius> because summarily closing tickets is a great way to make people feel unwelcome
[18:43:27] <nmatsakis> could of course autocomment after 2 weeks, autoclose after 3, or something.
[18:43:55] <eddyb> sounds good, trying to remember where I've seen this before
[18:45:59] *** Joins: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net)
[18:47:02] *** Quits: notmatt (notmatt@75AC61E6.68FFFFA3.47C41102.IP) (Ping timeout)
[18:51:08] <eddyb> no IRC disconnect during rustc-stage1 and I still have my browser open
[18:51:14] * strcat sighs
[18:51:20] * eddyb hi fives himself
[18:51:37] <strcat> so libuv lost their most active contributor over the age old `they` vs. `he` as gender neutral pronoun grammar bikeshed
[18:51:51] <friggle> strcat: what? Ben N is gone?!
[18:51:59] <cmr> wait what
[18:52:07] <cmr> I saw the kerfluffle but I didn't realize it was serious
[18:52:08] <eddyb> strcat: waaah
[18:52:13] <cmr> bnoorhuis was awesome :(
[18:52:16] <cmr> d
[18:52:23] <strcat> friggle: well he said he's not going to contribute anymore after Joyent called him a sexist asshole on their corporate blog
[18:52:45] <strcat> anyway I don't really see how this is a gender equality issue :s
[18:52:46] <kmc> strcat: they didn't say that, please don't escalate this further
[18:52:53] <friggle> I thought he basically led libuv
[18:53:02] <strcat> kmc: https://www.joyent.com/blog/the-power-of-a-pronoun
[18:53:03] <kmc> they called his attempt to revert the already-landed pronoun change "gobsmackingly inappropriate", which it was
[18:53:06] <kmc> yes i read that
[18:53:25] <strcat> kmc: it's inappropriate to follow their contribution guidelines? :\
[18:53:31] <eddyb> where would a pronoun like that be?
[18:53:35] <cmr> eddyb: docs
[18:53:48] <strcat> pushing something because it turned into a PR issue seems inappropriate
[18:54:45] <kmc> strcat: it's inappropriate for an OSS leader to show such a blind devotion to procedure on extremely emotionally charged issues
[18:55:08] <kmc> he could have at least waited a bit before reverting, or reverted with a less angry commit message
[18:55:20] <strcat> kmc: this has never seemed like anything but an age old English grammar bikeshed to me, I had teachers who refused to accept a singular 'they'
[18:55:21] <cmr> I didn't realize it was a revert, I thought it was just a closed PR.
[18:55:53] <eddyb> https://github.com/joyent/libuv/pull/1015 oh, one of these long threads
[18:55:53] <kmc> cmr: he tried to revert it after someone else (a Joyent employee) overruled his closing of the PR
[18:55:57] <kmc> don't read the thread :(
[18:55:58] <kmc> please
[18:56:00] <cmr> oh
[18:56:02] <cmr> that's sad.
[18:56:02] <strcat> is speaking French sexist because all the nouns are arbitrarily gendered? Italian, etc. too
[18:56:02] *** Quits: Sharp (Sharp@moz-780FECDA.washdc.fios.verizon.net) (Quit: Sharp)
[18:56:04] <kmc> it's become a total shitshow
[18:56:06] <strcat> kmc: they can't 'overrule' it
[18:56:08] * cmr doesn't care about node.js anymore.
[18:56:14] <friggle> kmc: and Joyent should have explained their unease to Ben's boss, who should have had a private chat with him. Not written a blog post about how they would have fired him immediately
[18:56:22] <cmr> Maybe we can snag bnoordhuis for ourselves ;p
[18:56:31] <kmc> friggle: I agree Joyent's reaction was extreme
[18:57:02] <kmc> strcat: have you read http://www.cs.virginia.edu/~evans/cs655/readings/purity.html
[18:57:11] <Eridius> Joyent's public post calling for his termination was surprising and extreme. But bnoordhuis's behavior was inexcusable as well.
[18:57:23] <Eridius> Isaac's post I thought was good
[18:57:38] <eddyb> ouch, this was bad (and it started another long thread): https://github.com/joyent/libuv/commit/804d40ee14dc0f82c482dcc8d1c41c14333fcb48
[18:57:43] <kmc> strcat: the weird thing is, people keep saying "gendered language doesn't matter" and "stop wasting time on it"  and then they FIGHT LIKE HELL when the change is already ready to merge
[18:57:43] <strcat> kmc: look, I'm saying this as someone who tries to use 'they' and 'them' but I have no problem with people not making that same grammar decision
[18:58:03] * eddyb is still trying to figure out the sides of this story
[18:58:04] <kmc> strcat: I do have a problem with it, and a lot of other people do, so why are you standing up for the person who closed an mergeable pull requset to fix it
[18:58:16] <strcat> kmc: because it's a grammar bikeshed
[18:58:27] <Eridius> strcat: it's one thing to personally decide you don't want to use "they" as a gender-neutral singular pronoun. But reverting a change landed by another committer on that, because of your personal feelings that it's unimportant? That's 100% wrong
[18:58:36] <Eridius> not important to _you_ does not mean not important to _everyone)_
[18:58:50] <kmc> it's not a meaningless bikeshed, it matters to a lot of people, it relates deeply to issues of privilege and fairness, even if you don't see that yourself
[18:58:55] <Eridius> strcat: the fact that it involves the english language does not make it trivial
[18:59:00] <friggle> Eridius: was it not reverted based on it not going through the correct procedure?
[18:59:14] <strcat> grammar isn't why FOSS is predominantly a bunch of people with a male gender identity
[18:59:35] <Eridius> friggle: that was the original stated reason, but it should have been immediately obvious that reverting the commit like that would piss people off
[18:59:39] <kmc> strcat: nobody's claiming this is a full solution to gender equality in tech
[18:59:42] <kmc> that's ridiculous
[18:59:46] <strcat> it's not a solution to gender equality at all
[18:59:52] <strcat> it's an age old linguistic issue
[18:59:52] <kmc> it should have been a 15 second change to make things slightly better
[18:59:55] <Eridius> strcat: more inclusive language? Absolutely is a step in the right direction
[19:00:08] <kmc> anyway, I can't take arguing about this anymore
[19:00:15] <strcat> Eridius: so romance languages with gendered nouns are sexist?
[19:00:32] <strcat> keep in mind that they genders aren't even consistent between the languages
[19:00:45] <kmc> you're changing the subject and generally being ridiculous
[19:00:50] <kmc> we aren't talking about romance languages
[19:00:51] <strcat> it's not changing the subject
[19:00:52] <kmc> we're talking about English
[19:01:20] <friggle> Eridius: yeah, but I think it's *at least* equally likely that Ben doesn't understand the issue and lacks conflict resolution skills as he is a sexist pig. Given a lack of evidenc eotherwise, I'd tend to believe the first
[19:01:21] <kmc> what's good in the English language and an Anglophone cultural context doesn't have to be the same as what's good in French
[19:01:23] <strcat> kmc: and there's not consensus that 'they' and 'them' are appropriate as a singular gender neutral pronoun, it's an age old grammar battle
[19:01:49] <benh> in germany, people concerned about gender equality are taking steps to reword things to avoid sexist constructions
[19:01:53] <kmc> there are examples from respected authors back to the 1300s
[19:02:06] <kmc> strcat: anyway you're acting like grammar was handed down from God on stone tablets... grammar exists to facilitate communication
[19:02:06] <strcat> kmc: I'm not saying they weren't used that way ages ago
[19:02:17] <kmc> if we want gender-neutral language then it's in our power to bend grammar to that goal
[19:02:28] <kmc> anyway, i cannot take more of this argument while I'm supposed to be working
[19:02:37] <strcat> kmc: sure, and there is not a current consensus (and never has been) on how to do a singular gender neutral pronoun in english
[19:02:55] <nmatsakis> luckily for us, this fight has nothing to do with Rust -- take it to Reddit (my 2 cents).
[19:02:55] <benh> I'm not sure whether german is inherently sexist or not but I also don't think it's fair to suggest that there's no issue with 'overgendering'
[19:03:00] <Eridius> friggle: I'm certainly not calling Ben a sexist pig. But he does seem to be wilfully ignorant, and prioritizing trivialities of commit procedure over the well being of the community
[19:03:15] <kmc> I will do everything in my power as a Mozilla employee and a #rust op and such to make the Rust community gender-inclusive, which includes not using "he" to refer to an arbitrary programmer, and yes I'm fucking aware that's not all I need to do ;P
[19:03:42] <Eridius> kmc: glad to hear it
[19:03:48] <kmc> and I hope that I don't come into conflict with you strcat on anything which affects the Rust community
[19:03:49] <Eridius> but I think nmatsakis is right. This is rather off topic
[19:03:49] <nmatsakis> also, kmc is correct that in the past we (the "Rust" community) have decided that -- at least on our turf -- "they" is the appropriate pronoun to use
[19:03:54] <friggle> Eridius: ok, I'm not familiar with the full context or any potential pattern of behaviour. I just know of him through reading really helpful responses on the libuv mailing list
[19:03:56] <benh> I grepped rustc earlier and there's a great total of one occurence of male pronouns refering to an arbitrary programmer and that's a "his/her" in some non-doc comment :)
[19:03:59] <kmc> because your attitude here is ugly and wrong
[19:04:35] <strcat> kmc: I'll continue using 'they' myself, but I have a problem with calling someone a sexist for their pronoun choices
[19:04:36] <kmc> and I'm going to leave the channel now and get work done, but do check out that essay by douglass hofstadter, http://www.cs.virginia.edu/~evans/cs655/readings/purity.html
[19:04:55] <kmc> strcat: calling someone "sexist" by intent is very different from saying they did something which could have negative consequences
[19:05:03] <kmc> this is a big problem with the way we talk about these issues
[19:05:16] <kmc> in school you learn that racism and sexism come from a small group of Very Bad People with malicious intent
[19:05:23] <kmc> actually, they are attitudes which almost everyone holds to some degree
[19:05:27] <strcat> kmc: sure, having a conversation about it is good, but I don't think it's unacceptable for someone to them go on continuing to use 'he'
[19:05:43] <Eridius> unconscious cultural biases are extremely prevalent and act as a sort of blanket baseline level of sexism (and racism!)
[19:05:52] <strcat> I've seen people mix 'she' and 'he' and that's not very inclusive either
[19:05:58] <kmc> it's sad that polite attempts at correcting unintended behavior are usually interpreted as accusations of malice
[19:06:03] <strcat> in the end it's just a grammar issue I don't think it's very important
[19:06:08] <kmc> anyway ttyl
[19:06:09] *** Parts: kmc (keegan@moz-2C6EE959.compute-1.amazonaws.com) ()
[19:06:17] <benh> strcat: that's speaking as someone to whom 'he' applies :/
[19:06:19] <Eridius> strcat: if someone wants to continue saying 'he' on their own, that's their choice. But when they represent a community, and control the words of that community (in this case, Ben controlling the wording of the documentation), you have to apply different standards
[19:06:56] <eddyb> Ben's only excuse would be that isaacs bypassed some formality, but after dismissing that PR for being trivial, why go through the trouble to revert it? I don't really think Ben was holding to the masculine pronoun, this was bound to happen for any small change that's important to someone else but not him
[19:07:21] <strcat> benh: how do you know that? what does my gender identity have to do with anything?
[19:07:22] <eddyb> ignore me, I just keep ranting with no idea of what I meant to say >_>
[19:07:48] <benh> I assume that because you have a typically-male first name and haven't objected to be refered to as 'he'
[19:08:06] <eddyb> I've been called out as being sexist in the past while trying to express the opposite, I shouldn't even talk in this context
[19:08:08] <strcat> benh: so you assume that by having a male first name, I identify as a male? maybe I do, but that's more of an issue than choice in grammar
[19:08:09] <benh> it has to do with not having the same experiences as someone for whom 'he' in 'arbitrary programmer' position is exclusionry
[19:08:19] <Eridius> hah, kmc's link is good. Ya'll should read it with me
[19:08:36] <eddyb> Eridius: but... DOTDOT needs me
[19:08:44] <strcat> you don't know someone considers themselves a male because their parents named them that way
[19:08:56] <Eridius> strcat: I'm confused as to what you're currently arguing for
[19:09:12] <strcat> I'm arguing for not worrying about age old grammar conflicts
[19:09:34] <nmatsakis> I don't understand why this argument is happening here.
[19:09:36] <strcat> and I think it's relevant to rust that a project it uses lost a contributor who has over 30% of the commits to it and was active on rust's mailing list...
[19:09:45] <Eridius> strcat: the reason you can argue for that is because you're in a privileged position.
[19:09:46] <nmatsakis> The Rust project's position on this is pretty clear:
[19:09:52] <nmatsakis> avoid gendered pronouns and terms
[19:10:30] <friggle> and I would think that Rust's other policies would prohibit a witch hunt, and prefer someone at least having quiet word when a contributor acts out of line
[19:10:43] <nmatsakis> if a comparable situation evolved here,
[19:10:46] <nmatsakis> I would prefer to handle it quietly, yes.
[19:10:58] <strcat> Eridius: how do you know anything about my gender identity or sexual orientation? what makes you assume I'm in a privileged position?
[19:11:05] <benh> strcat: are you, then?
[19:11:08] <Eridius> friggle: Joyent was wrong to publish a public blog post calling for Ben's firing. However, it was kind of too late to handle quietly anyway, as the internet was already stirring up a shitstorm
[19:11:09] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:11:14] * nmatsakis rolls his eyes.
[19:11:17] <strcat> not something I want to talk about in this context
[19:11:20] <Eridius> strcat: are you saying you don't self-identify as male?
[19:11:30] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[19:11:30] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14bd71546 to 1461443dc: 02http://git.io/N3iJvQ
[19:11:30] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[19:11:38] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[19:11:38] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/n9TIcg
[19:11:38] <ghrust> 13rust/06auto 1437d6ca9 15Niko Matsakis: Make trait lifetime parameters early bound in static fn type.  This is related...
[19:11:38] <ghrust> 13rust/06auto 1492f25e6 15bors: auto merge of #10506 : nikomatsakis/rust/issue-10391-ICE-with-lifetimes, r=pnkfelix...
[19:11:38] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[19:12:07] <Eridius> ok, I give up. nmatsakis is right, this is not the right place for this conversation
[19:12:10] <friggle> Eridius: yeah, everyone acted badly. I just felt Joyent's blog post was particularly inflammatory and unprofessional.
[19:12:49] <benh> I'll drop this now. strcat: I apologize if I have been misgendering you and particularly for making it an issue in this context.
[19:13:08] <strcat> benh: you haven't, I just don't think it's relevant
[19:13:21] <friggle> is there an issue on the removal of 'do'?
[19:15:53] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[19:16:48] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[19:21:34] <bstrie> strcat: I elect you to start rewriting libm and libc so that we can have completely static executables
[19:21:45] <eddyb> test-run-pass.rs:2:8: 2:24 error: unresolved import: there is no `TypeId` in `std::any`
[19:21:51] <friggle> bstrie: no need, see musl
[19:21:58] <eddyb> why is TypeId behind #[cfg(stage0)]?
[19:22:00] * bstrie sees musl
[19:22:59] <strcat> friggle: rust needs to get definitions from headers for musl to completely work afaik
[19:23:05] <strcat> I don't think their ABI matches glibc 100%
[19:23:06] <eddyb> aaaah, unstable::intrinsics
[19:23:45] <friggle> strcat: what sort of definitions?
[19:24:00] <strcat> friggle: pthread_foo_t 
[19:24:04] <strcat> etc.
[19:24:12] <strcat> although those might match glibc
[19:24:19] <strcat> there are some that don't
[19:24:31] <friggle> strcat: hmm, ok
[19:25:04] <eddyb> why is TypeId::of::<T: 'static>? turns out 'static || isn't 'static, so I can't compare it
[19:25:27] <nmatsakis> what does `'static ||` mean?
[19:25:35] <benh> || being the closure type?
[19:25:47] <nmatsakis> oh. man I have to fix that.
[19:25:55] <nmatsakis> by which I mean the syntax 'static ||
[19:26:03] <nmatsakis> but also the general treatment of bounds
[19:26:28] <nmatsakis> eddyb: to answer your original question, it is static beacuse lifetimes don't exist at runtime
[19:26:43] <nmatsakis> eddyb: so we don't wind up with different type descriptors for &'a int and &'b int, basically
[19:26:50] <nmatsakis> eddyb: and ence we can't dynamically check casts between them
[19:27:14] <nmatsakis> eddyb: as for the type `'static ||` -- that should ... probably be considered 'static, but why are you using that type anyhow?
[19:27:23] <Eridius> nmatsakis: based on your blog post about multiple lifetime annotations, I thought you were adding _ as a type placeholder to allow inference. That doesn't seem to work today. Is this going to happen?
[19:27:24] <nmatsakis> eddyb: you would probably prefer the type fn() <-- bare fn with no contxt
[19:27:31] <eddyb> better way to compare types than TypeId::of?
[19:27:43] <eddyb> nmatsakis: just making sure |..(a, b)| works
[19:27:46] <nmatsakis> eddyb: compare types? when, at runtime?
[19:28:20] <nmatsakis> eddyb: I believe so, I am working on a patch that includes that, though it hasn't seen much attention in a week or two
[19:28:24] <nmatsakis> er, Eridius ^
[19:28:28] <eddyb> well, doesn't matter when, it's a run-pass test that has to assert two types are the same
[19:28:38] <Eridius> nmatsakis: oh good. I just wanted to make sure it didn't get dropped by the wayside
[19:29:44] <nmatsakis> eddyb: I'd suggest just writing a generic like `fn same_type<A>(x: A, y: A) {}` and see if you can call it. no runtime test needed.
[19:29:50] <Eridius> nmatsakis: on another note, in your SST proposal, how does that handle types that use the same type parameter twice in its field list? i.e. struct Foo<T> { a: *T, b: *T }
[19:29:57] <Eridius> nmatsakis: also, your hyperlinks to Part 2 are broken :O
[19:30:23] <Eridius> (the links in both Part 3 and Part 4, they refer to the wrong date)
[19:31:16] <nmatsakis> yeah I noticed
[19:31:36] <nmatsakis> I don't think using the same type parameter twice makes much difference to any of the schemes, really,
[19:31:39] <eddyb> nmatsakis: I don't want to instantiate those types, I wouldn't have gone through the trouble of using TypeId otherwise
[19:31:46] <nmatsakis> though for DST you lose some information
[19:32:08] <Eridius> nmatsakis: well, the question is, does it add a second existentially-quantified variable, or do both fields end up requiring the same length (which would be excessively weird)?
[19:32:13] <nmatsakis> eddyb: then just do "fn same_type<A>(x: Option<A>, y: Option<A>),
[19:32:21] <nmatsakis> eddyb: and call it same_type(None::<type1>, None::<type2>)
[19:32:35] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[19:32:44] <Eridius> because if `Foo<[T]>` becomes `exists N. Foo<[T, ..N]>`, that suggests that both fields have to be the same length
[19:32:52] <nmatsakis> Eridius: in DST, you'd lose the fact that the two are the same underlying type
[19:32:53] <eddyb> nmatsakis: ooooh
[19:32:56] <nmatsakis> Eridius: in SST, you'd not lose it
[19:33:05] <eddyb> thanks, I like the None trick
[19:33:16] <nmatsakis> Eridius: as you suggest. but you couldn't do much of use with that information I guess.
[19:33:20] <Eridius> nmatsakis: right, but if the "same underlying type" ends up including the length, then that's problematic
[19:33:26] <nmatsakis> Eridius: why?
[19:33:35] <nmatsakis> Eridius: I mean, keep in mind that I think SST + vectors doesn't work
[19:33:38] <nmatsakis> Eridius: for a host of reasons :)
[19:34:06] <nmatsakis> Eridius: but I don't think this is necessarily one of them, except insofar as it relates to the general problem of finding the right monomorphized instance
[19:34:06] <Eridius> nmatsakis: if I have Foo<T> and use two separate fields that are both defined in terms of T, and T is a [U], that does not necessarily mean both fields should be the same fixed-length vector
[19:34:32] <nmatsakis> Eridius: well, that depends on what the type system winds up being :)
[19:34:46] <nmatsakis> Eridius: but if it were SST, then [U] is not a type, it's a shorthand for a type with a missing length,
[19:34:53] <nmatsakis> Eridius: and yes, it DOES mean they are the same
[19:35:20] <Eridius> nmatsakis: I can take a Vec<T> and provide it as a value to something that wants a [T], yes?
[19:35:28] <nmatsakis> Eridius: No.
[19:35:39] <nmatsakis> Eridius: potentially you can convert a Vec<T> to a ~[T]
[19:35:50] <Eridius> No? I thought Vec<T> in this discussion was just the resizable vector, but that things that don't need to resize would use some [T] pointer instead
[19:35:52] <nmatsakis> Eridius: but not a [T] with no sigil.
[19:35:56] <Eridius> well no, but like a &[T]
[19:36:16] <nmatsakis> you could slice it, yes.
[19:36:23] <nmatsakis> that is, convert it to a &[T]
[19:37:05] <Eridius> struct Pair<T> { a: &T, b: &T } let a = ~[1i, 2, 3]; let b = ~[4i, 5]; Pair{ a: a, b: b} // seems like it should work, both end up being sliced to &[T]
[19:37:17] <nmatsakis> that would be a type error in an SST-like world
[19:37:25] <Eridius> but it would be a dynamic runtime failure
[19:37:30] <nmatsakis> no, it'd fail to compile.
[19:37:56] <Eridius> why? because the compiler just happens to know the length of a and b? What if we remove that?
[19:38:02] <nmatsakis> because there'd be no type that T could be bound to which would make it work
[19:38:07] <nmatsakis> remember that [T] is not a type in SST (just like today)
[19:38:15] <Eridius> struct Pair<T> { a: &T, b: &T } fn get_a() -> &[int]; fn get_b() -> &[int]; Pair{a: get_a(), b: get_b() }
[19:38:32] <nmatsakis> doesn't matter, wouldn't compile
[19:38:49] <nmatsakis> problem is that you are assuming Pair can be instantiated with T = [int]
[19:39:01] <Eridius> I thought that's what SST enabled?
[19:39:09] <nmatsakis> no, that's what DST enables.
[19:39:13] <nmatsakis> that's the main difference.
[19:39:33] <Eridius> I thought the whole point of SST is it turns Pair<[T]> into `exists N. Pair<[T, ..N]>`
[19:39:36] <nmatsakis> right
[19:39:46] <nmatsakis> note that Pair is instantiated there with [T, ..N]
[19:39:48] <nmatsakis> not with [T]
[19:39:58] <Eridius> for some unknown N
[19:40:15] <nmatsakis> it's a subtle difference, but from the point of view of the Pair instance, it's not unknown
[19:40:18] <nmatsakis> vs
[19:40:22] <nmatsakis> Pair<exists N., [T, ..N]>
[19:40:32] <nmatsakis> there, once you expand out the Pair definition,
[19:40:35] <nmatsakis> N is still unknown
[19:40:46] <Eridius> ok, let's just say I have `let a: &[T]`. The type of a is really `exists N. &[T, ..N]`, right? so how can I assign any other &[T] to it?
[19:40:51] <Eridius> `a = get_a()`
[19:41:19] <nmatsakis> it has to do with when the existential is "unpacked", basically
[19:41:31] <nmatsakis> so if you have "exists N. Pair<[T, ..N]>", 
[19:41:36] <nmatsakis> and you want to "expand" the def'n of Pair,
[19:41:50] <nmatsakis> you have to first "unpack" the existential, which basically means that N becomes a known length
[19:42:13] <nmatsakis> though even trying to explain this is making me want to not have to ever explain it again
[19:42:16] <Eridius> hah
[19:42:30] <nmatsakis> it's not really a *known* length in the sense that the compiler knows it,
[19:42:45] <nmatsakis> at least not statically,
[19:42:47] <nmatsakis> but it's a constant.
[19:42:55] <nmatsakis> like an algebraic variable X
[19:43:12] <nmatsakis> anyway, point is, if I have: let mut a: &[T] = ...
[19:43:18] <nmatsakis> and I later do a = get_some_other_slice()
[19:43:26] <nmatsakis> that's ok because the type of `a` is `exists N. ...`
[19:43:28] <Eridius> it sounds to me like this proposal makes the following invalid: `fn get_a() -> &[int]; fn get_b() -> &[int]; let mut a = get_a(); a = get_b();`
[19:43:30] <nmatsakis> that is, we're outside the existential
[19:43:33] <nmatsakis> no
[19:43:34] <nmatsakis> that's ok
[19:43:40] <Eridius> heh you were just typing up that example
[19:43:51] <nmatsakis> but that's not the example you gave before
[19:43:54] <Eridius> no it's not
[19:44:34] <Eridius> ok, so back to Pair. What actually prevents that from being instantiated?
[19:44:48] <nmatsakis> well, you'd have to come up with some type T
[19:44:56] <Eridius> it seems as though the Pair type is `exists N. Pair<[T, ..N]>`, which suggests that it should be possible to instantiate if both fields contain pointers to vectors of the same length
[19:44:57] <nmatsakis> remember that [T] is not a type by itself in SST, it's just a shorthand
[19:45:03] <nmatsakis> yes, it would be possible then
[19:45:12] <Eridius> except the compiler can't possibly enforce that at compile-time because it doesn't necessarily know the length of the vectors provided to the type
[19:45:15] <nmatsakis> yes, it can
[19:45:19] <nmatsakis> if the types are &[int, ..3]
[19:45:22] <nmatsakis> and &[int, .3]
[19:45:24] <nmatsakis> or whatever
[19:45:33] <Eridius> ok yes, it could work with that. So I guess you simply cannot initialize it with a &[T]
[19:45:35] <nmatsakis> yes
[19:45:38] <Eridius> you _have_ to have [T, ..N]
[19:45:44] <nmatsakis> yes, because [T, ..N] is a type
[19:45:45] <Eridius> which sucks
[19:45:49] * nmatsakis shrugs
[19:46:15] <nmatsakis> maybe? it's how it works today, I've found it limiting for impls/traits,
[19:46:19] <nmatsakis> not so much that particular example you gave
[19:46:32] <nmatsakis> but you would most likely wind up with double indirection, yes
[19:46:36] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:46:36] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1492f25e6 to 1461443dc: 02http://git.io/N3iJvQ
[19:46:36] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:46:36] <nmatsakis> i.e., Pair<&[int]>
[19:46:46] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[19:46:46] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/eAgTqQ
[19:46:46] <ghrust> 13rust/06auto 1402ef197 15Corey Richardson: Check crate root for docs in missing_doc lint....
[19:46:46] <ghrust> 13rust/06auto 145b9080c 15bors: auto merge of #10665 : cmr/rust/doc_lint, r=alexcrichton...
[19:46:46] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[19:46:52] <Eridius> yeah, Pair<[int]> doesn't work today
[19:47:08] <nmatsakis> I should have written in the post,
[19:47:10] <nmatsakis> but I forgot to,
[19:47:18] <nmatsakis> that I was very concerned with somtehing like SST being impossible to explain,
[19:47:27] <nmatsakis> and yielding confusing errors -- though it's more-or-less like what we have now,
[19:47:31] <Eridius> it just seems unfortunate that using Foo<[T]> means the value provided to Foo as the [T] needs to have a known length at compile-time
[19:47:34] <nmatsakis> but what we have how IS confusing.
[19:47:50] <nmatsakis> yes, it is unfortunate.
[19:47:50] <Eridius> but, I dunno, thinking about it some more, maybe it's not terrible
[19:48:04] <Eridius> I mean, if Pair was {a: T, b: T} then I'd absolutely expect the length to have to be known
[19:48:09] <eddyb> random question: what should (..[int, 3]) translate to? (int, int, int)? can someone find an use for that?
[19:48:24] <Eridius> it only seems unnecessary because I know the Pair uses pointers internally
[19:49:41] <nmatsakis> eddyb: I don't know but I fear bad interactions if it is anything other than [int, ..3]. e.g., what happens if I have (T) <-- a one-tuple and T happens to be [int, ..3]. Though the same perhaps applies to T=(int, uint)
[19:50:08] <Eridius> given how complicated all these proposals end up being, I have to wonder if it's not simpler to just leave [T], etc. special-cased as they are today ;)
[19:50:08] <nmatsakis> Eridius: yes. I think the problem is that &[T] and RC<[T]> just really make it look like [T] is a type, and you expect it to compose...
[19:50:24] <nmatsakis> Eridius: ...well, the proposals all get a lot simpler if you don't support user-defined smart pointers.
[19:50:31] <Eridius> heh
[19:50:33] <nmatsakis> Eridius: (which we don't today)
[19:50:37] <nmatsakis> in that case, SST is basically what we have now,
[19:50:38] <Eridius> but we really want them
[19:50:47] <nmatsakis> and DST is strictly better (from my POV)
[19:51:21] <Eridius> inserting lengths into the middle of a struct's field list seems pretty nasty to me
[19:51:33] <eddyb> nmatsakis: ..((int, uint)) would be (int, uint). the only reason I mentioned [T, ..N] is because something can be done there but I don't know any uses for it
[19:51:43] <eddyb> it's just an oddity :P
[19:51:44] <nmatsakis> Eridius: it sets my spider sense a'tinling, that's for sure
[19:52:07] <Eridius> I wonder if there's any value to adding a `sized` qualifier in DST, so I can define `struct Foo<sized T>`, which says that T must not be DST, thus preserving the exact layout of my struct?
[19:52:14] <Eridius> but I don't know if there's any actual practical utility to that
[19:52:15] <nmatsakis> Eridius: that'd be the default
[19:52:24] <nmatsakis> you hvae to "opt in" by writing "struct Foo<unsized T>"
[19:52:24] <Eridius> oh you have to explicitly allow parameters to be unsized?
[19:52:32] <nmatsakis> at least as we've currently discussed it, yes.
[19:52:39] <Eridius> hrm, so the idea is that would largely just be used in custom smart-pointers and not really anywhere else?
[19:52:42] <Eridius> I guess I missed that bit
[19:52:49] <eddyb> my suggestions are <T: Unsized> and <T: !Sized>
[19:53:03] <Eridius> it still feels wonky to me, but a bit less so if you have to explicitly opt in to it
[19:53:05] <nmatsakis> however you do the syntax, same principle.
[19:53:35] <eddyb> the latter would require more changes but could allow for multiple implementations of the same generic, with opposing bounds
[19:54:15] <eddyb> Rc<T: Freeze>::new and Rc<T: !Freeze + Send>::new (the current from_send) could coexist </rant>
[19:54:41] <Eridius> people keep talking about !Bounds. Is anyone actually going to implement it? ;)
[19:57:25] *** Joins: tikue_ (tkuehn@D4F78F0D.F3E8A984.689607DE.IP)
[19:58:01] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Quit: leaving)
[19:58:17] <nmatsakis> please not right now. there's enough work to do on trait and method dispatch without adding a new feature.
[19:58:21] <nmatsakis> :)
[19:58:50] <Eridius> heh
[19:59:56] * nmatsakis feels guilty for not writing up his plans there for so long
[20:00:01] <nmatsakis> damn vectors.
[20:00:07] <nmatsakis> taking up my rust quota.
[20:00:09] <Eridius> heh
[20:00:25] <Eridius> I still feel that vectors are used so often that the current syntax is too useful to give up
[20:00:36] <nmatsakis> I worry about this.
[20:00:51] <nmatsakis> Slice<T> seems... wordy.
[20:00:54] <benh> I always feel tempted to suggest that we come up with smartptr/custom-allocator based proc() variants that don't allocate in ~
[20:01:13] <nmatsakis> benh: that is basically what GC<Trait> is
[20:01:49] <nmatsakis> benh: eventually we should be able to make proc a kind of sugar for a trait, or at least deprecate it in favor of some trait-based sol'n
[20:03:56] <eddyb> that reminds me, you know how Java did "closures" before they were in the language?
[20:04:15] <strcat> I think C++ closures are a better comparison point for rust
[20:04:25] <strcat> struct with operator() overloaded
[20:04:25] <eddyb> an anon inline interface implementation
[20:04:39] <eddyb> strcat: yeah, something like that
[20:05:01] <strcat> and C++ lambdas are basically just sugar for writing a type definition with an operator(), and making an instance of it
[20:05:04] <strcat> each one has a unique type
[20:05:07] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[20:05:10] <strcat> static dispatch
[20:07:53] <nmatsakis> that is basically what we are talking about, yes.
[20:10:08] <eddyb> updated my PR and my gist: https://gist.github.com/eddyb/fa60028cea6787437d8f
[20:11:04] <eddyb> I'll try to sort the enum thing tomorrow. tuple structs just don't work (like functions)
[20:11:09] <eddyb> good night
[20:13:26] *** Quits: eddyb (eddy@moz-68E0B7D0.residential.rdsnet.ro) (Ping timeout)
[20:17:29] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:21:35] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[20:21:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/hP2HpA
[20:21:35] <ghrust> 13rust/06auto 14e41c331 15Seo Sanghyeon: Fix type inference for proc expressions
[20:21:35] <ghrust> 13rust/06auto 14fc4540d 15bors: auto merge of #10728 : sanxiyn/rust/proc, r=cmr...
[20:21:36] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[20:24:59] *** Quits: tikue_ (tkuehn@D4F78F0D.F3E8A984.689607DE.IP) (Quit: tikue_)
[20:31:01] *** Joins: canhtak (canhtak@moz-EF153D0F.wl.t.ulaval.ca)
[20:36:23] *** Joins: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net)
[20:41:36] *** Joins: tikue_ (tkuehn@4B0537EF.48F908A.689607DE.IP)
[20:41:59] <cmr> jensnockert: strcat: bjz: dbaupp: acrichto: any objections to https://github.com/mozilla/rust/issues/10774 ?
[20:42:44] * acrichto closes 5702 now that segmented stacks are gone
[20:42:53] <acrichto> otherwise I'm always a fan of dropping dependencies
[20:44:22] <acrichto> cmr: you may want to make sure openlibm builds on arm as well as x86 chips
[20:44:24] <cmr> It's still a problem that llvm is emitting calls to libm
[20:44:40] <acrichto> only for math intrinsics though I think
[20:44:46] <acrichto> which are all defined in libstd anyway
[20:44:47] <cmr> acrichto: it has arm support, though I don't know if it is highly optimized
[20:44:58] *** Joins: sygf87w54 (esucg0aq47@29EF4EB3.6FEE3AC4.D623D704.IP)
[20:45:03] <acrichto> cmr: good enough for me!
[20:45:06] *** Quits: sygf87w54 (esucg0aq47@29EF4EB3.6FEE3AC4.D623D704.IP) (User has been banned from Mozilla (no spamming here))
[20:47:21] <cmr> acrichto: should it be a submodule in src/ or should I add it to rustrt?
[20:47:28] <cmr> I feel like it should be a submodule.
[20:47:37] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[20:47:40] <cmr> I'd eventually like to split out all but the most basic numerics into its own crate
[20:47:40] <acrichto> we're getting to the point where we really need a third-party directory
[20:47:49] <cmr> I'm very uncomfortable with a large libstd
[20:48:00] <acrichto> makes sense
[20:48:05] <acrichto> libstd doesn't really need numerics anyway
[20:48:20] <acrichto> a high quality numerics crate seems  like a good thing though
[20:48:41] <cmr> I have an email cooking about the package ecosystem and what direction we want to take.
[20:48:46] <cmr> I'll finish that up now.
[20:49:36] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[20:51:33] <strcat> cmr: I don't think we should embed any more libraries
[20:52:17] *** Quits: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com) (Ping timeout)
[20:52:36] <strcat> we should use the platform libc/libm by default and support alternatives, imo
[20:52:44] <strcat> I've come to that conclusion about the allocator too
[20:52:45] *** Joins: isaacd (me@moz-6902374D.dhcp.oxfr.ma.charter.com)
[20:56:05] *** Quits: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se) (Input/output error)
[20:56:33] *** Joins: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se)
[20:58:20] *** Quits: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se) (Ping timeout)
[21:01:33] *** Quits: vky (chatzilla@moz-4F2E17BF.dsl.dynamic.sonic.net) (Ping timeout)
[21:03:06] *** Joins: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se)
[21:03:12] <cmr> strcat: Why?
[21:03:29] <cmr> I don't have any strong opinions about it, just curious
[21:05:00] *** Quits: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se) (Ping timeout)
[21:08:22] *** Quits: Kxepal (Miranda@moz-BFDF5C72.pppoe.mtu-net.ru) (Quit: Kxepal)
[21:08:41] <strcat> cmr: because rust should be portable anywhere with a libc implementation and an LLVM target
[21:08:48] *** Joins: Kxepal (Miranda@moz-BFDF5C72.pppoe.mtu-net.ru)
[21:09:00] <strcat> and you should be able to use any conforming libc you want
[21:13:41] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[21:15:18] *** kimundi is now known as zz_kimundi
[21:17:13] *** Joins: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se)
[21:17:31] <jensnockert> cmr: Sounds amazing.
[21:17:40] <cmr> jensnockert: why?
[21:17:58] <jensnockert> Because it means we're less platform dependent.
[21:18:19] <jensnockert> Especially on Windows, where the library is shit.
[21:18:34] <cmr> I'm thinking it doesn't belong in libstd
[21:18:50] <jensnockert> libcore ?
[21:18:53] <jensnockert> ;)
[21:18:57] <cmr> libnum :P
[21:19:34] *** Quits: dbaupp (Thunderbir@moz-3BE4086E.lns20.syd6.internode.on.net) (Ping timeout)
[21:19:42] <jensnockert> Or something like that.
[21:24:41] *** Quits: tikue_ (tkuehn@4B0537EF.48F908A.689607DE.IP) (Quit: tikue_)
[21:27:08] <Eridius> nmatsakis: for the DST issue necessitating storing RC as a negative offset, what if instead the compiler simply allowed a DST as the type of the final field in a struct? Then `struct RCData<T> { priv ref_count: uint; priv t: T }` would work even with T = [T]
[21:31:44] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:31:44] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/hP2HpA
[21:31:44] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:36:40] *** Quits: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP) (Connection reset by peer)
[21:36:45] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:36:45] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/dbS03g
[21:36:45] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:36:46] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[21:36:46] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/bjbqoQ
[21:36:46] <ghrust> 13rust/06auto 14f9d6fd2 15Alex Crichton: Support OSX frameworks...
[21:36:46] <ghrust> 13rust/06auto 14d4c40b5 15Alex Crichton: Bring the linkage documentation up-to-date...
[21:36:46] <ghrust> 13rust/06auto 14c8b60a2 15bors: auto merge of #10742 : alexcrichton/rust/frameworks, r=cmr...
[21:36:48] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[21:37:00] <cmr> Something landed!
[21:37:27] *** Joins: blank_name (blank_name@FAB53C88.7071B2C8.31EC03F3.IP)
[21:41:45] *** Joins: tikue_ (tkuehn@622204DD.28259105.689607DE.IP)
[21:46:08] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[21:46:34] <Eridius> ooh, framework support. yay
[21:48:15] <jensnockert> \o/
[21:48:58] <cmr> Also documentation!
[21:49:07] * cmr is more excited about the delicious documentation
[21:50:05] <nmatsakis> Eridius: sounds reasonable, but it doesn't really work. Where would the length go, for example? the basic point of those changes was to move the length into the RC struct, vs the RCData struct
[21:50:43] *** Joins: kmc (keegan@moz-2C6EE959.compute-1.amazonaws.com)
[21:53:00] <pnkfelix> nmatsakis: my current take on things is that any proposal that includes the constraint "DSTs only appear [immediately] behind one of their built-in pointer-types" is a non-starter.  e.g. that constraint rules out RC.  Does that sound accurate?
[21:53:12] <Eridius> nmatsakis: before the value
[21:53:24] <Eridius> I thought SST was to move it into RC, and DST would put it in RCData?
[21:54:25] <Eridius> so the idea is the compiler would turn [T] into (len, [T, ..len]) rather than ([T, ..len], len). And because nothing else comes after the field, the fact that the length isn't known at compile-time is fine
[21:55:02] *** Quits: tikue_ (tkuehn@622204DD.28259105.689607DE.IP) (Ping timeout)
[21:56:05] <acrichto> jld: macro question, $foo < 0 || $foo > 10 <- does that evaluate $foo twice?
[21:56:40] <strcat> acrichto: well if $foo is bar(a), it's just going to expand to bar(a) < 0 || bar(a) > 10
[21:56:59] <acrichto> that's my question, does it actually do that or is it smart enough to memoize the return value?
[21:57:14] <strcat> acrichto: it won't do anything smart
[21:57:17] <sfackler> I would think that it'd intentionally not memoize
[21:57:23] <Eridius> implicit memoization wouldn't be smart. It would be surprising
[21:57:24] <kmc> auto-memoizing would give surprising semantics
[21:57:25] <sfackler> in case of side effects
[21:57:29] <pauls> acrichto: `$foo` just drops the syntax in place.
[21:57:35] <acrichto> cool
[21:57:39] <kmc> but you can do a 'let' binding and that binding is hygenic, right?
[21:57:40] <strcat> acrichto: it just glues tokens together
[21:57:41] <jld> What they said.
[21:57:51] <jld> Uh... are our macros hygienic yet?
[21:57:54] <pauls> acrichto: the traditional thing in macros is to use `let` to avoid multiple evaluation, when that's what you want.
[21:57:56] <strcat> kmc: a macro can't expand to more than one expr
[21:57:59] <pauls> jld: Partly!
[21:57:59] <strcat> but yes, you can do that
[21:58:00] <sfackler> jld: partially
[21:58:02] <sfackler> efb
[21:58:19] <kmc> sure but { let x = $foo; x < 0 || x > 10 } is an expression isn't it
[21:58:29] <kmc> you'd want a new scope anyway
[21:58:33] <strcat> https://github.com/thestinger/rust-core/blob/master/core/macros.rs#L13 works for crappy type checking too ;p
[21:59:00] <jld> Like, if you do `{ let v = $foo; $bar }` and the expansion of `$bar` contains `v`.
[21:59:18] *** Quits: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se) (Input/output error)
[21:59:19] <pauls> jld, as I understand it, only variables bound by `let` are treated hygienically...
[21:59:27] <pauls> ...but I don't know exactly what that means.
[21:59:35] <pauls> A paper will be forthcoming.
[21:59:37] <strcat> if it's in a scope it doesn't really matter anyway
[21:59:38] <jld> Oh.  Wow.  That's... odd.
[21:59:47] *** Joins: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se)
[22:00:06] <jld> I mean, there's let, there's match, and there are functions, and I'm probably forgetting something.
[22:00:10] <pauls> It's a stopgap, I think. I think it turned out to be tricky to do all kinds of variables.
[22:00:21] <pauls> The intention is still to have total hygiene.
[22:00:23] <cmr> pauls: Wait, someone is writing a paper on Rust's macro system?
[22:01:06] <pauls> cmr: John Clements is.
[22:01:35] *** Quits: jensnockert (jensnocker@moz-C6DA4C3D.wireless.lu.se) (Ping timeout)
[22:01:49] <cmr> Cool!
[22:02:07] <jld> I remember he was working on it, but I lost track of what actually happened with it.
[22:02:11] *** Joins: tikue_ (tkuehn@622204DD.28259105.689607DE.IP)
[22:04:07] <sfackler> pauls: do you have any opinions on how macros expanding to multiple statements should work? ideally any macro that can expand to items should be able to expand to statements, but the parser seems to require that items come before statements in a block
[22:05:58] <benh> really?
[22:08:32] <pauls> sfackler: I think that, ideally, anything should work.
[22:08:38] <pauls> But sometimes there are obstacles. 
[22:09:06] <pauls> For example, expression-vs-item in macros at the beginnings of lines is pretty tricky.
[22:09:16] <pauls> So something might come up.
[22:10:36] *** Joins: twb (textual@moz-C0B32516.lawn.gatech.edu)
[22:15:37] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[22:20:18] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[22:21:49] <nmatsakis> pnkfelix: I sketched out a scheme where RC could work with DST,
[22:22:03] <nmatsakis> pnkfelix: but it requires contorting the code to meet the constraint --
[22:22:08] <nmatsakis> pnkfelix: basically using negative indices
[22:22:32] <strcat> nmatsakis: that's perilously close to undefined behaviour in LLVM
[22:22:50] <strcat> hm
[22:22:51] <nmatsakis> strcat: negative indices are undefined?
[22:22:58] <cmr> Well
[22:23:02] <cmr> If you alloc the thing
[22:23:06] <nmatsakis> that surprises me, given that they are very prevalent in real code.
[22:23:11] <strcat> indexing outside of the bounds of an object, other than the special case of one-byte-past-the-end, is undefined
[22:23:18] <cmr> And just store the thing as a pointer to just past the start of the object.
[22:23:19] <nmatsakis> outside the bounds of an object is something else
[22:23:30] <strcat> nmatsakis: outside of the bounds specified by the current type of the pointer
[22:23:33] <strcat> you can ofc cast the ptr
[22:23:35] <cmr> What is the one-byte-past-the-end special case for anyway?
[22:23:45] <strcat> but I don't think you'd ever be able to index *before* the pointer as defined behaviour
[22:23:47] <nmatsakis> strcat: so, by "negative indexing", what I mean is pointer arithmetic 
[22:23:58] <strcat> nmatsakis: pointer arithmetic is often undefined, though
[22:24:03] <nmatsakis> strcat: e.g., cast to *char, substract 32, cast to RcHeader
[22:24:09] <Eridius> cmr: one-past-the-end exists so you can have an "end" pointer that you compare against
[22:24:15] <strcat> nmatsakis: in C, it's only well defined to do pointer arithmetic within the bounds of an object
[22:24:19] <cmr> Ah, yes, makes sense.
[22:24:21] <strcat> and LLVM inherits that for inbounds GEP
[22:24:24] <strcat> which is all we have exposed
[22:24:43] <nmatsakis> strcat: p-- where p is *char is certainly not undefined
[22:24:52] <nmatsakis> strcat: well let me rephrase; I'd be quite surprised.
[22:24:59] <nmatsakis> strcat: how are you defining "object" here?
[22:25:28] <nmatsakis> I shouldn't disagree, I could believe it, sometimes surprising things are undefined,
[22:25:44] <Luqman> acrichto: running into this now https://gist.github.com/luqmana/3eb91d9181cacf11cfbe
[22:25:45] <nmatsakis> but it's not that uncommon to (e.g.) make a pointer to the end of the string ,
[22:25:48] <nmatsakis> and walk backwards
[22:25:58] <strcat> nmatsakis: yeah, that's defined
[22:26:33] <Luqman> also, why are the cc args not just printed as one string now? makes it much more annoying if you want to copy + run cc yourself to test
[22:26:45] <Eridius> nmatsakis: here's another thought on DST. What if we allowed a DST not just if it's behind a pointer, but if it's part of a larger type that's behind a pointer? which is basically the same thing as saying you can embed it directly in another type, but that enclosing type is now effectively a DST as well
[22:26:53] <acrichto> Luqman: if you have --link-args '-lm', does it compile ok?
[22:27:05] <acrichto> Luqman: otherwise it looks like another consequence of #10743 (which sounds like it really needs to get fixed)
[22:27:22] <Eridius> (and for simplicity this should require the embedded DST to be at the end of the enclosing type, because you don't want to do pointer arithmetic for regular field access)
[22:27:30] <nmatsakis> Eridius: I don't really understand whta you mean.
[22:27:33] <Luqman> acrichto: yep that works
[22:27:35] <pnkfelix> Eridius: I think that proposal is part of some of the scemes that nmatsakis has described.
[22:27:37] <Eridius> this would allow RCData to again be {priv ref_count: uint, val: T } and have the length end up in the RC
[22:27:38] <pnkfelix> schemes
[22:27:49] <acrichto> Luqman: ok I'm just going to fix that
[22:28:28] <nmatsakis> strcat: ok, so negative arithmetic on a *u8 and casting to/from are both well-defined, afaik (that is, casting *T to *u8 doesn't violate C aliasing rules) -- but in any case, you said "perilously close", and with that I agree)
[22:28:41] <strcat> array indexing can be out-of-bounds, object indexing can't be
[22:28:50] <pnkfelix> Eridius: i.e. the RCData proposal in http://www.smallcultfollowing.com/babysteps/blog/2013/12/02/thoughts-on-dst-4/ is exactly what you just said, no ?
[22:29:01] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:29:13] <Eridius> pnkfelix: the RCData impl at the start of that part 4 is without DST
[22:29:29] <Eridius> pnkfelix: part of the whole point of that section is that RCData is incompatible with DST
[22:29:30] <strcat> nmatsakis: http://llvm.org/docs/GetElementPtr.html#what-happens-if-an-array-index-is-out-of-bounds
[22:29:39] <Eridius> and it goes on to rewrite RC using the negative offset thing
[22:30:06] <strcat> afaik this means if you allocate an object with 3 fields, and take a ptr to the 2nd field to pass around as another type, you can't then use that ptr to get at the first field later
[22:30:09] <Eridius> so I'm saying, allow that RCData definition to be valid, and just "inherit" the DST nature of [T] into the enclosing RCData<[T]>, such that an RCData<[T]> cannot occur except behind a pointer
[22:30:12] <pnkfelix> Eridius: ah, reading fail on my part, I had thought an earlier post had also mentioned it
[22:30:37] <strcat> nmatsakis: meh maybe not
[22:30:39] <strcat> *shrug* ;p
[22:30:47] <nmatsakis> strcat: that doesn't quite follow -- maybe if you use GEPi,
[22:30:53] <strcat> yeah I mean GEPi
[22:30:55] <nmatsakis> strcat: but in any case this arithmetic would be at Rust level,
[22:30:59] <Eridius> this would make RC<[T]> be represented as (*data, length) where the length is mapped to the [T] inside the RCData<[T]>
[22:31:03] <nmatsakis> strcat: and so would just be subtracting from an integer.
[22:31:22] <strcat> nmatsakis: well if you didn't use ptr::offset it would probably be well defined
[22:31:30] <strcat> but in that case you're going to get really bad optimization
[22:31:38] <Luqman> acrichto: yea, it looks like at the very least we want libm and libdl
[22:31:44] <Eridius> so basically, the RCData<exists N. [T, ..N]> would be transformed into `exists N. RCData<[T, ..N]>`
[22:32:04] <nmatsakis> Eridius: I don't think this scheme sounds very consistent :)
[22:32:11] <Eridius> why not?
[22:32:14] <pnkfelix> Eridius: okay, you're right, I had misinterpreted the post.  I had thought the conclusion was going to be that RCData<T> itself was also Unsized
[22:32:23] <pnkfelix> Eridius: I'm going to go read it more carefully now
[22:32:42] *** Joins: ktt3ja (Mibbit@moz-D69B60E4.hsd1.va.comcast.net)
[22:33:05] <strcat> nmatsakis: I think I was wrong, anyway, what matters is that you don't go out of bounds of the original object as it was allocated
[22:33:15] <nmatsakis> strcat: agreed
[22:34:15] <nmatsakis> Eridius: I think it's hard to specify what the substitution rules are in cases like this
[22:34:32] <nmatsakis> Eridius: I shouldn't say it's not consistent, just that it's handwavy and it's not obvious to me how the details work out
[22:34:38] <Eridius> nmatsakis: the basic idea is that the `exists N` gets hoisted out of the type parameter
[22:34:41] *** Quits: tikue_ (tkuehn@622204DD.28259105.689607DE.IP) (Ping timeout)
[22:34:51] <Eridius> it stays behind the pointer, but it now applies to the entire type, not just the type parameter
[22:34:52] <nmatsakis> yes I understand, i'm just saying that
[22:34:55] *** Joins: tikue_ (tkuehn@622204DD.28259105.689607DE.IP)
[22:34:58] <nmatsakis> when you ae working with generic functions
[22:35:03] <nmatsakis> that manipulate a RcData<T> etc
[22:35:05] <strcat> so what matters is the original LLVM type, if it was { i64, i64* } you can index from one to the other, but never into another object (out of bounds)
[22:35:07] <nmatsakis> they won't know if it's unsized or not etc
[22:35:11] <nmatsakis> it's not clear to me that it all works out
[22:35:26] <strcat> I guess the actual pointer types are fairly irrelevant without TBAA nodes
[22:36:24] <Eridius> nmatsakis: if the RCData can only be accessed via a pointer, do functions that manipulate it need to care if it's unsized? They need to know the length if they're accessing data in the T directly, but that's true without this proposal too
[22:37:17] <strcat> how does Rc know how much memory to allocate?
[22:37:36] <strcat> it wants to allocate sizeof::<RcBox>() where RcBox is { T, count }
[22:38:06] <strcat> well, lets say { count, T }
[22:38:16] <strcat> to avoid making life unnecessarily hard
[22:38:26] <pnkfelix> nmatsakis: I have to admit, I feel more confused than ever right now
[22:38:38] <strcat> (the whole point of { T, count } is avoiding a level of ptr arithmetic though)
[22:38:43] <Eridius> in the DST-compatible RC1 code, how does sizeof::<T>() know the count of T?
[22:39:01] <Eridius> is new() monomorphized separately for every value of [T, ..N]?
[22:39:16] <nmatsakis> pnkfelix: in what regard?
[22:39:17] <strcat> [T, ..n] isn't dynamically sized
[22:39:41] <nmatsakis> Eridius: yes, it would be monomorphized separately.
[22:39:41] <pnkfelix> nmatsakis: I will have to reflect further on these posts.  My intuition here is that Eridius's proposal, I think, matches the one in my own head.
[22:39:45] <Eridius> strcat: implementing a separate copy of new() for every possible used size of [T, ..N] sucks
[22:39:55] <pnkfelix> nmatsakis: but I have not yet tried making concrete examples to match the ones in your post
[22:40:03] <Eridius> but if we're already accepting that, then allocating RCData<T> should work
[22:40:06] <strcat> Eridius: fixed-size arrays are dynamically sized, I'm not sure what you mean
[22:40:10] <strcat> aren't* grr
[22:40:23] <strcat> atm every type has a known, static size
[22:40:53] <Eridius> strcat: what part of this is confusing you? If sizeof::<T> works with [T] under DST, which it must, then allocating RCData<T> should be doable as well
[22:41:11] <nmatsakis> pnkfelix: well there are many possible interpretations. Eridius's scheme where "[T]" bubbles out of the struct isn't one that I outlined. It might be nice, if it can be made to work out.
[22:41:24] <strcat> Eridius: it won't work with DST, though
[22:41:32] <strcat> that's why there was the `unsized` thing
[22:41:36] <Eridius> nmatsakis: the reason I like this proposal is it means the compiler does all the heavy lifting of creating the same implementation as your RC1, but without negative pointer arithmetic
[22:41:44] <strcat> and that's why a Sized kind was added
[22:42:08] <nmatsakis> Eridius: here is the challenge. I have:
[22:42:10] <pnkfelix> nmatsakis: it probably ends up being something where it bubbles out horribly to things like `unsized struct<T> { ‚Ä¶ }` in the code I was hacking up.
[22:42:10] <strcat> unsized was a way to make Sized the default
[22:42:16] <Eridius> nmatsakis: where the end result is the length is still stored in the RC instead of the RCData, and the RCData's layout is {refcount, data}
[22:42:19] <nmatsakis> struct RC1<T> { data: *RCData<T> }
[22:42:25] <nmatsakis> er
[22:42:27] <nmatsakis> struct RC<T> { data: *RCData<T> }
[22:42:34] <nmatsakis> struct RCData<T> { ..., t: T }
[22:42:36] <pnkfelix> nmatsakis: so that you end up having to say everything explicitly, and there's much potential for code duplication if you're not careful...
[22:43:11] <nmatsakis> now, if you have "RC<exists N. [U, ..N]>", then T = "exists N. [U, ..N]"
[22:44:02] <nmatsakis> if you then substitute the types in, you wind up with "*RCData<exists N. [U, ..N]>"
[22:44:33] <nmatsakis> and you're saying that this type (RCData<[U]>) is dyn sized,
[22:44:38] <nmatsakis> so that's a *T to a DST type,
[22:44:52] <Eridius> nmatsakis: so somehow that needs to be transformed into `*exists N. RCData<[U, ..N]>`
[22:45:13] <Eridius> either the compiler could "magically" realize that it needs to do this because the T in RCData<T> was used without a pointer, or maybe we just need to say `unsized struct RCData<T>`
[22:45:15] <nmatsakis> no
[22:45:21] <Eridius> no?
[22:45:23] <nmatsakis> that part can't work I think
[22:45:25] <nmatsakis> that transform
[22:45:29] <Eridius> why not?
[22:45:38] <nmatsakis> because that's not how type subst works
[22:45:45] <nmatsakis> but I don't see why you need that
[22:46:01] <nmatsakis> in other words, we say that a pointer to a DST is a pair including length,
[22:46:08] <nmatsakis> and RCData<[U]> is a DST,
[22:46:14] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[22:46:14] *** ChanServ sets mode: +ao dherman dherman
[22:46:17] <nmatsakis> it's possible you could derive a consistent scheme,
[22:46:35] <Eridius> the only reason I'm suggesting hoisting `exists N.` outside RCData is because I thought the definition for DST required it to be an existential type
[22:46:37] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[22:46:37] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/bjbqoQ
[22:46:37] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[22:46:42] <strcat> nmatsakis: so is *DST a fat pointer too?
[22:47:13] <nmatsakis> well, in the simpler scheme I was thinking about, "DST" could only be [U] or Trait
[22:47:17] <pnkfelix> nmatsakis: By `length` attached to the fat *RCData<[U]>, ‚Ä¶ it could mean the length of the whole RCData<[U]>, in bytes or words.  Or it could mean the length of the [U].
[22:47:29] <Eridius> my thought is the length would be the length of the [U]
[22:47:41] <Eridius> because the rest of the RCData is a fixed-size header
[22:47:43] <nmatsakis> pnkfelix: yeah that's one of the complications, extending set of DST would require us to get that striaght,
[22:47:49] <nmatsakis> consider Foo<[U], Trait, [V]>
[22:47:53] <nmatsakis> that'd be a fat pointer indeed
[22:47:55] <Eridius> the idea here is to basically allow me to define a DST with a fixed-size header
[22:47:59] <nmatsakis> well I guess there can be at most one
[22:48:03] <nmatsakis> since it must be the lsat type
[22:48:58] <nmatsakis> Eridius: ok, it might be a case where doing more (i.e., encompassing the C struct with an unsized last field use case) might let us handle more cases
[22:49:10] *** Quits: tikue_ (tkuehn@622204DD.28259105.689607DE.IP) (Quit: tikue_)
[22:49:12] <Eridius> simplistically, what i want is *(refcount, data). But if it works for tuples it may as well work for all structs
[22:49:46] *** Joins: dbaupp (Thunderbir@A192CB9D.D5A1DCF.37681C44.IP)
[22:49:58] <nmatsakis> ok I will think it over some, gotta go, dinner time
[22:50:05] <Eridius> ok
[22:51:35] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[22:51:35] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/lv9YQA
[22:51:35] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[22:51:43] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[22:51:43] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/lkxYEA
[22:51:43] <ghrust> 13rust/06auto 14870fb7d 15Philipp Br√ºschweiler: c_vec: Modernize...
[22:51:43] <ghrust> 13rust/06auto 14c77ab91 15bors: auto merge of #10736 : Blei/rust/fix_c_vec, r=alexcrichton...
[22:51:43] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[22:51:53] * cmr is happy that bors is healthy again
[22:53:52] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[22:57:47] <acrichto> Luqman: https://github.com/mozilla/rust/pull/10777
[23:00:38] *** flaper87 is now known as flaper87|afk
[23:07:10] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[23:08:01] <dbaupp> cmr: "which has a long history" the git repo for openlibm only goes back 2 years?
[23:09:06] <cmr> dbaupp: the code imported in the initial commit is over 20 years old.
[23:09:42] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[23:10:03] <dbaupp> cmr: good enough for me
[23:11:02] <ktt3ja> what's this error about? http://pastebin.com/AaJpWtM1
[23:11:12] <ktt3ja> I got it when I ran `make check -j4`
[23:16:53] <acrichto> ktt3ja: hm that should not be happening, you meay need to make clean and remake
[23:17:55] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[23:19:20] <dbaupp> cmr: (for the record though, I agree with strcat that we shouldn't mandate a libc; using openlibm as the default on platforms with libm's with known bugs/holes seems reasonable though.)
[23:19:36] <strcat> but which platforms are those?
[23:19:40] <cmr> mingw
[23:19:46] <cmr> though if we switch to mingw-w64 it doesn't mater
[23:19:52] <strcat> we shouldn't support mingw
[23:19:59] <strcat> it's 32-bit only and broken
[23:20:05] <cmr> mostly I want it for perf, but I agree it doesn't really belong in std.
[23:20:13] <strcat> mingw-w64 supports 32-bit, 64-bit, has devs who actually care and isn't totally broken
[23:20:55] <dbaupp> strcat: my use of "platforms" was hypothetical (i.e. if there was such a platform, but there may not be one.)
[23:22:39] <kmc> is there any awesome tool for diffing LLVM bitcode or assembly files?
[23:22:53] <strcat> vimdiff is good enough for me
[23:22:54] *** zz_kimundi is now known as kimundi
[23:23:02] <strcat> it handles inner-line differences and so on
[23:23:23] <Luqman> vimdiff works, but it gets a bit unwiedly with large files
[23:23:46] <kmc> i want something which ignores alpha-renaming of variables and such
[23:23:52] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[23:24:08] <kmc> want to see the behavioral difference in rustc output when i make a change in my rust code
[23:26:30] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:29:16] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[23:29:16] *** ChanServ sets mode: +ao dherman dherman
[23:30:23] *** Joins: tikue_ (tkuehn@622204DD.28259105.689607DE.IP)
[23:30:39] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[23:36:39] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[23:36:39] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14c77ab91 to 14c8b60a2: 02http://git.io/N3iJvQ
[23:36:39] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[23:36:48] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[23:36:48] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/PAvMIg
[23:36:48] <ghrust> 13rust/06auto 14055ddbe 15Alex Crichton: Register new snapshots
[23:36:48] <ghrust> 13rust/06auto 141bf00b2 15Alex Crichton: Link rustllvm statically to librustc...
[23:36:49] <ghrust> 13rust/06auto 14f520ca0 15Alex Crichton: Distribute a unified binary for snapshots...
[23:36:51] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[23:40:28] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[23:40:58] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Max SendQ exceeded)
[23:43:12] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[23:43:45] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Max SendQ exceeded)
[23:48:34] *** kimundi is now known as zz_kimundi
[23:51:35] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[23:51:35] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/EiKFVA
[23:51:35] <ghrust> 13rust/06auto 14055ddbe 15Alex Crichton: Register new snapshots
[23:51:35] <ghrust> 13rust/06auto 141bf00b2 15Alex Crichton: Link rustllvm statically to librustc...
[23:51:36] <ghrust> 13rust/06auto 144ec2cbc 15Alex Crichton: Distribute a unified binary for snapshots...
[23:51:38] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
