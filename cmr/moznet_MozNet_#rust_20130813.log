[00:00:11] *** Joins: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net)
[00:00:14] <graydon> the only relevant issue to us is whether we use ISAAC, some other internal CSPRNG, or /dev/urandom (essentially "Ask the OS for its CSPRNG")
[00:00:22] <graydon> I am happy to use /dev/urandom when it's fast enough relative to ISAAC
[00:00:52] <toddaaro> graydon: urandom is a *big* time hog
[00:01:03] <graydon> but not if it means people start looking at normal perf and saying "oh hells, let's use xorshift here!"
[00:01:05] <toddaaro> ~ms scale
[00:01:49] <graydon> people have reasonably expressed concern about us using ISAAC, and about our reseed frequency (which is, I think, either "never", "poorly defined" or "random")
[00:01:50] <toddaaro> as someone who recently went "oh hells, let's use xorshift here!", ping pong bench with a urandom call each receive was ~3000x slower than using xorshift
[00:01:53] *** Quits: vosen (vosen@moz-266BA656.icpnet.pl) (Connection reset by peer)
[00:02:01] <pcwalton> I think this is irrelevant
[00:02:04] <graydon> toddaaro: urandom or ISAAC?
[00:02:07] <pcwalton> the problem there was the fact that it's cryptographically secure
[00:02:14] <toddaaro> graydon: urandom
[00:02:19] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[00:02:43] <graydon> I would be ok with xorshift if we named it (say) InsecureRandomIAmSureIWantNoSecurityHereAtAll
[00:02:47] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[00:02:51] <brson> graydon: what concern do people have about isaac?
[00:02:56] <cmr> We have std::rand::weak_rng now
[00:03:06] <cmr> that should be used, rather than explicitly getting a XorShiftRng
[00:03:08] <toddaaro> brson: what are the invariants on calling idle_watcher::stop()?
[00:03:20] <pcwalton> thomas ptacek, adam langley, and coda hale are all saying "just use /dev/urandom"
[00:03:24] <toddaaro> brson: I'm calling stop on an active idle watcher and boom segfault every time
[00:04:33] *** Joins: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu)
[00:04:37] <strcat> pcwalton: linux's urandom is really slow :(
[00:04:43] <graydon> brson: as a prize for me naming libottery, nick mathewson did a look over it and suggested that mainstream cryptographers have given up caring about it since there are "a few published results against it" (such as mentioned on the wikipedia page)
[00:05:19] <pcwalton> Go uses AES-128
[00:05:37] <bblum> libottery.
[00:06:03] <graydon> pcwalton: what are you actually suggesting here? (1) that we open and read 8 bytes from /dev/urandom every time we clone a hashtable? or (2) we keep a local pool using a CSPRNG that we reseed from /dev/urandom regularly? or (3) that we keep a local pool that we reseed from /dev/random? or (4) something else?
[00:06:10] <strcat> pcwalton: openssl's AES-128 is ~20x faster than using /dev/urandom
[00:06:15] *** Quits: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu) (Input/output error)
[00:06:22] <bblum> graydon: we could use the radioactive unicode symbol for xorshift
[00:06:33] <brson> toddaaro: calling stop() then start() again from within the same callback may end up freeing the currently-running closure's environment
[00:06:42] <pcwalton> graydon: probably (1) because I don't want the crypto community bashing down our door
[00:06:50] <pcwalton> but we could keep a filehandle to it open of course
[00:07:00] <toddaaro> brson: what, that sounds bad
[00:07:12] <brson> toddaaro: it does
[00:07:18] <toddaaro> brson: why would that happen?
[00:07:22] <graydon> pcwalton: ok. feel free to post a patch that does that with before/after benchmark numbers. I'm fine with it so long as it's not brutally slow.
[00:07:36] <pcwalton> these guys tend to write rants whenever you do something exactly the way they don't like and we don't have someone like Adam Langley
[00:07:42] <pcwalton> to provide cover fire :)
[00:07:42] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[00:07:58] <graydon> pcwalton: similarly cryptgenrandom() on windows
[00:08:53] <brson> toddaaro: the native idle callback contains a single pointer to the Rust idle closure. calling start() sets that closure to the requested IdleCallback value. if there was a value there previously it gets freed, so calling start() on an idle callback from within that idle callback frees the running closure
[00:09:01] <graydon> pcwalton: I concur, I was fine with that from the get-go I think. I just .. kinda get beat up from both ends of the spectrum, y'know? we use randomness a lot in rust so I often get people (including you) telling me to rip cryptographic security properties out of the stdlib because it's "too slow".
[00:09:16] <pcwalton> yeah, it's frustrating
[00:09:32] <pcwalton> in general the security community has been very positive about Go and neutral to slightly negative on Rust
[00:09:36] <graydon> I like /dev/urandom as much as the next kernel engineer though
[00:09:40] <brson> toddaaro: this could concievably be fixed by having an alternate start method that just reruns the already-set closure instead of installing a new one
[00:09:44] <toddaaro> brson: ok, so I just need to dive deeper and add restart that uses the one there?
[00:09:47] <pcwalton> for no particularly principled reason as far as I can tell
[00:09:51] <toddaaro> brson: ok, I'll do that
[00:09:54] <graydon> it's because we're unstable and overengineered
[00:09:56] <pcwalton> except that Adam Langley and some Chrome team members work on it
[00:10:02] <pcwalton> on Go
[00:10:09] <graydon> security is a property of system simplicity
[00:10:30] <pcwalton> I think Go is a more complex language than Rust
[00:10:31] <pcwalton> honestly
[00:10:34] <pcwalton> in terms of the semantics
[00:10:39] <brson> what is wrong with using isaac?
[00:10:42] <brson> i still don't understand
[00:10:52] *** Quits: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net) (Ping timeout)
[00:10:58] <pcwalton> graydon: how do you feel we're overengineered?
[00:11:19] <benh> So this libottery isn't suitable for the hashtable's needs either? ;)
[00:11:40] <graydon> brson: there's a published result showing a few weaknesses in it (see its wikipedia page) and it's not forward secure, a bit old. nothing I think of as fatal.
[00:12:24] <toddaaro> so what is wrong with having all three RNG options as "first class" RNGs?
[00:12:30] <toddaaro> is having three choices too hard for users?
[00:13:22] <kimundi> does anyone know why exactly colored output is disabled for the test runners? It seems to be because of multithread races that can mangle the color codes, but is that just a workaround, or is there a way to properly fix it?
[00:13:34] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[00:14:00] <graydon> pcwalton: I'm sorry, I ... god, I should really not be saying anything today. I'm putting my foot in my mouth every time I speak. I don't personally think we're _that_ over-engineered, but we've redesigned things enough times that we give the impression of quite a bit more than we actually are.
[00:14:10] <pcwalton> yeah, that's true
[00:15:47] <graydon> pcwalton: and we have more ways, and more-cognitively-loading ways, to do several things (macros, more powerful modules, generics, ownership and region types, embedding/FFI, more type inference, pattern matching, disjoint sums, explicit mutability control)
[00:16:38] <pcwalton> sure. but we're... memory safe. and they're not.
[00:16:47] <pcwalton> that's what boggles my mind a little bit about the security community's reaction
[00:16:51] <graydon> depending on definition, but yes.
[00:17:19] <graydon> I mean, I think Go preserves its own memory model. it's just a model that includes null and racing.
[00:17:27] <pcwalton> and segfaults if GOMAXPROCS>1
[00:17:35] <graydon> (I'm not certain you can't corrupt some of its internal types by racing on them)
[00:17:36] <pcwalton> http://research.swtch.com/gorace
[00:17:48] <pcwalton> you can corrupt the internal types in memory unsafe ways
[00:17:52] <pcwalton> if GOMAXPROCS>1
[00:18:23] <graydon> ah. yeah, I worried that would be true.
[00:18:59] <pcwalton> I guess I don't see how ability to express abstractions reduces security
[00:19:06] <pcwalton> by that argument Forth is the most secure language on the planet
[00:19:16] <pcwalton> brb, lunch
[00:19:20] <graydon> heh
[00:21:03] *** Quits: lmandel (lmandel@moz-57D3C086.dsl.bell.ca) (Ping timeout)
[00:21:43] <graydon> I don't know if it's anything more than the sort of statement folks make about favouring programs written in C over C++. "it's small so you don't do anything too clever / just focus on the problem at hand" etc.
[00:21:43] *** Quits: rustyPipe (Mibbit@moz-5949C51B.dllstx.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:21:52] *** Joins: rustyPipe (Mibbit@moz-5949C51B.dllstx.fios.verizon.net)
[00:22:14] *** Joins: lmandel (lmandel@moz-57D3C086.dsl.bell.ca)
[00:22:17] <graydon> (I often find myself biting my tongue trying not to ask for a detailed explanation of how gobject works in such conversations, but whatever)
[00:22:22] <cmr> heh
[00:22:26] <kmc> it's easy to write secure programs in C, you just need to never make any mistakes ever ;)
[00:22:37] <cmr> kmc: And never ever write undefined behavior
[00:22:41] <graydon> arguably the set of mistakes one might make is smaller there
[00:22:52] *** Quits: sigma (sigma@51C589B3.EF2694B5.DFAC6AA7.IP) (Ping timeout)
[00:22:58] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[00:23:09] <cmr> I absolutely love having memory safety guarantees, which is why I like rust
[00:23:15] <cmr> the other stuff is just nice-to-have
[00:23:17] <bblum> brson: do we have a mechanism for global state in the new runtime?
[00:23:18] <benh> (i still don't understand aliasing restrictions in C)
[00:23:36] <kmc> a lot of the security community has zero respect for PL-based security, they think that bugs come from "people being idiots" and the solution is to forbid anyone who ever makes a mistake from writing programs, or something
[00:23:41] <bblum> brson: i attempted to use static mut values, but the libstd/stdtest linkage issue appears to be duplicating them
[00:23:47] <graydon> whee 2h10 => 1h28 on linux-64-nopt
[00:23:55] <doomlord_> i like reverting to a c-like style because i find the method vs function thing in c++ frustrating
[00:24:02] <graydon> I think this is possibly the single largest perf win anyone's ever landed :)
[00:24:09] <kmc> woo congrats
[00:24:10] <cmr> \o/
[00:24:11] <graydon> ("win" = "un-regression")
[00:24:12] <cmr> I win!
[00:24:14] <toddaaro> graydon: what is the "real" time comparison, oldrt -> fixed rtdebug
[00:24:22] <graydon> toddaaro: checking
[00:24:27] *** Joins: ross (ross@moz-8A84103E.br.br.cox.net)
[00:24:27] <bblum> graydon: wow what did you change
[00:24:30] <cmr> graydon: probably the smallest perf win too
[00:24:32] <cmr> bblum: rtdebug! fix
[00:24:37] <cmr> https://github.com/mozilla/rust/pull/8419
[00:24:41] <toddaaro> is it going to beat iterators
[00:24:42] <bblum> oh haha that one
[00:24:45] <toddaaro> that would be hilarious
[00:25:02] <cmr> graydon: so I take it it didn't hang?
[00:25:30] <graydon> looks like 1h14 => 1h28. newrt is slower, but only a little.
[00:25:39] <cmr> with nopt?
[00:25:46] <toddaaro> weird, the compiler isn't even using runtime stuff
[00:25:49] <toddaaro> or is it?
[00:25:50] <cmr> that's not bad, the c++ was always optimized
[00:25:51] <graydon> testsuite time
[00:25:59] <toddaaro> ah
[00:26:51] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[00:27:04] <graydon> compile phase is 5 min faster, tests 25min slower
[00:27:13] <graydon> still stuff to work on though
[00:27:43] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[00:27:44] <graydon> mac nopt 3h => 2h
[00:27:58] <aatch> I'm guessing the big segments could probably account for some of the slow-down
[00:28:10] <graydon> possible. we'll go through and find it.
[00:28:59] *** Joins: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu)
[00:29:31] <cmr> graydon: I'm really worried that some of these benchmarks I'm writing will be optimized into a no-op by DCE, because the result is never used. Is there anyway to prevent this?
[00:30:07] *** Quits: ozten (ozten@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ozten)
[00:30:15] <graydon> cmr: I think fiddling with the benchmark harness to bounce a value off memory is probably quite reasonable. you'll have to experiment to figure out the exact mechanism.
[00:30:16] <brson> bblum: there isn't, no
[00:30:32] *** Quits: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP) (Quit: brendan)
[00:30:37] <cmr> graydon: alright, I'll poke at it later this week
[00:32:31] <cmr> I'm thinking also running the benches under nopt is probably reasonable, at least to measure how well we're doing.
[00:33:21] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[00:33:43] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Quit: kernel update)
[00:34:03] <toddaaro> brson: ecr pointed out the problem is likely that the refcount on the loop is hitting 0 when I call stop, so I'm going to pursue this
[00:34:06] <toddaaro> brson: sound plausible?
[00:34:51] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[00:35:00] <Seldaek> graydon: I don't want to restart it, but I am curious why there is a big discussion about PRNGs for hashes, is it so important to rehash with a cryptographically secure prng when cloning? 
[00:35:10] <dherman> toddaaro: ping
[00:35:15] <toddaaro> dherman: pong
[00:35:27] <dherman> toddaaro: do you twitters?
[00:35:49] <toddaaro> dherman: kind of, private account, so no public discussion or anything
[00:35:49] <graydon> Seldaek: s/cloning/any time we rehash values/
[00:35:56] <dherman> toddaaro: ok
[00:35:58] <cmr> Seldaek: it's to prevent hashmap collisions, afaik, there might be more to it
[00:36:02] <graydon> Seldaek: only because it narrows the window of vulnerability on a hashmap in general
[00:36:08] <dherman> augh it's late in the day
[00:36:13] <dherman> guess I should wait till tomorrow
[00:36:20] <dherman> was gonna do a couple @rustlang tweets
[00:36:45] <Seldaek> graydon: yes, not sure what kind of vulnerabilities though, but yeah I saw this mentioned a few times in other languages too, never really got to the bottom of it.
[00:37:09] <graydon> Seldaek: if you figure out a hashtable's hash function you can make it perform as O(n) not O(1)
[00:37:11] <graydon> DoS
[00:37:35] *** Quits: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com) (Ping timeout)
[00:38:41] <Seldaek> graydon: I see.. yay computing problems 
[00:38:51] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[00:40:32] <toddaaro> what is the status of check-stage0 PR?
[00:40:53] <toddaaro> I need to add another libuv function binding, but that will require deeper changes than NO_REBUILD I think
[00:41:02] <cmr> toddaaro: cycle time is 3 hours atm (although it seems it will drop to 2), it'll be a while
[00:41:37] <cmr> http://kentonv.github.io/capnproto/news/2013-08-12-capnproto-0.2-no-more-haskell.html
[00:41:42] <cmr> that is an interesting change
[00:42:14] *** Quits: lmandel (lmandel@moz-57D3C086.dsl.bell.ca) (Ping timeout)
[00:43:30] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[00:43:38] *** kimundi is now known as zz_kimundi
[00:43:50] *** Quits: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[00:44:34] *** Quits: dcolish (dcolish@1DB472A5.BE69FB10.416A0103.IP) (Ping timeout)
[00:44:54] <brson> toddaaro: it's not what I would expect, no, but I guess it could be. I don't think that idle_stop detaches it from the loop. there are test cases for calling stop() on IdleWatcher that work successfully
[00:47:46] *** Joins: dcolish (dcolish@1DB472A5.BE69FB10.416A0103.IP)
[00:47:49] *** Quits: Vert (quassel@moz-15870EF5.skybroadband.com) (Ping timeout)
[00:48:34] <jack> cmr: reason #1 makes a lot of sense. reason #2 is just more food for "haskell isn't useful" trolls.
[00:48:39] *** Joins: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net)
[00:49:08] *** Quits: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net) (Client exited)
[00:50:03] <sully> oh, hm
[00:50:09] <sully> is upcall_fail gone, now that we are on the new runtime?
[00:52:32] <jack> sully: i think so. brson suggested rust_begin_unwind, but that didn't seem to work for me as a break target in gdb.
[00:52:53] <sully> sigh, and rt::backtrace doesn't seem to work, at least now that we disable logging by default
[00:52:58] *** Quits: lahwran (lahwran@lahwran.net) (Ping timeout)
[00:52:59] <sully> grrrrrrrrrrrrum
[00:53:21] *** Joins: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com)
[00:53:25] *** Joins: lahwran (lahwran@lahwran.net)
[00:53:45] <cmr> r? https://github.com/mozilla/rust/pull/8480
[00:53:59] <sully> and I am getting an error "failed at 'borrowed'" in code nowhere near anything I have touched
[00:54:07] <sully> grrrrrrrrrrrrrrrrrrrrrum
[00:54:53] *** Quits: rustyPipe (Mibbit@moz-5949C51B.dllstx.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:55:02] <brson> rust_begin_unwind should work!
[00:55:41] <sully> ok, it looks like it did for me
[00:56:15] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[00:56:22] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[00:56:22] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/yOjX4A
[00:56:22] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[00:56:30] <cmr> jack: thanks
[00:57:37] *** Joins: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net)
[00:58:45] <jack> brson: it wasn't working for me for option.unwrap() when option == None
[00:58:53] <jack> but i'll double check. maybe i was just tired
[00:59:24] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[00:59:24] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/vnAgNA
[00:59:24] <ghrust> 13rust/06auto 1488b89f8 15Alex Crichton: Allow disabling optimizations in tests only
[00:59:24] <ghrust> 13rust/06auto 14d9492d7 15bors: auto merge of #8450 : alexcrichton/rust/nopt-changes, r=graydon...
[00:59:25] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[01:00:30] *** Quits: true_droid (true_droid@moz-123FD9B8.beck.volia.net) (Client exited)
[01:02:26] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[01:02:40] <kmc> why do both Chan and SharedChan exist? what's the disadvantage of the latter?
[01:02:52] <jack> brson: https://gist.github.com/metajack/6216889
[01:02:57] <jack> maybe i'm doing it wrong.
[01:03:50] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[01:04:28] *** Quits: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP) (Ping timeout)
[01:04:40] *** Joins: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP)
[01:05:52] <Luqman> is there an issue for not allowing vector repeat expressions in statics?
[01:06:21] <cmr> why shouldn't they be allowed, if they're constexprs?
[01:06:40] <Luqman> cmr: that's the issue, they're not allowed right now
[01:06:51] <cmr> oh
[01:06:58] <Luqman> trying to fix that now and i was wondering if there was an issue already
[01:08:52] <brson> jack: your example works for me on both linux and mac
[01:09:28] <jack> brson: di dyou build it a certain way or rustc a certain way?
[01:09:38] <jack> is my rust commit too old for begin_unwind or something?
[01:10:04] <jack> 8f65dbf is my rustc build
[01:10:50] <jack> is there something i can do to help pinpoint this? i miss being able to debug things :)
[01:16:23] <brson> jack: are you running 32-bit bins? your gist says "CFNetwork(i386:x86-64)". Maybe that doesn't work
[01:17:14] <jack> how do i tell?
[01:17:47] <brson> 'file owrap' maybe
[01:18:48] *** Joins: mark_edward (quassel@B7AE644D.268EDECF.307D91A7.IP)
[01:19:22] <jack> owrap: Mach-O 64-bit executable x86_64
[01:19:22] <jack>  
[01:19:27] <mark_edward> hey guys, is there anyway i could download the rust library docs for easy offline perusal? i might not have internet access or so for a week?
[01:20:11] <jack> brson: gdb is also x64
[01:20:12] <cmr> mark_edward: old docs, or rustdoc_ng docs? :)
[01:20:22] <mark_edward> cmr: both would be nice!
[01:21:01] <brson> jack: does your gdb definitely break on the old upcall_fail? there's nothing new here
[01:21:23] <jack> i used it many times with upcall fail :(
[01:22:28] <cmr> mark_edward: if you have pandoc and such the docs are built by the makefiles
[01:22:36] <cmr> run the configure script, it will tell you what you're missing
[01:22:55] <mark_edward> okey  dokey. is there anyway to just make the docs?
[01:23:17] <cmr> make docs
[01:24:14] <mark_edward> cmr: also where can i find info on how to use the benchmarking stuff?
[01:24:19] <jack> brson: do you get that "can't set memory at address" on mac? also, are you still on 10.6?
[01:24:25] *** Joins: vodik_ (simon@moz-CBE4BB13.cable.teksavvy.com)
[01:24:27] <cmr> mark_edward: https://github.com/mozilla/rust/wiki/Doc-unit-testing
[01:25:12] <brson> jack: i don't get that error and am on 10.6.8
[01:25:21] *** Joins: heftig_ (heftig@moz-223ED7A6.dip0.t-ipconnect.de)
[01:25:36] <cmr> mark_edward: http://octayn.net/benches/newdocs.tar.gz tarball of rustdoc_ng docs
[01:25:51] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[01:26:01] *** Quits: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[01:26:03] <mark_edward> cmr: thanks. how recent is it/
[01:26:14] <cmr> yesterday, I think
[01:27:42] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Ping timeout)
[01:29:06] <mark_edward> cmr: for some reason chromium can't open the index.html file... is there anything i need to do?
[01:29:37] <tjc> bblum: re- r? https://github.com/mozilla/rust/pull/8479 -- I added a comment, let me know if it's clear
[01:30:09] *** Quits: dwhyte (dwhyte@1922756A.EDC594B0.7BF4A4B0.IP) (Ping timeout)
[01:30:15] <cmr> mark_edward: hm. use master/std/index.html I guess
[01:30:35] <cmr> it seems to redirect wrongly
[01:31:19] <mark_edward> cmr: i see. when will rustdoc_ng be put into mozilla/rust/master?
[01:31:44] <bblum> tjc: oh *that*'s what derived error means
[01:31:57] <bblum> tjc: i don't fully understand it still but it looks good enough
[01:31:59] <cmr> mark_edward: I hope to do it this weekend or maybe next week
[01:32:06] <mark_edward> cmr: nice!
[01:32:08] <cmr> still need to iron out bugs
[01:32:19] <tjc> bblum: heh, well, if you want to suggest anything to elaborate on in the comments, I can...
[01:32:49] <bblum> tjc: it's fine
[01:33:04] <bblum> you don't need to comment about every bug that was fixed in the past :P
[01:33:11] <bblum> the comments you added are great though
[01:33:47] <tjc> cool
[01:36:21] <mark_edward> cmr: none of the links at master/std/index.html work :-(
[01:37:06] <cmr> Awww they're not relative
[01:37:10] <cmr> Seldaek: going to have to fix that
[01:37:19] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[01:37:26] <cmr> (I mean not necessarily you, I can look at it tomorrow)
[01:37:49] <mark_edward> cmr: is there any other way to get the new docs offline?
[01:37:59] <cmr> mark_edward: not that I know of!
[01:38:12] <mark_edward> cmr: okay, thanks. old docs it is for now
[01:38:15] <cmr> graydon: r? https://github.com/mozilla/rust/pull/8481
[01:39:05] <cmr> bench_build_sized says it takes 0ns
[01:39:26] <cmr> can't really figure out why..
[01:39:27] <graydon> cmr: why are you running it 1024 times?
[01:39:33] *** Joins: ecr1 (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[01:39:39] <graydon> presumably it's being DCE'ed
[01:39:45] *** Quits: ecr1 (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Quit: ecr1)
[01:39:51] <cmr> this is without optimizations
[01:40:07] <cmr> graydon: good question, I shouldn't be, I just wanted to push a non-constant
[01:40:18] <cmr> but I need to do that in the closure, not outside of it
[01:40:21] <cmr> will fix
[01:40:24] *** Quits: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:42:00] <graydon> cmr: also I suspect it'd be better to do this on ~[] rather than @[], I think maybe @[] isn't long for the world
[01:42:02] <graydon> (maybe? I dunno)
[01:42:23] *** Quits: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu) (Input/output error)
[01:42:36] <cmr> I'm doing all of libstd in alphabetical order according to ls
[01:43:36] <cmr> https://github.com/cmr/rust/commit/5b280886199926101514ed52abaac2269533fdd0#L0R364 updated
[01:43:43] <cmr> 94271 ns/iter (nopt)
[01:45:43] <heftig_> graydon: i like removing it and adding it as a wrapper in the stdlib. rust seems to focus on ~, and it frees up the @ sigil for later reintroduction or reuse
[01:45:48] <cmr> 7560 opt, so it isn't being DCE'd, that's good
[01:45:54] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[01:46:43] <heftig_> so, maybe Gc<~[]>
[01:46:57] <Seldaek> cmr, mark_edward: what? links work fine here?
[01:47:04] <cmr> Seldaek: they link to seld.be
[01:47:08] <Seldaek> nope
[01:47:17] <graydon> cmr: ok. try to keep the interior of each iter loop short. making it big doesn't help the benchmarker.
[01:47:24] <mark_edward> Seldaek: no, i just get a file not found thingy
[01:47:24] <Seldaek> check the source, it's all ../../../.. something
[01:47:35] *** heftig_ is now known as heftig
[01:47:36] <cmr> Seldaek: I assure you they do? Look at the tarball: http://octayn.net/benches/newdocs.tar.gz
[01:47:37] <cmr> graydon: ok
[01:48:06] <graydon> r+
[01:48:10] <cmr> oh wait, you're right
[01:48:12] <cmr> I'm dumb
[01:48:19] <cmr> wrong tab >_<
[01:48:33] <Seldaek> cmr: I have no idea what you're saying, nor where that tarball comes from
[01:48:37] <Seldaek> but the links are relative:p
[01:48:44] <cmr> (I built the docs locally)
[01:49:06] <Seldaek> if someone wants a go laugh https://twitter.com/mitchellh/status/367063622712692736
[01:50:36] <steven_is_false> What's the const marking pass for rustc?
[01:50:56] <cmr> steven_is_false: checks if things are constexprs iirc
[01:51:02] <steven_is_false> Okay, thanks.
[01:51:34] <steven_is_false> It's just it takes up 0.428 seconds, and is the fourth largest factor in compile time for my program.
[01:51:41] <Seldaek> cmr, mark_edward: the issue might be that the links are relative but include the "master" dir name in them, if you rename taht you break all links
[01:51:58] <steven_is_false> It's just a drop in a bucker compared to LLVM (9.665 seconds.)
[01:53:33] <mark_edward> Seldaek: if try to open the root index.html, i get an error saying cannot locate file:///home/mark/rust/build/master/index.html
[01:53:39] <mark_edward> indeed it doesn't exist
[01:53:48] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[01:54:32] <Seldaek> mark_edward: well, here I use it over file:// protocol all the time while developing it, so I'm pretty sure it can work somehow
[01:54:57] <steven_is_false> If I'm readding the output of LLVM passes right, 16.7% of the time is spent in X86 DAG->DAG Instruction Selection (which I don't know what that is.)
[01:55:41] <mark_edward> cmr: the directory in that tarball is named build, is there any building i need to do?
[01:55:49] <cmr> mark_edward: no, it's the output of rustdoc_web
[01:55:54] <cmr> like, directly
[01:56:42] <mark_edward> cmr: for example, there is no index.html in build/master/std/rand/, but i get linked to it and get a file not found error
[01:58:12] *** Joins: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP)
[01:58:47] <Seldaek> mark_edward: yeah the tarball is missing a bunch of files I think
[01:59:14] <Seldaek> not sure if the build failed on cmr's machien for some obscure reason or what happened
[01:59:22] <cmr> it's everything I have in the build directory outputted by rustdoc_web... dunno :S
[01:59:28] <Seldaek> but anyway I must sleep
[01:59:32] <Seldaek> let's see tomorrow..
[01:59:46] <cmr> me too
[01:59:51] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[02:00:22] *** Quits: graydon (Adium@A5087023.2354C43D.D8E68FF6.IP) (Quit: Leaving.)
[02:02:36] <ChrisMorgan> I've been contemplating my vision for a web framework and looking further at the Haskell frameworks out thereâ€”Yesod, Snap, Happstackâ€”and I see that in many ways they are much closer to my vision than anything in any other language. (Though there are still certain aspects where they do not go as far for safety/speed as I do, nor are they convenient to a normal programmer, being Haskell.)
[02:03:07] *** Joins: msingle (Thunderbir@moz-20675462.nrflva.fios.verizon.net)
[02:03:29] <doublec> what about them matches your vision vs other frameworks?
[02:04:09] <ChrisMorgan> The biggest thing is doing validation at compile time rather than run time.
[02:04:31] *** Quits: msingle (Thunderbir@moz-20675462.nrflva.fios.verizon.net) (Quit: msingle)
[02:04:54] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[02:05:23] <tjc> I don't suppose anyone here knows anything about the Mac OS X process spawning code in libstd?
[02:05:35] <ChrisMorgan> That also gives plenty of scope for great performance.
[02:06:01] <doublec> Have you looked at ur/web?
[02:06:06] *** Quits: mark_edward (quassel@B7AE644D.268EDECF.307D91A7.IP) (Ping timeout)
[02:06:12] <doublec> http://www.impredicative.com/ur/
[02:06:20] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[02:06:27] <doublec> the demo gives a good feel: http://www.impredicative.com/ur/demo/
[02:06:43] <doublec> I agree that compile time checking of aspects of web apps is good
[02:07:18] <Luqman> r? https://github.com/mozilla/rust/pull/8483
[02:07:19] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:07:48] <ChrisMorgan> doublec: sounds quite similar
[02:07:50] *** Quits: fyolnish (fyolnish@moz-6F428248.uqwimax.jp) (Client exited)
[02:08:52] <ChrisMorgan> I still have some other ideas beyond that which they don't have so much, in a slightly different direction to most MVC frameworks, taking inspiration from Pylons/Pyramid.
[02:09:26] <steven_is_false> Is it possible to set rustc flags in rust/mk/platform.mk (for example: --cfg 'target_os = "windows"'?)
[02:09:29] <ChrisMorgan> Then too, I think the same concepts embedded in Rust will be much more successful than in Haskell. Much more accessible to Normal People.
[02:09:46] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Ping timeout)
[02:09:53] <ChrisMorgan> (Not that web developers should really be considered to be normal people.)
[02:11:40] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:12:18] *** Joins: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu)
[02:12:23] *** Quits: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (Client exited)
[02:13:59] *** Joins: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP)
[02:14:22] <aatch> ChrisMorgan, as web developer, I resemble that remark
[02:14:45] * ChrisMorgan does too
[02:14:53] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[02:15:33] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[02:16:26] <aatch> ChrisMorgan, that said, I would definitely be interested in helping out with a basic web framework, at least at core levels.
[02:16:44] <aatch> I'm currently building a simple one at work on top of HipHop
[02:17:08] <ChrisMorgan> aatch: at present I'm working at the server level rather than the framework level. Framework is still a little way off
[02:17:34] <aatch> ChrisMorgan, hence the future tense. If/when you get there, give me a bell.
[02:20:14] <aatch> Though there's definately some things I'm doing here that wouldn't get close to working in Rust (like a big chunk of the ORM)
[02:20:46] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[02:23:47] *** Quits: j3n (jen@moz-3388A3B.dip0.t-ipconnect.de) (Ping timeout)
[02:25:32] <klutzy> does `make check` look at files' modification time for license check?
[02:26:43] <klutzy> I got "incorrect license" from file I didn't actually changed, but possibly its mod date is wrong since I copied it
[02:27:03] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[02:27:11] *** Joins: jen (jen@moz-3388A3B.dip0.t-ipconnect.de)
[02:27:22] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[02:27:29] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[02:27:51] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[02:28:04] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[02:30:01] *** Quits: mihneadb_ (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[02:31:30] *** Joins: morton (Mibbit@2E78649B.2573F688.17406662.IP)
[02:32:12] <morton> What is the first language to use code blocks as expressions?
[02:32:17] *** Quits: zz_kimundi (kimundi@moz-FF584B9F.dip0.t-ipconnect.de) (Ping timeout)
[02:32:55] <doomlord_> lisp?
[02:34:27] *** Quits: morton (Mibbit@2E78649B.2573F688.17406662.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:35:42] *** Joins: zz_kimundi (kimundi@moz-216AF03A.dip0.t-ipconnect.de)
[02:35:59] *** zz_kimundi is now known as kimundi
[02:37:52] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[02:38:24] *** Joins: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[02:39:34] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My lid went down)
[02:41:48] *** Joins: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net)
[02:42:08] <acrichto> strcat: how familiar are you with drop glue codegen?
[02:42:28] <acrichto> or anyone really for https://github.com/mozilla/rust/issues/8484
[02:43:16] *** Quits: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP) (Quit: brendan)
[02:43:41] *** Quits: jgilbert (jgilbert@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[02:47:27] *** Joins: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP)
[02:50:19] <sp3d> strcat: you were building rustc arch packages daily, no? I seem to have lost the link
[02:51:05] *** Joins: recrack (ymin@5AB4884B.FCC4549.14D5B978.IP)
[02:51:45] <heftig> sp3d: http://pkgbuild.com/~thestinger
[02:52:37] <sp3d> <3
[02:57:49] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[02:59:49] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[03:03:13] *** Joins: alisdair (textual@4D086FCF.DFA2E3D3.C3C3A9D0.IP)
[03:03:24] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[03:04:52] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[03:09:19] *** Quits: alisdair (textual@4D086FCF.DFA2E3D3.C3C3A9D0.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[03:10:27] <bjz> strcat: how would I do ~str -> *c_char, without needing a null terminator
[03:11:01] <bjz> to_c_str().unwrap()?
[03:11:37] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[03:13:29] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[03:13:29] *** Quits: pcwalton (pcwalton@E2F7352.56080C53.97BBD552.IP) (Quit: pcwalton)
[03:14:30] <tautologico_> what's a good way to accumulate characters and then turn them into a str?
[03:15:07] <jeaye> tautologico_: You can use str::push_char
[03:15:24] <doomlord> i was going to say thats what i'm doing but i'm not sure its a good way
[03:15:51] <jeaye> Well, you can use str::reserve first if you can
[03:16:50] <tautologico_> thanks
[03:17:43] <engla> if you have an iterator yielding char, .collect() is enough
[03:17:44] <doomlord> started to get that sense of asymetry a bit with 'the first parameter'. is this just a fundemental problem with the universe like the halting problem..
[03:18:48] <doomlord> in C++ its the broken modularity. rust is refreshing but it takes me some thought to write things without overloading :)
[03:20:24] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Quit: Leaving)
[03:20:43] <doomlord> so one has the potentially conflicting requirement .. select the first parameter for convinience of chaining (call syntax), or for polymophism
[03:22:22] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[03:23:59] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[03:24:34] *** Quits: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com) (Ping timeout)
[03:25:09] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[03:26:13] <strcat> bjz: to_ptr
[03:26:25] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[03:26:25] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/vnAgNA
[03:26:25] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:26:27] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Quit: WeeChat 0.4.2-dev)
[03:26:29] <strcat> bjz: also strings are represented the same way as ~[u8] now
[03:26:35] <strcat> like you can just transmute them 
[03:26:40] <strcat> there's probably a wrapper fn
[03:29:23] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[03:29:23] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/hRFaVg
[03:29:23] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[03:29:25] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[03:29:25] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/2qfqAA
[03:29:25] <ghrust> 13rust/06auto 148b502d6 15Daniel Micay: register snapshots
[03:29:25] <ghrust> 13rust/06auto 140cb0ef2 15Daniel Micay: fix build with the new snapshot compiler
[03:29:25] <ghrust> 13rust/06auto 1444675ac 15bors: auto merge of #8476 : thestinger/rust/snapshot, r=brson
[03:29:27] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[03:29:58] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[03:30:05] <strcat> acrichto: yeah, that's how moves work
[03:30:07] <strcat> the same as C++
[03:30:11] <strcat> when you move from a value, it zeroes it
[03:30:16] <strcat> and then the drop glue checks for that
[03:30:22] <strcat> a custom Drop implementation adds a drop flag to check
[03:30:23] <ChrisMorgan> strcat: assuming ASCII string, I presume?
[03:30:30] <acrichto> yeah I read 5016 adn realized that optimization would just be nice to have
[03:30:39] <acrichto> I didn't know that was the default behavior though...
[03:30:40] <strcat> ChrisMorgan: no, it's always just ~[u8]
[03:30:48] <strcat> utf-8 is just bytes
[03:30:52] <ChrisMorgan> Oh, yeah.
[03:31:04] <strcat> a code point is just 1-4 bytes
[03:31:08] <strcat> no endian issues
[03:31:34] <acrichto> bjz: I'm adding `.repr()` for `~str` in https://github.com/mozilla/rust/pull/8446/files#L5R59
[03:32:01] <strcat> acrichto: that's why we made unsafe_no_drop_flag - it omits the drop flag, and zeroes instead (like it does for ~T)
[03:32:07] <strcat> anyway
[03:32:15] <strcat> would be nice to always not do it via analysis
[03:32:18] <bjz> strcat: cheers
[03:32:27] <strcat> bjz: :)
[03:32:50] <bjz> wait, what is to_ptr on?
[03:33:15] <engla> to_ptr is only for vec I think
[03:33:32] <acrichto> strcat: could the example in that issue be optimized with unsafe_no_drop_flag ?
[03:34:25] <strcat> acrichto: no, it already has no drop flag
[03:34:29] <strcat> it uses the ptr as the drop flag
[03:34:40] <strcat> the drop flag thing is just a size optimization
[03:35:02] <acrichto> aw man, my splay tree is 2x slower than treemap and there's no reason it should be that much slower on random inputs
[03:35:30] <strcat> I micro-optimized treemap a lot
[03:35:36] <strcat> it got 4x faster just from reorganizing stuff
[03:35:48] <strcat> if it was just with unsafe code it'd be 3x faster than it is now :|
[03:35:56] <strcat> the move issue really hurts
[03:36:07] <strcat> because we're missing TBAA and we have some IR issues
[03:36:07] <acrichto> yeah the splay method is one large method and the codegen is absolutely massive
[03:36:24] <strcat> we really need to update LLVM too ;p
[03:36:35] <acrichto> how much of a benefit would that get us?
[03:36:42] <acrichto> I tried last friday and a new commit came in that broke us
[03:37:08] <Luqman> acrichto: what commit?
[03:37:18] <strcat> acrichto: well it would help a lot because it would mean we could turn on loop-vectorize at --opt-level=2 and SLP vectorize at --opt-level=3
[03:37:31] <strcat> I dunno, 5% on rustc compiles at best :s
[03:37:41] <strcat> but on microbenchmarks, 30-70% wins in some cases
[03:38:07] <acrichto> strcat: I think https://github.com/llvm-mirror/llvm/commit/5b854f1ea55601790d9191c9720e77da35095340
[03:38:30] <acrichto> it was some assertion failure in sroa about some promotable thing (I forget exactly what it was)
[03:39:04] <acrichto> I don't think I'm going to find those rusti issues any time soon, so as soon as llvm builds again for me I think I'll resubmit the pull
[03:39:49] <strcat> was the assert a rusti issue, or a general one?
[03:40:11] <acrichto> a general one
[03:40:14] <acrichto> during stage1
[03:40:17] <acrichto> or stage2
[03:40:23] <acrichto> one of them
[03:43:06] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:43:06] *** ChanServ sets mode: +o brson
[03:45:13] *** Joins: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net)
[03:45:15] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[03:45:15] *** ChanServ sets mode: +o tjc
[03:46:31] *** Joins: dherman (dherman@moz-7B0110AD.mv.mozilla.com)
[03:46:32] *** ChanServ sets mode: +o dherman
[03:48:46] *** Joins: dherman_ (dherman@moz-BBE3ABD.mv.mozilla.com)
[03:48:49] *** Quits: dherman (dherman@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[03:48:49] *** dherman_ is now known as dherman
[03:51:59] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[03:52:19] *** Quits: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP) (Quit: tautologico_)
[03:54:51] <sfackler> acrichto: I'm planning on writing up extra::base32 which I think should wrap up all of the common encoding formats. the one potential exception is urlencode but I think that probably belongs in an http support library rather than extra. thoughts?
[03:55:01] *** Quits: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu) (Input/output error)
[03:55:46] <acrichto> sfackler: I'd be ok with that, seems like a pretty standard encoding to me (especially if we have base64)
[03:55:56] *** Quits: KindOne (KindOne@moz-4C88E65.dynamic.ip.windstream.net) (Ping timeout)
[03:59:59] *** Quits: recrack (ymin@5AB4884B.FCC4549.14D5B978.IP) (Quit: Lost terminal)
[04:00:16] *** Quits: boredomist (user@moz-63CF9F31.res-cmts.sesp.ptd.net) (Ping timeout)
[04:01:02] *** Joins: cmr (moznet@moz-EC676DFE.members.linode.com)
[04:01:03] *** Joins: sfackler (sfackler@moz-316FE70F.compute-1.amazonaws.com)
[04:01:04] *** Joins: [a]bacus (snoonan_mo@moz-F95B9243.hsd1.wa.comcast.net)
[04:01:04] *** Joins: kaeso (kaeso@moz-F21FF626.unstable.it)
[04:01:05] *** Joins: ldlework (ldlework@6AEB83D1.B92A0FC.176AC772.IP)
[04:01:06] *** Joins: cade (cade@66A6305B.C2D6DAC0.9510F13D.IP)
[04:01:06] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[04:01:06] *** Joins: doublec (doublec@moz-4DA4FA7C.cd.pn)
[04:01:06] *** Joins: jack (jack@moz-DF5A9AA3.members.linode.com)
[04:01:08] *** Joins: joelteon (joel@moz-317E8D0C.io)
[04:01:09] *** ChanServ changes topic to 'New Runtime is landed! http://www.rust-lang.orgÂ | logs at https://botbot.me/mozilla/rust/ and http://irclog.gr/#browse/irc.mozilla.org/rust | http://huonw.github.io/isrustfastyet/mem/ | landings http://buildbot.rust-lang.org/bors/bors.html'
[04:01:09] *** Joins: igl (igl@moz-8916AB00.adsl.alicedsl.de)
[04:01:09] *** Joins: [o__o] (~o__o@moz-24EBFAC7.me)
[04:01:10] *** Joins: fairfieldt (fairfieldt@moz-D8998E1C.xen.prgmr.com)
[04:01:10] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[04:01:12] *** Joins: lahwran (lahwran@lahwran.net)
[04:01:13] *** Joins: fzzzy (fzzzy@A5CBE5CF.A81CC6E.44FA8ED.IP)
[04:01:15] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[04:01:16] *** Joins: erick (erick@E1304535.2A7189BF.BE19388.IP)
[04:01:16] *** Joins: cantsin (cantsin@moz-F99612CC.members.linode.com)
[04:01:18] *** Joins: reed (reed@tech.monkey)
[04:01:19] *** [a]bacus is now known as abacus
[04:01:19] *** Joins: jen (jen@moz-3388A3B.dip0.t-ipconnect.de)
[04:01:19] *** Joins: dju (dju@moz-83BD5EC.dmz.me)
[04:01:20] *** Joins: noct (quassel@moz-BAA6B280.com)
[04:01:20] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[04:01:20] *** Joins: km (quassel@moz-777F24DE.kevinmehall.com)
[04:01:20] *** Joins: spacetime (quassel@moz-CAB487E6.rishab.in)
[04:01:21] *** zz_kimundi is now known as kimundi
[04:01:21] *** Joins: Boreeas (Boreeas@moz-F35C832D.boreeas.net)
[04:01:21] *** Joins: dcolish (dcolish@1DB472A5.BE69FB10.416A0103.IP)
[04:01:21] *** Joins: tupshin (quassel@moz-E7B03838.c3-0.nyr-ubr1.nyr.ny.cable.rcn.com)
[04:01:21] *** Joins: jst (quassel@moz-BBE3ABD.mv.mozilla.com)
[04:01:21] *** Joins: pcdummy (quassel@moz-CF4CA865.page4me.ch)
[04:01:21] *** Joins: jez0990 (quassel@moz-3BA8545E.kimsufi.com)
[04:01:21] *** Joins: kini (kini@moz-92AA953A.members.linode.com)
[04:01:21] *** Joins: XgF (quassel@moz-58044BA0.ldn1.uk.e43.eu)
[04:01:22] *** Joins: Mindless` (mindless@moz-9C38D3B4.net)
[04:01:22] *** Joins: parcha (quassel@moz-A9A9F340.hsd1.ma.comcast.net)
[04:01:22] *** Joins: h3r3tic (heretic@moz-8BC3B3DB.se)
[04:01:22] *** Joins: ruediger (quassel@moz-C9B8D8D0.org)
[04:01:22] *** Joins: ldunn (username@moz-94CB0FA.cyberius.net)
[04:01:25] *** Joins: decoder (quassel@moz-D7023D7D.own-hero.net)
[04:01:25] *** Joins: teratorn (teratorn@moz-5363C32C.teratorn.org)
[04:01:25] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[04:01:28] *** Joins: KindOne (KindOne@moz-4C88E65.dynamic.ip.windstream.net)
[04:01:29] *** Joins: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP)
[04:01:30] *** bnicholson is now known as IRCMonkey63003
[04:01:37] *** Joins: ivan (ivan@moz-531C3EC9.members.linode.com)
[04:01:37] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[04:01:39] *** Joins: diegoyam (quassel@FF9B1514.A4EC3D18.3A1EC144.IP)
[04:01:48] *** Joins: AutomatedTester|AFK (David@moz-DB4A9C19.scl3.mozilla.com)
[04:01:53] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:02:01] *** Joins: mreid (mreid@moz-5F4A70CA.yipyip.com)
[04:02:09] *** heftig is now known as IRCMonkey33931
[04:02:15] *** AutomatedTester|AFK is now known as AutomatedTester
[04:02:22] *** Joins: toshok (toshok@moz-67C55A1F.com)
[04:02:22] *** Joins: markluffel (markluffel@179F0C2A.5C4C7C24.8354FB35.IP)
[04:02:23] *** Joins: kkris (kkris@moz-CB70009.yourvserver.net)
[04:02:24] *** Joins: zheng_li (zheng_li@moz-D6711E9E.xenplanet.org)
[04:02:24] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[04:02:29] *** Joins: glandium (glandium@moz-A09032B1.kimsufi.com)
[04:02:29] *** Joins: kuuranne (kuuranne@moz-C4357EA7.kapsi.fi)
[04:02:51] *** Joins: wting (wting@moz-250C027.csres.utexas.edu)
[04:03:09] *** Joins: joshua_ (joshua@moz-45967CBE.emarhavil.com)
[04:03:10] *** Joins: indutny (indutny@moz-49D42D15.c.ircrelay.com)
[04:03:54] *** Joins: gazoombo (uid6629@moz-E77DEB21.irccloud.com)
[04:04:23] *** Joins: sankha93 (uid12218@moz-31ABA2C0.irccloud.com)
[04:05:05] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[04:05:19] *** Joins: snerd (motk@moz-E535583C.nonstopcrunchy.net)
[04:05:19] *** Joins: froystig (froystig@5A39C99E.352137A1.BCED17D.IP)
[04:05:20] *** Joins: kdj (kyle@FA39BFBF.D27A4F86.8BEFA1E3.IP)
[04:05:20] *** Joins: friggle (friggle@moz-A607EAFA.members.linode.com)
[04:05:20] *** Joins: Peng (mnordhoff@moz-D5175E95.mattnordhoff.net)
[04:05:20] *** Joins: rhelmer (rhelmer@moz-DB4A9C19.scl3.mozilla.com)
[04:05:20] *** Joins: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[04:05:20] *** Joins: shachaf (shachaf@moz-F37E0395.members.linode.com)
[04:05:20] *** Joins: eevee (eevee@moz-9A8E1439.evrt.wa.frontiernet.net)
[04:05:20] *** Joins: patrickg (patrick@moz-35CE42C5.de)
[04:05:20] *** Joins: marc (marc@E31B39DA.F9D61A8.416A0103.IP)
[04:05:20] *** Joins: ssiloti (steve@moz-4B8C4631.oc.oc.cox.net)
[04:05:20] *** Joins: balpert (balpert@moz-7E5ED302.members.linode.com)
[04:05:20] *** Joins: mcpherrin (mimcpher@moz-345B5EBA.csclub.uwaterloo.ca)
[04:05:20] *** Joins: Defiler (wilson@moz-5531C57F.wb78.net)
[04:05:20] *** Joins: yosemite (sam@moz-8CEAB1B0.dasbistro.com)
[04:05:20] *** Joins: xymostech (xymostech@22A34502.AFC2BCFF.2CFD4520.IP)
[04:05:21] *** Joins: madmoose (Hat@moz-E1973371.nerp.net)
[04:05:21] *** Joins: eakuefner (eakuefner@moz-9EDCAF3.com)
[04:05:21] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[04:05:21] *** Joins: oldmanstan (glesica@moz-CA910636.net)
[04:05:21] *** Joins: jld (jld@moz-B94C75AD.xlerb.net)
[04:05:21] *** Joins: rbancroft (rumble@moz-4E8E0D7F.cg.shawcable.net)
[04:05:21] *** Joins: flu_ (flu@1B44C715.B5AB1363.2E11A1C0.IP)
[04:05:21] *** Joins: relrod (relrod@moz-AABB5D31.redhat.com)
[04:05:21] *** Joins: callen (callen@95EE74F7.F6EF2525.EE6E63A5.IP)
[04:05:21] *** Joins: kalenedrael (wat@moz-DBB6BE74.zagar.us)
[04:05:21] *** Joins: eckzow (eckzow@moz-506D8496.members.linode.com)
[04:05:21] *** Joins: hoelzro (hoelzro@moz-937642A5.ro)
[04:05:21] *** Joins: BigEndian (hurp@moz-1B6DD81E.members.linode.com)
[04:05:21] *** Joins: jpf (jan@moz-A8C26A15.org)
[04:05:21] *** Joins: prudhvi (prudhvi@moz-154A460A.supr.io)
[04:05:21] *** Joins: sully (sully@moz-45967CBE.emarhavil.com)
[04:05:22] *** Joins: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu)
[04:05:22] *** Joins: jj2baile (jon@moz-DCEF6040.csclub.uwaterloo.ca)
[04:05:22] *** Joins: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu)
[04:05:22] *** Joins: Eridius|vacation (kevin@moz-533B0DB4.us)
[04:05:22] *** Joins: DasIch (dasich@moz-5EDA591.de)
[04:05:22] *** Joins: xlq (ekselkiu@moz-DF73151C.net)
[04:05:22] *** Joins: bbouvier (bnjbouv@moz-63AFAFBF.gagahome.fr)
[04:05:22] *** Joins: Esmil (esmil@moz-23E4A227.dk)
[04:05:22] *** Joins: chandler (foo@moz-F990611.mastenbrook.net)
[04:05:22] *** Joins: jasom (aidenn@moz-5F6FC7B3.sb.sd.cox.net)
[04:05:22] *** Joins: Thiez (thiez@moz-BF669398.student.utwente.nl)
[04:05:22] *** Joins: elly (elly@18D20C19.2A2E1A6B.EA806F19.IP)
[04:05:22] *** Joins: ssalbiz (ssalbiz@moz-21D6B3DE.csclub.uwaterloo.ca)
[04:05:22] *** Joins: goffrie (goffrie@moz-81CAF92F.dsl.ncf.ca)
[04:05:22] *** Joins: zebr (zebr@moz-87CB2D2A.kent.ac.uk)
[04:05:22] *** Joins: smvv (smvv@moz-A397289C.xlshosting.net)
[04:05:22] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[04:05:22] *** Joins: Klaufir_ (admin@94E7A28F.E28D9BD4.349F3CD5.IP)
[04:05:22] *** Joins: jyyou (jyyou@moz-47B052FA.cs.nctu.edu.tw)
[04:05:23] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[04:05:23] *** ChanServ sets mode: +o brson
[04:05:23] *** Joins: Ke (jkarlson@moz-40397852.org.aalto.fi)
[04:05:23] *** Joins: Flibo (Flibo@moz-40397852.org.aalto.fi)
[04:05:23] *** Joins: ilyoan (ilyoan@B4104EBB.3CC170B1.1E14B209.IP)
[04:05:23] *** Joins: rhodesd (none@3646D136.4C5731DA.F395EA5B.IP)
[04:05:23] *** Joins: zxcdw (r-a@858B320D.B543C4DE.3933CC16.IP)
[04:05:23] *** Joins: benh (ben@moz-4A0366D2.org)
[04:05:23] *** Joins: klutzy (th@BA61F396.8E859986.ECA1BB11.IP)
[04:05:23] *** Joins: Jontte (joonas@moz-8B229CD6.la)
[04:05:24] *** Joins: _1126 (1126@moz-83D60E55.lileth.net)
[04:05:24] *** Joins: myname (myname@F6BC1CBC.2C5F047.A0197E77.IP)
[04:05:24] *** Joins: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com)
[04:05:24] *** Joins: mjrosenb|ARM (mjrosenb@moz-B3592BDA.club.cc.cmu.edu)
[04:05:24] *** Joins: bstrie (ben@moz-D5A1D0F5.members.linode.com)
[04:05:24] *** Joins: dolphinling (andrew@moz-80A1E448.uvm.edu)
[04:05:24] *** Joins: toddaaro (toddaaro@moz-98F46974.us)
[04:05:25] *** Joins: Luqman (laden@moz-DCEF6040.csclub.uwaterloo.ca)
[04:05:25] *** Joins: acrichto (acrichto@moz-17CABEB0.wv.cc.cmu.edu)
[04:05:26] *** Joins: kmc (keegan@moz-D2A53639.compute-1.amazonaws.com)
[04:05:26] *** Joins: max (maxime@moz-478B7011.fr)
[04:05:27] *** Joins: dforsyth (dforsyth@A677A619.1C765EF.EE6E63A5.IP)
[04:05:28] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:05:28] *** Joins: brendanc (brendan@moz-CA4BEC19.cs.ubc.ca)
[04:05:29] *** Joins: dumitru (dgherman@moz-7C253BEB.getcadre.com)
[04:05:32] *** vfetwnuncszu is now known as dcrewi
[04:06:21] *** rhelmer is now known as IRCMonkey48213
[04:08:36] *** Joins: slaren (slaren@moz-E221166D.red-81-35-253.dynamicip.rima-tde.net)
[04:09:26] *** Joins: sawrubh (uid6719@moz-5F4AA75A.irccloud.com)
[04:09:43] *** Joins: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP)
[04:10:21] *** Joins: rntz_ (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[04:12:23] *** IRCMonkey63003 is now known as bnicholson
[04:13:44] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[04:14:20] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[04:14:27] *** Joins: Crnobog (uid1041@moz-E77DEB21.irccloud.com)
[04:16:07] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[04:16:26] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[04:16:49] <strcat> rusti: 2
[04:16:50] -rusti- 2
[04:18:26] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[04:19:27] *** Joins: Aetherspawn_BNC (uid6924@moz-31ABA2C0.irccloud.com)
[04:19:28] *** Joins: wilfred (uid159@moz-5F4AA75A.irccloud.com)
[04:19:42] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Connection reset by peer)
[04:20:05] *** Quits: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu) (Input/output error)
[04:21:05] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[04:21:06] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[04:23:41] *** Quits: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 24.0/20130806170643])
[04:24:26] *** Joins: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu)
[04:24:39] *** Joins: recrack (ymin@5AB4884B.FCC4549.14D5B978.IP)
[04:27:42] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Connection reset by peer)
[04:29:29] *** Joins: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com)
[04:32:36] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[04:35:16] <strcat> rust-buildbot: dance
[04:35:17] <rust-buildbot> <(^.^<)
[04:35:18] <rust-buildbot> <(^.^)>
[04:35:19] <rust-buildbot> (>^.^)>
[04:35:20] <rust-buildbot> (7^.^)7
[04:35:21] <rust-buildbot> (>^.^<)
[04:35:26] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[04:36:29] *** Joins: FDS (arnaud@moz-CE4D5907.bdx.modulonet.fr)
[04:38:44] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[04:42:03] *** Quits: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP) (Quit: brendan)
[04:43:31] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[04:45:23] *** Joins: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP)
[04:46:04] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:46:25] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[04:47:26] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[04:50:18] <engla> acrichto: will the {} format change to use a trait later (instead of %?)?
[04:50:34] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: Lost terminal)
[04:50:37] <engla> using something like ToStr on steroids
[04:50:57] <cmr> I wonder if we'd lose anything by defining `bool` as enum bool { true, false } in the prelude
[04:51:00] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[04:51:01] *** ChanServ sets mode: +o brson
[04:51:06] <cmr> At least once we have descriminant shrinking
[04:51:33] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[04:52:50] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[04:52:52] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: Lost terminal)
[04:53:25] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[04:53:25] *** ChanServ sets mode: +o brson
[04:54:38] <bjz> brson: is there a way of making sure a Chan doesn't close prematurely?
[04:55:17] <bjz> brson: I'm storing a Chan in a C libs user pointer
[04:55:42] <bjz> I think it might be closing early, because I'm getting seg-fualts
[04:55:46] <bjz> *faults
[04:56:08] *** Joins: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net)
[04:57:14] <bjz> cmr: that would be cool
[04:57:42] *** Joins: pcwalton (pcwalton@E2F7352.56080C53.97BBD552.IP)
[04:57:42] *** ChanServ sets mode: +o pcwalton
[04:57:42] <bjz> cmr: int as bool?
[04:57:44] <brson> bjz: presumably because the ownership situation between the Rust and native code isn't clear, so the Chan is being destroyed while the native code is trying to use it
[04:57:52] <engla> cmr: enum bool { false, true }  :-)
[04:58:06] <bjz> brson: how could I control that?
[04:58:24] <cmr> bjz: that is something we'd lose -- until https://github.com/mozilla/rust/issues/7080
[04:58:43] <bjz> brson: I have: pub fn parse(src: &str) -> Port<ParseResult> {
[04:58:49] <engla> int as bool is not useful
[04:59:04] <acrichto> engla: oh let me test if that's possible, I think bstrie wanted the same thing
[04:59:08] <bjz> engla: it is for c libs
[04:59:14] <brson> bjz: when I'm interoping with native code I try to preserve ownership semantics, so might make a ~Chan, transmute it to a *Void then give that to the native code, then Rust no longer owns it. Later transmute it back to ~Chan and Rust owns it again. Everytime Rust takes control it takes ownership
[04:59:34] <engla> bjz: you can just test against 0
[04:59:50] <brson> bjz: where is your ffi code?
[05:00:08] <bjz> not yet committed :P
[05:00:34] <bjz> brson: I can do that
[05:03:13] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[05:03:15] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[05:04:16] * ChrisMorgan is thinking about an eventual goal of his, compiling Rust to JavaScript, and how satisfying it would be to wrap hypothetical inline JavaScript code with `unsafe { }`
[05:04:45] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:06:32] *** Joins: LimeBurst (me@247D1419.D73964AC.27A8748.IP)
[05:09:11] <bjz> brendan: not the entire thing: https://gist.github.com/bjz/459c70141246da87f66d
[05:09:23] <bjz> woops, I mean brson
[05:10:34] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Client exited)
[05:12:08] <engla> acrichto: I've got a small fix to use unstable::raw in two more places, can I just let you adopt my patch?  https://gist.github.com/anonymous/b766727a39c137792b21
[05:12:15] <engla> it's a bit small to have a PR of its own
[05:12:41] <acrichto> engla: sure, can do (although ifmt! may take longer to review)
[05:12:46] *** Joins: jaen (jaen@moz-FBFFE493.play-internet.pl)
[05:12:53] <brson> bjz: on first glance that looks fine. where's the segfault?
[05:13:16] *** Quits: mibitzi (mibitzi@659DAD1F.60DF3A09.8395810B.IP) (Ping timeout)
[05:14:18] *** Joins: mibitzi (mibitzi@659DAD1F.60DF3A09.8395810B.IP)
[05:14:57] <acrichto> engla: also btw that works (impl<T: ToStr> DefautlFormat for T) and having {} == {:default} or whatever it should be
[05:15:28] <engla> aha
[05:15:48] <engla> maybe that complicates the nice design though
[05:16:07] <engla> ToStr should die and be replaced by a writer-based thing.. like maybe exactly DefaultFormat
[05:16:08] <acrichto> engla: one thing that'd be really cool do to is something like ifmt!("{}", time::now())
[05:16:26] *** Quits: jaen (jaen@moz-FBFFE493.play-internet.pl) (Ping timeout)
[05:16:28] <acrichto> but any type which implements ToStr couldn't override the DefaultFormat implementation
[05:16:32] <acrichto> which would be sad
[05:16:51] <acrichto> engla: although you're right about the writer-based version of ToStr
[05:16:55] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[05:16:56] <acrichto> it'd be perfect for ifmt
[05:17:49] *** Quits: igl (igl@moz-8916AB00.adsl.alicedsl.de) (Ping timeout)
[05:18:00] <bjz> brson: hmm, it seems changing cast::transmute(&chan) to cast::transmute(~chan) does the trick
[05:18:13] *** Quits: aatch (aatch@moz-B437F499.pocketrent.com) (Client exited)
[05:18:31] <jack> wait wait, how are you sending messages from a C callback?
[05:18:37] <jack> i thought that didn't work at all?
[05:18:44] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[05:19:17] <jack> is it the case that you will end up on the same thread/task as you invoked the C function from?
[05:19:22] <brson> bjz: that's probably going to leak your Chan
[05:19:26] <jack> what prevents you from getting descheduled?
[05:19:29] <bjz> brson: ah
[05:19:38] *** Joins: igl (igl@moz-7A86A165.adsl.alicedsl.de)
[05:19:43] <brson> well, unless you transmute it back sometime later
[05:20:39] <bjz> brson: I think my segfault is happening sometime around extern "C" fn start_element
[05:20:41] <brson> bjz: i don't understand why the code doesn't work as-is. maybe chan is going out of scope somewhere wierd. maybe try assigning from it after the xml parsing
[05:20:51] <brson> just to *make sure* it stays in scope
[05:21:27] <bjz> brson: weird thing is it works in my gl-generator. just trying to libify it
[05:21:40] *** Joins: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP)
[05:21:54] *** Joins: igl1 (igl@moz-BC524815.adsl.alicedsl.de)
[05:21:58] <brson> jack: this is a C callback being called from within a C function called from inside a task, which works. I don't think being descheduled is a problem here - it'll get rescheduled later
[05:21:59] <engla> acrichto: ifmt looks great. can the string formatter just be the default?
[05:22:08] *** Quits: igl (igl@moz-7A86A165.adsl.alicedsl.de) (Ping timeout)
[05:22:19] <jack> brson: when you call send, ti can move your task to another thread, no?
[05:22:35] <brson> jack: it could, yes
[05:23:15] <acrichto> engla: thanks! this may need to be brought up in a broader discussion though b/c I'm not sure that that's the best way to go either
[05:23:16] *** Quits: ross (ross@moz-8A84103E.br.br.cox.net) (Quit: )
[05:23:16] <jack> you call send, it switches to the other task, immediately. when your old tasks wakes up, ther eis no guarantee it's on the same thread. or at least that's how i understood it.
[05:23:28] <brson> jack: yes, that's true
[05:23:44] <brson> jack: but that's not a problem generally afaik
[05:23:54] <brson> only if the C code depends on thread-local state of some kind
[05:23:58] <bjz> brson: eh, this is weird, I run it multiple times and I get different results, sometimes it works, sometimes it segfaults, sometimes it does: task <unnamed> failed at 'assertion failed: is_utf8(v)', /Users/brendan/dev/rust/rust/src/libstd/str.rs:958
[05:24:02] <jack> assuming there's no thead local state in that c library :)
[05:24:11] <engla> acrichto: good idea
[05:24:17] *** Quits: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP) (Quit: brendan)
[05:24:36] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[05:24:38] <bjz> brson: would storing the Chan in TLS be a better idea?
[05:25:15] *** Quits: igl1 (igl@moz-BC524815.adsl.alicedsl.de) (Ping timeout)
[05:26:11] *** Quits: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP) (Ping timeout)
[05:26:17] *** Joins: igl (igl@moz-5C1E5CB4.adsl.alicedsl.de)
[05:26:19] <brson> bjz: not imo but it may be easier to get working
[05:26:25] <brson> worth a shot at lesat
[05:27:13] <bjz> oh wait, if I do: let _ = chan; at the end of `parse` I get a consistent `assertion failed: is_utf8(v)`
[05:27:48] <bjz> oh wait, no I don't
[05:28:11] <brson> bjz: you might try running with RUST_THREADS=1 to rule out multithreading wierdness
[05:28:46] <bjz> that works
[05:29:35] <bjz> oh wait
[05:29:37] *** Quits: igl (igl@moz-5C1E5CB4.adsl.alicedsl.de) (Ping timeout)
[05:29:39] <bjz> no
[05:29:55] <bjz> -_-
[05:30:21] <bjz> maybe I should just commit the repo
[05:30:24] <bjz> sax-rs
[05:30:37] *** Joins: robertknight (robertknig@moz-85C86086.range81-151.btcentralplus.com)
[05:32:09] *** Quits: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP) (Quit: tautologico_)
[05:32:32] *** Joins: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP)
[05:32:54] *** Joins: igl (igl@moz-4ECF23A5.adsl.alicedsl.de)
[05:32:58] <brson> what's the replacement for as_c_str?
[05:33:19] <strcat> brson: ideally, append a \0 yourself - if you must, there's to_c_str
[05:33:38] <strcat> er
[05:34:02] *** Joins: alisdair (textual@4D086FCF.DFA2E3D3.C3C3A9D0.IP)
[05:34:02] <strcat> ah yeah it's defined in c_str
[05:36:52] *** Quits: RMF (RMF@2FAA1705.89DFFE83.11F731AB.IP) (Quit: Textual IRC Client: www.textualapp.com)
[05:37:10] <bjz> brson: https://github.com/bjz/sax-rs
[05:37:22] *** Joins: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP)
[05:37:33] <bjz> brson: still weird randomness
[05:37:50] *** Joins: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net)
[05:37:54] <strcat> bjz: valgrind?
[05:38:00] *** Quits: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP) (Quit: brendan)
[05:39:01] <bjz> brson: it seems to work ok here: https://github.com/bjz/gl-rs/tree/master/generator
[05:39:10] <bjz> strcat: never used it before
[05:39:18] <bjz> strcat: how would that help?
[05:39:26] <strcat> maybe there's memory corruption somewhere
[05:39:34] *** Quits: tchoma (tchoma@moz-E58E29CC.dsl.static.sonic.net) (Quit: tchoma)
[05:40:09] *** Quits: dforsyth (dforsyth@A677A619.1C765EF.EE6E63A5.IP) (Quit: Lost terminal)
[05:41:27] *** Joins: dforsyth (dforsyth@A677A619.1C765EF.EE6E63A5.IP)
[05:42:22] <bjz> strcat: how do you use valgrind with rust?
[05:42:38] <strcat> bjz: just 'valgrind ./foo'
[05:42:50] <bjz> brson: might it be because I'm trying to use it in a testsuite?
[05:43:03] <strcat> although it will probably have 'condition jump depends on uninit value' false positives
[05:43:07] <bjz> brson: testsuites are parralellised?
[05:43:10] <strcat> conditional*
[05:44:01] <brson> bjz: they are but not with RUST_THREADS=1
[05:44:07] *** Joins: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP)
[05:47:06] <klutzy> https://github.com/mozilla/rust/pull/8488 r? mingw-w64 stuff.
[05:47:09] <engla> if I add a function  result::fold for  Iterator<Result<U, E>>  ~~> Result<V, E>;  how ok is it to have a function ~~> Result<(), E>  called `fold_`? (because it ignores the values)
[05:47:36] <bjz> strcat: is there an equivalent of as_imm_buf that gives a *c_char?
[05:47:39] *** Quits: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP) (Quit: tautologico_)
[05:48:03] <strcat> as_imm_buf is pretty dumb imo, pointless closure
[05:48:12] <strcat> vectors have to_ptr which is nicer
[05:48:51] <bjz> atm I'm doing: src.to_c_str().with_ref(|r|r), src.len() as libc::c_int
[05:49:57] *** Joins: igl1 (igl@moz-9684347A.adsl.alicedsl.de)
[05:50:22] <cmr> rusti: let x: &const int = &5;
[05:50:23] -rusti- <anon>:5:13: 5:14 warning: unused variable: `x` [-W unused-variable (default)]
[05:50:23] -rusti- <anon>:5          let x: &const int = &5;
[05:50:23] -rusti-                       ^
[05:50:23] -rusti- ()
[05:50:24] *** Quits: igl (igl@moz-4ECF23A5.adsl.alicedsl.de) (Ping timeout)
[05:50:30] <bjz> strcat: would cast::transmute(&src), src.len() as libc::c_int work?
[05:50:33] <cmr> rusti: let x: @const int = @5;
[05:50:35] -rusti- pastebinned 6 lines of output: http://ix.io/7eR
[05:50:43] <cmr> Alright! So only 8 pointer types
[05:50:46] <bjz> strcat: or cast::transmute(src), src.len() as libc::c_int
[05:51:09] <strcat> bjz: well, vectors have to_ptr
[05:51:12] *** Joins: maik (maik___@moz-122881CA.dip0.t-ipconnect.de)
[05:51:23] <bjz> heh, it doesn't like me transmuting it
[05:51:46] <bjz> strcat: but I have a string
[05:51:51] <strcat> bjz: look in std::unstable::raw
[05:52:00] <strcat> there are the raw representations of types
[05:52:16] <strcat> rusti: "foo".repr()
[05:52:17] -rusti- <anon>:5:9: 6:5 error: type `&'static str` does not implement any method in scope named `repr`
[05:52:17] -rusti- <anon>:5          "foo".repr()
[05:52:17] -rusti- <anon>:6     };
[05:52:17] -rusti- error: aborting due to previous error
[05:52:17] -rusti- application terminated with error code 101
[05:52:21] <cmr> klutzy: so uh https://github.com/klutzy/rust/commit/1f831d9637232805d6fb82f6f1c8b6869e066860
[05:52:25] <strcat> rusti: use std::unstable::raw::Repr; "foo".repr()
[05:52:26] -rusti- {data: (0x408918 as *()), len: 3}
[05:52:29] <strcat> bjz: ^
[05:52:38] <bjz> ahhh
[05:52:47] <cmr> klutzy: 1. Why, 2. What work needs to be done to get unwinding in windows?
[05:52:53] <strcat> bjz: I really want to kill the existing weird closure-based ones
[05:53:42] <klutzy> cmr: there is no __gxx_personality_v0 function in mingw-w64, if it doens't built with dwarf2
[05:54:19] <strcat> cmr: LLVM basically doesn't support unwinding on windows
[05:54:22] <strcat> table-based unwinding
[05:54:23] <klutzy> cmr: maybe the patch can be dropped off if I use dw2 mingw64, although not tested
[05:54:33] <cmr> klutzy: no, that's fine
[05:54:35] <bjz> strcat: so I do: src.repr().data as *libc::c_char?
[05:54:57] <strcat> bjz: I think you might have to take a ref to the data field, but yeah
[05:55:04] <strcat> so you might need 2 casts
[05:55:05] *** Quits: alisdair (textual@4D086FCF.DFA2E3D3.C3C3A9D0.IP) (Ping timeout)
[05:55:16] <bjz> what do you mean by that?
[05:55:22] <strcat> &foo.data as *u8 as *c_char
[05:55:29] <strcat> it doesn't like casting in more than one way at once
[05:55:47] <bjz> oh really
[05:55:59] <bjz> maybe that's another issue I'm having
[05:56:23] <bjz> in another place I have let mut ptr = atts as **libc::c_char;
[05:56:25] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:56:26] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/2qfqAA
[05:56:26] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:56:38] <bjz> strcat: would I need to change that?
[05:56:46] <strcat> bjz: dunno
[05:56:51] <strcat> oh look the snapshot landed
[05:57:27] *** Quits: igl1 (igl@moz-9684347A.adsl.alicedsl.de) (Ping timeout)
[05:57:39] <cmr> http://huonw.github.io/isrustfastyet/buildbot/all
[05:57:54] *** Joins: igl (igl@moz-2254D014.adsl.alicedsl.de)
[05:58:07] <cmr> brson: the rtdebug fix brought perf back to normal from the jump removing the c++ runtime
[05:58:11] <cmr> That is extremely confusing though
[05:58:23] <cmr> it shouldn't have been being used
[05:58:47] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[05:58:48] <strcat> the tests are still a lot slower in some cases
[05:59:10] <bjz> strcat:
[05:59:11] <bjz> src/sax.rs:97:39: 97:55 error: mismatched types: expected `*u8` but found `&*u8` (expected u8 but found *-ptr)
[05:59:12] <bjz> src/sax.rs:97                                        &src.repr().data as *u8 as *libc::c_char,
[05:59:12] <cmr> yeah
[05:59:16] <acrichto> strcat: we're not building with --disable-optimized-tests
[05:59:24] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[05:59:25] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/jX-pdw
[05:59:25] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[05:59:26] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[05:59:27] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/3mrrnQ
[05:59:27] <ghrust> 13rust/06auto 14e00e473 15Erick Tryzelaar: Deny warnings in stage1+ libsyntax/librustc/librustdoc/librusti/librust
[05:59:27] <ghrust> 13rust/06auto 1441e52e1 15Erick Tryzelaar: Deny warnings in tests
[05:59:27] <ghrust> 13rust/06auto 1453fdb3d 15bors: auto merge of #8441 : erickt/rust/deny-warnings, r=erickt...
[05:59:28] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[05:59:52] <steven_is_false> Is Valgrind's Helgrind expected to spit out a bunch of errors? I read that Helgrind checks multi-threading safety by looking at mutexes, and I think Rust's standard library works at a lower level than that.
[06:00:24] *** Quits: igl (igl@moz-2254D014.adsl.alicedsl.de) (Ping timeout)
[06:00:26] <cmr> steven_is_false: it uses atomics rather than locks in a few places
[06:00:41] <steven_is_false> cmr: Like thread sends?
[06:00:48] <steven_is_false> cmr: And recvs?
[06:01:19] *** Joins: igl (igl@moz-36704C12.adsl.alicedsl.de)
[06:01:30] <brson> cmr: what do you mean 'it shouldn't have been being used'? the c++ rt? I still don't understand what happened there and whether the perf gained from rtdebug is the same perf lost on the c++ rt change
[06:02:06] <brson> cmr: I have one more pr in to pick off some more low hanging fruit, but it won't be nearly as big a win
[06:02:07] <cmr> brson: yeah, the c++ rt
[06:02:16] <cmr> iot's probably not the same perf
[06:02:20] <cmr> *it's
[06:02:22] <cmr> steven_is_false: I don't know.
[06:02:37] <steven_is_false> Fair enough.
[06:03:14] <acrichto> brson: the *-nopt builders described in https://github.com/mozilla/rust/issues/8456 should be able to get set up now
[06:03:36] *** Joins: RMF (RMF@C1DE1C64.ACFAD170.823A4631.IP)
[06:04:43] *** Joins: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net)
[06:05:49] *** Joins: n0v (n0v@29BE42A.39E37E6E.A6DC652B.IP)
[06:06:27] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Quit: Lost terminal)
[06:07:01] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[06:07:53] *** Quits: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net) (Quit: zzz)
[06:08:11] *** Quits: n0v (n0v@29BE42A.39E37E6E.A6DC652B.IP) (Quit: ZNC - http://znc.in)
[06:09:05] *** Joins: n0v (n0v@29BE42A.39E37E6E.A6DC652B.IP)
[06:09:10] *** Joins: alisdair (textual@4D086FCF.DFA2E3D3.C3C3A9D0.IP)
[06:09:43] *** Joins: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP)
[06:10:29] *** Quits: igl (igl@moz-36704C12.adsl.alicedsl.de) (Ping timeout)
[06:10:34] *** Joins: igl (igl@moz-AE3E9A3A.adsl.alicedsl.de)
[06:11:09] *** Parts: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (ERC Version 5.3 (IRC client for Emacs))
[06:12:11] <bjz> rust: let s = "hi".to_c_str().with_ref(|r|r) as std::libc::c_uchar; unsafe { std::str::raw(from_buf_len, 2) }
[06:12:14] <bjz> rusti: let s = "hi".to_c_str().with_ref(|r|r) as std::libc::c_uchar; unsafe { std::str::raw(from_buf_len, 2) }
[06:12:16] -rusti- pastebinned 8 lines of output: http://ix.io/7eS
[06:12:24] <bjz> rusti: let s = "hi".to_c_str().with_ref(|r|r) as *std::libc::c_uchar; unsafe { std::str::raw(from_buf_len, 2) }
[06:12:26] -rusti- pastebinned 8 lines of output: http://ix.io/7eT
[06:12:45] <bjz> rusti: let s = "hi".to_c_str().with_ref(|r|r) as *std::libc::c_uchar; unsafe { std::str::raw::from_buf_len(s, 2) }
[06:12:46] -rusti- ~"\x00\x00"
[06:13:03] *** Joins: igl1 (igl@moz-FBD0F1A2.adsl.alicedsl.de)
[06:13:04] *** Quits: igl (igl@moz-AE3E9A3A.adsl.alicedsl.de) (Ping timeout)
[06:13:17] *** Quits: pcwalton (pcwalton@E2F7352.56080C53.97BBD552.IP) (Quit: pcwalton)
[06:13:21] <strcat> rusti: 222222222222222222222
[06:13:21] -rusti- <anon>:4:12: 4:13 error: int literal is too large
[06:13:21] -rusti- <anon>:4     let r = {
[06:13:21] -rusti-                      ^
[06:13:21] -rusti- application terminated with error code 101
[06:14:50] <bjz> rusti: let s = "hi".to_c_str().with_ref(|r|r); unsafe { std::str::raw::from_buf_len(s as *std::libc::c_uchar, 2) }
[06:14:51] -rusti- ~"\x00\x00"
[06:15:12] <bjz> rusti: let s = "hi".to_c_str().with_ref(|r|r); unsafe { std::str::raw::from_buf_len(s, 2) }
[06:15:13] -rusti- <anon>:5:86: 5:87 error: mismatched types: expected `*u8` but found `*i8` (expected u8 but found i8)
[06:15:13] -rusti- <anon>:5          let s = "hi".to_c_str().with_ref(|r|r); unsafe { std::str::raw::from_buf_len(s, 2) }
[06:15:13] -rusti-                                                                                                ^
[06:15:13] -rusti- error: aborting due to previous error
[06:15:15] -rusti- application terminated with error code 101
[06:15:22] <bjz> rusti: let s = "hi".to_c_str().with_ref(|r|r); unsafe { std::str::raw::from_c_str(s, 2) }
[06:15:22] -rusti- <anon>:5:58: 5:91 error: this function takes 1 parameter but 2 parameters were supplied
[06:15:23] -rusti- <anon>:5          let s = "hi".to_c_str().with_ref(|r|r); unsafe { std::str::raw::from_c_str(s, 2) }
[06:15:23] -rusti-                                                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[06:15:25] -rusti- error: aborting due to previous error
[06:15:27] -rusti- application terminated with error code 101
[06:15:27] <bjz> rusti: let s = "hi".to_c_str().with_ref(|r|r); unsafe { std::str::raw::from_c_str(s) }
[06:15:28] -rusti- ~""
[06:15:28] <cmr> bjz: you really shouldn't let the pointer with_ref returns escape from the closure.
[06:15:35] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[06:15:37] <cmr> It should probably be a borrowed reference.
[06:16:16] <acrichto> engla: https://github.com/mozilla/rust/issues/8489
[06:16:25] <bjz> rusti: unsafe { "hi".to_c_str().with_ref(|r| std::str::raw::from_c_str(r)) }
[06:16:26] -rusti- ~"hi"
[06:17:22] <bjz> rusti: unsafe { "hi".to_c_str().with_ref(|r| std::str::raw::from_buf_len(r as *std::libc::c_uchar, 2)) }
[06:17:23] -rusti- ~"hi"
[06:18:22] *** Joins: mitja (Mibbit@moz-353C1E66.dial-up.dsl.siol.net)
[06:18:25] *** Quits: igl1 (igl@moz-FBD0F1A2.adsl.alicedsl.de) (Connection reset by peer)
[06:19:54] *** Joins: igl (igl@moz-305C9F82.adsl.alicedsl.de)
[06:20:00] <mitja> Does rust have derived types, like Ada?
[06:21:00] <cmr> mitja: we call them newtypes
[06:21:07] <cmr> struct NewType(OldType);
[06:21:34] *** Quits: igl (igl@moz-305C9F82.adsl.alicedsl.de) (Ping timeout)
[06:22:00] *** Joins: igl (igl@moz-F9F268B4.adsl.alicedsl.de)
[06:22:06] *** Quits: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP) (Quit: tautologico_)
[06:25:31] *** Joins: ab (alex@BC9D99CC.37C1012D.FE617B51.IP)
[06:27:01] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Quit: Leaving)
[06:27:25] *** Joins: igl1 (igl@moz-A7F45D52.adsl.alicedsl.de)
[06:27:51] *** Quits: igl (igl@moz-F9F268B4.adsl.alicedsl.de) (Ping timeout)
[06:28:46] *** Quits: recrack (ymin@5AB4884B.FCC4549.14D5B978.IP) (Quit: Lost terminal)
[06:29:19] <mitja> cmr: thanks
[06:29:59] *** Joins: igl (igl@moz-13C24B1F.adsl.alicedsl.de)
[06:30:05] *** Quits: igl1 (igl@moz-A7F45D52.adsl.alicedsl.de) (Ping timeout)
[06:30:27] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[06:33:19] *** Quits: igl (igl@moz-13C24B1F.adsl.alicedsl.de) (Ping timeout)
[06:33:36] *** Joins: igl (igl@moz-696D6D83.adsl.alicedsl.de)
[06:37:55] *** Quits: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP) (Quit: brendan)
[06:39:06] *** Quits: FDS (arnaud@moz-CE4D5907.bdx.modulonet.fr) (Ping timeout)
[06:39:08] *** Quits: igl (igl@moz-696D6D83.adsl.alicedsl.de) (Ping timeout)
[06:39:09] *** Joins: igl (igl@moz-7015E36F.adsl.alicedsl.de)
[06:39:13] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Connection reset by peer)
[06:39:54] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[06:39:55] *** ChanServ sets mode: +o dherman
[06:40:23] *** flaper87|afk is now known as flaper87
[06:40:50] *** Quits: igl (igl@moz-7015E36F.adsl.alicedsl.de) (Ping timeout)
[06:42:18] <cmr> rusti: struct Foo; impl Drop for Foo { fn drop(&self) {} } let x = Foo; { let y = x }; x
[06:42:18] -rusti- <anon>:5:86: 5:87 error: expected `;` but found `}`
[06:42:18] -rusti- <anon>:5          struct Foo; impl Drop for Foo { fn drop(&self) {} } let x = Foo; { let y = x }; x
[06:42:18] -rusti-                                                                                                ^
[06:42:18] -rusti- application terminated with error code 101
[06:42:23] <cmr> rusti: struct Foo; impl Drop for Foo { fn drop(&self) {} } let x = Foo; { let y = x; } x
[06:42:26] -rusti- pastebinned 8 lines of output: http://ix.io/7eV
[06:42:47] <cmr> Is there any word for "thing that can have ownership of an object"?
[06:42:49] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[06:42:53] <strcat> slot
[06:42:54] <strcat> ?
[06:42:58] <cmr> hm
[06:43:08] <cmr> You can move something into a struct, right?
[06:43:14] <strcat> yes
[06:43:19] <cmr> So a struct fields considered slots?
[06:43:23] <cmr> *are
[06:44:11] <strcat> yes
[06:44:15] <cmr> ok
[06:44:34] <strcat> variables (including fn params), struct fields (including ones that are enum variants)
[06:44:55] <strcat> and a @ or ~ would be a slot too, but they are essentially structs
[06:45:11] *** Joins: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com)
[06:45:25] <aatch> Hey, for C-Style enums, the discriminant values are defined, right?
[06:45:30] <cmr> aatch: no
[06:45:32] *** Quits: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com) (Quit: ChatZilla 0.9.90.1 [Firefox 22.0/20130618035212])
[06:45:42] *** Joins: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com)
[06:45:56] <cmr> Well, you can define them, but they are of undefined type.
[06:46:12] <cmr> enum Foo { Bar = 10 } for example
[06:46:27] <aatch> cmr, no? I though they were. I know representation is undefined, but the values are defined.
[06:46:43] <strcat> rusti: enum Foo { B = 2u }
[06:46:43] -rusti- ()
[06:46:45] <cmr> aatch: `Foo` is of undefined representation, how are you going to get the value?
[06:46:45] <strcat> I think it's defined
[06:46:54] <strcat> cmr: I am pretty sure that's defined as an int
[06:46:57] <strcat> rusti: enum Foo { B = 2i8 }
[06:46:58] -rusti- ()
[06:47:01] <aatch> cmr, well it's partially defined.
[06:47:04] <strcat> rusti: enum Foo { B = 2i8 } B + 254
[06:47:04] -rusti- <anon>:5:30: 5:37 error: binary operation + cannot be applied to type `main::Foo`
[06:47:04] -rusti- <anon>:5          enum Foo { B = 2i8 } B + 254
[06:47:05] -rusti-                                        ^~~~~~~
[06:47:05] -rusti- error: aborting due to previous error
[06:47:05] -rusti- application terminated with error code 101
[06:47:09] <strcat> heh
[06:47:18] <strcat> but you can't store arbitrary stuff in it
[06:47:26] <aatch> rusti: enum Foo { B = 2i8 } (B as u32) + 254
[06:47:26] -rusti- 256
[06:47:39] <aatch> rusti: enum Foo { A=0, B } (B as u32) + 254
[06:47:40] -rusti- 255
[06:47:45] <cmr> https://github.com/mozilla/rust/pull/8000 btw
[06:48:16] <aatch> That's the behaviour I care about, btw ^
[06:48:25] <cmr> ok
[06:48:26] <aatch> so I don't have to do 0, 1, 2, 3
[06:48:43] <cmr> I'm pretty sure that is undefined right now, but won't be in the future
[06:50:26] *** Quits: alisdair (textual@4D086FCF.DFA2E3D3.C3C3A9D0.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[06:50:27] *** Joins: victorporof (victorporo@DBFC8886.2203F6DA.D111398B.IP)
[06:52:03] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Connection reset by peer)
[06:52:14] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Input/output error)
[06:52:29] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[06:52:47] *** Quits: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net) (Ping timeout)
[06:54:22] *** Joins: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net)
[06:56:28] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[06:56:28] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1453fdb3d to 1444675ac: 02http://git.io/N3iJvQ
[06:56:28] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[06:56:30] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:56:30] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/rdnWOQ
[06:56:30] <ghrust> 13rust/06auto 1495badab 15Brian Anderson: std: Re-optimize tls access on local allocation path...
[06:56:30] <ghrust> 13rust/06auto 144601ea6 15bors: auto merge of #8487 : brson/rust/local-opts, r=brson...
[06:56:31] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:56:57] <cmr> erickt_: fwiw that probably bounced because someone introduced more warnings...
[07:00:37] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[07:02:10] *** Quits: cdidd (cdidd@moz-7FEB29DB.broadband.corbina.ru) (Ping timeout)
[07:12:17] *** Quits: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com) (Ping timeout)
[07:12:58] *** Joins: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com)
[07:14:55] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[07:16:48] *** Joins: cdidd (cdidd@moz-413B7B85.broadband.corbina.ru)
[07:17:15] *** Joins: jaen (jaen@moz-E38D78E4.neoplus.adsl.tpnet.pl)
[07:21:33] *** Joins: jviereck (Adium@moz-C97F1B76.ethz.ch)
[07:21:59] *** Quits: jviereck (Adium@moz-C97F1B76.ethz.ch) (Quit: Leaving.)
[07:23:56] *** Joins: jviereck (Adium@moz-C97F1B76.ethz.ch)
[07:24:18] *** Quits: jviereck (Adium@moz-C97F1B76.ethz.ch) (Quit: Leaving.)
[07:25:17] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[07:25:23] <doener> acrichto: ping
[07:26:46] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[07:27:43] *** Quits: wilsonk-laptop (kvirc@moz-8E86F35A.cg.shawcable.net) (Connection reset by peer)
[07:28:33] *** Quits: rbancroft (rumble@moz-4E8E0D7F.cg.shawcable.net) (Ping timeout)
[07:28:43] *** Quits: Ralith (ralith@moz-50F3C77.vc.shawcable.net) (Ping timeout)
[07:29:11] *** Joins: wilsonk-laptop (kvirc@moz-8E86F35A.cg.shawcable.net)
[07:29:41] *** Joins: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP)
[07:29:47] *** Joins: Ralith (ralith@moz-50F3C77.vc.shawcable.net)
[07:29:53] *** Quits: tautologico_ (shung@8ABDEDA.34CAB63A.7B974E06.IP) (Quit: tautologico_)
[07:30:06] *** Joins: rbancroft (rumble@moz-4E8E0D7F.cg.shawcable.net)
[07:33:31] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[07:34:41] *** Quits: KindOne (KindOne@moz-4C88E65.dynamic.ip.windstream.net) (Ping timeout)
[07:35:32] *** Quits: tautologico (lymph@8ABDEDA.34CAB63A.7B974E06.IP) (Quit: tautologico)
[07:39:47] *** Joins: KindOne (KindOne@5D57545B.35741547.34F73994.IP)
[07:39:51] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Client exited)
[07:42:02] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[07:42:59] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[07:45:30] *** Joins: fabiand (fabiand@E8248357.5291F4C0.16E13E53.IP)
[07:46:19] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: sleep)
[07:51:02] *** Joins: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr)
[07:52:41] *** Quits: fabiand (fabiand@E8248357.5291F4C0.16E13E53.IP) (Ping timeout)
[07:53:47] *** Joins: fabiand (fabiand@E8248357.5291F4C0.16E13E53.IP)
[07:54:01] *** Quits: eatkinson (eatkinson@moz-5CF47426.dia.static.qwest.net) (Quit: eatkinson)
[08:01:11] *** Joins: huanghongqiao (Mibbit@A4B625EF.4B0BF813.AD584FE1.IP)
[08:01:33] <huanghongqiao> hello, everybody
[08:02:44] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[08:03:50] *** Joins: cypher (ircnet@moz-EA42E471.static.surfer.at)
[08:04:12] *** Quits: fabiand (fabiand@E8248357.5291F4C0.16E13E53.IP) (Ping timeout)
[08:04:31] *** Joins: fabiand (fabiand@E8248357.5291F4C0.16E13E53.IP)
[08:05:18] <huanghongqiao> fn  myloop() {myloop()}  do spawn { myloop(); } 
[08:06:08] <huanghongqiao> it's will get error: rust: task 31aa70 ran out of stack
[08:06:50] <huanghongqiao> This application has requested the Runtime to terminate it in an unusual way. Please contact the application's support team for more information.
[08:06:57] *** Quits: sebcrozet (sebcrozet@moz-C27D92D8.w193-252.abo.wanadoo.fr) (Ping timeout)
[08:07:29] <cmr> huanghongqiao: yes, infinite recursion exhausts the stack rather quickly
[08:07:43] *** Joins: sebcrozet (sebcrozet@moz-F96421F3.w80-13.abo.wanadoo.fr)
[08:07:49] <cmr> The second message is a bug, because task unwinding isn't implement on windows.
[08:08:15] *** Quits: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com) (Ping timeout)
[08:08:31] <aatch> fun fact, if you optimize, it might not infinite loop.
[08:08:58] *** Joins: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com)
[08:09:12] <huanghongqiao> I think  that is tail recursion
[08:09:34] <cmr> Rust does not have tail call optimization.
[08:09:56] <aatch> huanghongqiao, nah, it's because of inlining + LLVM optimizing no-op infinite loops out.
[08:10:13] <aatch> cmr, well, more accurately we don't have guaranteed tco.
[08:11:17] <huanghongqiao> Oh~! I see...
[08:11:18] <aatch> it's something LLVM will do if it can, but you can't assume it will exist. (Unlike, say, scheme, in which it's part of the implementation requirements)
[08:12:43] <aatch> Anyway, the iterbytes deriving impl just loops over the fields in order, right?
[08:14:24] *** Quits: sebcrozet (sebcrozet@moz-F96421F3.w80-13.abo.wanadoo.fr) (Ping timeout)
[08:15:53] <huanghongqiao> the scala language does not support tail recursion too, but the erlang language support , It is so simple and straightforward
[08:16:28] *** Joins: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP)
[08:16:46] <aatch> huanghongqiao, well erlang doesn't have a loop construct, so the only way to loop is via recursion.
[08:17:36] <cmr> TCO is neither simple nor straightforward in a native language
[08:17:43] <aatch> without guaranteed TCO, you could (in theory) run the risk of stack exaustion
[08:18:16] *** Quits: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP) (Quit: brendan)
[08:18:28] <doener> aatch: right
[08:18:49] <aatch> doener, cool, thanks.
[08:20:22] <doener> kind of related: why do we need the re-wrapping of stack closures instead of them being copyable?
[08:20:37] <aatch> re-wrapping?
[08:21:13] <doener> you have a stack closure "let f = |x| x;" which you want to pass to multiple other functions
[08:21:19] *** Joins: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP)
[08:21:28] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[08:21:33] <doener> then you have to do "a(|x| f(x)); b(|x| f(x));"
[08:21:42] <doener> instead of just "a(f); b(f);"
[08:21:57] <doener> i.e. you have to wrap the closure in yet another closure
[08:22:13] <doener> the IterBytes implementations do that
[08:22:16] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:22:27] <doener> creates quite a bunch of anonymous functions
[08:22:30] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[08:22:43] <cmr> doener: that'd be a good question for bblum
[08:22:53] <aatch> doener, as far as I know, it's because stack closures are currently just movable.
[08:23:19] <aatch> But because they capture by reference, it causes all sorts of weirdness.
[08:23:37] <doener> aatch: they were made move-only only recently IIRC
[08:23:46] <doener> I just wonder why.
[08:23:49] <doener> bblum: ping
[08:24:06] *** Quits: fabiand (fabiand@E8248357.5291F4C0.16E13E53.IP) (Ping timeout)
[08:24:07] <aatch> Is there a reason why rust-buildbot is a mod?
[08:24:27] <aatch> rust-buildbot: wassup
[08:24:39] <cmr> rust-buildbot: dance
[08:24:40] <rust-buildbot> <(^.^<)
[08:24:41] <rust-buildbot> <(^.^)>
[08:24:42] <rust-buildbot> (>^.^)>
[08:24:42] <rust-buildbot> (7^.^)7
[08:24:44] <rust-buildbot> (>^.^<)
[08:27:14] *** Joins: sebcrozet (sebcrozet@moz-F96421F3.w80-13.abo.wanadoo.fr)
[08:29:36] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[08:29:50] *** Quits: maik (maik___@moz-122881CA.dip0.t-ipconnect.de) (Ping timeout)
[08:34:20] *** Quits: KindOne (KindOne@5D57545B.35741547.34F73994.IP) (Ping timeout)
[08:35:00] *** Joins: doomlord (doomlod@moz-13E69BC8.range86-180.btcentralplus.com)
[08:36:24] <cypher> Hi everyone. Anyone got time to help me out/explain a lifetime problem to me?
[08:36:58] <aatch> cypher, what's your problem?
[08:37:06] <cypher> aatch, I've got this code: https://gist.github.com/cypher/5a80e2f2fe763ff5d135
[08:37:33] <cypher> Hold on, I'll add the compiler errors to the Gist
[08:37:52] <cypher> Ok, I've updated the Gist
[08:38:01] <cypher> Basically, I want to create a new struct/object that contains a string
[08:38:18] <cypher> But I can't seem to figure out how to tell Rust to either hold on to the string, or automatically create a copy for me
[08:38:23] <aatch> cypher, ok, first, thing. The "bare type" thing is because, well, `str` isn't a type. For strings and vectors, you need to have a &, @ or ~
[08:38:31] <aatch> cypher, you can't
[08:38:38] *** Joins: KindOne (KindOne@CC831BB2.5D2364C3.EC6A1518.IP)
[08:38:46] <aatch> Rust has strong ownership semantics.
[08:39:13] <cypher> Yeah, that I know, but I'm not familiar how exactly they work (or rather, I thought I was, and turns out I'm not)
[08:39:16] <aatch> So you either need to take ownership of the string (which is common if you are storing it immediately) or make a copy.
[08:39:22] <cypher> Ok
[08:39:33] <cypher> How can I do those, and which one would you recommend?
[08:40:00] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[08:40:04] <aatch> cypher, Ok, well the string type in the structs should be '~'
[08:40:22] <aatch> `~str` rather
[08:40:40] <aatch> and the `new` method should take a `~str` too.
[08:40:48] <cypher> ok
[08:40:58] <aatch> This means that the string is moved into the method, then into the struct.
[08:41:08] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[08:41:12] <aatch> If the caller wants a copy still, they need to do that themselves.
[08:41:40] <cypher> Ok
[08:42:14] <aatch> cypher, this also means your to_rna function will work as expected, as map_chars returns a ~str
[08:42:51] <aatch> The only downside is that passing it a literal string requires a leading `~`
[08:42:56] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[08:43:14] <cypher> Ah, I was about to ask, because now I get this error when running the tests: "error: mismatched types: expected `~str` but found `&'static str` (str storage differs: expected ~ but found &'static )"
[08:43:18] <aatch> so `...::new(~"AGC")`
[08:43:19] <cypher> Any way around this?
[08:44:02] <aatch> cypher, not really. You can take a slice (&str) and copy it to a ~str, but that means you always copy.
[08:44:27] <huanghongqiao> i found `~`  is common in rust
[08:44:36] <aatch> The leading ~ on the string is fine in this instance.
[08:44:47] <cypher> Ok
[08:44:55] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[08:44:59] <cypher> Well, now it compiles at least, but the tests all fail :)
[08:45:02] <aatch> since it's actually less copying on average (the caller won't always want to keep a copy)
[08:46:09] <cypher> Ok
[08:46:35] <huanghongqiao> i think `&` is like c language '&'
[08:46:35] <aatch> cypher, you have marked all your tests as should_fail, but as far as I can tell, none of them should be failing.
[08:46:45] <aatch> huanghongqiao, only in one case.
[08:46:52] <cypher> D'oh
[08:47:02] <aatch> which is when it is used as the address-of operator
[08:47:03] <cypher> Thanks. Guess I need more coffee.
[08:47:22] <aatch> cypher, no prob, it's easy to overlook things like that.
[08:47:28] <cypher> Alright, it works now! Thanks for the help
[08:47:58] <cypher> aatch, do you have any suggestions/improvements for the code? It's supposed to be the reference solution on http://exercism.io
[08:48:12] *** Quits: KindOne (KindOne@CC831BB2.5D2364C3.EC6A1518.IP) (Ping timeout)
[08:49:47] <aatch> cypher, what exercise?
[08:50:17] <aatch> (And I assume you mean specifically the reference solution /for/ rust?)
[08:50:21] *** Joins: mmmonk (mmmonk@moz-F145F0FF.xlshosting.net)
[08:51:49] <cypher> yes, the reference solution for Rust
[08:52:17] *** Joins: KindOne (KindOne@moz-D2A3BB41.dynamic.ip.windstream.net)
[08:52:25] <cypher> Here's the same example in Ruby: https://github.com/kytrinyx/exercism.io/tree/master/assignments/ruby/rna-transcription
[08:52:46] <huanghongqiao> Ruby...
[08:53:10] <aatch> cypher, ok. So for a start, you can use the #[deriving(...)] attribute to automatically derive Eq
[08:53:14] <cypher> Basically, you get the test file, along with a README. And in this case, you're supposed to write two classes (or whatever is appropriate in the given language) to convert between DNA and RNA, with the nucleotides given as a string
[08:53:41] <cypher> And all you have to do to convert DNA to RNA is replace all occurrences of "T" with "U"
[08:53:44] <cypher> ok
[08:54:18] *** Quits: KindOne (KindOne@moz-D2A3BB41.dynamic.ip.windstream.net) (Ping timeout)
[08:54:28] <aatch> cypher, so that just means putting #[deriving(Eq)] on the struct
[08:54:53] <cypher> ok
[08:55:08] <cypher> I'm guessing that basically recreates the same code I wrote by hand?
[08:55:18] <aatch> cypher, yep
[08:55:32] <cypher> Is there a similar thing for ToStr?
[08:55:38] <aatch> there's a whole suite of things for it.
[08:55:47] <cypher> Also, am I doing "the right thing" in my ToStr implementation?
[08:56:13] <aatch> cypher, assuming that's what you want, yes
[08:56:40] <cypher> Well, I want to return a copy of the nucleotides as a new string, with ownership transferred to the callee
[08:57:09] <aatch> cypher, that's what happening.
[08:57:17] <cypher> Excellent :)
[08:57:23] <aatch> If you're returning a ~str, then it's moved
[08:57:25] *** Joins: true_droid (true_droid@moz-123FD9B8.beck.volia.net)
[08:57:34] <cypher> Ok
[08:58:26] <aatch> most of the time values are moved, instead of being copied. Implicitly copyable types will be copied though
[08:58:36] <cypher> ok
[08:59:02] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[08:59:17] <aatch> anything with ~ or something implementing Drop will be moved.
[09:00:46] *** Joins: donri (dag@moz-9BB61102.tbcn.telia.com)
[09:01:05] <cypher> Ok.
[09:08:20] *** Joins: sigma (sigma@moz-5022C87F.range109-151.btcentralplus.com)
[09:11:18] *** Joins: maik (maik___@moz-122881CA.dip0.t-ipconnect.de)
[09:11:25] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[09:11:25] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/rdnWOQ
[09:11:25] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[09:12:47] *** Joins: KindOne (KindOne@moz-D2A3BB41.dynamic.ip.windstream.net)
[09:14:25] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[09:14:25] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/lFtcKQ
[09:14:25] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[09:14:27] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[09:14:27] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/p2bqdg
[09:14:27] <ghrust> 13rust/06auto 14dcecc66 15Steven Stewart-Gallus: Cleanup librustpkg a little bit....
[09:14:27] <ghrust> 13rust/06auto 14c99b2b9 15bors: auto merge of #7866 : sstewartgallus/rust/clean, r=cmr...
[09:14:28] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[09:16:30] <cypher> aatch, if I use #[deriving(Eq)], I get a whole lot of errors: https://gist.github.com/cypher/5a80e2f2fe763ff5d135
[09:16:40] <cypher> Using my own implementation of Eq works fine
[09:17:28] *** Quits: KindOne (KindOne@moz-D2A3BB41.dynamic.ip.windstream.net) (Ping timeout)
[09:19:12] <cypher> D'oh. Nevermind. It helps if I put it in the right place ;)
[09:19:35] <aatch> cypher, heh
[09:21:26] *** Joins: KindOne (KindOne@9134C84A.2171A688.34F73994.IP)
[09:22:17] *** Quits: robertknight (robertknig@moz-85C86086.range81-151.btcentralplus.com) (Ping timeout)
[09:26:22] <cypher> Is there a dictionary/hashmap type in Rust?
[09:26:32] <aatch> cypher, yep
[09:26:42] <aatch> cypher, std::hashmap::HashMap
[09:26:51] <cypher> ah, excellnt, thanks
[09:26:53] <aatch> is a secure hashmap.
[09:26:56] <dbaupp> (there's a whole pile of other maps too.)
[09:27:08] <dbaupp> e.g. extra::treemap, std::trie
[09:27:12] <aatch> There's also extra::treemap::TreeMap if you need to maintain the order
[09:27:37] <aatch> (but normally HashMap is all you want)
[09:29:15] *** Joins: sk (sk@A8E15A9E.F427598.78DD174B.IP)
[09:34:58] <huanghongqiao> I'm off work now,haha
[09:36:12] *** Quits: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net) (Quit: Leaving)
[09:39:58] *** Joins: fabiand (fabiand@moz-F49693AB.adsl.alicedsl.de)
[09:44:19] <cypher> No, order isn't important. But I guess there's no "inline syntax" for the HashMap? (similar to Ruby/Python)
[09:53:08] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[09:58:55] <Luqman> cypher: what do you mean by inline syntax?
[09:59:00] *** Quits: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP) (Ping timeout)
[09:59:43] *** Quits: fabiand (fabiand@moz-F49693AB.adsl.alicedsl.de) (Quit: Verlassend)
[09:59:52] *** Joins: fabiand (fabiand@moz-F49693AB.adsl.alicedsl.de)
[09:59:58] <cypher> Luqman, e.g. `let my_hashmap = { "a string" => 1, "another string" => 42 };`, and Rust would automagically figure out I want a `HashMap<~str, int>`, and fill it with those two pairs
[10:00:39] <cypher> Right now, I think I have to do a HashMap::new(), then `find_or_insert` twice to get the same thing
[10:01:15] *** Joins: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[10:07:57] <huanghongqiao> If I want a task always runs, how can i do it
[10:09:22] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[10:10:34] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:11:10] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Ping timeout)
[10:15:02] *** Joins: Palmik (palmik@moz-CC484FDD.tmcz.cz)
[10:15:49] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[10:16:11] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[10:19:05] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[10:19:15] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[10:20:45] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[10:23:25] *** Joins: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se)
[10:23:56] *** Quits: maik (maik___@moz-122881CA.dip0.t-ipconnect.de) (Ping timeout)
[10:24:42] *** Quits: huanghongqiao (Mibbit@A4B625EF.4B0BF813.AD584FE1.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:25:45] *** kimundi is now known as zz_kimundi
[10:27:13] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[10:27:26] *** Joins: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:27:29] *** Quits: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Client exited)
[10:28:31] *** Quits: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP) (Quit: brendan)
[10:29:17] *** Joins: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP)
[10:30:48] *** Joins: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au)
[10:31:26] *** Quits: rntz_ (rntz@moz-C76A8D96.sp.cs.cmu.edu) (Ping timeout)
[10:31:29] *** Quits: acrichto (acrichto@moz-17CABEB0.wv.cc.cmu.edu) (Ping timeout)
[10:31:32] *** Quits: mjrosenb|ARM (mjrosenb@moz-B3592BDA.club.cc.cmu.edu) (Ping timeout)
[10:31:45] *** Quits: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu) (Ping timeout)
[10:31:45] *** Quits: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu) (Ping timeout)
[10:32:03] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Ping timeout)
[10:32:10] *** Quits: maxli (maxli@B5559308.9C54E60.2FA4EA88.IP) (Quit: Leaving.)
[10:36:33] <Luqman> cypher: https://gist.github.com/luqmana/6219956
[10:37:00] <cypher> Luqman, oh, nice, thanks!
[10:37:12] *** Quits: mitja (Mibbit@moz-353C1E66.dial-up.dsl.siol.net) (Quit: http://www.mibbit.com ajax IRC Client)
[10:37:37] <Luqman> cypher: so yea, you can just copy that macro and then use hash! { key => value }
[10:45:59] <cypher> Very nifty, thanks
[10:46:27] *** Joins: maik (maik___@moz-122881CA.dip0.t-ipconnect.de)
[10:47:28] *** Joins: rntz_ (rntz@moz-C76A8D96.sp.cs.cmu.edu)
[10:47:47] *** Joins: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu)
[10:47:47] *** Joins: bblum (bblum@moz-2B41ACB5.andrew.cmu.edu)
[10:47:58] *** Joins: mjrosenb|ARM (mjrosenb@moz-B3592BDA.club.cc.cmu.edu)
[10:48:04] *** Joins: acrichto (acrichto@moz-17CABEB0.wv.cc.cmu.edu)
[10:49:21] *** Joins: quasisphere (btw@DC685DC2.94302614.1D0D91FF.IP)
[10:49:39] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[10:52:19] *** Joins: Ms2ger (Ms2ger@moz-3E74B52D.adsl-dyn.isp.belgacom.be)
[10:52:34] *** Joins: Earnestly (earnest@B0BDF733.8FDE20A.5411983D.IP)
[10:58:44] <Luqman> cypher: https://gist.github.com/luqmana/6219956 made it also work with an existing hashmap
[11:04:56] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[11:23:10] *** Joins: reuben (reuben@moz-DB4A9C19.scl3.mozilla.com)
[11:24:03] <reuben> mcpherrin: oakwood has speedqueen washer machines. the cards were these ones: http://www.washlaundry.com/property-manager-owner/card-systems
[11:24:07] *** Parts: reuben (reuben@moz-DB4A9C19.scl3.mozilla.com) (Textual IRC Client: www.textualapp.com)
[11:27:10] *** Joins: robertknight (robertknig@moz-90F4A0C8.range81-159.btcentralplus.com)
[11:28:49] *** Quits: jen (jen@moz-3388A3B.dip0.t-ipconnect.de) (Ping timeout)
[11:32:29] *** Joins: jen (jen@moz-3388A3B.dip0.t-ipconnect.de)
[11:37:29] *** Quits: jen (jen@moz-3388A3B.dip0.t-ipconnect.de) (Ping timeout)
[11:41:00] *** Joins: jen (jen@moz-3388A3B.dip0.t-ipconnect.de)
[11:42:03] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Quit: ChatZilla 0.9.90.1 [Firefox 24.0/20130806170643])
[11:49:03] *** Joins: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de)
[11:49:59] *** Quits: maik (maik___@moz-122881CA.dip0.t-ipconnect.de) (Ping timeout)
[11:51:51] *** Joins: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu)
[11:54:11] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[11:56:26] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[11:56:26] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/p2bqdg
[11:56:26] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[11:59:02] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[11:59:14] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[11:59:22] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[11:59:22] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/VkBk4w
[11:59:22] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[11:59:22] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[11:59:23] <ghrust> 01[13rust01] 15bors pushed 6 new commits to 06auto: 02http://git.io/mpWLNQ
[11:59:23] <ghrust> 13rust/06auto 14ee5cfb0 15Ben Blum: Don't use unkillable in UnsafeArc dtor when there's no unwrapper. Close #8382.
[11:59:23] <ghrust> 13rust/06auto 14c8c09d4 15Ben Blum: Reorganise Select traits to not expose internal runtime types. Close #5160. Pending #8215.
[11:59:23] <ghrust> 13rust/06auto 1431f9b51 15Ben Blum: Make cell with_ref/with_mut_ref use finally. Close #7975.
[11:59:25] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[12:06:59] *** Quits: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de) (Ping timeout)
[12:11:25] *** Joins: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk)
[12:15:00] *** Joins: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de)
[12:19:09] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[12:19:32] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[12:21:14] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[12:23:15] *** Joins: samx (sami@moz-48EC0983.dyn.optonline.net)
[12:23:51] *** Quits: samx (sami@moz-48EC0983.dyn.optonline.net) (Quit: This computer has gone to sleep)
[12:24:12] *** Quits: acrichto (acrichto@moz-17CABEB0.wv.cc.cmu.edu) (Ping timeout)
[12:29:49] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[12:29:56] *** Quits: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu) (Input/output error)
[12:30:47] *** Joins: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu)
[12:31:23] *** Quits: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu) (Input/output error)
[12:36:00] *** Joins: miloshadzic (miloshadzi@5E9C7FE4.FA4D0618.449B8A48.IP)
[12:37:08] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[12:42:53] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[12:43:51] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[12:45:14] *** Joins: Florob (Florob@moz-39532932.de)
[12:48:27] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Leaving.)
[12:51:15] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[12:51:42] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[12:56:52] *** Quits: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de) (Ping timeout)
[13:01:23] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[13:05:59] <SimonSapin> Any idea what Iâ€™m doing wrong to get link-time "undefined reference" errors but the compiler does not complain? http://pastebin.mozilla.org/2846776
[13:07:15] <dbaupp> SimonSapin: the things may not have `pub` on them?
[13:07:23] <dbaupp> (there's a few bugs related to that.)
[13:07:29] <SimonSapin> dbaupp: shouldnâ€™t the compiler catch that?
[13:07:36] <dbaupp> yeah... bugs :P
[13:08:22] <dbaupp> I think the bugs are about illegally using things inside a non-pub mod, so that might be the cause.
[13:09:20] <dbaupp> SimonSapin: e.g. https://github.com/mozilla/rust/issues/8478
[13:09:44] <SimonSapin> dbaupp: I have public stuff in non-public modules, re-exported by the crateâ€™s top level
[13:10:42] <SimonSapin> but I get "undefined reference" for only two of the dozen or so functions like this!
[13:10:54] *** Joins: richard|s (mindginati@moz-268511E5.dsl.dyn.ihug.co.nz)
[13:10:57] <dbaupp> oh
[13:11:06] <dbaupp> I think that pub use like that is unreliable too :(
[13:11:28] <SimonSapin> indeed, making the relevant modules pub works
[13:12:03] <SimonSapin> even though Iâ€™m using the re-exported name, and still using other re-exported functions form other non-pub modules
[13:12:37] <SimonSapin> Iâ€™ll just make everything public, but this is, letâ€™s say "unfortunate"
[13:12:56] <dbaupp> yep :(
[13:14:34] <doomlord_> r.e. the restriction on impl on a type outside the crate .. thats to prevent libraries clashing? ... would it work if that was just a warning when compiling a standalone porgram, and an error when compiling a library
[13:15:51] *** Joins: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de)
[13:15:56] <doomlord_> oh i guess you could still get link failiures when you bring other libraries into your standalone program, but you can deal with that yourself
[13:16:31] *** Quits: richard|s (mindginati@moz-268511E5.dsl.dyn.ihug.co.nz) (Quit: brb)
[13:16:50] <dbaupp> doomlord_: yeah, it's a "problem" with Haskell; the open-world assumption
[13:17:22] <dbaupp> (it's a consequence of sensible design decisions, so it's not exactly/always a problem.)
[13:18:02] <doomlord_> are you saying open world is a problem , or "problem" as in not a problem :)
[13:18:16] <dbaupp> doomlord_: in any case, you can't deal with it yourself; you literally cannot use two libraries both impling the same trait for the same type.
[13:18:36] <doomlord_> ^^ but my suggestion is: its still an error when you compile a *library*
[13:18:39] <dbaupp> the OWA is a semi-problem: sometimes it's a problem, but the flexibility is nice
[13:19:13] <dbaupp> yes, but it means that you can have 2 libraries which are entirely incompatible, just because they impl a certain trait for a certain type.
[13:20:22] <dbaupp> so it's not resolvable at any time (compile-, link- or run-time.), other than some fanciness with specifying which impl to use, or actually going and editing one or both of the libraries to remove the duplicate impl
[13:20:35] <doomlord_> what i'm suggesting keeping it an error to impl for another crates' types in a *library* .... but just a warning in a standalone program
[13:20:51] <dbaupp> oh
[13:21:10] <doomlord_> i realise thats different rules depending how its compiled but ...
[13:21:16] <dbaupp> that would be workable, I guess; although it'd be a strange inconsistency.
[13:21:35] <doomlord_> (a) it would keep people using the same types more - more able to read eachothers code, more likely to learn & actively use the existing types
[13:21:46] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[13:22:03] <doomlord_> no (b) sorry i sumarised 
[13:22:56] <doomlord_> For me its the #1 reason for looking into rust, the more open-world promise compared to C++
[13:23:31] <doomlord_> i dont know how that relates to other users... but perhaps you'd get more 'converts' this way..
[13:23:55] <doomlord_> in my current work i was finding myself still wanting to make my own types so i can extend them more easily
[13:25:01] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[13:25:38] <pnkfelix> doomlord_: I wouldn't be thrilled with thatâ€¦ it would impede breaking an existing program into piecesâ€¦
[13:26:26] <doomlord_> well when breaking it into libraries that you want to share with others, the impl clash matters
[13:27:20] <doomlord_> the #1 reason for NIH for me is if i'm making my own types, i can put my own conviniences in that suit me ... open world would be the only way to solve that
[13:27:42] <pnkfelix> "NIH" â€¦ "Not Invented Here" ?
[13:27:49] <doomlord_> yes , the tendancy to re-write code
[13:28:26] <doomlord_> the tendancy to make ones' own implementations of existing things. The instinct comes from a fear of another person having control over what you're doing really, and discoverability.
[13:28:41] <doomlord_> its easier to write code than read it.
[13:28:44] <pnkfelix> sure
[13:28:56] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[13:29:00] <pnkfelix> I'm not sure I agree that "open world would be the only way to solve that"
[13:29:13] <pnkfelix> but I probably haven't grasped your argument
[13:29:25] <doomlord_> yeah there's more i could ramble about here
[13:29:41] <doomlord_> i'm utterly burned by the experience of this in my last workplace, i'm a very bitter person :)
[13:30:17] <doomlord_> over 10+ years whilst one underlying hardware type remained identical (aligned float 4)
[13:30:17] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[13:30:43] <doomlord_> the closed world design of C++ meant multiple incompatable libraries being written, and entire source bases being trashed
[13:30:59] *** Quits: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org) (Ping timeout)
[13:30:59] <doomlord_> it got called a "bikeshed issue".  i would say its more like deciding what brick to use
[13:31:13] <doomlord_> build something with the wrong brick, and you have to tear it down and rebuild it
[13:31:27] <doomlord_> and thats exactly what happened, 4+ times over 10+ years
[13:32:00] *** Joins: mitsuhiko (mitsuhiko-@moz-BC29B73E.srv.pocoo.org)
[13:32:10] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[13:32:14] <doomlord_> at one point the boss decreed "we must have the same maths type everywhere", which resulted in 2 incompatable sources being thrown away, but 3 years later the  standardized type also thrown away, because it was deemed to have introduced more problems
[13:32:19] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[13:32:28] <doomlord_> so we went from 2 incompatable types in parallel to 2 incompatable types in series
[13:32:45] <pnkfelix> doomlord_: okay, I think many of us have experienced problems like this
[13:33:29] <pnkfelix> doomlord_: I guess my question is whether the standard coding pattern to work-around this particular issue in Rust
[13:33:59] <pnkfelix> doomlord_: â€¦ is that really as bad as the scenarios you encountered in C++ land
[13:34:04] <pnkfelix> doomlord_: ?
[13:34:06] *** Joins: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP)
[13:34:08] <doomlord_> struct/trait/impl IS already a step forward i think, i can at least make a new trait
[13:35:25] <doomlord_> but its still a bit more naming and noise ... you can end up with a lot of 1line traits
[13:35:45] <doomlord_> 1 trait for 1 function.. un-necasery symbols
[13:38:49] <doomlord_> if i want to encourage contributors to a project.. or write code that someone else can pick up and extend later, would it be a lesser evil to have 'leaf-only' code .. something that can't be integrated into a library because i extended some existing classes, but its got fewer extraneous symbols . opensource /git means the ability to collaborate on a lot of small shared sources . Tools like bindgen
[13:39:44] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[13:40:46] <doomlord_> One of the most appealing ideas on this i've seen is D's "extention methods"
[13:41:37] <doomlord_> sorry D's  **uniform call syntax** ... you can just call any function  a.foo(b) .   Quite a bit of the reason for 'methods' is the lack of nesting when you chain, and discoverabiltiy in an IDE.
[13:41:45] *** Joins: tikue (tkuehn@moz-F4812C6E.hsd1.fl.comcast.net)
[13:41:51] *** Quits: Kauhsa (kauhsa@moz-A78B2D1A.fi) (Ping timeout)
[13:42:03] *** Joins: Kauhsa (kauhsa@moz-A78B2D1A.fi)
[13:42:11] <doomlord_> IMO people want methods instead of functions because.. you get a nice drop box of completions. that should be orthogonal to program organization
[13:42:35] *** Joins: milinda (milinda@DA212585.7CFC0820.51B6877.IP)
[13:43:20] <nmatsakis> any news on a snapshot?
[13:43:20] <xlq> doomlord_: Unlike Ada, where you (at least originally) always do the symmetric foo(a, b), even if one parameter is dispatching.
[13:43:27] *** Quits: tikue (tkuehn@moz-F4812C6E.hsd1.fl.comcast.net) (Ping timeout)
[13:44:18] <bstrie> doomlord_: I feel like UFCS would actually greatly complicate IDE method-completion... rather than just having to list all them methods on a type, you'd have to iterate through every single function in scope and check to see if the type of the first argument matches
[13:44:23] <bstrie> but maybe that's not a big deal in practice
[13:44:43] <dbaupp> nmatsakis: one landed ~6 horus ago, I think
[13:44:45] <dbaupp> *hours
[13:44:48] <nmatsakis> dbaupp: woohoo
[13:45:00] <doomlord_> yeah the dispatching syntax is something of a double edge sword, but whilst in C++ i'm used to it being somethign i look over (i thikn of functions and methods the same, i dont use vtables often).. in Rust it does have more importance because you only get the compile-time overloading on the receiver
[13:45:17] <nmatsakis> we do plan to implement a version of "uniform method call" syntax)
[13:45:26] <nmatsakis> I'm not really following this thread so forgive me if that's not apropos
[13:46:09] <bstrie> nmatsakis: except the other way around... if you define a method, we'd let you call it as a function. opposite to what D does. and wouldn't address doomlord_'s note about having to define lots of very small traits to extend things
[13:46:19] <doomlord_> bstrie - is that really much different, you still have to 'scan things from different sources'
[13:46:32] <bstrie> but honestly I'm fine with how it works currently
[13:47:06] <dbaupp> bstrie: I think UFCS is mostly because people get annoyed with .map(|x| x.clone()) rather than .map(clone)?
[13:47:10] <doomlord_> well i'm still using the language and enjoying it so nothing as it stands is disasterous
[13:47:11] <nmatsakis> bstrie: right
[13:47:41] <nmatsakis> dbaupp: that case would work fine with the proposal
[13:47:45] <bstrie> dbaupp: I don't see how that example would be possible?
[13:47:54] <nmatsakis> should be, I would think
[13:48:01] <nmatsakis> you'd do vec.map(Clone::clone)
[13:48:04] <dbaupp> bstrie: (I know no details of it.)
[13:48:09] <bstrie> how would .map() know what to do with clone?
[13:48:38] <bstrie> hm, I guess it might work
[13:48:41] *** Quits: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de) (Ping timeout)
[13:48:49] <bstrie> if it just does `f(x)`
[13:48:58] <bstrie> because it knows there's always one parameter to the input function
[13:49:11] <doomlord_> unlike D you have more justification for the asymetry, because you dont overload on all the parameters (as far as i know). the first parameter really is special
[13:49:24] <dbaupp> bstrie: A method Self.foo(X,Y,Z) would get autoborrowed to &fn(Self,X,Y,Z), I guess?
[13:49:26] <doomlord_> ^ the asymetry of a method call, a.foo(b) vs foo(a,b)
[13:50:01] *** Quits: Palmik (palmik@moz-CC484FDD.tmcz.cz) (Quit: Lost terminal)
[13:50:32] <bstrie> I still think I prefer the look of `map(|x| x.clone())` to `map(clone)` or `map(Clone::clone)`
[13:50:45] <dbaupp> what time does graydon normally come back on here?
[13:50:56] <bstrie> in any case, that seems like a backwards-compatible change. no hurry on pushing it through
[13:51:29] <bstrie> dbaupp: three hours from now-ish?
[13:51:47] <nmatsakis> rusti: fn clone<A:Clone>(a: &A) -> A { a.clone() } let x = ~[1,2,3]; x.iter().map(clone).collect::<~[int]>()
[13:51:48] -rusti- ~[1, 2, 3]
[13:51:54] <nmatsakis> dbaupp: bstrie: ^
[13:52:05] <nmatsakis> that's more-or-less equivalent to what UMC syntax should permit
[13:52:08] <bstrie> I guess it does look sort of nice :)
[13:52:22] <myname> why do you need iter() for this?
[13:52:33] <bstrie> myname: map is defined on iterators
[13:52:40] <bstrie> so you have to turn your vector into an iterator
[13:52:42] <myname> ah
[13:52:42] <nmatsakis> we should probably have a short-cut version on vectors
[13:52:48] <nmatsakis> or something
[13:52:50] <dbaupp> bstrie: (thanks, I'll not wait then.)
[13:52:59] <doomlord_> heh thats something i want to make an extention trait for myself :)
[13:53:08] <bstrie> nmatsakis: if a lot of people do the `.iter().map().collect()` dance, yeah
[13:53:09] <dbaupp> nmatsakis, myname: we do have ~[].map -> ~[]
[13:53:23] *** Joins: Azdle (Azdle@moz-B334B496.hfc.comcastbusiness.net)
[13:53:24] <dbaupp> we also have Iterator.map -> Iterator
[13:53:26] <nmatsakis> dbaupp: oh, cool. I confess I haven't been following the various changes in detail :)
[13:53:31] <doomlord_> x.map( ...) . collect().      only specficy an iterator if i *dont* want the default, forward iterator over the whole collection
[13:53:35] <nmatsakis> rusti: fn clone<A:Clone>(a: &A) -> A { a.clone() } let x = ~[1,2,3]; x.map(clone)
[13:53:36] -rusti- ~[1, 2, 3]
[13:53:40] <nmatsakis> somewhat shorter
[13:53:43] <myname> bstrie: the bigger question should be: why aren't vectors iterators?
[13:53:59] <nmatsakis> myname: because an iterator has state (how far have you iterated?)
[13:54:09] <doomlord_> ^^^ Thats how i did my own implementation of functional programming in C++ - chainable "lazy collections"
[13:54:13] <doomlord_> not iterators
[13:54:31] <bstrie> rusti: [1,2,3].iter()
[13:54:33] -rusti- pastebinned 15 lines of output: http://ix.io/7fi
[13:54:38] <bstrie> rusti: [1i,2,3].iter()
[13:54:40] -rusti- pastebinned 15 lines of output: http://ix.io/7fj
[13:54:48] <dbaupp> myname: &[] *could* be the implementation of the vec iterator, but it's represented by (ptr, len) rather than (start ptr, end ptr), so it'd slower than it should be.
[13:54:49] <bstrie> bleh :P
[13:54:51] <doomlord_> i set somethign up where you could write   "foo.filter(..).map(..).do() "  (do being 'collect' / 'to_owned_vec' really)
[13:54:55] <nmatsakis> bstrie: the iterator holds a region pointer, so you can't print it out like that
[13:55:08] <dbaupp> rusti: printfln!([1i,2,3].iter())
[13:55:12] -rusti- pastebinned 23 lines of output: http://ix.io/7fl
[13:55:23] <dbaupp> :(
[13:55:40] <bstrie> hitting the implementation details of rusti
[13:55:42] <dbaupp> nmatsakis: is fixing that on your near-term list? :)
[13:55:43] <bstrie> I think
[13:55:44] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[13:55:55] <dbaupp> nmatsakis: (lifetimes of temporaries)
[13:56:06] <dbaupp> rusti: let v = [1i,2,3]; printfln!(v.iter())
[13:56:06] -rusti- {ptr: (0x7faaeb80f010 as *()), end: (0x7faaeb80f028 as *()), lifetime: &1}
[13:56:07] -rusti- ()
[13:56:11] *** Joins: huanghongqiao (Mibbit@3C680082.93A8C231.B33D3324.IP)
[13:56:29] <nmatsakis> dbaupp: I was thinking that with iterators it's become a real pain point, I will look some at it today I think,
[13:56:35] <nmatsakis> dbaupp: however, this particular problem is not tied to temporaries
[13:56:52] <dbaupp> nmatsakis: bstrie's one? yeh
[13:56:56] <nmatsakis> right
[13:57:06] <dbaupp> I mean:
[13:57:11] <dbaupp> rusti: printfln!([1i,2,3].iter())
[13:57:12] <nmatsakis> I know that it's a pain otherwise though
[13:57:13] -rusti- pastebinned 23 lines of output: http://ix.io/7fl
[13:57:21] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[13:57:48] <bstrie> what's that "lifetime" field in the iterator struct?
[13:57:55] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[13:58:09] <bstrie> let x = [1,2,3]; printfln!(x.iter());
[13:58:14] <bstrie> sigh
[13:58:17] <bstrie> rusti: let x = [1,2,3]; printfln!(x.iter());
[13:58:18] <dbaupp> to allow VecIterator to be associated with the lifetime of the vector it comes from
[13:58:18] -rusti- {ptr: (0x7febe6b68010 as *()), end: (0x7febe6b68028 as *()), lifetime: &1}
[13:58:18] -rusti- ()
[13:58:19] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[13:58:26] <nmatsakis> bstrie: I think that's a workaround that's just used to give the type system something to tie the lifetime to, since the actual impl uses unsafe ptrs
[13:58:41] <bstrie> myname: ^ as we have at last laboriously demonstrated, iterators are a struct with data inside about the iteratee
[13:58:43] <nmatsakis> bstrie: if I would get around to fixing some shortcomings in the lifetime type checker, it wouldn't be needed :)
[13:59:37] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[13:59:49] <doomlord_> ^^ is that  an issue where one has to sometimes assign a temporary to a local to avoid an error message "borrowed value does not live long enough" 
[14:00:02] <doomlord_> (i sometimes run into that)
[14:00:16] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[14:00:40] <huanghongqiao> If I want a task always runs, how can i do it?
[14:00:44] <dbaupp> doomlord_: yes
[14:00:57] <dbaupp> huanghongqiao: what does "always runs" mean in this context?
[14:01:08] <xlq> huanghongqiao: Strap firecrackers to its leg.
[14:01:11] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[14:01:33] <dbaupp> huanghongqiao: it runs immediately when your program starts up? or it runs no matter what happens to any other tasks?
[14:01:46] <huanghongqiao> keep a task moving on
[14:02:24] <dbaupp> `do spawn { loop { foo(); bar(); } }` ?
[14:04:30] <huanghongqiao> do spawn {loop()} , and the lopp() not stop
[14:05:08] <dbaupp> rusti: do spawn { for _ in range(0, 10) { println("foo") } }
[14:05:10] -rusti- pastebinned 11 lines of output: http://ix.io/7fq
[14:05:17] <dbaupp> huanghongqiao: ^
[14:05:45] <dbaupp> replace `for _ in range(0, 10)` with just `loop` for an infinite loop
[14:05:51] <huanghongqiao> :/sorry,my english is weak....
[14:05:54] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[14:06:02] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[14:06:06] <dbaupp> do spawn { loop { println("foo") } }
[14:06:19] <ChrisMorgan> If you mean that you don't want it to fail if something else fails, you want task::spawn_unlinked.
[14:06:37] <dbaupp> huanghongqiao: `do spawn { loop { println("foo") } }` prints "foo" without stopping
[14:06:43] *** Quits: z0w0 (zack@moz-E12708D5.lns6.woo.bigpond.net.au) (Client exited)
[14:07:11] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[14:07:22] <huanghongqiao> let me try
[14:10:13] *** Quits: milinda (milinda@DA212585.7CFC0820.51B6877.IP) (Input/output error)
[14:10:16] *** Quits: jaen (jaen@moz-E38D78E4.neoplus.adsl.tpnet.pl) (Ping timeout)
[14:10:41] *** Joins: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net)
[14:12:21] *** Joins: milinda (milinda@DA212585.7CFC0820.51B6877.IP)
[14:12:21] <huanghongqiao> yes,  it can work
[14:13:51] <huanghongqiao> ChrisMorganï¼š i want to test hao many task dose Rust can spawn...
[14:14:29] <ChrisMorgan> Oh... that's more like `loop { do spawn { loop() } }`. But that's silly :-)
[14:14:32] <dbaupp> for i in count(0,1) { do spawn { printfln!(i); loop {} } }
[14:15:26] *** Joins: mrordinaire (Mibbit@1A659656.A607747.FD383126.IP)
[14:15:40] <dbaupp> (sorry, `std::iterator::count(0,1)`.)
[14:15:52] <huanghongqiao> what's the best way
[14:15:52] <mrordinaire> rusti: [1,2,3].map(|&x| { x * 2 })
[14:15:53] -rusti- ~[2, 4, 6]
[14:16:50] <mrordinaire> rusti: [1,2,3].map(|&x| { x * 2 }).fold(0, |x, acc| { x + acc })
[14:16:52] -rusti- pastebinned 8 lines of output: http://ix.io/7fr
[14:17:09] <dbaupp> rusti: [1,2,3].iter().map(|&x| { x * 2 }).fold(0, |x, acc| { x + acc })
[14:17:12] -rusti- pastebinned 11 lines of output: http://ix.io/7fs
[14:17:21] <engla> mrordinaire: range(1, 4).map(|x| x * 2)
[14:17:25] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[14:17:25] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/mpWLNQ
[14:17:25] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[14:17:28] <myname> pfft, why not fold(0, |x, acc| { x*2 + acc })? :p
[14:17:40] <engla> the acc is actually the first argument
[14:17:41] <dbaupp> rusti: let x = [1,2,3]; v.iter().map(|&x| { x * 2 }).fold(0, |x, acc| { x + acc })
[14:17:41] -rusti- <anon>:5:26: 5:27 error: unresolved name `v`. Did you mean `x`?
[14:17:41] -rusti- <anon>:5          let x = [1,2,3]; v.iter().map(|&x| { x * 2 }).fold(0, |x, acc| { x + acc })
[14:17:41] -rusti-                                    ^
[14:17:41] -rusti- error: aborting due to previous error
[14:17:42] -rusti- application terminated with error code 101
[14:17:45] <dbaupp> rusti: let x = [1,2,3]; x.iter().map(|&x| { x * 2 }).fold(0, |x, acc| { x + acc })
[14:17:46] -rusti- 12
[14:18:40] <myname> mrordinaire: is there a reason you used burrowed pointers at map?
[14:18:57] *** Joins: acrichto (acrichto@moz-17CABEB0.wv.cc.cmu.edu)
[14:19:29] <mrordinaire> myname: I'm just trying things out :P
[14:19:39] <mrordinaire> engla, dbaupp: thanks
[14:19:50] <myname> i'm just wondering if your example would work WITHOUT &
[14:19:54] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[14:20:26] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[14:20:26] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/HX2ZwQ
[14:20:26] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[14:20:27] <dbaupp> myname: that's only because map passes a reference to the element to the closure, so, there has to be a dereference at some point
[14:20:33] <huanghongqiao> it's the same in scala :  (1 to 3).map(x=>x*2).sum,haha
[14:20:45] <dbaupp> rusti: [1,2,3].map(|x| { *x * 2 }) // myname
[14:20:46] -rusti- ~[2, 4, 6]
[14:20:54] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[14:20:54] <bstrie> rusti: range(1, 4).map(|x| x*2)
[14:20:55] -rusti- {iter: {state: 1, stop: 4, one: 1}, f: }
[14:21:06] <bstrie> rusti: range(1, 4).map(|x| x*2).collect::<~[int]>()
[14:21:07] -rusti- ~[2, 4, 6]
[14:21:24] <dbaupp> rusti: use std::iterator::AdditiveIterator; range(1, 4).map(|x| x*2).sum()
[14:21:25] -rusti- 12
[14:21:44] <myname> rusti: [1,2,3].map(|x| { *x * 2 }).fold(0, |x,acc| { acc + x })
[14:21:46] -rusti- pastebinned 8 lines of output: http://ix.io/7ft
[14:21:58] <dbaupp> rusti: let v = [1,2,3]; v.iter().map(|x| { *x * 2 }).fold(0, |x,acc| { acc + x })
[14:21:59] -rusti- 12
[14:22:19] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[14:22:23] <myname> actually, i'm confused about this error message
[14:22:33] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[14:22:43] <dbaupp> `fold` is only on iterators, not vectors
[14:22:57] <dbaupp> (the second error message is caused by the first.)
[14:23:05] <myname> okay
[14:23:06] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[14:23:24] <myname> why is there a map for vectors but no fold? :/
[14:23:34] <myname> and are there differences like haskells foldl and folr?
[14:23:46] <bstrie> myname: as a rule we only implement those sorts of things on iterators, rather than on every imaginable container type
[14:24:03] <bstrie> the idea is that the containers only need to implement .iter(), and then they get all those for free
[14:24:33] <myname> bstrie: will it be possible to make this oneself?
[14:24:49] <dbaupp> myname: yes, one can easily define an iterator yourself
[14:24:53] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[14:25:01] <myname> like haskells "instance iterator vec where fold ..."
[14:25:52] <dbaupp> rusti: struct Ones; impl Iterator<int> for Ones { fn next(&mut self) -> Option<int> { Some(1) } } let mut ones = Ones; for i in ones.take(3) { printfln!(i) }
[14:25:54] -rusti- pastebinned 7 lines of output: http://ix.io/7fu
[14:26:17] <dbaupp> rusti: struct Ones; impl Iterator<int> for Ones { fn next(&mut self) -> Option<int> { Some(1) } } for i in Ones.take(3) { printfln!(i) }
[14:26:18] -rusti- 1
[14:26:18] -rusti- 1
[14:26:18] -rusti- 1
[14:26:18] -rusti- ()
[14:26:26] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[14:26:26] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14895092f to 14f02cc6b: 02http://git.io/N3iJvQ
[14:26:26] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[14:26:45] <dbaupp> myname: you only need to define the `next`, all the other ones happen for free.
[14:26:51] <myname> the question is more like "will i be able to make [1,2,3].fold work if i want to"
[14:27:05] <dbaupp> ah
[14:27:12] <bstrie> myname: sure you can
[14:27:30] <bstrie> but you'd have to define the trait containing `fold` yourself
[14:27:32] <dbaupp> a little bit, but not exactly the same as the iterator one; it'll be on a different trait.
[14:27:51] <bstrie> dbaupp: I have *no idea* how `Ones.take` works in that example
[14:28:08] <dbaupp> bstrie: magic! ... which bit in particular?
[14:28:21] <bstrie> dbaupp: how are you using Ones as a value?
[14:28:31] <bstrie> you can't call methods on types...
[14:28:32] <myname> bstrie: i guess it calls next a couple of times?
[14:28:34] <dbaupp> bstrie: because it's a unit-struct
[14:28:39] <bstrie> are unit structs special
[14:28:44] <dbaupp> bstrie: so it's constructor is `Ones`
[14:28:46] <dbaupp> yeah
[14:28:48] <bstrie> ah
[14:28:51] <bstrie> I see
[14:28:54] <dbaupp> rusti: struct Foo; Foo
[14:28:55] -rusti- {}
[14:28:56] <bstrie> just constructing in-place
[14:28:59] <dbaupp> yup
[14:29:29] <engla> there is a repeat too.   std::iterator::Repeat::new(1)
[14:29:49] <myname> why does the above example end with ()?
[14:29:51] <engla> rusti: std::iterator::Repeat::new(1).take(3).to_owned_vec()
[14:29:52] -rusti- ~[1, 1, 1]
[14:29:59] <myname> does it come from for?
[14:30:01] <dbaupp> engla: but that doesn't demonstrate implementing an iterator yourself :)
[14:30:03] <engla> myname: return value of the expression
[14:30:10] *** Quits: jen (jen@moz-3388A3B.dip0.t-ipconnect.de) (Ping timeout)
[14:30:14] <myname> ah
[14:30:28] <bstrie> myname: artifact of the rusti bot always printing the return type
[14:30:31] <engla> oh yeah. sorry. shooting from the hip as usual
[14:30:40] <bstrie> er, return value
[14:30:43] <dbaupp> myname: the expression == the whole input to rusti; it's run like `let r = { <input> }; printfln!(r)`
[14:31:04] <dbaupp> rusti: show me your internals
[14:31:04] -rusti- <anon>:5:14: 5:16 error: expected one of `; }` but found `me`
[14:31:04] -rusti- <anon>:5          show me your internals
[14:31:05] -rusti-                        ^~
[14:31:05] -rusti- application terminated with error code 101
[14:31:16] * dbaupp thought that would give more context
[14:31:30] <engla> silly, you can't talk to the bot
[14:31:40] <bstrie> rusti: botsnack
[14:31:40] -rusti- <anon>:5:9: 5:17 error: unresolved name `botsnack`.
[14:31:41] -rusti- <anon>:5          botsnack
[14:31:41] -rusti-                   ^~~~~~~~
[14:31:41] -rusti- error: aborting due to previous error
[14:31:41] -rusti- application terminated with error code 101
[14:31:45] <bstrie> no fun
[14:31:59] <dbaupp> rusti: {
[14:31:59] -rusti- <anon>:8:0: 8:1 error: file ended with unbalanced delimiters
[14:32:00] -rusti- <anon>:8 }
[14:32:00] -rusti-          ^
[14:32:00] -rusti- application terminated with error code 101
[14:32:03] <dbaupp> rusti: (
[14:32:03] -rusti- <anon>:6:4: 6:5 error: incorrect close delimiter: `}`
[14:32:03] -rusti- <anon>:6     };
[14:32:03] -rusti-              ^
[14:32:03] -rusti- application terminated with error code 101
[14:32:24] <SiegeLord> I kind of wish rusti the bot always pastebinned the errors
[14:32:31] <dbaupp> yeah, a lot of spam
[14:32:46] <dbaupp> (and the whole channel gets muted semi-regularly.)
[14:32:56] <engla> it could print just the first line of the error
[14:33:01] <engla> and a pastebin link
[14:33:25] *** Quits: mrordinaire (Mibbit@1A659656.A607747.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:33:39] <SiegeLord> Also... it'd be nice to have error numbers, but I guess I already mentioned this awhile ago...
[14:34:13] *** Joins: jen (jen@moz-3388A3B.dip0.t-ipconnect.de)
[14:36:17] <SiegeLord> Like this: http://msdn.microsoft.com/en-us/library/cfahxw6k.aspx
[14:36:36] <SiegeLord> They'd be useful if rustc ever gets localized
[14:36:43] *** Quits: jen (jen@moz-3388A3B.dip0.t-ipconnect.de) (Ping timeout)
[14:37:54] *** zz_kimundi is now known as kimundi
[14:38:43] *** Parts: xlq (ekselkiu@moz-DF73151C.net) ()
[14:40:14] *** Joins: jen (jen@moz-3388A3B.dip0.t-ipconnect.de)
[14:41:31] <kimundi> Hm, could someone give me a r+ ? https://github.com/mozilla/rust/pull/8452
[14:41:37] *** Joins: mw (mw@moz-F023ECC0.adsl.highway.telekom.at)
[14:42:44] *** Quits: jen (jen@moz-3388A3B.dip0.t-ipconnect.de) (Ping timeout)
[14:43:17] *** Joins: vosen (vosen@moz-266BA656.icpnet.pl)
[14:45:49] <pnkfelix> nmatsakis: ping
[14:46:11] *** Quits: cypher (ircnet@moz-EA42E471.static.surfer.at) (Quit: Leaving...)
[14:46:15] *** Joins: jen (jen@moz-90A4EF1C.dip0.t-ipconnect.de)
[14:48:21] <bstrie> kimundi: I'm still not certain what that .or_some interface should look like
[14:48:44] <kimundi> bstrie: what do you mean
[14:48:46] *** Joins: noam_ (noam@F6B530A7.720527A7.416762B.IP)
[14:48:48] <kimundi> ?
[14:48:58] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[14:49:00] <bstrie> part of me wonders if the .unwrap_default method should be preferred because it's more efficient
[14:49:16] <kimundi> bstrie: I'm not removing that one
[14:49:17] <bstrie> not sure if llvm optimizes out the wrapping-and-unwrapping check
[14:49:40] <bstrie> kimundi: but if we're not removing it, then perhaps .or_some should just be called .default
[14:49:56] <bstrie> no reason to suggest that they do different things
[14:50:32] <kimundi> well... I'd rather reanme 'default' then
[14:50:40] <kimundi> unwrap_or_value
[14:51:01] <bstrie> I don't think default is a bad name
[14:51:09] <bstrie> pretty sure it has precedence elsewhere
[14:51:12] <kimundi> well, it is once we have the Default trait xD
[14:51:45] <nmatsakis> pnkfelix: pong
[14:51:45] <bstrie> kimundi: tell you what, figure out what other languages have named these things and I'll approve it. no reason to bikeshed when we can steal paint colors
[14:51:52] <pnkfelix> nmatsakis: Q: have the semantics of putting an overriding default method impl in a trait extension (e.g. "trait ExtT : BaseT { fn foo(&mut self) { â€¦ } }" where foo already has a default impl in BaseT been worked out? 
[14:52:18] <pnkfelix> nmatsakis: the lint.rs code is funky and I'm trying to figure out the best way to deal with it.
[14:52:39] <kimundi> bstrie: hmm... Need to learn about languages with option types first
[14:53:04] <nmatsakis> pnkfelix: that is not really allowed
[14:53:24] <nmatsakis> pnkfelix: the current system of "trait extension" is not very object-oriented like, I fear, and we are truly abusing the term trait
[14:53:27] <pnkfelix> nmatsakis: yeah.  It doesn't seem like its properly disallowed either.  :)
[14:53:37] <pnkfelix> nmatsakis: I'm going to avoid attempting to use it at this point.
[14:53:39] <nmatsakis> pnkfelix: this is one of my disappointments with our current system actually that I would like to address, but I fear it will have to wait
[14:54:07] <nmatsakis> pnkfelix: it is best to think of trait "extension" as trait addition or implication
[14:54:20] <nmatsakis> pnkfelix: that is, `trait Foo : Bar` means: to implement Foo, you must implement Bar, but Foo and Bar are still separate
[14:54:36] <pnkfelix> nmatsakis: the lint code is the first case I've seen that is taking advantage of the explicit VTable + Y-combinator-style-tying-the-knot to do delegation-style extension
[14:54:46] <nmatsakis> pnkfelix: I hope that we can improve upon this in the future, but there are some (relatively minor) complications that arise
[14:55:09] <nmatsakis> pnkfelix: AST folder used to do that (maybe still does?), I wonder if it was copied from there
[14:55:22] <pnkfelix> nmatsakis: i don't think so, this seems like a pretty special case
[14:55:42] <pnkfelix> nmatsakis: see "fn item_stopping_visitor" in lint.rs if you are interested.
[14:56:39] <nmatsakis> pnkfelix: oh, yes, I... sort of recall. I remember reading that and thinking "this seems more complicated than it has to be..."
[14:56:44] <pnkfelix> yeah
[14:56:59] <pnkfelix> I'm going to have to do *something* different here
[14:57:19] <pnkfelix> but I'm trying to come up with a small hack for now
[14:57:38] <pnkfelix> (or at least, a mechanically-applicable hack, if not exactly small)
[14:58:50] *** Quits: Crnobog (uid1041@moz-E77DEB21.irccloud.com) (Quit: Connection closed for inactivity)
[15:02:26] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[15:03:15] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[15:03:30] *** Quits: noam_ (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[15:04:57] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Ping timeout)
[15:05:57] *** Joins: noam (noam@F6B530A7.720527A7.416762B.IP)
[15:07:42] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[15:07:53] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[15:09:24] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[15:10:25] *** Quits: jen (jen@moz-90A4EF1C.dip0.t-ipconnect.de) (Ping timeout)
[15:12:21] *** Quits: milinda (milinda@DA212585.7CFC0820.51B6877.IP) (Input/output error)
[15:13:47] *** Joins: jen (jen@moz-90A4EF1C.dip0.t-ipconnect.de)
[15:15:24] *** Joins: milinda (milinda@DA212585.7CFC0820.51B6877.IP)
[15:17:02] *** Quits: fabiand (fabiand@moz-F49693AB.adsl.alicedsl.de) (Quit: Verlassend)
[15:17:07] *** Joins: fabiand (fabiand@moz-F49693AB.adsl.alicedsl.de)
[15:18:37] *** Quits: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net) (Ping timeout)
[15:20:18] *** Quits: slaren (slaren@moz-E221166D.red-81-35-253.dynamicip.rima-tde.net) (Ping timeout)
[15:20:31] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[15:20:50] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[15:23:02] *** Joins: simon (simon@moz-1DDE8FF6.dsl.bell.ca)
[15:24:52] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Connection reset by peer)
[15:25:28] *** Joins: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de)
[15:25:51] <nmatsakis> pnkfelix: any luck? you've got me curious now but I'm trying to avoid the urge to go and read lint myself...
[15:26:08] <pnkfelix> nmatsakis: well, the approach I'm taking
[15:26:17] <pnkfelix> nmatsakis: is to carry an explicit bit of state
[15:26:19] *** Joins: sp3d (a@moz-41A29595.dhcp.stls.mo.charter.com)
[15:26:31] <pnkfelix> nmatsakis: to say "am I going to process items?  or not?"
[15:26:54] <pnkfelix> nmatsakis: (its not quite that simple, but its not easy to explain quikcly)
[15:28:01] <pnkfelix> nmatsakis: that and some surrounding infrastructure to ease putting this change inâ€¦ I'm hoping it will work
[15:28:16] <pnkfelix> nmatsakis: but its an all-or-nothing port of the file, and there are a bunch of different lints to port ...
[15:28:58] <nmatsakis> pnkfelix: k...hack upon hack. As I recall, the *original* lint visited every item many, many times (there was an outer walk, and then the per-lint passes did their own walks), then I think the item-stopping-visitor-thingy was added to try and rectify that...
[15:29:18] <pnkfelix> nmatsakis: this all seems wrong
[15:29:23] <nmatsakis> it does to me too!
[15:29:31] <pnkfelix> nmatsakis: but I don't want to take the time to try to come up with something better
[15:29:41] <pnkfelix> nmatsakis: not right now, at least
[15:29:45] <nmatsakis> yeah, I think that's been the motivation of all who touch lint ;)
[15:30:06] <nmatsakis> but I agree :)
[15:30:20] <pnkfelix> I can understnad that coming up with a good solution here migth be tricky
[15:30:38] <nmatsakis> I don't think it needs to be any more,
[15:30:42] <nmatsakis> now that we have the add_lint interface
[15:30:46] <nmatsakis> I think we can just use the simple visitor or whatever
[15:30:53] <nmatsakis> and anything that doesn't fit,
[15:30:57] <nmatsakis> can just be moved to its own pass
[15:31:07] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Client exited)
[15:31:17] <pnkfelix> nmatsakis: well, if this doesn't resolve itself quickly
[15:31:21] <nmatsakis> or maybe just move everything to their own passes anyhow, though this has a potential cost of compilation time,
[15:31:24] <pnkfelix> nmatsakis: maybe I'll look into more extreme approaches like thast
[15:31:30] <nmatsakis> though empirically speaking that cost is very low
[15:32:28] <nmatsakis> anyway, it's a pain to do, and it does feel a bit...separate
[15:32:39] <pnkfelix> I suppose the other thing would be 
[15:32:45] <pnkfelix> to port everything except lint.rs
[15:32:52] <pnkfelix> and start getting those reviewed
[15:33:20] <pnkfelix> leaving in oldvisit until lint.rs can be addressed, under the assumption that we're more willing to drop lints or replace them with new code.
[15:33:35] <pnkfelix> and thus its less important to carry them forward
[15:33:49] <nmatsakis> or just the assumption that it's a pain and worth separating
[15:34:01] <nmatsakis> I personally think that's a good strategy: one PR for the straightofrwad ports
[15:35:48] <pnkfelix> nmatsakis: or one issue with many PR's.
[15:36:06] <pnkfelix> nmatsakis: since it might still be valuable to commit the files individually.  We'll see
[15:37:49] *** Quits: huanghongqiao (Mibbit@3C680082.93A8C231.B33D3324.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:38:25] *** Parts: mw (mw@moz-F023ECC0.adsl.highway.telekom.at) ()
[15:38:55] *** Quits: sk (sk@A8E15A9E.F427598.78DD174B.IP) (Quit: Leaving)
[15:40:21] *** Joins: cypher (ircnet@moz-1D494DB3.vie.surfer.at)
[15:42:01] *** Quits: cypher (ircnet@moz-1D494DB3.vie.surfer.at) (Ping timeout)
[15:42:21] *** Quits: milinda (milinda@DA212585.7CFC0820.51B6877.IP) (Input/output error)
[15:43:59] *** Joins: FDS (arnaud@moz-CE4D5907.bdx.modulonet.fr)
[15:44:18] *** Joins: huanghongqiao (Mibbit@8241A3B7.C880F6CE.22DEFD68.IP)
[15:46:45] <huanghongqiao> this is my code:let mut i = 0;while i < 1000000 { println(fmt!("The %dth task", i)); do spawn {loop{}}; i += 1;}, when i equal 91898, out of memory alloc
[15:49:03] *** Joins: milinda (milinda@DA212585.7CFC0820.51B6877.IP)
[15:49:18] <nmatsakis> huanghongqiao: presumably this is from allocating all of the stack frames.
[15:53:12] <bstrie> huanghongqiao: right now our stacks are much bigger than they should be
[15:53:21] <bstrie> you will not be able to have a very large number of tasks
[15:53:43] <huanghongqiao> nmatsakis maybeï¼Œ but it is small
[15:54:38] *** Joins: graydon (graydon@moz-F14EE0DB.cable.teksavvy.com)
[15:54:38] *** ChanServ sets mode: +qo graydon graydon
[15:54:42] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[15:54:42] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[15:54:55] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:55:55] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[15:58:29] <nmatsakis> huanghongqiao: I believe that at this moment, we are always allocating large stacks for every task
[15:58:39] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[15:58:39] *** ChanServ sets mode: +o dherman
[15:58:44] *** Joins: tautologico (lymph@8ABDEDA.34CAB63A.7B974E06.IP)
[15:58:54] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[15:59:24] <cmr> 4MB I think
[15:59:29] *** Joins: alisdair (textual@moz-4833EC3E.eng.wind.ca)
[15:59:53] *** Quits: milinda (milinda@DA212585.7CFC0820.51B6877.IP) (Ping timeout)
[16:00:10] <graydon> https://etherpad.mozilla.org/Meeting-weekly-2013-08-13
[16:01:22] <huanghongqiao> too big..
[16:02:21] <graydon> huanghongqiao: it's a temporary thing until we re-enable split stacks on the new runtime (depending on platform)
[16:03:07] *** Joins: jeaye (Jeaye@moz-FD505E54.hsd1.ca.comcast.net)
[16:03:46] <SimonSapin> How can I see the result of macro expansion?
[16:03:57] <cmr> SimonSapin: rustc --pretty expanded
[16:04:01] *** Joins: milinda (milinda@DA212585.7CFC0820.51B6877.IP)
[16:04:26] <jld> I assume the 4MB is demand-paged, so we actually allocate only the first page and the first PTP (on x86) if the usage is small, but, yeah.
[16:04:29] <toddaaro> is there a rust meeting today?
[16:04:39] *** Joins: ozten (ozten@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:04:49] <Ms2ger> graydon just pointed to a meeting etherpad
[16:05:15] <toddaaro> there are 0 mtv folks in the room
[16:05:21] <toddaaro> at 5m after start time
[16:05:23] <graydon> yeah. don't know where they went.
[16:05:28] <toddaaro> if someone walks me through it I can try turning on the stuff
[16:05:48] <SimonSapin> I have dead-assignment warnings that go away if I expand macros manually. (The assignment is in the macro)
[16:05:53] <graydon> oh. they're on vidyo
[16:05:56] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:06:05] <graydon> some folks are anyway!
[16:06:52] <bstrie> SimonSapin: I believe there are some bugs in the bug tracker to that effect...
[16:07:19] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[16:07:19] *** ChanServ sets mode: +o brson
[16:07:26] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[16:07:26] *** ChanServ sets mode: +o tjc
[16:08:09] *** Joins: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:09:06] <huanghongqiao> thanks everybody
[16:09:31] <graydon> https://etherpad.mozilla.org/Meeting-weekly-2013-08-13
[16:10:47] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[16:11:42] <nmatsakis> pnkfelix: this works https://gist.github.com/nikomatsakis/6222791
[16:12:11] <pnkfelix> nmatsakis: excellent.  â€¦ what about &mut Foo ?
[16:12:31] <pnkfelix> nmatsakis: (from @mut Foo, presumably)
[16:12:38] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[16:13:03] <nmatsakis> pnkfelix: ought to? 
[16:13:05] <nmatsakis> pnkfelix: let me try :)
[16:13:35] *** Quits: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se) (Ping timeout)
[16:13:57] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Ping timeout)
[16:14:20] <nmatsakis> pnkfelix: yes.
[16:14:37] <pnkfelix> nmatsakis: cool.  I'll have to double-check why my code isn't "just working" out of the box
[16:15:06] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[16:15:06] *** Joins: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca)
[16:15:25] *** Quits: davbo (dave@moz-3FFA637C.oucs.ox.ac.uk) (Client exited)
[16:15:34] *** Joins: brianm (brianm@moz-9B7D279E.dsl.static.sonic.net)
[16:18:05] *** Quits: tchoma (tchoma@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: tchoma)
[16:18:10] *** Quits: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP) (Client exited)
[16:18:36] *** Joins: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP)
[16:20:07] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[16:20:21] *** Quits: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP) (Ping timeout)
[16:21:21] *** Joins: Florob (Florob@moz-39532932.de)
[16:23:31] *** Quits: KindOne (KindOne@9134C84A.2171A688.34F73994.IP) (Ping timeout)
[16:24:23] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[16:25:55] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[16:27:39] *** Joins: KindOne (KindOne@moz-65A10CB1.dynamic.ip.windstream.net)
[16:27:40] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:30:21] <sp3d> rusti: 4u8.clone()
[16:30:22] -rusti- 4
[16:31:37] *** flaper87 is now known as flaper87|afk
[16:32:57] *** Quits: fabiand (fabiand@moz-F49693AB.adsl.alicedsl.de) (Quit: Verlassend)
[16:33:02] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Quit: Leaving)
[16:34:39] *** Quits: alisdair (textual@moz-4833EC3E.eng.wind.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[16:39:26] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[16:40:58] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[16:41:25] *** Joins: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP)
[16:42:00] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[16:42:04] *** Joins: oren (oren@moz-B0F26027.red.bezeqint.net)
[16:42:18] *** Quits: simon (simon@moz-1DDE8FF6.dsl.bell.ca) (Quit: WeeChat 0.4.2-dev)
[16:43:11] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[16:44:35] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Client exited)
[16:44:52] <graydon> nmatsakis: woah, @Foo decays to &Foo?
[16:44:59] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[16:45:01] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Places to go, people to annoy)
[16:45:05] <graydon> nmatsakis: er, borrows
[16:45:14] <nmatsakis> graydon: yes
[16:45:16] <Ms2ger> Decays is a nice word too
[16:45:17] <nmatsakis> graydon: is that not expected?
[16:45:20] <graydon> that's exciting!
[16:45:30] <nmatsakis> graydon: ok :)
[16:45:34] <graydon> I did not expect it because I thought the world(s) of object types were assumed to be a lot more disjoint than that
[16:45:56] <graydon> (I guess reading-in to the notion of &Trait not implementing Trait in the first place)
[16:46:12] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[16:46:41] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[16:46:42] <graydon> incidentally, if all the methods on Trait take &self, is there a simple-ish way to make &Trait impl Trait? or do I have to spell it all out?
[16:46:54] <nmatsakis> no simple way, a deriving mode would seem to make sense?
[16:47:09] <nmatsakis> #[deriving(Self)]? :)
[16:47:09] <graydon> perhaps
[16:47:27] <cmr> Isn't that the delegate derivation I suggested on some issue that I can't find?
[16:47:36] <nmatsakis> I think so
[16:47:36] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[16:47:40] <nmatsakis> I seem to recall seeing it suggested
[16:47:46] <graydon> I can see people bumping into this with some frequency. the concepts are deceptively similar.
[16:47:50] <nmatsakis> yes I know
[16:47:59] <graydon> (which is part of the charm! but also part of the hazard)
[16:48:19] <nmatsakis> interestingly, it's not always possible to impl Trait for &Trait --- 
[16:48:26] <nmatsakis> that is, if the trait has @self and ~self methods
[16:48:30] <graydon> of course
[16:48:41] <nmatsakis> (not to mention the usual hazards regarding uses of the `Self` type)
[16:48:43] <graydon> that's why I said "if all the methods on Trait take &self" :)
[16:49:03] <bblum> graydon: iirc it's not just if all the methods take &self
[16:49:16] <bblum> there is also a problem with methods taking other arguments of Self type
[16:49:50] <graydon> ah true
[16:49:51] <nmatsakis> is someone already putting minutes onto the wiki?
[16:49:54] <graydon> quite thorny
[16:50:01] <nmatsakis> the full set of conditions is rather complicated,
[16:50:04] <nmatsakis> there is also &mut self to consider
[16:50:14] <nmatsakis> that's why we dont' do it automaticaly :)
[16:50:27] <engla> by the way, I had a change merged to fix lexical order of tuples and &[T]. sequences like these now require Eq + Ord to impl Ord. Maybe Ord should inherit Eq.
[16:50:29] <graydon> nmatsakis: I will put it in the wiki
[16:51:47] <nmatsakis> engla: probably, yes.
[16:52:45] *** Quits: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de) (Ping timeout)
[16:53:07] <acrichto> graydon: looks like the bots just finished a pull, would it be a good time to reconfigure for https://github.com/mozilla/rust/issues/7425 ?
[16:53:13] <graydon> yes
[16:53:29] <acrichto> looks like bors hasn't actually done the merge yet, but all the tests passed anyway
[16:53:39] <graydon> bors is now disabled
[16:53:44] <graydon> I will drive it manually while reconfiguring
[16:53:51] <acrichto> thanks!
[16:54:18] <acrichto> if this works, cycle time should decrease by ~1hr
[16:54:29] <engla> nmatsakis: ok. I think it will have very little impact.
[16:54:50] <engla> as in, no changes required, everything already implements both Eq and Ord
[16:55:54] *** IRCMonkey48213 is now known as rhelmer
[16:55:56] *** Quits: oren (oren@moz-B0F26027.red.bezeqint.net) (Quit: Lost terminal)
[16:57:00] <pnkfelix> nmatsakis: If we get rid of @mut T in favor of Cell<T>, will we also get rid of @mut Trait?  Or will there be some way to express that?  (I find myself creating @mut Visitor solely because I need to pass them to fns taking &mut self â€¦)
[16:57:00] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[16:57:02] <nmatsakis> pnkfelix: however, poking a bit deeper I found some bugs in the code to coerce @Object to &Object -- in particular around mutability
[16:57:10] <nmatsakis> pnkfelix: funny you should mention that,
[16:57:39] <nmatsakis> pnkfelix: I was just thinking about it the other day. Similarly with @mut [] -- presumably we would need to a way to handle this?
[16:58:12] <pnkfelix> nmatsakis: seems like there's something missing here.  That or we are being too clever with our conflating of concepts.
[16:58:18] <brson> graydon: do you want to reserve 'yield'?
[16:58:19] *** Joins: obk (Mibbit@moz-B0F26027.red.bezeqint.net)
[16:58:47] <graydon> brson: probably? why, oh, you want to use it as a function name in sched I bet!
[16:58:51] <nmatsakis> pnkfelix: well, it seems plausible to permit @Cell<Trait>, but it would require some thought to get the rules correct
[16:59:19] <graydon> brson: it just seems unlikely to me that "yet another form of coroutine" is going to die.
[16:59:20] <pnkfelix> nmatsakis: â€¦ can one even express types of that form currently?
[16:59:28] <nmatsakis> pnkfelix: No. 
[16:59:34] <pnkfelix> nmatsakis: (substituting a Trait name for a type parameter)
[16:59:40] <pnkfelix> nmatsakis: okay.  just a sanity check.
[16:59:53] <obk> Can someone tell me what I'm doing wrong in https://gist.github.com/orenbenkiki/6208391 (in rust 0.8-pre (74efdf6 2013-08-09 08:17:04 -0700) if it matters)?
[17:00:05] <pnkfelix> nmatsakis: strikes me as a mistakeâ€¦ potentially confusing different domains.
[17:00:09] <cmr> obk: assert_ne really doesn't exist.
[17:00:13] <cmr> Oh I see
[17:00:15] <cmr> nevermind
[17:00:21] <nmatsakis> pnkfelix: what strikes you as a mistake? permitting trait names to appear as types? (bit late for that!)
[17:00:23] *** Joins: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP)
[17:00:34] <nmatsakis> pnkfelix: formally, it's an existential type.
[17:00:47] <pnkfelix> nmatsakis: My mental model: A type parameter represents a type.
[17:00:55] * Ms2ger thought rust didn't have existentials
[17:01:01] <pnkfelix> nmatsakis: A trait represents a constraint on a type
[17:01:05] <brson> graydon: there's a task::yield function currently that needs to be renamed
[17:01:09] <nmatsakis> Ms2ger: we have object types, which are existentials, though not expressed as such
[17:01:11] <pnkfelix> nmatsakis: @Trait is a cute way to express existential
[17:01:17] <kmc> it doesn't have general existential quantification
[17:01:29] <kmc> but it has one thing that is like a specific case of existentials
[17:01:35] *** Quits: StarLight (StarLight@moz-F606CD03.dynamic.avangarddsl.ru) (Ping timeout)
[17:01:37] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:01:39] <nmatsakis> pnkfelix: well, if we permitted it, Cell<Trait> would presumably be equivalent to "exists T:Trait. Cell<T>"
[17:01:47] <nmatsakis> pnkfelix: but I agree this is a radical concept that would take great care to introduce
[17:02:05] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[17:02:12] <huanghongqiao> rust: task failed at 'glob() is unimplemented on Windows', C:\bot\slave\dist-win\build\src\libstd\os.rs:1328
[17:02:25] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[17:02:28] <obk> cmr: Seems like it should work, right? I guess I should just learn to live without macros... :-/
[17:02:57] <pnkfelix> nmatsakis: yeah, I don't know yet.  (e.g. Would that local transformation/elaboration actually suffice as an explanation, or would it be more context dependent.  just not sure.)
[17:03:03] <cmr> obk: macros are in a weird state atm, they don't use the normal scope rules etc
[17:03:35] <nmatsakis> pnkfelix: it ... seems a bit complicated. And introducing more general existentials in any form opens the door to other fun problems
[17:04:04] <pnkfelix> nmatsakis: well, for now, lets just keep this in mind as a reason to leave @mut Trait in, even if only under a -Z flag...
[17:04:06] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[17:04:06] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/JYZ3oA
[17:04:06] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[17:04:08] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[17:04:17] <obk> cmr: I know, I thought that's what #[macro_escape] solved. I guess it doesn't really work yet (at least not in 0.8-pre).
[17:04:19] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[17:04:26] * obk will do without for now...
[17:04:27] <nmatsakis> pnkfelix: yes, as I said, it occurred to me a day or two ago while thinking over this patch... annoying.
[17:04:35] <cmr> obk: where is your crate fil.e?
[17:04:37] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[17:04:42] <cmr> obk: you're doing weird things with mods..
[17:05:05] <pnkfelix> nmatsakis: when did your fix for &Trait and &mut Trait objects get in?  Would it be in the current snapshot?
[17:05:11] <nmatsakis> pnkfelix: I believe it is, yes.
[17:05:31] <pnkfelix> nmatsakis: mind looking at a gist to help me figure out what I'm doing wrong?
[17:05:40] *** Joins: StarLight (StarLight@moz-B9BAF9D0.dynamic.avangarddsl.ru)
[17:05:44] <nmatsakis> pnkfelix: nope
[17:05:47] <obk> cmr: Why? This is just an example (defining macros in one mod and using it in another). Never mind the specific macro (I picked assert_ne just for example).
[17:06:03] <obk> Let me add the crate file, sec...
[17:06:10] <cmr> obk: Because you're introducing extra nodes in the module tree with the explicit `mod` blocks
[17:06:13] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[17:06:20] <cmr> `mod foo;` already creates a mod.
[17:06:30] <cmr> `mod macros;` in your crate file will have your macros in macros::macros
[17:06:37] <cmr> and you would be missing a level of #[macro_escape]
[17:06:51] <pnkfelix> nmatsakis: https://gist.github.com/pnkfelix/6223306
[17:07:20] <nmatsakis> pnkfelix: what in specific?
[17:07:25] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[17:07:31] <pnkfelix> nmatsakis: compiler error message for above: https://gist.github.com/pnkfelix/6223310
[17:08:13] <obk> Ah! So each .rs file is already implicitly a mod?
[17:08:14] <pnkfelix> nmatsakis: oh wait
[17:08:17] <cmr> Yes
[17:08:22] <pnkfelix> nmatsakis: the walk method takes  &mut V
[17:08:26] <pnkfelix> nmatsakis: (where <V:Visitor>)
[17:08:31] <obk> I missed that in the docs somehow.
[17:08:32] <pnkfelix> nmatsakis: that's not a &mut Visitor
[17:08:39] <pnkfelix> nmatsakis: that's probably my mistake
[17:08:57] <pnkfelix> nmatsakis: (this is the first case where I've needed to try to do this, so I overlooked that...)
[17:09:03] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[17:09:41] <obk> cmr: Removing the mod name { ... } solves the problem. Thanks!
[17:10:03] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[17:10:03] <obk> I guess the name of the mod is the name of the file - that makes sense.
[17:10:04] <pnkfelix> nmatsakis: I do have "impl<E:Clone> Visitor<E> for @mut Visitor<E>" though
[17:10:05] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:10:09] *** Joins: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:10:12] <pnkfelix> nmatsakis: so maybe it should still work ...
[17:10:19] <cmr> obk: nope
[17:10:33] <cmr> the name of the mod is the name of the name of the mod statement when it's included
[17:10:39] <cmr> that doesn't make sense, phrasd that way...
[17:10:41] <cmr> `mod foo;`
[17:10:42] <kmc> it's a bit confusing that "mod foo;" is a definition (with content from an external file), not a declaration
[17:10:50] <cmr> Loads foo.rs (or foo/mod.rs) into the module tree as `foo`
[17:10:53] <kmc> I wonder if there is alternative syntax to make that more clear; it's probably too late, though
[17:11:00] <nmatsakis> pnkfelix: reading
[17:11:11] <cmr> `#[path="bar.rs"] mod foo;` loads bar.rs as `foo` at that point in the module tree
[17:11:36] <obk> Oh, so what controls things is the crate file?
[17:11:50] <kmc> the crate file is the file whose name you pass to rustc directly
[17:11:50] <cmr> No, crate file is just usually where you put most/all of your `mod` statements
[17:12:01] <cmr> It's the root of the module tree
[17:12:04] <kmc> so it's in charge of bringing in other stuff
[17:12:33] <obk> Ok, so where should I put #[macro_escape]? In the crate file before `mod macros;`?
[17:12:46] <pnkfelix> nmatsakis: let me try taking a &mut ref of the @mut Visitor
[17:12:50] <cmr> Usually you put `#[macro_escape];` in the file.
[17:13:01] <cmr> The semicolon applies the attribute to the containing item (in this case, the module)
[17:13:25] <nmatsakis> pnkfelix: yes, I am writing up an explanation, but in short I think you need this
[17:13:27] <toddaaro> brson: now that I think about it, this could be binary incompatibility from the NO_REBUILD flag, I'm not sure what exactly it does but I have had problems with it before when changing struct definitions
[17:13:42] <toddaaro> brson: I'll first see if stage0 has the same problem
[17:13:49] <graydon> reconfiguring bots
[17:13:50] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[17:13:50] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[17:13:59] <obk> Got it. Another point - the order of the lines in the crate file matters! I must insert the macros module first.
[17:14:14] <cmr> that... shouldn't be the case, but there might be weirdness with macros
[17:14:16] <obk> Which makes sense given the macros "escape" the module.
[17:14:17] *** Joins: wilmoore (wilmoore@moz-1248C037.mystrotv.com)
[17:14:43] <graydon> brson: is "reserving yield" something you're really opposed to? I don't have strong feelings about generators, vaguely opposed on the grounds of complexity, but I gather they have a die-hard contingent almost as dedicated to them as tail calls..
[17:14:47] <obk> Ok, so it is working now. Thanks!
[17:14:48] <nmatsakis> pnkfelix: https://gist.github.com/pnkfelix/6223310#comment-885759
[17:14:56] *** Quits: wilmoore (wilmoore@moz-1248C037.mystrotv.com) (Connection reset by peer)
[17:15:00] <pnkfelix> nmatsakis: cool, that's what I'm trying now.
[17:15:11] <kimundi> bstrie: I looked a bit into what other languages do in regard to their option type
[17:15:16] *** Joins: wilmoore (wilmoore@moz-1248C037.mystrotv.com)
[17:15:17] <bstrie> kimundi: go on
[17:16:12] <toddaaro> ay		
[17:16:13] <kimundi> bstrie: Turns out they all work slightly differntly and have different naming shemes, none of wich is what there currently is in rust
[17:16:44] <obk> Now that people are around... I opened https://github.com/mozilla/rust/issues/8457 - perhaps someone could tell me what the right thing to do is.
[17:16:44] <toddaaro> graydon: the weird thing about reserving yield for generators is that it is in many ways the "same" yield as would be used elsewhere, with tasks for example
[17:16:59] <obk> The compiler crash is some sort of bug, of course, but other than that.
[17:17:22] <toddaaro> graydon: conceptually at least, in terms of implementation I expect they would be different
[17:17:23] <kimundi> bstrie: In other words, none seem to have a function that does what 'or_some' does, but that's also true for a lot of other functions that are currenty implemented on Option in rust. Of course, due to differnt type systems it'S not really comparable, but nevertheless
[17:17:24] <cmr> nmatsakis: ^
[17:17:34] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[17:17:34] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/3yL_6w
[17:17:34] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[17:17:35] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[17:17:35] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/PoUj5A
[17:17:36] <ghrust> 13rust/06auto 141ceee6a 15Chris Morgan: Remove in-tree test binary....
[17:17:36] <ghrust> 13rust/06auto 14d659753 15bors: auto merge of #8432 : chris-morgan/rust/remove-assert-eq-macro-fail-binary, r=huonw...
[17:17:36] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[17:18:02] <obk> Is there a way to upgrade an RW ARC read lock to a write lock? And, if not, what should I put as the lifetime of the variable there (or is it just another compiler bug that it can't figure it out by itself)?
[17:18:27] <toddaaro> graydon: so I do think reserving yield is a goodish idea, but I think we need a concept of how the various uses of yield relate and how to name them
[17:18:56] <nmatsakis> cmr: what am I to take from this?
[17:19:23] <cmr> nmatsakis: the lifetime crash/how to work around it
[17:19:41] <cmr> It's the line `let maybe_intern: &'self Option<&Intern> = do arc_interner.write |interner| {`
[17:19:41] *** Joins: alisdair (textual@moz-4833EC3E.eng.wind.ca)
[17:19:50] <nmatsakis> cmr: oh, I thought you were referring me to kimundi's comment. You mean #8457?
[17:20:04] <cmr> nmatsakis: yeah
[17:20:05] *** Quits: robertknight (robertknig@moz-90F4A0C8.range81-159.btcentralplus.com) (Ping timeout)
[17:20:19] *** Ms2ger is now known as Ms2ger|cat
[17:20:21] <kimundi> bstrie: ocaml has something like 'default(self, T)' == unwrap_or_default, scala seems to only have 'getOrElse(self, fn() -> T)' etc 
[17:21:21] <kimundi> google gueva library has 'get(self, T)' overloaded to work like unwrap_or_default AND or_some
[17:21:28] <obk> nmatsakis: Using 'self makes no sense, I know, but it causes a crash. The question is, what should I put there instead. It seems strange I need to put anything...
[17:21:32] <bstrie> kimundi: do either of those have methods that get the value and just fail on None, like our current .unwrap?
[17:21:55] <kimundi> bstrie: yeah
[17:22:09] <kimundi> ususally raises a exception
[17:22:30] <obk> Ideally I'd just nest the write lock in the read lock, but that deadlock (which sort of make sense) and there's no write_upgrade (which would have been really useful for this sort of thing).
[17:22:36] <bstrie> kimundi: what are they named?
[17:23:13] <Yurume> rusti: trait a{fn f(~self)->int;}struct x;impl a for x{fn f(~self)->int{42}} let z=~x as ~a; z.f()
[17:23:14] -rusti- 42
[17:23:49] <nmatsakis> obk: reading now. one question, why do you do "arc_interner.write" in the first part? shouldn't it be read?
[17:24:00] <kimundi> bstrie: valOf, Value, get, fromJust
[17:24:06] <brson> graydon: no, i'm not opposed to reserving 'yield'. i was just thinking of doing it. renaming task::yield makes it a bigger project than i expected though
[17:24:06] <nmatsakis> obk: (also, you probably want find_equiv)
[17:24:12] <brson> graydon: i'll probably just file the issue
[17:24:14] <Yurume> ugh, is it possible to get "cannot move out of dereference of & pointer" error while calling ~self method of the generic owned box?
[17:24:34] <kimundi> bstrie: And a lot of different additional names because of implementing a collection interface
[17:24:43] *** Quits: huanghongqiao (Mibbit@8241A3B7.C880F6CE.22DEFD68.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:24:46] <kimundi> drop etc
[17:24:46] <cmr> Yurume: you'd only get that if you're trying to call the method in a &T I think
[17:24:56] <nmatsakis> obk: finally, the crash is unfortunate, but I think there is no annotation you could put there that would cause it to type check---
[17:24:58] <obk> nmatsakis: Because I push a new string into it - it needs to be mutable
[17:25:07] <nmatsakis> obk: you don't push a new string, you just call find
[17:25:14] <nmatsakis> obk: the push comes later
[17:25:42] <nmatsakis> obk: (I don't mean that there is no way to write that code, I just mean that you can't make it type check the way you have it, I'll explain in 1 sec)
[17:25:43] <obk> I did call find above, and only reach there if it fails.
[17:25:55] <graydon> toddaaro: I think it's a different version. those discussing it are describing it as a thing that compiles the function to a rather self-contained state machine. just sugar for constructing an iterator. I think nearly-no runtime implication.
[17:25:58] *** Joins: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se)
[17:25:59] <obk> If I could nest the write lock in the read lock, I could just do an insert w/o find.
[17:26:31] <obk> But since I gave up the lock after the 1st find, I need to re-find and only insert if it isn't there - all under a single lock so I never add the same string twice.
[17:26:36] <Yurume> cmr, yeah, and I'm getting that error from ~ box in the &mut self. :(
[17:27:03] <obk> Not sure about the difference between find and find_equiv, but that's secondary I think.
[17:27:14] <nmatsakis> obk: read my comment, nesting a write lock inside read is logically impossible
[17:27:20] <nmatsakis> obk: but that's not the main issue 
[17:27:39] *** Joins: Florob (Florob@moz-39532932.de)
[17:27:48] <toddaaro> graydon: conceptually a generator with yield is like a coroutine where you save your context and invoke the yield continuation to return an element, which is very similiar to how the runtime will use the yield keyword, so there is cognitive overlap
[17:28:00] <nmatsakis> obk: the reason that the type checker gets unhappy with you, is that you are returning borrowed pointers from inside the region where the lock is held; however, those borrowed pointers are only valid so long as the map is not changed,
[17:28:09] <nmatsakis> obk: and once the lock is released, there is no guarantee that it will not change
[17:28:20] <nmatsakis> obk: so what you need to do is ... well, I'll add a comment on the issue
[17:28:31] <obk> Thanks
[17:28:33] <kimundi> bstrie: Anyway, bigger design decisions withstanding, '.or_some(x)' can already be written as '.or(Some(x))' today. Seeing how Some is the constructor for the type itself, having a little convenience method for that operation seems like no big deal. Of course, if it is, I'll exclude it... It just seems natural to me.
[17:28:58] <toddaaro> graydon: we are likely to get that usecase in the runtime and want to call it yield, but if it shares a name with a totally different yield implementation it is confusing
[17:29:20] <toddaaro> graydon: so some set of thoughts on what to name things need to happen
[17:29:56] <graydon> toddaaro: in this version of thinking, a generator is a single stack frame (reified into a state-object), not a full continuation.
[17:29:56] <Ms2ger|cat> kimundi, but then you have to construct the Some
[17:30:19] <obk> nmatsakis: I see your point about upgrading the locks, yes, you can't do that unless you do an STM model, which you really don't want to :-)
[17:30:23] <toddaaro> graydon: yea, the implementation has nothing in common, but if you ignore the implementation they are very closely related
[17:30:47] <toddaaro> graydon: and that is what I think is potentially problematic, as I don't know any good alternate words for either
[17:30:48] <graydon> toddaaro: when you're talking about an iterator that consists of (say) a pointer and a state-number, then it's 2 words. a task is thousands to millions of words. it's substantially different.
[17:30:59] <kimundi> Ms2ger|cat: Yes? Sorry, I don't understand your point :(
[17:31:02] <toddaaro> graydon: but that is just implementation detail
[17:31:20] <Ms2ger|cat> kimundi, never mind
[17:31:24] <nmatsakis> obk: https://github.com/mozilla/rust/issues/8457#issuecomment-22582567
[17:31:29] <graydon> toddaaro: no. it also doesn't contain a real continuation.
[17:31:36] <nmatsakis> obk: short version: change find to find_copy
[17:31:50] <graydon> toddaaro: it's not just an implementation detail. any more than "byte" vs. "bignum" are "implementation details"
[17:32:17] *** Joins: lmandel (lmandel@moz-57D3C086.dsl.bell.ca)
[17:32:49] <graydon> actually .. I don't know what I'm arguing about here. I'm sorry. I seem to still be yelling-prone today.
[17:33:06] <cmr> It *is* an implementation detail, it's just a really important one
[17:33:08] <toddaaro> if you think it won't be confusing I'd say we use the same name
[17:33:28] <toddaaro> and in the future provide the same "syntax extension" stuff to coroutine-implemented generators
[17:33:29] <graydon> you're concerned about the name being recycled, yes?
[17:33:40] <toddaaro> mostly
[17:33:41] <nmatsakis> what is this talk of the runtime using the yield keyword?
[17:33:46] <graydon> as a function name
[17:33:54] <graydon> "yield this green task"
[17:33:57] <nmatsakis> can't it.. just call it yield_yask
[17:33:59] <nmatsakis> *yield_task
[17:34:00] <nmatsakis> or something
[17:34:09] <graydon> sure
[17:34:09] *** Joins: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de)
[17:34:16] <nmatsakis> or is it just that it might be confusing because it's a timeslice and not a generator thing-y
[17:34:47] <graydon> and for that matter, if the generator stuff can be encapsulated in a syntax extension, it's not _that_ important that 'yield' be a keyword.
[17:34:54] <graydon> it can just be an ident that the extension cares about
[17:34:55] <toddaaro> I'm not sure what the best course is, but the runtime wants yield, and in the future it will likely be used to implement generators of various sorts
[17:35:22] <nmatsakis> graydon: one issue with using a syntax extension is that we currently have no way to say "parse Rust code except for with this new keyword `yield`"
[17:35:22] <toddaaro> so coming up with some sort of story for how generator yield relates to runtime yield and naming things appropriately merits some nontrivial thought
[17:35:30] <toddaaro> I don't have many more thoughts than that
[17:35:43] <graydon> nmatsakis: true. it'd be an .. invasive one.
[17:35:50] <graydon> hard-to-write
[17:35:55] <nmatsakis> graydon: so you'd effectively have to reimplement the Rust grammar -- though conceptually we could add an option to the parser to dynamically extend keyword set with callbacks, and then a programmatic syntax extension could call that 
[17:36:02] <graydon> yeah
[17:36:04] <graydon> bleh
[17:36:23] <graydon> ok maybe a keyword to be safe then. I don't really want to dig too deep into the problem space at this point. it feels post-1.0-ish to me
[17:36:28] <obk> nmatsakis: find_copy solved the problem and I have working code. Thanks!
[17:36:40] <nmatsakis> (I personally think the runtime yield should just be renamed -- generators seem like something one will use far more often than this relatively internal scheduling fn)
[17:36:42] <graydon> I wouldn't want to take a form of generators that caused much in the way of complications of the memory model or failure model or such.
[17:37:04] <nmatsakis> I would rather prefer them to be a syntax extension
[17:37:17] <nmatsakis> but basically yes
[17:37:33] <nmatsakis> some form of syntactic sugar would be nice, but I don't want to have to modify anything in the type system for it
[17:38:19] * cmr would rather hit milestone #1 than entertain more features
[17:38:50] <nmatsakis> (strongly agree on post 1.0 nature of this feature)
[17:39:05] <nmatsakis> graydon: I say reserve the keyword, but hope we don't need it
[17:39:12] <graydon> yeah
[17:39:19] <toddaaro> nmatsakis: I think yield might end up with a fair bit of use, so thinking of it as a lower class function could backfire. Impossible to tell at this point though, we don't even have a concept for what yield would do in the current runtime, it is a noop.
[17:39:32] <graydon> I often point out the number of reserved words that seem not to be harming other languages based on similar future-speculation.
[17:39:34] <nmatsakis> toddaaro: I guess I think people can handle the context
[17:39:49] <nmatsakis> toddaaro: to undersstand that yield in a generator !== scheduler yield
[17:40:07] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[17:40:18] <toddaaro> nmatsakis: in the simple case sure, but when you get people implementing generators with scheduler yield the confusion can start
[17:40:19] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[17:40:20] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[17:40:24] * nmatsakis rebuilds LLVM for the 2nd time today. I guess it's time to install ccache
[17:40:38] <toddaaro> brson: ok, so the segfaults I was having were entirely NO_REBUILD
[17:40:41] <cmr> nmatsakis: ccache + -j12 is wonderful
[17:41:00] <nmatsakis> toddaaro: then call it "surrender_timeslice"
[17:41:02] <toddaaro> so that pretty solidly makes the case that NO_REBUILD + stage1 doesn't work for runtime tests
[17:41:04] <nmatsakis> :)
[17:41:24] <toddaaro> nmatsakis: yea, something, I mostly just want this pondered through at some point
[17:41:57] <toddaaro> I'll update the check-stage0-std issue, as it looks like you just can't do runtime dev without it
[17:41:59] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[17:42:06] <toddaaro> \rainbow{self hosting}
[17:42:18] *** Joins: robarnold (rob@BD56354E.DB510C09.6E370BFC.IP)
[17:43:46] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[17:45:19] <nmatsakis> erickt_: ping
[17:45:34] <nmatsakis> cmr: do you use any special configuration options?
[17:45:40] <nmatsakis> cmr: (to get good use of ccache?)
[17:45:48] <cmr> nmatsakis: ./configure --enable-clang --enable-ccache does it all
[17:45:51] <brson> graydon: i'm going to spend some more time looking into perf today, but i need to get a few servo things done too
[17:46:01] <graydon> brson: ok
[17:46:08] <graydon> brson: I'm mid way through testing the nopt split
[17:46:13] <nmatsakis> cmr: oh? is clang specially integrated with ccache in some way?
[17:46:27] <graydon> brson: if that sticks I'll go over to looking at .. the next-most-terrible things I see in profiles.
[17:46:28] <cmr> nmatsakis: no, but it's faster.
[17:46:31] <nmatsakis> cmr: ah ok
[17:46:38] <cmr> (than gcc)
[17:46:43] <cmr> if you're on a mac that doesn't matter :p
[17:46:57] <graydon> brson: also want to polish off the condition tutorial and land it
[17:47:33] <obk> Is there a way to tell whether a task is the root task of the program, or a sub-task (as in, parent_task() -> Option<Task> or some such)?
[17:47:49] <brson> obk: no
[17:48:02] <obk> brson: Thanks :-(
[17:48:23] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[17:48:31] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:49:01] * nmatsakis so sick of rebasing #3678
[17:49:15] <toddaaro> obk: what do you need to know for?
[17:49:30] *** Quits: ozten (ozten@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ozten)
[17:51:31] <nmatsakis> if anyone is curious about that article I mentioned regarding passing arguments in the wrong order, here it is http://mp.binaervarianz.de/tse2013.pdf
[17:52:15] *** Joins: Odiel (Mibbit@moz-526E04A.cable.teksavvy.com)
[17:52:37] <Odiel> Hi everyone
[17:52:50] <bstrie> Odiel: hello
[17:53:27] <Odiel> just wanted to know if there is any good examples or guides talking about the use of Rust for web developpment?
[17:53:47] *** Joins: Sergio965 (sergiobz@moz-8D70E596.wireless.csail.mit.edu)
[17:54:04] <cmr> Odiel: It has not been used for such.
[17:54:22] <cmr> Rust is still very unstable.
[17:54:40] <Odiel> yes I read that
[17:55:02] <Odiel> is still a very new language
[17:55:50] <cmr> ChrisMorgan is working in this area atm
[17:56:00] <Odiel> making it stable?
[17:56:01] <cmr> Wrote a webserver, is going to write a framework of some sort
[17:56:03] <cmr> No
[17:56:12] <Odiel> ahh, I see
[17:56:17] <Odiel> thats great
[17:59:28] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Ping timeout)
[17:59:36] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[18:00:44] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Ping timeout)
[18:00:44] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[18:00:44] *** ChanServ sets mode: +o tjc
[18:02:08] <kmc> Rust isn't the sort of language I'd use for a garden variety webapp
[18:02:18] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:02:29] <kmc> Rust is a low-level systems language, comparable to C++ (but a lot safer and better in other ways)
[18:03:00] <kmc> if you need very high throughput or predictably low latency from your webapp, it could be a great choice
[18:03:51] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[18:05:19] *** Ms2ger|cat is now known as Ms2ger
[18:06:22] *** Quits: Jesin (Jessin_@moz-3AD6F09F.res.lehigh.edu) (Quit: Leaving)
[18:07:43] *** Quits: miloshadzic (miloshadzi@5E9C7FE4.FA4D0618.449B8A48.IP) (Quit: Textual IRC Client: www.textualapp.com)
[18:09:04] *** Joins: ozten (ozten@moz-BE33DA21.fw1.sfo1.mozilla.net)
[18:09:33] *** Joins: fabiand (fabiand@moz-F49693AB.adsl.alicedsl.de)
[18:10:17] <brson> bblum: re this line https://github.com/mozilla/rust/blob/master/src/libstd/select.rs#L66 can a task be woken up immediately after calling block_on? is there an environment race here?
[18:11:38] <bblum> brson: that used to be true; that race is what the callback/oneshot is for (see the XXX comment above)
[18:12:10] <brson> bblum: ok, i se
[18:12:23] <brson> bblum: also, is there a way currently to select on two ports of different types?
[18:12:50] <bblum> brson: currently no... the commented-out code below would enable it, but there is a &Trait bug that stops it from working for now
[18:13:13] <bblum> (the code would also scale to select3, select4, etc)
[18:13:46] <brson> bblum: it looks like there's still an environment race there on cell 'c', since it's part of the env. does c.take() need to be called before task.make_selectable?
[18:15:08] <bblum> brson: no, the fact that the task blocks until c is sent on protects the environment
[18:15:13] *** Joins: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru)
[18:15:23] <bblum> brson: however, there is a bug in that recv should be inside a finally block in case the task gets killed
[18:15:35] <bblum> in which case it currently does not protect the environment :P
[18:15:59] <brson> oh, right
[18:17:09] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[18:19:09] <bblum> brson: the task blocking on a message send is basically a heavier-handed, more open-coded version of the various protections i suggested for putting inside the context switcher
[18:19:17] <bblum> same guarantees though
[18:20:04] *** Quits: alisdair (textual@moz-4833EC3E.eng.wind.ca) (Ping timeout)
[18:20:42] *** Quits: Odiel (Mibbit@moz-526E04A.cable.teksavvy.com) (Quit: http://www.mibbit.com ajax IRC Client)
[18:20:43] *** Joins: ecr (Thunderbir@moz-BBE3ABD.mv.mozilla.com)
[18:21:48] *** Joins: Odiel (Mibbit@moz-526E04A.cable.teksavvy.com)
[18:21:53] <brson> are there intern presentations today?
[18:22:25] <bblum> yep, me, eatkinson, and eschweic 
[18:22:33] * bblum frantically working on slides
[18:25:24] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[18:25:27] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[18:25:54] <tjc> what time is the first intern talk today?
[18:28:08] *** Quits: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se) (Ping timeout)
[18:29:43] <Sergio965> I wanna go to the intern talks!
[18:30:03] <cmr> Sergio965: they will be broadcast on http://air.mozilla.org/
[18:30:13] <Sergio965> That's neat.
[18:30:56] <cmr> "Types of Types in Rust"
[18:30:59] <cmr> bblum: nice title
[18:31:15] <bblum> thanks
[18:31:19] <bblum> hopefully i'll have slides too
[18:31:49] *** Joins: Palmik (palmik@moz-CC484FDD.tmcz.cz)
[18:32:34] <doomlord_> default arguments... i should get used to using enums more..
[18:34:10] *** Joins: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP)
[18:34:53] <ecr> Can't be that much to the talk, all the types have kind * :P
[18:35:48] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:36:53] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[18:37:03] <ecr> brson: I think we're going to be stuck with having every accepted connection from a TCP listener on the same event loop as the listener. I can't figure out a way to delay acceptance and let it move to another loop.
[18:38:01] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[18:39:16] <brson> ecr: ok. we'll have to work with libuv upstream to make that work in the future
[18:39:27] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[18:40:07] *** Quits: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de) (Ping timeout)
[18:41:35] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:44:30] *** bent is now known as bent|lunch
[18:45:05] *** Quits: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru) (Quit: dim-an)
[18:45:19] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[18:46:03] *** Quits: fabiand (fabiand@moz-F49693AB.adsl.alicedsl.de) (Quit: Verlassend)
[18:46:06] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:46:13] *** Joins: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se)
[18:48:04] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[18:48:28] <ecr>  bblum: what time is your presentation?
[18:48:49] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[18:48:55] <bblum> ecr: 1330
[18:54:22] <obk> Is there a way to access crate attributes from within the program? Specifically, if I want to print the version number in a help string.
[18:54:43] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[18:55:37] <cmr> obk: no, not yet.
[18:55:54] <obk> cmr: Oh, so it is intended that there will be one?
[18:55:57] <cmr> A syntax extension that did that would be pretty cool
[18:56:04] <cmr> obk: not that I know of, but nothing precludes the feature.
[18:56:12] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[18:56:20] <Sergio965> No more syntax extensions!
[18:56:23] <Sergio965> I don't like them.
[18:56:30] <obk> Ok. I can work around it - I generate the version string from git anyway, I can embed it in a .rs file while at it.
[18:56:35] <Sergio965> They make things 'look' like they're part of the language, but in reality, they're part of the library.
[18:56:55] <cmr> Sergio965: that's kinda the point.
[18:57:00] <obk> Why a syntax extension? Some API would do the trick.
[18:57:20] <Sergio965> cmr: Why not just make it actually part of the library?
[18:57:29] <cmr> Sergio965: Because they happen at compiletime, not runtime.
[18:57:38] <Sergio965> Oh. They do? Like what?
[18:57:40] <Sergio965> fmt!
[18:57:42] <Sergio965> ?
[18:57:45] <cmr> fmt happens at compile time
[18:57:48] <cmr> env! happens at compile time
[18:57:50] <Sergio965> fmt is broken.
[18:57:51] <cmr> cfg! happens at compile time
[18:57:58] <cmr> ifmt! happens at compile time
[18:58:03] <cmr> macro_rules! happens at compile time
[18:58:08] <cmr> they all happen at compile time :p
[18:58:11] <Sergio965> But, fmt! requires so much runtime support to work.
[18:58:22] <cmr> In its current implementation yes.
[18:58:24] <cmr> So what?
[18:58:30] <doomlord_> syntax extentions are appropriate for that sort of thing IMO.  file!( ) .. line!( ...) great for debug.. version!( .. ) ? sounds good to me
[18:58:45] <Sergio965> And I can't implement fmt! myself.
[18:58:59] <cmr> Not yet no, because user-defined syntax extensions haven't been implemented.
[18:59:08] <Sergio965> Procedural macros?
[18:59:21] <cmr> Same thing
[18:59:22] *** Quits: milinda (milinda@DA212585.7CFC0820.51B6877.IP) (Input/output error)
[18:59:52] <pauls> At that point, the term "syntax extension" could be dropped entirely in favor of calling everything spelled with `!` a macro.
[19:00:12] <Sergio965> Procedural macros are fantastic.
[19:00:14] <Sergio965> We need those.
[19:00:18] <cmr> That's what fmt! is
[19:00:21] <cmr> and cfg! and env!
[19:00:34] <Sergio965> Well, no it's not.
[19:00:38] <Sergio965> Because I can't write one.
[19:00:42] <cmr> Yes you can.
[19:00:45] <Sergio965> I can?
[19:00:46] <cmr> You just need to write it in libsyntax.
[19:00:47] *** Joins: milinda (milinda@DA212585.7CFC0820.51B6877.IP)
[19:01:31] <Sergio965> I wasn't aware of this. Weren't we talking about Rust getting procedural macros the other day?
[19:01:42] <cmr> It already has them! Just not pluggable.
[19:01:56] <pauls> Most things you want to extend syntax for are writeable with pattern-matching, however.
[19:02:07] <Sergio965> pauls: But that's at runtime.
[19:02:19] <cmr> Macros are pattern matching.
[19:02:22] <cmr> (macro_rules! macros)
[19:02:30] <pauls> Sergio965: macros are all compile-time
[19:02:35] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[19:02:45] <Sergio965> pauls: But I want to do something like what fmt! does.
[19:03:05] <graydon> hmph
[19:03:12] <pauls> (in fact, you could write something like `fmt!` if it disassembled a special syntax instead of a string literal)
[19:03:18] <graydon> test rand::bench::rand_isaac ... bench: 68 ns/iter (+/- 4) = 117 MB/s
[19:03:18] <graydon> test rand::bench::rand_unixrng ... bench: 7303 ns/iter (+/- 557) = 1 MB/s
[19:03:18] <graydon> test rand::bench::rand_xorshift ... bench: 35 ns/iter (+/- 2) = 228 MB/s
[19:03:31] <cmr> graydon: unixrng being urandom?
[19:03:35] <graydon> yeah
[19:03:42] <cmr> Using std::io to read it?
[19:03:48] <engla> urandom should be tens of MB at least
[19:03:56] <engla> but not much more
[19:04:05] <cmr> yeah, that is a lot slower than I'd expect.
[19:04:07] <Sergio965> pauls: I have one written like that now. But I can't do string formatting with it. There aren't any "optional tokens" I can ask the macro to parse.
[19:04:15] <graydon> using libc::read to get 4 bytes per iter
[19:04:24] <graydon> because our rand interface is next() -> u32
[19:04:36] <cmr> I'm guessing it's FFI overhead.
[19:04:51] <nmatsakis> any advice for debugging LLVM assertions that occur after trans?
[19:04:53] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[19:04:59] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:05:03] <Sergio965> pauls: IE: I can't do %02x.
[19:05:12] <graydon> cmr: probably. also non-buffered reading. lots of syscalls.
[19:05:19] <graydon> cmr: I'll poke at it after lunch.
[19:05:25] <graydon> anyway, it "works"
[19:05:35] <pauls> Sergio965: it's a bit tricky; you need to use multiple input patterns and have matching fail until it selects the right one...
[19:05:51] <Sergio965> pauls: Sounds like a work around rather than a solution.
[19:05:58] <pauls> ...and you need to use a bunch of recursive macro definitions to get there.
[19:06:16] <pauls> gotta go
[19:06:33] <pauls> (it's weird, but it's not as bad as it may sound)
[19:07:50] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[19:08:40] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:08:40] *** ChanServ sets mode: +o tjc
[19:08:40] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:11:01] *** Quits: Sergio965 (sergiobz@moz-8D70E596.wireless.csail.mit.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[19:13:07] *** Quits: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com) (Ping timeout)
[19:13:20] *** Quits: obk (Mibbit@moz-B0F26027.red.bezeqint.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:13:27] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[19:14:10] *** Joins: miloshadzic (miloshadzi@5E9C7FE4.FA4D0618.449B8A48.IP)
[19:16:44] <brson> graydon: bors is ignore me on https://github.com/mozilla/rust/pull/8475
[19:17:48] *** Joins: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru)
[19:17:49] <graydon> brson: bors is not running
[19:17:59] <graydon> brson: I turned it off while testing the new builders
[19:18:27] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[19:18:46] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[19:18:56] <graydon> will re-enable after lunch
[19:19:02] <graydon> (if all goes well)
[19:19:19] <toddaaro> brson: idlecall back change was a 35% speedup in the message passing benchmark
[19:19:28] <toddaaro> brson: but with the disclaimer that one test case is failing mysteriously
[19:20:46] <brson> toddaaro: sweet!
[19:21:03] *** Joins: Sergio965 (sergiobz@moz-6AF4AC69.dyn.mit.edu)
[19:21:51] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[19:22:00] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[19:23:24] <brson> so much of the unoptimized profile is dominated by tls accessors :(
[19:23:47] <cmr> eatkinson: good job, very interesting
[19:24:09] <eatkinson> thanks cmr, glad you liked it
[19:24:56] *** Quits: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP) (Quit: brendan)
[19:25:39] <toddaaro> brson: test_spawn_sched is the one, it is in task/mod.rs
[19:26:28] <toddaaro> brson: event_loop.run() is returning with messages in the queue, so I am thinking the "final" handle is destructed after being used to send a message, and the message check callback is forgoton
[19:26:34] <bblum> bors is become ignore me, slayer of pulls
[19:26:37] <toddaaro> brson: so maybe I'll try putting handles in messages
[19:26:57] <toddaaro> brson: (major slowdown until handles are optimized, but that is a trivial todo)
[19:27:28] <toddaaro> well, relative to the message overhead it might not be a big deal at all
[19:27:50] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[19:29:13] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:29:27] *** Joins: pcwalton (pcwalton@moz-4F2F08F2.datalock.co.nz)
[19:29:27] *** ChanServ sets mode: +o pcwalton
[19:29:30] <tjc> cool, gdb is telling me "set a breakpoint in malloc_error_break" to debug and then not breaking there
[19:29:30] <tjc> nice
[19:30:19] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[19:30:20] <bblum> that's its passive-aggressive way of telling you it's disappointed in you
[19:30:37] <bblum> it always thought you would grow up to be a programmer who wrote correct code the first time every time
[19:30:39] *** Joins: dherman (dherman@moz-BBE3ABD.mv.mozilla.com)
[19:30:39] *** ChanServ sets mode: +o dherman
[19:30:40] *** Quits: milinda (milinda@DA212585.7CFC0820.51B6877.IP) (Input/output error)
[19:30:41] <kmc> building the very latest Rust, I get librustrt.so: undefined reference to `uv_tcp_simultaneous_accepts'  (and other libuv symbols similarly)
[19:30:45] <jack> tjc: i am having lots of gdb issues lately too.
[19:30:45] <kmc> anyone know what's up?
[19:30:55] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[19:30:55] *** ChanServ sets mode: +o brson
[19:31:15] <tjc> bblum: Yeah, but I'm trying to debug someone *else's* code this time :P
[19:34:05] <bstrie> kimundi: I'd actually rather that .or_some be excluded, it's just not a win to have a method that's exactly the same as .or(Some)
[19:34:17] <bstrie> kimundi: I'm not a big fan of TIMTOWTDI :)
[19:34:49] <bstrie> also, adding methods is backwards-compatible, and removing them isn't. better to err on the side of caution
[19:37:24] <cmr> bstrie: only API compat, not ABI
[19:37:40] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[19:37:41] <cmr> well, for traits
[19:37:45] <cmr> this probably isn't a trait
[19:37:47] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[19:39:32] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[19:44:38] *** Joins: milinda (milinda@DA212585.7CFC0820.51B6877.IP)
[19:44:42] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[19:45:45] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[19:50:18] *** Joins: igl (igl@moz-5A5A4EC6.adsl.alicedsl.de)
[19:51:31] *** Quits: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[19:51:54] *** Quits: reyre (reyre@FCCEA34F.7672369.D8E68FF6.IP) (Client exited)
[19:52:26] *** Joins: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:53:22] *** Quits: milinda (milinda@DA212585.7CFC0820.51B6877.IP) (Input/output error)
[19:54:34] <strcat> kmc: maybe missing a git submodule update?
[19:54:38] *** Joins: milinda (milinda@DA212585.7CFC0820.51B6877.IP)
[19:56:01] *** bent|lunch is now known as bent
[19:56:08] *** Joins: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP)
[19:56:26] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Computer has gone to sleep.)
[19:58:21] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[19:58:41] <veddan> I haven't been able to build master for a couple days
[19:58:49] <veddan> Error is: "error: unrecognized intrinsic function: `i64_mul_with_overflow`"
[19:58:59] *** Joins: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net)
[19:59:04] <veddan> and similar for other types than i64
[19:59:23] *** Quits: Palmik (palmik@moz-CC484FDD.tmcz.cz) (Quit: Lost terminal)
[19:59:38] <kimundi> bstrie: okay, removing it. The rest is fine, right?
[20:00:24] *** Joins: milinda_ (milinda@moz-A7272ABE.dhcp-bl.indiana.edu)
[20:01:03] *** Quits: devinus (devinus@moz-B4AF84BC.ptr.us.xo.net) (Quit: Textual IRC Client: www.textualapp.com)
[20:01:18] *** Quits: milinda (milinda@DA212585.7CFC0820.51B6877.IP) (Ping timeout)
[20:02:18] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[20:04:18] *** Joins: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP)
[20:05:40] <kimundi> bstrie: removed and rebased it
[20:06:03] <kmc> strcat: yeah, can't repro on a clean checkout
[20:12:32] <brson> veddan: that error indicates that you are somehow building with an old rustc. have you tried a 'make clean'?
[20:12:58] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[20:16:19] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[20:16:33] <veddan> brson: I've tried make clean && make -j4, but it doesn't help. 
[20:17:20] <veddan> If memory serves, the problem is there even on a fresh git clone (without --enable-local-rust), but I'll try it again
[20:17:21] <cmr> veddan: you might need to re-run the configure script to update the llvm submodule?
[20:19:23] *** Quits: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se) (Ping timeout)
[20:20:10] *** Joins: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP)
[20:21:20] <veddan> cmr: Do I need to do anything to convince it to update? It says: f67442eee27d3d075a65cf7f9a70f7ec6649ffd1 src/llvm (remotes/origin/llvm-33)
[20:21:59] <cmr> veddan: no, that's right
[20:22:43] <veddan> cmr: I building a fresh clone right now. I'll see how it goes.
[20:24:56] *** Joins: jaen (jaen@moz-D2DF94DF.play-internet.pl)
[20:26:35] <orshem> S is a struct, what's impl &S {} means?
[20:27:01] <engla> bblum talking now
[20:27:03] <tjc> orshem: that's saying you want to implement no methods on the type of references to S, but I'm not sure why you ever would
[20:27:23] <orshem> i remember seeing it in code, but now when i tried to compile a small example i get: Illegal anonymous lifetime: anonymous lifetimes are not permitted here
[20:27:31] <pcwalton> impl &S is forbidden now
[20:27:38] <pcwalton> that sort of thing used to be done a few months ago
[20:27:51] <rntz_> pcwalton: presumably the error message should be nicer than "anonymous lifetimes are not permitted here", though
[20:27:57] <pcwalton> yeah
[20:28:06] <pcwalton> i mean, it's true that anonymous lifetimes are not permitted there
[20:28:07] <orshem> tjc, pcwalton : thanks
[20:28:11] <orshem> engla, link?
[20:28:18] <engla> https://air.mozilla.org/2013-intern-presentations-august-13/
[20:28:19] <pcwalton> but also lifetimes or references are not permitted there :)
[20:30:14] <orshem> engla, thanks!
[20:30:24] *** Quits: milinda_ (milinda@moz-A7272ABE.dhcp-bl.indiana.edu) (Ping timeout)
[20:30:35] *** Quits: FDS (arnaud@moz-CE4D5907.bdx.modulonet.fr) (Ping timeout)
[20:30:38] <veddan> cmr: the problem also appears on a fresh clone
[20:30:56] <eatkinson> pcwalton: was copy not removed?
[20:31:03] <eatkinson> oh nvm
[20:31:04] <pcwalton> it was removed
[20:31:06] <pcwalton> :)
[20:31:19] <veddan> I just did
[20:31:20] <veddan> git clone https://github.com/mozilla/rust.git && cd rust && ./configure --enable-clang && make -j4
[20:31:28] <veddan> and it failed to build
[20:31:52] <veddan> at compile_and_link: x86_64-unknown-linux-gnu/stage1/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd.so
[20:33:43] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[20:35:12] <tjc> Are there any known bugs involving passing an Option of a &-vector?
[20:35:27] <cmr> tjc: not that I know of.
[20:35:29] <Sergio965> Is there an ETA on 0.8?
[20:35:34] <cmr> Sergio965: 2 months
[20:35:38] <Sergio965> :(
[20:35:41] <cmr> We release every 3 months
[20:35:45] <Sergio965> But there's so much good stuff in there.
[20:35:47] <cmr> They are time-based snapshots
[20:36:10] <Sergio965> How about a 7.5 tag?
[20:36:17] <cmr> What would it be?
[20:36:19] <cmr> Just use master
[20:36:25] <Sergio965> But it changes.
[20:36:30] <cmr> Not if you don't update it.
[20:36:32] <orshem> arc has nothing with to do with atomic operations, right?
[20:36:38] <toddaaro> a delay is probably good
[20:36:46] <cmr> orshem: it's atomic reference counting.
[20:36:46] <Sergio965> orshem: Yeah. It's "atomic reference counting".
[20:36:52] <toddaaro> there is a huge amount to do to get the new runtime and IO up and really ready
[20:37:15] <Sergio965> cmr: Yeah, but I have a vagrant + puppet auto deployment that I use to show people my stuff.
[20:37:24] <orshem> Sergio965, cmr: thanks
[20:37:29] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[20:37:31] <Sergio965> cmr: And having it pull a new version of Rust would lead to unexpected problems.
[20:37:39] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[20:37:42] <cmr> Sergio965: use the hash
[20:37:46] <mcpherrin> Sergio965: Just pick a revision to pull
[20:37:51] <Sergio965> But then I have to build it...
[20:37:53] <Sergio965> And it takes forever.
[20:38:34] <mcpherrin> That's kinda true.  It might be worthwhile to have "rust weeklies" or something, even unofficially.
[20:39:10] <cmr> strcat has daily builds as arch packages, that should be fairly portable.
[20:39:28] <Sergio965> Yeah, someone has a ppa for nightlies.
[20:39:37] <Sergio965> But it's updated nightly.
[20:39:39] <Sergio965> :P
[20:39:44] <cmr> Just don't update.
[20:39:49] <cmr> Take the .deb and distribute it
[20:40:08] <Sergio965> I can't just "not update".
[20:40:17] <Sergio965> The whole point is to be able to provision a dev environment.
[20:40:20] *** Quits: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net) (Ping timeout)
[20:40:28] <Sergio965> Without keeping a huge ISO around.
[20:40:53] <Sergio965> I guess I could make my own PPA.
[20:41:23] <Sergio965> But an officially "supported" Rust 0.75 would be sweet.
[20:41:35] <cmr> 0.7 isn't even officially supported :p
[20:41:53] <cmr> Releases are purely time-based snapshots, they represent nothing about stability or suitability for use
[20:42:20] <Sergio965> But aren't there milestones on Github?
[20:42:38] <cmr> Yes, none of them have been reached, and they also don't correspond to releases
[20:42:55] <Sergio965> I see, I see.
[20:43:03] <cmr> They are maturity levels
[20:43:18] <Sergio965> I mostly want the "for x in y" iterator syntax.
[20:43:28] *** Joins: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de)
[20:43:39] <orshem> einstein did look a bit like a bird..
[20:47:19] <sully> hm, so, I seem to remember hearing somebody talk about enum structs?
[20:47:32] <cmr> sully: what about them/
[20:47:41] <sully> are they documented, do they work?
[20:47:43] *** Quits: Ms2ger (Ms2ger@moz-3E74B52D.adsl-dyn.isp.belgacom.be) (Quit: nn)
[20:47:47] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[20:48:01] <cmr> http://static.rust-lang.org/doc/rust.html#enumerations
[20:48:04] <cmr> struct-like variants
[20:48:07] <cmr> Yes, they work quite well
[20:48:17] *** Joins: guitsaru (guitsaru@10BE83CF.5DF68D0E.4C2245EF.IP)
[20:48:20] *** Quits: guitsaru (guitsaru@10BE83CF.5DF68D0E.4C2245EF.IP) (Quit: guitsaru)
[20:49:06] <orshem> pcwalton, tjc: is impl @S a thing?
[20:49:09] <pcwalton> no
[20:49:09] *** Quits: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP) (Ping timeout)
[20:49:19] <tjc> orshem: no, instead you would write a method that takes an @S self
[20:49:52] <tjc> so, I have some news, there's a bug involving passing an Option of a &-vector
[20:50:14] <cmr> tjc: testcase?
[20:50:23] <tjc> cmr: working on it
[20:50:26] <cmr> k
[20:50:27] <orshem> tjc, great :) love hearing that. sorry to say it but the language is big enough as it is. 
[20:50:36] <cmr> bblum: nice job
[20:50:43] <tjc> orshem: yeah, we're definitely working on trying to resist as many feature suggestions as possible at the moment :-)
[20:50:59] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:51:13] <bblum> cmr: thanks :)
[20:51:19] *** Joins: andresgut (Mibbit@27ECC323.EB18EA40.AE3C3E9A.IP)
[20:51:20] <bblum> jack: wee :)
[20:51:27] <sully> cmr: when you match on them, though, you have to bind all the fields you want?
[20:51:54] <cmr> sully: yes, if I understand what you mean correctly.
[20:52:06] <sully> ok, hm
[20:52:15] <cmr> I use one here: https://github.com/cmr/rustdoc_ng/blob/master/clean.rs#L463
[20:52:22] <sully> so that's a downside, relative to defining a new struct to go in the arm
[20:52:30] *** Joins: TD-Linux (TD-Linux@E338EB99.2B4F0AE0.A0A36CCE.IP)
[20:53:30] *** jen is now known as ofeldt
[20:55:08] *** Joins: Diamond (dick@moz-C01E1CD1.ks.ks.cox.net)
[20:55:35] *** Quits: pcwalton (pcwalton@moz-4F2F08F2.datalock.co.nz) (Quit: pcwalton)
[20:56:39] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:58:08] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[20:58:31] *** Joins: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se)
[20:58:46] *** Quits: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[20:59:31] <cmr> sully: it's exactly the same as pattern matching against any other struct?
[20:59:46] <sully> well, if you have an enum arg with a named struct in it
[20:59:53] <sully> you can either pattern match into the struct, or just bind the struct
[20:59:59] <cmr> oh, right
[21:02:03] *** Joins: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net)
[21:03:19] *** Joins: TwatSlime (TwatSlime@206E1A32.DB72F871.5CDC7B37.IP)
[21:04:53] *** Quits: TwatSlime (TwatSlime@206E1A32.DB72F871.5CDC7B37.IP) (User has been banned from Mozilla (no spamming here))
[21:08:36] *** Quits: wilmoore (wilmoore@moz-1248C037.mystrotv.com) (Connection reset by peer)
[21:08:52] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[21:08:55] *** Joins: wilmoore (wilmoore@moz-1248C037.mystrotv.com)
[21:10:04] *** Joins: wilmoore_ (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:10:37] *** Quits: wilmoore (wilmoore@moz-1248C037.mystrotv.com) (Ping timeout)
[21:11:54] *** Quits: wilmoore_ (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:12:07] <bblum> sigh @ global state not working in libstd test
[21:12:31] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[21:12:36] *** Joins: wilmoore (wilmoore@moz-1248C037.mystrotv.com)
[21:14:12] *** Joins: wilmoore_ (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:14:16] <ecr> what's the flag for displaying rtdebug! output?
[21:14:25] <cmr> ecr: build libstd with --cfg rtdebug
[21:14:37] *** Quits: wilmoore_ (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[21:14:53] *** Quits: wilmoore (wilmoore@moz-1248C037.mystrotv.com) (Ping timeout)
[21:15:03] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:15:55] *** Quits: maik_ (maik___@moz-E1B76F8B.dip0.t-ipconnect.de) (Ping timeout)
[21:16:35] *** Joins: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu)
[21:18:08] <cmr> Is it possible to have a @T where T does *not* fulfill 'static?
[21:18:14] <toddaaro> ecr: I added a make target in the main Makefile right under CFG_ENABLE_DEBUG
[21:18:22] <cmr> (I'm writing a tutorial about rust's memory management)
[21:18:30] <toddaaro> cmr: was there a Makefile tweak in your PR or do we need to add that in some other PR
[21:19:39] <cmr> toddaaro: there wasn't
[21:19:47] <cmr> Probably a configure option too?
[21:19:50] <cmr> --enable-rtdebug
[21:20:01] <toddaaro> cmr: maybe? I'm not sure where a configuration option would go
[21:20:06] <cmr> neither am I
[21:20:11] <cmr> I try to avoid the build system :p
[21:20:27] <toddaaro> I can PR the Make env variable, I guess with a note "dunno if there needs to be more stuff"
[21:21:30] <cmr> I think around line 376 in the configure script, `opt rtdebug 0 "build with runtime debugging"`
[21:22:00] <cmr> Which gets dumped into config.mk somehow
[21:22:17] <toddaaro> I feel like I should learn how all this works
[21:22:19] <toddaaro> but I really don't want to
[21:22:37] <graydon> linux-32-nopt-t finished in 1h22
[21:22:43] <graydon> \o/
[21:24:23] <graydon> toddaaro: struck by your reversed nick, I see!
[21:24:42] *** Quits: Sergio965 (sergiobz@moz-6AF4AC69.dyn.mit.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[21:24:45] <toddaaro> graydon: oh, yea
[21:25:03] <toddaaro> lastfirs is apparently nonstandard
[21:25:09] <bblum> lastfirs
[21:25:23] <graydon> I'm just glad you're not another of those "given name, IRC nick and github name are all different" people :)
[21:25:32] <bblum> blumbe
[21:25:34] <bblum> hoaregraydo
[21:25:43] <graydon> ugh that reads awful
[21:25:46] <graydon> blumbe is not bad
[21:25:53] <toddaaro> blumbe is fun to say
[21:26:19] <ecr> I guess I'm one of those all 3 are different people
[21:26:26] <SimonSapin> In a macro with a ident parameter, can I concatenate the ident to make new identifiers?
[21:26:42] <graydon> my minor dyslexic tendency means every time I read "toddaaro" on the screen I instead parse "toddaroo", and smile
[21:26:51] *** Quits: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP) (Quit: brendan)
[21:27:00] <bblum> haha toddaroo
[21:27:13] <graydon> SimonSapin: you're supposed to be able to, but I think I have had a hard time making it work in practice
[21:27:38] <toddaaro> toddaroo is slightly easier to say
[21:28:01] <graydon> I hope I didn't just curse you with a new awful informal nickname
[21:28:05] <toddaaro> if it was easily pronouncable I'd just go by toddaaro verbally and be done with ambiguity
[21:28:05] <ecr> the 'aroo' part makes me think of futurama nixon
[21:28:15] *** Joins: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP)
[21:28:47] * tjc has a different given name, IRC nick, and github name
[21:28:49] <tjc> so there :P
[21:29:02] <toddaaro> tjc: it took me around two months to figure out who you were
[21:29:12] <tjc> toddaaro: heh, well, I didn't know most of the interns' names for most of the summer :-)
[21:29:17] *** Joins: aatch (aatch@moz-B437F499.pocketrent.com)
[21:30:34] <graydon> they have been stealthy this year. sneak in, sneak out, fix the odd malfunctioning airconditioning duct along the way
[21:31:17] <tjc> heh
[21:31:54] <ecr> we even sweep the secret chimney free of charge
[21:32:29] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[21:32:30] *** Joins: richard|s (mindginati@moz-9C555AF3.spmconsultants.co.nz)
[21:33:19] <cmr> graydon: tjc: would you mind looking over a tutorial I'm writing? Mostly for correctness. https://gist.github.com/cmr/4d9664b8c65a521e82c9
[21:33:23] * cmr goes to cook dinner
[21:33:38] <tjc> cmr: sure, I'll take a look
[21:33:49] <graydon> cmr: I would try to not say "8 pointer types"
[21:35:20] <graydon> cmr: also not so keen on using the word "reference" in place of borrowed pointer.
[21:35:45] *** Quits: brendan (brendaneic@E908EF74.6BAC3F3B.56A6FAA.IP) (Quit: brendan)
[21:36:11] <doomlord> is your target audience for that c/c++ people , i'd have thought its those raised on GC that complain about multiple pointer types
[21:36:18] <graydon> cmr: and ... the fact that you use type inference in the rust example means the reader can't tell when something is a pointer or an interior structure, which I think is crucial to forming a useful mental model
[21:36:33] <cmr> graydon: I've always seen it as reference in here, very rarely as pointer
[21:37:12] *** Joins: cypher (ircnet@moz-1D494DB3.vie.surfer.at)
[21:37:15] <graydon> I am not really interested in trying to divine a philosophical difference between reference and pointer; I'm merely talking about profusion of terminology
[21:37:59] <graydon> you could think of it like a C++ & or like a C *, it's not really like either
[21:39:41] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[21:39:47] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[21:39:52] <graydon> we haven't decided what to do about the word "slot". it's no longer anywhere near simple enough to speak of the basis of ownership in terms of them.
[21:40:10] <graydon> the borrow checker operates on a memory ownership categorization system that's richer than just slots
[21:40:28] <graydon> slots were something we had in very early rust versions, the word has stuck around the docs for too long
[21:41:03] <graydon> I'd be inclined to remove it at this point until we have a better developed terminology, though I expect niko might have a set of terms he's most comfortable with.
[21:41:07] <rntz_> what is the basis of ownership, then? lifetimes?
[21:41:25] *** Joins: pcwalton (pcwalton@E2F7352.56080C53.97BBD552.IP)
[21:41:25] *** ChanServ sets mode: +o pcwalton
[21:41:54] <tjc> cmr: my suggested changes, mostly nits -- https://gist.github.com/catamorphism/2a80a60f9ba5bddf4870
[21:42:02] <veddan> cmr: "In Rust, there is no way to safely free memory." sounds a bit odd to me
[21:42:03] <tjc> I didn't see anything outright wrong, although we don't sue the word "slot" much anymore
[21:42:09] <tjc> don't use it, I mean
[21:42:27] <tjc> I thought the beginning could be improved a bit, but otherwise, looks pretty good
[21:42:55] *** Joins: pyrac (pyrac@moz-F2B1E85D.w92-162.abo.wanadoo.fr)
[21:42:56] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[21:44:42] <graydon> rntz_: every value has a single owner. the owner is either a task's stack or the gc. there is a path consisting of 1:N owner:ownee relationships -- owning pointers or embeddings -- between an owner and all the values it owns.
[21:45:56] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[21:46:38] <rntz_> graydon: interesting. although I think you might be forgetting static-lifetime things
[21:46:42] <graydon> rntz_: put another way, you program by moving around proper trees of ownership; multiple borrowed &-ptrs can point into a subtree but they don't own it and the subtree is always proven to outlive all of them.
[21:46:44] <rntz_> although I guess you could call those "owned by the GC"
[21:46:51] <sp3d> I don't like the notion of "slot" because it isn't something that's really familiar to the way C or C++ programmers think about memory management/ownership
[21:47:01] <rntz_> but yeah, that is a pretty nice way to explain it
[21:47:49] <graydon> rntz_: sure. stacks, gc and static lifetime. those outlive the program itself :)
[21:47:52] <rntz_> hrm. is the only way to have a circular data structure in rust to use @ptrs?
[21:47:56] <engla>  region or scope might be a more intuitive name for lifetime
[21:48:06] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[21:48:15] <graydon> rntz_: you can form them with &
[21:48:21] <rntz_> scope already has a very well-defined meaning that does not match "lifetime"
[21:48:32] <rntz_> graydon: really? impressive.
[21:48:51] <kmc> i like "lifetime"
[21:49:00] <rntz_> seems like you'd run into trouble with destruction order
[21:49:10] <rntz_> I guess I should go try it myself
[21:49:22] <graydon> depends if they have dtors. IIRC there's a bug on this.
[21:49:30] <mcpherrin> How do I do for vec::each2(a, b) |&u, &t| {  with the new for loops?
[21:50:09] <pcwalton> zip() I think
[21:50:12] <graydon> has to be outlawed, I think is presently unsound. long ago dtors were more limited to ensure they always run in the right order. I think it got accidentally relaxed.
[21:50:24] <engla> the confusion with lifetime is that you don't tie &T to the life of a ~T  (until it is freed)
[21:51:39] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[21:51:40] <ghrust> 01[13rust01] 15graydon pushed 1 new commit to 06master: 02http://git.io/yKevEA
[21:51:40] <ghrust> 13rust/06master 1426fd428 15Graydon Hoare: Merge pull request #8432 from chris-morgan/remove-assert-eq-macro-fail-binary...
[21:51:40] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[21:51:56] *** Quits: IRCMonkey33931 (heftig@moz-223ED7A6.dip0.t-ipconnect.de) (Ping timeout)
[21:52:16] <graydon> that was a force-merge on my part
[21:52:18] <pcwalton> just wanted to say that I remain extremely skeptical of trait resolution on ::
[21:52:32] <graydon> bors got confused and saw a failure
[21:52:33] *** Joins: IRCMonkey33931 (heftig@moz-B35D30A.dip0.t-ipconnect.de)
[21:52:43] <graydon> pcwalton: with respect to what?
[21:52:53] <pcwalton> there's a PR here https://github.com/mozilla/rust/pull/8438
[21:52:55] <graydon> bors is turned back on. cycle time should be further down now
[21:53:18] <pcwalton> so you could say int::sin() or whatever and it would search through all traits in scope for a trait that implements a method called sin()
[21:53:29] <pcwalton> people have asked for this feature a lot and I remain opposed
[21:53:53] <graydon> oh, huh
[21:54:13] <pcwalton> trait lookup on :: is just too magical for my taste and I am drawing a line in the sand regarding complexity of resolve
[21:54:21] <graydon> I .. have no strong feelings on it. I suspect they want to do it because it reads C++-ish. why trait based?
[21:54:25] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[21:54:39] <pcwalton> you could have a Newable trait or something and then say Foo::new()
[21:54:45] <graydon> isn't it a static method?
[21:55:02] <pcwalton> it wouldn't be namespaced under the type if the static method was an implementation of a trait
[21:55:16] <pcwalton> it would be Newable::new()
[21:55:25] <pcwalton> Newable::new::<for Foo>()
[21:55:28] *** Joins: brendan (brendaneic@538BABFE.A073F3E.97BBD552.IP)
[21:55:31] <graydon> namespaced .. under the .. type?
[21:55:36] * graydon scratches head
[21:55:41] <pcwalton> impl Foo { fn new() { ... } }
[21:55:44] <pcwalton> that is namespaced under Foo
[21:55:46] <pcwalton> Foo::new()
[21:55:48] <graydon> right
[21:55:53] <graydon> you don't mind that
[21:55:54] <pcwalton> however impl Newable for Foo { fn new() { ... } }
[21:55:57] *** Quits: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: Leaving)
[21:56:00] <pcwalton> that is namespaced under the *trait*
[21:56:06] <pcwalton> and that's important
[21:56:07] <kmc> FromStr already works this way
[21:56:09] <graydon> right. that sounds fine to me.
[21:56:14] <graydon> that's how it works now right?
[21:56:16] <pcwalton> yes
[21:56:30] <pcwalton> the feature that's being proposed is being able to write Foo::new() for the latter impl
[21:56:32] <kmc> the ::<Foo> part is annoying but usually not necessary due to inference, I think?
[21:56:37] <graydon> oh. huh.
[21:56:42] <pcwalton> if you said "use newable::Newable;"
[21:56:45] *** Quits: Kruppe (user@moz-4DDA8AB8.uwaterloo.ca) (Ping timeout)
[21:56:45] <pcwalton> at the top
[21:56:52] <jack> kmc: i used it a lot with Rng
[21:57:06] <pcwalton> so having to write Newable::new() is annoying and I propose being able to import static methods
[21:57:09] <pcwalton> so you can just import new()
[21:57:14] <jack> oh wait, that's the slightly differnt case of rng.gen<bool>()
[21:57:17] <pcwalton> and then say new::<for Foo>() if you have to
[21:57:25] *** Joins: recrack (ymin@5AB4884B.FCC4549.14D5B978.IP)
[21:57:26] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:57:26] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d659753 to 1426fd428: 02http://git.io/N3iJvQ
[21:57:26] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:57:27] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[21:57:27] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/1tetAw
[21:57:27] <ghrust> 13rust/06auto 142145de8 15Keegan McAllister: rt::task: Make current_stack_segment public...
[21:57:27] <ghrust> 13rust/06auto 144fd5318 15Keegan McAllister: Make rt::stack public...
[21:57:28] <ghrust> 13rust/06auto 149f37932 15bors: auto merge of #8475 : kmcallister/rust/stack_segment, r=brson,brson...
[21:57:30] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[21:57:31] <engla> An example is Zero::zero()
[21:57:41] <pcwalton> you should just be able to import Zero::zero
[21:57:53] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[21:58:17] <nmatsakis> pcwalton: I've always assumed we'd permit that sooner or later
[21:58:18] <graydon> what would that help with?
[21:58:20] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[21:58:31] <pcwalton> I feel fairly strongly that overloading :: to search through all traits in scope is jumping the shark
[21:58:34] <pcwalton> that way leads to Scala
[21:58:49] <pcwalton> nmatsakis: what, overloading ::?
[21:58:52] <pcwalton> or ::<for Foo>
[21:59:00] <nmatsakis> no, importing trait fns
[21:59:06] *** Joins: tikue (tkuehn@374A74BD.DE6F369E.F4438BC.IP)
[21:59:10] <nmatsakis> I thought we decided against having `::` do trait lookup?
[21:59:16] <nmatsakis> though I disagree about its distastefulness
[21:59:21] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:59:21] <pcwalton> nmatsakis: oh, sure
[21:59:22] <nmatsakis> or I am not sure if I disagree actually
[21:59:54] * nmatsakis should read backlog before jumping in I guess
[21:59:58] <pcwalton> someone's going to write a wtfrust.com and :: is going to be on there if we do trait lookup in it
[22:00:00] <graydon> what would "importing trait fns" help with, in this case?
[22:00:08] <pcwalton> graydon: the verbosity of Zero::zero()
[22:00:10] <graydon> I'm not even clear why the current behavior is so bad
[22:00:13] <graydon> (is it?)
[22:00:20] <pcwalton> graydon: it's not bad except that you have to write Zero:: a lot
[22:00:23] <pcwalton> but that's fixable
[22:00:35] <nmatsakis> graydon: my main problem with it is that it doesn't work for things like associated constants etc
[22:00:38] <pcwalton> the other problem is that there's no way to do <for>
[22:00:44] *** Quits: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:00:48] <nmatsakis> but the other sol'n is not a magic bullet either
[22:01:01] <SimonSapin> Can I turn &T into &[T] of size 1 without copying?
[22:01:06] <nmatsakis> bjz_ has a numbre of examples that are difficult
[22:01:08] *** Joins: jgilbert_ (jgilbert@moz-7B0110AD.mv.mozilla.com)
[22:01:23] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[22:01:28] <nmatsakis> however, I have to run -- but I came to the channel with a quick question I wanted to ask
[22:01:44] <nmatsakis> well, maybe not so quick
[22:01:47] <nmatsakis> I'm working still on this extern "C" fn patch
[22:02:06] <nmatsakis> I added a lint to warn you if you call a C fn without #[fixed_stack_segment] on the caller or #[rust_stack] on the callee
[22:02:17] <nmatsakis> (those attribute names are probably non-ideal but that's neither here nor there)
[22:02:21] *** Joins: mschifer (Adium@moz-BBE3ABD.mv.mozilla.com)
[22:02:25] <nmatsakis> I also added a macro that lets you declare an extern C fn
[22:02:26] <nmatsakis> and wrap it
[22:02:28] <nmatsakis> in one step
[22:02:36] <nmatsakis> (more or less what trans does today)
[22:02:47] <nmatsakis> question however is : for all the fns in libc,
[22:02:51] <pcwalton> cool!
[22:02:53] <nmatsakis> presumably I should keep the "raw" C functions exported
[22:03:01] <nmatsakis> but do we want to export convenience wrappers too?
[22:03:53] <nmatsakis> incidentally, I think best practice is to have #[fixed_stack_segment] #[inline(never)] on the caller
[22:03:57] <sully> ok, woo
[22:04:07] <sully> have got calling supertrait methods on objects working
[22:04:10] <nmatsakis> so as to prevent "stack-growth creep"
[22:04:13] <engla> SimonSapin: you can, but it doesn't sound very sane :)
[22:04:13] <nmatsakis> sully: cool!
[22:04:24] <pcwalton> sully: \o/
[22:04:49] <pcwalton> nmatsakis: when in doubt export the convenience wrappers I'd say
[22:04:51] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:04:51] <graydon> sully: awesome
[22:06:44] <rntz_> sully: supertrait method calling? so A is a subtrait of B, impl of A for type T calls method from trait B?
[22:07:29] <tjc> cmr: https://github.com/mozilla/rust/issues/8498 if you're still interested
[22:08:03] <engla> SimonSapin: vec::raw::buf_as_slice
[22:08:06] <sully> rntz_: I made it so that if you have an object (an existential package) for some trait
[22:08:15] <sully> rntz_: you can call methods from supertraits on it
[22:08:43] <rntz_> ah, I see.
[22:08:58] <SimonSapin> thanks engla
[22:09:05] <SimonSapin> I refactored to avoid it :)
[22:10:52] *** Joins: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net)
[22:11:11] *** Quits: dherman (dherman@moz-BBE3ABD.mv.mozilla.com) (Quit: dherman)
[22:11:30] *** Quits: echristo (echristo@DCF57675.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[22:14:58] <graydon> dbaupp: ping
[22:15:56] <cmr> graydon: tjc: thanks for the feedback
[22:16:11] <cmr> pcwalton: re: trait lookup on ::, I don't particularly care, strcat just brought it up on my PR
[22:16:15] <tjc> cmr: no prob. thanks for writing docs! it's something that needs to happen more :-)
[22:16:44] <cmr> Also, wrt "slot"
[22:17:02] <cmr> Is there any better word for "thing that has ownership of something"?
[22:17:09] <cmr> I don't really understand all the finer details, I admit that
[22:17:53] <tjc> cmr: what if you said early on "an owner can be either a data structure field or a block in the program", and then use the term "owner" from then on?
[22:17:54] <tjc> bbiab
[22:18:02] <cmr> Ok, works for me :)
[22:21:46] <pcwalton> down to last few tests for the path trait resolution overhaul
[22:22:01] <pcwalton> aka Foo::<Bar>::Baz::<Boo>
[22:22:19] <pcwalton> this took way longer than I expected :(
[22:25:54] *** kimundi is now known as zz_kimundi
[22:27:32] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[22:27:37] *** Quits: sully (sully@moz-45967CBE.emarhavil.com) (Ping timeout)
[22:28:10] <joelteon> where did consume_iter go?
[22:28:16] *** Quits: dim-an (ermolovd@moz-FE167E47.nationalcablenetworks.ru) (Quit: dim-an)
[22:28:17] <cmr> Renamed to move_iter
[22:28:47] *** Joins: sully (sully@moz-45967CBE.emarhavil.com)
[22:28:50] <joelteon> and where did transform go?
[22:28:58] <cmr> Renamed to map
[22:29:02] <joelteon> neat
[22:29:07] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[22:29:31] <cmr> graydon: I think Rust needs a bdfl-approved glossary
[22:29:59] <graydon> cmr: glossary of terms or API name-affixes?
[22:30:03] <cmr> graydon: terms
[22:30:20] <cmr> Although name-affixes would probably be welcome too :p
[22:30:31] <graydon> that _should_ be the reference manual. we're all just being a bit too slack at keeping it up to date.
[22:30:41] <graydon> I would like to make time to focus on the reference manual
[22:31:20] <joelteon> rats, still no comm adapters
[22:31:22] <cmr> git log -S doc/rust.md is depressing.
[22:32:06] <cmr> It looks like it hasn't been altered content-wise since january 2012???
[22:32:21] <cmr> That doesn't sound right
[22:33:02] <graydon> can't be right
[22:33:27] <cmr> I don't want -S, my bad
[22:33:28] <engla> -S is pickaxe
[22:33:57] <sully> what is -S?
[22:34:07] <cmr> Searches for test in commit messages
[22:34:10] <engla> no
[22:34:11] *** Quits: donri (dag@moz-9BB61102.tbcn.telia.com) (Client exited)
[22:34:12] <cmr> no?
[22:34:19] <engla> git log --grep is for searching in commit messages
[22:34:30] <cmr> "Look for differences that change the number of occurrences of the specified string (i.e. addition/deletion) in a file."
[22:34:32] <cmr> My bad
[22:34:35] <engla> git log -Sxyz   finds commits where the number of times 'xyz' appears in the source changes
[22:35:51] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Quit: Leaving)
[22:35:56] <engla> the changes that touch doc/rust.md  are of course   git log -- doc/rust.md
[22:35:59] <engla> normal path filter
[22:36:00] *** Joins: michael_rb (michael_rb@moz-985E1E74.sw.biz.rr.com)
[22:36:33] <mitsuhiko> is my mail client broken or is there no activity on the rust mailinglist?
[22:36:51] <cmr> no activity since when?
[22:37:03] <mitsuhiko> 11/08
[22:37:14] <cmr> broken
[22:38:34] <mitsuhiko> :(
[22:39:12] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[22:39:29] <joelteon> what's up with this? rt/comm.rs says Port takes one type argument https://gist.github.com/anonymous/f2401c36f34aa5359739
[22:39:36] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[22:39:37] *** ChanServ sets mode: +o tjc
[22:40:05] *** Quits: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP) (Connection reset by peer)
[22:41:22] *** Joins: maxli (maxli@13F2CEC5.7672369.D8E68FF6.IP)
[22:41:42] *** zz_kimundi is now known as kimundi
[22:42:52] <cmr> graydon: owning pointer, owned pointer, or owned box?
[22:43:14] <cmr> I think I heard all three in the intern talks..
[22:43:14] <kmc> joelteon: possible that some other Port is in scope?
[22:43:20] *** Quits: cypher (ircnet@moz-1D494DB3.vie.surfer.at) (Quit: Leaving...)
[22:43:21] <bblum> i wouldn't say owned box
[22:43:32] <bblum> owned or owning pointer are fine though
[22:43:34] <orshem> cmr, what happened to unique pointer? :)
[22:43:35] <cmr> The manual calls them a box
[22:43:38] <cmr> orshem: they aren't unique
[22:43:46] <kmc> it makes sense to me to say there's an owning pointer pointing to an owned box
[22:43:48] <cmr> A borrowed pointer can alias them.
[22:44:01] <orshem> cmr i think they used to be called that as well
[22:44:10] <graydon> they're unique in a sense. anyway we renamed it in order to standardize on terms that were metaphor-related
[22:44:11] <engla> they are unique as unique pointers though
[22:44:21] <joelteon> kmc: does rustc not specify whether there are two types with the same name in scope?
[22:44:34] <cmr> joelteon: no, shadowing is allowed
[22:44:54] <cmr> probably should be a lint for that
[22:45:50] <graydon> owned, borrowed and managed are all relatively well related through the metaphor of property. it's not great, and I suppose it means we should have called static "common" (like in fortran! hee!)
[22:45:58] <kmc> yep a 'use' can shadow a previous 'use'
[22:46:41] <cmr> graydon: what's confusing is there's both the kind 'static, and the lifetime 'static, and they mean different things.
[22:47:19] <graydon> cmr: they mean relatively similar things. the bound means "can only borrow stuff from 'static"
[22:47:34] *** Quits: igl (igl@moz-5A5A4EC6.adsl.alicedsl.de) (Connection reset by peer)
[22:49:08] <joelteon> ok. so apparently std::comm::Port is in scope, although I didn't import it
[22:49:28] <cmr> joelteon: it's in the prelude
[22:49:40] <kmc> what does the kind 'static mean, again?
[22:49:45] <kmc> oh you just said ;P
[22:49:56] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Quit: Ex-Chat)
[22:50:01] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[22:50:20] <joelteon> oh, ok
[22:50:24] <joelteon> should I stop using rt::comm stuff?
[22:50:27] <sully> hm, what is the thing to breakpiont on these days?
[22:50:47] <tjc> sully: upcall_fail
[22:51:04] <sully> upcall_fail died with the old runtime, I thought
[22:51:16] <tjc> oh
[22:51:18] <tjc> then I don't know =P
[22:51:40] *** Quits: andresgut (Mibbit@27ECC323.EB18EA40.AE3C3E9A.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:51:48] <joelteon> there's an implementation of Select for rt::comm::Port but not for comm::Port
[22:51:53] <joelteon> :(
[22:52:08] <sully> ah, rust_begin_unwind
[22:52:22] <kmc> joelteon: I think brson is working on that issue right now
[22:52:48] <joelteon> oh neat
[22:53:44] <sully> argh, the debug spew gets truncated now?
[22:53:57] <cmr> Yeah :( If you figure out a way to make it not do that, let me know
[22:54:04] <tjc> sully: I thought it always did
[22:54:16] <joelteon> and should I stop using rt::comm?
[22:54:21] <joelteon> what's the difference between that and comm?
[22:54:48] <cmr> joelteon: rt::comm is the new runtime, comm is the old one
[22:54:50] <ecr> graydon: could we rename 'static' to 'common'? I like that
[22:55:04] <kmc> but now 'comm' is an API adapter to the new runtime, I guess
[22:55:05] <joelteon> ok
[22:55:09] <joelteon> right, that's what I've heard
[22:55:25] <kmc> <brson> kmc: eventually we're going to move std::rt::comm to std::comm but that's fairly major surgery
[22:55:28] <graydon> ecr: I don't think so.
[22:55:29] <sully> it gets truncated at a much shorter point than it used to
[22:55:41] <ecr> graydon: aw :(
[22:55:57] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[22:56:01] <ecr> joelteon: I'd suggest sticking to std::comm unless you're writing runtime code.
[22:56:25] <bblum> comm is the right thing to use in all cases
[22:56:50] <sully> argh
[22:56:58] <kmc> unless you need to call Select and can't wait a day or two :/
[22:56:58] <sully> this makes a bunch of the debug spew super useless
[22:57:11] <kmc> but you can use  port.x  to get at the rt::comm::Port inside
[22:57:21] <joelteon> ecr: ok
[22:57:26] <toddaaro> sully: I think it is just a magic number in the debug implementation, can probably change it easily
[22:57:43] <toddaaro> sully: I forget where it is though
[22:57:56] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:58:01] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:59:33] <sully> toddaaro: can it be changed dynamically with an environment variable or something?
[22:59:37] <sully> or do I need to rebuild everything
[22:59:51] <toddaaro> sully: probably not, it should be
[23:00:01] <sully> I mean, I don't evenunderstand why it exists
[23:00:13] <toddaaro> I didn't think too hard about it when I interacted with it
[23:00:16] <ecr> jeolteon: rt::comm just defines the primitives that std::comm is built on (and we use it internally inside the runtime). it's not really supposed to escape to the outside world.
[23:00:27] <toddaaro> but I remember updating some debug print code that was triggering a test suite failure for not truncating
[23:00:53] <toddaaro> an env variable to control it would be a great PR for someone
[23:01:04] <pcwalton> all of the test cases in num/{float,f32,f64} have to be rewritten
[23:01:10] * pcwalton is unhappy
[23:01:20] <pcwalton> they abuse type parameter stacking
[23:04:29] *** Quits: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com) (Ping timeout)
[23:05:40] <cmr> graydon: is "managed box" still the prefered term?
[23:06:05] <graydon> for the allocation, yes. the pointer is a pointer.
[23:06:14] <graydon> and the expression is an expression
[23:06:23] <sully> toddaaro: do you know where this code lives at all?
[23:06:43] <toddaaro> sully: I forgot
[23:06:55] <graydon> cmr: @10 is an managed box expression. it allocates a managed box, moves 10 into it, and returns a managed pointer to that box.
[23:07:04] <graydon> (or rather, evaluating it causes that)
[23:07:18] <cmr> Managed pointer, ok
[23:07:25] <cmr> I haven't heard that one but I'll buy it
[23:07:40] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[23:08:36] <graydon> cmr: I think we've been pretty consistent since adopting "pointer". managed pointer / managing pointer.
[23:08:37] <graydon> http://static.rust-lang.org/doc/rust.html#pointer-types
[23:09:03] <graydon> try to be precise when describing these things, differentiating pointer and pointee
[23:09:47] <sully> arrrrrrrrgh
[23:09:56] <sully> it is, in fact, a hardcoded value
[23:10:00] <sully> god, I don't approve of that
[23:10:22] <graydon> sully: which value?
[23:11:09] <sully> log messages are truncated to 256 characters
[23:11:12] <sully> by the new runtime
[23:12:00] <toddaaro> yea, we cut some corners making it ship
[23:12:10] <toddaaro> the old runtime just had a different hardcoded value
[23:12:17] <sully> although maybe the old runtime truncated too?
[23:12:26] <sully> but it truncated it at something big enough :P
[23:12:28] <toddaaro> it certainly did, we had a test case that made sure it did so
[23:12:48] <toddaaro> it is a great one, it uses debug to print a few pages of "aaaaaaaaaaaaaaa..."
[23:13:24] <sully> why do we truncate at all?
[23:13:29] <toddaaro> I'm not really sure
[23:13:48] <toddaaro> if we mess up logging it could print a zillion lines
[23:13:51] <toddaaro> which would be annoying
[23:13:55] <toddaaro> but maybe we should just not mess up
[23:14:17] <toddaaro> we can already print a zillion lines by just printing more than once, so the failure case is still there
[23:15:15] *** Quits: orshem (orshem@C5E06B1E.A5B6B765.E3D28531.IP) (Quit: Leaving)
[23:15:43] <sully> hm
[23:15:53] <sully> does anybody know where the actual implementation of debug! is?
[23:16:04] *** tikue is now known as tikue--dinner
[23:16:26] <strcat> sully: as in not the macro?
[23:16:33] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Connection reset by peer)
[23:16:47] *** Joins: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net)
[23:16:51] <sully> er, no, actually, the opposite
[23:16:56] <sully> I want to find the macro implementation
[23:17:03] <strcat> libsyntax/ext/expand.rs
[23:17:19] <strcat> scary place
[23:17:29] *** Quits: mihneadb (mihneadb@moz-BE33DA21.fw1.sfo1.mozilla.net) (Input/output error)
[23:17:58] <sully> I see
[23:18:03] *** Joins: mihneadb (Mihnea@moz-BE33DA21.fw1.sfo1.mozilla.net)
[23:18:58] <sully> wait, we still have a language feature for logging
[23:19:01] <strcat> yep :(
[23:19:06] <strcat> rusti: let __log = 5;
[23:19:08] -rusti- <anon>:5:9: 5:12 error: found `__log` in ident position
[23:19:08] -rusti- <anon>:5          let __log = 5;
[23:19:08] -rusti-                   ^~~
[23:19:08] -rusti- error: aborting due to previous error
[23:19:09] -rusti- application terminated with error code 101
[23:19:29] <sully> .... ok
[23:19:36] <strcat> rusti: __log(2)
[23:19:36] -rusti- <anon>:5:16: 5:17 error: expected `,` but found `)`
[23:19:37] -rusti- <anon>:5          __log(2)
[23:19:37] -rusti-                          ^
[23:19:37] -rusti- application terminated with error code 101
[23:19:43] <strcat> rusti: __log(2, "foo")
[23:19:45] -rusti- ()
[23:19:47] <joelteon> rusti: __log
[23:19:48] -rusti- <anon>:6:4: 6:5 error: expected `(` but found `}`
[23:19:48] -rusti- <anon>:6     };
[23:19:48] -rusti-              ^
[23:19:48] -rusti- application terminated with error code 101
[23:20:21] <sully> I kind of want to go fix log so that, at least if you give it a string, it just prints the damn string
[23:20:25] <sully> instead of escaping it first
[23:20:41] <strcat> throw out fmt! ;p
[23:20:47] <cmr> It does that because of fmt yeah
[23:21:00] <strcat> from %?
[23:21:58] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:22:07] <engla> rusti: ifmt("hi\n");
[23:22:08] -rusti- <anon>:5:9: 5:13 error: unresolved name `ifmt`.
[23:22:08] -rusti- <anon>:5          ifmt("hi\n");
[23:22:08] -rusti-                   ^~~~
[23:22:08] -rusti- error: aborting due to previous error
[23:22:08] -rusti- application terminated with error code 101
[23:22:17] <engla> rusti: ifmt!("hi\n");
[23:22:18] -rusti- ()
[23:22:29] <engla> I'm not that good at rust :)
[23:22:55] <ecr> brson: turns out there was a different test in uvio that did multiple TCP read/writes (much more than the broken one actually. ~250 writes). It works fine with the homing activated.
[23:23:07] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:23:10] <ecr> brson: so multiple writes doesn't seem to be the problem
[23:23:29] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:23:49] <engla> sully: ifmt will hopefully fix this
[23:24:06] <toddaaro> are we really getting something called ifmt
[23:24:17] <toddaaro> if-mt and i-fmt are both hilarious ways to say it
[23:24:28] <engla> well the name doesn't matter, that can change
[23:24:38] <toddaaro> I kind of like it
[23:24:48] <toddaaro> we can be sure to never standardize the pronunciation
[23:24:54] <toddaaro> to troll everyone
[23:25:02] <ecr> brson: interestingly, if I tell gdb to ignore SIGPIPE before running the test, then everything is fine. test passes. no segfaults.
[23:25:43] <ecr> toddaaro: no, we standardize to 'if-t' and claim the 'm' is silent.
[23:26:11] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[23:26:55] <strcat> graydon: around?
[23:27:14] <graydon> strcat: yes
[23:27:42] <strcat> graydon: I was thinking about switching us to using compiler-rt (LLVM's libgcc replacement) because I hit some missing features in libgcc, but I'm not quite sure how to do it
[23:27:48] <strcat> since it's another SVN project
[23:27:49] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[23:27:54] <strcat> it's pretty small though afaict
[23:28:00] <graydon> we had compiler-rt in tree for a while
[23:28:07] <graydon> (along with _all of clang!_)
[23:28:14] *** Quits: jorendorff (jorendorff@moz-2F32ACA3.hsd1.tn.comcast.net) (Quit: jorendorff)
[23:28:16] <strcat> I'd like to just statically link it in
[23:28:35] <strcat> atm 64-bit overflow-checked multiplication doesn't work on 32-bit :[, missing symbol
[23:28:38] <graydon> into what, librustllvm or rustrt or what?
[23:28:40] <strcat> and I hit some more
[23:28:43] <strcat> graydon: rustrt
[23:29:02] <graydon> *shrug* I don't have a strong feeling on that, I think it's brson's call
[23:29:08] *** Joins: dew (Instantbir@moz-8A63B53.dhcp.stls.mo.charter.com)
[23:30:02] <strcat> we actually had clang *in-tree*? or as a submodule
[23:30:29] <graydon> submodule
[23:30:49] <strcat> it would be cool if LLVM finally finished their silly linker, so we could just use LLVM instead of mingw
[23:30:55] *** Joins: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu)
[23:31:13] <sully> hm, running into some trickiness with supertrait methods
[23:31:16] <sully> on objects
[23:31:17] <Ralith> I'm eagerly awaiting that myself
[23:31:18] <graydon> it would be cool
[23:31:20] <graydon> but we're not there yet
[23:31:24] <strcat> yeah
[23:31:31] <strcat> gcc-libs is weird :s
[23:31:32] <sully> when there are type params on the trait
[23:31:36] <Ralith> silly how, though?
[23:31:37] <strcat> it has some of these overflow checking fns, but they don't work
[23:32:10] *** Quits: BitPuffin (quassel@moz-7BB00EC9.bredband.comhem.se) (Ping timeout)
[23:33:28] <strcat> -ftrapv is seriously broken and nobody wants to fix it;  so the most appealing
[23:33:29] <strcat> solution is to remove support for -ftrapv.
[23:33:31] <strcat> yeah, well
[23:33:37] <strcat> the gcc bug tracker is sad
[23:34:09] <strcat> afaict someone removed these support functions
[23:34:14] <strcat> but they left the frontend intact
[23:34:17] <strcat> so now it just doesn't work
[23:34:19] *** IRCMonkey33931 is now known as heftig
[23:35:23] <Ralith> strcat: in what regard is lld silly?
[23:35:30] <graydon> strcat: :((((
[23:35:39] <strcat> Ralith: because it only does static linking :), at least last time I checked
[23:35:56] <Ralith> well, at the moment there's all kinds of things it doesn't do
[23:35:59] *** Quits: int3_ (int3_@moz-ABE52D50.hsd1.ca.comcast.net) (Client exited)
[23:36:10] <Ralith> do you mean support isn't planned for dynamic linking?
[23:36:20] <strcat> Ralith: I'm sure they plan on supporting it one day
[23:36:26] <strcat> in the grand scheme of things
[23:37:28] <Ralith> do you have reason to believe it's of particularly low priority?
[23:38:22] <cmr> Is lld itself of particularly high priority?
[23:38:50] <strcat> Ralith: apple has their own linker already
[23:39:06] <cmr> I don't mean to pretend it's trivial to write a linker, but it doesn't seem to be progressing with any rapidity.
[23:39:10] <strcat> they don't care about lld from their usual *must replace GPL things because we want to sue people over patents* POV
[23:39:36] <strcat> and google doesn't care, since they only deploy to linux and already have gold
[23:39:45] * strcat shrugs
[23:43:12] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Client exited)
[23:43:39] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[23:44:58] <bblum> nmatsakis: ping
[23:45:20] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[23:46:16] *** Joins: dherman (dherman@moz-7B0110AD.mv.mozilla.com)
[23:46:17] *** ChanServ sets mode: +o dherman
[23:48:06] <eatkinson> is there anything special about 'self?
[23:48:27] <cmr> eatkinson: it's the only lifetime the parser accepts in some contexts.
[23:48:30] <cmr> besides that, nothing
[23:48:32] <cmr> it's a bug
[23:48:34] <kmc> (which I find baffling)
[23:48:37] <graydon> weren't we going to rename Result::unwrap() to get()?
[23:48:40] <graydon> or did we finish this?
[23:48:46] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[23:48:47] <cmr> graydon: other way around
[23:48:49] <cmr> get to unwrap
[23:48:52] <graydon> oh. that's unfortunate.
[23:49:00] <graydon> I quite dislike the word "unwrap", thought I said as much in the bug!
[23:49:01] <graydon> oh well
[23:49:11] <kmc> Result::unwrap(x) turned into x.unwrap()
[23:49:16] <eatkinson> cmr: ah ok thanks. i was kind of worried for a bit there
[23:50:15] *** Quits: sully (sully@moz-45967CBE.emarhavil.com) (Ping timeout)
[23:50:15] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:50:15] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/1tetAw
[23:50:15] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:50:18] <graydon> kmc: well, yes. but I mean ..
[23:50:22] *** Joins: sully (sully@moz-45967CBE.emarhavil.com)
[23:50:25] <graydon> https://github.com/mozilla/rust/issues/7887 looks like it's wip
[23:50:27] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[23:51:02] <graydon> I thought it was to become .get_move() or such
[23:51:53] *** Quits: milinda (milinda@moz-C79ADF95.dhcp-bl.indiana.edu) (Input/output error)
[23:52:32] <kmc> .yoink()
[23:52:38] <cmr> hah
[23:53:15] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[23:53:15] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/f9RMLA
[23:53:15] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[23:53:17] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[23:53:17] <ghrust> 01[13rust01] 15bors pushed 4 new commits to 06auto: 02http://git.io/Rn8LWw
[23:53:17] <ghrust> 13rust/06auto 1433e7d95 15Michael Woerister: debuginfo: Implemented proper handling of lexical scopes and variable shadowing.
[23:53:17] <ghrust> 13rust/06auto 149c7d9eb 15Michael Woerister: debuginfo: Add support for argument shadowing.
[23:53:17] <ghrust> 13rust/06auto 14983cc77 15Michael Woerister: debuginfo: Add some tests for visibiliy scopes within closures.
[23:53:19] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[23:54:41] *** Quits: hjr3 (hradtke@374E545A.3A8E9B0C.F9D9C60E.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[23:54:44] *** kimundi is now known as zz_kimundi
[23:57:48] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:57:48] *** ChanServ sets mode: +o brson
[23:58:25] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[23:59:23] <bblum> write a slide deck, give a talk on same, fix a soundness bug in the type system
[23:59:26] <bblum> all in a day's work
[23:59:27] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
