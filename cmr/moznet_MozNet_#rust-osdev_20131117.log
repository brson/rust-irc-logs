[00:48:15] *** Quits: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca) (Quit: canhtak)
[01:06:36] *** kimundi is now known as zz_kimundi
[01:06:41] *** Joins: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca)
[01:31:48] *** Quits: jaeholee (uid4856@moz-31ABA2C0.irccloud.com) (Ping timeout)
[01:32:42] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Ping timeout)
[01:32:55] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[01:34:01] *** Joins: jaeholee (uid4856@moz-31ABA2C0.irccloud.com)
[02:46:30] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:22:51] *** Quits: eholk (eric@moz-F70D5031.hsd1.in.comcast.net) (Quit: Konversation terminated!)
[03:35:47] *** Quits: zz_kimundi (kimundi@moz-8E17C911.dip0.t-ipconnect.de) (Ping timeout)
[03:39:58] *** Joins: zz_kimundi (kimundi@moz-A47A651A.dip0.t-ipconnect.de)
[03:39:59] *** zz_kimundi is now known as kimundi
[04:00:40] *** Quits: zxcdw (r-a@BC4D85C9.B543C4DE.3933CC16.IP) (Ping timeout)
[04:00:46] *** Joins: eholk (eric@moz-F70D5031.hsd1.in.comcast.net)
[04:04:03] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[04:08:26] *** Joins: brson (brson@6A848D32.C1B840DD.76F66111.IP)
[04:13:09] *** Quits: eholk (eric@moz-F70D5031.hsd1.in.comcast.net) (Quit: Konversation terminated!)
[04:16:06] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[04:16:21] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[04:37:36] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[04:37:52] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[05:21:37] *** Quits: brson (brson@6A848D32.C1B840DD.76F66111.IP) (Ping timeout)
[06:57:19] *** Quits: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca) (Quit: canhtak)
[07:38:09] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[09:58:57] *** Joins: w3lcome (Mibbit@moz-FE6BEF26.home.otenet.gr)
[10:06:06] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Input/output error)
[11:33:57] *** Joins: GeorgeH (George@moz-FB5F2302.hsd1.nj.comcast.net)
[12:05:51] <eddyb> strcat: do you have a Cell in rust-core?
[12:05:55] <strcat> nope
[12:05:58] <eddyb> dammit
[12:06:06] <strcat> I don't have a lot of stuff ;)
[12:06:19] <strcat> no iterators, no strings, no files, no sockets
[12:06:26] <eddyb> I can't really test this in userspace without emulating a lot of things
[12:07:11] <eddyb> but Cell should be simple, right?
[12:07:34] <strcat> well
[12:07:37] <strcat> to get it right, no :)
[12:07:53] <strcat> eddyb: what do you need it for though?
[12:08:01] <eddyb> strcat: register references
[12:08:08] <strcat> eddyb: can
[12:08:12] <strcat> can't use Option? *
[12:08:20] <eddyb> I don't need more than one access at a time
[12:08:26] <strcat> use Option then
[12:08:31] <strcat> Cell is for breaking the mutability rules
[12:08:42] <strcat> it's #[no_freeze] and lets you mutate it with &self
[12:08:47] <eddyb> I can't use &mut because I have multiple references
[12:08:51] <strcat> oh
[12:09:29] <eddyb> I don't need multiple *accessible* references at the same time, and rarely mut
[12:09:44] <eddyb> as in, I borrow one at a time
[12:11:46] <strcat> yeah I don't have that yet
[12:11:47] <strcat> just RcMut
[12:12:10] <eddyb> I don't want to clone :/
[12:12:14] <eddyb> (do I need to?)
[12:12:31] <strcat> hm?
[12:12:44] <eddyb> I basically want a handle I can pass around without cloning
[12:12:57] <eddyb> using &Cell<Register> right now
[12:13:23] <strcat> Cell is really simple, you could copy it from the stdlib
[12:13:27] <strcat> but I think it is about to be removed
[12:13:38] <eddyb> it is useful in this special case :/
[12:13:49] <eddyb> strcat: can I have &RcMut<Register> instead?
[12:14:08] <eddyb> and use the .with_borrow closure-based methods
[12:14:09] <strcat> eddyb: yes but just use Cell if you want Cell
[12:14:22] <strcat> RcMut will be removed in favour of something better too I think
[12:14:26] <eddyb> I'm not sure what I want, at this point
[12:14:28] <eddyb> oh lol
[12:15:36] <eddyb> https://github.com/mozilla/rust/blob/master/src/libstd/cell.rs
[12:16:05] <eddyb> strcat: so what it does is just transmute_mut(self)?
[12:16:10] <strcat> yes
[12:16:14] <strcat> and it's marked #[no_freeze]
[12:16:24] <strcat> eddyb: it swaps in None
[12:16:26] <strcat> into an inner Option
[12:16:31] <strcat> so there's no way to ever get 2 refs
[12:16:43] <eddyb> so that's how it makes itself safe?
[12:16:47] <strcat> yeah
[12:56:12] <eddyb> aaaaaaaaaalmost there
[12:57:05] <eddyb> strcat: what if I use transmute_mut just to set a field, no side-effects
[12:57:23] <strcat> eddyb: unsafe if the struct isn't mutable, unless it's #[no_freeze]
[12:57:43] <eddyb> strcat: thanks, I'll add that
[12:57:55] <strcat> assuming it's a shallow field you can't take pointers deeper into, it will be fine with that
[12:58:02] <eddyb> does it limit me in any way?
[12:58:21] <eddyb> no_freeze, that is
[12:58:26] <strcat> eddyb: well it makes it not Freeze
[12:58:36] <strcat> so anything with a Freeze type bound
[12:58:45] <strcat> other than that, no - you're still responsible for safety
[12:58:56] <strcat> but the compiler is allowed to assume &T where T is Freeze is immutable
[12:59:59] <eddyb> the field will be a one-deep enum because the borrowed pointers wouldn't be valid anyway
[13:00:08] <eddyb> strcat: ah, I see
[13:27:04] *** Joins: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca)
[14:57:41] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[15:25:00] <eddyb> pretty sure this won't work as gist :(
[15:35:12] <eddyb> aaaand no highlighting https://gist.github.com/eddyb/f37442c4ace4a1c17368
[16:37:24] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[16:38:01] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[16:38:55] *** Quits: w3lcome (Mibbit@moz-FE6BEF26.home.otenet.gr) (Quit: http://www.mibbit.com ajax IRC Client)
[16:40:26] *** Joins: w3lcome (Mibbit@moz-FE6BEF26.home.otenet.gr)
[16:48:58] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:08:25] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[17:12:54] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[17:39:51] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[17:40:52] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[17:54:02] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[17:56:29] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[18:14:10] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[21:10:00] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:14:13] *** Quits: canhtak (canhtak@moz-43EC0376.wl.t.ulaval.ca) (Quit: canhtak)
[21:19:20] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[21:29:02] *** Joins: rusti (rusti@moz-61B073BC.cpe.net.cable.rogers.com)
[21:53:37] *** Quits: w3lcome (Mibbit@moz-FE6BEF26.home.otenet.gr) (Quit: http://www.mibbit.com ajax IRC Client)
[22:15:41] *** Quits: rusti (rusti@moz-61B073BC.cpe.net.cable.rogers.com) (Client exited)
[22:16:49] *** Joins: rusti (rusti@moz-61B073BC.cpe.net.cable.rogers.com)
[22:17:54] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Quit: leaving)
[23:45:52] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[23:46:07] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
