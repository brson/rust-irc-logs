[00:09:29] *** Quits: Jesin (Jesin@moz-qb9.79h.16.107.IP) (Quit: Leaving)
[00:21:05] *** Joins: andreabedini (andreabedin@moz-2lt49q.unimelb.edu.au)
[00:23:26] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:47:43] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[00:53:53] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[00:55:04] *** Quits: ahartzheim (ahartzheim@moz-5uk5u4.tor-exit.network) (Ping timeout: 121 seconds)
[01:22:20] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:22:35] *** Quits: whipsch (whipsch@moz-bl4i0b.from.irc.camp) (Ping timeout: 121 seconds)
[01:31:14] *** Joins: whipsch (whipsch@moz-bl4i0b.from.irc.camp)
[01:33:34] *** Quits: andars (andars@moz-bsldst.sntcca.sbcglobal.net) (Ping timeout: 121 seconds)
[01:43:09] *** Joins: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP)
[01:47:04] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[01:47:55] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:49:17] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[01:49:34] *** Joins: cdidd_ (cdidd@moz-c38vr7.broadband.corbina.ru)
[01:49:55] *** Quits: mcpherrin (mcpherrin@moz-fl0kt2.ca.comcast.net) (Ping timeout: 121 seconds)
[01:50:39] *** Joins: c74d3 (c74d3a4ebb6@moz-l85t2q.mggc.hibn.4404.2002.IP)
[01:51:09] *** Quits: cdidd (cdidd@moz-b3smji.broadband.corbina.ru) (Ping timeout: 121 seconds)
[01:52:21] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Ping timeout: 121 seconds)
[01:52:31] *** c74d3 is now known as c74d
[01:55:37] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[01:56:34] *** Quits: c74d (c74d3a4ebb6@moz-l85t2q.mggc.hibn.4404.2002.IP) (Connection closed)
[01:56:43] *** Joins: c74d (c74d3a4ebb6@moz-gadv8g.mggc.hibn.4404.2002.IP)
[02:02:19] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[02:12:38] *** Joins: bkearns (Adium@moz-2l9j31.ca.comcast.net)
[02:14:49] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[02:17:55] *** Joins: p1start (p1start@moz-nftjhe.org)
[02:18:09] *** Quits: andreabedini (andreabedin@moz-2lt49q.unimelb.edu.au) (Quit: Textual IRC Client: www.textualapp.com)
[02:23:53] *** Joins: trecer (textual@moz-87lmhp.dyn.centurytel.net)
[02:25:31] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[02:38:09] *** Quits: trecer (textual@moz-87lmhp.dyn.centurytel.net) (Ping timeout: 121 seconds)
[02:47:41] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[02:50:00] *** Quits: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP) (Ping timeout: 121 seconds)
[02:50:46] *** Quits: zz_kimundi (kimundi@moz-rb1gq6.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:51:50] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:52:32] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[02:53:03] *** Joins: zz_kimundi (kimundi@moz-pvqpe9.dip0.t-ipconnect.de)
[02:53:04] *** zz_kimundi is now known as kimundi
[02:56:27] *** Joins: sproing (Mibbit@moz-juv.9o3.252.72.IP)
[02:58:04] *** Quits: sproing (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:02:02] *** Joins: andars (andars@moz-bsldst.sntcca.sbcglobal.net)
[03:06:46] *** Joins: Jesin (Jesin@moz-liu.7tn.134.198.IP)
[03:06:51] *** Joins: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP)
[03:11:18] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Ping timeout: 121 seconds)
[03:18:53] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[03:27:36] *** Joins: semarie (semarie@moz-d6ctul.dfri.se)
[03:32:26] *** Quits: mssbrg (mark@moz-0aum2d.compute.amazonaws.com) (Client exited)
[03:37:56] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[03:38:37] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[03:42:22] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[04:00:37] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[04:00:48] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[04:00:59] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[04:02:36] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[04:15:12] *** Quits: Jesin (Jesin@moz-liu.7tn.134.198.IP) (Quit: Leaving)
[04:21:53] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[04:23:03] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[04:23:07] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[04:24:15] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[04:28:46] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[04:31:17] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[04:31:41] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[04:32:49] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[04:33:46] *** Joins: ChrisPls (Mibbit@moz-ou1.3i1.67.138.IP)
[04:34:49] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[04:53:06] *** Quits: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP) (Ping timeout: 121 seconds)
[05:07:00] *** Joins: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP)
[05:10:41] *** Quits: ChrisPls (Mibbit@moz-ou1.3i1.67.138.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:16:03] *** Quits: O01eg (o01eg@moz-grusqb.5ej6.3egh.2698.2a02.IP) (Client exited)
[05:18:24] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[05:22:57] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[05:27:35] *** Quits: andars (andars@moz-bsldst.sntcca.sbcglobal.net) (Ping timeout: 121 seconds)
[05:30:56] *** Joins: Jesin (Jesin@moz-p39jm6.mobility.exede.net)
[05:42:46] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[05:51:00] *** Quits: c74d (c74d3a4ebb6@moz-gadv8g.mggc.hibn.4404.2002.IP) (Connection closed)
[05:51:04] *** Joins: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[05:57:33] <Mutabah> Any official discussion on this? https://github.com/rust-lang/rfcs/pull/1119
[05:59:22] *** Joins: James (quassel@moz-8qs8a3.range86-148.btcentralplus.com)
[06:09:19] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[06:10:45] *** Joins: dinfuehr (dinfuehr@moz-7mu8a8.highway.telekom.at)
[06:12:34] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[06:13:52] *** Quits: Diggsey (diggsey@moz-9s9ol4.dsl.pipex.com) (Ping timeout: 121 seconds)
[06:17:06] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[06:22:26] *** Quits: dinfuehr (dinfuehr@moz-7mu8a8.highway.telekom.at) (Connection closed)
[06:28:58] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[06:33:33] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:41:44] *** Quits: Jesin (Jesin@moz-p39jm6.mobility.exede.net) (Quit: Leaving)
[06:47:38] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[06:49:21] *** Joins: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de)
[06:49:27] *** Quits: c0170 (c0170@moz-4stj9o.cable.virginm.net) (Ping timeout: 121 seconds)
[06:52:33] *** Quits: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de) (Quit: Bye)
[06:52:56] *** Joins: squiddy (squiddy@moz-md4.pm3.19.178.IP)
[06:53:23] *** Quits: James (quassel@moz-8qs8a3.range86-148.btcentralplus.com) (Ping timeout: 121 seconds)
[06:54:30] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[06:54:44] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[07:02:06] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[07:02:14] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[07:06:42] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[07:07:38] *** Joins: c0170 (c0170@moz-bb29a4.cambridge.arm.com)
[07:11:14] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[07:12:45] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[07:20:26] *** Quits: njn (chatzilla@moz-01sv7l.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 41.0a1/20150531163607])
[07:22:35] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[07:23:41] *** Joins: dcb_ (textual@moz-j72nfe.ca.comcast.net)
[07:23:46] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Connection closed)
[07:27:29] *** Joins: nodweber_ (nodweber@moz-knt.fgq.178.5.IP)
[07:27:54] *** Joins: aepsil0n (eduard@moz-gtoi2p.hsi8.kabel-badenwuerttemberg.de)
[07:31:11] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[07:35:42] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[07:38:26] *** Quits: nodweber_ (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[07:39:49] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[07:43:40] *** Quits: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net) (Ping timeout: 121 seconds)
[07:44:50] *** Joins: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net)
[07:50:08] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[07:52:56] *** Quits: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP) (Ping timeout: 121 seconds)
[07:56:05] *** Quits: Kxepal (Miranda@moz-r7ntvk.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[07:56:35] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[07:57:35] *** Quits: pauls (pauls@moz-e5p333.ccs.neu.edu) (Ping timeout: 121 seconds)
[08:00:50] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[08:02:43] *** Quits: dcb_ (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[08:05:23] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[08:07:11] *** Quits: _Vi (vi@moz-bbs.vhj.131.104.IP) (Ping timeout: 121 seconds)
[08:11:28] *** Joins: acharles (acharles@moz-ulbdcn.ca.comcast.net)
[08:31:09] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[08:31:59] *** Joins: pauls (pauls@moz-e5p333.ccs.neu.edu)
[08:40:32] *** Joins: imperio (Mibbit@moz-ou0a11.rev.sfr.net)
[08:40:59] <imperio> can someone take a look at gh25825 please ? Thanks ! =D
[08:40:59] <[o__o]> Adding E0011 explanation: https://github.com/rust-lang/rust/pull/25825
[08:41:34] *** Joins: munksgaard (munksgaard@moz-1i4.hq0.225.130.IP)
[08:43:21] *** Quits: nham (nham@moz-lglsfe.il.comcast.net) (Quit: leaving)
[08:47:01] <imperio> Manishearth: thanks for your error reporting ! :-)
[08:55:00] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[08:59:34] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[09:09:01] *** Joins: eddyb_ (eddyb@moz-9ak.sgj.26.188.IP)
[09:11:48] *** Quits: eddyb (eddyb@moz-ure.pug.25.188.IP) (Ping timeout: 121 seconds)
[09:23:06] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[09:25:40] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[09:34:14] *** Joins: oli_obk_ (Mibbit@moz-7bq.0sb.52.141.IP)
[09:37:14] *** Quits: oli_obk_ (Mibbit@moz-7bq.0sb.52.141.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:40:08] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[09:41:11] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[09:42:19] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[09:49:12] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[09:53:43] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[10:02:09] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[10:05:52] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[10:06:00] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[10:15:52] *** Quits: Yurumechan (23f9939a@moz-eg6.d6u.78.121.IP) (Ping timeout: 121 seconds)
[10:18:04] *** Joins: Yurumechan (23f9939a@moz-eg6.d6u.78.121.IP)
[10:20:08] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[10:21:40] *** Quits: mib_jtjx54 (Mibbit@moz-g6k.oht.161.46.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:36:14] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[10:36:33] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[10:38:00] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Quit: Leaving)
[10:38:10] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[10:39:42] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[10:42:30] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[10:43:31] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[10:44:56] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[10:47:53] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[10:52:15] *** Joins: nodweber (nodweber@moz-nimkla.bali.ge)
[10:56:43] *** Quits: nodweber (nodweber@moz-nimkla.bali.ge) (Connection closed)
[11:02:38] *** Quits: sp3d (sp3d@moz-ik970v.enn1.s22b.000d.2601.IP) (Ping timeout: 121 seconds)
[11:02:51] *** Joins: _Vi (vi@moz-bbs.vhj.131.104.IP)
[11:05:54] *** Joins: nodweber (nodweber@moz-nimkla.bali.ge)
[11:06:09] *** Joins: genbattle (genbattle@moz-r09mao.xtra.co.nz)
[11:07:26] *** Joins: sp3d (sp3d@moz-ik970v.enn1.s22b.000d.2601.IP)
[11:07:55] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[11:10:36] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[11:12:04] *** Joins: nickniko_ (nicknikolov@moz-k0r.8sn.209.90.IP)
[11:12:04] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[11:15:48] *** Quits: genbattle (genbattle@moz-r09mao.xtra.co.nz) (Ping timeout: 121 seconds)
[11:18:25] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[11:20:02] *** Quits: bvssvni (sven@moz-qqolj8.bb.online.no) (Ping timeout: 121 seconds)
[11:21:41] *** Joins: ferdinand (Mibbit@moz-juv.9o3.252.72.IP)
[11:22:37] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[11:22:57] *** Joins: bvssvni (sven@moz-8nopqv.bb.online.no)
[11:24:45] *** Quits: ferdinand (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:32:11] *** Quits: nodweber (nodweber@moz-nimkla.bali.ge) (Quit: Leaving...)
[11:38:27] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[11:38:33] *** Quits: summerlight_ (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[11:47:46] *** Joins: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP)
[11:50:08] *** Joins: mukilan (mukilan@moz-agl.8le.164.122.IP)
[11:51:51] <frewsxcv> Anyone have any grand ideas why only the last of these three commented blocks works? http://is.gd/PZRC5b
[11:54:57] <Manishearth> frewsxcv: the last one returns :)
[11:54:57] *** Quits: capella-s3 (capella-s3@moz-vcqob4.res.rr.com) (Connection closed)
[11:55:01] <Manishearth> and that helps type inference
[11:55:03] <Manishearth> and autoderef
[11:55:15] <frewsxcv> they all return
[11:55:21] <Manishearth> it works by virtue of being the last one
[11:55:43] <frewsxcv> i meant, uncomment each of the comment blocks one at a time
[11:55:43] <Manishearth> frewsxcv: put a `;return &[1];; at the end of it and see what happens
[11:55:48] <Manishearth> oh
[11:56:53] <Manishearth> frewsxcv: I bet it's a coerce issue
[11:57:06] <Manishearth> &Vec coerces to &[T], but coercion isn't universal
[11:57:12] <frewsxcv> hm
[11:57:33] <frewsxcv> is it worth filing an issue?
[11:57:44] *** Joins: dinfuehr (dinfuehr@moz-7mu8a8.highway.telekom.at)
[11:58:13] <Manishearth> not sure
[11:58:18] <Manishearth> this might be expected behavior
[11:58:24] <Manishearth> but file away
[12:03:58] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[12:05:04] <frewsxcv> Manishearth: https://github.com/rust-lang/rust/pull/25937#issuecomment-107416277
[12:05:24] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[12:06:44] <Manishearth> thought so
[12:08:00] *** Quits: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net) (Quit: Konversation terminated!)
[12:08:41] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[12:09:34] *** eddyb_ is now known as eddyb
[12:11:12] *** Joins: pudgetta (Mibbit@moz-juv.9o3.252.72.IP)
[12:12:26] *** Quits: pudgetta (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:12:55] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[12:15:56] *** Quits: semarie (semarie@moz-d6ctul.dfri.se) (A TLS packet with unexpected length was received.)
[12:16:10] *** Joins: semarie (semarie@moz-vjb.r8r.42.192.IP)
[12:22:40] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[12:23:38] *** Quits: vadimcn (uid46608@moz-0d43u8.highgate.irccloud.com) (Quit: Connection closed for inactivity)
[12:24:37] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[12:25:05] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[12:25:59] *** Joins: capella-s3 (capella-s3@moz-vcqob4.res.rr.com)
[12:27:44] *** Joins: kushal (kdas@moz-so4.f0d.244.121.IP)
[12:27:48] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[12:29:15] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[12:34:22] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[12:34:59] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[12:35:14] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[12:45:15] *** Quits: kushal (kdas@moz-so4.f0d.244.121.IP) (Ping timeout: 121 seconds)
[12:53:09] *** Quits: luzie (lu.cy@moz-g11uhv.lu) (Quit: WeeChat 1.3-dev)
[12:54:41] *** Joins: ChrisPls (Mibbit@moz-ou1.3i1.67.138.IP)
[12:57:11] *** Parts: ChrisPls (Mibbit@moz-ou1.3i1.67.138.IP) ()
[12:59:00] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[13:10:38] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[13:17:01] *** Quits: dinfuehr (dinfuehr@moz-7mu8a8.highway.telekom.at) (Quit: )
[13:30:03] *** Joins: bdero (bran@moz-bi0u90.mit.edu)
[13:30:08] *** Parts: bdero (bran@moz-bi0u90.mit.edu) ()
[13:48:45] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[13:52:16] *** Quits: Guest60769 (rovar@moz-6iq.47m.88.38.IP) (Quit: Leaving)
[13:52:19] *** Joins: Guest60769 (rovar@moz-6iq.47m.88.38.IP)
[13:52:24] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Client exited)
[13:52:39] *** Quits: rovar (rovar@moz-96effg.dyn.optonline.net) (NickServ (RECOVER command used by Guest60769))
[13:52:40] *** Guest60769 is now known as rovar
[13:52:52] *** Joins: rovar_ (rovar@moz-96effg.dyn.optonline.net)
[14:02:09] *** Quits: squiddy (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[14:06:47] *** Joins: annodomini (lambda@moz-hp1.h27.143.32.IP)
[14:10:09] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[14:13:34] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[14:16:02] *** Joins: maralla (uid69246@moz-mq40mv.brockwell.irccloud.com)
[14:16:05] *** Quits: annodomini (lambda@moz-hp1.h27.143.32.IP) (Client exited)
[14:19:46] *** Joins: annodomini (lambda@moz-hp1.h27.143.32.IP)
[14:19:58] *** Quits: imperio (Mibbit@moz-ou0a11.rev.sfr.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:24:53] *** Joins: summerlight_ (summerlight@moz-99k.2mj.130.121.IP)
[14:25:39] *** Quits: jgallagher (john@moz-6ge.dhn.131.24.IP) (Client exited)
[14:26:30] *** Joins: laumann (thomas@moz-gqpfnm.science.ku.dk)
[14:31:40] *** Quits: annodomini (lambda@moz-hp1.h27.143.32.IP) (Client exited)
[14:35:33] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Connection closed)
[14:44:52] *** Quits: bkearns (Adium@moz-2l9j31.ca.comcast.net) (Quit: Leaving.)
[14:52:10] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[14:52:56] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[14:54:01] *** Joins: arielb1 (Ariel@moz-9he9ta.red.bezeqint.net)
[14:58:35] *** Joins: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net)
[14:58:40] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[15:03:21] *** Quits: aepsil0n (eduard@moz-gtoi2p.hsi8.kabel-badenwuerttemberg.de) (Connection closed)
[15:13:06] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[15:13:33] *** Joins: kushal (kdas@moz-0bg.hkq.143.114.IP)
[15:14:02] *** Quits: kushal (kdas@moz-0bg.hkq.143.114.IP) (Connection closed)
[15:14:22] *** Quits: c0170 (c0170@moz-bb29a4.cambridge.arm.com) (Ping timeout: 121 seconds)
[15:19:37] *** Joins: kushal (kdas@moz-0bg.hkq.143.114.IP)
[15:20:32] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[15:20:43] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[15:20:58] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[15:24:50] *** Quits: laumann (thomas@moz-gqpfnm.science.ku.dk) (Ping timeout: 121 seconds)
[15:26:52] *** Joins: laumann (thomas@moz-1f0.hq0.225.130.IP)
[15:29:41] *** Joins: andars (andars@moz-bsldst.sntcca.sbcglobal.net)
[15:35:18] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[15:35:33] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[15:37:32] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[15:39:29] <Mutabah> What's the representation of &TypeContainingUnsizedSlice?
[15:40:01] <Mutabah> is it (*const Type..., usize) (where the usize is the number of elements in the contained slice)
[15:40:16] <Mutabah> (context - writing a "from_iter" method for Rc<[T]>)
[15:40:30] <arielb1> Mutabah: it is (&Type, usize)
[15:41:02] <arielb1> where usize contains the length
[15:41:21] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[15:41:27] *** Joins: O01eg (o01eg@moz-58bgnj.kdi6.4n8f.2698.2a02.IP)
[15:41:36] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[15:44:12] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[15:44:30] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[15:46:54] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Connection closed)
[15:47:24] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[15:47:34] *** Joins: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net)
[15:47:40] *** Joins: c0170 (c0170@moz-4stj9o.cable.virginm.net)
[15:49:06] <Mutabah> Bother, Rc<[T]> interacts interestingly with Rc's drop impl
[15:49:13] * Mutabah looks a how std does it
[15:49:41] <Mutabah> Oh, it doesn't
[15:50:40] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Ping timeout: 121 seconds)
[15:58:56] *** Quits: munksgaard (munksgaard@moz-1i4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[16:02:01] <WindowsBunny> acrichto: exciting developments in the LLD world http://reviews.llvm.org/rL238458
[16:04:16] *** Joins: vadimcn (uid46608@moz-0d43u8.highgate.irccloud.com)
[16:07:31] *** Joins: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP)
[16:11:33] *** Quits: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP) (Ping timeout: 121 seconds)
[16:14:22] *** Joins: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP)
[16:15:54] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[16:16:16] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[16:16:43] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[16:19:20] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[16:19:54] *** Quits: summerlight_ (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[16:20:54] <acrichto> WindowsBunny: whoa!
[16:22:00] <XMPPwocky> the moment i switch to linux, now windows's getting all the cool stuff
[16:24:32] *** Joins: davebettin (textual@moz-rnhkmd.bendcable.com)
[16:27:05] *** Quits: laumann (thomas@moz-1f0.hq0.225.130.IP) (Quit: leaving)
[16:27:43] *** Quits: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP) (Ping timeout: 121 seconds)
[16:29:16] *** Joins: eibwen (eibwen@moz-7ovl3b.dip0.t-ipconnect.de)
[16:30:47] *** Joins: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP)
[16:33:08] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[16:34:04] *** Quits: maralla (uid69246@moz-mq40mv.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[16:34:46] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[16:34:57] *** Quits: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP) (Ping timeout: 121 seconds)
[16:42:26] *** Joins: seanmonstar (seanmonstar@moz-jd3i0j.fkdv.ulf6.3c01.2600.IP)
[16:42:50] *** Quits: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP) (Ping timeout: 121 seconds)
[16:42:58] *** Quits: aldeka (quassel@moz-qqf.of6.243.162.IP) (Ping timeout: 121 seconds)
[16:43:50] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[16:48:10] <eddyb> Mutabah: what do you mean?
[16:48:11] * Mutabah is away (Screen Detached)
[16:48:45] <eddyb> (Rc<T> uses the DST smart pointer intrinsics: size_of_val, min_align_of_val and drop_in_place)
[16:52:34] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[16:57:45] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[16:57:45] *** ChanServ sets mode: +o pcwalton
[17:01:10] *** Joins: martin (martin@moz-bmp33l.u0v6.gff7.1608.2001.IP)
[17:01:23] *** Quits: martin (martin@moz-bmp33l.u0v6.gff7.1608.2001.IP) (Quit: WeeChat 1.1.1)
[17:02:43] *** chmanchester|afk is now known as chmanchester
[17:02:58] *** Joins: bdero1 (bran@moz-itn.uao.189.18.IP)
[17:03:15] *** Parts: bdero1 (bran@moz-itn.uao.189.18.IP) ()
[17:03:48] *** Joins: martin (martin@moz-bmp33l.u0v6.gff7.1608.2001.IP)
[17:04:55] *** Quits: martin (martin@moz-bmp33l.u0v6.gff7.1608.2001.IP) (Quit: WeeChat 1.1.1)
[17:04:59] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[17:04:59] *** ChanServ sets mode: +o brson
[17:05:26] *** Joins: martin (martin@moz-bmp33l.u0v6.gff7.1608.2001.IP)
[17:06:09] *** Joins: avikpal (avikpal@moz-a9h.imq.194.117.IP)
[17:07:46] *** Quits: arielb1 (Ariel@moz-9he9ta.red.bezeqint.net) (Ping timeout: 121 seconds)
[17:07:59] *** Joins: arielb1 (Ariel@moz-9he9ta.red.bezeqint.net)
[17:08:01] *** Quits: avikpal (avikpal@moz-a9h.imq.194.117.IP) (Connection closed)
[17:08:15] *** Joins: jdm (jdm@moz-i5m.05u.207.66.IP)
[17:09:05] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[17:10:05] *** Joins: avikpal (avikpal@moz-a9h.imq.194.117.IP)
[17:10:50] <brson> today after i catch up i'm going to continue working on linkage optimization
[17:11:44] <sfackler> aturon: still thinking Duration stable in 1.1? if so, is stabilization blocking on anything?
[17:17:05] *** Joins: bkearns (Adium@moz-rudtng.static.wiline.com)
[17:25:09] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:28:44] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[17:29:46] *** Joins: Diggsey (diggsey@moz-9s9ol4.dsl.pipex.com)
[17:30:46] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[17:31:37] <Eridius> sfackler: my PR to change Duration's impl of fmt::Display is still open: https://github.com/rust-lang/rust/pull/25481
[17:36:19] <eddyb> brson: what can we do better there? I don't think I've ever seen someone look into speeding up linking
[17:37:08] *** Joins: James (quassel@moz-8qs8a3.range86-148.btcentralplus.com)
[17:39:35] <brson> eddyb: oh, it's not speeding up the link step but change the linkage of monomorphized functions to reduce downstream codegen
[17:40:37] <eddyb> brson: using available_externally?
[17:41:16] <eddyb> brson: constants could also use that
[17:41:58] <brson> eddyb: upstream uses linkonceodr and downstream uses available_externally, yeah
[17:42:34] <brson> eddyb: some cursory analysis of servo's monomorphization suggested that 40%+ were duplicates
[17:42:44] <brson> hoping to get rid of some of them
[17:42:45] <eddyb> wow, that would be a pretty nice win
[17:50:07] *** Joins: ph88 (Mibbit@moz-eo02sv.dynamic.ziggo.nl)
[17:50:51] <ph88> hey guys .. what can i do about this?  http://pastebin.com/zciGEZKw  logfile: http://pastebin.com/sTLMVcCx
[17:53:04] *** Quits: avikpal (avikpal@moz-a9h.imq.194.117.IP) (Connection closed)
[17:53:41] <Manishearth> brson: ^ install.sh brokenness
[17:54:02] *** Joins: pcwalton (pcwalton@moz-vst.p2i.254.50.IP)
[17:54:02] *** ChanServ sets mode: +o pcwalton
[17:54:05] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[17:56:10] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Ping timeout: 121 seconds)
[17:56:15] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[17:57:01] *** Joins: geri (Mibbit@moz-fdkcva.highway.telekom.at)
[17:57:04] <geri> hi
[17:57:21] *** Joins: avikpal (avikpal@moz-a9h.imq.194.117.IP)
[17:57:58] <geri> i face an runtime error: illegal instruction when i switch from debug to --release... when i add #[inline(never)] in --release all is fine... how can i figure out the issue?
[17:58:00] *** Quits: avikpal (avikpal@moz-a9h.imq.194.117.IP) (Connection closed)
[17:58:36] *** Joins: avikpal (avikpal@moz-a9h.imq.194.117.IP)
[17:59:05] <Manishearth> geri: post the code and the error in an issue?
[17:59:20] <geri> its hard to reproduce...i cross compile to arm
[17:59:31] <geri> and mmap stuff
[18:00:01] <geri> can i chance the optimization if a specific loop in rust?
[18:00:06] <geri> change
[18:00:43] *** Quits: pcwalton (pcwalton@moz-vst.p2i.254.50.IP) (Client exited)
[18:01:01] <geri> would a diff between dubug and release help to figure out more?
[18:01:14] <eddyb> maybe an IR diff
[18:01:28] <eddyb> geri: sounds like UB in unsafe code
[18:01:52] <geri> i use unsafe since i did low level stuff
[18:02:00] <eddyb> can I see the code?
[18:02:10] <geri> just the function or all code?
[18:02:20] <eddyb> all the code
[18:02:39] <geri> its lots of unsafe... dont punish me :D
[18:02:52] *** Quits: kushal (kdas@moz-0bg.hkq.143.114.IP) (Ping timeout: 121 seconds)
[18:03:09] <eddyb> LLVM is already punishing you (if it's indeed UB)
[18:03:16] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[18:04:07] <Eridius> IIRC I think LLVM does use SIGILL as its "abort" when branching to UB
[18:04:15] <Eridius> on ARM
[18:04:33] <eddyb> Eridius: not specifically on ARM
[18:04:48] <Eridius> well, on x86 it probably uses int3?
[18:05:03] <brson> ph88: that is a surprising error
[18:05:05] <eddyb> no, ud2
[18:05:05] *** Joins: kushal (kdas@moz-iq5.378.143.114.IP)
[18:05:12] <Eridius> hmm ok
[18:06:15] <eddyb> playbot: unsafe { std::intrinsics::abort() }
[18:06:16] -playbot- <anon>:9:18: 9:40 error: use of unstable library feature 'core'
[18:06:16] -playbot- <anon>:9         unsafe { std::intrinsics::abort() }
[18:06:16] -playbot- output truncated; full output at: http://bit.ly/1EORpko
[18:06:18] <eddyb> grr
[18:06:50] <eddyb> playbot: struct Foo; impl Drop for Foo { fn drop(&mut self) {panic!("wheee");} } let _x = Foo; panic!("oops");
[18:06:52] -playbot- thread '<main>' panicked at 'oops', <anon>:9
[18:06:52] -playbot- thread '<main>' panicked at 'wheee', <anon>:9
[18:06:52] -playbot- output truncated; full output at: http://bit.ly/1AG8H8q
[18:07:07] <eddyb> playpen: application terminated abnormally with signal 4 (Illegal instruction)
[18:07:53] <Eridius> you're right, I checked locally, it is ud2
[18:08:09] <brson> ph88: what happens if you just run `sudo umask 022 && mkdir -p /usr/local/share/man/man1`?
[18:08:31] <eddyb> brson: that won't run mkdir as root
[18:08:42] <eddyb> you need sudo bash -c '...' or something
[18:08:43] <brson> eddyb: yeah i just realized
[18:08:55] <brson> sudo bash -c 'sudo umask 022 && mkdir -p /usr/local/share/man/man1' maybe
[18:09:02] <brson> without the extra sudo!
[18:09:04] <eddyb> :D
[18:09:05] <brson> ph88: sorry
[18:09:10] <brson> maybe you can sort that out
[18:09:52] <brson> ph88: what does uname -a say?
[18:10:15] <brson> this error is strange, mkdir -p is supposed to do nothing if the dir exists
[18:10:36] <geri> eddyb: https://gist.github.com/Arnold1/835ebb37a222961bb33f https://gist.github.com/Arnold1/acc773a324ecc355edae
[18:11:44] <geri> eddyb: function in line 114 .. i also tried to change to data: &mut [i32; n], awg: &mut awgParam ... same result
[18:12:49] <brson> ph88: that error is also a 'critical' error for the installer, which means it probably left files behind on your computer
[18:13:02] <brson> ph88: the log file mentioned will say exactly what it did if you want to try to clean it up manually
[18:13:35] <brson> if only we used nix :)
[18:13:41] <geri> eddyb: i figured out that the issue is to write to (*self.chaMem)[i] as well as (*self.chbMem)[i]
[18:18:27] <eddyb> huh
[18:18:49] <eddyb> geri: btw, gists can have multiple files
[18:18:58] *** Joins: Kxepal (Miranda@moz-082iv9.pppoe.mtu-net.ru)
[18:19:22] <eddyb> geri: ouch, you're using `offset`
[18:19:36] <geri> eddyb: so?
[18:19:42] <eddyb> geri: that is UB if it doesn't obey some "same-object" rules
[18:20:13] <eddyb> though I'm not sure it's *that*
[18:20:37] <eddyb> geri: you should be using volatile writes
[18:20:51] <geri> which line?
[18:21:06] *** Quits: _Vi (vi@moz-bbs.vhj.131.104.IP) (Ping timeout: 121 seconds)
[18:21:07] <eddyb> all of them
[18:21:26] <eddyb> the offset calls that might upset LLVM are https://gist.github.com/Arnold1/acc773a324ecc355edae#file-fpga_awg-rs-L76-L78
[18:21:30] <geri> how is the syntax?
[18:21:49] <eddyb> for?
[18:22:02] <geri> using volatile writes
[18:22:35] <eddyb> that's going to be painful. AFAIK there are only intrinsics atm
[18:23:16] <geri> can you tell me what to add...?
[18:23:34] <eddyb> geri: could you first try replacing those ptr.offset(off) calls with std::intrinsics::arith_offset(ptr, off)? that's a version which cannot cause UB by itself
[18:23:53] <geri> ok for all 3 i guess?
[18:24:06] <eddyb> yeah
[18:24:13] <geri> will i need to add a mod?
[18:24:24] <eddyb> `use`?
[18:24:33] <geri> ok
[18:24:49] <eddyb> you may want to `use std::intrinsics::arith_offset;` so you can just write arith_offset
[18:24:56] <eddyb> for volatile reads and writes, see the volatile_* functions here http://doc.rust-lang.org/nightly/std/intrinsics/index.html
[18:25:13] <geri> i use rust 1.0 stable
[18:25:24] <eddyb> geri: that's not an option
[18:25:29] <eddyb> for what you're doing
[18:25:45] <geri> oh i need to update to the lastest version?
[18:25:56] <eddyb> switch to nightly to be able to use unstable features
[18:26:08] <geri> ok
[18:26:16] <eddyb> so the volatile_* functions, they take raw pointers. in particular, volatile_load is a read and volatile_store is a write
[18:26:52] <eddyb> I'm not sure, but it's possible that LLVM optimizes out all the reads and writes - wait, no, I really have no clue now
[18:27:11] <eddyb> mmap-ing memory isn't usually subject to the same rules as MMIO, but why?
[18:27:23] <geri> oh
[18:27:40] <geri> how is it related to no inline?
[18:28:45] <eddyb> #[inline(never)] prevents some potentially dangerous optimizations
[18:28:50] <geri> i mean #[inline(never)] 
[18:29:06] <geri> could it be that the loop will be optimized?
[18:29:31] <geri> the issue is within the loop
[18:29:56] <geri> writing to the mapped mem
[18:30:08] <eddyb> sure it's going to be optimized
[18:30:32] <geri> could i make a manual test and write a memcopy?
[18:30:44] <geri> instead of the loop?
[18:30:56] <eddyb> if that loop triggers SIGILL, that means some other part of your code is wrong
[18:31:35] <eddyb> playbot: 0x20000-0x10000
[18:31:36] -playbot- 65536
[18:32:01] <eddyb> geri: have you tried arith_offset? oh, I guess you need to switch to nightly first
[18:32:19] <geri> not yet ... i need to build the nightly compiler first
[18:32:22] <geri> that takes a while
[18:32:33] <eddyb> build? why
[18:32:42] <geri> i cross compile to arm
[18:32:58] <eddyb> japaric provides ARM cross-compilers, doesn't he?
[18:33:03] *** Quits: jdm (jdm@moz-i5m.05u.207.66.IP) (Connection closed)
[18:33:18] *** Joins: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP)
[18:33:35] <eddyb> there's https://www.reddit.com/r/rust/comments/37wat6/unofficial_rustcargo_nightlybetastable_builds_for/
[18:34:00] *** Joins: jld (jld@moz-onnk26.xlerb.net)
[18:34:14] <eddyb> not sure if it can be used for cross-compilation
[18:36:12] <eddyb> I think it can be, though, if you use the right host version
[18:36:27] <eddyb> geri: alternatively... you can degrade to integer-based pointer arithmetic
[18:37:15] *** Quits: davebettin (textual@moz-rnhkmd.bendcable.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:37:19] <eddyb> geri: replace data.offset(AWG_BASE_ADDR) as *mut awg_reg with (data as usize + AWG_BASE_ADDR) as *mut awg_reg
[18:37:26] <eddyb> (sorry, I forgot about this simpler way
[18:37:52] <eddyb> also, in 	pub fn write_data_fpga(&mut self, ch: u32, data: *mut [i32; n], awg: *mut awgParam) {
[18:38:06] *** Joins: bdero (bran@moz-c8i0l7.mit.edu)
[18:38:07] <eddyb> data and awg can be &T instead of *mut T
[18:38:19] <eddyb> and i doesn't need to be declared
[18:38:51] <eddyb> but that's just makes the code harder to understand, the main source of unsafety still has to be the offsets
[18:41:47] *** Quits: mukilan (mukilan@moz-agl.8le.164.122.IP) (A TLS packet with unexpected length was received.)
[18:44:44] *** Quits: arielb1 (Ariel@moz-9he9ta.red.bezeqint.net) (Quit: Ex-Chat)
[18:46:25] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[18:46:25] *** ChanServ sets mode: +o pcwalton
[18:49:05] *** Joins: eddyb_ (eddyb@moz-e8s.ur8.27.188.IP)
[18:51:52] *** Quits: eddyb (eddyb@moz-9ak.sgj.26.188.IP) (Ping timeout: 121 seconds)
[18:54:18] *** eddyb_ is now known as eddyb
[18:57:00] *** Quits: nickniko_ (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[18:59:32] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[18:59:38] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:01:51] *** Joins: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de)
[19:02:51] *** Quits: bkearns (Adium@moz-rudtng.static.wiline.com) (Quit: Leaving.)
[19:03:57] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[19:05:50] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[19:12:59] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[19:14:41] <geri> eddyb: i really think the issue is with this loop... The thing with this loop is, g_awg_ch[ab]_mem are pointers into the fpga's address space... 
[19:15:38] <geri> eddyb: So replacing the loop with memcpy might work if 32bit accesses are preserved, but if the compiler decides to optimize the accesses, it may not work... 
[19:15:47] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[19:15:47] *** ChanServ sets mode: +o pcwalton
[19:16:34] <geri> eddyb: can i tell the compiler not to optimize the loop somehow?
[19:17:17] <XMPPwocky> geri: volatile_load/store?
[19:17:23] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[19:17:42] <eddyb> geri: oh
[19:17:52] <eddyb> geri: you mean "optimize out" or "optimize away" not just "optimize"
[19:17:55] <ph88> brson: you want me to run this command?   sudo umask 022 && mkdir -p /usr/local/share/man/man1      uname=Linux ph88-1215N 3.19.0-16-generic #16-Ubuntu SMP Thu Apr 30 16:09:58 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
[19:18:11] <eddyb> geri: are you sure that's what happens? that wouldn't trigger SIGILL
[19:18:12] <geri> eddyb: disable optimization :)
[19:18:24] <eddyb> geri: optimizations would turn the loop into a faster loop
[19:18:32] <eddyb> or a memcpy
[19:18:41] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[19:18:52] <eddyb> not necessarily remove it altogether
[19:19:04] <ph88> brson: eh this command ?   sudo bash -c 'umask 022 && mkdir -p /usr/local/share/man/man1'
[19:19:09] <geri> but you dont know it if you dont have the asm
[19:19:14] <ph88> i run zshell
[19:19:29] <geri> eddyb: can i disable the optimization for this loop for quick test?
[19:19:30] <eddyb> geri: to get bad codegen, you must be doing something wrong
[19:19:43] <eddyb> do you get SIGILL?
[19:19:56] <eddyb> because you can just comment out the loop and see if you still get SIGILL
[19:20:04] <geri> here the strace output: http://paste.ubuntu.com/11482780/
[19:20:07] <geofft> geri: if you're in the platforms listed in stack_overflow.rs, you wrongly get SIGILL instead of SIGSEGV 
[19:20:11] <geofft> and Linux is one of those 
[19:20:29] <eddyb> --- SIGBUS {si_signo=SIGBUS, si_code=SI_USER, si_pid=908132352, si_uid=0} ---
[19:20:30] <eddyb> oh
[19:20:34] <geofft> oh yeah, the SIGBUS-to-SIGILL thing is a bug in the SIGBUS handler, treat it as actually SIGBUS 
[19:20:45] <geri> what does it mean?
[19:20:46] <eddyb> sorry!
[19:20:46] <geofft> (I have a patch for that, but it's blocking on my other signal patch) 
[19:20:53] <eddyb> geri: you have a segmentation fault
[19:21:04] *** Joins: clatour (clatour@moz-slkfub.hlrn.qwest.net)
[19:21:05] <geri> eddyb: bc of the 32 bit address issue?
[19:21:06] <eddyb> geri: you should run the program in a debugger
[19:21:14] <geofft> or an alignment issue 
[19:21:15] <eddyb> what 32-bit address issue?
[19:21:40] <eddyb> on non-AArch64 ARM addresses are 32-bit
[19:21:53] <geri> eddyb: i mean i need to only access this region 32bits at a time
[19:21:55] <geofft> actually.. if strace is to be believed, process id 908132352 sent you an explicit SIGBUS 
[19:22:20] <eddyb> playbot: format!("{:x}", 908132352)
[19:22:22] -playbot- "36210000"
[19:22:30] <eddyb> that looks like an address to me
[19:22:59] <geofft> mrrr, that union is dumb, yes, that's probably si_addr not si_pid 
[19:23:11] <eddyb> close(3)                                = 0
[19:23:39] <eddyb> nevermind, mmap refcounts the fd
[19:23:59] <eddyb> geri: running this under gdb will give you more information
[19:24:11] <geri> ok
[19:24:48] <SimonSapin> Is the ordering generated by `#[derive(PartialOrd)]` always total, antisymmetric, and transitive? (The constraints of `Ord`)
[19:24:59] <eddyb> geri: it's an access at offset 0x210000 inside the mmap region btw
[19:25:00] <SimonSapin> Assuming the respective orderings of the components are
[19:25:07] <geri> eddyb: yes
[19:25:38] <eddyb> sheesh, sorry for wasting your time with guesses of UB
[19:25:40] *** Joins: _Vi (vi@moz-bbs.vhj.131.104.IP)
[19:26:25] <geri> eddyb: its the start address of chaMem
[19:26:35] <eddyb> playbot: format!("{:x} {:x}", 908132352 - 0x36000000, 4194304)
[19:26:36] -playbot- "210000 400000"
[19:26:59] <eddyb> geri: and this only happens when optimizations are turned on?
[19:27:05] <geri> yes
[19:27:06] <eddyb> that's odd
[19:27:10] <geri> with debug its all fine
[19:27:43] <eddyb> geri: could you write *(data.offset(AWG_BASE_ADDR + AWG_CHA_OFFSET as isize) as *mut u32) = 0;?
[19:28:04] <eddyb> geri: right after creating the mmap'd region?
[19:28:07] <geri> before the loop?
[19:28:17] *** Joins: edward-san (Edward`san@moz-6u9adl.retail.telecomitalia.it)
[19:28:17] <eddyb> in fpgaAwg::new
[19:28:35] <eddyb> and don't even call the loop
[19:28:43] *** Joins: skeuomorf (skeuomorf@moz-a8h.ni9.32.197.IP)
[19:28:54] <geri> ok
[19:29:03] <geri> and what about the ideas from before?
[19:29:14] <eddyb> which ones?
[19:29:27] <geri> eddyb: replace data.offset(AWG_BASE_ADDR) as *mut awg_reg with (data as usize + AWG_BASE_ADDR) as *mut awg_reg
[19:29:35] <eddyb> I'm not sure volatile has an impact, the address is perfectly aligned...
[19:29:42] <geri> ok
[19:29:45] <eddyb> geri: that was for UB, and this is not a SIGILL caused by UB, sorry
[19:29:59] <geri> i keep the same code and add the *(data.offset(AWG_BASE_ADDR + AWG_CHA_OFFSET as isize) as *mut u32) = 0;   ok?
[19:30:06] <edward-san> are complex numbers available in rust?
[19:30:19] <bluss> edward-san: in the num crate
[19:30:21] <eddyb> geri: yes, but in main, don't call anything other than the fpaAwg::new function
[19:30:37] <geri> ok
[19:31:43] <edward-san> bluss, I see no trace of it in the std::num page: https://doc.rust-lang.org/nightly/std/num/
[19:31:56] <bluss> !crate num
[19:31:57] <rustbot> num (0.1.24) - Simple numerics. This crate contains basic arbitrary-sized integer,rational, and complex types. -> https://crates.io/crates/num
[19:32:00] <bluss> edward-san: ^ this one
[19:32:21] *** Joins: bkearns (Adium@moz-rudtng.static.wiline.com)
[19:34:47] *** Quits: bdero (bran@moz-c8i0l7.mit.edu) (Ping timeout: 121 seconds)
[19:35:20] *** Quits: avikpal (avikpal@moz-a9h.imq.194.117.IP) (Connection closed)
[19:36:08] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[19:37:07] <edward-san> which also has this page: http://doc.rust-lang.org/num/num/index.html ... it's interesting that it was not accessible through the api docs page
[19:38:34] <bluss> it's not part of libstd
[19:38:35] <geri> eddyb: that works fine!!
[19:39:00] <bluss> edward-san: it's a separate crate, separately versioned, but still maintained by rust-lang
[19:39:07] <bluss> edward-san: there are a couple of those
[19:40:41] <eddyb> geri: even with optimizations on?
[19:40:59] <geri> yes
[19:41:13] <eddyb> hmm
[19:41:30] *** Joins: nrc (nrc@moz-14pjgj.xtra.co.nz)
[19:41:31] *** ChanServ sets mode: +o nrc
[19:41:47] <geri> could it be optimized away?
[19:41:51] <eddyb> geri: what about (*chaMem)[0] = 0;? (still in fpgaAwg::new)
[19:42:06] <eddyb> no, it's not optimized away, the write *is there* and it's what causing your program to crash
[19:42:12] <brson> ph88: yeah the latter. did it produce the same error?
[19:42:20] <eddyb> if it were optimized away, nothing would happen
[19:42:27] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[19:42:29] <brson> ph88: I wonder if running from zsh could have some mysterious side-effect
[19:42:33] <eddyb> OH
[19:42:48] <eddyb> geri: maybe it's an ordering issue between https://gist.github.com/Arnold1/acc773a324ecc355edae#file-fpga_awg-rs-L120-L124 and the loop
[19:43:02] <brson> ph88: is /bin/sh a symlink to zsh? (surely not)
[19:43:05] *** Joins: binkarus (textual@moz-014tff.ca.comcast.net)
[19:43:21] <geri> eddyb: i disabled the loop and it didnt show any erros
[19:43:49] <eddyb> geri: what if you do the loop with no register setting?
[19:44:01] <geri> like what?
[19:44:09] <eddyb> comment out all the awgReg stuff
[19:44:21] <geri> for i in 0..n { } ?
[19:44:26] <eddyb> no
[19:44:28] <WindowsBunny> Manishearth: Do you think you could use your connections with Microsoft to get us the specs for standard debug info in object files in msvc?
[19:44:29] <eddyb> that's the loop
[19:44:39] <eddyb> geri: I'm talking about the highlighted lines here https://gist.github.com/Arnold1/acc773a324ecc355edae#file-fpga_awg-rs-L120-L124
[19:44:47] <eddyb> the ones starting with (*self.awgReg)
[19:44:58] <geri> ok disable them all?
[19:44:59] <brson> ph88: if you just run 'sh' does it launch zsh instead of bash/dash?
[19:45:02] *** Quits: semarie (semarie@moz-vjb.r8r.42.192.IP) (A TLS packet with unexpected length was received.)
[19:45:08] <eddyb> geri: yes
[19:45:18] <brson> maybe zsh posix emulation behaves differently than dash's
[19:45:21] *** Quits: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP) (A TLS packet with unexpected length was received.)
[19:45:29] <eddyb> geri: they might cause the device to go into a mode where it denies writes or something
[19:45:31] <Manishearth> WindowsBunny: I ... doubt it
[19:45:44] *** Joins: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP)
[19:45:46] <Manishearth> WindowsBunny: I don't know whom to approach either
[19:45:57] <Manishearth> The VS team is here. And Azure, and Office.
[19:46:05] <Manishearth> No windows stuff
[19:46:13] <Manishearth> (assorted other teams, like cortana, too)
[19:46:26] <Manishearth> I can ask around though
[19:47:01] <geri> eddyb: still error
[19:47:39] <WindowsBunny> Manishearth: I found a CV4 spec somewhere on the internet, but I can't find codeview 5 anywhere
[19:47:42] *** Joins: aldeka (quassel@moz-qqf.of6.243.162.IP)
[19:47:58] <WindowsBunny> Manishearth: But what everyone really wants is a PDB spec :P
[19:48:03] <geri> for i in 0...n { (*self.chaMem)[i] = 0; } ... also this returns illegal instruction
[19:48:07] <Manishearth> WindowsBunny: I also don't understand windows so I don't even know what I'm asking for
[19:48:12] <geri> eddyb: 
[19:48:18] <WindowsBunny> Manishearth: Hmmm, that might be an issue
[19:48:20] <geri> for i in 0...n { (*self.chaMem)[i] = 0; } ... also this returns illegal instruction
[19:48:35] <Manishearth> WindowsBunny: if you send me an email with all the details -- what PDB is, what it falls under, perhaps I can help
[19:48:49] <Manishearth> (I know what pdb is, but I don't know enough to hunt for the people responsible for it)
[19:50:28] <Manishearth> also, might be worth finding other languages who have gone through this to see if they know something
[19:50:31] <Manishearth> also what is codeview
[19:50:43] <Manishearth> ah okay
[19:50:47] <eddyb> geri: what if you move that loop into the new function and have just for i in 0...n { (*chaMem)[i] = 0; }?
[19:51:09] <WindowsBunny> Manishearth: Codeview is the old debug info format, before it was replaced by PDB
[19:51:13] <geri> ok, what should that effect?
[19:51:28] <Manishearth> WindowsBunny: we don't want that, right?
[19:51:58] <WindowsBunny> Manishearth: a way to emit PDB debug info is the best thing we want
[19:52:18] <Manishearth> WindowsBunny: but it's old?
[19:52:24] <Manishearth> oh but backcompat i guess
[19:52:25] <WindowsBunny> Manishearth: Failing that, a CodeView 5 spec would still let us emit debug info that link.exe understands and would be newer than codeview 4
[19:52:45] <Manishearth> okay, send me an email with all the details, what I should ask for, what I should ask for if that can't be done, etc
[19:53:01] <Manishearth> At the very least I could try to find someone and have them chat with the core or tooling teams
[19:53:20] <WindowsBunny> Manishearth: your name @ gmail?
[19:54:12] *** Quits: huseby (huseby@moz-m7l0au.d2vr.5em6.6400.2605.IP) (Ping timeout: 121 seconds)
[19:54:12] <Manishearth> username @ gmail
[19:54:18] <Manishearth> or t-magor @ microsoft
[19:54:42] <eddyb> geri: idk, just trying things
[19:54:54] <eddyb> geri: sorry, this will not make sense until you find the issue
[19:55:01] <eddyb> I mean, it doesn't make sense for me
[19:55:06] <geri> :D
[19:55:40] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[19:56:12] <geri> eddyb: i guess the function will be inlined? :D
[19:56:41] <geri> eddyb: no success with that special function
[19:57:39] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[19:57:42] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[19:57:54] <geri> eddyb: the function only works with #[inline(never)]
[19:57:59] <eddyb> nono
[19:58:13] <eddyb> geri: no function other than fpgaAwg::new
[19:58:18] <eddyb> just have everything in one tiny function
[19:58:26] <eddyb> opening up the file and attempting to write some bytes
[19:58:44] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[19:59:14] <geri> eddyb: we just talked about the loop
[20:00:17] <eddyb> geri: yes. move it out of the separate function
[20:00:19] <eddyb> ugh
[20:00:20] <eddyb> let me just show you
[20:00:22] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:00:24] <geri> ok
[20:01:25] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[20:02:19] <Manishearth> WindowsBunny: thanks
[20:02:32] *** Joins: xilec (Mibbit@moz-g6k.oht.161.46.IP)
[20:03:18] <eddyb> geri: https://gist.github.com/eddyb/452f50ba34b967b3816e
[20:03:22] <eddyb> geri: something like this
[20:03:55] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[20:03:58] <WindowsBunny> Manishearth: Since Microsoft has been going on an open source binge lately, see if you can convince them to open up the PDB format :D
[20:04:18] *** Joins: genbattle (genbattle@moz-4v0.gkd.16.182.IP)
[20:04:23] <Manishearth> haha
[20:04:31] <Manishearth> I don't know if the India team has the power to do so
[20:04:42] <ph88> brson: can i query you? 
[20:04:48] <Manishearth> I think MSIDC only handles a portion of the VS stuff
[20:04:53] <geri> eddyb: ok, you forgot unsafe...
[20:04:59] <eddyb> oh, right
[20:05:01] <eddyb> in the loop
[20:05:08] <Manishearth> but .. perhaps they can get me in touch with someone who can
[20:05:08] <brson> ph88: yes
[20:05:23] <eddyb> geri: fixed
[20:06:23] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[20:06:45] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[20:08:56] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[20:10:51] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[20:12:25] *** Joins: willem (willem@moz-facs2s.dynamic.upc.nl)
[20:13:26] *** bvssvni is now known as bvssvni_
[20:13:27] *** Joins: huseby (huseby@moz-m7l0au.d2vr.5em6.6400.2605.IP)
[20:14:32] <geri> eddyb: that code work fine
[20:15:54] <eddyb> geri: now add a function returning your structure and a function doing the loop from the structure
[20:15:58] <eddyb> still a bit odd though
[20:17:35] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Quit: leaving)
[20:18:14] *** Joins: doener (doener@moz-929cn9.unity-media.net)
[20:18:41] <geri> eddyb: now it fails :D
[20:19:03] <eddyb> geri: so it's enough to put the pointer in the structure for it to fail?
[20:19:48] <eddyb> geri: what if you also keep f around, not just mmap?
[20:20:08] <geri> https://gist.github.com/Arnold1/b6615cae596fd46b0c88
[20:24:33] *** Joins: mib_3gziz4 (Mibbit@moz-juv.9o3.252.72.IP)
[20:25:25] <geri> eddyb: so it's enough to put the pointer in the structure for it to fail? no: only if i write to the mem
[20:25:43] <geri> eddyb: what if you also keep f around, not just mmap? thats already in the example?
[20:26:08] *** Quits: mib_3gziz4 (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:27:37] *** Quits: nham (nham@moz-lglsfe.il.comcast.net) (Ping timeout: 121 seconds)
[20:28:36] <eddyb> geri: wait, what, it's enough for it to be in a separate function?
[20:29:14] <eddyb> geri: what if you use *mut u32 for those pointers and *chaMem.offset(i) = 0;?
[20:29:23] <geri> passing the pointer to the function and not writing to the mem doesnt fail
[20:30:00] <brson> the haskell platform apparently symlinks `/usr/local/share/man/man1` to the ghc.1 manpage
[20:30:08] <brson> the man1 *directory* to the ghc man page
[20:30:18] <brson> and that confuses rust-installer bad
[20:30:23] <brson> https://github.com/rust-lang/rust-installer/issues/36
[20:32:02] <geri> eddyb: same error
[20:32:06] <acrichto> brson: wut
[20:32:19] <eddyb> geri: I am confused
[20:33:14] *** chmanchester is now known as chmanchester|afk
[20:33:17] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:33:30] <geri> eddyb: https://gist.github.com/Arnold1/98defd9477b887ace263
[20:33:34] <geri> this fails
[20:35:06] <eddyb> with or without optimizations?
[20:35:13] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[20:35:27] <geri> with
[20:35:38] <eddyb> only with?
[20:36:00] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[20:36:02] <geri> should i add inline(never) ?
[20:36:18] <eddyb> no, I mean, have you tried running in debug move?
[20:36:27] <geri> not yet
[20:36:39] <eddyb> *mode
[20:37:25] *** Joins: larhat (Adium@moz-vlo5br.cable.virginm.net)
[20:37:30] <geri> it runs with with debug
[20:37:40] <geri> runs fine
[20:38:38] <eddyb> geri: but it works in release mode if the loop is in main and not in a separate function?
[20:39:00] *** Quits: ph88 (Mibbit@moz-eo02sv.dynamic.ziggo.nl) (Quit: http://www.mibbit.com ajax IRC Client)
[20:39:25] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[20:40:15] <geri> eddyb: yes!
[20:42:56] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[20:43:09] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[20:43:30] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Ping timeout: 121 seconds)
[20:43:45] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[20:43:45] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[20:43:46] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[20:43:47] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:44:15] <eddyb> uh oh
[20:44:25] <geri> eddyb: what do you conclude? :D
[20:45:53] <eddyb> geri: what about https://gist.github.com/eddyb/6b9e478ca03bd4170aa0?
[20:46:30] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[20:49:52] <geri> eddyb: that works
[20:51:01] <eddyb> mkay
[20:53:13] <geri> does that make sense? :D
[20:53:27] *** chmanchester|afk is now known as chmanchester
[20:54:34] <eddyb> geri: maybe, but I'm not sure
[20:55:02] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:55:08] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:55:11] *** Joins: Sho (sho@moz-anta7k.cust.telecolumbus.net)
[20:55:33] <eddyb> geri: have you tried running it in a debugger? I'm curious what instruction it's running when it segfaults
[20:55:42] <geri> not yet
[20:55:47] <geri> with the pointer version?
[20:55:52] <eddyb> yeah
[20:56:32] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[20:56:42] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[20:57:48] <WindowsBunny> bluss: cmd.exe accepts paths with both forward and back slashes
[20:57:48] <geri> sigbus received from memset
[20:57:55] <geri> eddyb: sigbus received from memset
[20:58:02] <WindowsBunny> bluss: while msys only really accepts forward slashes
[20:58:12] <geri> eddyb: from libc.so.6
[20:58:37] *** Joins: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com)
[20:58:54] *** Joins: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu)
[20:59:07] *** Quits: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP) (A TLS packet with unexpected length was received.)
[20:59:26] *** Joins: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP)
[20:59:38] *** Quits: kushal (kdas@moz-iq5.378.143.114.IP) (Ping timeout: 121 seconds)
[20:59:38] *** Quits: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net) (Client exited)
[20:59:41] <WindowsBunny> bluss: So if you just replace backslashes with forwardslashes, and then escape inner quotes with backslashes, it'll work on both cmd and msys
[21:00:11] <bluss> hm inner ' or "?
[21:00:21] <geri> eddyb: https://gist.github.com/Arnold1/8ce83b41ed5a5006551f
[21:00:50] <eddyb> hehehehe
[21:00:59] <eddyb> geri: so what happens is the loop gets optimized
[21:01:25] <eddyb> geri: run dissassemble
[21:01:46] <eddyb> geri: I'm curious what instruction is doing it
[21:02:25] <eddyb> geri: you might be able to work around this optimization by using volatile_store
[21:02:37] <eddyb> if memset isn't compatible with that mmap'd file
[21:02:46] <geri> eddyb: some more infos: https://gist.github.com/Arnold1/17fa3d433994b3a38ea9
[21:03:43] <geri> eddyb: isnt it what i was saying at the very beginning? :D
[21:04:39] *** Joins: fredrik (fredrik@moz-2b08ue.priv.bahnhof.se)
[21:04:55] <geri> eddyb: whats the name of the dissassemble tool on ubuntu?
[21:05:02] <eddyb> geri: no, disassemble in gdb
[21:05:20] <eddyb> https://gist.github.com/Arnold1/17fa3d433994b3a38ea9#file-gdb2-L57
[21:05:22] <eddyb> at this point
[21:05:27] <eddyb> disassemble
[21:05:28] <eddyb> just that
[21:05:30] <geri> in dgb?
[21:05:32] <geri> ok
[21:07:52] *** Quits: flaper87 (flaper87@moz-fnn.1e9.132.209.IP) (Ping timeout: 121 seconds)
[21:08:50] <geri> eddyb: https://gist.github.com/Arnold1/ab7f3cbb6322990d685a
[21:09:11] <eddyb> => 0x2a00b054 <+612>:	mov	r0, r4
[21:09:12] <eddyb> this?
[21:09:20] <eddyb> nonono
[21:09:22] <eddyb> geri: don't do that
[21:09:31] <eddyb> geri: don't single-step at all
[21:09:51] <eddyb> geri: just run the program in gdb, without any breakpoints
[21:09:55] <geri> ok
[21:09:57] <eddyb> geri: it will stop at the SIGBUS
[21:10:02] <eddyb> and then you run disassemble
[21:10:22] <WindowsBunny> bluss: inner double quotes
[21:10:36] <WindowsBunny> bluss: single quotes are irrelevant and have no effect
[21:10:48] <bluss> ok
[21:10:58] <bluss> WindowsBunny: very useful info! :)
[21:10:59] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[21:11:02] *** Joins: flaper87 (flaper87@moz-fnn.1e9.132.209.IP)
[21:11:37] *** Joins: frogzilla (Mibbit@moz-juv.9o3.252.72.IP)
[21:11:53] <geri> eddyb: https://gist.github.com/Arnold1/c5728aea64fea257603e
[21:12:24] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[21:14:06] *** Quits: frogzilla (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:16:06] <eddyb> geri: you shouldn't have continued https://gist.github.com/Arnold1/c5728aea64fea257603e#file-gistfile1-txt-L29
[21:16:21] <eddyb> geri: the SIGBUS in memset is what I want a disassemble of
[21:16:28] <eddyb> geri: everything else is irrelevant
[21:16:48] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[21:18:04] *** Quits: flaper87 (flaper87@moz-fnn.1e9.132.209.IP) (Ping timeout: 121 seconds)
[21:18:44] <geri> eddyb: like that? https://gist.github.com/Arnold1/145ffe8411b45cb04938
[21:19:07] *** Quits: willem (willem@moz-facs2s.dynamic.upc.nl) (Quit: leaving)
[21:19:07] <eddyb> aha! stmiacs	r3!, {r1, r12}
[21:20:03] <eddyb> now I need someone who knows what that means
[21:20:13] <geri> #asm ? :D
[21:20:47] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[21:21:06] <geri> eddyb: on freenode i guess :D
[21:22:05] <eddyb> found something claiming that the new name of that instruction is stmcs
[21:22:15] <eddyb> which I can't find either
[21:22:47] <eddyb> OH
[21:22:52] <geri> for arm?
[21:22:56] <eddyb> is CS a condition code?
[21:23:19] *** Joins: flaper87 (flaper87@moz-fnn.1e9.132.209.IP)
[21:23:42] <eddyb> geri: okay, so this is just a "store multiple" instruction
[21:24:31] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:24:57] <eddyb> but why would it behave differently?
[21:25:35] <geri> multiple of 32 bit?
[21:25:46] <eddyb> it stores two 32-bit values
[21:26:00] <geri> oh
[21:26:05] <eddyb> maybe it's like some sort of 64-bit store
[21:26:11] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[21:26:11] <eddyb> http://doc.rust-lang.org/std/intrinsics/fn.volatile_copy_nonoverlapping_memory.html
[21:26:16] <eddyb> this is something you can use, btw
[21:26:29] <brson> i'm confused about how to annotate the llvm declaration with linkage attributes vs the lld definition
[21:26:33] <eddyb> hopefully it doesn't end up using the optimized instructions
[21:26:45] <brson> it seems the two are conflated in a single lldecl in the code?
[21:26:48] <eddyb> brson: using lld? o_O
[21:26:53] <brson> eddyb: no in trans
[21:27:06] <brson> some linkage attributes only go on the definition some only on the declaration
[21:27:13] <eddyb> oh, *that*
[21:27:30] <geri> eddyb: someone told me: you should only access this region 32bits at a time. 
[21:27:30] <eddyb> the definition and declaration are identical if they're both present
[21:27:48] <eddyb> geri: yes, but this should still be two 32-bit stores
[21:28:14] *** Quits: James (quassel@moz-8qs8a3.range86-148.btcentralplus.com) (Connection closed)
[21:29:33] <eddyb> geri: anyways, this with u32 pointers http://doc.rust-lang.org/std/intrinsics/fn.volatile_store.html
[21:29:44] <eddyb> geri: and values. that should do exactly what you want
[21:30:07] <geri> how is the syntax?
[21:30:51] <eddyb> volatile_store(pointer, value)
[21:30:58] <eddyb> instead of *pointer = value;
[21:31:02] <geri> volatile_store((*self.chaMem)[i], 0) ?
[21:31:41] <eddyb> volatile_store(self.chaMem.offset(i), 0) 
[21:31:46] <geri> ok
[21:31:53] <geri> but will need nightly?
[21:32:20] <eddyb> yes
[21:32:38] <geri> what about when reading from that memory?
[21:32:46] <geri> i need a volatile_load ?
[21:32:49] <eddyb> yupp
[21:33:16] <eddyb> you should be able to use the libraries from japaric's builds. and the host compiler for the same nightly build
[21:33:37] <geri> i plan to build it from source
[21:33:41] <geri> any issue with that?
[21:34:11] *** Quits: binkarus (textual@moz-014tff.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:34:14] *** Quits: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de) (Quit: Bye)
[21:35:22] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[21:36:29] <eddyb> geri: it's fine, it will just take longer
[21:36:49] <geri> okk
[21:37:34] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[21:39:41] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:40:19] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[21:40:38] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Ping timeout: 121 seconds)
[21:42:04] *** Quits: Rym (y@moz-mhu.sd4.38.217.IP) (Ping timeout: 121 seconds)
[21:42:19] <geri> eddyb: is there a way to disable optimization in rust?
[21:42:55] <geri> eddyb: besides inline(never) ?
[21:43:21] <geri> eddyb: it to set the optimization flags with cargo?
[21:43:52] <eddyb> geri: that's not a very good idea
[21:44:25] <geri> eddyb: hu?
[21:44:34] <eddyb> geri: oh, I think LLVM doesn't optimize with #[inline(never)] because you pass *mut [T] for data
[21:44:40] <eddyb> instead of &[T] or whatever
[21:44:54] <eddyb> so it thinks the data and the mmap pointer can alias (which they can't)
[21:45:17] <eddyb> but LLVM should actually be able to optimize your original code even with #[inline(never)]
[21:45:33] <eddyb> the problem is that the optimization is wrong because you have restrictions on your data access
[21:45:44] <geri> is it a bug in rust?
[21:45:49] <eddyb> no
[21:45:51] <eddyb> so either don't optimize at all, or use volatile_store
[21:46:05] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[21:46:20] <geri> i have some code which needs optization besides reading and writing to the mem
[21:47:03] <eddyb> so you'll have to use nightly
[21:47:13] <geri> ok installing...
[21:47:25] <eddyb> stable Rust isn't really up to the challenge of low-level hardware programming
[21:47:32] <geri> nightly will be rust 1.1 in 6 weeks?
[21:47:50] <eddyb> geri: the volatile intrinsics won't be exposed in 1.1 or 1.2
[21:48:16] <steveklabnik> geri: nightly will be rust 1.2 in... 10 weeks?
[21:48:20] *** Quits: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP) (A TLS packet with unexpected length was received.)
[21:48:54] *** Joins: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP)
[21:49:20] <steveklabnik> when 1.0 was released, 1.1 was branched, and 1.2 is master
[21:49:27] <steveklabnik> so today's nightlies are 1.2
[21:52:53] *** Quits: achernya_ (quassel@moz-i01917.mit.edu) (Ping timeout: 121 seconds)
[21:54:05] <edward-san> wait, will the next release be 1.2 or 1.1?
[21:54:44] <WindowsBunny> edward-san: stable is 1.0, beta is 1.1, nightly is 1.2, in a few weeks stable will be 1.1, beta will be 1.2, and nightly will be 1.3
[21:55:35] *** Quits: larhat (Adium@moz-vlo5br.cable.virginm.net) (Quit: Leaving.)
[21:56:02] <edward-san> quite clever, indeed
[21:56:03] <steveklabnik> always this way
[21:56:05] <steveklabnik> :)
[21:57:55] <geri> is it backwards compatible?
[21:58:53] <steveklabnik> yes
[21:59:01] <steveklabnik> 1.1 should be a drop-in replacement for 1.0
[21:59:03] <steveklabnik> etc
[21:59:17] <steveklabnik> there's a small, small asterick there
[21:59:29] <geri> ok
[22:00:01] <steveklabnik> if we say, fix a type inference thing, as long as it takes a trivial annotation to fix, we might do it. but we're hoping to not even have that
[22:00:04] <steveklabnik> more detials here
[22:00:22] <steveklabnik> https://github.com/rust-lang/rfcs/pull/1122
[22:00:49] <geri> small things are ok, but if people needs to rewrite 1000 lines of code... no fun
[22:01:24] <steveklabnik> exactly
[22:01:34] <geri> "Though it might eat your laundry due to the compiler more aggressively exploiting latent UB in the code than the compilers of 25 years earlier. ;)"
[22:01:36] <geri> :D
[22:02:50] <geri> even go will do a small change for 1.5
[22:03:20] <geri> but only extend the syntax.
[22:05:02] *** Joins: achernya (quassel@moz-i01917.mit.edu)
[22:06:38] *** Joins: binkarus (textual@moz-014tff.ca.comcast.net)
[22:06:38] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[22:07:33] <acrichto> doener: ping
[22:12:14] *** Quits: eibwen (eibwen@moz-7ovl3b.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[22:14:44] *** Joins: Rym (y@moz-mhu.sd4.38.217.IP)
[22:19:24] *** Quits: fredrik (fredrik@moz-2b08ue.priv.bahnhof.se) (Ping timeout: 121 seconds)
[22:24:45] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[22:27:49] *** Joins: summerlight_ (summerlight@moz-99k.2mj.130.121.IP)
[22:33:24] *** Quits: jevin_ (jevin@moz-sra.ovp.12.72.IP) (Connection closed)
[22:33:39] *** Joins: jevin (jevin@moz-ms8.93o.175.166.IP)
[22:33:46] <brson> unreferenced linkonceodr functions are allowed to be discarded when unreferenced, which makes it impossible to avoid emitting downstream generics when they aren't #[inline]
[22:34:05] <brson> because some of the upstream instances get dead-code eliminated
[22:34:45] <brson> probably not a big loss
[22:37:13] <brson> it's making me question whether this will work though because i can't mark downstream versions available_externally because i can't know it actually is available
[22:38:33] *** Quits: jevin (jevin@moz-ms8.93o.175.166.IP) (Connection closed)
[22:38:54] *** Joins: jevin (jevin@moz-sra.ovp.12.72.IP)
[22:40:14] <geri> eddyb: im back when i have more news...thanks for far!
[22:41:03] * brson asking in #llvm
[22:43:17] *** Quits: jdm (jdm@moz-uvd6cm.ckpj.s0pt.0450.2001.IP) (Quit: )
[22:43:33] <brson> i'm going to try weak_odr linkage instead of linkonce_odr
[22:44:14] <brson> i'm wonder precisely what c++ uses linkonce_odr for. google does not help much
[22:47:59] *** Quits: summerlight_ (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[22:48:01] *** Quits: andars (andars@moz-bsldst.sntcca.sbcglobal.net) (Ping timeout: 121 seconds)
[22:50:59] *** Joins: njn (chatzilla@moz-c6c476.iinet.net.au)
[22:51:43] <brson> well, i'm going to file a bug against the haskell platform for fucking up the rust platform
[22:52:48] <eddyb> haha
[22:53:39] <eddyb> brson: why did you want to use linkonce_odr specifically?
[22:54:15] <brson> eddyb: i was under the impression c++ also used it for a similar purpose
[22:54:37] <eddyb> brson: do you want something that only takes effect when linking together an executable?
[22:56:37] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:56:39] <brson> eddyb: no. what i want is for secondary translations to get discarded before optimization
[22:58:18] <eddyb> brson: I'm not sure I understand. "secondary" as in "in a downstream crate"?
[22:58:36] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[22:59:04] *** Quits: geri (Mibbit@moz-fdkcva.highway.telekom.at) (Quit: http://www.mibbit.com ajax IRC Client)
[22:59:16] <brson> eddyb: yes in downstream crates
[22:59:40] <eddyb> I'd expect available_externally to cause codegen to use an upstream symbol and not emit any assembly/machine code for that function
[23:00:06] <brson> eddyb: yes, that's what i want!
[23:00:12] <eddyb> but that's *after* optimizations
[23:00:21] <brson> well that's not what i want :)
[23:00:33] <brson> why would that be after?
[23:00:34] <eddyb> you can't discard anything *before* optimizations because all monomorphizations are referenced
[23:00:50] <eddyb> they exist because they were called from somewhere
[23:01:14] <brson> eddyb: sure, but we only *need* them for inlining, the non-inlined versions don't need to be used
[23:01:26] <eddyb> and inlining is an optimization
[23:02:24] <brson> this doesn't seem to be contradictory to me. it seems entirely reasonable to not optimize available_externally functions expecting to throw them away
[23:02:28] <eddyb> the body of monomorphized functions is useful for optimizations, so it has to be around. those functions are also always referenced, so they can't be pruned
[23:02:30] <eddyb> brson: oh!
[23:02:50] <eddyb> brson: there's an issue with that, though
[23:03:01] <eddyb> brson: inlining can happen after optimizing the function to be inlined
[23:03:20] <eddyb> (which can make the function small enough to be viable for inlining)
[23:03:33] <brson> yeah
[23:03:41] <brson> it may be that llvm does not just do what i am expecting
[23:04:04] <eddyb> I don't think it can predict whether it will be able to optimize a function significantly
[23:04:17] <eddyb> brson: however... you may want to not trans the function *at all*
[23:04:18] <brson> eddyb: i also only expect this optimizition to be effective for debug mode, where i don't care much about inlining incorrectly
[23:04:41] <eddyb> brson: but instead pull from the crate where it's available from
[23:04:56] <brson> possibly yeah. i don't have any sense of whether that is faster
[23:05:01] <eddyb> that way it's already optimized
[23:05:09] <brson> interesting
[23:05:15] <eddyb> brson: you can avoid both trans and optimizations on that function if you do it that way
[23:05:20] <eddyb> so... it should always be faster
[23:06:05] <eddyb> it's just a pain to load, probably, but I don't know much about that. doener might be able to help
[23:08:48] <eddyb> brson: this is effectively a selective form of LTO. I expect it to be pretty good if it's possible at all
[23:10:00] <eddyb> brson: is there an issue describing all of this? I would cc @dotdash on it (or even the entire compiler team) and see if anyone knows anything more specific than just "it may work"
[23:10:02] <cmr> https://github.com/rust-lang/rust/issues/14527 has some thoughts on this.
[23:10:05] <brson> i should talk to somebody familiar with what clang does to optimize around odr
[23:10:08] <eddyb> oh, cool!
[23:10:14] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Client exited)
[23:10:40] <eddyb> "it can start by fetching the LLVM bytecode for the required inline functions"
[23:10:43] <cmr> apparently strcat had a patch before he ragequit
[23:11:09] *** Joins: jgallagher (john@moz-6ge.dhn.131.24.IP)
[23:11:33] <brson> eddyb: i've talked to sunfish about it and he gave a thumbs up
[23:11:55] <eddyb> so that issue pretty much what we are saying here. but the mechanism is not described in detail
[23:11:57] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:11:59] <brson> not storing bytecode but just taking advantage of odr linkage
[23:12:17] <eddyb> "It would also be possible to leverage this for instantiations of generic functions, by making the instantiations already done by the library available externally as LLVM bytecode blobs in the metadata."
[23:12:30] <eddyb> I believe we already store all the LLVM bytecode we need, for LTO
[23:13:03] <eddyb> brson: if odr doesn't do anything magical with bytecode, it's going to be suboptimal
[23:15:40] <eddyb> eugh, rustdoc's Type enum has a nasty ResolvedPath
[23:16:52] <eddyb> and traits work differently in ast types and middle::ty types
[23:17:30] *** Quits: clatour (clatour@moz-slkfub.hlrn.qwest.net) (Quit: Textual IRC Client: www.textualapp.com)
[23:18:18] *** Joins: clatour (clatour@moz-slkfub.hlrn.qwest.net)
[23:19:38] *** Joins: aatch (james@moz-5r41gb.6pd7.20lj.e000.2406.IP)
[23:20:34] *** Quits: xilec (Mibbit@moz-g6k.oht.161.46.IP) (Ping timeout: 121 seconds)
[23:22:24] <brson> here's my ghc bug https://ghc.haskell.org/trac/ghc/ticket/10473#ticket
[23:22:24] *** Joins: andars (andars@moz-bsldst.sntcca.sbcglobal.net)
[23:24:09] <eddyb> oh, that's what the haskell thing was about
[23:26:05] <brson> eddyb: the odr approach should also result in less code bloat since there will only ever be one instance per fn+substs. not sure if that can also be done with the approach of copying bytecode
[23:26:40] <eddyb> you might be able to combine them
[23:26:54] <brson> possibly. maybe import the bytecode then change the linkage
[23:27:00] <eddyb> copying bytecode lets you get away without trans+per-function optimizations
[23:28:00] <eddyb> not sure if you can mark a function as "maybe inline but don't optimize by itself" (is that anything like what "odr" does?)
[23:28:03] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[23:28:30] <brson> eddyb: no but it's close to available_externally
[23:28:39] *** Quits: edward-san (Edward`san@moz-6u9adl.retail.telecomitalia.it) (Quit: Watt is love? Baby, don't Hertz me. Don't Hertz me, no morse.)
[23:29:08] <brson> if there's no switch in llvm to make it do that hopefully we can add one
[23:30:52] <brson> well i finally got a build working with weak_odr and the build did replace some non-inline generics with calls to the upstream crates
[23:31:32] <eddyb> that's cool
[23:31:42] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[23:34:30] <brson> i wonder how much we can count on non-collision of 64-bit crypto hashes. this patch adds a lot more reliance on them
[23:34:53] <brson> i guess the biggest risk is probably just incorrect implementations of 'fn hash'
[23:35:02] <cmr> what's for sure is that when there is a collision it's going to be really obscure to track down I bet.
[23:35:30] <brson> oh yeah
[23:36:41] <eddyb> cmr: I've suggested building collision detection into such systems and maybe "dialing home" :P
[23:37:09] <eddyb> but nobody took me seriously
[23:37:39] <eddyb> at least giving a nice dumb of the colliding data, to be submitted to the appropriate authorities, that would be nice
[23:38:05] <eddyb> (IIRC Servo had a similar theoretical discussion at some point)
[23:38:10] <eddyb> s/dumb/dump
[23:53:00] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:53:21] *** Joins: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net)
[23:57:17] *** Quits: bkearns (Adium@moz-rudtng.static.wiline.com) (Quit: Leaving.)
[23:58:33] *** Quits: eddyb (eddyb@moz-e8s.ur8.27.188.IP) (Ping timeout: 121 seconds)
[23:58:41] *** Joins: mssbrg (mark@moz-0aum2d.compute.amazonaws.com)
