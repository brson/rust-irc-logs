[00:17:09] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[00:26:46] *** Quits: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net) (Ping timeout: 121 seconds)
[00:27:22] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[00:38:39] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[00:43:54] *** Quits: brson (brson@moz-0i1.c9m.56.172.IP) (Quit: leaving)
[00:49:11] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[00:57:35] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[01:09:12] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[01:37:27] *** Quits: Riastradh (riastradh@moz-6odf4a.exit.babylon.network) (Ping timeout: 121 seconds)
[02:12:23] *** Joins: jtdowney (jtdowney@moz-obnifk.il.comcast.net)
[02:29:10] *** Quits: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net) (Ping timeout: 121 seconds)
[03:22:00] *** Joins: Riastradh (riastradh@moz-ke9rv2.nos-oignons.net)
[03:51:42] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[04:34:07] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[04:48:45] *** Quits: Riastradh (riastradh@moz-ke9rv2.nos-oignons.net) (Ping timeout: 121 seconds)
[04:50:09] <Ilari> Also, when things get complicated, memory safety won't help that much. I think Servo devs estimated that Browser bugs are 50/50 memory unsafety vs. weird machines.
[04:55:01] <bascule> Ilari: the hard part is everything needs to be secure :|
[05:05:20] <Ilari> Then there are problems such as cookies behaving differently from anything else.
[05:05:38] <bascule> lol
[05:05:45] <Ilari> And Javascript too (turing-complete with who-knows-what APIs).
[05:05:49] <bascule> it would be nice if there were a header like HSTS
[05:05:59] <bascule> that let you specify you want cookies on your domain to honor the same origin policy
[05:39:33] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[06:41:41] *** Quits: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net) (Ping timeout: 121 seconds)
[06:47:21] *** Joins: Tuba (Tobba@moz-6oh.7ki.21.217.IP)
[06:47:25] <Ilari> RequireCT would be especially useful with reporting that dumped the offending certificate chains.
[06:58:23] <bascule> Ilari: I'm just thinking it'd be nice to say that cookies set on this domain are complete origin-locked, cannot be shared over http:// if set on https (the SecureOnly problem), can't be set on a domain, or inherited from a domain, or session fixated through such a vector
[06:58:35] <bascule> they must be set on that origin and are only honored if set on that origin
[06:58:57] <bascule> basically make shit like SecureOnly SOP and get wid of wacky shit like domain cookies
[06:59:28] <bascule> it would require different behavior for the Cookie: header
[06:59:46] <bascule> it would have to actually inform the web server that the client has been instructed to follow the same origin policy and is attempting to honor it
[07:00:12] <bascule> perhaps a different HTTP header
[07:00:17] <bascule> Same-Origin-Cookie:
[07:04:23] *** Quits: Tuba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[07:08:25] <eternaleye> Pinned-Origin-Cookie
[07:08:59] <eternaleye> (Have to keep in mind how it acronymizes :D)
[07:11:26] <bascule> sure, whatever, I have no bikeshed in that horse race
[07:11:33] <bascule> but like
[07:11:45] <bascule> wouldn't it be nice?
[07:12:03] <bascule> a new, opt-in cookie protocol that actually respects the same origin policy
[07:12:36] <bascule> and legacy clients would just degrade to Cookie:
[07:15:11] *** Quits: jtdowney (jtdowney@moz-obnifk.il.comcast.net) (Ping timeout: 121 seconds)
[07:16:17] *** Joins: jtdowney (jtdowney@moz-obnifk.il.comcast.net)
[07:19:21] *** Joins: jtdowney_ (jtdowney@moz-obnifk.il.comcast.net)
[07:20:08] <Ilari> bascule: I think there was some I-D on that...
[07:21:07] <eternaleye> bascule: OTOH, if you've got same-origin, could that be done using macaroons carrying a third-party-caveat-to-issuer?
[07:21:13] *** Quits: jtdowney (jtdowney@moz-obnifk.il.comcast.net) (Ping timeout: 121 seconds)
[07:21:45] <eternaleye> bascule: That'd conceal the value from anyone but same-origin, and you could toss whatever caveats you want on it to boot.
[07:22:28] <eternaleye> bascule: No need for browser or webserver changes, just middleware/app - and O_PONIES for everyone
[07:24:16] <eternaleye> bascule: Also, it'd back the same-origin policy with crypto, rather than relying on the browser to never leak it...
[07:24:27] <Ilari> bascule: Looks like present cookie mechanism can add new directives, but can't echo those back without defining a new header to carry the cookie back.
[07:24:46] <bascule> eternaleye: well yes I would like some sort of contextual caveats or tokbind/unbearable/channel ID whatever
[07:24:49] <bascule> Ilari: yup :(
[07:25:01] <eternaleye> bascule: No, I mean, even without that
[07:25:04] <bascule> https://www.reddit.com/r/crypto/comments/346mx3/how_eff_got_an_a_on_ssl_labs/cqseu3f
[07:25:09] <eternaleye> bascule: Just pure macaroons
[07:25:22] <bascule> eternaleye: you're talking about like... keeping them in the DOM?
[07:25:30] <bascule> you can try to do the DOM/LocalStorage thing
[07:25:38] <bascule> then you lose "HttpOnly" properties
[07:25:39] <eternaleye> bascule: The same way you seal the nonce on a third-party caveat can be used to seal secret cookie data in the macaroon
[07:25:43] <bascule> it's nice keeping them out-of-band
[07:25:47] <eternaleye> bascule: Then you just... use the macaroon as a cookie.
[07:25:49] <Ilari> bascule: Well, I presume such mechanism could be defined (with some directives triggering the use of the new mechanism).
[07:25:58] <eternaleye> bascule: Only the holder of the root MAC key can then read the value.
[07:26:00] <bascule> eternaleye: the main things I'm doing use Macaroons as cookies
[07:26:19] <eternaleye> bascule: And the holder of the root MAC key is definitionally same-origin
[07:26:27] <bascule> like, basically I have a KDC
[07:26:29] <eternaleye> bascule: Unless someone really fucked up their key distribution
[07:26:42] <bascule> where you can trade your TGT-Macaroon for an app-specific discharge
[07:26:52] <bascule> that needs to be periodically refreshed
[07:27:05] <bascule> and we have a proxy that sits in the middle and does that refreshing for you
[07:27:18] <bascule> and sets the discharges as cookies
[07:27:19] <eternaleye> bascule: Sure, but what I mean is that you can implement "same-origin cookies" with exactly two parties, vanilla HTTP cookies, and vanilla macaroons.
[07:27:35] <eternaleye> bascule: And only the website has to do anything special or new.
[07:27:37] <bascule> how do you lock cookies to an origin?
[07:27:41] <bascule> Macaroons are just a format
[07:27:46] <eternaleye> bascule: The macaroon verification key
[07:27:56] <bascule> what about session fixation attacks?
[07:28:00] <eternaleye> bascule: The same way that the nonce in a third-party caveat is sealed under it
[07:28:15] <bascule> like, what about the traditional security problems of cookies
[07:28:20] <bascule> those are what it'd be nice to make go away
[07:28:32] <eternaleye> bascule: Yes, and same-origin cookies don't solve those
[07:28:33] <bascule> you basically have to make sure you have all the band-aids on today
[07:28:38] <bascule> they totally do
[07:28:42] <bascule> because you can lock to https
[07:28:48] <bascule> that's the big problem with cookies
[07:28:56] <bascule> you can have a cookie set over http
[07:28:59] <bascule> that gets sent back over https
[07:29:00] <eternaleye> ...so use a different macaroon verification key on HTTP vs HTTPS.
[07:29:04] <eternaleye> Bam.
[07:29:07] <bascule> except
[07:29:13] <bascule> an attacker can take a cookie set via https
[07:29:18] <bascule> and do a session fixation attack over http
[07:29:28] <bascule> that cookie gets sent from the client over https
[07:29:32] <bascule> and you can't tell the difference
[07:29:42] <bascule> because the client doesn't inform you of how the cookie was set originally
[07:29:57] *** Quits: atomic (atomic@moz-ch53jc.jager.io) (Ping timeout: 121 seconds)
[07:30:12] <Ilari> Basically, if attacker can do maliscous operations as an origin, you are pretty much fucked.
[07:30:13] <eternaleye> Uh, what? The server knows how it set the cookie, and can jam that in the macaroon as a caveat.
[07:30:16] <bascule> like, imagine an attacker does a session fixation attack and has you link an account with some other authority
[07:30:29] <bascule> you set up oauth or what have you to some other service
[07:30:38] <bascule> but you've just linked the attacker's account to that service, not yours
[07:30:54] <bascule> now the attacker has hijacked what you've just ouathed to
[07:31:43] <bascule> eternaleye: the problem is if an attacker can make an account with the same service, and there is anywhere on the entire domain that there's a single non-https service, an attacker who can MitM you can perform a session fixation attack
[07:32:00] <eternaleye> Mm
[07:32:51] <bascule> using a separate HTTP header to signal that you've set a same-origin cookie lets the server know the cookie was set securely
[07:33:52] <eternaleye> But if you use a different MAC key for secure/insecure, then HTTP-set will fail to verify on HTTPS, *and* vice versa
[07:34:48] <bascule> you can't tell though
[07:34:50] <bascule> the flow is
[07:34:56] <bascule> attacker gets cookie set over HTTPS
[07:35:03] <bascule> attacker replays cookie to victim over HTTP
[07:35:16] <bascule> victim client sends cookie to victim service over HTTPS
[07:35:51] <bascule> tokbind/unbearable could help solve this too, and provide even better guarantees
[07:35:55] <eternaleye> Mm
[07:36:37] <bascule> the tl;dr: problem is that clients will send cookies set over HTTP to HTTPS services and provide no clues of what happened
[07:37:02] <bascule> if the client simply echoed that the cookie was set SecureOnly that'd solve the problem too
[07:37:05] <bascule> but they don't
[07:38:05] <bascule> the thing about an Origin-Bound-Cookie or what have you is it would also let the server know that the cookie was not set by some service elsewhere on the same domain
[07:38:22] <bascule> so say, someone can't own your WordPress and inject cookies
[07:38:25] <Ilari> Except it makes difference for tokbin/unbearable if cookie is using traditional semantics or same-origin semantics.
[07:38:35] <bascule> if you happen to be hosting a WordPress on the same domain as something valuable
[07:38:59] <bascule> Ilari: do you think HSTS-style opt-in for origin-bound cookies is a good idea?
[07:39:39] <bascule> and has someone already done this?
[07:39:49] <Ilari> Traditional semantics require guessing root (whee, PSL) associated with domain and giving one key per root. Same-origin semantics would assign key per origin.
[07:41:51] <Ilari> Actually, draft-west-origin-cookies ...
[07:43:18] <Ilari> But for those cookies, one would need a per-origin key to protect those properly.
[07:44:41] <bascule> Ilari: the nice things that same-origin cookies would rule out are "domain" cookies and cookies set over http replayed over https
[07:44:53] <bascule> get rid of all that legacy complexity
[07:45:05] <bascule> kind of like shutting "features" of RFC 6125 off, heh
[07:52:08] <Ilari> If one had transport capable of server 0RTT and HTTP/2, one could do tokbind completely at HTTP level (with existing libraries).
[07:58:25] <Ilari> Since one could send the config data in server SETTINGS block, which is sent in the first flight if server 0RTT is available.
[08:32:23] *** Joins: Tuba (Tobba@moz-6oh.7ki.21.217.IP)
[09:00:05] *** Joins: Tobba_ (Tobba@moz-6oh.7ki.21.217.IP)
[09:02:00] *** Quits: Tuba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[09:57:32] *** Quits: Tobba_ (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[10:22:46] *** Joins: Tobba_ (Tobba@moz-6oh.7ki.21.217.IP)
[11:08:18] *** Joins: Riastradh (riastradh@moz-qpd.aq7.187.37.IP)
[12:11:15] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[12:17:10] *** Quits: Tobba_ (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[12:44:32] *** Quits: jtdowney_ (jtdowney@moz-obnifk.il.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[13:46:01] *** Joins: jtdowney (jtdowney@moz-gh1isj.static.twtelecom.net)
[14:56:27] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[15:42:48] *** Joins: atomic (atomic@moz-kvs6fc.torservers.net)
[16:00:43] *** Quits: jtdowney (jtdowney@moz-gh1isj.static.twtelecom.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:03:19] *** Joins: jtdowney (jtdowney@moz-gh1isj.static.twtelecom.net)
[16:09:40] <bascule> Ilari: oh no, I thought Dan Brown's random curve thread was dead, but some people corpse revived it
[16:12:12] *** Quits: jtdowney (jtdowney@moz-gh1isj.static.twtelecom.net) (Quit: Textual IRC Client: www.textualapp.com)
[16:16:32] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[16:28:06] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Connection closed)
[16:31:55] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[16:42:45] *** Quits: blank_name (blank_name@moz-sct.ivp.36.50.IP) (Ping timeout: 121 seconds)
[16:44:42] *** Joins: blank_name (blank_name@moz-kau.24b.36.50.IP)
[17:00:32] *** Quits: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net) (Ping timeout: 121 seconds)
[17:03:58] <Ilari> bascule: Are there known cases where small parameters are less secure than random parameters in ECC, over any field (including really broken extension fields)?
[17:07:30] <bascule> I have no idea
[17:09:03] <Ilari> (I am certainly not aware of any...)
[17:31:51] <Ilari> Is curve genration cheap? Heck no.
[17:56:01] *** Quits: Riastradh (riastradh@moz-qpd.aq7.187.37.IP) (Ping timeout: 121 seconds)
[18:01:18] <Ilari> Whee, fun: Discussing if to use arrays or maps, with example where 8 bytes in object size is make-or-break difference...
[18:25:54] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[18:38:54] *** Quits: jvrbanac (jvrbanac@moz-932o89.kdmi.s520.4801.2001.IP) (Ping timeout: 121 seconds)
[18:41:21] *** Joins: jvrbanac (jvrbanac@moz-932o89.kdmi.s520.4801.2001.IP)
[18:41:42] *** Joins: Riastradh (riastradh@moz-lh4dsc.xzyqvk.co.uk)
[18:54:48] *** Joins: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net)
[20:48:52] <Ilari> Whee, telnet.
[20:50:40] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[21:50:06] *** Joins: blank_na1e (blank_name@moz-igojne.mi.frontiernet.net)
[21:51:32] *** Quits: blank_name (blank_name@moz-kau.24b.36.50.IP) (Ping timeout: 121 seconds)
[22:47:23] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[23:10:33] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[23:16:28] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[23:26:48] *** Quits: gsingh93 (gulshan@moz-qnbukr.mi.comcast.net) (Ping timeout: 121 seconds)
