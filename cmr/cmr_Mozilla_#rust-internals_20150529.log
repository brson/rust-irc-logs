[00:00:38] *** Joins: garming (garming@moz-hrh.s0u.195.130.IP)
[00:01:36] *** Quits: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP) (Connection closed)
[00:02:13] *** Quits: lorenzb (textual@moz-5ev.5pk.144.213.IP) (Quit: Bye bye)
[00:02:20] *** Joins: lorenzb (lorenzb@moz-5ev.5pk.144.213.IP)
[00:03:01] *** Joins: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP)
[00:03:29] *** Quits: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP) (Connection closed)
[00:05:40] *** Quits: swgillespie (swgillespie@moz-1i5.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[00:08:32] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[00:09:24] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[00:12:29] *** Joins: andreabedini (andreabedin@moz-2lt49q.unimelb.edu.au)
[00:16:46] *** Joins: ytain (ytain@moz-ffpck2.dsl.teksavvy.com)
[00:18:55] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[00:19:02] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[00:19:17] *** Quits: davebettin (davebettin@moz-hde.5e5.136.67.IP) (Ping timeout: 121 seconds)
[00:20:38] *** Quits: rillian (giles@moz-84unpo.osuosl.org) (Ping timeout: 121 seconds)
[00:23:16] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[00:23:34] *** Quits: lorenzb (lorenzb@moz-5ev.5pk.144.213.IP) (Quit: Bye bye)
[00:26:47] *** Quits: Simplebrain (Simplebrain@moz-6h4u6b.skybroadband.com) (Connection closed)
[00:27:31] *** Joins: Simplebrain (Simplebrain@moz-6h4u6b.skybroadband.com)
[00:31:12] *** Quits: ytain (ytain@moz-ffpck2.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[00:31:43] *** Joins: p1start (p1start@moz-nftjhe.org)
[00:39:47] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:40:34] *** Joins: JuggleTux (tux@moz-ho0t1f.adslplus.ch)
[00:42:26] *** Quits: mib_oz31cx (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:45:15] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:45:41] <mcpherrin> Is there a tool, maybe for debugging or something, that dumps the metadata section of an object?
[00:46:02] <cmr> mcpherrin: do you want to see it decoded?
[00:46:31] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[00:46:40] <mcpherrin> cmr: yeah
[00:46:55] <cmr> I'm not sure we have anything like that anymore.
[00:47:32] <mcpherrin> I guess I'll just write one then
[00:47:33] *** Joins: p1start (p1start@moz-nftjhe.org)
[00:47:34] <mcpherrin> :)
[00:47:53] *** Joins: mib_q1wufq (Mibbit@moz-juv.9o3.252.72.IP)
[00:48:51] *** Quits: mib_q1wufq (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:51:28] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[00:53:44] *** Joins: blank_na1e (blank_name@moz-pah0nm.mi.frontiernet.net)
[00:54:59] *** Joins: maralla (uid69246@moz-mq40mv.brockwell.irccloud.com)
[00:56:26] *** Quits: blank_name (blank_name@moz-f80.i34.36.50.IP) (Ping timeout: 121 seconds)
[00:58:21] *** Joins: rillian (giles@moz-84unpo.osuosl.org)
[00:59:07] *** Quits: garming (garming@moz-hrh.s0u.195.130.IP) (Ping timeout: 121 seconds)
[01:01:35] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[01:02:08] *** kimundi is now known as zz_kimundi
[01:02:49] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:05:44] <mcpherrin> Can I depend on librustc on crates.io?
[01:06:41] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:06:44] <mcpherrin> not the best place to ask that
[01:07:14] *** Quits: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[01:11:15] *** Joins: tamird (textual@moz-gg3hct.res.rr.com)
[01:11:26] *** Joins: jgallagher (john@moz-6ge.dhn.131.24.IP)
[01:14:52] *** Joins: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com)
[01:14:52] *** ChanServ sets mode: +o acrichto
[01:17:13] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[01:17:36] *** Quits: kwantam (kwantam@moz-1adqok.DYNAPOOL.NYU.EDU) (Quit: WeeChat 1.1.1)
[01:17:50] *** Joins: jbomo (dkd@moz-uol4mm.fios.verizon.net)
[01:22:16] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:23:17] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[01:28:51] *** chmanchester is now known as chmanchester|afk
[01:37:58] *** Quits: Jesin (Jesin@moz-u7t8t5.mobility.exede.net) (Ping timeout: 121 seconds)
[01:40:41] *** Joins: Jesin (Jesin@moz-u7t8t5.mobility.exede.net)
[01:54:55] *** Joins: Kroisse (Kroisse@moz-t75tk5.krois.se)
[01:56:05] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[01:56:21] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[02:00:22] *** Joins: rovar_ (rovar@moz-96effg.dyn.optonline.net)
[02:00:35] *** rovar is now known as Guest60769
[02:00:35] *** rovar_ is now known as rovar
[02:05:06] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[02:05:19] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[02:07:58] *** Joins: c74d3 (c74d3a4ebb6@moz-rhs0n6.mggc.hibn.4404.2002.IP)
[02:09:26] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Ping timeout: 121 seconds)
[02:09:45] *** c74d3 is now known as c74d
[02:14:49] *** Joins: Tuba (Tobba@moz-o13d22.bredband.telia.com)
[02:17:09] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[02:17:23] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[02:20:03] *** Tuba is now known as Tobba
[02:21:53] <koobs> morning all
[02:25:02] <koobs> Shared object "libc++.so.1" not found, required by "rustc"
[02:25:04] <koobs> *ponders*
[02:29:07] <eternaleye> koobs: What OS is this?
[02:29:14] <koobs> eternaleye: FreeBSD
[02:29:21] <koobs> im just trying to work out the dependency
[02:29:48] <koobs> Given what i think i know right now. That is: rust -> llvm (build) -> c++11 library/compiler
[02:30:42] <eternaleye> koobs: yeah, though I thought freebsd had moved to libc++/libcxxrt/etc, so it should work IIRC
[02:34:49] <koobs> well we have clang post 10
[02:34:56] <koobs> thats not what im trying to understand
[02:35:15] <koobs> i was under the inpression rust was C, and only llvm needed the c++11 lib/compiler
[02:35:35] <koobs> eternaleye: i can declare the right dependencies if i know what they are so that theyre installed at build/run time
[02:36:29] *** Joins: kwantam (kwantam@moz-1adqok.DYNAPOOL.NYU.EDU)
[02:36:38] <koobs> eternaleye: right now the rust port works on 10+ (with --enable-clang) *without* system llvm (that is, using the bundled one)
[02:37:11] <koobs> eternaleye: my goal is to use system llvm on all versions, and ive done that, but obvious the deps arent declared completely correctly/accurately
[02:40:12] <eternaleye> koobs: Rust is not C
[02:40:28] <eternaleye> koobs: Nor is rustc
[02:40:35] <eternaleye> koobs: It's a self-hosting compiler
[02:41:06] <eternaleye> koobs: But it doesn't need C++ itself, no.
[02:41:19] <koobs> eternaleye: so rust depends on llvm and a c++ library ?
[02:41:26] <koobs> its that last bit im trying to grok
[02:41:29] <eternaleye> koobs: rust != rustc
[02:41:40] <koobs> ok now where getting somewhere
[02:41:44] <eternaleye> koobs: Rust is the language; rustc is the current compiler
[02:41:45] <koobs> rustc is the compiler, no ?
[02:41:47] <koobs> right
[02:41:48] <eternaleye> koobs: Yes
[02:41:52] <huon> llvm is in C++ and so requires the C++ standard library
[02:42:01] <eternaleye> koobs: rustc uses LLVM for optimization and codegen
[02:42:56] <eternaleye> koobs: The rust *bindings* for LLVM might require stubs which are compiled with a C++ compiler though
[02:43:04] <koobs> :|
[02:43:05] <eternaleye> koobs: Since I don't think rustc uses the LLVM C-api
[02:43:15] <eternaleye> koobs: And binding directly to C++ is not really a thing
[02:43:37] <eternaleye> koobs: (because templates)
[02:43:53] <koobs> still confused.
[02:44:22] <koobs> what you've both said makes sense. but i dont have the answer to, how/why does rust want/need libc++
[02:44:29] <koobs> unless ive missed something
[02:45:16] <huon> rust doesn't need it
[02:45:22] <huon> rust*c* does need it, because it uses LLVM
[02:45:38] <aatch> koobs, rustc itself doesn't, but LLVM does. If you're using the system LLVM libc++ shouldn't be a direct dependency for rustc.
[02:45:51] <koobs> aatch: thats slightly clearer
[02:46:21] <koobs> aatch: i declare rust (c) needs llvm at build/run time, right?
[02:46:38] <koobs> if and when llvm and all the things it needs are there, rust has what it needs
[02:46:40] <aatch> koobs, you need LLVM in order to build rustc, yes.
[02:47:10] <koobs> aatch: ive already done, rust depends =
[02:47:11] <koobs> BUILD_DEPENDS=  llvm36>=3.6.0:${PORTSDIR}/devel/llvm36
[02:47:13] <koobs> LIB_DEPENDS=    libLLVM-3.6.so:${PORTSDIR}/devel/llvm36
[02:47:15] <koobs> so far
[02:47:20] <eternaleye> koobs: Basically, rustc is written in Rust. Rust code can bind to C code, but I doubt rustc is using only the LLVM C-api. LLVM itself is in C++; thus I suspect that there exists some code that takes LLVM's C++ API, exports parts of it in extern C, and then is bound to by rustc. *that* code would require a C++ compiler.
[02:48:03] <koobs> rustc either requires itself libc++, or it doesnt, the 'because llvm does' part is orthogonal
[02:48:12] <koobs> eternaleye: again i grok what youre saying
[02:49:11] <aatch> eternaleye, we have a few extra wrappers for stuff that isn't exposed (or isn't exposed very well) by the C-api.
[02:49:15] <eternaleye> koobs: The bindings stubs are probably a .o that gets statically linked into rustc
[02:49:30] <eternaleye> koobs: Thus, rustc winds up needing libc++ *directly*
[02:49:33] <eternaleye> koobs: At runtime
[02:49:40] <eternaleye> koobs: Not just transitively via LLVM
[02:49:41] <koobs> eternaleye: super clear, if tru :)
[02:49:44] <koobs> awesome
[02:50:07] <koobs> eternaleye: so i can say rust (the port, which includes rustc) needs c++11 library
[02:50:22] <koobs> then i can deal with whether thats gcc/clang, whatever via the ports framework
[02:50:28] <koobs> *goes to have a play and test*
[02:51:02] <koobs> im going to have a field day with your building from source docs when im done :)
[02:51:11] <koobs> eternaleye aatch danke for the clarity
[02:51:32] <aatch> We have building-from-source docs?! :P
[02:51:42] <koobs> aatch: they dont really qualify :) but yes
[02:51:46] <koobs> theres a url with content on it
[02:51:50] <koobs> https://github.com/rust-lang/rust/#building-from-source
[02:52:04] <koobs> I will PR that doc when im done
[02:52:46] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:53:33] *** Quits: zz_kimundi (kimundi@moz-ch362e.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:53:33] <koobs> cool, llvm36 on 9.x needs gcc/binutils
[02:53:35] <koobs> :D
[02:54:11] <koobs> eternaleye aatch do you know how to switch rust(c) from wanting/taking a static llvm library and making it shared?
[02:54:24] <eternaleye> koobs: Not a clue
[02:54:54] <koobs> eternaleye: ive declared a dep on .so, but is the following correct: that llvm is *not* a run time dependency, given rustc links it statically
[02:55:23] <koobs> that is: llvm build dependency, c++ library build/run time
[02:55:33] <eternaleye> koobs: Might be able to do something via -C link-args=
[02:56:06] *** Joins: zz_kimundi (kimundi@moz-68riih.dip0.t-ipconnect.de)
[02:56:08] *** zz_kimundi is now known as kimundi
[02:56:45] <eternaleye> koobs: like -C link-args=-Bdynamic
[02:57:04] <koobs> where can i find what it currently defaults to ?
[02:57:14] <koobs> is it a platform.mk thing, or makefile/configure ?
[02:58:17] <cmr> koobs: it is not possible to dynamically link rustc to llvm right now.
[02:58:47] <koobs> cool
[02:58:57] <cmr> Although it might do it automatically if you use --llvm-root, not sure
[02:59:01] <eternaleye> cmr: Not possible, not possible without buildsystem patches, or not supported?
[02:59:14] <koobs> cmr: im already using --llvm-root
[02:59:19] <koobs> looks like its stat linked still
[02:59:21] <koobs> will confirm
[02:59:22] <eternaleye> cmr: As the last two likely are not an issue here
[02:59:26] <cmr> eternaleye: w/o buildsystem patches
[02:59:29] <cmr> probably, yeah.
[03:01:04] *** Joins: davebettin (davebettin@moz-ip635p.or.comcast.net)
[03:02:16] <eternaleye> cmr: I wonder how hard it'd be to build the LLVM-cstubs as a shared library...
[03:04:21] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[03:06:43] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Connection closed)
[03:07:02] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[03:07:23] <koobs> https://github.com/rust-lang/rust/issues/24345
[03:07:25] <koobs> hmm.
[03:12:06] <koobs> so confused.
[03:13:27] <koobs>  don't build with llvm with libc++ instead of libstdc++ when using clang
[03:13:38] <koobs> is that supposed to be "dont build llvm with libc++" ?
[03:13:45] <koobs> that is, the "bundled" llvm ?
[03:14:00] <koobs> really need to group the bundled llvm build options together, seperate from the non llvm build options
[03:15:11] <cmr> koobs: I think so yes.
[03:16:23] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[03:17:52] <koobs> https://github.com/rust-lang/rust/issues/14023
[03:17:54] <koobs> hmm 
[03:17:56] <koobs> cmr: thanks
[03:17:58] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[03:18:29] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[03:21:12] *** Quits: Jesin (Jesin@moz-u7t8t5.mobility.exede.net) (Quit: preparing to land)
[03:22:32] <koobs> *tests*
[03:28:22] <koobs> hmm nope, still wants libc++
[03:28:29] <koobs> *ponders*
[03:32:22] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[03:33:09] <geofft> are there docs on how to set up Rust for cross-building to Android somewhere? 
[03:35:16] <cmr> geofft: https://github.com/tomaka/android-rs-glue#installation
[03:35:34] *** Joins: semarie (semarie@moz-vjb.r8r.42.192.IP)
[03:36:07] <geofft> ... wait, is this what I want? I want to build rustc itself for the Android target 
[03:36:13] <geofft> (since my PR is failing to compile) 
[03:36:28] <cmr> sorry, wrong hyperlink: https://github.com/tomaka/android-rs-glue#setting-up-your-environment
[03:36:46] <geofft> oh, just saw that, gotcha 
[03:37:19] <geofft> eugh I'm increasingly convinced that Docker is a good idea, the more I read this :P 
[03:37:52] <eternaleye> koobs: What are you passing to rust's configure? Are you passing --disable-libcpp?
[03:38:48] <eternaleye> geofft: Maybe look at vagga?
[03:38:53] <eternaleye> geofft: It is written in Rust
[03:39:02] <geofft> oh shiny 
[03:39:07] <koobs> eternaleye: i just tried that, yeh
[03:39:27] <geofft> I mean it doesn't solve the problem of "I want someone else to make a container for me", but still, neato 
[03:39:53] <eternaleye> geofft: Also, https://lwn.net/Articles/646330/
[03:40:28] <geofft> yeah lol. I mean I literally don't care about the security of the image, I just want to get my PR to compile and then I'll discard it 
[03:40:34] <eternaleye> Heh
[03:40:34] <geofft> which seems like actually a good use case for Docker 
[03:41:19] <mcpherrin> If I want to use a modified librustc, but don't need to bootstrap the whole compiler, is there a make target for that?
[03:42:17] <huon> mcpherrin: i'm not sure that's a well-defined question :)
[03:42:35] <mcpherrin> huon: I want to use librustc in an application that is not a compiler
[03:42:43] <huon> oh, unless you mean that you don't need a `rustc` binary that has the changes
[03:42:44] <huon> yeah
[03:42:48] <huon> I don't think so
[03:43:05] <mcpherrin> alright, I shall solve this problem with CPU power
[03:43:10] <mcpherrin> (and just do the whole thing)
[03:43:27] <mcpherrin> alternatively, can I override privacy?
[03:43:35] <mcpherrin> I just want to make some stuff `pub`
[03:43:45] <huon> don't think so
[03:44:50] <mcpherrin> ok
[03:47:44] *** Quits: annodomini (lambda@moz-hceqmj.hfc.comcastbusiness.net) (Client exited)
[03:50:17] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[03:53:37] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[03:53:56] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[03:54:27] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[03:54:56] <koobs> eternaleye: im stumped
[04:13:30] *** Joins: Quxxy (chatzilla@moz-efh10q.internode.on.net)
[04:13:36] *** Quits: semarie (semarie@moz-vjb.r8r.42.192.IP) (Ping timeout: 121 seconds)
[04:13:39] *** Joins: bletch (Mibbit@moz-juv.9o3.252.72.IP)
[04:14:45] *** Quits: JuggleTux (tux@moz-ho0t1f.adslplus.ch) (Ping timeout: 121 seconds)
[04:16:14] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[04:16:29] *** Quits: bletch (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:18:39] *** Joins: semarie (semarie@moz-j5rng1.tor-exit.network)
[04:20:34] <koobs> eternaleye: i have a feeling this might be related to: https://github.com/rust-lang/rust/issues/11671
[04:20:40] *** Quits: jga (jga@moz-e4s.t1q.244.77.IP) (Connection closed)
[04:24:42] *** Quits: shep-home (shep@moz-7pm0e0.fios.verizon.net) (Ping timeout: 121 seconds)
[04:26:19] <eddyb> mcpherrin: just open a PR
[04:26:27] <eddyb> mcpherrin: if it's reasonable, of course
[04:26:43] *** Joins: shep-home (shep@moz-7pm0e0.fios.verizon.net)
[04:27:06] <eddyb> I made some things in typeck public so I can invoke it from rid3 on one function at a time insstead of the whole crate at once
[04:28:25] <eddyb> mcpherrin: also, why do you think you need to dump anything? the data is not very nice to look at, and kind of useless without the whole infrastructure
[04:28:42] *** Joins: p1start (p1start@moz-nftjhe.org)
[04:34:11] <koobs> eddyb: --disable-libcpp appears orthogonal to llvm-root (external)
[04:34:22] <koobs> not sure that should be the case with external llvm (built with gcc)
[04:34:25] <koobs> libstdc++
[04:34:40] <koobs> s/eddyb/eternaleye 
[04:35:45] <koobs> i see nothing outside of src/llvm (ie; rustc's build) that uses it
[04:36:19] *** Quits: semarie (semarie@moz-j5rng1.tor-exit.network) (Quit: WeeChat 1.1)
[04:40:36] *** Joins: guacamole (Mibbit@moz-juv.9o3.252.72.IP)
[04:44:07] *** Quits: guacamole (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:45:22] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[04:47:14] <mcpherrin> eddyb: So my understanding is that metadata can be used to figure out types for each symbol in an .so
[04:47:41] <mcpherrin> At this point I'm just playing around to understand what's going on
[04:49:22] *** Joins: semarie (semarie@moz-ke9rv2.nos-oignons.net)
[04:50:49] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[04:54:03] *** Quits: maralla (uid69246@moz-mq40mv.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[04:55:02] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[04:55:02] *** Joins: davebettin_ (davebettin@moz-ip635p.or.comcast.net)
[04:58:08] *** Quits: davebettin (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[05:03:51] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[05:13:34] *** Joins: c74d3 (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[05:14:46] *** Quits: c74d (c74d3a4ebb6@moz-rhs0n6.mggc.hibn.4404.2002.IP) (Ping timeout: 121 seconds)
[05:15:22] *** c74d3 is now known as c74d
[05:16:09] *** Quits: O01eg (o01eg@moz-qi2pml.uea1.4n8f.2698.2a02.IP) (Client exited)
[05:17:25] *** Quits: ctennis (ctennis@moz-vcpg3c.in.comcast.net) (Connection closed)
[05:19:33] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Connection closed)
[05:21:12] *** Quits: nham (nham@moz-lglsfe.il.comcast.net) (Ping timeout: 121 seconds)
[05:21:28] <c74d> geofft: also take note of <http://reventlov.com/advisories/using-the-docker-command-to-root-the-host>
[05:22:23] <geofft> to be clear, I made my comment because I usually like hating on docker :) 
[05:22:57] <geofft> but in this context, it would just be to avoid installing a bunch of stuff on my host, not for security isolation, and the only user of this machine is me 
[05:23:14] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[05:23:18] <geofft> and I would explicitly want a setup where someone else has made a container and I don't care about how up-to-date it is 
[05:26:17] <c74d> (For me, the concern wouldn't be other users in the docker group being malicious, but rather any malware running as me using my hypothetical docker group access.)
[05:27:12] <geofft> yeah, but I already su from this account etc. 
[05:28:52] <c74d> with Docker, the malware would have one step fewer (password filching) to root.
[05:29:53] <c74d> (not that I'm trying to push this as a panic-worthy issue)
[05:34:43] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[05:47:26] <sfackler> windows people - any idea why I'd run into this trying to run check-stage1-std? /home/sfackler/rust/x86_64-pc-windows-gnu/stage1/test/stdtest-x86_64-pc-windows-gnu.exe: error while loading shared libraries: test-d8ace771.dll: cannot open shared object file: No such file or directory
[05:49:44] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[05:50:42] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[05:50:51] *** Quits: davebettin_ (davebettin@moz-ip635p.or.comcast.net) (Ping timeout: 121 seconds)
[05:51:47] <acrichto> sfackler: I was getting that recently as well, I just assumed stage1 testing was broken
[05:52:09] <acrichto> sfackler: I don't know what would happen though unless our build system doesn't set up PATH correctly in one way or another
[05:52:33] *** Quits: genbattle (genbattle@moz-4v0.gkd.16.182.IP) (Ping timeout: 121 seconds)
[05:52:39] *** Joins: dcb (textual@moz-j72nfe.ca.comcast.net)
[05:53:45] *** Quits: jbomo (dkd@moz-uol4mm.fios.verizon.net) (Quit: )
[05:54:30] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[05:55:42] <sfackler> i also don't appear to have a stage1/lib directory at all - do stage1 tests use stage0 lib?
[05:56:55] <acrichto> sfackler: it'll probably be in stage1/bin/rustlib
[05:57:01] <acrichto> windows is a little different that way
[05:57:10] <acrichto> stage1 tests should use the stage1 libs though
[05:58:13] <sfackler> ah
[06:00:42] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[06:04:13] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[06:04:31] *** Joins: James (quassel@moz-q6malq.range86-148.btcentralplus.com)
[06:04:32] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[06:04:49] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[06:14:49] <sfackler> acrichto: so on windows, a tcp read with a timeout of 10 milliseconds actually returns after ~510 milliseconds, and a udp read that times out returns  Error { repr: Custom(Custom { kind: InvalidInput, error: StringError("invalid argument") }) }
[06:15:16] <sfackler> which is incredibly confusing since it looks like the only reference to the string "invalid argument" is in sockaddr_to_addr
[06:20:11] *** Quits: det (chris@moz-9klsea.lv.cox.net) (Ping timeout: 121 seconds)
[06:21:34] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[06:22:33] *** Quits: c0170 (c0170@moz-4stj9o.cable.virginm.net) (Ping timeout: 121 seconds)
[06:23:29] <eternaleye> sfackler: Could it be coming from an errno conversion of an EINVAL somewhere?
[06:24:40] <sfackler> eternaleye: shouldn't be - that'd use the other repr
[06:24:57] <eternaleye> sfackler: From<Error>, try!() perhaps?
[06:25:52] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Ping timeout: 121 seconds)
[06:27:33] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:27:33] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[06:28:13] *** Quits: pauls (pauls@moz-e5p333.ccs.neu.edu) (Ping timeout: 121 seconds)
[06:28:26] *** Quits: clatour (clatour@moz-slkfub.hlrn.qwest.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[06:29:54] <sfackler> WindowsBunny: any idea why read timeouts (set with SO_RCVTIMEO) would be ~.5 seconds longer than they're supposed to be?
[06:30:01] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[06:31:57] <sfackler> i.e. a 10 ms timeout returns in 510 ms and a 790 ms timeout returns in 1290 ms
[06:32:33] *** Quits: James (quassel@moz-q6malq.range86-148.btcentralplus.com) (Ping timeout: 121 seconds)
[06:34:45] <sfackler> oh, derp, recv_from calls sockaddr_to_addr
[06:35:53] <eternaleye> sfackler: http://stackoverflow.com/questions/6234086/winsock-recv-timeout-setsockopt-set-value-half-a-second
[06:36:03] <eternaleye> sfackler: re: the .5s timeout extension
[06:36:34] <eternaleye> sfackler: >> If you need to use the SO_RCVTIMEO option and you use the WSASocket function to create the socket, you must specify WSA_FLAG_OVERLAPPED as part of WSASocket's dwFlags parameter. Subsequent calls to any Winsock receive function (such as recv, recvfrom, WSARecv, or WSARecvFrom) block only for the amount of time specified.
[06:37:20] <acrichto> sfackler: whoa this is... weird
[06:37:30] <acrichto> eternaleye: we do specify that flag at creation time, so that may be somewhat unrelated
[06:37:32] *** Joins: kushal (kdas@moz-so4.f0d.244.121.IP)
[06:38:52] <acrichto> sfackler:  You can set these options on any type of socket in any state. The default value for these options is zero, which refers to an infinite time-out. Any other setting is the time-out, in milliseconds. It is valid to set the time-out to any value, but values less than 500 milliseconds (half a second) are interpreted to be 500 milliseconds.
[06:39:11] <acrichto> that doesn't seem to agree with what you're seeing, however
[06:40:59] <sfackler> it also appears that SO_RCVTIMEO isn't respected by recvfrom on windows
[06:42:09] *** Joins: c0170 (c0170@moz-bb29a4.cambridge.arm.com)
[06:42:14] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[06:42:42] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[06:43:11] <acrichto> sfackler: hm, what makes you think that?
[06:43:33] *** Quits: kushal (kdas@moz-so4.f0d.244.121.IP) (Ping timeout: 121 seconds)
[06:44:12] <sfackler> the setsockopt docs only mention recv, and recvfrom doesn't mention SO_RCVTIMEO, and I'm not seeing timeouts come out of it
[06:44:42] <acrichto> that... is pretty convincing!
[06:46:10] <sfackler> weirdly enough what does come out of it appears to be a value not equal to -1, but an sa_family of 0
[06:46:17] <sfackler> so sockaddr_to_addr fails
[06:46:40] <sfackler> which I assume means it's just not filling it in
[06:46:46] <sfackler> which makes sense since there is no message
[06:46:57] <sfackler> where did you get that quote about rounding up to 500 ms?
[06:47:19] <acrichto> http://www.microsoft.com/mspress/books/WW/sampchap/4287d.aspx
[06:47:24] <acrichto> search for "500"
[06:47:45] <acrichto> it looks like it's also what C# does
[06:47:56] <acrichto> https://msdn.microsoft.com/en-us/library/system.net.sockets.socket.sendtimeout
[06:48:02] <acrichto> If you set the property with a value between 1 and 499, the value will be changed to 500. The default value is 0, which indicates an infinite time-out period. Specifying -1 also indicates an infinite time-out period.
[06:48:12] <sfackler> weird
[06:48:20] <sfackler> it claims recvfrom should work with it
[06:48:36] <eternaleye> sfackler: What version of Windows is this?
[06:48:41] <XMPPwocky> On Windows, why doesn't Rust install into PATH by default
[06:49:02] <XMPPwocky> is there ever a time where people are like "i want rustc installed, but i want to type the full path out every time"
[06:49:20] <eternaleye> XMPPwocky: Or have a batch file that sets up an env...
[06:49:34] <sfackler> eternaleye: 7
[06:50:04] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[06:50:14] <sfackler> eternaleye: 7
[06:50:47] <XMPPwocky> 7?
[06:51:14] <eternaleye> sfackler: http://stackoverflow.com/questions/11142579/consistent-500ms-delay-on-network-comms-on-some-winxp-win7-systems
[06:51:24] <eternaleye> XMPPwocky: Windows 7, in response to a question I asked
[06:51:32] <XMPPwocky> oh, sorry
[06:52:08] <sfackler> eternaleye: ooh, thanks
[06:52:12] <sfackler> windows is weird :P
[06:52:41] <eternaleye> sfackler: So, try turning off antivirus? (ohgodIamsogladIworkonLinuxallday)
[06:54:01] <sfackler> I'll probably just change the assert to assert!(cfg!(windows) || time < Duration::from_millis(15)) :P
[06:55:50] <eternaleye> sfackler: This sounds like a case for saturating subtraction of 501, then addition of 1!
[06:55:59] <eternaleye> sfackler: :P
[06:56:34] <sfackler> wut
[06:56:45] <sfackler> recvfrom is returning this: 4294967295
[06:57:06] <acrichto> sfackler: that's -1
[06:57:35] *** Quits: semarie (semarie@moz-ke9rv2.nos-oignons.net) (Quit: WeeChat 1.1)
[06:57:50] <sfackler> this definition of recvfrom does not seem to match microsoft's docs: https://doc.rust-lang.org/stable/src/libc/lib.rs.html#5965
[06:57:54] <sfackler> https://msdn.microsoft.com/en-us/library/windows/desktop/ms740120%28v=vs.85%29.aspx
[06:57:57] <sfackler> int vs ssize_t
[06:58:05] *** Joins: squiddy (squiddy@moz-md4.pm3.19.178.IP)
[06:58:25] <eternaleye> sfackler: Hm, maybe this is an LP64 vs LLP64 thing?
[06:58:36] <acrichto> sfackler: er oops :(
[07:00:25] <sfackler> I bet this'll fix it
[07:00:42] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Client exited)
[07:06:03] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[07:06:35] <eternaleye> sfackler: Backport candidate, do you think?
[07:07:36] <sfackler> seems reasonable
[07:10:40] *** Quits: njn (chatzilla@moz-e6r6of.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 41.0a1/20150524155217])
[07:13:40] *** Quits: nham (nham@moz-lglsfe.il.comcast.net) (Quit: leaving)
[07:18:12] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[07:18:45] <sfackler> victory!
[07:20:48] <Mutabah> Question - is the restriction on destructable objects in const fn an inherent restriction? Or could it be used to do compile-time ininitialisation of statics?
[07:21:18] <huon> Mutabah: could you clarify how those two questions relate?
[07:21:31] <huon> isn't const fn exactly designed to do compile-time init of statics?
[07:21:43] <Mutabah> yes, but atm I get " error: constant functions are not allowed to have destructors
[07:21:56] <Mutabah> When I try to construct an object that has a destructor
[07:22:37] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[07:23:32] <eternaleye> Mutabah: Mm, that could _probably_ be replaced by some check that ensures that no value is _actually destroyed_ in a const fn.
[07:23:49] <eternaleye> Mutabah: i.e. it's either returned into (ultimately) a static, or has no Drop impl
[07:23:49] <Mutabah> eternaleye: Yeah, that would be ideal
[07:24:07] <eternaleye> Actually, not even a static
[07:24:16] <eternaleye> Just into either a static or a non-const fn
[07:24:27] <Mutabah> Ah - "struct/enum values are not allowed if their type implements Drop, but this is not transitive, allowing the (perfectly harmless) creation of, e.g. None::<Vec<T>> (as an aside, this rule could be used to allow [x; N] even for non-Copy types of x, but that is out of the scope of this RFC)" (from the RFC)
[07:24:49] <eternaleye> Hm
[07:25:00] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[07:25:03] <eternaleye> But doesn't that require the user use static mut?
[07:25:10] <eternaleye> Which requires unsafe to access?
[07:25:20] <Mutabah> eternaleye: Doesn't what?
[07:25:38] <eternaleye> Mutabah: In order to actually create a useful static with Drop
[07:25:41] <Mutabah> eternaleye: My kernel is peppered with instances of 'Mutex<Vec<...>>'
[07:25:50] <eternaleye> Oh, I see now.
[07:26:00] <eternaleye> I was taking the None example too literally
[07:29:58] <SimonSapin> Does 'const fn' mean compile-time evaluation?
[07:33:41] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[07:35:56] <klutzy> acrichto: WindowsBunny: do you know what's the core issue at #25268/#25654? (I'm much confused because I cannot even reproduce process-remove-from-env.rs at all - `output` is "" to me.)
[07:36:03] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Connection closed)
[07:36:25] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[07:37:57] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[07:40:27] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[07:41:32] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[07:42:21] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[07:43:35] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[07:44:05] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:48:38] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[07:52:01] <Mutabah> SimonSapin: yes it does
[07:52:13] <Mutabah> SimonSapin: Well, more that it can be run at compile time
[07:54:27] *** Quits: dcb (textual@moz-j72nfe.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[07:55:44] *** Quits: Kxepal (Miranda@moz-j3eqgp.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[07:57:39] *** Joins: Kxepal (Miranda@moz-k6rt2h.pppoe.mtu-net.ru)
[08:03:18] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Connection closed)
[08:04:22] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[08:12:58] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[08:13:45] *** Quits: andreabedini (andreabedin@moz-2lt49q.unimelb.edu.au) (Quit: Textual IRC Client: www.textualapp.com)
[08:15:44] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[08:31:48] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[08:36:11] *** kimundi is now known as zz_kimundi
[08:36:41] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[08:39:08] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[08:40:23] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[08:40:44] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[08:41:28] *** Joins: p1start (p1start@moz-nftjhe.org)
[08:45:28] *** Joins: goyox86 (textual@moz-qfs.570.70.83.IP)
[08:52:34] *** Joins: laumann (thomas@moz-gqpfnm.science.ku.dk)
[08:54:50] *** Joins: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP)
[09:10:41] *** Joins: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP)
[09:10:58] *** Joins: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP)
[09:11:01] *** Quits: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP) (Connection closed)
[09:11:02] *** Joins: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP)
[09:12:01] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[09:12:31] *** zz_kimundi is now known as kimundi
[09:17:42] <WindowsBunny> klutzy: sup
[09:19:03] <WindowsBunny> sfackler: You still there?
[09:19:30] <WindowsBunny> sfackler: The windows thread scheduler is precise down to 1ms
[09:21:05] <WindowsBunny> wait, .5 seconds, not .5 ms
[09:21:10] <WindowsBunny> jeez, how does that even work
[09:21:22] <klutzy> WindowsBunny: my rough understanding is `cmd /c set` works differently based on code page, then the "right" solution is just to not use cmd for test
[09:21:53] <klutzy> so I built the testcase locally then found it doesn't capture cmd output at all
[09:22:24] <WindowsBunny> klutzy: What is it even doing?
[09:22:51] <Quxxy> WindowsBunny: is winapi supposed to expose any macros?  They is not showing up in the docs as far as I can tell (am looking for a GUID macro so I can define CSIDL_LOCAL_APPDATA)
[09:23:24] <WindowsBunny> Quxxy: Um, I don't know, how do you expose macros?
[09:23:37] <Quxxy> #[macro_export], I think
[09:24:00] * Quxxy checks his own intro to macros article
[09:24:08] <Quxxy> Yup
[09:24:25] <Quxxy> Then #[macro_use] on the `extern crate`.  I... don't know off-hand how to re-export them
[09:24:45] <Quxxy> Also, I assume this means there isn't a usable GUID! macro :P
[09:24:59] <klutzy> WindowsBunny: I've copied https://github.com/rust-lang/rust/blob/master/src/test/run-pass/process-remove-from-env.rs#L49 and just added `println!("output: {:?}", result.output);`. I got `output: []` when I ran it manually
[09:24:59] <WindowsBunny> yes there is
[09:25:25] <WindowsBunny> Quxxy: Note  As of Windows Vista, these values have been replaced by KNOWNFOLDERID values. 
[09:25:50] <Quxxy> Blargh; yes, I'm on that list, I just copy+pasted the wrong bit of the table :P
[09:25:57] <WindowsBunny> Quxxy: See FOLDERID_LocalAppData in uuid-sys
[09:26:05] <Quxxy> Ah, I see
[09:26:45] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[09:26:53] <WindowsBunny> klutzy: I'm so confused
[09:26:54] <Quxxy> Wait, so... is that re-exported by winapi?
[09:27:09] <WindowsBunny> Quxxy: -sys crates depend on winapi, so winapi can't re-export them
[09:27:26] <WindowsBunny> Quxxy: It's an external static
[09:27:42] <Quxxy> Ah... is there supposed to be a `uuid` crate?  There seems to be one for all the other `*-sys` crates
[09:28:56] <WindowsBunny> Quxxy: yes
[09:29:18] <Quxxy> Aah, but `uuid` was already taken?
[09:32:05] <WindowsBunny> Quxxy: https://crates.io/crates/uuid-sys
[09:32:49] <Quxxy> Aye; I was just wondering if I was supposed to use that or `uuid` (which wasn't in the docs) given that there is, for example, `shell32` and `shell32-sys`
[09:34:01] <WindowsBunny> Quxxy: I don't see `shell32` on crates.io
[09:34:15] <Quxxy> Oh, I'm looking at the docs, not the crates.io listing
[09:34:17] <WindowsBunny> Quxxy: Are you looking at my online docs for winapi?
[09:34:24] <Quxxy> Yes, that thing :)
[09:34:24] <WindowsBunny> hmmm, they're probably outdated
[09:34:52] <WindowsBunny> Quxxy: Also, the cargo name is uuid-sys, but the name you use inside rust is `extern crate uuid;`
[09:35:00] <WindowsBunny> so if you want to use both uuid-sys and uuid, tough
[09:35:10] <Quxxy> :3
[09:37:27] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[09:40:26] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Connection closed)
[09:40:38] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[09:41:19] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Quit: Leaving...)
[09:41:30] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[09:44:02] *** Joins: Johannes (Johannes@moz-4et8d7.ocn.ne.jp)
[09:46:57] * Quxxy is tempted to dig out the parts from his higher-level winapi wrapper...
[09:46:58] *** Quits: Johannes (Johannes@moz-4et8d7.ocn.ne.jp) (Quit: Leaving...)
[09:48:34] *** kimundi is now known as zz_kimundi
[09:51:28] *** Joins: genbattle (genbattle@moz-r09mao.xtra.co.nz)
[09:55:00] * WindowsBunny digs out parts of Quxxy
[09:55:09] *** Quits: goyox86 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[09:55:14] *** Joins: lorenzb (lorenzb@moz-n0t21v.ethz.ch)
[09:55:16] <Quxxy> WindowsBunny: Noo, not my squeedily spooch!
[09:56:57] *** zz_kimundi is now known as kimundi
[10:00:30] *** Joins: larhat (Adium@moz-egv.ld6.128.213.IP)
[10:01:19] *** Quits: larhat (Adium@moz-egv.ld6.128.213.IP) (Quit: Leaving.)
[10:01:43] <Quxxy> Waitaminute... how does OsStr work if there's no conversion to ucs-2?
[10:11:10] <SimonSapin> What’s the timezone for "time" column on http://buildbot.rust-lang.org/builders/nightly-dist-rustc-linux , UTC?
[10:11:57] <SimonSapin> Quxxy: there is?
[10:12:19] <Quxxy> Well, *yes*, but the question is where is it, what is it called, and can I call it? :P
[10:12:45] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[10:12:56] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[10:13:22] <SimonSapin> Quxxy: std::os::windows::OsStrExt
[10:13:25] <SimonSapin> something like that
[10:13:27] *** Joins: ctennis (ctennis@moz-vcpg3c.in.comcast.net)
[10:13:35] *** Quits: lorenzb (lorenzb@moz-n0t21v.ethz.ch) (Connection closed)
[10:13:42] <SimonSapin> It doesn’t show up in the docs because of https://github.com/rust-lang/rust/issues/24658
[10:14:00] *** Joins: semarie (semarie@moz-r8s4se.server.torland.is)
[10:14:00] <Quxxy> You do realise that I *just* found that by crawling through the libstd source, right?
[10:14:27] <SimonSapin> eeh, ok?
[10:16:12] <Quxxy> That was a "you just solved my problem, and I thank you for it.  That said, you did so at the latest possible moment, which is somewhat frustrating in a cosmic sense" comment :)
[10:17:23] *** Joins: goyox86 (textual@moz-qfs.570.70.83.IP)
[10:19:24] <WindowsBunny> Quxxy: encode_wide
[10:19:42] <Quxxy> I actually need to go the other way, but yes
[10:20:03] <Quxxy> I found the OsStringExt trait, now I just need to see if there's already something that will go from PWSTR -> &[u16]
[10:20:10] <Quxxy> But first, there is popcorn, apparently
[10:21:07] <WindowsBunny> Quxxy: You're getting a null terminated PWSTR from winapi without a length?
[10:23:37] <WindowsBunny> Quxxy: std::slice::from_raw_parts
[10:23:48] <WindowsBunny> but if you don't have a length, no idea
[10:25:00] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[10:26:32] <WindowsBunny> You'd just have to write an unsafe method to get the length of a null terminated *const u16
[10:27:27] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[10:30:00] <Quxxy> WindowsBunny: Aye, so far as I can see, there's no length
[10:31:18] *** Quits: semarie (semarie@moz-r8s4se.server.torland.is) (Ping timeout: 121 seconds)
[10:31:35] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Ping timeout: 121 seconds)
[10:35:18] <WindowsBunny> Quxxy: how are you getting the string?
[10:35:27] <Quxxy> SHGetKnownFolderPath
[10:37:06] <WindowsBunny> Quxxy: ah, I see
[10:38:12] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[10:39:24] *** Quits: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP) (Connection closed)
[10:39:45] *** Joins: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP)
[10:42:15] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[10:43:47] *** Quits: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP) (Ping timeout: 121 seconds)
[10:44:22] *** Joins: semarie (semarie@moz-uk024k.blackcatz.org)
[10:45:46] *** Quits: genbattle (genbattle@moz-r09mao.xtra.co.nz) (Ping timeout: 121 seconds)
[10:52:44] *** kimundi is now known as zz_kimundi
[10:55:24] *** Quits: semarie (semarie@moz-uk024k.blackcatz.org) (Ping timeout: 121 seconds)
[10:56:22] *** Joins: semarie (semarie@moz-r8s4se.server.torland.is)
[10:58:45] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[11:13:37] *** Quits: goyox86 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:24:43] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[11:26:45] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[11:28:13] *** Joins: vmx (vmx@moz-3rq9n0.dip0.t-ipconnect.de)
[11:28:27] *** Quits: bjz (bjz@moz-4cc8qn.bigpond.net.au) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:29:39] *** Joins: ytain (ytain@moz-ffpck2.dsl.teksavvy.com)
[11:35:30] *** Joins: bjz (bjz@moz-4cc8qn.bigpond.net.au)
[11:41:46] <koobs> Anyone up to help with build system ?
[11:42:55] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[11:47:00] <koobs> gus: ahh, i see you added ldflgags
[11:47:02] <koobs> ldflags
[11:47:25] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[11:47:28] *** Joins: goyox86 (textual@moz-qfs.570.70.83.IP)
[11:48:07] <SimonSapin> Given `struct Foo(Bar);`, is it always safe to transmute &Bar to &Foo? or could e.g. drop flags interfere?
[11:50:01] <Manishearth> SimonSapin: Drop flags are important
[11:50:20] <SimonSapin> so is it safe is Foo doesn’t have a destructor?
[11:50:48] <Manishearth> and if Bar doesn't either
[11:51:37] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[11:51:53] <SimonSapin> hum, maybe I should avoid that and just do `struct FooRef<'a>(&'a Bar);` or something
[11:52:09] <bluss> isn't it enough that Foo doesn't have a destructor
[11:52:41] <bluss> that said, I don't know how rusts aliasing rules work
[11:52:51] <Manishearth> yeah
[11:53:11] <Manishearth> SimonSapin: though ... does &T work with drop flags? Perhaps not.
[11:53:14] <Manishearth> No, it doesn't
[11:53:39] <SimonSapin> I mean with an explicit &Bar in the struct I don’t need transmute
[11:54:06] <bluss> you don't need to transmute &foo.0 either for the Foo(Bar) case
[11:54:27] <bluss> ah, but you're going from bar to foo
[11:54:29] *** Joins: Sho (sho@moz-jrjdrg.cust.telecolumbus.net)
[11:56:24] *** Joins: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP)
[11:56:33] <SimonSapin> So, for context: https://github.com/SimonSapin/kuchiki/blob/03106884a6/src/tree.rs I have Node that contains a NodeData enum with variants like Element(ElementData), and a pub fn as_element(&self) -> Option<&ElementData> method on Node 
[11:57:52] <SimonSapin> I was thinking the API could be nicer if I make ElementData private and have an Element wrapper with both Node methods and ElementData methods
[11:58:45] <SimonSapin> so it could be `struct Element<'a>(&'a Node, &'a ElementData);`, but it’s kinda wasteful to store two pointers to basically the same thing
[11:59:13] <Manishearth> SimonSapin: i think it should be okay to transmute
[11:59:39] <SimonSapin> anyway, I’m rambling
[12:01:39] <SimonSapin> I want Element to also have all the methods of Node. Is it a terrible idea to implement Deref to simulate "inheritance"?
[12:02:01] *** Quits: squiddy (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[12:04:30] *** Quits: jooert (jooert@moz-ec67oq.compute-1.amazonaws.com) (Quit: Bye!)
[12:04:54] *** Joins: jooert (jooert@moz-ec67oq.compute-1.amazonaws.com)
[12:09:26] *** Quits: tamird (textual@moz-gg3hct.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[12:10:25] *** Joins: ryanhiebert (ryanhiebert@moz-nsd5kl.ks.cox.net)
[12:11:46] <Manishearth> SimonSapin: sounds okay
[12:11:54] <Manishearth> very strange, but okay
[12:12:50] *** Joins: dinfuehr_ (dinfuehr@moz-c25.u8s.112.91.IP)
[12:12:54] <SimonSapin> https://twitter.com/nick_r_cameron/status/580106932297465856
[12:13:31] <SimonSapin> but duplicating methods make docs hard to read, and using a trait means users need to import it :(
[12:15:31] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Ping timeout: 121 seconds)
[12:16:54] *** Quits: dinfuehr_ (dinfuehr@moz-c25.u8s.112.91.IP) (Ping timeout: 121 seconds)
[12:19:05] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[12:19:28] <bluss> SimonSapin: by the way will you use map_ref for a caching solution? I'm going to be interested to look at it
[12:20:01] <SimonSapin> caching?
[12:20:40] <SimonSapin> no, I want easier accessors to https://github.com/SimonSapin/kuchiki/blob/03106884a6/src/tree.rs#L29 for example
[12:20:47] <bluss> ok
[12:21:36] <bluss> yes because using RefCells eliminates regular borrowing, can't return &T from RefCell<T> anymore
[12:21:47] <SimonSapin> replacing e.g `element.attributes.borrow().get(&QualName::new(ns!(""), Atom::from_slice(name)))` with `element.get_attribute(name)`
[12:21:50] *** Joins: eerie_ (eerie@moz-ja0t6l.red.bezeqint.net)
[12:22:09] <SimonSapin> and have get_attribute return std::cell::Ref<String>
[12:22:29] <bluss> that's nice
[12:23:07] <bluss> but as I said, when I tested this it was basically for a cache and that was next to unusable
[12:23:14] *** Joins: bdero1 (bran@moz-216hqv.oo5r.e4su.0006.2601.IP)
[12:23:22] <SimonSapin> what made it unusable?
[12:23:33] <bluss> in my case since it was so easy for the user to keep references, I could never call .borrow_mut()
[12:23:43] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[12:23:48] <SimonSapin> well, that’s up to the user
[12:24:19] <SimonSapin> and if I just exposed the RefCell and let them borrow() it, the same issue can still happen
[12:24:28] <bluss> yes
[12:24:40] <bluss> I don't like refcells at all
[12:24:42] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Ping timeout: 121 seconds)
[12:25:50] *** Joins: JuggleTux (tux@moz-ho0t1f.adslplus.ch)
[12:25:56] <SimonSapin> I need them to have any mutablity for nodes in an Arena, which I need to have parent pointers in the tree (and thus reference cycles)
[12:26:29] *** Joins: harrisonclarke (harrisoncla@moz-4lq79j.eastlink.ca)
[12:27:15] <SimonSapin> alternatives are reference counting with weak references (has runtime cost, even traversing the tree is reference count traffic), or a big Vec of nodes with indices (not-so-convenient API, you have to go back to the vector for any access)
[12:28:19] *** Joins: lorenzb (lorenzb@moz-tde1p4.ethz.ch)
[12:32:04] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[12:34:42] *** Quits: eerie_ (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[12:43:47] <pnkfelix> SimonSapin: "even traversing the tree is reference count traffic" hmm, that make we wonder about some variant API to avoid that traffic
[12:44:49] <pnkfelix> SimonSapin: e.g. some hack like `tree.scoped_traversal( |node| { ... });` where scoped_traveral increments the root ref-count for `tree`, and then exposes the internal nodes without doing anything to their ref-counts
[12:45:33] <SimonSapin> pnkfelix: my experiment has an independant refcount for every node, and you can detach nodes at any time
[12:47:57] <SimonSapin> … and you’d still need refcell within Rc
[12:48:11] <pnkfelix> SimonSapin: okay, if you're going to allow that level of flexibility then an Rc-based rep pretty much has to pay with refcount traffic
[12:49:02] * pnkfelix still hasn't actually looked at the API carefully
[12:49:13] <pnkfelix> just idle musing
[12:49:57] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[12:50:13] *** Joins: rkruppe (chatzilla@moz-0k5kpu.uopk.14d9.41b8.2001.IP)
[12:51:27] <SimonSapin> http://smallcultfollowing.com/babysteps/blog/2015/04/06/modeling-graphs-in-rust-using-vector-indices/ says "Another similar problem arises if you use the index from one graph with another graph (you can mitigate that with fancy type tricks, but in my experience it’s not really worth the trouble)." nmatsakis: I’m curious what the fancy tricks are :)
[12:53:17] <SimonSapin> pnkfelix: do you know what they are? ↑
[12:54:07] <bluss> using the index from one graph in another is useful too.. Maybe you have two graphs with identicial nodes but different edges
[12:54:18] <bluss> it's open to logic bugs sure
[12:54:58] <SimonSapin> that sounds like a very special case
[12:54:59] <pnkfelix> SimonSapin: I'm not sure off the top of my head
[12:55:13] <pnkfelix> nmatsakis: ^
[12:55:41] <pnkfelix> (I could make guesses but I would want to prototype them first, and I don't want to spend time on that right now)
[12:55:43] *** Quits: harrisonclarke (harrisoncla@moz-4lq79j.eastlink.ca) (Connection closed)
[12:55:50] <SimonSapin> haha fair enough
[12:56:05] *** Joins: harrisonclarke (harrisoncla@moz-4lq79j.eastlink.ca)
[12:56:50] <pnkfelix> (i was mostly thinking of things like making the index type an associated type of the graph, but I'm not even sure that actually mitigates the issue to the degree alluded to there.)
[12:57:37] <SimonSapin> wouldn’t two graphs have the same type?
[12:57:41] <bluss> I took the rustc graph and put in the package petgraph. And exactly that special case was something I found a consumer of the crate was doing. I suppose it could have been solved another way if it were restricted
[12:58:32] *** Joins: summerlight_ (summerlight@moz-99k.2mj.130.121.IP)
[13:00:22] *** Quits: harrisonclarke (harrisoncla@moz-4lq79j.eastlink.ca) (Ping timeout: 121 seconds)
[13:00:50] <pnkfelix> SimonSapin: yes, they would if you did `f<G: Graph>(g1: G, g2: G)`
[13:01:21] <pnkfelix> SimonSapin: but if you did `f<G1: Graph, G2:Graph>(g1: G1, g2: G2)` then the type checker will assume they don't.
[13:01:41] <pnkfelix> SimonSapin: still, might not be the right answer here.
[13:02:53] <pnkfelix> (especially since that approach doesn't scale to e.g. vectors of graphs)
[13:03:20] <SimonSapin> that’s not the issue I had in mind
[13:03:56] <SimonSapin> I was thinking of `id = graph1.new_node(); graph2.get_node(id)` would give you an unrelated node
[13:04:02] *** Joins: jdm (jdm@moz-1s76ai.dsl.teksavvy.com)
[13:04:32] <pnkfelix> SimonSapin: yes, I do think I'm trying to address that; by G/G1/G2 I meant G::AssociatedIndex will be the same type for `g1` and `g2` in the first example , and thus `get_node` would return the same type in the first example.
[13:05:03] <pnkfelix> SimonSapin: while in the second example, `get_node` would return `G1::AssociatedIndex` for `g1` and `G2::AssociatedIndex` for `g2`.
[13:05:09] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[13:05:14] *** Quits: _Vi (vi@moz-bbs.vhj.131.104.IP) (Ping timeout: 121 seconds)
[13:05:30] <pnkfelix> SimonSapin: and thus you would not be allowed to intermix the two indices
[13:05:45] <pnkfelix> (at least, not between the graphs)
[13:10:35] <pnkfelix> SimonSapin: or are we talking about different things?
[13:10:48] *** Quits: bkearns (Adium@moz-vofc96.us.xo.net) (Quit: Leaving.)
[13:10:53] <SimonSapin> I’m not sure :)
[13:12:29] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[13:13:27] <pnkfelix> SimonSapin: okay.  Maybe at some point I will add a part III to the series of graph blog posts 
[13:14:46] *** Quits: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP) (Connection closed)
[13:14:51] *** Quits: rkruppe (chatzilla@moz-0k5kpu.uopk.14d9.41b8.2001.IP) (Ping timeout: 121 seconds)
[13:17:22] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[13:17:33] *** Quits: ctennis (ctennis@moz-vcpg3c.in.comcast.net) (Quit: Leaving...)
[13:24:30] *** Joins: rkruppe (chatzilla@moz-0k5kpu.uopk.14d9.41b8.2001.IP)
[13:25:28] *** Joins: poorman (poorman@moz-sdl0oq.res.rr.com)
[13:25:43] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[13:32:24] <nmatsakis> SimonSapin: so pnkfelix's idea is one, another is to use existential lifetimes, but they all rely on the same basic trick
[13:32:33] <nmatsakis> which is to make code that is more generic than it has to be
[13:32:45] <SimonSapin> existential lifetimes?
[13:32:51] <nmatsakis> well I mean
[13:33:00] <nmatsakis> you give each graph some arbitrary lifetime 'x (Graph<'x>)
[13:33:09] <nmatsakis> in reality this is always 'static
[13:33:13] <nmatsakis> but then you write your code like
[13:33:27] <nmatsakis> fn g<'x,'y>(g1: Graph<'x>, g2: Graph<'y>)
[13:33:29] <nmatsakis> and the id has a type like
[13:33:31] <nmatsakis> GraphIndex<'x>
[13:33:42] <nmatsakis> you can also use a closure like
[13:33:42] <SimonSapin> I see
[13:33:42] *** Joins: rkruppe_ (chatzilla@moz-0k5kpu.uopk.14d9.41b8.2001.IP)
[13:33:57] <nmatsakis> well anyway
[13:33:57] <nmatsakis> you get the idea
[13:34:05] <nmatsakis> scala's path dependent types are kind of nnice here
[13:34:14] <nmatsakis> but in practice all of these schemes only work when thigns are fairly straightforward
[13:34:28] <nmatsakis> like, you have a fixed number of graphs you are juggling etc
[13:34:32] <nmatsakis> and in that case you could as well do
[13:34:39] <nmatsakis> Graph<N>
[13:34:42] <nmatsakis> where N is the node type
[13:34:53] <nmatsakis> that is, the newtype'd index
[13:35:06] <nmatsakis> actually I did something like that somewhere in the compiler I think
[13:35:08] <nmatsakis> for a different reason
[13:35:08] *** Quits: rkruppe (chatzilla@moz-0k5kpu.uopk.14d9.41b8.2001.IP) (Ping timeout: 121 seconds)
[13:35:10] <nmatsakis> and it worked out ok
[13:35:10] *** Joins: ctennis (ctennis@moz-7lm.a44.102.99.IP)
[13:35:23] *** rkruppe_ is now known as rkruppe
[13:35:23] <nmatsakis> (in that case you can just make N new types)
[13:36:24] <SimonSapin> I’m applying these graph ideas to DOM-like trees (with parent and sibling "edges")
[13:36:27] <nmatsakis> (the nic thing about that is that it's as fine-grained as you want it to be)
[13:36:33] *** Joins: annodomini (lambda@moz-qgii5v.ma.comcast.net)
[13:37:00] <nmatsakis> here is where we use that last pattern in the compiler: https://github.com/rust-lang/rust/blob/master/src/librustc_data_structures/unify/mod.rs#L30-L38
[13:37:14] <nmatsakis> SimonSapin: interesting; makes sense
[13:37:27] <SimonSapin> nmatsakis: I find the Vec+IDs approach much less ergonomic, rather than node.parent() you have to do tree.get_parent(node) and go back to the vec/tree/graph for every access
[13:37:58] <nmatsakis> yes, that's true.
[13:38:12] <nmatsakis> you could do some work to sidestep that but it'd be a lot of boilerplate I imagine
[13:38:18] <SimonSapin> but on the other hand it avoids RefCell and enables multi-threaded access
[13:38:23] <nmatsakis> (e.g., have some kidn of short-lived wrwapper that brings those two together)
[13:38:30] <nmatsakis> well maybe it'd not be so bad
[13:38:36] <nmatsakis> if it implemented Deref
[13:38:52] <nmatsakis> and just provided methods for the navigation (parent, etc)
[13:39:16] <nmatsakis> something like struct GraphCursor<'g> { index: usize, graph: &'g Graph }
[13:39:16] <SimonSapin> something like `struct NodeRef<'a>(&'a Graph, Index)` ?
[13:39:20] <nmatsakis> and
[13:39:24] <nmatsakis> something like struct MutGraphCursor<'g> { index: usize, graph: &'g mut Graph }
[13:39:27] <nmatsakis> (presumably)
[13:39:30] <SimonSapin> right
[13:39:31] <nmatsakis> or you could do it in one
[13:39:37] <nmatsakis> with more generics
[13:39:47] <nmatsakis> struct Graphcursor<G> { index: usize, graph: G }
[13:40:03] <nmatsakis> struct GraphCursor<G:GraphRef> { index: usize, graph_ref: G } // <-- more completely
[13:40:34] *** Quits: goyox86 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[13:40:48] <SimonSapin> interesting
[13:41:35] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[13:41:36] <SimonSapin> I don’t mind some boilerplate if I can write it "once" (until I rewrite it of course) in a library
[13:41:42] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[13:41:44] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[13:41:54] *** Joins: joh (uid13099@moz-2c7ap3.ealing.irccloud.com)
[13:42:09] *** Quits: rkruppe (chatzilla@moz-0k5kpu.uopk.14d9.41b8.2001.IP) (Ping timeout: 121 seconds)
[13:43:59] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[13:45:07] *** Joins: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP)
[13:46:02] *** Joins: goyox86 (textual@moz-qfs.570.70.83.IP)
[13:46:55] <bluss> SimonSapin: using indices freely is a feature for me, it allows much simpler traversal & mutation logic, see example @ http://bluss.github.io/petulant-avenger-graphlibrary/target/doc/petgraph/visit/struct.Dfs.html
[13:49:31] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[13:53:05] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[13:56:17] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Connection closed)
[13:56:39] *** Joins: casey (casey@moz-v0ns05.tpgi.com.au)
[13:57:48] *** Joins: nodweber_ (nodweber@moz-knt.fgq.178.5.IP)
[13:58:34] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[13:59:40] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[13:59:51] *** Quits: JuggleTux (tux@moz-ho0t1f.adslplus.ch) (Ping timeout: 121 seconds)
[14:00:41] *** Quits: casey (casey@moz-v0ns05.tpgi.com.au) (Ping timeout: 121 seconds)
[14:02:08] *** Quits: annodomini (lambda@moz-qgii5v.ma.comcast.net) (Client exited)
[14:07:46] *** Joins: _Vi (vi@moz-bbs.vhj.131.104.IP)
[14:08:12] *** Quits: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[14:09:05] *** Joins: rkruppe (chatzilla@moz-0k5kpu.uopk.14d9.41b8.2001.IP)
[14:10:21] *** Joins: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP)
[14:12:25] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[14:12:39] *** Quits: nodweber_ (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[14:17:50] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[14:18:05] *** Quits: jgallagher (john@moz-6ge.dhn.131.24.IP) (Client exited)
[14:19:53] *** Joins: gretcherex (Mibbit@moz-juv.9o3.252.72.IP)
[14:20:33] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[14:20:43] *** Quits: gretcherex (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:26:16] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[14:29:19] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[14:30:25] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[14:30:37] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[14:32:38] *** Joins: annodomini (lambda@moz-suboe0.ma.comcast.net)
[14:32:45] *** Joins: wca (will@moz-oonm1e.firepipe.net)
[14:33:26] *** Joins: mgottschlag (quassel@moz-p7t3va.hsi2.kabelbw.de)
[14:34:17] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[14:39:05] *** Joins: zmack (zmack@moz-qdq.e19.24.188.IP)
[14:40:30] *** Joins: rkruppe_ (chatzilla@moz-fd8tjk.hrz.tu-darmstadt.de)
[14:41:26] *** Quits: annodomini (lambda@moz-suboe0.ma.comcast.net) (Client exited)
[14:42:43] *** Quits: goyox86 (textual@moz-qfs.570.70.83.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[14:42:44] *** Quits: rkruppe (chatzilla@moz-0k5kpu.uopk.14d9.41b8.2001.IP) (Ping timeout: 121 seconds)
[14:44:57] *** Quits: rkruppe_ (chatzilla@moz-fd8tjk.hrz.tu-darmstadt.de) (Ping timeout: 121 seconds)
[14:46:44] *** Quits: burntsushi (burntsushi@moz-t92kn9.ma.charter.com) (Connection closed)
[14:47:13] *** Joins: burntsushi (burntsushi@moz-t92kn9.ma.charter.com)
[14:48:50] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[14:49:15] *** Quits: zmack (zmack@moz-qdq.e19.24.188.IP) (Connection closed)
[14:49:29] *** Quits: c0170 (c0170@moz-bb29a4.cambridge.arm.com) (Connection closed)
[14:49:40] *** Joins: zmack (zmack@moz-qdq.e19.24.188.IP)
[14:50:14] *** Quits: zmack (zmack@moz-qdq.e19.24.188.IP) (Connection closed)
[14:52:21] *** Joins: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net)
[14:56:07] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[14:56:38] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[14:58:48] *** Quits: lorenzb (lorenzb@moz-tde1p4.ethz.ch) (Quit: Computer went to sleep)
[15:00:42] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Ping timeout: 121 seconds)
[15:01:18] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[15:05:32] *** Quits: mgottschlag (quassel@moz-p7t3va.hsi2.kabelbw.de) (Connection closed)
[15:06:40] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Connection closed)
[15:08:09] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[15:09:37] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[15:10:08] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[15:10:09] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[15:10:47] *** Joins: goyox86 (textual@moz-qfs.570.70.83.IP)
[15:11:09] *** Quits: goyox86 (textual@moz-qfs.570.70.83.IP) (Quit: Textual IRC Client: www.textualapp.com)
[15:12:18] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Ping timeout: 121 seconds)
[15:16:24] <pnkfelix> nmatsakis: do you think it would be plausible to change the `move_val_init` intrinsic to use `trans_into` (much like how trans handles the arg to ExprBox), rather than creating an Rvalue datum like it does now?
[15:17:38] * pnkfelix starts hacking without waiting for an answer. Let him know if he's crazy!
[15:17:41] <nmatsakis> pnkfelix: seems plausible; I feel like at lesat some intrinsics
[15:17:46] <nmatsakis> pnkfelix: are not handled as normal fns
[15:17:52] <nmatsakis> pnkfelix: but rather we kind of hardcode everything
[15:18:19] <nmatsakis> pnkfelix: though I may be wrong
[15:18:46] <pnkfelix> "are not handled as normal fns" -- that is to be expected for intrinsics, right?
[15:18:49] <Manishearth> hey, pnkfelix, is there an approximate timeline for when dynamic drop is going to die?
[15:18:59] <pnkfelix> nmatsakis: maybe I do not understand what you are getting at though
[15:19:08] <Manishearth> (i.e the drop flag and its friends)
[15:19:14] <pnkfelix> Manishearth: dynamic drop lives forever.  The embedded drop flags and zeroing are meant to go away
[15:19:27] <nmatsakis> pnkfelix: ah yes see: https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/intrinsic.rs#L175-L266
[15:19:37] <nmatsakis> pnkfelix: well, I guess it depends on what you mean by normal
[15:19:41] <Manishearth> pnkfelix: "dynamic drop lives forever" what do you mean by dynamic drop here?
[15:19:45] <pnkfelix> Manishearth: I currently have a branch that gets rid of the zeroing *some* of the time
[15:19:55] <nmatsakis> pnkfelix: for most intrinsics, we make a "regular" C function, we just generate its body in a special way,
[15:19:58] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[15:19:58] <nmatsakis> pnkfelix: and let LLVM inline it
[15:20:12] <nmatsakis> pnkfelix: but (as you can see from that link) for transmute, we don't do that
[15:20:23] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[15:20:51] <pnkfelix> Manishearth: (by "dynamic drop" I meant some form of dynamic-ness.  E.g. if drop-flags live on the stack, then its still dynamic.  Its to support things like `{ let x; if test { x = Foo; } }`, where the decision to run the dtor for `x` depends on the outcome of `test`)
[15:21:20] <Manishearth> pnkfelix: that code isn't possible
[15:21:29] <pnkfelix> nmatsakis: okay yes I see what you mean.
[15:21:47] <pnkfelix> Manishearth: I must not be communicating properly.  Let me put an example up on play.
[15:21:53] <Manishearth> pnkfelix: that code is *always* equal to if test {let x  = Foo}
[15:22:02] *** Joins: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP)
[15:22:19] <Manishearth> it can never be used to hoist a variable out of scope
[15:22:23] <Manishearth> ah cool
[15:22:36] <pnkfelix> Manishearth: look at the `fn sometimes_initialize` example here: http://blog.rust-lang.org/2015/04/17/Enums-match-mutation-and-moves.html
[15:22:45] <pnkfelix> Manishearth: that is fundamentally relying on dynamic drop
[15:23:49] <Manishearth> pnkfelix: ohhhh
[15:23:50] <Manishearth> I see
[15:24:05] <Manishearth> pnkfelix: but in sucha case can the drop flag be made part of the stack of the function and not the type itself?
[15:24:07] <pnkfelix> (we should add a `#[test]` mode to play
[15:24:18] <pnkfelix> Manishearth: yes, that is exactly the plan
[15:24:23] <Manishearth> cool
[15:24:28] <pnkfelix> Manishearth: and thus Dynamic Drop lives forever
[15:24:33] <Manishearth> haha
[15:24:35] <pnkfelix> Manishearth: but the embedded drop flags go away
[15:24:55] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[15:25:10] <pnkfelix> Manishearth: anyway, I have a branch that takes some baby steps in the right direction, based on some ideas provided by pcwalton and nmatsakis 
[15:25:20] *** Joins: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de)
[15:25:28] <pnkfelix> Manishearth: It needs some cleanup and does not provide quite the performance win we were hoping for
[15:25:31] <Manishearth> cool
[15:25:39] <pnkfelix> Manishearth: but it gives me hope that we'll get there
[15:26:22] <pnkfelix> oh wait, play *does* do #[test] autoamtically ???
[15:26:45] <Manishearth> magic
[15:26:57] <Manishearth> pnkfelix: anyway, I didn't even know Rust could do that ^_^
[15:27:04] <pnkfelix> wow!  when did that happen?  Has it always inferred based on whether a `fn main` is present?
[15:27:08] <Manishearth> (the deferred initialization stuff)
[15:27:17] <Manishearth> I always thought deferred initialization was just sugar
[15:27:20] <pnkfelix> Manishearth: yeah sometimes I think I should have put big stars around that part of the blog post
[15:27:39] <pnkfelix> Manishearth: since its illustrating a subtlety that even experts may not be aware of 
[15:27:56] * Manishearth is not an expert
[15:28:09] <Manishearth> last week I discovered the the Struct {...Default()} sugar
[15:28:55] *** Joins: maralla (uid69246@moz-mq40mv.brockwell.irccloud.com)
[15:29:03] *** Joins: davebettin_ (davebettin@moz-hde.5e5.136.67.IP)
[15:29:32] <WindowsBunny> Manishearth: slowpoke
[15:29:47] <Manishearth> hah
[15:32:31] <Manishearth> wait, I don't see its ast representation
[15:32:32] <Manishearth> http://doc.rust-lang.org/syntax/ast/struct.StructDef.html
[15:33:24] <Manishearth> wait nvm
[15:33:27] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[15:33:36] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[15:36:07] *** Joins: O01eg (o01eg@moz-8p1van.34rt.4n8f.2698.2a02.IP)
[15:37:03] <pnkfelix> nmatsakis: I see, yes.  (I am used to assuming that compiler intrinsics do not act like function calls even if they look like them; that's what led me to say "that is to be expected").  But of course you are right that *many* of them are indeed compiled into essentially inlined function calls.
[15:37:28] <pnkfelix> nmatsakis: in any case that is a good point, I will try hacking in another special case for `move_val_init` in the same place.
[15:37:31] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[15:37:42] * pnkfelix wonders if he should have initiated this discussion in #rustc instead. :)
[15:38:45] <Manishearth> WindowsBunny: ..whoa
[15:38:50] <nmatsakis> pnkfelix: yes to all counts
[15:38:53] <Manishearth> I'm really, really stupid
[15:38:54] <Manishearth> https://github.com/rust-lang/rust/commit/a5828ff7b0203ac378974c2d30ed94a14073895a#diff-0de6e63ecfba5c83fb06c9e981f292a6R883
[15:39:03] <Manishearth> WindowsBunny: I was the one who had *documented* that feature in the AST
[15:39:07] <Manishearth> and I somehow forgot
[15:39:35] <WindowsBunny> Manishearth: Okay stupidhearth :D
[15:40:39] *** Quits: laumann (thomas@moz-gqpfnm.science.ku.dk) (Ping timeout: 121 seconds)
[15:41:52] *** Joins: laumann (thomas@moz-gqpfnm.science.ku.dk)
[15:42:00] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[15:43:16] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[15:43:24] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[15:43:35] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[15:43:57] <pnkfelix> nmatsakis: its sort of scary how much code there is in that transmute intrinsic snippet you linked.  I.e. you'd think there'd be less surrounding boilerplate to set up the invocation of `expr::trans_into` ...
[15:44:57] <nmatsakis> pnkfelix: yes, I think it's beacuse of the context from the call, but still
[15:45:04] <nmatsakis> pnkfelix: might be we want to hook in at an earlier step
[15:45:22] <nmatsakis> pnkfelix: I thought the same when I saw it though!
[15:45:29] <pnkfelix> though maybe much of that is for the purposes of making the types work out, and thus hopefully wont arise in the same way for `move_val_init` ...?
[15:45:31] <pnkfelix> nmatsakis:  though maybe much of that is for the purposes of making the types work out, and thus hopefully wont arise in the same way for `move_val_init` ...?
[15:45:38] <pnkfelix> (doh sorry)
[15:47:14] <nmatsakis> pnkfelix: got me
[15:47:19] <nmatsakis> pnkfelix: I didn't look that closely
[15:47:37] <pnkfelix> nmatsakis: I'll look into it.  Looks like fun.
[15:50:01] <doener> pnkfelix: out of curiosity, is that branch somewhere public?
[15:51:08] *** Quits: nicknikolov (nicknikolov@moz-ko7.r6m.215.90.IP) (Connection closed)
[15:51:47] <pnkfelix> doener: yeah, let me just push the latest commit that adds some stats
[15:52:01] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[15:52:17] <pnkfelix> doener: nmatsakis: https://github.com/pnkfelix/rust/tree/fsk-trans-nzmove-mac
[15:52:28] <doener> nmatsakis: what do you mean by "let LLVM inline it" WRT intrinsic calls? We're translating all intrinsics in-place AFAIK
[15:52:49] <nmatsakis> doener: pehaps I am out of date; I thought we still generated a C function in some cases?
[15:52:55] <nmatsakis> er, an LLVM function
[15:52:57] <nmatsakis> and actually called it
[15:53:14] <nmatsakis> certainly we seem to generate the "structure" of such a fn
[15:53:38] <pnkfelix> we certainly evaluate the inputs from args into llargs, and then uses those llargs in the emitted code
[15:53:52] <pnkfelix> but "let LLVM inline it" may be inaccurate for some cases
[15:54:12] <doener> nmatsakis: we're still doing the "setup" for a function call (as pnkfelix says), but don't emit any call anymore (except for forwarding to llvm intrinsics, of course)
[15:54:17] <nmatsakis> ok
[15:54:17] <pnkfelix> but on the other hand, consider things like memset_intrinsic
[15:54:27] <nmatsakis> doener: good to know
[15:54:33] <pnkfelix> okay, yes, thats an instance of forwarding to llvm intrinsics
[15:54:42] <nmatsakis> it'd probably  be nice to skip the setup?
[15:55:07] <nmatsakis> but maybe it'd be hard(er) to get right semantics sometimes?
[15:56:30] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[15:56:47] <doener> nmatsakis: I briefly looked at that when I started my now stale branch that tried to unify the ABI handling for the various (Rust, Rust-Call, C, ...) ABIs, but I don't recall details anymore
[15:57:13] <pnkfelix> doener: note that the above linked branch has a lot of experimental cruft and various idiocies
[15:57:47] <pnkfelix> doener: (I was delegating much of it's development to my dog who was helping me type, you see...)
[15:57:52] <doener> nmatsakis: function argument handling in particular probably needs a little refactoring to allow calls where rust arguments don't map 1:1 to llvm arguments
[15:57:56] <doener> pnkfelix: :-D
[15:58:15] <pnkfelix> "No Elmo!  Don't bubble-sort!"
[15:58:31] *** Quits: capella-s3 (capella-s3@moz-vcqob4.res.rr.com) (Ping timeout: 121 seconds)
[15:58:41] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[15:58:43] <nmatsakis> don't be down on bubble sort man
[15:58:47] <nmatsakis> except that it's kind of harder to write
[15:58:48] <nmatsakis> than merge sort
[15:58:50] <doener> nmatsakis: for example to be able to pass a slice as two separate arguments... that's something I've planned to do for a loooong time
[15:58:51] *** Joins: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP)
[15:58:58] <nmatsakis> doener: yeah, that whole area of code is kind of a mess
[15:59:15] <nmatsakis> if nothing else the "contract" for the trans_call_Common or whatever is out of this world
[15:59:26] <nmatsakis> and not in a positive way
[15:59:54] *** Quits: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com) (A TLS packet with unexpected length was received.)
[16:00:18] <doener> last blocker for the hackish way to do that is actually UFCS related, where we forget that the first parameter is &self, and that breaks that
[16:02:05] *** Joins: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com)
[16:06:34] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:09:07] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[16:11:04] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[16:11:27] *** Quits: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP) (Connection closed)
[16:11:28] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Connection closed)
[16:11:54] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[16:12:23] *** Joins: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP)
[16:13:22] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Ping timeout: 121 seconds)
[16:13:25] *** Quits: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP) (Connection closed)
[16:13:46] *** Quits: summerlight_ (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[16:14:06] *** Joins: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP)
[16:14:32] *** Quits: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP) (Connection closed)
[16:16:18] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:16:40] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[16:16:50] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[16:19:13] *** Joins: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP)
[16:19:55] *** Joins: summerlight_ (summerlight@moz-99k.2mj.130.121.IP)
[16:19:58] *** Quits: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP) (Connection closed)
[16:20:58] *** Joins: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP)
[16:21:07] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:24:04] *** Quits: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP) (Connection closed)
[16:24:14] *** Quits: summerlight_ (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[16:25:21] <acrichto> klutzy: ah unfortunately I don't think I fully understand the root problem there 
[16:25:39] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[16:25:45] <acrichto> klutzy: I would expect a non-unicode output to be the cause, but it sounded like cmd.exe was silently changing things as well? it wasn't super clear to me...
[16:26:37] *** Joins: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP)
[16:26:47] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:26:50] *** Joins: det (chris@moz-6q2one.lv.cox.net)
[16:27:18] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[16:28:09] <WindowsBunny> If we're piping output from something, then changes to the console should not affect the piped output
[16:28:32] <WindowsBunny> unless for whatever reason that process decides to encode its output in the consoles's code page even if it isn't writing to the console
[16:28:35] <acrichto> WindowsBunny: that's what I would have thought
[16:28:44] <acrichto> it sounded like that wasn't the case though
[16:28:45] <WindowsBunny> and I guess some processes are doing that
[16:28:56] <WindowsBunny> one sec, lemme do some tests
[16:29:02] *** Quits: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP) (Connection closed)
[16:29:13] *** Joins: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP)
[16:32:43] <WindowsBunny> acrichto: Okay, I can confirm that piping output from some processes, the encoding _is_ affected by the current console code page
[16:32:56] <acrichto> wut
[16:33:18] <WindowsBunny> however, when I don't pipe it, and just print directly to the console, it uses unicode regardless
[16:33:57] <WindowsBunny> so we have to make sure the code page is in utf-8 if we want to pipe unicode correctly from certain things
[16:34:28] *** Quits: vmx (vmx@moz-3rq9n0.dip0.t-ipconnect.de) (Quit: Leaving)
[16:34:29] *** Quits: eternaleye (eternaleye@moz-7ps.ehi.245.50.IP) (Ping timeout: 121 seconds)
[16:35:04] <WindowsBunny> acrichto: So now it's a matter of deciding who is responsible for ensuring that code page "{
[16:35:04] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Ping timeout: 121 seconds)
[16:35:40] <acrichto> WindowsBunny: hm ok, thanks for investigating!
[16:35:44] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:35:50] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[16:37:52] *** Quits: larsberg (sid89@moz-1a60qu.0j4i.jtu0.0101.2620.IP) (Quit: )
[16:38:12] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:38:16] <steveklabnik> acrichto: https://github.com/rust-lang/rust/pull/25882#event-317400136 <- it's my own PR!
[16:38:19] <steveklabnik> :)
[16:38:29] <acrichto> steveklabnik: wow
[16:38:32] <steveklabnik> <3
[16:38:32] <acrichto> I got this
[16:38:43] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[16:38:51] *** Joins: eternaleye (eternaleye@moz-7ps.ehi.245.50.IP)
[16:39:46] <WindowsBunny> acrichto: Is it possible to add an option to the msvc rustc to link against the static CRT instead of the dynamic CRT?
[16:40:11] <WindowsBunny> aka libcmt.lib
[16:40:14] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[16:40:23] <acrichto> WindowsBunny: perhaps! I don't know enough about it to know what that would entail
[16:41:21] *** Quits: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP) (Connection closed)
[16:41:44] <WindowsBunny> acrichto: it should be as simple as passing libcmt instead of msvcrt in the linking phase
[16:43:19] <acrichto> WindowsBunny: hm I forget if we explicitly do that...
[16:43:32] <acrichto> ah we do :\
[16:43:44] *** Joins: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP)
[16:44:31] *** Quits: Havvy (Havvy@moz-2v0ao2.5euu.k9bm.0007.2601.IP) (Connection closed)
[16:44:32] *** Quits: capella-s3 (capella-s3@moz-rbe.30o.87.66.IP) (Connection closed)
[16:46:36] <WindowsBunny> acrichto: such an option for static/dynamic CRT could also one day grow a third option, to not use the CRT at all :D
[16:46:56] <acrichto> WindowsBunny: hm yeah I'm curious if we don't link that in how many undefined symbols we have
[16:47:02] <acrichto> if it's like all the libm symbols there may just be no hope
[16:47:33] *** Quits: laumann (thomas@moz-gqpfnm.science.ku.dk) (Ping timeout: 121 seconds)
[16:49:10] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:49:34] *** Joins: laumann (thomas@moz-1f0.hq0.225.130.IP)
[16:49:41] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[16:50:17] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:50:29] <WindowsBunny> acrichto: here's all the functions from msvcrt.dll we currently link to https://gist.github.com/94f19f4a73660218793b
[16:51:12] <WindowsBunny> some of that might be due to mingw's crt0.o stuff which does some of its own funky initialization
[16:52:13] <acrichto> WindowsBunny: hm there's no way we depend on write/printf
[16:52:23] <acrichto> I would be super surprised if that still existed
[16:52:41] <acrichto> same with that osfhandle stuff
[16:52:49] <WindowsBunny> acrichto: this is what depends.exe is telling me
[16:53:43] *** Joins: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP)
[16:53:59] <WindowsBunny> so it means all calls into msvcrt.dll from the .exe
[16:54:13] <WindowsBunny> regardless of whether they are from rust itself or statically linked C
[16:54:48] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[16:55:40] <acrichto> WindowsBunny: hm, let me check what shows up for a msvc bin
[16:55:57] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[16:56:21] <WindowsBunny> acrichto: Actually, it turned out I was looking at an old binary, look at the functions we lost recently :D https://gist.github.com/retep998/94f19f4a73660218793b/revisions
[16:57:27] <acrichto> WindowsBunny: that looks more correct!
[16:57:32] <acrichto> still suspicious though
[16:58:20] <WindowsBunny> hmmm, I should totally get IDA and decompile this thing
[16:59:38] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:00:08] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[17:00:26] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:00:47] <sfackler> WindowsBunny: eternaleye found some SO post that implied that the timeout issue may be a weird interaction with antiviruses or something?
[17:01:48] <sfackler> acrichto: seem reasonable to backport the recvfrom signature fix to beta?
[17:01:56] <WindowsBunny> sfackler: Can you give me a test so I can determine whether it affects my PC as well?
[17:02:13] <WindowsBunny> sfackler: Do we call recvfrom in existing code?
[17:02:16] <acrichto> sfackler: that'd just be a new release of liblibc
[17:02:30] <acrichto> sfackler: oh right it affects things today
[17:02:34] <acrichto> sfackler: yeah seems plausible
[17:02:35] <WindowsBunny> It would only matter for beta if there was existing code using it
[17:03:14] <WindowsBunny> which apparently we already do
[17:03:27] <sfackler> WindowsBunny: yeah, UdpSocket::recv_from
[17:03:59] <WindowsBunny> https://github.com/rust-lang/rust/blob/master/src/libstd/sys/common/net.rs#L394
[17:04:06] <WindowsBunny> Fortunately nobody uses Udp
[17:04:10] <WindowsBunny> so nobody noticed it yet
[17:04:31] <sfackler> WindowsBunny: if you take this branch and remove the cfg!(windows) || from the tests here: https://github.com/rust-lang/rust/pull/25818/files#diff-8e730a26d74a9a3f4b7e669fda35ca02R402
[17:05:01] <sfackler> a 10ms timeout translated to ~510ms, and a 700ms timeout translated to ~1200ms
[17:05:05] <WindowsBunny> sfackler: You expect me to build an entire rust just to test? D:
[17:05:13] <sfackler> :P
[17:05:22] <WindowsBunny> sfackler: I want a convenient binary
[17:05:47] <WindowsBunny> or a single .rs I can build and run
[17:05:56] <sfackler> i'll try to make one tonight
[17:06:26] <sfackler> but it should just be make a TcpStream, use setsockopt and SO_RCVTIMEO and then see how long it takes a recv call to return
[17:06:33] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[17:06:47] *** chmanchester|afk is now known as chmanchester
[17:10:22] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[17:10:30] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[17:10:35] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:11:06] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[17:14:26] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:14:29] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Ping timeout: 121 seconds)
[17:15:01] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:16:18] *** Quits: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP) (Connection closed)
[17:17:42] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[17:19:10] *** Joins: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP)
[17:21:26] <acrichto> sfackler: so you'll find this interesting, recently crates.io response times have skyrocketd: https://i.imgur.com/ibBy9g2.png
[17:21:33] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:21:35] <acrichto> I didn't realize this until about 20 minutes ago, and it left me very perplexed
[17:21:49] <acrichto> and I suspect something about the db just taking forever, which was very perplexing
[17:22:00] <acrichto> so I ran a few queries myself and they were all super speedy
[17:22:04] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[17:22:10] <sfackler> can you turn on slow query logging?
[17:22:11] <acrichto> and then I realized I did a redeploy of crates.io about the time the response times increased
[17:22:18] <acrichto> it looked like all queries were super fast
[17:22:29] <acrichto> but it turns out crates.io was linked against bufstream 1.0
[17:22:33] <sfackler> ha!
[17:22:34] <acrichto> which had the bug where it didn't actually buffer anything
[17:22:44] <acrichto> so... goes to show that rust-postgres needs buffering lol
[17:22:48] <acrichto> or else it dies horribly
[17:22:54] <acrichto> or rather is just super duper slow
[17:22:59] <sfackler> that is in fact why I wrote Buffered{Reader,Writer,Stream} :P
[17:23:04] <acrichto> lol
[17:23:19] * acrichto should have seen this much sooner than he did
[17:24:45] *** Quits: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP) (Connection closed)
[17:24:48] *** Joins: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP)
[17:25:06] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[17:25:12] *** Joins: James (quassel@moz-q6malq.range86-148.btcentralplus.com)
[17:25:16] <XMPPwocky> r? http://imgur.com/dcT0Z34
[17:25:16] <XMPPwocky> err
[17:25:30] <XMPPwocky> https://github.com/rust-lang/rust/pull/25817
[17:26:07] <acrichto> XMPPwocky: could you squash some commits together as well?
[17:26:31] <XMPPwocky> okay
[17:28:15] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: Textual IRC Client: www.textualapp.com)
[17:28:23] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[17:28:45] *** Quits: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP) (Connection closed)
[17:28:54] <XMPPwocky> you mean just w/ rebase? /me isn't particularly familiar with git
[17:29:34] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:29:49] <acrichto> XMPPwocky: nah leaving out the rebase is fine
[17:29:57] <acrichto> `git rebase -i` should allow you to squash commits together
[17:30:17] *** Joins: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP)
[17:30:31] <XMPPwocky> the issue is there are other commits in between
[17:31:19] *** Quits: tbelaire (tbelaire@moz-e3f93l.csclub.uwaterloo.ca) (Ping timeout: 121 seconds)
[17:31:24] <acrichto> XMPPwocky: sure, but the interactive rebase allows you to reorder commits
[17:31:28] <acrichto> and delete the merge commits for example
[17:31:46] <XMPPwocky> ah
[17:32:30] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:32:52] *** Quits: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP) (Connection closed)
[17:33:01] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[17:34:17] *** Joins: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP)
[17:35:40] *** Joins: capella-s32 (capella-s3@moz-4cb.rdl.59.24.IP)
[17:35:40] *** Quits: capella-s3 (capella-s3@moz-t1o.a68.87.66.IP) (Connection closed)
[17:39:39] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[17:40:46] *** Quits: _Vi (vi@moz-bbs.vhj.131.104.IP) (Ping timeout: 121 seconds)
[17:40:47] *** Quits: laumann (thomas@moz-1f0.hq0.225.130.IP) (Ping timeout: 121 seconds)
[17:42:03] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[17:42:06] *** Quits: bdero1 (bran@moz-216hqv.oo5r.e4su.0006.2601.IP) (Quit: Leaving.)
[17:42:22] *** Quits: Luqman (laden@moz-bjmiqc.csclub.uwaterloo.ca) (Ping timeout: 121 seconds)
[17:42:42] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[17:42:42] *** Joins: bdero1 (bran@moz-lbs.91h.47.73.IP)
[17:43:16] *** Quits: bdero1 (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[17:43:17] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[17:43:52] *** Joins: bdero1 (bran@moz-lbs.91h.47.73.IP)
[17:43:52] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Connection reset by peer)
[17:43:56] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:44:08] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:44:26] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[17:46:26] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[17:46:26] *** Quits: bdero1 (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[17:47:01] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[17:47:01] *** Joins: bdero1 (bran@moz-lbs.91h.47.73.IP)
[17:47:36] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[17:47:36] *** Quits: bdero1 (bran@moz-lbs.91h.47.73.IP) (Connection reset by peer)
[17:48:11] *** Joins: bdero1 (bran@moz-lbs.91h.47.73.IP)
[17:48:11] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[17:48:15] <SimonSapin> I just got my Rust 1.0 shirt in the mail <3
[17:48:46] *** Quits: bdero1 (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[17:48:46] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[17:48:49] *** Joins: laumann (thomas@moz-1f0.hq0.225.130.IP)
[17:49:21] *** Joins: bdero1 (bran@moz-lbs.91h.47.73.IP)
[17:49:21] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[17:51:01] <rovar> nmatsakis, if you're not busy, I think I need your help with the borrow checker. I think its a bug, but I'm probably doing something dumb. 
[17:51:41] <nmatsakis> rovar: ok
[17:52:06] *** Joins: Luqman (laden@moz-bjmiqc.csclub.uwaterloo.ca)
[17:52:42] <rovar> in https://github.com/rrichardson/reactor/blob/master/examples/echo.rs#L45-L47
[17:53:07] <rovar> I have a closure, declared at line 49 whose lifetime is tied to r.  the boxed closure gets stored in a struct stored by r
[17:53:24] <rovar> the problem is that it says that r does not live long enough.  
[17:53:36] <rovar> if I declare r at the top, it says that client/server do not live long enough
[17:53:44] <rovar> (which is probably correct)
[17:54:03] *** Quits: maralla (uid69246@moz-mq40mv.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[17:54:13] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[17:54:23] *** Joins: tbelaire (tbelaire@moz-e3f93l.csclub.uwaterloo.ca)
[17:54:31] <nmatsakis> rovar: can you point me at def'n of listen()
[17:54:32] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Ping timeout: 121 seconds)
[17:54:52] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:55:14] <rovar> nmatsakis, https://github.com/rrichardson/reactor/blob/master/src/reactor.rs#L78
[17:55:23] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[17:56:10] <rovar> would it be that the lifetime of the closure is forcing r's lifetime to need to be the entirety of main() ?
[17:56:14] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[17:58:15] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[17:58:22] <nmatsakis> rovar: I think it may have to do with the dropck, but I am not sure. let me see if I can reproduce the error, one sec
[17:58:43] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[17:59:33] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[17:59:56] <rovar> fundamentally,  r does depend on server and client, since its closures reference them.  But client/server shouldn't depend on r, which is what appears to be happening, but it may not be. 
[18:01:31] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[18:01:42] *** Joins: Rym (y@moz-h2o.mso.205.31.IP)
[18:02:14] <rovar> the only reason I have explicit lifetimes in there at all is so I can constrain the lifetime of the Box<FnMut  so its allowed to reference client/server
[18:02:30] <rovar> if there is another way to do that, then all the better
[18:02:38] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[18:02:40] *** rkruppe_ is now known as rkruppe
[18:03:01] <nmatsakis> rovar: ok so
[18:03:11] <nmatsakis> rovar: I have NO idea why that error is getting printed, but I think I know what your problem is
[18:03:19] <nmatsakis> rovar: this is a GREAT case for me to dig into those diagnostics :)
[18:03:24] <nmatsakis> rovar: (something I had meant to do by 1.0 -- ah well)
[18:03:46] <nmatsakis> rovar: so this is my reduction of your problem http://is.gd/oDK41V
[18:03:55] <nmatsakis> rovar: as you can see it seems to fail in the same way, right?
[18:04:40] <rovar> yessir
[18:05:01] <nmatsakis> rovar: anyway, if you modify those methods to be &self instead of &mut self, it works: http://is.gd/hrpDjV
[18:05:13] <nmatsakis> now this is probably not what you wanted...but your original setup isn't valid in any case...
[18:05:24] <nmatsakis> because listen is mutablly borrowing `r` 
[18:05:28] <nmatsakis> and so is the closure 
[18:05:37] <nmatsakis> but there is a workaround, let me try it
[18:05:50] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:05:52] <rovar> oic
[18:06:21] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[18:06:32] <nmatsakis> rovar: http://is.gd/Dz63j7
[18:06:35] <nmatsakis> the usual thing in this scenario
[18:06:36] <acrichto> sfackler: buffering ftw: https://i.imgur.com/3NLg9eE.png
[18:06:40] <nmatsakis> rovar: is to have the fn pass `self` back to the closure
[18:06:50] <nmatsakis> rovar: effectively this proves to the compiler that you are threading control through in a linear fashion
[18:07:04] <nmatsakis> rovar: and in particular you couldn't pass `self` to the clsoure if (for example) you had a borrow on some of self's fields
[18:07:25] <nmatsakis> which is what the compiler is concerned about, because then both the closure and listen() could borrow from `self`
[18:07:29] <nmatsakis> and think that they have sole access
[18:07:41] * nmatsakis anthropomorphizes like mad
[18:08:21] <nmatsakis> rovar: anyway, the error is weird, though I can sort of imagine how it happens, but that's the fundamental problem -- I guess that somehow it's trying to extend the borrow too far to make it all workout or something, I'd have to dig through the logs a bit to figure out why that particular error
[18:08:27] <sfackler> acrichto: so how bout that BufStream stabilization? (cough cough)
[18:08:36] <acrichto> sfackler: lol
[18:08:53] <nmatsakis> rovar: hope that helps
[18:09:26] <rovar> nmatsakis, holy mother of
[18:09:39] <rovar> so I just comment out  r.timeout_conn and it works
[18:09:54] <rovar> that makes total sense. I was looking somewhere completely different
[18:09:55] <nmatsakis> rovar: right, that would do it too since then closure is not using `r`
[18:09:57] *** Quits: laumann (thomas@moz-1f0.hq0.225.130.IP) (Ping timeout: 121 seconds)
[18:10:09] *** Joins: laumann (thomas@moz-1f0.hq0.225.130.IP)
[18:10:30] <rovar> yea.. the closure shouldn't use r.. I'll just need a way to thread in ReactorCtrl to the callback, like you mentioned.. I can pull that off. 
[18:10:52] <nmatsakis> rovar: I'll have to file an issue; as I said, great example of a terrible terrible error msg :)
[18:11:07] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[18:11:28] <rovar> happy to help :)
[18:11:42] <rovar> and thanks
[18:12:29] *** Joins: aepsil0n (eduard@moz-pfjhmu.mullvad.net)
[18:12:40] *** Quits: aepsil0n (eduard@moz-pfjhmu.mullvad.net) (Quit: Leaving.)
[18:13:16] <nmatsakis> rovar: https://github.com/rust-lang/rust/issues/25885 :)
[18:15:16] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Ping timeout: 121 seconds)
[18:16:48] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:17:18] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[18:17:42] *** Quits: laumann (thomas@moz-1f0.hq0.225.130.IP) (Ping timeout: 121 seconds)
[18:17:47] *** Joins: laumann (thomas@moz-1f0.hq0.225.130.IP)
[18:21:00] *** Joins: pauls (pauls@moz-e5p333.ccs.neu.edu)
[18:22:28] <acrichto> good lord rust is fast
[18:23:18] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[18:24:33] <WindowsBunny> acrichto: what makes you think that
[18:25:32] <acrichto> WindowsBunny: I'm removing millions of operations being run in cargo when building servo, and I'm going from like 5s runtimes to 4s
[18:25:54] <XMPPwocky> is I-amazingly-bad-error-message a thing
[18:26:02] <Manishearth> if not it should be
[18:26:13] <nmatsakis> actually,
[18:26:22] <nmatsakis> there was an existing issue I should have added that too, probably
[18:27:13] <Manishearth> ooo new virtual structs post
[18:27:15] *** Quits: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de) (Quit: Bye)
[18:27:27] <Manishearth> if only my internet wasn't so sucky
[18:27:46] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:28:24] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[18:29:24] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[18:29:38] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[18:31:47] <WindowsBunny> acrichto: I'm decompiling a rust program to see what calls which msvcrt function :D
[18:37:26] <WindowsBunny> It's a lot of mingw :|
[18:37:28] *** Joins: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP)
[18:38:24] *** Quits: laumann (thomas@moz-1f0.hq0.225.130.IP) (Quit: leaving)
[18:38:43] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:39:14] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[18:39:42] <acrichto> WindowsBunny: you should be able to get a MSVC build pretty quickly
[18:39:56] <acrichto> it just requires the fix-msvc PR I have
[18:40:29] <WindowsBunny> ooo
[18:40:34] <WindowsBunny> I found some stuff that is jemalloc's faul
[18:40:35] <WindowsBunny> t
[18:41:07] <acrichto> oh wow I thought we didn't use jemalloc on windows
[18:41:15] <acrichto> guess that's just msvc
[18:41:41] <Manishearth> nmatsakis: the link around `[been proposals][324] along these lines before` is broken
[18:42:15] <WindowsBunny> acrichto: yep, for the gnu version we use jemalloc
[18:42:50] *** Joins: Havvy (Havvy@moz-2v0ao2.5euu.k9bm.0007.2601.IP)
[18:43:21] *** Joins: harrisonclarke (harrisoncla@moz-mh0.9rm.212.173.IP)
[18:44:24] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[18:44:24] *** ChanServ sets mode: +o pcwalton
[18:44:57] <XMPPwocky> okay, i rebased everything into one commit, although the PR now looks really funky on github: https://github.com/rust-lang/rust/pull/25817
[18:45:44] <WindowsBunny> acrichto: I found printf in __report_error
[18:45:53] <cmr> XMPPwocky: it appears you accidentally during the rebase.
[18:45:55] <WindowsBunny> fwrite("Mingw-w64 runtime failure:\n", 1u, 0x1Bu, (FILE *)__iob[0]._ptr + 2);
[18:45:57] <WindowsBunny> :P
[18:46:01] <XMPPwocky> cmr: i accidentally?
[18:46:11] <cmr> Look at the "76" commits.
[18:46:21] <acrichto> WindowsBunny: wheeeeee
[18:46:31] <WindowsBunny> vfprintf((FILE *)__iob[0]._ptr + 2, a1, va);
[18:46:48] <WindowsBunny> Yeah, on mingw we're tied to the CRT
[18:46:58] <WindowsBunny> With msvc though, we might be able to get away with it
[18:47:09] <XMPPwocky> cmr: am I supposed to be seeing something?
[18:47:17] <cmr> XMPPwocky: shouldn't there only be one commit?
[18:47:17] <acrichto> WindowsBunny: I can ship you a hello world foo.exe for msvc?
[18:47:24] <acrichto> WindowsBunny: if you want to inspect it
[18:47:27] <WindowsBunny> acrichto: sure!
[18:47:31] <XMPPwocky> cmr: yeah, exactl
[18:47:32] *** Joins: willem (willem@moz-facs2s.dynamic.upc.nl)
[18:47:34] <XMPPwocky> thta's why i'm confused
[18:47:41] <acrichto> WindowsBunny: hm, what's the easiest way to upload a binary somewhere on windows?
[18:47:46] <XMPPwocky> i just moved all the commits together, and fixup-d them
[18:48:00] <Zoxc> acrichto: IE?
[18:48:08] <WindowsBunny> acrichto: mega?
[18:48:08] <WindowsBunny> :D
[18:48:12] <oli_obk> XMPPwocky: you chose the wrong base commit to rebase on
[18:48:39] <ytain> acrichto you have to zip it first with a password before uploading on any cloud sharing
[18:48:41] <WindowsBunny> acrichto: I use ShareX to easily share anything
[18:49:00] <acrichto> WindowsBunny: http://speedy.sh/uHGzF/foo.exe
[18:49:10] * acrichto can't even copy/paste to/from the windows vm
[18:49:12] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:49:16] <WindowsBunny> oh boy
[18:49:19] <WindowsBunny> what a shady download site
[18:49:32] <acrichto> oh wow that is shady
[18:49:39] <acrichto> wow what is going on here
[18:49:48] <XMPPwocky> oli_obk: aha. what's the "right" commit?
[18:49:52] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[18:49:55] <WindowsBunny> acrichto: um
[18:49:55] <WindowsBunny> wow
[18:49:56] <XMPPwocky> and how can i get back to a reasonable state
[18:50:05] <WindowsBunny> acrichto: It doesn't actually link to msvcrt.dll at all :|
[18:50:17] <acrichto> WindowsBunny: that seems... good?
[18:50:24] <oli_obk> XMPPWocky: do a fetch on the official repo (usually "origin"), then rebase on "origin/master"
[18:50:32] <nmatsakis> Manishearth: oh thanks
[18:50:58] <XMPPwocky> okay
[18:51:02] <WindowsBunny> acrichto: Actually, its probably due to link.exe doing really good deadcode elimination :P
[18:51:15] <WindowsBunny> like, really good
[18:51:25] <acrichto> oh yay!
[18:51:36] <WindowsBunny> acrichto: Here's all the actual imports we use (all from kernel32) https://gist.github.com/4ed7a43bbcec9676e0e3
[18:51:52] <WindowsBunny> So msvc is looking pretty optimistic
[18:52:08] <acrichto> whoa is malloc wired to HeapAlloc?
[18:52:14] <WindowsBunny> yes
[18:52:15] <cmr> yeah
[18:52:18] *** Quits: capella-s32 (capella-s3@moz-4cb.rdl.59.24.IP) (Ping timeout: 121 seconds)
[18:52:18] <acrichto> fascinating
[18:52:30] <WindowsBunny> thats all malloc is
[18:52:34] <WindowsBunny> HeapAlloc to a default heap
[18:52:52] <acrichto> I'm just surprised the symbol-wiring-up works like that
[18:53:25] <WindowsBunny> acrichto: Are you sure you're dynamically linking to msvcrt.lib?
[18:53:43] <acrichto> WindowsBunny: I'm sure we're linking to msvcrt.lib
[18:53:50] <acrichto> I don't know of a way to dynamically link or statically link
[18:53:55] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[18:54:00] <WindowsBunny> msvcrt.lib is the dynamically linked one
[18:54:00] <acrichto> b/c I thought both had the same file, so you get whatever someone arranged the .lib to do
[18:54:08] <acrichto> then yes, we're dynamic
[18:54:09] *** Quits: poorman (poorman@moz-sdl0oq.res.rr.com) (A TLS packet with unexpected length was received.)
[18:54:10] <WindowsBunny> and libcmt.lib is the statically linked one
[18:54:23] <WindowsBunny> also lol @ IsDebuggerPresent
[18:54:29] <acrichto> WindowsBunny: https://github.com/rust-lang/rust/blob/master/src/liblibc/lib.rs#L153-L157
[18:54:37] <WindowsBunny> acrichto: The thing is, a .lib can actually have a mix of dynamic and static linked stuff
[18:55:08] <WindowsBunny> a dynamically linked .lib is really a bunch of statically linked stubs :P
[18:55:36] <acrichto> hm makes sense
[18:55:41] <WindowsBunny> okay, time to do some more in-depth analysis!
[18:56:10] *** Joins: poorman (poorman@moz-sdl0oq.res.rr.com)
[18:57:39] *** Quits: Rym (y@moz-h2o.mso.205.31.IP) (Ping timeout: 121 seconds)
[18:57:47] <WindowsBunny> acrichto: I think malloc is being statically linked
[18:58:03] <XMPPwocky> welp, now everything's ruined
[18:58:21] <cmr> XMPPwocky: I suggest cherry-picking the relevant commit onto a new branch.
[18:58:34] <acrichto> WindowsBunny: ah interesting, is it just a tiny stub to call HeapAlloc?
[18:59:31] <WindowsBunny> acrichto: "tiny stub" http://i.imgur.com/Vc1cubN.png
[18:59:33] *** Quits: O01eg (o01eg@moz-8p1van.34rt.4n8f.2698.2a02.IP) (Client exited)
[19:00:00] *** Quits: Quxxy (chatzilla@moz-efh10q.internode.on.net) (Ping timeout: 121 seconds)
[19:00:12] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:00:40] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[19:01:16] <acrichto> er...
[19:01:21] <WindowsBunny> its not tiny
[19:01:28] <WindowsBunny> its an actual function with branches
[19:01:38] <WindowsBunny> which ends up calling HeapAlloc
[19:02:10] <acrichto> ah well it has to sdo some translation which makes sense
[19:02:14] <acrichto> b/c the arguments are different
[19:02:33] <WindowsBunny> still, its a statically linked function
[19:02:38] <WindowsBunny> there's a ton of statically linked stuff
[19:03:01] <acrichto> seems not bad/
[19:03:03] <acrichto> ?*
[19:03:17] <XMPPwocky> https://github.com/rust-lang/rust/pull/25817 okay i think this works?
[19:03:34] *** Joins: lorenzb (lorenzb@moz-vp0hu9.ethz.ch)
[19:03:34] <WindowsBunny> acrichto: Here's a list of all the symbols inside foo.exe https://gist.github.com/dea25339f11d03ab52da
[19:04:10] <XMPPwocky> oli_obk: thanks for the help
[19:04:18] <acrichto> well then
[19:04:47] <WindowsBunny> the sub_ stuff is all the rust functions :P
[19:04:48] *** Joins: JuggleTux (tux@moz-ho0t1f.adslplus.ch)
[19:04:53] <WindowsBunny> because no debuginfo to tell their names
[19:05:23] *** Quits: harrisonclarke (harrisoncla@moz-mh0.9rm.212.173.IP) (Connection closed)
[19:05:46] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:06:07] <WindowsBunny> >If you link your program from the command line without a compiler option  that specifies a C run-time library, the linker will use LIBCMT.LIB.
[19:06:43] <WindowsBunny> hmm, maybe the linker is using libcmt.lib
[19:06:58] <XMPPwocky> acrichto: i don't think https://github.com/bor is going to merge that :P
[19:07:31] <acrichto> oops
[19:09:14] *** Quits: ytain (ytain@moz-ffpck2.dsl.teksavvy.com) (Quit: Textual IRC Client: www.textualapp.com)
[19:10:28] <WindowsBunny> acrichto: Yeah, I'm fairly convinced libcmt.lib is being linked somehow
[19:11:07] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:11:38] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[19:11:50] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Quit: Leaving)
[19:11:52] *** Joins: eerie (eerie@moz-ja0t6l.red.bezeqint.net)
[19:12:01] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[19:12:44] <WindowsBunny> Which is totally fine by me
[19:16:01] *** Quits: eerie (eerie@moz-ja0t6l.red.bezeqint.net) (Ping timeout: 121 seconds)
[19:17:31] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[19:17:33] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[19:17:56] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[19:19:57] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[19:21:32] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[19:22:05] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:22:13] <bluss> steveklabnik: I've poisoned your rollup.  #25651 needs to go, it won't pass tests
[19:22:39] <bluss> but it found a bug
[19:22:44] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[19:24:07] <steveklabnik> aww
[19:24:10] <steveklabnik> okay
[19:24:44] <bluss> Sorry. It failed legitimately on the first bors run (but on 32-bit, I didn't test that)
[19:24:52] <steveklabnik> :)
[19:24:53] <steveklabnik> it happens
[19:27:10] <Manishearth> steveklabnik: btw, if I want to upstream that refcell post, any pointers (hah!) on where it would fit, and how I should write it?
[19:27:17] <steveklabnik> hehe
[19:27:22] <steveklabnik> sooooo
[19:27:28] <steveklabnik> it would fit in effective rust i guess
[19:27:39] <steveklabnik> well
[19:27:42] *** Quits: munksgaard (munksgaard@moz-vj4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[19:27:46] <steveklabnik> which one is this again? haven't you written two lately?
[19:27:50] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Quit: Leaving)
[19:27:54] <Manishearth> I've written a bunch lately :p
[19:28:01] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[19:28:08] <Manishearth> http://manishearth.github.io/blog/2015/05/27/wrapper-types-in-rust-choosing-your-guarantees/
[19:28:35] <Manishearth> Queued: one on Send/Sync, one on rust-gc's design, and some non-rust ones
[19:28:47] <steveklabnik> yeah, this was the one i was thinking about
[19:28:50] <XMPPwocky> what is it with Octopress and interesting rust blog posts
[19:29:32] <steveklabnik> yeah, it would make sense as an effective rust chapter. that's what these kinds of things are. wanna get burntsushi 's error post in there too
[19:29:38] <Manishearth> XMPPwocky: I think the interesting rust blog posts inspired me to move to octopress.
[19:29:45] <Manishearth> wysiwyg blogger sucks a lot
[19:30:03] <XMPPwocky> maybe i'll try it out
[19:30:19] <Manishearth> I'd wanted to move a lot, but I couldn't find any jekyll theme I liked, but I realized I liked the octopress default a lot
[19:30:53] <Manishearth> steveklabnik: any ideas on structure? the current one sort of rambles
[19:31:08] <steveklabnik> sort of rambling is kinda okay
[19:31:11] <Manishearth> (as do all my blog posts)
[19:31:16] <steveklabnik> i can't say a whole lot more right now
[19:31:19] <Havvy> !error
[19:31:24] <steveklabnik> but might be doing some heavy editing in the near future
[19:31:25] <steveklabnik> ;)
[19:31:28] <Manishearth> steveklabnik: hah
[19:31:31] <Havvy> Err right, I have !error as a command, no so factoids for it.
[19:31:31] <Manishearth> sekrit plans
[19:31:39] <Manishearth> Rust 2.0 = Go confirmed
[19:31:53] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (Connection closed)
[19:32:17] <Manishearth> steveklabnik: So what parts should I focus on improving/rewriting/fixing while porting it?
[19:32:27] * Havvy wonders if it'd be okay to just transplant a blog post into the book wholesale with a disclaimer that the chapter was written originally as a blog post?  :P
[19:32:38] <steveklabnik> Havvy: i've done it before hehe
[19:32:56] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[19:33:03] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:33:14] <steveklabnik> lemme think Manishearth . i'll have to read it again too. but realistically, we can probably just import it basically wholesale
[19:33:22] <WindowsBunny> acrichto: Should I open an issue to investigate how the CRT is being linked, or just add it to the msvc metabug?
[19:33:34] <Manishearth> steveklabnik: okay, I'll make a PR and then keep pinging you till you review it -- sounds good? :P
[19:33:40] <steveklabnik> sure :)
[19:33:42] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[19:34:00] <Manishearth> steveklabnik: I guess all the non-doc.r-l.o links should go away
[19:34:03] <Manishearth> and the footnotes
[19:34:09] <Manishearth> I miss my footnotes
[19:34:29] <Havvy> Manishearth:  Since I suggested incorporating it into the Rust Book when I first saw it, am I the inspiration for your current goal, or would you have been doing this anyways?
[19:34:32] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[19:34:41] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[19:35:06] <Manishearth> Havvy: You were the fourth person to do so, which made me finaly think that perhaps it was something I should do :p
[19:35:22] <Manishearth> There were others on proggit/HN suggesting the same
[19:35:52] <Havvy> Oh, I didn't read the proggit or HN comments. I'll go do that now.
[19:36:02] <pnkfelix> test gh22086
[19:36:02] <[o__o]> overloaded-`box` protocol changes: https://github.com/rust-lang/rust/pull/22086
[19:39:43] <Manishearth> pnkfelix: btw, what does fsk stand for?
[19:39:51] <Manishearth> I see it all over your PRs when doing rollups
[19:40:02] <Manishearth> Felix is Super Kool? :P
[19:40:04] <cmr> Manishearth: his name.
[19:40:24] <Manishearth> oh ... I should have figured that out
[19:40:44] <Manishearth> I thought it stood for feature-something
[19:43:54] <Manishearth> steveklabnik: > After reading this introduction, youâll want to dive into either âLearn Rustâ or âSyntax and Semanticsâ, depending on your preference: âLearn Rustâ if you want to dive in with a project, or âSyntax and Semanticsâ if you prefer to start small, and learn a single concept thoroughly before moving onto the next.
[19:44:13] <Manishearth> shouldn't that bit be mroe prominent somehow?
[19:44:14] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:44:20] <Manishearth> or the posts be reordered to reflect that
[19:44:35] <Manishearth> (I was a bit confused when I saw FFI coming before variable bindings)
[19:44:44] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[19:44:49] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[19:44:52] <eternaleye> Manishearth: Wow, that just vomited the apple symbol everywhere for me
[19:45:01] *** Quits: semarie (semarie@moz-r8s4se.server.torland.is) (A TLS packet with unexpected length was received.)
[19:45:05] <eternaleye> WindowsBunny: Specifically, â<Apple>™ in place of singlequote
[19:45:14] <XMPPwocky> eternaleye: i get an a with a little hat on it, and then "@X" and "@Y" in white background
[19:45:25] <Manishearth> eternaleye: yeah I think I broke encoding somewhere between my terminal, my server, and the screen session
[19:45:26] <WindowsBunny> eternaleye: wut
[19:45:40] <Manishearth> those are smart quotes btw, but they look broken to me too
[19:45:50] <eternaleye> XMPPwocky: Yeah, for me it's a with caret-hat, apple symbol, and TM (though wider than the one I sent, Somehow)
[19:45:57] <WindowsBunny> Manishearth: That's because something along the way didn't handle encoding correctly
[19:46:04] <Manishearth> WindowsBunny: I know
[19:46:08] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[19:46:14] *** rkruppe_ is now known as rkruppe
[19:46:24] <WindowsBunny> Manishearth: I blame it on you being on linux
[19:46:29] <eternaleye> Smart quotes are *evil*
[19:46:55] <eternaleye> Mainly because of the way Windows did them, in that it sticks them into almost-ISO-8859-1
[19:47:08] <eternaleye> And how they asplode when put near unicode
[19:47:09] <Manishearth> WindowsBunny: IIRC my encoding switches between en-IN and en-US
[19:47:17] <XMPPwocky> “smart” quotes
[19:47:28] <Manishearth> WindowsBunny: I blame Windows for smart quotes
[19:47:50] <eternaleye> Agreed
[19:48:17] <eternaleye> Also, Unicode has perfectly good directionalized quotes.
[19:48:31] <steveklabnik> Manishearth: you can't support everyone. people were mad when it was the other way.
[19:48:35] <Manishearth> steveklabnik: ah
[19:48:41] <steveklabnik> syntax and semantics is more reference-y 
[19:48:43] <Manishearth> steveklabnik: I think it should be somehow more explicit though
[19:48:45] <steveklabnik> it kinda has a dual purpose
[19:48:54] <Manishearth> that there are two ways of reading the book
[19:48:58] <steveklabnik> i don't know how to make it more explicit than right in the intro ;)
[19:49:07] <Manishearth> yeah I don't know either :p
[19:49:30] <Manishearth> sorta lazily handing off the problem to you in hopes that you'll figure something out :P
[19:49:50] <Manishearth> Poll: What would you like to know about Send/Sync?
[19:50:23] <Manishearth> And for those who have given intro talks, what are people interested in when it comes to thread safety?
[19:51:30] <Manishearth> (thread safety isn't part of my talks, but *every* talk someone asks me about it and a I do a quick Send intro on the board.)
[19:53:14] *** Quits: det (chris@moz-6q2one.lv.cox.net) (Connection closed)
[19:55:11] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:55:34] *** Joins: semarie (semarie@moz-jgfl05.torservers.net)
[19:55:42] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[19:58:04] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[20:00:00] *** Quits: Defaultti (Defaultti@moz-bmdn13.kapsi.fi) (Quit: Quitting.)
[20:00:29] *** Joins: eibwen (eibwen@moz-4fjp9d.dip0.t-ipconnect.de)
[20:01:06] *** Joins: Defaultti (Defaultti@moz-bmdn13.kapsi.fi)
[20:01:54] *** chmanchester is now known as chmanchester|afk
[20:03:54] *** Joins: sigma (sigma@moz-k1ghg8.range109-153.btcentralplus.com)
[20:06:09] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:06:39] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[20:08:48] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[20:09:15] *** Joins: det (chris@moz-6q2one.lv.cox.net)
[20:10:42] <Havvy> Is there an RFC open about allowing both static and instance methods of the same name?
[20:11:03] *** Quits: semarie (semarie@moz-jgfl05.torservers.net) (Quit: WeeChat 1.1)
[20:12:28] <acrichto> WindowsBunny: adding to the metabug I think is fine for now, it seems like a relatively minor issue 
[20:14:00] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:14:00] *** ChanServ sets mode: +o pcwalton
[20:17:06] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:17:37] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[20:19:33] <WindowsBunny> k
[20:23:27] *** Joins: duesenfranz_ (jona@moz-711djm.tirol.surfer.at)
[20:25:23] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[20:27:17] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[20:28:04] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:28:46] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[20:30:33] *** chmanchester|afk is now known as chmanchester
[20:30:58] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:30:58] *** ChanServ sets mode: +o pcwalton
[20:31:43] *** Joins: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com)
[20:33:10] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:36:26] <steveklabnik> Havvy: we usualyl call them 'associated functions' and 'methods'
[20:36:36] <steveklabnik> though technically they're all associated functions...
[20:36:46] <steveklabnik> but also, no, i don't think so
[20:38:04] <Havvy> Are there any early objections to me opening an RFC to allow that?
[20:38:14] <cmr> Havvy: What is the usecase?
[20:38:31] <cmr> Havvy: UFCS makes this ambiguous, I don't think it would work.
[20:39:03] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:39:12] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:39:40] <Havvy> (From #rust )
[20:39:41] <Havvy> If you want the specific example, Style::bold() should create a new Style with only bold, and `(Style { is_underline: true, .. Style::default() }).bold()` should create a new style that is both bold and underline.  One of them is a static function, the other is a method. But they're both considered methods to impl.
[20:39:43] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[20:40:22] <Havvy> !ufcs
[20:40:23] <rustbot> Universal Function Call Syntax (Type::Method(type)) - https://doc.rust-lang.org/book/ufcs.html | https://github.com/rust-lang/rfcs/blob/master/text/0132-ufcs.md
[20:40:25] *** Joins: O01eg (o01eg@moz-stqs0u.1si9.4n8f.2698.2a02.IP)
[20:40:36] <Havvy> Ah, it would be ambiguous. :S
[20:40:58] <cmr> (And I don't think we would *want* to make it work)
[20:42:46] <geofft> Zoxc: is there a reason signal_handler()'s term() in stack_overflow.rs is a separate function? 
[20:43:06] <Havvy> cmr:  I'll just have to keep that in mind when designing APIs then.
[20:43:18] *** Joins: capella-s3 (capella-s3@moz-vcqob4.res.rr.com)
[20:45:15] *** Joins: genbattle (genbattle@moz-r09mao.xtra.co.nz)
[20:46:28] *** Joins: Guest38 (textual@moz-4hh.6p3.217.74.IP)
[20:49:31] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:49:37] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Quit: Leaving)
[20:49:45] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[20:49:46] *** Joins: larhat (Adium@moz-vlo5br.cable.virginm.net)
[20:50:01] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[20:50:25] *** Quits: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net) (Client exited)
[20:55:56] *** Quits: ctennis (ctennis@moz-7lm.a44.102.99.IP) (Quit: Leaving...)
[20:56:08] *** Joins: larsberg (Adium@moz-kmvlue.cable.rcn.com)
[20:58:29] <Zoxc> geofft: It used to be called twice at some point
[21:00:28] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:01:00] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[21:04:19] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Connection closed)
[21:05:08] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[21:06:33] *** Quits: willem (willem@moz-facs2s.dynamic.upc.nl) (Quit: leaving)
[21:06:48] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[21:06:48] *** Joins: ctennis (ctennis@moz-vcpg3c.in.comcast.net)
[21:07:06] <Manishearth> steveklabnik: btw, many folks have noticed that the online and distributed docs no longer contain the docs for compiler internals (even for nightlies)
[21:07:16] <Manishearth> Is this also the default on a regular doc build?
[21:07:37] <Manishearth> we need docs for libsyntax/librustc for contributing to plugins and the compiler itself
[21:08:03] *** Quits: lorenzb (lorenzb@moz-vp0hu9.ethz.ch) (Quit: Computer went to sleep)
[21:08:17] <Manishearth> We could host the heavy ones separately, and there should be a build option to get them (I want them for Servo)
[21:09:10] <steveklabnik> it was a deliberate decision, yes
[21:09:58] <Manishearth> steveklabnik: so how do we get them now?
[21:11:26] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:11:56] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[21:14:13] <steveklabnik> gotta build them yourself iirc
[21:14:29] <steveklabnik> they were removed because basically they are VERY VERY VERY unstable
[21:14:36] <steveklabnik> and they were polluting search results
[21:15:09] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[21:15:12] <Manishearth> steveklabnik: no, so when I build them myself, do they come automatically or do I need to tell rust I want them?
[21:15:42] <steveklabnik> oh
[21:15:45] <steveklabnik> i see what you're saying
[21:15:50] <steveklabnik> i, uh, have no idea tbh
[21:16:07] <steveklabnik> i would assume that if you wanted the docs for libsyntax you'd just rustdoc src/libsyntax/lib.rs
[21:16:11] <steveklabnik> and then you'd get them
[21:16:16] * steveklabnik is afriad of rustc's makefiles ;)
[21:16:21] <cmr> there's a configure setting for it
[21:16:23] <cmr> let me find it
[21:16:49] <cmr> --enable-compiler-docs
[21:16:54] <cmr> Manishearth: ^
[21:17:00] <Manishearth> ah thanks
[21:17:15] <Manishearth> steveklabnik: also, thoughts of officially hosting a copy of inflated docs?
[21:17:25] <Manishearth> I agree that that crap shouldn't be in the default
[21:17:34] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[21:19:55] * Manishearth considers setting up a GH pages env with rust docs
[21:20:50] <steveklabnik> i am 50/50 on it.
[21:21:05] <Manishearth> hm
[21:21:11] * Manishearth bribes steveklabnik 
[21:21:14] <steveklabnik> i could see maybe, /internals
[21:21:19] <Manishearth> yep
[21:21:20] <steveklabnik> to go with /stable, /nightly and /beta
[21:21:25] <steveklabnik> it's basically just nightly with that flag
[21:21:27] <Manishearth> that's what I was thinking
[21:21:38] <Manishearth> we need not make those every night either
[21:22:23] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:23:04] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[21:26:29] *** Joins: sprocket (Mibbit@moz-juv.9o3.252.72.IP)
[21:27:27] *** Quits: jdm (jdm@moz-1s76ai.dsl.teksavvy.com) (Quit: )
[21:28:49] *** Joins: nodweber (nodweber@moz-knt.fgq.178.5.IP)
[21:28:50] <steveklabnik> i think the windows doc issue is bigger
[21:29:34] <Manishearth> steveklabnik: agreed
[21:29:46] <Manishearth> but we could just have /windows then?
[21:29:55] *** Quits: sprocket (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:30:00] <steveklabnik> heh
[21:32:36] *** Joins: _Vi (vi@moz-bbs.vhj.131.104.IP)
[21:33:21] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:33:51] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[21:39:55] *** Quits: sigma (sigma@moz-k1ghg8.range109-153.btcentralplus.com) (Ping timeout: 121 seconds)
[21:44:39] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:45:17] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[21:47:56] *** Quits: larsberg (Adium@moz-kmvlue.cable.rcn.com) (Quit: Leaving.)
[21:51:00] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[21:52:20] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[21:54:07] <WindowsBunny> please windows docs
[21:54:19] <cmr> that'd be really useful for me at least.
[21:55:36] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:56:07] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[21:56:17] *** Joins: dinfuehr (dinfuehr@moz-4fk061.highway.telekom.at)
[22:00:32] *** Joins: mib_t5dfpg (Mibbit@moz-juv.9o3.252.72.IP)
[22:00:52] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[22:01:12] *** Quits: eibwen (eibwen@moz-4fjp9d.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[22:02:06] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[22:02:16] *** rkruppe_ is now known as rkruppe
[22:02:33] *** Quits: mib_t5dfpg (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:06:34] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:07:05] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[22:10:24] <Manishearth> acrichto: why is Vec Sync?
[22:10:50] <sfackler> Why wouldn't it be?
[22:11:04] <Manishearth> oh nvm mutation
[22:11:08] <Manishearth> got it
[22:12:22] <mrmonday> Manishearth: ping? may I pm you?
[22:13:04] <Manishearth> sure
[22:13:25] * Manishearth ponders why Cell is not Sync
[22:13:54] <sfackler> can't atomically set an arbitrarily large type
[22:13:57] <sfackler> or get
[22:14:06] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[22:14:16] <Manishearth> oh right
[22:14:18] <Manishearth> thought so
[22:14:30] *** Quits: duesenfranz_ (jona@moz-711djm.tirol.surfer.at) (Client exited)
[22:17:32] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:18:12] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[22:25:31] *** Quits: Havvy (Havvy@moz-2v0ao2.5euu.k9bm.0007.2601.IP) (Connection closed)
[22:25:49] *** Quits: nodweber (nodweber@moz-knt.fgq.178.5.IP) (A TLS packet with unexpected length was received.)
[22:26:08] *** Joins: Havvy (Havvy@moz-epv20b.wa.comcast.net)
[22:28:30] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:29:01] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[22:35:12] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:36:02] *** Joins: imperio (imperio@moz-co1.baj.164.37.IP)
[22:36:59] <imperio> Someone can r+ gh25825 please (or at least just take a look ?). Thanks !
[22:36:59] <[o__o]> Adding E0011 explanation: https://github.com/rust-lang/rust/pull/25825
[22:37:24] *** Quits: imperio (imperio@moz-co1.baj.164.37.IP) (Quit: Bye)
[22:37:33] *** Joins: imperio (imperio@moz-co1.baj.164.37.IP)
[22:38:57] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[22:39:28] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:39:57] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[22:40:10] *** Quits: dinfuehr (dinfuehr@moz-4fk061.highway.telekom.at) (Connection closed)
[22:41:25] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Client exited)
[22:46:47] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[22:48:06] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[22:48:13] *** rkruppe_ is now known as rkruppe
[22:49:15] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:49:54] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:49:56] *** Quits: imperio (imperio@moz-co1.baj.164.37.IP) (Quit: Bye)
[22:50:33] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[22:52:43] *** Joins: harrisonclarke (harrisoncla@moz-v2i.4mr.177.142.IP)
[22:53:28] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[22:54:54] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:57:07] *** Joins: andars (andars@moz-bsldst.sntcca.sbcglobal.net)
[23:01:14] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:01:53] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[23:02:14] *** Joins: willem (willem@moz-facs2s.dynamic.upc.nl)
[23:07:29] *** Quits: Rym (y@moz-c2u.sd4.38.217.IP) (Connection closed)
[23:07:34] *** Joins: Rym (y@moz-c2u.sd4.38.217.IP)
[23:07:57] *** Joins: summerlight_ (summerlight@moz-99k.2mj.130.121.IP)
[23:09:36] *** Joins: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP)
[23:11:07] *** Quits: rkruppe (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[23:13:30] *** Quits: larhat (Adium@moz-vlo5br.cable.virginm.net) (Quit: Leaving.)
[23:13:45] *** Quits: rkruppe_ (chatzilla@moz-3nj.rnu.131.95.IP) (Ping timeout: 121 seconds)
[23:16:34] *** Joins: p1start (p1start@moz-nftjhe.org)
[23:19:21] *** Joins: mib_r0v86w (Mibbit@moz-juv.9o3.252.72.IP)
[23:21:46] *** Quits: mib_r0v86w (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:21:53] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[23:29:05] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:29:36] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[23:40:03] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:40:44] *** Joins: iitaku (textual@moz-u578hl.ocn.ne.jp)
[23:43:52] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[23:44:17] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[23:47:35] *** Quits: iitaku (textual@moz-u578hl.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[23:48:54] *** Quits: davebettin_ (davebettin@moz-hde.5e5.136.67.IP) (Ping timeout: 121 seconds)
[23:50:36] *** Joins: dinfuehr (dinfuehr@moz-4fk061.highway.telekom.at)
[23:50:52] *** Joins: ytain (ytain@moz-ffpck2.dsl.teksavvy.com)
[23:54:42] *** Quits: dinfuehr (dinfuehr@moz-4fk061.highway.telekom.at) (Ping timeout: 121 seconds)
[23:55:17] *** Quits: genbattle (genbattle@moz-r09mao.xtra.co.nz) (Ping timeout: 121 seconds)
[23:56:04] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
