[00:06:32] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:10:02] <SimonSapin> I intend to write a proper RFC with reasoning and all, but how do you all feel about renaming char to rune?
[00:10:23] <mcpherrin> Rune?
[00:10:24] <SimonSapin> the main idea being to avoid "character", which is ambiguous in computing
[00:10:26] <mcpherrin> that ... sounds unusual
[00:10:42] <SimonSapin> go uses it
[00:10:56] <SimonSapin> for Unicode code points
[00:11:37] <mcpherrin> Code and Point are both bad names I think
[00:12:19] <SimonSapin> (our char is actually a Unicode scalar value, excluding surrogate code points, but itâ€™s close enough)
[00:12:23] <mcpherrin> I dunno, I think char is fine -- though the confusion between a char and a u8/i8 is given
[00:13:01] <mcpherrin> Rune isn't bad, just an unusual flavour
[00:13:02] <SimonSapin> depending on the context, "character" may mean grapheme cluster, which can be made of multiple code points
[00:13:56] <SimonSapin> the idea of rune in go (afaict) was to use something kinda related to writing, but wasnâ€™t used in computing yet
[00:14:02] <strcat> SimonSapin: rune is pretty ambiguous too imo
[00:14:13] <SimonSapin> strcat: is it?
[00:14:18] <strcat> it has heavy implications of being a glyph
[00:14:36] <SiegeLord> What does the Unicode standard use?
[00:14:37] <strcat> I think the terminology predates stuff like combining characters
[00:14:40] <SimonSapin> even in computing?
[00:14:43] <strcat> SiegeLord: unicode scalar value
[00:15:34] <strcat> unicode scalar values -> grapheme clusters -> glyph
[00:15:55] <SimonSapin> strcat: whatâ€™s the arrow here?
[00:16:52] <strcat> just a lazy way of marking the RHS as being <= N values
[00:18:53] *** Quits: intuxicated (intuxicate@5BA9DB47.F2F0EDE4.DA0107E2.IP) (Ping timeout)
[00:20:02] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:20:50] <SiegeLord> It doesn't seem that a character is an incorrect word, as far as my reading of the definition of 'character' goes
[00:21:05] <strcat> character isn't incorrect, but it's ambiguous
[00:21:09] <strcat> imo rune isn't less ambiguous
[00:21:35] <mcpherrin> let a: UnicodeScalarValue = 'a';
[00:21:39] <mcpherrin> it's the only way to be sure.
[00:21:42] <strcat> usv
[00:21:44] <strcat> ;p
[00:21:57] *** Joins: intuxicated (intuxicate@5BA9DB47.F2F0EDE4.DA0107E2.IP)
[00:22:14] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[00:23:37] *** Quits: dotfelix (dotfelix@193B523.829DBEF3.40E092AA.IP) (Quit: )
[00:24:46] <SiegeLord> It feels like rune would mostly be of help to Go converts
[00:27:47] *** Joins: dotfelix (dotfelix@676F0DF8.829DBEF3.40E092AA.IP)
[00:28:43] *** Quits: cgaebel (clark@moz-F9D89110.nyc.res.rr.com) (Ping timeout)
[00:33:08] *** Joins: cgaebel (clark@moz-F9D89110.nyc.res.rr.com)
[00:33:28] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:33:39] <acrichto> brson: did you take the linux snap builder offline?
[00:35:32] *** Joins: Jesse (jruderman@moz-62518563.mtv2.mozilla.com)
[00:35:54] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:42:52] *** Quits: Sharp (Sharp@19388942.6B775EBE.DC877F3B.IP) (Quit: Sharp)
[00:43:55] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[00:45:35] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[00:48:53] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:51:13] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:56:01] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:56:48] <brson> acrichto: no
[00:57:27] <brson> well, maybe. not sure
[00:57:39] <acrichto> it is currently offline
[00:58:16] <acrichto> brson: r? https://github.com/mozilla/rust/pull/13020
[00:58:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:02:37] *** Quits: pcwalton (pcwalton@moz-24157589.mtv2.mozilla.com) (Quit: pcwalton)
[01:05:18] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[01:09:44] <brson> restarting buildbot
[01:11:45] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:13:20] *** kimundi is now known as zz_kimundi
[01:14:07] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:14:56] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[01:16:52] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[01:16:52] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1413d3571 to 144ca51ae: 02http://git.io/N3iJvQ
[01:16:52] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[01:16:52] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[01:16:52] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/GATBNg
[01:16:52] <ghrust> 13rust/06auto 14aa5c8ea 15Nick Cameron: Fix spans for enum-struct match arms...
[01:16:52] <ghrust> 13rust/06auto 144a2bd62 15bors: auto merge of #12854 : nick29581/rust/parse-enum-struct, r=alexcrichton...
[01:16:53] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[01:18:18] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:19:42] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[01:20:37] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:31:54] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[01:33:40] <brson> dammit, I don't understand what buildbot is thinking
[01:33:53] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[01:36:09] <brson> i *think* it's still spinning up slaves
[01:41:15] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:43:18] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:50:13] *** Joins: huon_ (huon_@7DB26CEE.D5A1DCF.37681C44.IP)
[01:53:17] <huon_> SimonSapin: btw, https://github.com/mozilla/rust/issues/12730 (a pre-new RFC process RFC)
[01:54:43] <huon_> I'd be in support of a proper RFC.
[01:56:05] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[01:56:05] *** ChanServ sets mode: +o tjc
[01:57:20] *** Quits: wycats (sid79@moz-5F4AA75A.irccloud.com) (Ping timeout)
[01:57:57] *** Joins: lpy (lpy@84D39BAD.183D133C.8C13C571.IP)
[01:58:35] *** Quits: dotfelix (dotfelix@676F0DF8.829DBEF3.40E092AA.IP) (Quit: )
[01:59:24] *** Joins: wycats (sid79@moz-5F4AA75A.irccloud.com)
[02:03:29] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:03:54] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:04:09] *** Quits: huon_ (huon_@7DB26CEE.D5A1DCF.37681C44.IP) (Connection reset by peer)
[02:05:40] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:06:49] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[02:06:49] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/Nex1sg
[02:06:49] <ghrust> 13rust/06auto 147332b65 15Alex Crichton: std: Add Vec to the prelude...
[02:06:49] <ghrust> 13rust/06auto 1477f9b76 15Alex Crichton: rustc: Default the ~[] lint to allow for now...
[02:06:50] <ghrust> 13rust/06auto 14d73c652 15bors: auto merge of #13020 : alexcrichton/rust/vec, r=brson...
[02:06:52] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[02:12:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:14:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:21:03] <brson> buildbot seems very confused about the state of the world
[02:25:45] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:27:41] <brson> well, this time bors is running correctly and we're building a linux snap again
[02:28:13] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:28:25] *** Joins: gwty (gwtypc@7D111845.F527CD2B.25B273F5.IP)
[02:28:40] <brson> acrichto: fyi, buildbot seems to start up vm's serially, and last time the linux-snap vm failed to read it's user/pw, then failed to connect to the buildmaster
[02:28:51] <brson> since it never connected buildbot never continued booting up other vms
[02:29:09] <brson> i had to go into the vm and run ./setup-slave.sh to reconfigure it
[02:30:08] <acrichto> brson: interesting
[02:30:59] <brson> i believe that *right now* everything is behaving correctly
[02:31:21] <brson> waiting for snapshot builds
[02:34:45] <acrichto> we've had a bunch of timeouts checking out LLVM
[02:48:44] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:49:37] <brson> i think i accidentally just shut down the linux snap bot
[02:49:51] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[02:50:41] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[02:50:45] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:51:27] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:51:27] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[02:52:20] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[02:54:41] <sfackler> did HashMap::mangle go away with the robin hood rewrite?
[02:56:17] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:57:09] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[02:57:31] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[02:58:02] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[02:59:14] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[02:59:21] *** Quits: cgaebel (clark@moz-F9D89110.nyc.res.rr.com) (Ping timeout)
[03:02:56] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[03:02:56] <ghrust> [13rust] 15cmr 04force-pushed 06try from 14b26a7f9 to 1479990e6: 02http://git.io/k471pw
[03:02:56] <ghrust> 13rust/06try 1479990e6 15Corey Richardson: how does that keep sneaking in
[03:02:56] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[03:05:41] *** Quits: Jesse (jruderman@moz-62518563.mtv2.mozilla.com) (Quit: Jesse)
[03:11:27] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:14:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:18:48] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[03:19:21] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[03:21:51] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[03:21:51] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14d73c652 to 144ca51ae: 02http://git.io/N3iJvQ
[03:21:51] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[03:21:52] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[03:21:52] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/W0lOBw
[03:21:52] <ghrust> 13rust/06auto 14405b5fc 15Huon Wilson: rustc: put ty_trait behind some indirection....
[03:21:52] <ghrust> 13rust/06auto 14ddc7960 15Huon Wilson: rustc: put ty_closure behind some indirection....
[03:21:52] <ghrust> 13rust/06auto 14d8590e2 15bors: auto merge of #13013 : huonw/rust/tytrait, r=cmr...
[03:21:54] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[03:23:58] <cmr> strcat: r? https://github.com/mozilla/rust/pull/12980
[03:28:47] <brson> yeah they keep timing out on llvm :-(
[03:32:40] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[03:32:47] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[03:33:54] <cmr> strcat: thanks
[03:34:41] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[03:34:49] <sfackler> acrichto: wat? argument used to format with `` was attempted to not be used for formatting
[03:35:05] * cmr 's brain bends in half
[03:35:43] *** Quits: lpy (lpy@84D39BAD.183D133C.8C13C571.IP) (Ping timeout)
[03:35:56] <acrichto> sfackler: code?
[03:36:05] <acrichto> oh
[03:36:08] <acrichto> heh
[03:36:10] <acrichto> yes
[03:36:22] <acrichto> rusti: format!("{} {:0$}", 1, 2)
[03:36:45] <sfackler> acrichto: format!("PHF generation took {} seconds and {} \ {1, plural, one{round} other{rounds}}", time, rounds)
[03:37:03] <acrichto> using an argument for selection is different than formatting it
[03:37:19] <acrichto> {} + {1, plural, ...} == not valid
[03:38:17] <sfackler> I'm not sure I follow
[03:38:42] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:38:49] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:39:13] <acrichto> you're using the same argument for two different purposes
[03:39:26] <acrichto> one is pluralization, which requires uint, and one is Show, which requires T
[03:39:38] *** Joins: lpy (lpy@3B6F1F1D.F09091A8.1348A864.IP)
[03:39:39] <acrichto> the format string parser can't reconcile those two, so it generates an error
[03:39:47] <acrichto> there's an issue open on formatting the same thing twice
[03:39:55] <sfackler> oh
[03:39:56] <sfackler> got it
[03:40:00] <acrichto> it should be easy-ish, I just haven't gotten around to doing it
[03:40:42] <acrichto> sfackler: https://github.com/mozilla/rust/issues/9456
[03:41:51] <sfackler> is there also an issue for making that error message comprehensible/english? :P
[03:42:02] *** Quits: eibwen (kvirc@moz-6D1D100D.dip0.t-ipconnect.de) (Ping timeout)
[03:42:09] <acrichto> hehe, not yet
[03:42:22] <acrichto> it's basically true
[03:42:27] <acrichto> but could probably get re-worded...
[03:55:30] *** Quits: zz_kimundi (kimundi@moz-4CD428D2.dip0.t-ipconnect.de) (Ping timeout)
[03:56:22] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:58:01] *** Quits: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca) (Quit: canhtak)
[03:58:44] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:59:25] *** Joins: zz_kimundi (kimundi@moz-B62309E6.dip0.t-ipconnect.de)
[03:59:27] *** zz_kimundi is now known as kimundi
[04:00:26] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[04:00:50] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[04:06:31] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:07:31] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[04:12:09] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:14:31] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:19:05] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:20:04] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[04:21:28] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:24:28] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[04:25:24] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[04:25:51] *** Quits: lpy (lpy@3B6F1F1D.F09091A8.1348A864.IP) (Client exited)
[04:30:01] <brson> acrichto: i'm manually fixing the failed llvm clones
[04:31:13] <brson> i'm feeling pretty optimistic about moving stuff into ec2 now
[04:31:48] <brson> with just a few more physical machines we could create a second integration branch
[04:32:19] <brson> we might even be able to do it with the hardware we already have
[04:34:20] <cmr> http://phabricator.octayn.net/ is up
[04:34:49] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[04:35:00] <cmr> if you want to play with it
[04:42:47] <sfackler> cmr: Access token error: incorrect_client_credentials
[04:42:49] <cmr> !!! separate-libc just passed all try
[04:42:57] <sfackler> Unhandled Exception ("Exception")
[04:43:22] <cmr> sfackler: this is trying to create an account? after you've allowed it through github?
[04:43:47] <brson> cmr: neat
[04:43:49] <brson> both things
[04:43:53] <sfackler> cmr: yep
[04:44:04] <cmr> sfackler: let me check the app settings...
[04:44:14] <cmr> oauth is such a pita
[04:46:24] <aatch> cmr, ever implemented it yourself?
[04:46:40] <cmr> aatch: yes, unfortunately.
[04:47:06] <cmr> oauth is the biggest pile of crap I've had the pleasure of working with.
[04:47:08] * cmr grumbles
[04:47:20] <cmr> oauth v2 specifically
[04:47:28] <strcat> and... persona is basically dead ;\
[04:47:30] <mcpherrin> it's great for finding attack surfaces to exploit
[04:47:49] <aatch> oauth v2 is much, much nicer than oauth v1
[04:47:55] <mcpherrin> persona and oauth aren't really the same thing at all though
[04:48:27] <cmr> I'm frightened by what oauth v1 must have been
[04:48:51] <strcat> mcpherrin: doesn't persona include that functionality though?
[04:49:16] <mcpherrin> strcat: Maybe it does. Unsure.
[04:49:24] * strcat shrugs
[04:50:14] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[04:50:18] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[04:50:21] <cmr> sfackler: can you try again?
[04:52:55] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[04:54:54] <sfackler> I am now Waiting Patiently
[04:55:17] <cmr> which half? phabricator or github?
[04:55:36] <sfackler> phabricator
[04:55:42] <sfackler> Your account has been created, but needs to be approved by an administrator. You'll receive an email once your account is approved.
[04:55:46] <cmr> bah
[04:55:53] * cmr figures out how to turn that off
[04:56:02] <cmr> I haven't setup email yet :p
[04:56:12] * strcat makes 200000 accounts for a rainy day
[04:56:32] <cmr> dev null and his 200k friends
[04:56:47] <aatch> 199,999 friends
[04:57:13] <strcat> cmr: sure, they can all be @devnullmail.info
[04:58:47] <cmr> where is the damn approve button
[04:59:31] <strcat> that's how I crawl the nytimes via their API after all
[04:59:57] <cmr> sfackler: I'm just going to delete your account
[05:00:03] <cmr> sfackler: make a new one, will be automatically approved
[05:00:09] <strcat> http://sprunge.us/ETMg
[05:00:14] * strcat boos at API rate limits
[05:00:56] <sfackler> hurray!
[05:01:10] <strcat> http://mailinator.com/inbox.jsp?to=ozuewxivnqurxjclammmo mailinator <3
[05:01:43] <strcat> cmr: anyway I can see why they have that as a default ;p
[05:01:57] <sfackler> jfc, someone at facebook got way too into the ph thing
[05:02:08] <cmr> sfackler: it's quite hilarious
[05:02:15] <cmr> strcat: yeah it's a sane default
[05:03:46] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[05:04:52] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:07:18] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:12:08] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:14:32] <cmr> hey email works
[05:14:35] <cmr> that was painless
[05:14:36] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:14:40] <cmr> why pay for mailgun when you can use gmail
[05:15:54] <mcpherrin> what's the plan for phabricator?
[05:16:05] <cmr> I'm just experimenting with it
[05:16:15] <mcpherrin> mmmkay
[05:16:19] <cmr> seeing if we can use it for code review.
[05:16:26] *** Quits: [o__o] (~o__o@604A2740.DB688352.F4ADE383.IP) (Ping timeout)
[05:16:50] <cmr> ideally I'd be able to write some glue that uses their respective api's to make it a two-way binding with the github "code review"
[05:18:15] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[05:20:45] <eddyb> good morning :D
[05:20:52] <eddyb> aaaany minute now
[05:22:29] <eddyb> oh wow, with both my and huon's changes, we should be down to 1.1GB in the trans peak. only need a snapshot :P
[05:22:49] * jdm has set up an audit rule for debuginfo.rs changes
[05:23:18] <cmr> jdm: on phabricator?
[05:23:21] <jdm> yep
[05:23:24] <cmr> cool
[05:23:34] <eddyb> hmm?
[05:23:39] <cmr> I'm pretty excited about this tool, it looks awesome. Hopefully I feel that way after I use it.
[05:23:43] <cmr> eddyb: http://phabricator.octayn.net/
[05:23:49] <cmr> setting it up for rust
[05:24:22] <eddyb> so we already tried a snapshot, after my "drop TLD" PR?
[05:24:30] <cmr> the snapshot bots are going.
[05:24:36] <eddyb> oh okay
[05:24:56] <eddyb> I can't tell what's going on in the console
[05:25:19] <cmr> still having some issues with the migration
[05:25:33] <eddyb> okay, it shows up in here http://buildbot.rust-lang.org/waterfall?branch=snap-stage3&refresh=15
[05:25:34] *** Joins: ecr (chatzilla@E940BDD3.FBC7597F.11F8506F.IP)
[05:26:24] <eddyb> aww I forgot to remove the silly description on #12770 before it got merged
[05:27:33] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:27:34] <brson> oh we aparently got a successful windows snapshot from ec2. that's new!
[05:30:00] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:30:31] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[05:31:08] *** Joins: [o__o] (~o__o@604A2740.DB688352.F4ADE383.IP)
[05:31:46] <strcat> acrichto: do you still want to wait for https://github.com/mozilla/rust/pull/12772 ? it doesn't seem anyone is against it
[05:33:36] * strcat doesn't really want to create a bunch of merge conflicts for himself ;s
[05:33:53] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[05:34:22] <eddyb> brson: wait... snapshot... I've been begging for it, but if it comes, I have to be ready!
[05:34:48] <strcat> stupid intel gpu eats more and more of my memory
[05:35:00] <eddyb> need to remove .get() methods on Ref/RefMut and... maybe remove Deref/DerefMut from the prelude?
[05:35:05] <strcat> it reserves 300MiB for itself now on boot ;s
[05:35:06] <eddyb> strcat: but at least it's safe :P
[05:35:12] <strcat> soon I won't be able to compile rust
[05:35:19] <eddyb> haha feel my pain
[05:35:46] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[05:39:47] <strcat> eddyb: if I get fully working gpg in gmail or find another good imap client then at least I can drop thunderbird and save 300MiB of memory ;s
[05:41:52] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[05:41:52] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/W0lOBw
[05:41:52] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[05:43:08] <cmr> http://stackoverflow.com/questions/8945879/how-to-get-body-of-a-post-in-php
[05:43:16] <cmr> this is insane.
[05:43:33] <strcat> why are you using php? :(
[05:43:36] <strcat> oh, phabricator
[05:43:51] <eddyb> facebook is insane
[05:43:51] <cmr> yeah :(
[05:44:03] * strcat puts hands over aatch's ears
[05:44:10] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[05:44:13] <cmr> I was going to try and bang out a webhook handler
[05:44:13] <eddyb> you'd think they'd just rewrite their backends in something saner
[05:44:18] <cmr> but this is way too insane for me
[05:44:49] <eddyb> node.js would be an improvement over PHP, in the backend >_>
[05:45:03] <strcat> rust*
[05:45:10] <eddyb> (I guess that wouldn't have been an option for Facebook)
[05:45:24] <eddyb> strcat: well, Rust is even newer
[05:45:35] <strcat> eddyb: they use php because their programmers know php
[05:45:36] <eddyb> and it has a higher transition cost. I should've phrased that better
[05:45:41] <strcat> because they hired php programmers because they used php
[05:45:49] <eddyb> "almost anything would be an improvement over PHP"
[05:45:57] <cmr> and then they hired some C++ developers to make PHP less slow
[05:46:03] <eddyb> it's ridiculous
[05:46:05] <cmr> that's where they should have shot the PHP developers ;p
[05:46:22] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[05:46:50] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[05:46:50] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/CtNGbA
[05:46:50] <ghrust> 13rust/06auto 147f8609b 15Corey Richardson: ever more fallout
[05:46:50] <ghrust> 13rust/06auto 143adf52d 15bors: auto merge of #12526 : cmr/rust/separate-libc, r=alexcrichton...
[05:46:50] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[05:46:53] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[05:46:53] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/MbV6rQ
[05:46:53] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[05:46:56] <cmr> please land
[05:47:37] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[05:50:35] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:52:29] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:53:54] <strcat> brson: hm, why does windows need the extra stage?
[05:54:02] <strcat> the weird dir arrangement?
[05:54:39] <brson> strcat: to hope for convergence because of the way we mix the binaries between stages during the windows install
[05:54:45] <strcat> acrichto: \o/
[05:55:06] <acrichto> here's to the death of ~[T]!
[05:55:15] <strcat> soon ;p
[05:55:46] <strcat> I want to get all the slice methods implemented for Vec, in a way where it doesn't have to be repeated (and the docs should be readable...)
[05:56:17] <eddyb> strcat: impl ImmutableVector<T> for Vec<T>
[05:56:23] <eddyb> strcat: or rather, &Vec<T>
[05:56:35] <strcat> eddyb: I'd rather have a Slice trait and impl it for Vec
[05:56:41] <strcat> and &[T]
[05:56:48] <strcat> and &mut [T]
[05:56:49] <acrichto> brson: looks like the new snap builder for linux is a little slower than the old one, they're both VMs though, right?
[05:56:56] <strcat> then put all the immutable slice methods on it
[05:56:59] <eddyb> strcat: just make all the methods defaults, using as_slice()
[05:57:02] <strcat> but I don't know what rustdoc will do
[05:57:12] <eddyb> that should work
[05:57:24] <strcat> imo readable docs is more important than removing this duplication, although I really hate this duplication
[05:58:02] <strcat> acrichto: aws speed also varies all the time ;P
[05:58:17] <strcat> especially I/O
[05:58:32] <brson> acrichto: no, the old one was actually a box hosted somewhere in mv
[05:58:42] <brson> i'm surprised this is slower though
[05:58:49] <brson> these are supposed to be very fast CPUs
[05:58:56] <acrichto> brson: oh hm wait, let me check if it built LLVM
[05:59:13] <acrichto> ah yes
[05:59:15] <acrichto> it built llvm twice
[05:59:20] <acrichto> that would explain a 20 minute delta
[06:00:11] * strcat amused by all the no-op benchmarks
[06:00:17] <strcat> is*
[06:00:26] <brson> the old linux ec2 vms were supposed to be very fast too, but they are smoked by the i7s we're using as the primary
[06:01:14] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[06:02:06] <acrichto> only one more builder to go
[06:02:08] <acrichto> and we have a new snap
[06:10:45] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Input/output error)
[06:11:05] *** Quits: brson (brson@moz-62518563.mtv2.mozilla.com) (Ping timeout)
[06:14:47] *** Joins: lpy (lpy@186A8F3A.F09091A8.1348A864.IP)
[06:16:25] *** Joins: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net)
[06:16:25] *** ChanServ sets mode: +o huon
[06:21:49] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[06:21:49] <ghrust> [13rust] 15bors 04force-pushed 06auto from 143adf52d to 14d8590e2: 02http://git.io/N3iJvQ
[06:21:49] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[06:21:53] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[06:21:53] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/dV_doQ
[06:21:53] <ghrust> 13rust/06auto 14ce62032 15Daniel Micay: rename std::vec -> std::slice...
[06:21:53] <ghrust> 13rust/06auto 147aded2a 15bors: auto merge of #12772 : thestinger/rust/slice, r=alexcrichton...
[06:21:54] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[06:22:12] *** Joins: edwardw (edwardw@BF6575DE.1B2F6624.7F41E82D.IP)
[06:23:44] <eddyb> nmatsakis: I don't know what to call Lvalue | PodValue
[06:24:04] <huon> PlodValue
[06:24:20] <cmr> LetsGoShoppingValue
[06:24:27] <cmr> (because naming is hard)
[06:25:11] <eddyb> it's something you can pass around freely
[06:25:14] <acrichto> cmr: did you see the recent failure with liblibc?
[06:25:19] <cmr> bah
[06:25:21] * cmr looks
[06:25:34] <acrichto> CANNOT LINK EXECUTABLE: could not load library "libgreen-2892ff35-0.10-pre.so" needed by "/data/tmp/vec-push.stage2-arm-linux-androideabi"; caused by could not load library "librand-413a5926-0.10-pre.so" needed by "libgreen-2892ff35-0.10-pre.so"; caused by could not load library "libstd-31b43f22-0.10-pre.so" needed by "librand-413a5926-0.10-pre.so"; caused by could not load library "liblibc-8f65d5a8-0.10-pre.so" needed by "libstd-31b43f2
[06:25:36] <acrichto> wat
[06:25:50] <cmr> did *everything* explode on android?
[06:25:53] <strcat> linkers
[06:26:08] <acrichto> apparently we can generate arm binaries
[06:26:11] <acrichto> we just cannot run them
[06:26:25] <cmr> caused by cannot locate symbol "__cxa_atexit" referenced by "liblibc-8f65d5a8-0.10-pre.so"...
[06:26:27] <cmr>  
[06:26:32] <cmr> wat
[06:26:39] <acrichto> where in the world is that coming from
[06:26:51] <acrichto> if you linked to librustc I'd expect to pick up something like that
[06:26:52] <cmr> there should be literally no code in liblibc
[06:26:57] <cmr> if there is it wouldn't have compiled
[06:27:02] <strcat> that's from dtors
[06:27:05] <strcat> on globals
[06:27:07] <strcat> afaik
[06:27:10] <strcat> in C++
[06:27:10] <acrichto> but we don't have any :(
[06:27:45] <acrichto> aww it's already been cleaned out
[06:27:48] <acrichto> I can't inspect it
[06:27:53] <cmr> I don't even know how how to start debugging that
[06:28:06] <cmr> I've never really used android
[06:28:07] <strcat> step 1) take the same drugs the bionic devs did
[06:28:15] <acrichto> oh yay it's still on the emulator, lemme see if I can poke at the binary
[06:28:49] <acrichto>         U __cxa_atexit
[06:28:51] <acrichto> yep
[06:28:55] <acrichto>          U __cxa_finalize
[06:28:56] * strcat has seen a lot of horrible linker failures lately due to cross-compiling to windows with mingw-w64
[06:29:04] <eddyb> huon: I was going to make an enum Local {LvalueLocal(Datum<Lvalue>), PodImm(Datum<PodValue>)}
[06:29:24] <eddyb> huon: but I need a similar things for globals (statics are Lvalues while function pointers are PodValues)
[06:29:31] <huon> eddyb: sounds fine to me, as long as the values are actuall "Local" to a function
[06:29:34] <cmr> acrichto: can you find the function that's referencing it?
[06:29:38] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[06:29:41] <cmr> or is it just referenced but unused
[06:29:57] <eddyb> huon: thing is, it doesn't matter
[06:30:17] <acrichto> https://gist.github.com/anonymous/9658369
[06:30:20] <acrichto> cmr: ^ that's the objdump
[06:30:21] <huon> eddyb: well name it "Cats"
[06:30:29] <huon> if it doesn't matter :P
[06:30:39] <eddyb> ykwim
[06:30:41] <cmr> acrichto: ok, so there's no code, as it should be :P
[06:30:53] <acrichto> cmr: it has atexit and __on_dlclose
[06:30:55] <acrichto> dunno why
[06:31:03] <eddyb> huon: but if I remove "Local", I get enum ??? {Lvalue /* taken by the unit struct datum::Lvalue*/(Datum<Lvalue>), PodImm(Datum<PodValue>)}
[06:31:15] <strcat> acrichto: that's just what C++ dtors on globals do
[06:31:19] <strcat> if you unload a library they run
[06:31:19] <cmr> acrichto: well that's surely not coming from rust
[06:31:20] <eddyb> so if it's either a global or a local.... it's a thing
[06:31:21] <cmr> c
[06:31:28] <eddyb> so what do I call a thing?
[06:31:34] <eddyb> that I can freely pass around?
[06:31:37] <acrichto> this is not a new thing
[06:31:40] <cmr> eddyb: Cats
[06:31:48] <strcat> acrichto: are they from LLVM? ;s
[06:31:50] <eddyb> I just thought "Joint". lol
[06:31:53] <eddyb> cmr: why Cats?
[06:31:54] <acrichto> dunno
[06:32:04] <cmr> eddyb: huon suggested it. I like it.
[06:32:08] <huon> eddyb: this is the internet
[06:32:36] <cmr> acrichto: even more confusing is that this is coming from the rtld
[06:33:04] <eddyb> haha, what, I can enter a decimal point in the "go to line" thing in my editor
[06:33:19] <eddyb> it should totally allow : for columns
[06:33:23] <huon> 9.75
[06:33:48] <huon> cmr: btw, is the bencher catching up to now?
[06:33:57] <eddyb> huon: if this weren't written in C++... I could see that moving the cursor third quarters of a line below line 9
[06:34:09] <cmr> huon: whoops, it was off from the benches I ran this morning. it's back on.
[06:34:22] <eddyb> (*cough* HTML5 *cough* JS)
[06:34:36] * huon wants to see his \ on the graph
[06:34:48] * eddyb too
[06:34:54] <eddyb> stairway to hell
[06:35:03] <huon> low memory use is hell?
[06:35:08] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[06:35:09] <acrichto> cmr: you can look at the IR with the stage0 compiler: https://gist.github.com/anonymous/9658411
[06:35:12] <eddyb> huon: it's down and not up :/
[06:35:20] <acrichto> ./$target/stage0/bin/rustc --target=android libc.rs
[06:35:21] <acrichto> etc
[06:35:22] <eddyb> huon: maybe we should invert the graphs?
[06:35:31] * huon holds his laptop upside down
[06:35:36] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:35:48] <cmr> acrichto: nothing there but ffi definitions :\
[06:35:55] <cmr> LLVM must be inserting them :(
[06:36:00] <eddyb> and draw pretty pictures like from Dante's works
[06:36:10] <eddyb> cmr: -ffreestanding :P
[06:36:17] <eddyb> I have an android build, fwiw
[06:36:31] <eddyb> should I pull and try to build stage2?
[06:36:41] <eddyb> (but that will take a while and you guys will all have figured it out)
[06:36:48] <acrichto> cmr: hm the linker must be putting it in there
[06:36:55] <acrichto> the object file doesn't have any unknown symbols
[06:37:03] <cmr> /o\
[06:37:25] <cmr> also how long have we been gated on android?
[06:38:01] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:38:33] <huon> acrichto: snaps \o/
[06:38:34] <cmr> acrichto: do we just need another -l somewhere early in the linker args perhaps?
[06:38:54] <acrichto> cmr: maybe
[06:38:59] <acrichto> gonna try to replicate
[06:39:38] <cmr> acrichto: thanks
[06:42:45] <acrichto> cmr: hm, so I wasn't doing it right before
[06:42:52] <acrichto> if I pass -shared then it will always pull in those deps
[06:45:53] <acrichto> cmr: whoa, it's in libc
[06:45:58] <acrichto> the symbol
[06:46:11] <cmr> liblibc or libc libc?
[06:46:13] <acrichto> [sysroot/usr/lib] $ arm-linux-androideabi-nm libc.so| grep __cxa_atexit       
[06:46:13] <acrichto> 00008874 T __cxa_atexit
[06:46:20] <acrichto> the arm libc
[06:46:40] <cmr> are we not linking to its libc?
[06:46:46] <acrichto> libstd is
[06:46:53] <acrichto> which should bring it in I would think
[06:47:02] <cmr> perhaps their rtld cares about order.
[06:47:06] <cmr> it's loading std
[06:47:10] <cmr> going to load liblibc
[06:47:13] <cmr> not finding it
[06:47:15] <cmr> and bailing
[06:47:16] <acrichto> ah yes
[06:47:19] <acrichto> well wait
[06:47:22] <acrichto> so the libc crate
[06:47:24] <acrichto> should link to libc
[06:47:32] <cmr> .... yeah
[06:47:32] <acrichto> (just an idea)
[06:47:34] <cmr> it should
[06:47:43] <acrichto> take a look at src/libstd/rtdeps.rs
[06:47:50] <acrichto> you can move over the "c" ones
[06:48:20] <acrichto> osx has libc.dylib
[06:48:24] <acrichto> so you can add an entry for osx
[06:48:40] <acrichto> freebsd also likely has a libc
[06:48:56] <acrichto> I'd omit it for win32 but add it for everyone else
[06:49:54] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[06:50:57] <cmr> should just need c and m?
[06:51:16] <acrichto> hm, there are probably a bunch of bindings in there for c
[06:51:18] <acrichto> and m
[06:51:26] <acrichto> I'd add both to be safe
[06:51:52] <cmr> lol. we have pthread constants but no functions.
[06:52:09] <acrichto> shhhhhhh
[06:53:27] <cmr> does osx have a separate libm?
[06:53:59] <cmr> I'm hoping I can just have a #[cfg(not(windows))] ...
[06:55:51] <cmr> acrichto: r? https://github.com/cmr/rust/commit/b218a5c4045a2ff6419861ec97beaf729e77f316
[06:57:58] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[06:57:58] *** ChanServ sets mode: +ao pcwalton pcwalton
[06:58:04] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[06:58:56] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:00:45] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:00:46] <cmr> jdm: how do you add an audit? I want to add one for unsafe code
[07:03:16] <cmr> ah did you add a personal one?
[07:04:18] <cmr> ok, herald, seeing it now
[07:04:34] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:05:23] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[07:12:07] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:12:34] <huon> is https://github.com/mozilla/rust/pull/12837 going to be updated in the near future?
[07:13:10] <acrichto> cmr: r=me if you remove those lines from rtdeps.rs
[07:13:35] <acrichto> huon: I think pcwalton is overloaded in servo right now, but he'd know more than I
[07:13:40] <cmr> acrichto: not sure that's a good idea, std might not always depend on liblibc?
[07:13:50] <cmr> although if it's doing any ffi it wants the ctypes
[07:13:52] <cmr> so nevermind
[07:13:52] <acrichto> true
[07:14:02] <acrichto> it's got pthread definitions in there for native mutexes anyway
[07:14:04] <acrichto> and stuff like that
[07:14:16] <acrichto> let's land this first
[07:14:20] <cmr> agree
[07:14:22] <acrichto> it's baked long enough :)
[07:14:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:14:36] <huon> acrichto: ok
[07:14:48] <huon> I'll consider reviving it then
[07:18:22] <cmr> sfackler: ping
[07:20:52] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:23:02] <strcat> cmr: you found the strangest error ever ;\
[07:23:10] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:23:12] <cmr> strcat: that linker one?
[07:23:12] <strcat> that C++ atexit thing
[07:23:18] <cmr> yeah
[07:23:21] <cmr> pretty confounding
[07:23:36] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[07:23:59] <cmr> I have a great story about a race condition in stdc++ caused by a missing #include <thread>
[07:30:08] *** huon is now known as ed1
[07:31:11] *** Joins: bjz (bjz@moz-38D46E1C.perm.iinet.net.au)
[07:31:23] *** ed1 is now known as huon
[07:31:53] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[07:31:53] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/dV_doQ
[07:31:53] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[07:36:54] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[07:36:54] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/w3jqGQ
[07:36:54] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[07:39:04] <cmr> phabricator is nicer than I could have hoped.
[07:39:10] <cmr> a bit rough around the edges in some parts
[07:39:14] <cmr> but overall great.
[07:41:55] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[07:41:55] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/e942aQ
[07:41:55] <ghrust> 13rust/06auto 14aa5c8ea 15Nick Cameron: Fix spans for enum-struct match arms...
[07:41:55] <ghrust> 13rust/06auto 14a92dcb0 15bors: auto merge of #12854 : nick29581/rust/parse-enum-struct, r=alexcrichton...
[07:41:55] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[07:41:57] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[07:41:57] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/w3jqGQ
[07:41:57] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[07:42:27] <huon> cmr: does it integrate with github well?
[07:42:33] <huon> (i.e. "import" PRs, etc?)
[07:42:41] *** Quits: ecr (chatzilla@E940BDD3.FBC7597F.11F8506F.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 27.0.1/20140212131424])
[07:43:59] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:45:38] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[07:46:00] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:46:40] <mcpherrin> huon: I don't think it has any github integration
[07:47:55] <huon> mcpherrin: oh :(
[07:50:01] *** flaper87|afk is now known as flaper87
[07:50:07] <huon> apparently phabricator handles commit --amend correctly?
[07:57:29] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[07:59:46] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 31.0a1/20140318030202])
[08:03:23] <edwardw> there are tickets for return type deduction (#10448, #11455), does it make sense to consider doing the same for argument type?
[08:03:54] <edwardw> e.g. `fn foo(x: Bar<_>)`
[08:04:03] <eddyb> not really
[08:04:17] <eddyb> edwardw: is that global inference or implicit generics?
[08:04:23] <edwardw> care to elaborate? 
[08:04:37] <edwardw> that _ is given inside the function
[08:05:37] <eddyb> that's global type inference, which Rust is against
[08:05:46] <edwardw> hmm, sad
[08:05:49] <eddyb> "return type deduction" is not really deduction
[08:06:05] <eddyb> but rather, providing an anonymous interface for a concrete type
[08:06:32] <edwardw> k
[08:08:48] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[08:09:09] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[08:10:50] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[08:12:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:14:26] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:17:46] *** Quits: edwardw (edwardw@BF6575DE.1B2F6624.7F41E82D.IP) (Quit: Leaving...)
[08:18:18] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[08:24:25] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:24:25] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:24:30] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:24:33] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:24:33] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[08:26:36] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[08:29:04] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:30:21] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[08:30:51] *** Joins: glaebhoerl (glaebhoerl@moz-D2E372A1.catv.broadband.hu)
[08:31:26] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:33:06] *** Quits: glaebhoerl (glaebhoerl@moz-D2E372A1.catv.broadband.hu) (Quit: )
[08:33:10] *** Joins: glaebhoerl_ (glaebhoerl@moz-D2E372A1.catv.broadband.hu)
[08:34:56] *** Quits: glaebhoerl_ (glaebhoerl@moz-D2E372A1.catv.broadband.hu) (Ping timeout)
[08:36:36] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[08:39:27] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[08:39:57] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[08:41:10] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:41:20] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:42:53] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[08:45:36] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[08:48:08] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[08:51:57] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[08:51:58] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/e942aQ
[08:51:58] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[08:52:22] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:54:14] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:56:49] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[08:56:49] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/JeJI6Q
[08:56:49] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[09:04:35] <flaper87> huon: https://github.com/mozilla/rust/pull/12686 r=niko pls :)
[09:04:42] <flaper87> I ran doc-crate-std locally this time
[09:05:19] <flaper87> actually, that sounds like something we could add to travis builds, probably 
[09:11:55] <eddyb> nmatsakis: why do we always make closures lvalues?
[09:12:10] <eddyb> nmatsakis: seems like a waste of allocas to me
[09:12:20] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:13:14] <eddyb> nmatsakis: they use rvalues and ADT to extract the fields (so they can still work if we pass them by value instead of reference)
[09:15:18] *** Quits: kimundi (kimundi@moz-B62309E6.dip0.t-ipconnect.de) (Ping timeout)
[09:16:54] <flaper87> damn, now I need to rebase
[09:17:02] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:17:41] <flaper87> ok, that was an easy rebase
[09:26:20] <eddyb> is std-macros only compiled at stage1 and later?
[09:26:43] <eddyb> I'm trying to understand why/how it works
[09:28:56] <eddyb> huon: I've figured it out
[09:29:14] <eddyb> huon: we need to somehow link against a binary
[09:31:16] <huon> flaper87: "Mention share in guid-unsafe instead of freeze" s/guid/guide/
[09:31:29] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[09:32:13] <flaper87> huon: oops, lemme fix that
[09:33:03] <flaper87> huon: done
[09:41:55] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[09:45:40] *** Joins: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl)
[09:46:50] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[09:46:50] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1472d190f to 14a92dcb0: 02http://git.io/N3iJvQ
[09:46:50] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[09:46:51] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[09:46:51] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/AZC_og
[09:46:51] <ghrust> 13rust/06auto 1414f656d 15Daniel Micay: rename std::vec_ng -> std::vec...
[09:46:51] <ghrust> 13rust/06auto 14cdab8a7 15Steven Fackler: A couple of fixes to vec_ng docs
[09:46:52] <ghrust> 13rust/06auto 144224147 15bors: auto merge of #13028 : thestinger/rust/vec_ng, r=huonw...
[09:46:54] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[09:47:43] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[09:48:35] *** Quits: lpy (lpy@186A8F3A.F09091A8.1348A864.IP) (Client exited)
[09:48:53] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[10:00:12] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:00:32] <eddyb> acrichto: now I need to write an RFC for rbin (Rust metadata in statically linked binaries - exporting certain crates used to create the binary, for things like loadable plugins)
[10:01:25] <eddyb> huon: ^^ but that should solve the bootstrapping issue and allow interesting usages of macro sub-crates
[10:01:58] <eddyb> even extend #phase to other stages, like post-type-checking (some interesting transforms to be had there, whenever we get a CFG)
[10:02:33] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:02:38] <eddyb> I guess... synthetic AST produced from a generator syntax extension could survive type checking
[10:02:42] <huon> #[phase(lint)] fn my_custom_lint(...) { ... }
[10:02:50] <eddyb> after which, it can be transformed into an actual generator
[10:02:53] <eddyb> huon: yupp :)
[10:03:09] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Ping timeout)
[10:03:10] <huon> heh, phase(link, lint) won't ever get confusing :P
[10:03:52] <eddyb> the in-crate syntax extension thing is still easy
[10:04:34] <eddyb> hardest part would be generating the temp file name and removing it... hmm, can we do everything in RAM? that would be a bit crazy
[10:04:49] <eddyb> kinda like JIT - I guess not, you still need the linker
[10:04:49] <huon> MC-JIT?
[10:04:57] <eddyb> huon: yeah, but without invoking it
[10:07:02] <eddyb> huon: and maybe the rbin thing is not hard either
[10:07:10] <eddyb> we already do this for .so, don't we?
[10:07:38] <eddyb> the snapshot compiler will be a runnable library (reminds me of DLL)
[10:09:09] *** Quits: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com) (Quit: I'm sure it's perfectly safe)
[10:09:28] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: sleep)
[10:12:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:12:27] <eddyb> nmatsakis: hehe I must've done something wrong    arg datum: Datum((i64*:  %25 = load i64** %v), int, LvalueExpr)
[10:13:55] <eddyb> nmatsakis: ohhh I know what this is. the autoref thing for the RHS of an operator
[10:14:25] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:16:14] <eddyb> let's try not doing that at all
[10:16:51] <eddyb> no, it's more complicated
[10:17:31] *** Joins: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com)
[10:19:47] <eddyb> nmatsakis: take a look over the datumize PR if you have time for it
[10:22:36] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:24:55] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:29:34] *** Quits: gwty (gwtypc@7D111845.F527CD2B.25B273F5.IP) (Ping timeout)
[10:46:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:48:03] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:55:40] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[10:56:55] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[10:56:55] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/AZC_og
[10:56:55] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[11:01:54] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[11:01:54] <ghrust> [13rust] 15bors pushed 14 new commits to 06auto: 02http://git.io/ViJP6w
[11:01:54] <ghrust> 13rust/06auto 1437154fb 15Flavio Percoco: Add a Share kind...
[11:01:54] <ghrust> 13rust/06auto 1421d23ff 15Flavio Percoco: Make `Rc`, `Cell` and `RefCell` NoShare
[11:01:54] <ghrust> 13rust/06auto 1412ecafb 15Flavio Percoco: Replace Freeze bounds with Share bounds
[11:01:56] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[11:04:04] <eddyb> oh, hmpf, I think I need rebase :/
[11:05:53] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[11:07:33] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[11:08:28] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:10:33] <eddyb> nmatsakis: r? https://github.com/mozilla/rust/pull/13004
[11:10:37] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:10:54] <eddyb> acrichto: I hope the description is good enough
[11:16:01] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:22:05] <eddyb> rusti: ::std::mem::size_of::<Option<(~uint, uint)>>()
[11:22:06] -rusti- 24
[11:22:10] <eddyb> hmm
[11:22:38] <eddyb> rusti: enum Foo {Bar(~uint, uint), Baz} ::std::mem::size_of::<Foo>()
[11:22:39] -rusti- 16
[11:22:48] <eddyb> rusti: enum Foo {Bar(uint, ~uint), Baz} ::std::mem::size_of::<Foo>()
[11:22:48] -rusti- 16
[11:22:57] <eddyb> hah, so it already does this. interesting
[11:22:58] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[11:29:16] *** Quits: intuxicated (intuxicate@5BA9DB47.F2F0EDE4.DA0107E2.IP) (Quit: Leaving)
[11:30:31] *** Quits: bytbox (s@moz-E1E7FAC3.washdc.fios.verizon.net) (Client exited)
[11:31:03] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:33:23] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:36:51] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[11:36:51] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/QgfPEQ
[11:36:51] <ghrust> 13rust/06auto 148fee3f6 15Corey Richardson: std: io: flush stdout on stdin read from tty
[11:36:51] <ghrust> 13rust/06auto 1495ee0a0 15bors: auto merge of #12980 : cmr/rust/overhaul-stdio, r=thestinger...
[11:36:51] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[11:36:55] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[11:36:55] <ghrust> [13rust] 15bors 04force-pushed 06auto from 148136dd2 to 144224147: 02http://git.io/N3iJvQ
[11:36:55] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[11:37:09] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[11:41:01] *** Quits: bjz (bjz@moz-38D46E1C.perm.iinet.net.au) (Ping timeout)
[11:54:18] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:56:19] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:56:52] <eddyb> acrichto: needs a rebase :( https://github.com/mozilla/rust/pull/13026
[11:58:20] *** Joins: mw (mw@moz-9E61E1D7.static.surfer.at)
[12:02:38] *** Joins: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca)
[12:04:17] *** Joins: eibwen (kvirc@moz-B8CF119D.dip0.t-ipconnect.de)
[12:16:45] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:19:01] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:21:37] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[12:22:15] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[12:22:30] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[12:37:42] *** Joins: kimundi (kimundi@moz-B62309E6.dip0.t-ipconnect.de)
[12:39:49] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:40:07] *** kimundi is now known as zz_kimundi
[12:40:13] *** Joins: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[12:41:49] *** zz_kimundi is now known as kimundi
[12:42:03] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:45:28] <nmatsakis> eddyb: I'll take a look
[12:45:39] <nmatsakis> though I really owe edwardw some time
[12:45:44] <nmatsakis> and probably a few others :)
[12:45:54] <eddyb> oh, don't worry then
[12:46:02] <eddyb> I think I've got it to compile now
[12:46:28] <eddyb> yeah, travis passes
[12:46:54] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[12:46:54] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/QgfPEQ
[12:46:54] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[12:51:49] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[12:51:49] <ghrust> [13rust] 15bors pushed 14 new commits to 06auto: 02http://git.io/hljRGQ
[12:51:49] <ghrust> 13rust/06auto 1437154fb 15Flavio Percoco: Add a Share kind...
[12:51:49] <ghrust> 13rust/06auto 1421d23ff 15Flavio Percoco: Make `Rc`, `Cell` and `RefCell` NoShare
[12:51:50] <ghrust> 13rust/06auto 1412ecafb 15Flavio Percoco: Replace Freeze bounds with Share bounds
[12:51:52] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[12:55:55] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[12:56:20] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[12:56:22] <nmatsakis> eddyb: in that PR, the last commit, is there anything unexpected there?
[12:56:39] <nmatsakis> of course you can't possibly answer that, since you don't know what I expect :)
[12:56:44] <nmatsakis> but I guess what I mean is:
[12:57:06] <nmatsakis> I expect to see a bunch of ValueRefs changing to datums,
[12:57:18] <nmatsakis> some amount of lame repeated work fetching and re-fetching types going away,
[12:57:27] <nmatsakis> and I'm wondering if you encountered any significant cleanups or complications
[12:57:43] <eddyb> well, 300 lines are gone
[12:57:59] <eddyb> I think callee was fetching types even three times
[12:58:07] <nmatsakis> I guess I'm more interested in the complications :)
[12:58:15] <nmatsakis> re: the tcx thing,
[12:58:19] <nmatsakis> I've long wante dto put the TCX into thread-local data
[12:58:25] <eddyb> get_item_val should return Lvalue | PodValue
[12:58:29] <nmatsakis> (I also really want a scoped version of TLD,
[12:58:30] <eddyb> but I don't know how to name that yet
[12:58:33] <nmatsakis> that permits region data,
[12:58:35] <eddyb> (i.e. it's wrong for globals)
[12:58:37] <nmatsakis> but enforces a stack hierarchy)
[12:58:41] <nmatsakis> not sure if we have that yet
[12:58:43] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[12:58:50] <nmatsakis> I keep forgetting to look
[12:58:58] <nmatsakis> anyway, my only real complaint is that PodValue is unchecked
[12:59:04] <erickt_> good morning all. does anyone happen to know why `FromIterator::from_iterator` and `Extendable::extend` take `&mut Iter`? are there any cases where they don't completely consume the iterator?
[12:59:25] <eddyb> nmatsakis: yeah, I should just do that. any suggestions on Datum<Lvalue | PodValue>?
[12:59:31] <nmatsakis> erickt_: the only reason I can see is that sometimes the iterator might be in a field where it's inconvenient to give it away
[12:59:56] <nmatsakis> erickt_: but it's kind of a dodge, since the value is in an undefined state at the end
[13:00:02] <nmatsakis> eddyb: defining an enum
[13:00:21] <eddyb> nmatsakis: it's the type of items and locals (the latter only if we apply my changes of keeping Pod immediate locals as values)
[13:00:25] <eddyb> nmatsakis: welll... what name?
[13:00:28] <nmatsakis> eddyb: I have to go read up on the latest virtual struct RFCs, but I'm very excited about merging it with enums (at least in spirit), in whcih case that would provide an answer too ;)
[13:00:34] <nmatsakis> eddyb: LvalueOrPod?
[13:00:49] * nmatsakis creative
[13:00:59] <eddyb> hmpf. but some Pods are Lvalues
[13:01:08] <eddyb> or... nevermind. I guess that's fine
[13:01:10] <huon> erickt_: I believe there was some talk of making them take it by value, and then someone can use the .by_ref() adaptor if necessary
[13:01:20] <eddyb> nmatsakis: it's basically Datum<Expr> but shareable
[13:01:33] <nmatsakis> eddyb: or, nor xor :)
[13:01:41] *** Quits: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca) (Quit: canhtak)
[13:01:45] <eddyb> details :D
[13:02:23] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[13:02:42] <eddyb> nmatsakis: ValueRef of that enum as the value type in the item cache? (non-monomorphized, getting the type from the DefId should be cheap)
[13:02:47] <eddyb> s/of/or
[13:02:54] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:03:25] <erickt_> huon: thanks
[13:03:43] <nmatsakis> eddyb: I can't parse that sentence
[13:04:25] *** flaper87 is now known as flaper87|afk
[13:05:05] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:07:27] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[13:12:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:12:30] *** Quits: mw (mw@moz-9E61E1D7.static.surfer.at) (Client exited)
[13:12:49] *** flaper87|afk is now known as flaper87
[13:13:44] <huon> gah, I just spend hours and hours trying to work out why something was segfault: `#[deriving(Clone)] struct Foo { x: *mut T }` does the wrong thing when `x` is an owned allocation. :(
[13:14:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:15:23] *** Quits: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[13:20:11] <nmatsakis> huon: I think it'd be quite reasonable to have deriving refuse to do anything with a struct containing unsafe pointers
[13:20:59] *** Joins: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca)
[13:21:09] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[13:21:21] <nmatsakis> huon: by reasonable I mean "probably the only sane thing"
[13:21:21] <huon> nmatsakis: we could get it automatically by removing the trait impls for unsafe pointers...
[13:21:57] <nmatsakis> huon: hmm that may not be possible for Clone specifically, since I plan to make all POD things clone by default
[13:22:13] * nmatsakis ponders
[13:22:26] <nmatsakis> or I had thought that might be nice anyway
[13:22:32] <nmatsakis> (if we improved coherence rules)
[13:22:38] <nmatsakis> gah, the RFCs I have to write
[13:22:59] <kimundi> erickt: Btw I was the one who was talking about wanting to change those iterator functions to by-value
[13:23:08] *** Joins: edwardw (edwardw@2D2C4852.2264CD20.339614B0.IP)
[13:23:25] <nmatsakis> huon: I think there are many examples where the impls kind of make sense? but maybe not. I was thinknig of Eq etc, but maybe it'd make more sense for *T not to impl those traits, and rather to add helper fns
[13:25:24] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:26:06] <huon> nmatsakis: yeah, I wouldn't be keen on removing all traits, but my experience just now pushed me closer to wanting that... (The problem with removing the traits is then *T etc. become unusable in generic code; although it's probably good practice to be new-type wrapping raw pointers anyway.)
[13:27:05] *** Joins: gwty (gwtypc@5F452814.1C047769.25B273F5.IP)
[13:27:38] <nmatsakis> huon: yes. well I think we should either make deriving refuse (or at least WARN) *or* remove all traits
[13:27:46] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:27:53] <nmatsakis> huon: it'd be an easy lint to add
[13:28:02] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[13:28:17] <nmatsakis> huon: (i.e., any item which has a `#[deriving]` annotation *and* contains raw pointer fields etc)
[13:28:58] <huon> nmatsakis: https://github.com/mozilla/rust/issues/13032
[13:29:19] <huon> Yeah, a lint sounds good.
[13:32:53] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[13:35:07] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[13:36:43] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[13:37:49] *** Joins: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[13:38:16] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[13:39:06] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[13:51:23] <huon> cmr: another bench if you can? https://github.com/mozilla/rust/pull/13016 (thanks)
[14:01:12] <eddyb> did I just waste 4 hours waiting for a phonecall? yes I did :/
[14:01:50] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[14:01:50] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/hljRGQ
[14:01:50] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[14:02:21] <eddyb> was that Share?
[14:04:30] *** Quits: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com) (Ping timeout)
[14:06:46] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[14:06:46] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/Z0R3tA
[14:06:46] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[14:06:47] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[14:06:47] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/D-Ot7w
[14:06:47] <ghrust> 13rust/06auto 149b588a9 15Tobias Bucher: Remove std::cast::transmute_immut_unsafe...
[14:06:47] <ghrust> 13rust/06auto 148cfef59 15bors: auto merge of #13015 : tbu-/rust/pr_remove_immut, r=alexcrichton...
[14:06:47] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[14:06:57] <flaper87> w0000000000000000000t the share work landed
[14:10:53] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:13:34] *** flaper87 is now known as flaper87|afk
[14:14:34] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:18:47] *** Joins: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com)
[14:23:16] *** Quits: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[14:24:06] *** Joins: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[14:24:58] *** Quits: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[14:25:33] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[14:52:07] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[14:56:12] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:58:30] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:00:29] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[15:02:42] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[15:03:03] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[15:04:46] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[15:12:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:14:29] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:16:50] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[15:16:50] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/D-Ot7w
[15:16:50] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[15:17:08] <eddyb> *sigh* turns out my phone didn't work. I hate these things. now to actually do something today
[15:19:01] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:21:20] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:21:46] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[15:21:47] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/g7atvg
[15:21:47] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[15:21:47] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[15:21:48] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/ln-p4g
[15:21:48] <ghrust> 13rust/06auto 14068740b 15Alex Crichton: rustc: Prevent false positives in crate loading...
[15:21:48] <ghrust> 13rust/06auto 14c01e2f0 15bors: auto merge of #13017 : alexcrichton/rust/issue-13010, r=huonw...
[15:21:48] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[15:23:24] <edwardw> r? https://github.com/mozilla/rust/pull/13034
[15:31:40] *** Joins: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net)
[15:31:59] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[15:41:19] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[15:41:43] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[15:42:01] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[15:42:01] *** ChanServ sets mode: +ao dherman dherman
[15:44:18] *** Joins: lpy (lpy@1834E2CB.F09091A8.1348A864.IP)
[15:48:46] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[15:50:10] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[15:55:36] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:57:01] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[15:57:23] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[15:58:46] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[15:58:47] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[15:58:57] <erickt> kimundi / huon: actually, I think .by_ref() converts a `&mut Iterator<T>` into a `Iterator<T>`. It's going the opposite way than what I starting to think `fn extend` should take
[16:00:09] <erickt> kimundi: do you file an issue about this?
[16:00:28] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[16:01:02] <kimundi> erickt: I haven't filed an issue - but could you explain what you mean with that by_ref() comment?
[16:01:26] *** Quits: edwardw (edwardw@2D2C4852.2264CD20.339614B0.IP) (Ping timeout)
[16:01:35] *** Joins: edwardw (edwardw@3570A9BA.4E6A4251.FAED9FFC.IP)
[16:01:56] <erickt> kimundi: sure, by_ref is `fn by_ref<'r>(&'r mut self) -> ByRef<'r, Self>` defined on an iterator
[16:02:23] <erickt> kimundi: it takes a ref pointer and returns a value that contains that ref pointer
[16:02:39] <erickt> that value can then be consumed by methods like Iterator.take
[16:02:39] <kimundi> Right, I meant what you meant with " It's going the opposite way than what I starting to think `fn extend` should take" :
[16:02:49] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[16:03:28] <erickt> kimundi: ah, so I'm exporing the idea of changing extend to `fn extend<Iter: Iterator<T>>(iter: Iter) -> Self`
[16:03:59] <kimundi> Yeah, same here - in fact I'm currently testing a patch that did that motivated by you speaking about it earlier ;)
[16:03:59] <eddyb> erickt: and using .by_ref() when you don't have a value?
[16:04:03] <erickt> that would let me do things like `let x = ~[1,2,3]; let y = ~[]; y.extend(x.move_iter())`
[16:04:15] <kimundi> erickt: yep
[16:04:19] <eddyb> that's a pretty nice move
[16:04:37] <erickt> right now I need to do `let x = ~[1,2,3]; let y = ~[]; y.extend(&mut x.move_iter())`
[16:04:54] <kimundi> In fact I'm thinking whether all iterator methods that take a Iterator argument with the intention of exhausting it should take by-value
[16:05:30] <erickt> eddyb: yeah
[16:05:58] <acrichto> flaper87|afk: \o/ nice job with Share!
[16:06:35] <erickt> my impetus for doing this is the fact that Vec.push_all is essentially redundant when we have Extendable.extend
[16:06:42] <eddyb> acrichto: get that snapshot PR merged :D
[16:06:54] <eddyb> who will do the removal of .get() and .deref()?
[16:07:08] <eddyb> should we keep Deref/DerefMut out of prelude?
[16:07:14] <kimundi> erickt: Heh, yeah I have another patch that removes push_all ;)
[16:07:27] <kimundi> erickt: But it bitrotted/waits on DST changes to complete
[16:07:29] <acrichto> eddyb: are they needed in the prelude to have autoderef?
[16:07:36] <eddyb> acrichto: no
[16:07:53] <erickt> :) mine bitrotted too! I was cleaning up an old fork and found it and thought it might be worth reviving
[16:07:55] <acrichto> we should remove them then
[16:08:10] <acrichto> eddyb: I plan on going through the compiler and cleaning up lots of usage of Rc<RefCell> and such 
[16:08:13] <acrichto> once the snap lands
[16:08:37] <eddyb> acrichto: oh, okay, so I shouldn't touch it :)
[16:08:46] <kimundi> Once the snap lands, I can start testing wether I can use partial type hints for at least a few of the Vec<_> cases :P
[16:08:50] * pnkfelix thinks the name `push_all` is more self-documenting than `extend` (with respect to whether it modifies versus  returns new extended value)
[16:09:19] <erickt> pnkfelix: that's a separate issue :)
[16:09:41] <erickt> `trait PushAllable { ... }`
[16:09:44] <eddyb> acrichto: if you remove the get methods from cell::Ref/RefMut and Deref/DerefMut from prelude, then all you need to do is fix errors :P
[16:09:54] <eddyb> erickt: Pushable
[16:09:58] <eddyb> with push and push_all
[16:10:09] <pnkfelix> eddyb: I'd be fine with that.
[16:10:11] <eddyb> push_all can be implemented by default in terms of push
[16:10:21] <acrichto> hm, 'git fetch origin' is not fetching the current commit on origin/master...
[16:10:22] <eddyb> (but Vec would optimize it)
[16:10:23] <kimundi> pnkfelix: extend could be renamed to push_all, but the current push_alls are definitely bad. They currently force a allocation or clone just for being able to invoke it. :P
[16:10:38] <eddyb> acrichto: is origin the right remote?
[16:10:46] <acrichto> eddyb: I think I may leave deref in the prelude for now so "impl Deref" works
[16:10:56] <eddyb> acrichto: you can import it
[16:10:57] <acrichto> Fetch URL: /home/alex/code/rust2
[16:10:58] <acrichto> lol
[16:10:59] <acrichto> no it is not
[16:11:03] <pnkfelix> kimundi: right, my first instinct was to wonder why not just change `push_all` to take an Iterator rather than a vector
[16:11:20] <eddyb> acrichto: not many places have to implement Deref, just use std::ops::Deref;
[16:11:29] <pnkfelix> kimundi: which as long as size_hint is implemented on the iterator, should be fine
[16:11:55] <acrichto> eddyb: may as well err on the side of a smaller prelude
[16:12:06] <erickt> so something like `Pushable` is my next thing :) I also have a patch that adds a `MutableSeq` trait to std::container. This also could be a place to hang the `fn push_all` method (and is in fact what I did in this patch. I did it before I knew about Extendable)
[16:12:26] <eddyb> though... push/push_all for HashSet. doesn't seem that sane
[16:12:26] <kimundi> pnkfelix: Yeah, but there's already the existing Extendable infrastructure.
[16:12:42] <pnkfelix> kimundi: I like erickt was unaware of that
[16:12:58] <eddyb> s/like/,like/?
[16:13:10] <erickt> I like you too, pnkfelix :D
[16:13:11] <eddyb> I guess HashMap can be extended with (K, V) pairs
[16:13:27] <eddyb> map.push((k, v)); would be weird to see
[16:13:35] <eddyb> but it's shorter than insert. what gives?
[16:13:38] <kimundi> hm, make check-stage1 doesn't compile stage1 libsyntax
[16:13:56] <eddyb> kimundi: and with good reason :P?
[16:14:03] <erickt> I was actually thinking we have 3 generic container (or shall we call em collections??) traits: Seq, Set, Map
[16:14:21] <erickt> Along with those we have the mutable forms of MutableSeq, MutableSet, MutableMap
[16:14:27] <kimundi> eddyb: How can "testsuite doesn't complete" be a good reason? :P
[16:14:29] <pnkfelix> erickt: no Bag?  :(
[16:14:36] *** Quits: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca) (Quit: canhtak)
[16:14:37] <erickt> we can leave methods like .push* defined only on Seq types
[16:14:39] <eddyb> kimundi: do you have NO_REBUILD on?
[16:14:42] <kimundi> no
[16:14:51] <erickt> and the number 4 container is Bags! bags for everyone!
[16:14:55] *** Joins: gimpf (gimpf@moz-11D9DBFB.adsl.highway.telekom.at)
[16:15:02] <eddyb> pnkfelix: put_in and take_out?
[16:15:44] <pnkfelix> eddyb: eh?  (Impromptu bikeshed?)
[16:15:44] <eddyb> (so many kinds of bags I have a hard time choosing which ones to make fun of)
[16:16:00] <erickt> Since this all doesn't sound like a crazy idea, I'm going to take this patch and a couple of my other collection papercut issues and merge them into a proper RFC
[16:16:31] <erickt> where we can pick the proper bikeshed color
[16:17:20] <kimundi> urg, the worst thing about changining Extendable and FromIterator is that each "&mut T instead of T" type error stops the compilation, so I have to run make for every single change.
[16:17:32] <kimundi> erickt: Good idea
[16:18:05] <erickt> kimundi: are you already doing this conversion?
[16:19:04] *** Joins: Meistarin (Nsa@moz-C7E162F6.ca.us.panicbnc.net)
[16:19:04] *** Quits: Meistarin (Nsa@moz-C7E162F6.ca.us.panicbnc.net) (Max SendQ exceeded)
[16:19:34] *** Joins: Meistarin (Nsa@moz-C7E162F6.ca.us.panicbnc.net)
[16:19:34] *** Quits: Meistarin (Nsa@moz-C7E162F6.ca.us.panicbnc.net) (Max SendQ exceeded)
[16:20:04] *** Joins: Meistarin (Nsa@moz-C7E162F6.ca.us.panicbnc.net)
[16:20:04] *** Quits: Meistarin (Nsa@moz-C7E162F6.ca.us.panicbnc.net) (Max SendQ exceeded)
[16:20:34] *** Joins: Meistarin (Nsa@moz-C7E162F6.ca.us.panicbnc.net)
[16:20:34] *** Quits: Meistarin (Nsa@moz-C7E162F6.ca.us.panicbnc.net) (Max SendQ exceeded)
[16:21:12] <kimundi> only for extend and FromIterator
[16:23:11] <eddyb> nmatsakis: *sigh* this will cause some fun issues LvalueDatum(Datum<Lvalue>)
[16:23:26] <eddyb> nmatsakis: why do circular globs have to be broken :(?
[16:28:46] <pnkfelix> huon: re #13016, acrichto probably meant "will need much thought", not "need much though"
[16:30:50] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[16:30:50] *** ChanServ sets mode: +o tjc
[16:31:49] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[16:31:49] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/ln-p4g
[16:31:49] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[16:32:25] *** Joins: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca)
[16:35:32] <eddyb> this reminds me of myself :)) http://www.reddit.com/r/Minecraft/comments/20wnkk/so_is_it_snapshot_day_today/
[16:36:44] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[16:36:44] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/C-I_oQ
[16:36:44] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[16:36:45] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[16:36:45] <ghrust> [13rust] 15bors pushed 10 new commits to 06auto: 02http://git.io/JmPobA
[16:36:45] <ghrust> 13rust/06auto 143ff8c2b 15Corey Richardson: Remove libc from std...
[16:36:45] <ghrust> 13rust/06auto 145b229bf 15Corey Richardson: fix fallout from std::libc separation
[16:36:45] <ghrust> 13rust/06auto 149cb2739 15Corey Richardson: Add unrecognized_lint
[16:36:47] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[16:36:53] <kimundi> eddyb: Ah, snap landed?
[16:37:20] <eddyb> kimundi: https://github.com/mozilla/rust/pull/13026
[16:38:35] <kimundi> darn
[16:39:33] *** Quits: lpy (lpy@1834E2CB.F09091A8.1348A864.IP) (Client exited)
[16:42:21] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[16:42:37] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[16:50:34] <sinistersnare> just finished removing all warns about deprecated `
[16:50:49] <sinistersnare> ~[], should i just submit a PR, or await some sort of approval?
[16:51:47] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[16:51:47] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/DSsVCg
[16:51:47] <ghrust> 13rust/06auto 140305ed5 15Alex Crichton: std: Add Vec to the prelude...
[16:51:47] <ghrust> 13rust/06auto 147a5a8c3 15Alex Crichton: rustc: Default the ~[] lint to allow for now...
[16:51:47] <ghrust> 13rust/06auto 14da36251 15Alex Crichton: Removing imports of std::vec_ng::Vec...
[16:51:49] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[16:52:47] <sinistersnare> https://github.com/mozilla/rust/commit/da3625161d8f8bcb2f43d703eec8d002d0bb9c87 :(
[16:53:45] *** Joins: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP)
[16:56:09] *** Quits: Kxepal (Miranda@moz-5876CFFD.pppoe.mtu-net.ru) (Ping timeout)
[16:57:56] *** Quits: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com) (Client exited)
[16:59:50] *** Joins: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com)
[17:00:18] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Quit: Leaving...)
[17:00:28] *** Joins: Kxepal (Miranda@moz-B1712077.pppoe.mtu-net.ru)
[17:04:16] <sfackler> cmr: pong
[17:16:16] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:23:32] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: rcirc on GNU Emacs 24.3.1)
[17:24:14] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[17:27:11] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[17:27:24] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:27:28] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[17:27:28] *** ChanServ sets mode: +ao dherman dherman
[17:27:51] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[17:27:51] *** ChanServ sets mode: +o tjc
[17:28:10] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[17:31:36] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[17:31:36] <ghrust> [13rust] 15alexcrichton 04force-pushed 06try from 1479990e6 to 14048726c: 02http://git.io/k471pw
[17:31:36] <ghrust> 13rust/06try 140761be0 15Alex Crichton: rustc: Switch defaults from libgreen to libnative...
[17:31:36] <ghrust> 13rust/06try 14db5e81e 15Alex Crichton: rand: Rewrite OsRng in Rust for windows...
[17:31:36] <ghrust> 13rust/06try 14048726c 15Alex Crichton: rustdoc: Always run tests in a M:N pool
[17:31:38] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[17:34:23] *** Joins: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[17:35:41] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[17:46:49] *** Quits: luz (lu.cy@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[17:47:48] <eddyb> where's pnkfelix? I want to stare at graphs
[17:48:03] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[17:49:25] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[17:54:53] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[17:54:53] *** ChanServ sets mode: +ao pcwalton pcwalton
[17:55:56] <edwardw> what is supposed to be the sub/sup-type relationship between UnsafeFn, ImpureFn and ExternFn?
[17:56:05] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[17:56:10] <eddyb> no idea, just kill ExternFn
[17:56:17] <eddyb> I assume we handle the ABI correctly
[17:56:42] *** Joins: luz (lu.cy@moz-CD18B14B.customer.cdi.no)
[17:56:47] <eddyb> edwardw: but, technically, extern is unsafe which is impure
[17:57:20] <edwardw> k
[17:58:22] <edwardw> what the code base implements seems to be extern <: impure <: unsafe
[17:58:35] <acrichto> edwardw: Impure and such are relics of long ago, I think all we have now is "regulard" and unsafe
[17:58:50] <eddyb> acrichto: Impure is still technically correct :D
[17:59:06] <acrichto> I think Impure == Extern though
[17:59:07] <eddyb> acrichto: the enum name, Purity, is outdated, since we have nothing pure
[17:59:19] * acrichto reminisces about 'pure fn'
[17:59:21] <eddyb> nothing uses ExternFn for anything
[17:59:24] <acrichto> so glad it's gone
[17:59:25] <edwardw> that should be the root cause of my mysterious rustdoc assertion
[17:59:35] <eddyb> edwardw: you can just remove ExternFn completely
[17:59:42] <edwardw> k
[17:59:48] <edwardw> I shall try that then
[18:00:01] <acrichto> be careful though, I'd want to verify that with someone more knowledgeable than I
[18:00:08] <eddyb> acrichto: grep for ExternFn :P
[18:00:27] <edwardw> who should I ask then?
[18:00:33] <acrichto> again, I just want to make sure
[18:00:37] <edwardw> s/who/whom
[18:00:43] <eddyb> acrichto: it's dead all but for printing. where it causes issues
[18:01:02] <acrichto> if that's true then it's probably ok, but we should still print "extern fn()" correctly
[18:01:24] <eddyb> rusti: extern "C" fn foo() {} foo
[18:01:25] -rusti- pastebinned 8 lines of output: http://sprunge.us/jHNG
[18:01:44] <eddyb> acrichto: ^^ the error has the type
[18:01:50] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[18:01:50] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/DSsVCg
[18:01:50] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[18:01:56] <eddyb> the extra extern in there is from ExternFn. everything else works nicely
[18:02:27] <eddyb> I also think that maybe we can have `unsafe fn` be a combination of a "rust-unsafe" ABI (which would make it unsafe to call) + wrapping the body in an unsafe block
[18:02:31] <edwardw> yes, one unsafe gets substituted to extern
[18:02:50] <eddyb> then extern "C" unsafe fn would just gets its body wrapped, the "C" ABI should make it unsafe already
[18:04:32] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[18:04:32] *** ChanServ sets mode: +o tjc
[18:04:56] *** Quits: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com) (Client exited)
[18:06:44] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[18:06:45] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/aP_98g
[18:06:45] <ghrust> 13rust/06auto 1411ac4df 15Alex Crichton: Register new snapshots
[18:06:45] <ghrust> 13rust/06auto 147334c11 15bors: auto merge of #13026 : alexcrichton/rust/snapshots, r=huonw
[18:06:45] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[18:12:42] <kimundi> erickt: Did you write something up about Iterator by-value stuff?
[18:14:46] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[18:15:24] <erickt> kimundi: no, not yet. I won't be able to get to it until after work
[18:18:24] *** Quits: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP) (Input/output error)
[18:18:25] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[18:27:18] *** Joins: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP)
[18:32:56] *** Quits: eibwen (kvirc@moz-B8CF119D.dip0.t-ipconnect.de) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[18:33:49] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:36:38] *** Quits: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca) (Client exited)
[18:36:52] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:39:13] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:39:19] *** Joins: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com)
[18:40:26] *** Quits: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com) (Quit: Leaving.)
[18:40:30] *** Joins: brson (brson@moz-62518563.mtv2.mozilla.com)
[18:40:30] *** ChanServ sets mode: +qo brson brson
[18:41:13] *** Joins: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca)
[18:41:14] *** Quits: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca) (Quit: canhtak)
[18:41:25] *** Joins: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca)
[18:54:25] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[18:56:04] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[18:56:04] *** ChanServ sets mode: +o tjc
[18:58:00] <edwardw> eddyb: works like a charm! ExternFn is gone
[18:59:02] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:59:24] <eddyb> \o/
[19:01:01] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:06:36] <kimundi> eddyb: https://github.com/mozilla/rust/pull/13039
[19:07:43] <larsberg> When I'm building a --crate-type staticlib and get a whole bunch of "warning: unlinked native library: <name>", what flags, attributes, or otherwise is rustc asking me to add?
[19:08:43] <eddyb> larsberg: why are you building a staticlib?
[19:08:48] *** Quits: gwty (gwtypc@5F452814.1C047769.25B273F5.IP) (Ping timeout)
[19:08:58] <eddyb> (if it's for servo, I don't really see why you would have to)
[19:09:41] <larsberg> eddyb: I'm playing around with it for our android scenario, to see if we can get out of the madness that is our "shared lib (for android) that loads a shared lib (servo) via dlopen" strategy
[19:10:10] <eddyb> ahh
[19:10:26] <eddyb> larsberg: so building servo as staticlib?
[19:10:29] <larsberg> Trying to avoid it mainly because dlsym on android is... ungood.
[19:10:42] <larsberg> Yup, trying to make servo (all the rust code) staticlib.
[19:11:00] <eddyb> and link it against what?
[19:11:06] <eddyb> or link what against it?
[19:11:09] <larsberg> But we still reference a bunch of so files for all our native dependencies... though I guess I could change that, if necessary.
[19:11:15] *** Joins: gwty (gwtypc@5F452814.1C047769.25B273F5.IP)
[19:11:38] <eddyb> larsberg: I'm curious why rlib won't just... work
[19:11:57] <eddyb> I guess you need to feed the static library into the NDK build process?
[19:12:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:12:37] <larsberg> Yup. For the NDK, you have to build a shared library with a bunch of magical properties. Maybe the Right Thing is to see if I can export all those magical properties from the servo shared lib and use it directly....
[19:12:46] *** Quits: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com) (Ping timeout)
[19:13:41] <eddyb> larsberg: I don't really understand the nesting
[19:14:02] <eddyb> what does android load? a shared library, or a Java shim that loads a shared library?
[19:14:10] <eddyb> how native is NDK?
[19:14:24] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:15:38] <larsberg> eddyb: I don't fully know what happens on-device (as far as a Java shim goes). My Android APK is only native files, including a manifest that points at a .so that is compiled from some native C++ code with all the right exports that the Java shim/loader/whatever knows how to launch.
[19:16:11] <eddyb> ah, so the APK contains an .so. fair enough
[19:16:43] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[19:16:43] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/aP_98g
[19:16:43] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[19:18:04] <larsberg> Yeah, I was trying to just get all the rust code linked right into it, but perhaps the right thing is to avoid having the separate C++ shim code entirely.
[19:18:48] <eddyb> larsberg: what does the C++ shim look like?
[19:19:00] <eddyb> (I have the NDK, I just don't know which files to look at)
[19:20:01] <larsberg> eddyb: It's pretty trivial; the jni/main.cpp file in any of the examples. Basically just define a `main` function. The mystery for me is what's in the native_app_glue stuff you're required to link into your binary.
[19:20:15] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:21:44] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[19:21:44] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/dVrO9g
[19:21:44] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[19:21:44] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[19:21:44] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/ZS8lbw
[19:21:44] <ghrust> 13rust/06auto 140de6441 15Daniel Micay: rm obsolete references to `DeepClone`
[19:21:44] <ghrust> 13rust/06auto 14bc6f027 15bors: auto merge of #13023 : thestinger/rust/deep_clone, r=alexcrichton
[19:21:45] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[19:22:35] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:28:50] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:29:02] *** Quits: sinistersnare (sinistersn@moz-7E48AC93.washdc.fios.verizon.net) (Quit: Leaving)
[19:29:35] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[19:30:42] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[19:31:01] <kimundi> erickt: https://github.com/mozilla/rust/pull/13039
[19:31:24] <erickt> kimundi: awesome
[19:35:24] *** Joins: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com)
[19:37:13] <erickt> kimundi: part of what I wanted to bring up in my RFC was defining methods like `Vec.flat_map` in terms of the iterator expression you just metion. Are you opposed to these methods in general?
[19:37:38] <eddyb> I'd like in-place operations
[19:38:06] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[19:38:19] <kimundi> erickt: Well, the plan was always kinda that one day Iterable works, and we can just call the iterator adapters like `vec.flat_map().collect()`
[19:38:50] <kimundi> erickt: If the same names get implemented of the Containers directly by something different, that would conflict
[19:38:52] <erickt> kimundi: so: `trait Seq<T, Iter: Iterable<T>> { fn map<U, Out>(&self, f: |T| -> U) -> Out { self.iter().map(f).collect() } }`
[19:39:11] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[19:39:16] <eddyb> erickt: cool
[19:39:59] <erickt> although I'm not sure we've shaken out all the bugs that have so far prevented an Iterable<T> trait
[19:40:23] <kimundi> erickt: If the community decides that is better than having Iterable, then I wouldn't oppose. But it seems kinda duplicate-ish to me.
[19:40:57] <erickt> Oh. right. I could put all these impls on the Iterable<T> trait :)
[19:41:03] <kimundi> yeah
[19:41:55] <kimundi> but the problem is: should iterable be defined for self, &self or &mut self or all three with some kind of fallback?
[19:42:41] <eddyb> the answer is obvious
[19:42:47] <eddyb> make collect implicit
[19:42:48] <erickt> kimundi: I was thinking there'd be a `Iterable<T>`, `MutIterable<T>`, and `MoveIterable<T>~
[19:43:05] <eddyb> erickt: and RefIterable?
[19:43:06] <erickt> for `&self`, `&mut self`, and `self`
[19:43:20] <eddyb> why not impl on &/&mut/value?
[19:43:25] <kimundi> eddyb: RefIterable?
[19:43:39] <eddyb> kimundi: I didn't understand what erickt meant, ignore that
[19:44:16] <kimundi> erickt: (Aside: These days we should avoid the term `Move` for something that is defined with by-value semantics, not everything moves after all)
[19:44:28] <kimundi> eddyb: okay ;)
[19:44:29] *** Quits: KokaKiwi (kokakiwi@moz-D674DAC6.kokakiwi.net) (Ping timeout)
[19:44:46] <eddyb> erickt: is there anything wrong with one trait implemented on values or references?
[19:45:05] <eddyb> erickt: I guess we couldn't really put the lifetimes in all the right places until now
[19:45:18] <kimundi> eddyb: example?
[19:45:19] <erickt> so here's an explicit example of the traits: https://gist.github.com/erickt/9672253
[19:45:34] <erickt> dunno if that'd actually work
[19:46:03] <eddyb> kimundi: ^^ well, lifetimes like that never worked until last week
[19:46:44] <eddyb> erickt: but why not trait Iterable<T, Iter: Iterator<T>> {fn iter(self) -> Iter;}?
[19:46:49] <eddyb> erickt: is there any issue with that?
[19:47:07] <eddyb> I guess there's some subtle things, when you're generic over Iterable
[19:47:14] <kimundi> erickt: I don't understand why Iterator<&'a T> and Iterator<&'a mut T> need to be hardcoded to references
[19:47:19] <erickt> kimundi: what should we use to distinguish the two? Should `Iterable` correspond to by-value consuming of self, and `RefIterable` be iterating over the references?
[19:47:29] <eddyb> erickt: why distinguish?
[19:47:54] <eddyb> (since you can't have a bound on &T but only on T, if T is a type parameter. that might be the main issue. but I think it can be solved with a proxy trait)
[19:48:02] <kimundi> I guess Iterable for value, RefIterable and MutIterable would be be more consistent with current terminology
[19:48:14] <eddyb> why more than one trait?
[19:48:46] <kimundi> eddyb: If you have a immutable data structure, you can't provide a mut_iter
[19:48:47] <erickt> eddyb: because we have types, like Vec, that provide 2 ways to iterate over the values. `.iter()` and `.move_iter()`
[19:49:07] *** Joins: KokaKiwi (kokakiwi@moz-D674DAC6.kokakiwi.net)
[19:49:17] <eddyb> kimundi: oh, that
[19:49:28] <erickt> and we could argue that Vec should have a `.mut_iter()` that allows for inplace modification of values
[19:49:37] <nrc> nmatsakis: ping
[19:49:38] <eddyb> this will end up in the same bikeshed like the Fn traits
[19:49:39] <kimundi> (I'd like to rename those methods to something like .refs(), .mut_refs() and .values() btw)
[19:49:42] <eddyb> 4 instead of one :(
[19:49:53] <kimundi> eddyb: 4?
[19:50:05] <eddyb> 3, sorry
[19:50:10] <eddyb> kimundi: .values() is not a good idea IMO
[19:50:30] <kimundi> .into_values()
[19:50:43] <kimundi> since it kinda turns the data structure into a iterator
[19:50:43] <eddyb> strcat has a pretty good idea, implement a .values() *automatically* on anything that iterates references of Pods
[19:50:56] <kimundi> eddyb: Yeah, know about that one
[19:50:57] <erickt> and maybe `.as_refs()` and `.as_mut_refs()`
[19:51:03] <erickt> ?
[19:51:18] <sfackler> erickt: http://static.rust-lang.org/doc/master/std/vec/struct.Vec.html#method.mut_iter
[19:51:18] <kimundi> erickt: Thats what I meant with refs() and mut_refs() :)
[19:52:05] <kimundi> since we are not lightly casting, but constructing a new iterator in any case, the as_ prefix would be wrong I think
[19:52:17] <erickt> sfackler: oh neat I didn't know that existed already
[19:52:42] <kimundi> for example TreeMaps .iter() is very much not a light cast, because it contains a stack.
[19:53:34] <erickt> I added all these bikeshedding to my RFC draft
[19:53:40] *** Joins: bmurphy1976 (bmurphy197@46E64081.D240E006.6624BF1.IP)
[19:54:01] <kimundi> erickt: We already have the container iterable trinity of iter(), mut_iter() and move_iter(), Iterable traits would codify each of these three
[19:54:04] <nmatsakis> nrc: pong
[19:54:09] <eddyb> acrichto: did we get snapshot :D?
[19:54:15] <kimundi> eddyb: we did
[19:54:28] <eddyb> I mean, merged and stuff
[19:54:39] <eddyb> hmpf, what can I work on :/
[19:54:56] <acrichto> eddyb: I just found an assertion "vtables missing where they are needed" related to autoderef
[19:54:57] <eddyb> ast::P? I don't have time :(
[19:55:00] <acrichto> trying to minimize
[19:55:16] <eddyb> that sounds familiar
[19:56:09] <eddyb> acrichto: what did you do?
[19:56:20] <eddyb> acrichto: ah hehe
[19:56:28] <eddyb> acrichto: it's the RWLock and the Mutex
[19:56:28] <erickt> kimundi: I should probably make a couple RFCs instead of one uber-lets-clean-up-libcollections. I'll split Iterable into it's own RFC
[19:56:43] <eddyb> acrichto: I didn't expect people to put bounds on those
[19:56:45] <kimundi> sure
[19:56:50] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:56:53] <eddyb> acrichto: and later forgot about it :/
[19:57:03] *** Quits: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:57:29] <eddyb> acrichto: long story short, you can't call methods from traits bounding type params of deref impls
[19:57:32] <nrc> nmatsakis: DST/unsized question: http://pastebin.mozilla.org/4635939
[19:57:48] <nrc> nmatsakis: would you expect that error, or something similar? Should this thing type check?
[19:57:52] * acrichto sighs
[19:58:09] <eddyb> acrichto: can you simplify the impls until that gets fixed?
[19:58:10] <nrc> nmatsakis: I am confused around how the `unsized` on Self gets checked
[19:58:33] <acrichto> eddyb: I still don't understand what's going on
[19:58:41] <eddyb> acrichto: why do you even call methods in deref impls, anyways? they're supposed to be very simple
[19:59:04] <acrichto> you're saying words, and I don't know how they have relevance
[19:59:14] <eddyb> acrichto: impl<T: Trait> Deref<T> for Foo<T> {fn deref<'a>(&'a self) -> &'a T {self.method_that_has_Trait_bound()}
[19:59:23] <eddyb> acrichto: the Trait wants a vtable
[19:59:26] <acrichto> yes?
[19:59:33] <acrichto> is that not valid?
[19:59:34] <eddyb> where do you do this?
[19:59:49] <nmatsakis> nrc: not related to your question, but fwiw I've changed my pref from an unsized keyword to pnkfelix's type proposal http://blog.pnkfx.org/blog/2014/03/13/an-insight-regarding-dst-grammar-for-rust/
[20:00:04] <eddyb> acrichto: it is, bug caused by me not thinking ahead. still, most deref impls shouldn't need those
[20:00:05] <nmatsakis> nrc: anyway, let me look at your example :)
[20:00:15] <acrichto> eddyb: https://github.com/alexcrichton/rust/blob/rewrite-sync/src/libsync/arc.rs#L159-L162
[20:00:35] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[20:00:35] <nmatsakis> nrc: I don't expect that to compile for numerous reasons
[20:00:44] <eddyb> acrichto: aww it's unsafe :/
[20:00:49] <nrc> nmatsakis: that is just s/unsized/type, right? SO should be very easy to change
[20:01:01] <nmatsakis> nrc: more or lesss yes :)
[20:01:12] <nmatsakis> nrc: (1) local variable of unsized type shouldn't be permitted
[20:01:18] <eddyb> acrichto: the workaround is copying what inner() does within the deref impl and open an issue
[20:01:40] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[20:01:40] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14bc6f027 to 147334c11: 02http://git.io/N3iJvQ
[20:01:40] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[20:01:40] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[20:01:40] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/IIii-g
[20:01:40] <ghrust> 13rust/06auto 148289430 15Daniel Fagnan: Added new attribute syntax with backward compatibility....
[20:01:40] <ghrust> 13rust/06auto 14c34f65c 15Alex Crichton: syntax: Tidy up parsing the new attribute syntax
[20:01:41] <nmatsakis> nrc: (2) if X is unsized, then it can't be bound by T2 (though I'm not sure if we need to enforce that per se)
[20:01:41] <ghrust> 13rust/06auto 14ecd91ec 15bors: auto merge of #13037 : alexcrichton/rust/attr-syntax, r=brson...
[20:01:43] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[20:02:14] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[20:02:18] <nmatsakis> nrc: I think the only condition I would enforce is #1 there,
[20:02:24] <nmatsakis> nrc: but if you tried to implement T2 for an unsized type,
[20:02:27] <nmatsakis> nrc: you'd get an error
[20:02:37] <nmatsakis> nrc: e.g., `impl T2 for [int]`
[20:02:37] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[20:02:38] *** ChanServ sets mode: +ao pcwalton pcwalton
[20:02:43] <eddyb> acrichto: I'm sorry :(
[20:02:55] <acrichto> oh no worries!
[20:03:12] <eddyb> it took me so long and I didn't even bother to implement vtable support :/
[20:03:24] * eddyb => sleep
[20:05:36] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[20:07:18] <nrc> nmatsakis: for 2, it would be an error because we shouldn't allow unsized types to have impls for traits?
[20:07:39] <larsberg> Should "-C prefer-dynamic" produce a .dylib if the only crate attribute in the library is #[crate_type = "lib"];? I'm seeing it still produce a .rlib. Or am I misunderstanding the documentation in the manual?
[20:08:31] <nmatsakis> nrc: no, but because the trait wasn't declared as possibly having an unsized Self
[20:08:49] <nmatsakis> nrc: would have to be trait T2 for unsized { ... } (modulo syntax)
[20:09:28] <nrc> right
[20:10:33] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[20:10:33] *** ChanServ sets mode: +o tjc
[20:11:10] <erickt> kimundi: yay! Iterable<T> works! https://gist.github.com/erickt/9672769
[20:12:11] <nrc> nmatsakis: so the issue I was worried about was that on line 1, T2 is sized, so Self is a sized type, but on line 11 we infer X for the Self type (which is unsized) - should that be an error on line 11, or will it always be caught by 2?
[20:12:37] <kimundi> erickt: Nice, but I'm not sure that Iterable should be defined for Iterator<&T> directly
[20:13:17] <erickt> true
[20:14:04] <nmatsakis> nrc: We could certainly check that the bounds are ever fulfillable, but I don't think there's a particular problem if we don't
[20:14:29] <nmatsakis> nrc: i.e., you'd never be able to call the function with something that's actually unsized I guess...you'd just be adding extra limitations to how you can use instances of t
[20:16:10] <erickt> kimundi: that way seems to lead to an ICE: https://gist.github.com/erickt/9672881
[20:16:26] <nrc> nmatsakis: OK, thanks!
[20:17:31] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[20:17:32] <nrc> nmatsakis: wait, I thought we _were_ going to allow unsized local vars and args, just not allow them as fields? (i.e., stack OK, heap bad)
[20:17:49] <kimundi> erickt: Hm, I wonder if not defining a new map() method, instead making the existing map() be a Iterable impl itself would work
[20:19:08] <erickt> kimundi: do you mean a `trait Mappable { fn map(...) { ... } } impl Mappable for ~[T] { }`?
[20:19:38] <erickt> or just to leave off the default impl for Iterable?
[20:19:41] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[20:20:02] <kimundi> erickt: No, do what Iterator<T> does today, but apply it to Iterable<T>
[20:20:26] *** Quits: bmurphy1976 (bmurphy197@46E64081.D240E006.6624BF1.IP) (Quit: Textual IRC Client: www.textualapp.com)
[20:21:04] <kimundi> foo.map() would return a Map iterator and call move_iter() because it is defined to take self by value for example
[20:21:24] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[20:21:56] <kimundi> We would need to make every Iterator adapter implement Iterable and MutIterable though
[20:22:26] <erickt> well I did want to make Iterator also implement Iterable :)
[20:23:00] <erickt> that would let us do `let x = ~[1,2,3]; x.extend(~[4,5,6]); x.extend(~[7,8,9].move_iter())`
[20:23:17] <kimundi> yeah
[20:25:02] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:25:07] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:25:31] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:25:51] *** flaper87|afk is now known as flaper87
[20:27:51] <erickt> kimundi: so defining Iterable to be `Iterator<T>` is icing because it looks like methods still don't like having lifetime in typaram bounds
[20:28:27] <erickt> kimundi: so I think for now we'd have to declare Iterable as `trait Iterable<'a, T, Iter: Iterator<&'a T>> { ... }`
[20:29:27] <kimundi> That will restrict it though
[20:30:46] <erickt> I'm having trouble thinking of a case where it'd be restrictive, only inconvenient. Can you think of one?
[20:36:42] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[20:36:42] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14ecd91ec to 147334c11: 02http://git.io/N3iJvQ
[20:36:42] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[20:36:43] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[20:37:15] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[20:38:54] <nmatsakis> nrc: I intend to only allow parameters
[20:38:57] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[20:39:04] <nmatsakis> nrc: I don't think we can allow local variables safely
[20:39:09] <nmatsakis> nrc: without some kind of lifetimes
[20:40:41] <nrc> nmatsakis: why are they different to arguments in that respect?
[20:40:58] <kimundi> erickt: Well not everything that implements .iter() is going to return a iterator over references I think
[20:42:40] <kimundi> erickt: Though maybe they shouldn't implement it like that anyway then. Okay forget what I said, them always returning a reference sounds like a good idea actually.
[20:42:56] <kimundi> couldn't implement .values() otherwise for example
[20:43:07] <nmatsakis> nrc: https://gist.github.com/nikomatsakis/9673400
[20:43:24] <nmatsakis> nrc: we might be able to come up with a more limiting rule but...
[20:43:49] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[20:44:19] <erickt> kimundi: hrm. One downside is that we can only implement methods like `.map()` only for Iteratable, MutIterable, or MoveIterable. 
[20:44:53] <erickt> *Iterable
[20:45:07] *** Quits: edwardw (edwardw@3570A9BA.4E6A4251.FAED9FFC.IP) (Quit: Leaving...)
[20:45:24] <erickt> that might not be terrible, because you could always do `x.move_iter().map(|x| *x + 1).collect()`
[20:45:46] <kimundi> erickt: Right, I expect them to be implemented on either MoveIterable or MutIterable, without overlap
[20:46:07] <erickt> another item for the RFC!
[20:47:43] <kimundi> erickt: Heh, I started sketching a version of Iterable myself, and directly got an ICE
[20:47:57] <erickt> there be dragons in this feature
[20:48:00] * strcat doesn't think rustc is ready for iterable ;(
[20:48:34] <erickt> strcat: it actually kinda works right now: https://gist.github.com/erickt/9673494
[20:48:56] <strcat> erickt: try doing it for both slices and one like Vec/HashMap
[20:49:24] <strcat> (or ~[T] as you already did)
[20:50:17] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[20:50:17] *** ChanServ sets mode: +o tjc
[20:51:20] <erickt> strcat: yeah I'm sure there are ICEs that'll prevent this from working. In the worst case though we can at least get an RFC written up and debated until those ICEs are fixed
[20:52:56] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[20:53:16] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[20:54:05] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[20:54:05] *** ChanServ sets mode: +ao pcwalton pcwalton
[20:54:57] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[20:55:48] <nrc> nmatsakis: your gist - I don't see anything DST specific there, isn't line 5 just wrong?
[20:56:51] *** flaper87 is now known as flaper87|afk
[20:57:00] <nmatsakis> nrc: no
[20:57:03] <nmatsakis> nrc: only in DST
[20:57:13] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[20:57:28] <nmatsakis> nrc: the point is that passing a dst "by value" isn't really possible in the normal sense
[20:57:33] <nmatsakis> because we don't know how big it is
[20:57:44] <nmatsakis> normally we would: allocate space on the stack, move the data there
[20:57:49] <nmatsakis> but in DST we can't do that
[20:57:54] <nmatsakis> we can only pass pointers to the space the value is already located
[20:58:10] <nmatsakis> for a time I wanted to add a new kind of pointer (sometimes called `&move`) to represent this notion:
[20:58:16] <nmatsakis> I am pointing at memory that I do not own, but whose contents I own
[20:58:29] <nmatsakis> but really it's not that useful in general, only useful for DST equivalent of by-move
[20:58:37] <nmatsakis> so simpler version is just to limit it to parameters, where it works ok
[20:58:42] <nmatsakis> by the nature of the functional call 
[20:58:43] <nmatsakis> *function call
[20:59:05] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Quit: Computer has gone to sleep.)
[20:59:23] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[20:59:29] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[20:59:38] <erickt> does anyone have a good trick that'll allow for impl-ing a trait for all Iterators? as in https://gist.github.com/erickt/9673666?
[20:59:52] <nrc> nmatsakis: what exactly about the nature of funtion calls makes it easier?
[21:00:50] <acrichto> quick r? https://github.com/mozilla/rust/pull/13043
[21:00:55] <acrichto> (causing some spurious bot failures)
[21:01:09] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[21:02:04] <nmatsakis> nrc: because the function can't return the value, so it can't outlive the expression where the move occurred, basically
[21:02:26] <nmatsakis> nrc: well in a sense the function *can* return the value, but only by using Rc::new) or some allocation expression, which will dynamically probe to see how much memory is needed
[21:02:51] <nmatsakis> nrc: (that dynamic probing is part of the RFC I have yet to write, it was relatd to the allocator trait and so on)
[21:03:13] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[21:03:15] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[21:03:29] <nmatsakis> nrc: unfortunately I have to run, let's find a time to talk later tho
[21:03:46] <nrc> nmatsakis: sure, thanks!
[21:04:07] <nmatsakis> nrc: (if it helps, it's analagous to the "ref mode" parameters many languages -- including Rust in the bygone days -- have)
[21:04:25] <nmatsakis> of which lifetimes were a generalization
[21:04:40] <nmatsakis> anyhow
[21:06:20] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[21:06:20] *** ChanServ sets mode: +o tjc
[21:08:51] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:10:08] *** Quits: Zr40 (zr40@moz-CCFEAB92.adsl.xs4all.nl) (Quit: leaving)
[21:13:30] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[21:14:31] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[21:14:31] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:15:04] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[21:16:40] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[21:16:40] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1475f68a4 to 147334c11: 02http://git.io/N3iJvQ
[21:16:40] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[21:16:41] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[21:16:41] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/nf_6sg
[21:16:41] <ghrust> 13rust/06auto 148289430 15Daniel Fagnan: Added new attribute syntax with backward compatibility....
[21:16:41] <ghrust> 13rust/06auto 14fae3cef 15Alex Crichton: syntax: Tidy up parsing the new attribute syntax
[21:16:41] <ghrust> 13rust/06auto 1440252b2 15bors: auto merge of #13037 : alexcrichton/rust/attr-syntax, r=brson...
[21:16:43] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[21:27:16] *** flaper87|afk is now known as flaper87
[21:28:30] *** Quits: gwty (gwtypc@5F452814.1C047769.25B273F5.IP) (Ping timeout)
[21:30:53] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:32:29] *** Joins: gwty (gwtypc@123D3329.2908BEAF.25B273F5.IP)
[21:33:14] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:34:36] *** flaper87 is now known as flaper87|afk
[21:35:28] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[21:37:44] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:40:04] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:40:22] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[21:42:56] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:46:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:48:58] *** Quits: brson (brson@moz-62518563.mtv2.mozilla.com) (Ping timeout)
[21:50:12] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[21:52:37] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:53:25] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[21:53:26] *** ChanServ sets mode: +qo brson brson
[21:54:55] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:01:30] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[22:01:48] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[22:01:48] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1440252b2 to 147334c11: 02http://git.io/N3iJvQ
[22:01:48] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[22:01:49] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[22:01:49] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/yrvIGQ
[22:01:49] <ghrust> 13rust/06auto 140de6441 15Daniel Micay: rm obsolete references to `DeepClone`
[22:01:49] <ghrust> 13rust/06auto 146eae7df 15bors: auto merge of #13023 : thestinger/rust/deep_clone, r=alexcrichton
[22:01:49] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[22:02:15] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:04:41] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:05:54] <huon> r? https://github.com/mozilla/rust/pull/13016
[22:06:01] <huon> cmr: mem-bench? ^
[22:06:09] <cmr> huon: I'm benching it now
[22:06:13] <huon> \o/
[22:07:27] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:08:29] *** Joins: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net)
[22:09:35] *** Quits: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net) (Quit: Leaving.)
[22:13:17] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[22:13:18] *** ChanServ sets mode: +o tjc
[22:14:19] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:16:02] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[22:16:40] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:18:17] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[22:20:18] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:21:32] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[22:21:32] *** ChanServ sets mode: +o tjc
[22:22:42] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:27:42] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[22:27:45] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:28:05] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[22:28:05] *** ChanServ sets mode: +o tjc
[22:29:24] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[22:29:55] <cmr> huon: rebase and r=me
[22:31:20] <olsonjeffery> looking at `rustc -W help` .. i wish there was a way to convert all of the default warn lints to deny/forbid .. there?
[22:31:34] <cmr> olsonjeffery: -D warnings
[22:31:41] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Quit: Leaving)
[22:31:51] <olsonjeffery> cmr: ah! there it is at the end
[22:31:54] <olsonjeffery> thanks, heh.
[22:33:19] <huon> acrichto: comments? https://github.com/mozilla/rust/pull/13016#issuecomment-38167928
[22:33:32] <huon> cmr: thanks (not sure what acrichto things of using more unsafe code though...)
[22:35:05] <acrichto> huon: the only new unsafe code is in owned_slice.rs?
[22:35:50] <huon> acrichto: there's one raw constructor function added to Vec
[22:36:00] <huon> to go from length, capacity, pointer -> Vec
[22:36:13] <acrichto> oh yeah that looked fine, I'm not worried about that
[22:36:25] <acrichto> I still think it's a bit too soon for this, but I'm not gonna stop you now that you've implemented all of it
[22:36:36] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:36:38] <acrichto> got some nice memory wins as well!
[22:36:40] <acrichto> r+
[22:37:04] <huon> thanks
[22:38:23] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:40:54] <olsonjeffery> does iter have a to_owned_vec() equiv for vec_ng::Vec ?
[22:42:11] <sfackler> collect'd be the closest
[22:42:12] *** Quits: TimAbraldes (quassel@125EF623.B2666F0E.66399531.IP) (Input/output error)
[22:43:14] <kimundi> olsonjeffery: No it doesn't, and to_owned will die someday. ;)
[22:43:31] <kimundi> olsonjeffery: try if .collect::<Vec<_>>() works
[22:44:20] <acrichto> zomg resolve is so big
[22:45:49] <olsonjeffery> kimundi: hence my move to turn all warnings into errors
[22:50:19] *** flaper87|afk is now known as flaper87
[22:51:46] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Ping timeout)
[22:54:05] <huon> acrichto: remove the last half or so, it's so big that no-one will notice it's gone ;P
[22:54:08] <sfackler> kimundi: was that fixed?
[22:54:55] <kimundi> sfackler: I didn't fix anything there - afaik nmatsakis has a RFC hes writing that would include changes that would fix the problem
[22:55:07] <sfackler> kk
[22:56:11] *** Joins: brson (brson@moz-62518563.mtv2.mozilla.com)
[22:56:11] *** ChanServ sets mode: +qo brson brson
[22:58:16] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:00:03] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:03:14] *** Joins: cgaebel (clark@moz-F9D89110.nyc.res.rr.com)
[23:04:35] <huon> acrichto, brson, pcwalton etc: comments? https://github.com/mozilla/rust/issues/12876#issuecomment-38231658
[23:06:23] <acrichto> huon: as a general rule of thumb, I don't want to mark something stable unless I'm happy with it
[23:06:29] <acrichto> I'm not happy with std::sync and libsync
[23:07:02] <huon> the specifics of sync are not what should be focused on
[23:07:10] *** flaper87 is now known as flaper87|afk
[23:07:27] <huon> but rather the movement and changes of libraries
[23:07:37] <acrichto> it's the same idea
[23:07:43] <acrichto> if we're not happy with it then we don't mark it stable
[23:07:50] <acrichto> and yes, once something is stable it's gotta stay there
[23:08:01] <acrichto> this has very little to do with splitting crates, it's just an api question in general
[23:08:06] <acrichto> stable apis need to stay where they are
[23:09:21] <brson> agree. there's no issue there at all
[23:09:33] <huon> ok; so things that will possibly have a better home will never get marked #[stable], in the hope that std (or whatever) will eventually lose the dependency on them?
[23:09:50] <acrichto> along those lines yeah
[23:09:53] <huon> :/
[23:10:03] <acrichto> I read that issue as "watch out, once you stabilize an API it must stay the same"
[23:10:09] <acrichto> which is a fact, not an issue to deal with 
[23:10:16] <brson> i'm hoping to make std a facade over other libraries, to decouple the question of 'what should be in std' from 'what must be in std'
[23:10:37] <huon> I read it as "watch out, stabilising APIs incorrectly will burn us forever"
[23:10:47] <acrichto> they're the same in my mind
[23:10:52] <acrichto> thse are all facts
[23:10:58] <acrichto> no actionalbe things have been mentioned
[23:11:01] <acrichto> other than "be careful"
[23:11:06] <acrichto> which is fairly self-evident
[23:11:31] <huon> ok, I guess I'll just have to cope with swathes of the standard library never being #[stable]...
[23:11:39] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[23:11:39] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/yrvIGQ
[23:11:39] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[23:11:58] <acrichto> that's not going to be the case
[23:12:07] <acrichto> we just can't stabilize everything *right now*
[23:12:20] <acrichto> change comes in time, we have good visions for where we're going, we just need to get there
[23:12:26] <acrichto> for example, I don't want channels in libstd
[23:12:31] <acrichto> it's not really that necessary
[23:12:44] <acrichto> but they will always be available through the standard library/prelude
[23:12:52] <acrichto> with brson's facade this is all possible
[23:13:13] <acrichto> we are hamstrung with what brson mentioned of that the contents are libstd are currently "what must be in libstd"
[23:13:17] <acrichto> not "what should be in libstd"
[23:13:44] <huon> OK, I'm feeling better about this; thanks.
[23:14:03] <cmr> what facade is this?
[23:14:04] <acrichto> but yeah, basically we're not releasing 1.0 without a stable channel API
[23:14:07] <acrichto> that's just disastrous
[23:14:19] <acrichto> cmr: the idea that libstd is just a bunch of 'extern crate foo;' + reexports
[23:14:31] <cmr> so where do all the things that std currently does go?
[23:14:46] <cmr> option, iterators, etc etc
[23:14:51] <acrichto> sharded into their own crates
[23:14:58] <acrichto> this is where things like lib{prim,mini,whatever} will shine
[23:15:01] <huon> I'm still slightly concerned by not really having a policy for what do with crates A and B, where B depends on A, but A needs some things from B.
[23:15:06] <acrichto> libsync will have a minimal number of deps, etc
[23:15:39] <acrichto> it's a tough policy, but the idea is that "everything should has as few dependencies as possible"
[23:15:44] <acrichto> which is true of almost anything
[23:15:51] <acrichto> it just so happens right now that libstd is too large of a dependency
[23:16:18] <huon> I'm also concerned about how many contortions we may have to do to get std split up appropriately (e.g. moving rand out of std wasn't super-great, due to std never being able to use random numbers)
[23:16:42] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[23:16:42] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/TPeh3Q
[23:16:42] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[23:16:57] <huon> and, also with rand, collections depends on rand; so rand can never use any interesting data structures. (Not that I see it needing any.)
[23:17:15] <acrichto> these are all definitely legitimate concerns, but it's all just engineering problems
[23:17:26] <huon> it's not just engineering
[23:17:44] <huon> we need a social/human/design policy for how we arrange our APIs
[23:17:59] <acrichto> I agree
[23:18:20] <acrichto> I think we're still developing that policy, it's not something that's solidified
[23:18:31] <huon> e.g. do we use reexports of secret types + https://github.com/mozilla/rust/issues/13045 do pretend that a type is defined in a different crate?
[23:18:36] <acrichto> up until now it's not been solidified at all, and like the rest of rust we're just iterating until we find something we like
[23:18:46] <acrichto> that's certainly one possibility
[23:20:02] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:20:11] <brson> i wish std::ty had not gotten the greenlight
[23:20:25] <acrichto> I was surprised that got in as well :\
[23:20:36] <brson> that's an odd place to put Unsafe
[23:20:38] * cmr goes to look at what std::ty is
[23:20:54] <acrichto> why not in std::cell?
[23:21:08] <cmr> that's a miserable name...
[23:21:28] <acrichto> miserable names are good though!
[23:21:34] <acrichto> they're fantastic impetus for finding a better one
[23:21:39] <acrichto> *cough* if_ok *cough*
[23:21:49] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:21:54] <cmr> IMO we should be less afraid of std::Foo
[23:21:58] <cmr> std::Unsafe, for example
[23:22:28] <huon> acrichto: but the new name for if_ok has problems too :P
[23:22:56] <acrichto> :(
[23:23:42] <cmr> get should really be get_mut ...
[23:24:00] <cmr> Unsafe::new also isn't a "Static constructor" by any meaning of the rust word
[23:24:03] <cmr> Which PR was this?
[23:24:10] * cmr regrets not looking at it
[23:24:29] <acrichto> 12686
[23:24:52] <huon> someone can go through and clean it up...
[23:25:28] <huon> why does it have the `marker1` field public... with that doc comment?
[23:25:42] <huon> well... why are any of it's fields public?
[23:25:49] <huon> Oh.
[23:25:53] <acrichto> it's public so it can be constructed in statics
[23:25:54] <huon> There's a comment.
[23:25:59] * huon learns to read
[23:26:21] <acrichto> brson: r? https://github.com/mozilla/rust/pull/13043
[23:33:26] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Input/output error)
[23:44:15] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:49:27] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[23:51:05] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
