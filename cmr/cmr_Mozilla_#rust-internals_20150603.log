[00:02:54] *** Joins: mib_l5y7le (Mibbit@moz-juv.9o3.252.72.IP)
[00:09:18] <WindowsBunny> wooo, my RFC merged
[00:10:06] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[00:12:23] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[00:14:38] <Tobba> WindowsBunny: which RFC?
[00:15:01] <WindowsBunny> Tobba: https://github.com/rust-lang/rfcs/pull/1014
[00:15:17] <Tobba> woo
[00:15:53] <Tobba> it was pretty ridiculous how many failure modes hella world had
[00:16:58] <WindowsBunny> Gankro: Lol @ your RFC embrace extend extinguish
[00:17:28] <Tobba> WindowsBunny: was the RFC windows related as well?
[00:17:29] *** Quits: bkearns (Adium@moz-rudtng.static.wiline.com) (Quit: Leaving.)
[00:17:45] <WindowsBunny> Tobba: No, that was just some collections stuff https://github.com/rust-lang/rfcs/pull/839
[00:19:29] <Tobba> WindowsBunny: Gankro, working on collections. how predictable
[00:20:16] <Gankro> WindowsBunny: *finally* someone noticed
[00:20:36] <Gankro> I contribute to Rust pretty much solely to get stupid names canonized in the rfcs repo
[00:20:59] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[00:21:05] <WindowsBunny> Gankro: You're not the first to do EEE though :P
[00:21:25] <Gankro> shit, really?
[00:21:55] *** Joins: wycats (sid79@moz-b4lrm3.brockwell.irccloud.com)
[00:21:55] *** ChanServ sets mode: +o wycats
[00:24:01] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[00:25:03] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[00:27:35] *** Quits: _Vi (vi@moz-bbs.vhj.131.104.IP) (Ping timeout: 121 seconds)
[00:28:26] *** Quits: Diggsey (diggsey@moz-8jb74a.dsl.pipex.com) (Ping timeout: 121 seconds)
[00:28:49] *** Joins: Diggsey (diggsey@moz-sfmu28.dsl.pipex.com)
[00:29:09] <WindowsBunny> Gankro: my winapi did that first
[00:29:19] <WindowsBunny> Gankro: see the readme https://github.com/retep998/winapi-rs
[00:29:32] <WindowsBunny> well, first in the rust community anyway
[00:29:54] *** Quits: rovar (rovar@moz-6iq.47m.88.38.IP) (NickServ (RECOVER command used by rovar_))
[00:29:54] *** rovar_ is now known as rovar
[00:29:55] <Gankro> WindowsBunny: I dunno, it's a pretty old RFC
[00:30:07] *** Joins: rovar_ (rovar@moz-6iq.47m.88.38.IP)
[00:30:28] <WindowsBunny> Gankro: https://github.com/retep998/winapi-rs/commit/0a07260523034616635ea978fc5d32362fec5d3e
[00:30:51] <Gankro> Less than a month. *shrug*
[00:36:11] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[00:44:52] *** Quits: mib_l5y7le (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:47:25] *** Joins: _Vi (vi@moz-bbs.vhj.131.104.IP)
[00:47:36] *** chmanchester is now known as chmanchester|afk
[00:48:37] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:49:04] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[00:53:48] <huon> thoughts on `fn share_it<'a, T: Copy>(x: &'a mut T) -> &'a Cell<T> { unsafe {transmute(x)} }` being legal?
[00:55:09] <reem> seems cool/useful, no idea if it actually is legal
[00:55:46] <huon> (I suspect it applies to anything that is... covariant(?) in its type argument)
[00:56:09] <huon> e.g. &mut Vec<T> -> &Vec<Cell<T>>, &mut HashMap<K, V> -> &HashMap<K, Cell<V>>
[00:57:47] <huon> WindowsBunny: Gankro: stop trying to extinguish the other's claim, just extend your good will and embrace the community spirit.
[00:58:14] <WindowsBunny> huon: No >:(
[00:58:57] <huon> WindowsBunny: you're EEEvil
[00:59:07] <WindowsBunny> huon: Just the way I like it
[01:02:59] <nrc> I'm seeing an error about a symbol ....::_FILE_LINE but there is nothing in the function called anything like _FILE_LINE. I assume it is a special symbol. Anyone know anything about it?
[01:03:14] <huon> nrc: probably comes from inside panic!()
[01:03:35] <nrc> thanks huon!
[01:08:14] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[01:08:32] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[01:09:46] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:20:12] *** Quits: andars (andars@moz-bsldst.sntcca.sbcglobal.net) (Ping timeout: 121 seconds)
[01:22:13] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[01:29:05] *** Quits: Guest38 (textual@moz-4hh.6p3.217.74.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[01:37:23] *** Joins: larsberg (Adium@moz-3ctsh7.ocn.ne.jp)
[01:50:43] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[01:52:24] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Connection closed)
[01:57:46] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[02:00:34] *** WindowsBunny is now known as WindowsSheep
[02:05:13] *** Quits: zz_kimundi (kimundi@moz-6vnj1q.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:07:32] *** Joins: zz_kimundi (kimundi@moz-iru09r.dip0.t-ipconnect.de)
[02:07:33] *** zz_kimundi is now known as kimundi
[02:08:00] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[02:12:03] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[02:14:19] *** Quits: Luqman (laden@moz-bjmiqc.csclub.uwaterloo.ca) (Ping timeout: 121 seconds)
[02:14:37] *** Joins: Luqman (laden@moz-bjmiqc.csclub.uwaterloo.ca)
[02:24:41] *** Quits: larsberg (Adium@moz-3ctsh7.ocn.ne.jp) (Quit: Leaving.)
[02:30:45] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[02:32:31] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[02:35:42] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[02:39:06] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[02:43:29] *** Joins: eddyb (eddyb@moz-c0q.mv7.25.188.IP)
[02:49:11] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[02:53:47] *** Quits: swgillespie (swgillespie@moz-o29.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:56:39] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[03:01:02] *** Joins: p1start (p1start@moz-nftjhe.org)
[03:03:37] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[03:12:16] *** Joins: joneshf-laptop (joneshf@moz-05a1nm.ucdavis.edu)
[03:16:35] *** Joins: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP)
[03:27:35] *** Joins: semarie (semarie@moz-ols.hu0.7.50.IP)
[03:45:45] *** Joins: bkearns (Adium@moz-2l9j31.ca.comcast.net)
[03:50:03] <sfackler> acrichto: can you publish a new version of liblibc so it'll pick up getsockopt?
[03:50:24] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[03:52:47] <sfackler> oh, wait, it's not in liblibc, nvm
[04:10:46] *** Quits: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com) (Ping timeout: 121 seconds)
[04:17:34] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[04:21:58] *** Joins: larsberg (Adium@moz-3ctsh7.ocn.ne.jp)
[04:22:37] *** Quits: joh (uid13099@moz-2c7ap3.ealing.irccloud.com) (Quit: Connection closed for inactivity)
[04:28:44] *** Quits: larsberg (Adium@moz-3ctsh7.ocn.ne.jp) (Quit: Leaving.)
[04:31:04] *** Joins: trecer (textual@moz-pudn0g.dyn.centurytel.net)
[04:32:28] *** Quits: bdero (bran@moz-216hqv.oo5r.e4su.0006.2601.IP) (Ping timeout: 121 seconds)
[04:34:01] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[04:35:00] *** Joins: larsberg (Adium@moz-mfl.g5u.215.61.IP)
[04:36:30] *** Joins: trecer_ (textual@moz-pudn0g.dyn.centurytel.net)
[04:37:14] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[04:38:46] *** Quits: trecer (textual@moz-pudn0g.dyn.centurytel.net) (Ping timeout: 121 seconds)
[04:52:25] *** Joins: elif (chatzilla@moz-2qitoe.res.rr.com)
[04:55:29] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[04:56:54] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[05:01:36] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[05:02:15] *** Quits: bkearns (Adium@moz-2l9j31.ca.comcast.net) (Quit: Leaving.)
[05:09:23] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[05:10:20] *** Joins: bkearns (Adium@moz-2l9j31.ca.comcast.net)
[05:13:03] *** Joins: Diggsey2 (diggsey@moz-sfmu28.dsl.pipex.com)
[05:15:12] *** Quits: Diggsey (diggsey@moz-sfmu28.dsl.pipex.com) (Ping timeout: 121 seconds)
[05:16:14] *** Quits: Jesin (Jesin@moz-6elflj.eecs.lehigh.edu) (Quit: Leaving)
[05:19:05] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[05:21:04] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[05:23:07] *** Joins: p1start (p1start@moz-nftjhe.org)
[05:27:07] *** Quits: O01eg (o01eg@moz-i1t4iu.kiim.3egh.2698.2a02.IP) (Client exited)
[05:29:26] *** Joins: mib_nyclaa (Mibbit@moz-juv.9o3.252.72.IP)
[05:33:15] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[05:33:40] *** Quits: bkearns (Adium@moz-2l9j31.ca.comcast.net) (Quit: Leaving.)
[05:36:38] *** Joins: munksgaard (munksgaard@moz-ob0t16.0.fullrate.dk)
[05:37:55] *** Quits: mib_nyclaa (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:41:47] *** Quits: larsberg (Adium@moz-mfl.g5u.215.61.IP) (Quit: Leaving.)
[05:54:46] *** Joins: James (quassel@moz-8qs8a3.range86-148.btcentralplus.com)
[06:01:24] *** Quits: trecer_ (textual@moz-pudn0g.dyn.centurytel.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[06:06:22] *** Joins: trecer (textual@moz-pudn0g.dyn.centurytel.net)
[06:06:45] *** Quits: aatch (james@moz-5r41gb.6pd7.20lj.e000.2406.IP) (Connection closed)
[06:10:08] *** Quits: genbattle (genbattle@moz-4v0.gkd.16.182.IP) (Ping timeout: 121 seconds)
[06:10:26] *** Quits: trecer (textual@moz-pudn0g.dyn.centurytel.net) (Ping timeout: 121 seconds)
[06:13:11] *** Quits: munksgaard (munksgaard@moz-ob0t16.0.fullrate.dk) (Ping timeout: 121 seconds)
[06:15:56] *** Quits: Amaranth (travis@moz-1raqsl.cpe.cableone.net) (Ping timeout: 121 seconds)
[06:17:04] *** Quits: swgillespie (swgillespie@moz-rn1.vmq.232.104.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:24:48] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[06:36:37] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[06:37:46] *** Quits: Diggsey2 (diggsey@moz-sfmu28.dsl.pipex.com) (Ping timeout: 121 seconds)
[06:38:07] *** Quits: elif (chatzilla@moz-2qitoe.res.rr.com) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 29.0/20140421221237])
[06:39:40] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[06:43:57] *** Joins: squiddy (squiddy@moz-md4.pm3.19.178.IP)
[06:45:20] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[06:46:04] *** Quits: njn (chatzilla@moz-c6c476.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 41.0a1/20150531163607])
[06:46:49] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[06:47:36] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[06:49:47] *** Quits: James (quassel@moz-8qs8a3.range86-148.btcentralplus.com) (Ping timeout: 121 seconds)
[06:50:55] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[06:51:27] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[06:58:21] *** Joins: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net)
[07:00:08] *** Quits: joneshf-laptop (joneshf@moz-05a1nm.ucdavis.edu) (Ping timeout: 121 seconds)
[07:01:54] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[07:02:24] *** Joins: mukilan (mukilan@moz-sp8.1ur.164.122.IP)
[07:07:41] *** Quits: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au) (Ping timeout: 121 seconds)
[07:09:09] *** Joins: Amaranth (travis@moz-1raqsl.cpe.cableone.net)
[07:15:21] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[07:16:18] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Client exited)
[07:18:19] *** Joins: zxq9 (ceverett@moz-qsm369.mesh.ad.jp)
[07:18:55] *** Quits: mukilan (mukilan@moz-sp8.1ur.164.122.IP) (Ping timeout: 121 seconds)
[07:22:11] *** Joins: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de)
[07:22:37] *** Joins: mukilan (mukilan@moz-j5b.31o.164.122.IP)
[07:33:43] *** Quits: mgottschlag (quassel@moz-8uvcc8.hsi15.kabel-badenwuerttemberg.de) (Ping timeout: 121 seconds)
[07:34:37] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[07:38:44] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[07:44:42] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[07:53:47] *** Joins: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP)
[07:56:36] *** Quits: Kxepal (Miranda@moz-et10ht.pppoe.mtu-net.ru) (Ping timeout: 121 seconds)
[07:58:40] *** Joins: Kxepal (Miranda@moz-lmj2m2.pppoe.mtu-net.ru)
[08:01:14] *** Quits: nham (nham@moz-lglsfe.il.comcast.net) (Quit: Lost terminal)
[08:12:06] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[08:17:35] <koobs> acrichto: we already got some excitement :) https://twitter.com/worr/status/605980811213422592 
[08:17:41] <koobs> and https://gitlab.com/worr/olp-freebsd/tree/master
[08:20:20] <acrichto> koobs: nice!
[08:22:02] *** Joins: genbattle (genbattle@moz-r09mao.xtra.co.nz)
[08:23:28] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Ping timeout: 121 seconds)
[08:24:16] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[08:26:45] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[08:35:25] *** Joins: arielb1 (Mibbit@moz-cmi.jfj.114.192.IP)
[08:36:43] *** Joins: eibwen (eibwen@moz-v8obbc.dip0.t-ipconnect.de)
[08:43:14] <arielb1> nmatsakis: ping
[08:44:05] *** Joins: larsberg (Adium@moz-9k9mc5.ocn.ne.jp)
[08:44:14] *** Quits: eibwen (eibwen@moz-v8obbc.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[08:45:13] *** Quits: arielb1 (Mibbit@moz-cmi.jfj.114.192.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:52:54] *** Quits: larsberg (Adium@moz-9k9mc5.ocn.ne.jp) (Quit: Leaving.)
[08:56:51] <nrc> This is fun: http://is.gd/8gF3iv
[08:56:54] <nrc> look at the ir
[08:57:08] <nrc> now inline the value of x into its one use
[08:57:09] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[08:57:17] <nrc> look at the ir again
[08:57:38] <nrc> 463 lines vs 188 lines
[08:57:49] <nrc> by manually inlining one expression
[08:58:12] *** Joins: p1start (p1start@moz-nftjhe.org)
[08:58:19] <aatch> nrc, yeah?
[08:58:48] <nrc> aatch: yeah
[08:59:06] <aatch> nrc, it's because we have a front-end optimisation.
[08:59:15] <huon> nrc: the compiler does a basic syntactic pattern match for `if true {` (essentially)
[08:59:41] <aatch> nrc, but since `load %x` isn't a constant, it doesn't get applied.
[08:59:48] <huon> to reduce trans bloat from debug_assert! (with its `if cfg!(debug_assertions) {`)
[08:59:59] <nrc> ah, I didn't realise we did that optimisation our selves
[09:00:04] <nrc> I thought we left it all to trans
[09:00:04] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[09:00:08] <nrc> er llvm
[09:00:57] <nrc> So
[09:01:04] <nrc> the real reason this is fun...
[09:01:09] <aatch> we'll optimise `if <const expr> { ... }`
[09:01:27] <nrc> is because this code (the inlined version) is in std/sys/unix/rwlock.rs
[09:01:54] <nrc> and it is the only thing in the bootstrap which breaks codegen_units now (with my patches)
[09:01:57] <eddyb> huon: I thought we asked LLVM to evaluate it
[09:02:23] <eddyb> which would work in this case if we didn't put x in an alloca...
[09:02:24] <nrc> but if I extract the cfg! into a local variable, then it doesn't break
[09:02:24] <aatch> eddyb, we do, for a given value of "evaluate", we just check that the condition is a constant.
[09:02:53] <nrc> break = multiple definition error from the linker
[09:03:03] <aatch> eddyb, for a debug build it'll go into an alloca anyway.
[09:03:20] <nrc> I can't imagine how the version with less ir is the one that gives the multiple def error
[09:03:36] <eddyb> https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/controlflow.rs#L169
[09:03:58] <eddyb> maybe there's something fundamentally broken about const_to_opt_uint
[09:04:37] <eddyb> not really, it's pretty dull
[09:05:10] <eddyb> nrc: is it the fact that there's an else?
[09:05:13] <aatch> nrc, that is weird. We don't translate the dead code, but I don't know why that would cause an error.
[09:05:42] <eddyb> https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/controlflow.rs#L176-L177
[09:05:52] <eddyb> nrc: it manually uses TransItemVisitor
[09:06:10] <eddyb> maybe that's not supposed to happen anymore
[09:06:28] <nrc> I don't really know whats going on
[09:06:29] <eddyb> and debug_assert_eq does indeed generate items
[09:07:03] <nrc> we should only drop the debug_assert branch, not the debug_assert_eq
[09:07:08] <eddyb> nrc: so for the branch that's not taken, it visits items. I think that's wrong with codeunits
[09:07:27] <eddyb> nrc: or debug_assert, doesn't matter. I took the if true case as an example
[09:07:38] <nrc> ok
[09:07:41] <eddyb> we drop the branch that's not taken but manually visit its items
[09:07:58] <eddyb> try just... removing the "manually visit its items" bits
[09:08:14] <nrc> TransItemVisitor will just run trans on any items it finds?
[09:08:14] <eddyb> I wonder if there's tests for it in non-parallel-codegen mode
[09:08:18] <eddyb> nrc: yupp
[09:08:26] <nrc> Why is that a problem with codegen units?
[09:08:36] <eddyb> because I thought that's not done at all with codegen units
[09:08:59] <nrc> "that" = translate items?
[09:09:03] <eddyb> visit items
[09:09:18] <eddyb> I thought there's a huge vector of items for each translation unit
[09:09:22] <eddyb> or iterator or something
[09:09:38] <nrc> I don't think so, I might be wrong
[09:09:39] <eddyb> and no recursion, other than for monomorphization, perhaps
[09:10:01] <nrc> I think we just trans as normal, but when we start at a top level module we pick a new compilation unit
[09:10:25] <eddyb> TransItemVisitor is not used anymore
[09:10:32] <eddyb> it's... dead code
[09:10:37] <eddyb> except for wrong uses
[09:11:23] <eddyb> I wonder how this other one didn't cause you trouble https://github.com/rust-lang/rust/blob/aecf3d8b659c1f5bc457a5a146357ba484e27346/src/librustc_trans/trans/meth.rs#L66
[09:12:25] <eddyb> nrc: wait, no, I'm blind
[09:12:36] <eddyb> I should use my text editor and not the GitHub UI
[09:12:57] <nrc> GitHub *is* awful :-p
[09:13:13] <Manishearth> *gasp*
[09:13:15] <Manishearth> heresy
[09:13:23] <Manishearth> okay I agree with you
[09:13:37] <Manishearth> I use `hub` and stay away from the gh ui whenever possible
[09:14:04] <eddyb> nrc: hmm, so it seems that the control flow recursion conflicts with this one https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/base.rs#L2001-L2004
[09:14:26] <aatch> eddyb, I saw that, thinking the same thing.
[09:15:17] <nrc> eddyb: what do you mean by "conflicts"? It'll be trying to walk two places 'at once'?
[09:15:44] <eddyb> nrc: it will see the items in the branch-not-taken two times
[09:15:56] <nrc> ah, right
[09:16:41] <eddyb> I have no idea how that ends up in a separate translation unit, but I'd say controlflow is wrong and couldn't affect anything until now
[09:16:50] <aatch> So trans_block doesn't actually translate items anyway, so the use of `TransItemVisitor` there is wrong.
[09:17:31] <nrc> I'm trying a build without those lines
[09:17:35] <nrc> now we wait...
[09:17:45] <aatch> As in, the only reason that code would be there for is to make sure we don't skip doing something we would normally do without the opt.
[09:18:32] <aatch> Since we don't translate items c.f. https://github.com/rust-lang/rust/blob/master/src/librustc_trans/trans/controlflow.rs#L67 normally while doing expressions, it's clearly incorrect to do it there.
[09:19:47] <eddyb> aatch: well, it likely was necessary at the time the change was made
[09:19:47] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[09:20:00] <aatch> eddyb, oh, probably.
[09:21:03] <aatch> eddyb, I assume LLVM's automatic renaming stopped it from exploding with `codegen-units=1`
[09:22:23] <eddyb> https://github.com/rust-lang/rust/commit/daee1b4d5c6e1db8563c57ff5529b62d0a29fbde
[09:22:51] <eddyb> I am confused
[09:24:02] <eddyb> https://github.com/rust-lang/rust/blob/daee1b4d5c6e1db8563c57ff5529b62d0a29fbde/src/librustc/middle/trans/base.rs#L2246-L2247
[09:24:41] <eddyb> in monomorphic functions, TransItemVisitor wasn't responsible for nested items
[09:33:12] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[09:34:23] *** kimundi is now known as zz_kimundi
[09:39:43] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[09:41:08] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[09:41:23] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[09:43:33] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[09:48:00] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[09:51:18] *** Joins: kushal (kdas@moz-so4.f0d.244.121.IP)
[09:51:44] <nrc> Woo! It bootstraps!
[09:52:33] <nrc> Thanks eddyb and aatch!
[09:55:31] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[09:58:37] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[10:01:52] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[10:16:52] *** Quits: summerlight_ (summerlight@moz-99k.2mj.130.121.IP) (Ping timeout: 121 seconds)
[10:20:21] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[10:22:33] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[10:22:37] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[10:23:09] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[10:24:22] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[10:33:35] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[10:33:54] *** Quits: genbattle (genbattle@moz-r09mao.xtra.co.nz) (Ping timeout: 121 seconds)
[10:34:16] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[10:35:08] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[10:38:38] *** Joins: nickniko_ (nicknikolov@moz-k0r.8sn.209.90.IP)
[10:41:40] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[10:44:42] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[10:45:14] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[10:45:18] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[10:57:48] *** Quits: brain (brain@moz-ake53i.rcsntx.sbcglobal.net) (Ping timeout: 121 seconds)
[10:58:05] *** Joins: brain (brain@moz-ake53i.rcsntx.sbcglobal.net)
[11:02:46] *** Quits: p1start (p1start@moz-nftjhe.org) (Ping timeout: 121 seconds)
[11:11:01] *** Quits: ptalbot (ptalbot@moz-j4gnuh.fbx.proxad.net) (Ping timeout: 121 seconds)
[11:21:18] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Ping timeout: 121 seconds)
[11:23:20] *** Joins: munksgaard (munksgaard@moz-33d.hq0.225.130.IP)
[11:24:37] *** Quits: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net) (Quit: Konversation terminated!)
[11:26:25] *** Joins: larhat (Adium@moz-egv.ld6.128.213.IP)
[11:26:27] <eddyb> acrichto: this comment block doesn't apply to the macro in the no_elf_tls case https://github.com/rust-lang/rust/blob/master/src/libstd/thread/local.rs#L100-L103
[11:26:40] *** WindowsSheep is now known as WindowsBunny
[11:26:41] <eddyb> persistent link: https://github.com/rust-lang/rust/blob/a5979be9fefe671fa81ec70720234602f8112bec/src/libstd/thread/local.rs#L100-L103
[11:27:16] *** Joins: laumann (thomas@moz-vj4.hq0.225.130.IP)
[11:32:48] *** Quits: nrc (nrc@moz-14pjgj.xtra.co.nz) (Ping timeout: 121 seconds)
[11:34:09] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:34:22] *** Quits: laumann (thomas@moz-vj4.hq0.225.130.IP) (Ping timeout: 121 seconds)
[11:34:41] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[11:36:21] *** Joins: laumann (thomas@moz-gqpfnm.science.ku.dk)
[11:40:01] *** Joins: dinfuehr_ (dinfuehr@moz-c25.u8s.112.91.IP)
[11:41:53] *** Quits: larhat (Adium@moz-egv.ld6.128.213.IP) (Quit: Leaving.)
[11:43:39] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Ping timeout: 121 seconds)
[11:44:37] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:44:52] *** Quits: munksgaard (munksgaard@moz-33d.hq0.225.130.IP) (Ping timeout: 121 seconds)
[11:45:12] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[11:45:45] *** Joins: larhat (Adium@moz-egv.ld6.128.213.IP)
[11:46:18] *** Joins: munksgaard (munksgaard@moz-33d.hq0.225.130.IP)
[11:46:33] *** Quits: dinfuehr_ (dinfuehr@moz-c25.u8s.112.91.IP) (Connection closed)
[11:46:54] *** Joins: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP)
[11:48:54] *** Quits: larhat (Adium@moz-egv.ld6.128.213.IP) (Quit: Leaving.)
[11:49:14] *** Quits: nickniko_ (nicknikolov@moz-k0r.8sn.209.90.IP) (Quit: Leaving...)
[11:49:32] *** Joins: larhat (Adium@moz-egv.ld6.128.213.IP)
[11:49:39] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[11:50:33] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Quit: Leaving.)
[11:50:56] *** Quits: dinfuehr (dinfuehr@moz-c25.u8s.112.91.IP) (Ping timeout: 121 seconds)
[11:55:38] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:56:10] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[11:58:02] *** Quits: larhat (Adium@moz-egv.ld6.128.213.IP) (Quit: Leaving.)
[12:00:44] *** Quits: munksgaard (munksgaard@moz-33d.hq0.225.130.IP) (Ping timeout: 121 seconds)
[12:01:41] *** Joins: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP)
[12:03:43] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Quit: Leaving...)
[12:06:36] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[12:07:08] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[12:09:56] *** zz_kimundi is now known as kimundi
[12:13:33] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[12:18:04] <pnkfelix> can someone remind me what the was for ... brson's (?) project that showed each of the rust source tests historically, so you could see the language evolved over time?
[12:18:13] <pnkfelix> *what the link/url was
[12:18:21] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[12:18:22] <steveklabnik> hmmmmmmm
[12:19:28] <pnkfelix> found it from searching for brson on reddit: http://brson.github.io/archaea/
[12:20:11] <steveklabnik> ah nice
[12:20:40] <Manishearth> eddyb: aroubd?
[12:20:55] <Manishearth> I'm getting a parse error whilst building typeck docs
[12:21:16] <Manishearth> <stdin>:1:24: 1:25 error: unknown start of token: `
[12:21:16] <Manishearth> <stdin>:1 (A.) the Drop impl for `D` instantiates `D` at 'a directly,
[12:21:30] <pnkfelix> Maybe I will go fix that now
[12:21:35] <Manishearth> from librustc_typeck/check/dropck.rs
[12:21:41] <pnkfelix> Manishearth: there's a bug filed for this
[12:21:45] <Manishearth> ah okay
[12:21:58] * Manishearth wants his compiler docs back
[12:22:00] <pnkfelix> Manishearth: the short-term solution we adopted was to stop building the compiler docs for the release
[12:22:11] <pnkfelix> Manishearth: but obviously it would be nice to fix this
[12:22:12] <Manishearth> my precioussss
[12:22:15] <steveklabnik> hehe
[12:22:16] <pnkfelix> Manishearth: so I'll go do that
[12:22:20] <steveklabnik> it broke the plugins chapter too :/
[12:22:24] <Manishearth> :(
[12:22:37] <steveklabnik> :+1: to the /internals idea
[12:22:49] <steveklabnik> i think for most people, what we did is right, but if you'ren not most people, it's not as great
[12:22:51] <pnkfelix> Manishearth: (I think the issue is ... rustdoc automatically interprets the indentation as a code block ... ?)
[12:23:18] <pnkfelix> Manishearth: so the obvious "fix" is to get rid of the indentation in that doc comment
[12:23:30] <eddyb> or mark it as non-Rust
[12:23:38] <pnkfelix> eddyb: how do you mark indentation ?}
[12:23:47] <pnkfelix> eddyb: i.e. its not using ```, I think...
[12:23:52] *** Quits: kushal (kdas@moz-so4.f0d.244.121.IP) (Ping timeout: 121 seconds)
[12:23:52] <eddyb> good question :P
[12:24:01] <steveklabnik> you can't with just indentation
[12:24:05] <steveklabnik> gotta fence it
[12:24:07] <eddyb> maybe we should ignore indentation-based code blocks
[12:24:11] <pnkfelix> personally, I wonder why rustdoc is treating indentation as a code-block
[12:24:16] <pnkfelix> right, what eddyb said.  :)
[12:24:17] <steveklabnik> because markdown does
[12:24:19] <eddyb> markdown
[12:24:29] <pnkfelix> so what?  We don't have to test them, right?
[12:24:33] *** Joins: Sho (sho@moz-ah9.1ms.28.5.IP)
[12:24:38] <pnkfelix> i.e. we could let pandoc keep rendering them
[12:24:52] <pnkfelix> the issue is that its trying to feed it to the compiler to parse
[12:24:58] <pnkfelix> right?
[12:25:04] <eddyb> +1 for "assume notrust unless it's fenced"
[12:25:15] <steveklabnik> yes, we could in theory do rust,ignore for indent blocks
[12:25:17] <steveklabnik> eddyb: notrust is gone
[12:25:18] <pnkfelix> maybe I should just do that instead
[12:25:31] <steveklabnik> or text
[12:25:37] <pnkfelix> though it might require an RFC.  :(
[12:25:39] <steveklabnik> i'd prefer rust,ignore probably, maybe
[12:26:13] *** Joins: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP)
[12:26:15] <pnkfelix> (is rustdoc considered "stable" the same way other tools are?  Or can we treat it like the wild west still? I assume its supposed to be stable)
[12:26:38] <Manishearth> steveklabnik: yes please, /internals :)
[12:26:58] <Manishearth> steveklabnik: I think the nightly build can incrementally build both sets of docs
[12:27:07] <steveklabnik> pnkfelix: 'the rust distribution' includes rustdoc, yeah
[12:27:11] <steveklabnik> but
[12:27:18] <steveklabnik> cargo isn't exactly stable either
[12:27:24] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Connection closed)
[12:27:30] <Manishearth> steveklabnik: rust,ignore for indented blocks lgtm
[12:27:31] <steveklabnik> gray area
[12:27:40] <Manishearth> define "stable"
[12:27:54] <Manishearth> their flags may move around, basic functionality should stay the same
[12:28:28] <pnkfelix> then again, if the markdown rendering of the doc in question is going to make it look like code
[12:28:39] <pnkfelix> I should probably *also* fix the doc to not use indentation that way
[12:28:40] <eddyb> Manishearth: there are stable flags
[12:28:43] <Manishearth> so clearly we should unindent it
[12:28:47] <Manishearth> eddyb: for cargo/rustdoc?
[12:28:55] <eddyb> rustc at least. hmm
[12:29:05] <Manishearth> we're talking about the others
[12:29:21] <Manishearth> I think for cargo `cargo build/test/run` sans flags are stable
[12:29:27] <Manishearth> theoretically speaking
[12:31:40] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[12:31:58] *** Joins: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca)
[12:32:24] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[12:33:19] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[12:33:51] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[12:35:07] <pnkfelix> Manishearth: r? https://github.com/rust-lang/rust/pull/25987
[12:35:34] <Manishearth> pnkfelix: why *s?
[12:35:39] *** Joins: larsberg (Adium@moz-mfl.g5u.215.61.IP)
[12:35:48] <Manishearth> Why not jsut use nested markdown directly?
[12:36:02] <Manishearth> Also, fwiw the problem is the line break on line 244
[12:36:13] <Manishearth> markdown doesn't do code blockification if there isn't space on either side
[12:36:49] <Manishearth> * nested lsits
[12:36:52] <Manishearth> *lists
[12:37:37] <Manishearth> actually nvm it's fine
[12:37:58] <Manishearth> steveklabnik: should we have a linkrotck part of the doctests?
[12:38:08] <steveklabnik> so
[12:38:17] <steveklabnik> there are FAR TOO MANY broken links for that to make any sense right now ;)
[12:38:28] <Manishearth> heh
[12:38:39] <steveklabnik> i haven't run a check in a while
[12:38:49] *** Joins: bgamari (bgamari@moz-m173ho.hsi8.kabel-badenwuerttemberg.de)
[12:39:33] <Manishearth> We should have an automated tool that does it, even if we don't gate on it
[12:39:54] <steveklabnik> we also gated rust by example on it
[12:40:01] <Manishearth> ah
[12:40:03] <steveklabnik> and then, when an external site went down, we couldn't deploy 
[12:40:10] <steveklabnik> so yeah just a fan of a lint and not a gate
[12:40:29] <Manishearth> steveklabnik: so we have the tooling for this?
[12:40:57] <steveklabnik> there's a tool called 'lnikchecker
[12:41:01] <steveklabnik> linkchecker
[12:41:02] <Manishearth> ah
[12:41:02] <steveklabnik> that i used
[12:41:47] <Manishearth> ugh, now I want to go and fix all those broken links
[12:41:51] <Manishearth> but I want to also do diagnostics
[12:41:58] <Manishearth> and I don't have the time for either
[12:42:07] <Manishearth> -_-
[12:42:08] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[12:42:12] <steveklabnik> lots of them are like 'rustdoc generates some link'
[12:42:21] <Manishearth> ah
[12:42:21] <steveklabnik> so for example, any function that returns a private type? broken link
[12:42:31] <Manishearth> that's linted anyway
[12:42:40] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[12:42:47] <Manishearth> you cannot do public things with private types without getting a light slap on the wrist from rustc
[12:42:51] <pnkfelix> Manishearth: "nested markdown", you mean numbers, 1. .. 2. ..., instead of asterisks?
[12:42:56] <Manishearth> pnkfelix: yes
[12:42:58] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[12:42:59] <pnkfelix> Manishearth: does that work for letters?
[12:43:01] <steveklabnik> yeah but we do it in the stdlib a lot
[12:43:01] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[12:43:02] <Manishearth> pnkfelix: yes
[12:43:06] <pnkfelix> Manishearth: oh well
[12:43:51] <pnkfelix> Manishearth: I guess I just don't care enough to make it perfect.
[12:44:05] <Manishearth> pnkfelix: only numbers
[12:44:31] <Manishearth> pnkfelix: https://manishearth.pastebin.mozilla.org/8835546
[12:44:32] <pnkfelix> Manishearth: ... more context please ...
[12:44:53] <Manishearth> tldr markdown is confusing
[12:45:08] <Manishearth> see the pastebin, that's what we were suggesting
[12:45:17] <Manishearth> sadly you can't get a. / b. to work
[12:45:19] <pnkfelix> Manishearth: but I want capital A and capital B
[12:45:39] <pnkfelix> Manishearth: that's what was used in the RFC, and the conditions are referenced by number and letter at times
[12:45:51] <Manishearth> ah
[12:45:52] <pnkfelix> Manishearth: anyway, lets just leave it as bullets plus labels
[12:45:56] <Manishearth> yeah
[12:46:10] <Manishearth> so, it seems like what yo uwant is actually impossible by markdown standards :p
[12:46:18] <Manishearth> because for A. and B. to work
[12:46:26] <Manishearth> you need to have spaces around them
[12:46:37] <Manishearth> but that makes them into a codeblock
[12:46:52] <Manishearth> unless you use &nbsp; but that's cheating and looks ugly in the source
[12:47:04] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Connection closed)
[12:47:25] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[12:50:42] *** Joins: ChrisMorgan (ChrisMorgan@moz-g6osuq.tpgi.com.au)
[12:51:27] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[12:51:36] *** Joins: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP)
[12:53:06] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[12:53:46] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[13:01:32] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[13:01:34] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[13:01:55] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[13:04:03] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[13:04:35] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[13:05:38] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[13:08:37] *** Quits: koobs (koobs@moz-lu0tvm.internode.on.net) (Ping timeout: 121 seconds)
[13:10:48] *** Quits: larsberg (Adium@moz-mfl.g5u.215.61.IP) (Quit: Leaving.)
[13:14:03] *** Joins: kushal (kdas@moz-iq5.378.143.114.IP)
[13:14:23] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[13:15:01] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[13:15:33] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[13:16:40] *** Quits: rovar (rovar@moz-96effg.dyn.optonline.net) (NickServ (RECOVER command used by rovar_))
[13:16:40] *** rovar_ is now known as rovar
[13:16:53] *** Joins: rovar_ (rovar@moz-96effg.dyn.optonline.net)
[13:19:45] *** Joins: mib_5dwpjr (Mibbit@moz-juv.9o3.252.72.IP)
[13:25:29] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[13:26:10] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[13:30:28] *** Quits: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP) (Ping timeout: 121 seconds)
[13:36:26] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[13:37:06] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[13:37:38] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[13:37:57] *** Joins: imperio (Mibbit@moz-clvcou.abo.wanadoo.fr)
[13:38:05] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[13:38:08] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[13:38:42] <imperio> https://github.com/rust-lang/rust/blob/b77d60adb019bb5de05e884a99f3290ec4694137/src/librustc/middle/check_const.rs#L655
[13:38:48] <imperio> I don't get how to get this error
[13:38:56] <imperio> what path is talked about ?
[13:43:26] <Manishearth> path is a::b::c
[13:43:28] <Manishearth> or just a
[13:43:46] <imperio> oh ok
[13:43:55] <Manishearth> imperio: try using a local var in a const fn
[13:47:06] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Connection closed)
[13:47:24] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[13:47:27] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[13:48:04] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[13:48:33] <Manishearth> imperio: check out the different types of Defs and see which one isn't applicable ther
[13:48:36] <imperio> http://is.gd/ztXtXc
[13:48:50] <imperio> I think I didn't get it
[13:50:05] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[13:50:35] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[13:50:52] *** Quits: harrisonclarke (harrisoncla@moz-uur7pt.eastlink.ca) (Connection closed)
[13:51:29] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[13:52:54] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[13:54:15] <Manishearth> imperio: I .. don't see how it's possible to hit that error
[13:54:47] *** Quits: johnsoft (johnsoft@moz-69mrig.res.rr.com) (Ping timeout: 121 seconds)
[13:54:47] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Connection closed)
[13:55:08] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[13:56:23] <imperio> Manishearth: me neither, When I try to give a trait (which should throw the error), it just says it doesn't know the trait name
[13:56:36] <imperio> and lastly I tested : http://is.gd/3EuxBf
[13:56:42] <Manishearth> you can't have a trait in an exprpath
[13:56:55] <imperio> hum...
[13:56:59] <Manishearth> you can have a defstatic, defconst, deffn, defmethod, deflocal
[13:57:16] <Manishearth> defstruct/defvariant for ctors
[13:57:33] *** Joins: dinfuehr_ (dinfuehr@moz-jgtob1.highway.telekom.at)
[13:58:16] <Manishearth> all are handled
[13:58:21] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[13:58:37] <imperio> well, I think I'll give up on this and come back to it later
[13:58:51] *** Quits: lu324 (lu324___@moz-3v8ljg.dhcp.embarqhsd.net) (Ping timeout: 121 seconds)
[13:58:53] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[13:58:54] <imperio> finding how to get the error is always the longest part...
[13:59:11] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[13:59:39] <Manishearth> heh
[13:59:50] <Manishearth> eddyb might know
[13:59:58] *** Joins: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP)
[14:00:01] <Manishearth> eddyb: can you hit this error for us?
[14:00:03] <Manishearth> https://github.com/rust-lang/rust/blob/b77d60adb019bb5de05e884a99f3290ec4694137/src/librustc/middle/check_const.rs#L655
[14:00:17] <Manishearth> alternatively that could be some kind of future proofing :)
[14:00:36] *** Joins: johnsoft (johnsoft@moz-69mrig.res.rr.com)
[14:01:38] *** Quits: dinfuehr_ (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[14:07:49] *** Quits: jgallagher (john@moz-6ge.dhn.131.24.IP) (Client exited)
[14:09:19] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[14:09:51] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[14:13:44] *** Joins: lu324 (lu324___@moz-3v8ljg.dhcp.embarqhsd.net)
[14:15:54] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[14:19:47] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[14:20:19] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[14:21:03] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[14:22:33] *** Joins: capella-s32 (capella-s3@moz-ic6k9m.pools.spcsdns.net)
[14:23:47] *** Quits: capella-s32 (capella-s3@moz-ic6k9m.pools.spcsdns.net) (Connection closed)
[14:24:00] *** Joins: marcusklaas (marcus@moz-0ol9oe.chello.nl)
[14:24:07] *** Quits: capella-s3 (capella-s3@moz-vcqob4.res.rr.com) (Ping timeout: 121 seconds)
[14:24:49] *** Joins: capella-s3 (capella-s3@moz-ic6k9m.pools.spcsdns.net)
[14:25:54] <marcusklaas> I've written a patch to change the span in the AST. How should I test that now does what it should? I can't find any such tests in the tree...
[14:26:13] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[14:27:03] <marcusklaas> a span*
[14:27:04] <Manishearth> marcusklaas: "change a span in the AST" link?
[14:27:21] <Manishearth> what exactly are you changing?
[14:27:39] <marcusklaas> The size of span. Specially, this issue: https://github.com/rust-lang/rust/issues/25969
[14:27:50] <marcusklaas> a span**
[14:28:06] <Manishearth> marcusklaas: you could:
[14:28:20] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[14:28:25] <Manishearth> (a) write a small plugin that checks the span
[14:28:51] <Manishearth>  (b) somehow make that emit an error
[14:29:07] <Manishearth>  and use the compiletest's span-selecting abilities to narrow down on it
[14:29:26] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Connection closed)
[14:29:39] <marcusklaas> I don't understand. Are these options to fix the issue, or test it?
[14:29:43] <Manishearth> to test it
[14:29:47] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[14:30:13] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Connection closed)
[14:30:15] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[14:30:45] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[14:31:24] <marcusklaas> Alright. I am afraid those would be a bit too involved for me... Would a test be required to get my patch accepted?
[14:31:24] *** Quits: capella-s3 (capella-s3@moz-ic6k9m.pools.spcsdns.net) (Connection closed)
[14:31:26] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[14:31:43] <Manishearth> perhaps not
[14:32:12] *** Quits: _Vi (vi@moz-bbs.vhj.131.104.IP) (Ping timeout: 121 seconds)
[14:32:15] *** Joins: capella-s3 (capella-s3@moz-ic6k9m.pools.spcsdns.net)
[14:32:24] <marcusklaas> Are there other such tests that you know of that I could maybe learn from?
[14:32:36] <Manishearth> marcusklaas: I can probably whip up the latter for you
[14:32:44] *** Quits: capella-s3 (capella-s3@moz-ic6k9m.pools.spcsdns.net) (Connection closed)
[14:35:04] <marcusklaas> Thanks, that's very kind of you. I'd like to play around with it a little before I encumber you, though ;-)
[14:35:50] <Manishearth> marcusklaas: can you link me to your patch?
[14:36:28] <Manishearth> because it seems to work here
[14:36:30] <Manishearth> http://is.gd/DiPibm
[14:36:56] <Manishearth> nvm got it
[14:36:57] <marcusklaas> It sure works, but the span associated to the expression is incorrect.
[14:37:20] <marcusklaas> one minute, I'll push my commit to github and send you a link
[14:37:25] <Manishearth> marcusklaas: http://is.gd/3pLa1E
[14:37:30] <Manishearth> this is the test you want
[14:37:36] <Manishearth> I was running it on stable
[14:38:18] <marcusklaas> Aah, yes! Nice!
[14:38:44] <marcusklaas> We can turn this into a regression test using your (b) option, no?
[14:39:31] <Manishearth> this is my (b) option
[14:39:40] <Manishearth> that is the full test
[14:39:49] <Manishearth> drop it in tests/compile-fail/whatever.rs
[14:39:54] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Connection closed)
[14:39:59] <Manishearth> and test with TESTNAME=whatever make check-stage1-cfail
[14:40:10] <Manishearth> I'm testing it on unfixed rust master rightn ow
[14:40:15] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[14:40:18] <Manishearth> yep, it failed
[14:40:20] <marcusklaas> but will it be automated?
[14:41:00] <Manishearth> yes
[14:41:43] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[14:42:02] <marcusklaas> Oh I understand how it works now, apologies.
[14:42:11] <marcusklaas> Thanks a bunch for your help Manish!
[14:42:15] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[14:42:25] <Manishearth> marcusklaas: this would be an even better test btw
[14:42:27] <Manishearth> http://is.gd/rQHizJ
[14:42:54] <Manishearth> just add the MPL error, clean up any dangling whitespace (use make tidy to find whitespace errors), and drop it in compile-fail with a descriptive name
[14:42:58] <Manishearth> or just 
[14:43:03] <Manishearth> compile-fail/issue-12345.rs
[14:43:15] <Manishearth> actually the latter might make more sense since this is a regression test
[14:43:21] <marcusklaas> Will do! :+1:
[14:43:34] *** Joins: dinfuehr_ (dinfuehr@moz-jgtob1.highway.telekom.at)
[14:43:40] *** Joins: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net)
[14:43:42] <Manishearth> :)
[14:44:18] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[14:46:21] *** Quits: Binero (jeroen@moz-91joat.69vi.s4ge.1810.2a02.IP) (Client exited)
[14:47:38] *** Joins: davebettin (textual@moz-rnhkmd.bendcable.com)
[14:51:35] <Manishearth> steveklabnik: stopgap: http://manishearth.github.io/rust-internals-docs/rustc/
[14:52:16] <steveklabnik> :)
[14:52:40] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[14:53:04] <bluss> huon: loose thoughts: How does &mut T -> &Cell<T> couple with a mutable version of RandomAccessIterator?
[14:53:13] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[14:53:43] <bluss> maybe it's the way to provide safe random access operations
[14:53:52] *** Joins: harrisonclarke (harrisoncla@moz-p78oth.eastlink.ca)
[14:54:09] *** Joins: edward-san (Edward`san@moz-6u9adl.retail.telecomitalia.it)
[14:54:14] <bluss> since RAI hasn't been viable for Iterator<Item=&mut T> since it would violate aliasing massively
[14:57:08] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[14:57:09] *** ChanServ sets mode: +o brson
[15:01:20] <marcusklaas> Sorry for the nooby question, but how does one make a debug build of rustc?
[15:02:55] *** Joins: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net)
[15:03:23] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[15:03:35] <bluss> marcusklaas: --enable-debug, then I don't know if it's preferable to use --enable-optimize too
[15:03:38] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[15:03:59] <marcusklaas> It isn't.. I want the optimizations to go! :p
[15:04:03] <marcusklaas> Thanks bluss!
[15:04:11] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[15:04:52] <bluss> well then bootstrapping will be slower
[15:04:54] <marcusklaas> bluss: make --enable-debug doesn't work unfortunately..
[15:05:15] <bluss> it's a configure option. I should have told you ./configure --help to start with :)
[15:05:25] <bluss> I don't know all these things so well either
[15:06:05] <marcusklaas> bluss: Is the fastest way to build rustc to simply use the defaults? Because that is taking upwards of 10 minutes, even after a single line change :o
[15:06:44] <bluss> 10 minutes? Then your rig is a lot better than mine
[15:06:48] *** Quits: squiddy (squiddy@moz-md4.pm3.19.178.IP) (Quit: Leaving)
[15:06:54] <bluss> I know nothing besides  make stage1-rustc
[15:06:58] <marcusklaas> bluss: upwards ;-p
[15:07:26] <marcusklaas> bluss: but seriously, how does one hack on the compiler when it takes so long to check your changes?
[15:07:32] <marcusklaas> test your changes*
[15:07:49] *** Quits: imperio (Mibbit@moz-clvcou.abo.wanadoo.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[15:08:15] <bluss> I don't know the answer. stage1-rustc is reasonably fast
[15:08:26] <marcusklaas> bluss: alright, thanks :-)
[15:08:44] <marcusklaas> I'm getting `make: *** No rule to make target 'stage1-rustc'.  Stop.` though
[15:08:59] <bluss> then it's rustc-stage1
[15:09:06] *** Quits: Astrum|Lap (Astrum|Lap@moz-skcefh.co.comcast.net) (Ping timeout: 121 seconds)
[15:09:20] <marcusklaas> Ah, that works. Thanks for your patience bluss
[15:09:46] <bluss> there's a channel #rustc for just rustc hacking
[15:10:15] <marcusklaas> I saw that, but I don't understand the difference between internals and rustc :O
[15:10:42] <bluss> well here's it's everything related to developing rust-lang I guess
[15:11:58] *** Quits: harrisonclarke (harrisoncla@moz-p78oth.eastlink.ca) (Connection closed)
[15:13:17] *** Joins: ncarrillo (textual@moz-hr3gaj.subnet.rcn.com)
[15:14:36] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[15:14:41] *** rovar is now known as rrichardson
[15:14:50] *** rrichardson is now known as rovar
[15:15:09] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[15:18:17] *** Joins: SiegeLord (sl@moz-9jtaei.ca.comcast.net)
[15:19:02] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[15:25:04] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[15:25:36] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[15:26:15] <edward-san> hey! when will you add a 'Docs (Beta)' menu in http://www.rust-lang.org/ page? Since 'beta' docs are available ...
[15:31:40] *** Joins: ConnorDo_ (ConnorDoyle@moz-hud.3ra.116.199.IP)
[15:34:16] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[15:36:01] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[15:36:34] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[15:36:59] *** Quits: lu324 (lu324___@moz-3v8ljg.dhcp.embarqhsd.net) (Ping timeout: 121 seconds)
[15:37:27] <brson> acrichto: do you have opinions about using bash instead of sh in our shell scripts?
[15:37:32] <brson> re https://github.com/rust-lang/rust/pull/25889
[15:37:39] *** Quits: SiegeLord (sl@moz-9jtaei.ca.comcast.net) (Quit: It's a joke, it's all a joke.)
[15:38:33] <eddyb> marcusklaas: hmm?
[15:38:36] <eddyb> err, Manishearth
[15:38:46] <acrichto> brson: surely sh is a subset of bash, right? And we have systems that may not have bash, so sh seems like the common denominator that we should be using?
[15:39:23] *** Joins: bkearns (Adium@moz-rudtng.static.wiline.com)
[15:40:01] <brson> acrichto: that is what I think. I do worry that it is all tilting at windmills, as we haven't actually encountered those systems yet
[15:40:21] * acrichto learns a new phrase
[15:40:35] *** Joins: Binero (jeroen@moz-9quuoa.access.telenet.be)
[15:40:41] <eddyb> playbot: const FOO: i32 = { let x = 0; x }; FOO
[15:40:41] <acrichto> we've come this far not using bash, seems like we can go just a little further?
[15:40:42] -playbot- <anon>:9:32: 9:37 error: blocks in constants are limited to items and tail expressions [E0016]
[15:40:43] -playbot- <anon>:9         const FOO: i32 = { let x = 0; x }; FOO
[15:40:43] -playbot- output truncated; full output at: http://bit.ly/1dM6fDh
[15:41:00] <brson> acrichto: sure
[15:41:43] <eddyb> Manishearth: example of the error http://is.gd/oAe9iZ
[15:41:54] <eddyb> Manishearth: it used to be the case that less of those branches were supported
[15:42:02] <WindowsBunny> I'm just waiting for the day I don't need sh at all to build Rust :P
[15:42:28] <eddyb> Manishearth: nowadays it's just `let` in constants (which is totally valid, just TBD)
[15:42:37] <eddyb> unless it's let mut, ofc :)
[15:42:49] <brson> WindowsBunny: what would you prefer?
[15:43:20] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[15:43:57] *** Joins: _Vi (vi@moz-bbs.vhj.131.104.IP)
[15:46:59] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[15:47:32] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[15:48:30] *** Joins: dcuddeback (textual@moz-ilr344.ca.comcast.net)
[15:49:47] *** Quits: ConnorDo_ (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[15:50:10] *** Quits: dinfuehr_ (dinfuehr@moz-jgtob1.highway.telekom.at) (Connection closed)
[15:50:31] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[15:51:14] <Manishearth> eddyb: ah
[15:51:36] <Manishearth> steveklabnik: WindowsBunny I found Rustaceans in MS!
[15:51:58] <Manishearth> I didn't meet any, but in casual conversation one guy pointed out that there were a couple here
[15:52:36] *** Quits: munksgaard (munksgaard@moz-3v9.hq0.225.130.IP) (Ping timeout: 121 seconds)
[15:52:42] <Manishearth> Also, ckkashyap (the Rust kernel guy who switched to nim) apparently sits like two rows away from me; somehow I never met him
[15:53:00] * Manishearth is going to have fun tomorrow
[15:53:35] <Manishearth> (no, I won't harrass the Nim guy :P )
[15:53:43] <eddyb> ferris infestation?
[15:53:47] <eddyb> aww
[15:54:17] <eddyb> now I want paper (cardboard?) cutouts of http://www.rustacean.net/img/rustacean-orig-noshadow.png
[15:54:28] <eddyb> in large quantities :D
[15:54:34] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[15:56:28] *** Joins: O01eg (o01eg@moz-us5806.sii9.3egh.2698.2a02.IP)
[15:57:22] <WindowsBunny> brson: I don't know D:
[15:57:57] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[15:58:38] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[15:58:46] *** Quits: Binero (jeroen@moz-9quuoa.access.telenet.be) (Client exited)
[15:59:12] <Manishearth> PowerShell scripts!
[15:59:51] <brson> WindowsBunny: how do you feel about python?
[16:00:11] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[16:00:24] <marcusklaas> Manishearth: sorry to bother again, but how can I match against the span in a compile-fail-test?
[16:00:38] <Manishearth> marcusklaas: the //~ERROR stuff
[16:00:51] <Manishearth> if an error matching the string is not on that line, it bails
[16:01:03] <WindowsBunny> brson: Also not good :D
[16:01:15] <marcusklaas> Manishearth: but it seems to always match the top line of the error..
[16:01:25] <Manishearth> marcusklaas: really?
[16:01:32] <Manishearth> hmm
[16:01:33] <marcusklaas> Manishearth: think so, yea
[16:02:43] <Manishearth> marcusklaas: that's no good then is it
[16:02:48] <Manishearth> one sec, let me try something
[16:03:06] <marcusklaas> Manishearth: nope :-( At least I'm confident my patch works now, because it is actually throwing the correct error messages
[16:03:58] *** Joins: lu324 (lu324___@moz-3v8ljg.dhcp.embarqhsd.net)
[16:07:26] <Manishearth> hmm
[16:08:55] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:09:24] <Manishearth> marcusklaas: AHA!
[16:09:27] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[16:09:32] <marcusklaas> ? :-D
[16:10:31] <brson> nmatsakis: something went wrong with crater yesterday and it didn't get results. trying again today
[16:10:51] *** Joins: bdero1 (bran@moz-lbs.91h.47.73.IP)
[16:10:57] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Connection closed)
[16:11:01] <Manishearth> marcusklaas: nvm
[16:11:16] <marcusklaas> :(
[16:11:26] <marcusklaas> I'll just submit my patch and see what the reviewer thinks
[16:11:29] <Manishearth> marcusklaas: wait wait
[16:11:32] *** Joins: bdero (bran@moz-lbs.91h.47.73.IP)
[16:11:33] *** Quits: bdero1 (bran@moz-lbs.91h.47.73.IP) (Quit: Leaving.)
[16:11:37] *** Quits: bdero (bran@moz-lbs.91h.47.73.IP) (Quit: Leaving.)
[16:15:00] <marcusklaas> Manishearth: I have to go for a bit. Sorry!
[16:15:13] <marcusklaas> Manishearth: I'll try to shoot you a msg when I'm back
[16:15:27] <Manishearth> k
[16:16:01] *** Quits: marcusklaas (marcus@moz-0ol9oe.chello.nl) (Client exited)
[16:17:12] *** Quits: ptalbot (ptalbot@moz-1gn7gb.eu0n.jcdj.0660.2001.IP) (Ping timeout: 121 seconds)
[16:18:27] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[16:19:22] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:19:55] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[16:22:35] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[16:22:44] <WindowsBunny> brson: Maybe one day I'll write a Rust program to build Rust
[16:24:06] *** Joins: ddamko (derekdamko@moz-plrm4a.toriangroup.com)
[16:30:20] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:30:28] *** Joins: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP)
[16:30:52] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[16:31:41] *** Joins: imperio (Mibbit@moz-8otf3a.fbx.proxad.net)
[16:33:30] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[16:33:32] *** Joins: capella-s3 (capella-s3@moz-vcqob4.res.rr.com)
[16:37:32] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Ping timeout: 121 seconds)
[16:38:50] <aturon> subteam reports are out -- sorry for the delay! https://internals.rust-lang.org/t/subteam-reports-2015-06-02/2191
[16:40:29] *** chmanchester|afk is now known as chmanchester
[16:40:45] <Manishearth> aturon: reminds me, I need to draft up something for the mod team
[16:40:47] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Connection closed)
[16:41:08] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:41:49] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[16:43:31] *** Quits: laumann (thomas@moz-gqpfnm.science.ku.dk) (Quit: leaving)
[16:47:09] *** Joins: munksgaard (munksgaard@moz-478pev.u.parknet.dk)
[16:48:15] <brson> does anybody know a way to 'diff' two runs of perf to find regressions?
[16:49:12] <eddyb> that's an interesting question, a few days ago I was wondering whether there were any cool perf visualizations
[16:50:46] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[16:51:36] *** Joins: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net)
[16:52:06] <brson> is there still a smallintmap equivalent in rustc?
[16:52:06] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[16:52:24] <eddyb> it's called... VecMap?
[16:52:40] <brson> eddyb: thanks
[16:52:46] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[16:54:49] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[16:57:18] *** Quits: bkearns (Adium@moz-rudtng.static.wiline.com) (Ping timeout: 121 seconds)
[16:57:54] *** Joins: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP)
[17:03:11] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:03:52] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[17:06:55] *** Quits: imperio (Mibbit@moz-8otf3a.fbx.proxad.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:07:48] * Gankro is thinking of just pulling VecMap into a crate once and for all
[17:08:08] <Gankro> But I'm not a fan of the "secret libcollections" that is growing for rustc
[17:08:19] *** Joins: swgillespie (swgillespie@moz-o29.3un.220.167.IP)
[17:09:52] *** Quits: ddamko (derekdamko@moz-plrm4a.toriangroup.com) (Quit: Leaving)
[17:11:28] *** Joins: bdero (bran@moz-1h9.8fo.42.70.IP)
[17:14:09] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:14:50] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[17:14:53] *** Joins: Diggsey (diggsey@moz-9pp22j.dsl.pipex.com)
[17:14:58] *** Joins: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de)
[17:15:38] *** Quits: swgillespie (swgillespie@moz-o29.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[17:20:09] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[17:20:45] *** Joins: Guest38 (textual@moz-j72nfe.ca.comcast.net)
[17:21:33] *** Quits: aepsil0n (eduard@moz-6491ha.mv2h.pepi.8071.2a02.IP) (Connection closed)
[17:24:37] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:25:12] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[17:26:07] *** chmanchester is now known as chmanchester|afk
[17:29:51] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[17:30:50] *** Quits: ncarrillo (textual@moz-hr3gaj.subnet.rcn.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:31:28] *** Quits: Guest38 (textual@moz-j72nfe.ca.comcast.net) (Connection closed)
[17:35:34] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:35:38] *** Quits: clatour (clatour@moz-slkfub.hlrn.qwest.net) (Quit: Textual IRC Client: www.textualapp.com)
[17:36:07] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[17:45:16] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[17:45:48] *** ChanServ sets mode: +o pcwalton
[17:46:33] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:47:06] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[17:50:23] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[17:51:23] <eddyb> Gankro: is rustc even using VecMap *anywhere*?
[17:51:25] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[17:51:32] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[17:51:43] <eddyb> ast_map is using a custom thing to avoid wasting 33% on a tag
[17:52:00] <Gankro> eddyb: I thought it was, but I'm happy to learn otherwise
[17:52:14] * Gankro eyes brson warily
[17:52:36] <eddyb> it's unstable and nothing uses it
[17:53:43] <brson> what replaced all the smallintmaps in rustc?
[17:53:48] <eddyb> Gankro: without some automatic enum flattening or a way to customize VecMap with a "null value", it seems pretty useless
[17:53:56] <seanmonstar> mem::size_of::<T>() and generated llvm ir are rustc specifics, not requiring rfcs to optimize, right?
[17:54:00] <eddyb> brson: I'm not sure if it was used anywhere before ast_map
[17:54:05] *** Joins: andars (andars@moz-bsldst.sntcca.sbcglobal.net)
[17:54:18] <eddyb> seanmonstar: yes, assuming T is not C-compatible
[17:54:30] <eddyb> #[repr(C)] is set in stone, more or less
[17:54:53] <eddyb> brson: either huon wrote it for ast_map or it was sitting there *shrug*
[17:55:12] * eddyb tries to figure out how to use git grep to search in the history
[17:55:17] <brson> hm, i was just looking at an fnvmap used to hold crate numbers, which seems pretty wasteful
[17:55:21] <seanmonstar> eddyb: specifically thinking that size_of::<Result<u8, EmptyEnum>>() could return 1, not 2
[17:55:40] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[17:56:14] <eddyb> enum EmptyEnum {}?
[17:56:18] <seanmonstar> yep
[17:56:31] <eddyb> brson: that should just be a Vec, unless it's sparse for some odd reason
[17:56:57] <eddyb> seanmonstar: the problem is we haven't given any semantics to uninhabited types :(
[17:57:27] <seanmonstar> eddyb: well, match e {} is defined
[17:57:30] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:57:45] <eddyb> generics don't handle them
[17:58:03] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[17:58:07] <seanmonstar> how so
[17:58:45] <eddyb> if you have a generic type, how do you know whether it can be or can't be an uninhabited type?
[17:58:50] *** Quits: mib_5dwpjr (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[17:59:21] <seanmonstar> i dont see why you'd ask that. its the same as asking how many variants an enum might have
[18:00:14] <eddyb> I wanted to get this hole plugged before 1.0 but someone kept pushing against proper handling in the language
[18:00:59] <eddyb> seanmonstar: that match e {} you mentioned, only works if the type is known
[18:01:46] <eddyb> seanmonstar: https://github.com/rust-lang/rust/issues/24885
[18:01:48] <seanmonstar> eddyb: yea...
[18:01:59] <seanmonstar> eddyb: my main motivation is that i'd like to bubble up the `match e {}` unreachable optimization to variants that contain an uninhabited type. so `match r { Ok(b) => ..., Err(_) => /*unreachable/* }`
[18:02:23] <seanmonstar> oh hey, thats the exact issue
[18:02:32] <seanmonstar> well
[18:02:37] <seanmonstar> thats with &T
[18:02:40] <eddyb> the same "doesn't propagate" issue happens with generics
[18:03:03] <eddyb> there's multiple strategies for handling it, and I'm not sure anything consistent is backwards-compat
[18:03:39] <seanmonstar> hm
[18:03:50] <eddyb> seanmonstar: do you want strong unreachable semantics or a zero-sized type that "optimizes away" variants it's used in?
[18:04:04] <seanmonstar> the latter
[18:04:20] <eddyb> that's inconsistent with match e {}
[18:04:46] <eddyb> seems backwards incompatible to switch it away from being unreachable
[18:04:46] <seanmonstar> this would allow `impl<T> FromStr for T where T: From<str> { type Err = Empty; }` to be optimized, for instance
[18:04:54] <eddyb> there's also the question of it being Sizeable
[18:05:01] <seanmonstar> inconsistent?
[18:05:19] <eddyb> yeah, for your usage to work it has to not be unreachable at the language level
[18:05:38] <seanmonstar> so, you mean that consistent would be `match r { Ok(b) => ... }` and completely leave off the Err arm, cause its uninhabitable?
[18:05:50] <eddyb> yes
[18:05:59] <eddyb> but that's incompatible with generics
[18:06:33] <eddyb> but you can't disallow uninhabited types in generics because they are allowed in 1.0
[18:06:37] <eddyb> do you see the problem?
[18:06:58] <eddyb> either way, you'd have to compromise
[18:07:21] <eddyb> seanmonstar: naive handling of this causes UB
[18:07:45] <seanmonstar> so, having `match r { Ok(b) => ..., Err(e) => return Err(e) }`, where e could be uninhabited... i'd desire that the compiler could mark the Err branch as unreachable
[18:08:06] <seanmonstar> this could be done for each monomorphization
[18:08:27] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:08:37] *** Quits: munksgaard (munksgaard@moz-478pev.u.parknet.dk) (Ping timeout: 121 seconds)
[18:09:01] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[18:09:38] *** Quits: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net) (Client exited)
[18:09:42] <eddyb> hmm
[18:09:49] <eddyb> playbot: #[derive(Copy)] enum Void {}
[18:09:51] -playbot- <anon>:9:18: 9:22 error: the trait `core::clone::Clone` is not implemented for the type `main::Void` [E0277]
[18:09:51] -playbot- <anon>:9         #[derive(Copy)] enum Void {}
[18:09:51] -playbot- output truncated; full output at: http://bit.ly/1GkMeji
[18:09:57] <eddyb> playbot: #[derive(Copy, Clone)] enum Void {}
[18:09:59] -playbot- ()
[18:10:04] <eddyb> seanmonstar: this is not good
[18:10:06] *** Quits: mukilan (mukilan@moz-j5b.31o.164.122.IP) (A TLS packet with unexpected length was received.)
[18:10:34] <seanmonstar> what isnt?
[18:10:39] *** Joins: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk)
[18:10:44] <seanmonstar> i'd hope the derive would expand to a `match *self {}`
[18:10:52] *** Joins: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net)
[18:11:07] <eddyb> playbot: #[derive(Copy, Clone)] enum Void {} unsafe { let p = 0 as *const Void; let x = *p; println!("hai there"); }
[18:11:09] -playbot- hai there
[18:11:09] -playbot- ()
[18:11:30] <eddyb> playbot: #[derive(Copy, Clone)] enum Void {} unsafe { let p = 0 as *const Void; let x = (*p).clone(); println!("hai there"); }
[18:11:32] -playbot- thread '<main>' panicked at 'internal error: entered unreachable code', <anon>:9
[18:11:32] -playbot- playpen: application terminated with error code 101
[18:11:57] * eddyb squints eyes
[18:12:04] <seanmonstar> granted, you're in unsafe land
[18:12:09] <seanmonstar> it does cause shudders tho
[18:12:15] <eddyb> the problem is generic abstractions using unsafe
[18:12:40] <eddyb> if there's no way to abuse it to trigger UB in abstractions you don't control... mmmaybe it's fine
[18:12:48] <seanmonstar> you'd have to explicitly type a *const Void yourself
[18:12:51] <eddyb> that is a panic, after all. it's not just an unreachable function
[18:13:06] <eddyb> seanmonstar: guess what we recommend enum Void {} for
[18:13:15] <seanmonstar> c_void?
[18:13:32] <eddyb> opaque pointers
[18:13:52] <eddyb> c_void might be an u8 for various reasons
[18:14:06] <seanmonstar> i've usually used *cosnt () for that :D
[18:14:16] <eddyb> that's... worse :P
[18:14:41] <eddyb> okay, so...
[18:15:03] <eddyb> playbot: #[derive(Copy, Clone)] enum Void {} fn copy<T: Copy>(x: &T) -> T {*x} unsafe { let p = 0 as *const Void; let x = copy(&*p); println!("hai there"); }
[18:15:06] -playbot- hai there
[18:15:06] -playbot- ()
[18:15:07] <seanmonstar> it would be nice if you could not cast to a *const VOid
[18:15:18] <eddyb> that's a function returning Void, which doesn't panic
[18:15:32] <eddyb> seanmonstar: no, it would be nice if you couldn't implement Clone on the damn thing
[18:16:07] <eddyb> playbot: #[derive(Copy, Clone)] enum Void {} fn copy<T: Copy>(x: &T) -> T {*x} unsafe { let p = 0 as *const Void; let x = Some(copy(&*p)).unwrap(); println!("hai there"); }
[18:16:10] -playbot- hai there
[18:16:10] -playbot- ()
[18:16:17] <seanmonstar> eddyb: that might be working because &T doesnt bubble up the emptiness
[18:16:19] *** Joins: arielb1 (Ariel@moz-9he9ta.red.bezeqint.net)
[18:16:39] <eddyb> there is no match
[18:16:51] <seanmonstar> right
[18:17:33] <eddyb> the match itself is a panic... which is fine, I guess
[18:17:35] <seanmonstar> i did notice that _match.rs specifically handles empty enums
[18:17:57] <eddyb> but that's just a special case
[18:18:01] <seanmonstar> everywhere else in the compiler, an empty enum is treated as an enum with 1 variants
[18:18:03] <seanmonstar> right
[18:18:06] *** Joins: eibwen (eibwen@moz-v8obbc.dip0.t-ipconnect.de)
[18:18:41] <eddyb> it's not related to "unreachable" in any way other than by triggering a panic in match x {}
[18:18:55] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:19:02] <eddyb> what I was worried about were proper unreachable semantics based on the *existence* of the value
[18:19:16] <seanmonstar> eddyb: match x {} will get compiled out
[18:19:21] <seanmonstar> it doesnt get replaced with a panic
[18:19:29] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[18:19:46] <eddyb> hmm
[18:19:57] <eddyb> playbot: #[derive(Copy, Clone)] enum Void {} fn copy<T: Copy>(x: &T) -> T {*x} unsafe { let p = 0 as *const Void; let x = match copy(&*p) {}; println!("hai there"); }
[18:20:06] -playbot- output truncated; full output at: http://bit.ly/1cxSDtu
[18:20:18] <eddyb> seanmonstar: what does it compile to?
[18:20:23] <arielb1> eddyb: it should compile to ud2
[18:20:36] <eddyb> lets just look at the IR
[18:20:36] <arielb1> because having a value of an empty enum is UB
[18:20:54] <eddyb> unreachable
[18:20:58] *** Quits: samnmax (samnmax@moz-1vk.aq9.27.72.IP) (Quit: Ex-Chat)
[18:21:05] <eddyb> arielb1: wasn't it you who prevented this to be fixed in 1.0?
[18:21:23] <arielb1> from being fixed?
[18:21:26] <eddyb> yeah
[18:21:30] <arielb1> this is not a bug
[18:21:32] <eddyb> https://github.com/rust-lang/rust/issues/24885
[18:21:41] <seanmonstar> eddyb: the ir is 'unreachable'
[18:21:45] <eddyb> seanmonstar: yes
[18:21:53] <eddyb> uninhabited types are a joke in Rust
[18:22:06] <arielb1> eddyb: that's match check being less-than omniscient
[18:22:12] <seanmonstar> eddyb: it may be that the derived code inserts `unreachable!()`
[18:22:18] <arielb1> nothing special
[18:22:19] <eddyb> seanmonstar: let's see
[18:22:56] <arielb1> I mean, of course there are ways to confuse it
[18:23:02] <eddyb> https://github.com/rust-lang/rust/blob/master/src/libsyntax/ext/deriving/generic/mod.rs#L1273-L1322
[18:23:39] <eddyb> seanmonstar: you're right, that makes Clone harmless
[18:23:45] <eddyb> but it lets you implement Copy!
[18:23:52] <carllerche> Is there a rust release calendar?
[18:23:53] <arielb1> eddyb: of course
[18:23:59] <arielb1> an uninhabited enum can be Copy
[18:24:09] <arielb1> that is obviously safe
[18:24:12] <carllerche> and is there a changelog tracked somewhere?
[18:24:39] <seanmonstar> eddyb: of course, you way of passing it through the safe copy() fn required unsafe to do it
[18:24:54] <eddyb> arielb1: not when *const Opaque is the recommended way to handle C structs of unknown size
[18:25:16] <eddyb> and the sole existence of the value is not UB
[18:25:17] <arielb1> seanmonstar: what's the problem?
[18:25:33] <seanmonstar> arielb1: i dont have a problem
[18:25:40] <eddyb> but it could cause UB somewhere else due to unspecified semantics
[18:25:45] <arielb1> *const Void is fine
[18:25:46] <arielb1> of course it is fine
[18:25:46] <arielb1> *const () is also fine
[18:25:51] <arielb1> but *const Void is fine because you can have 0xcccccccc as *const Void
[18:25:57] <arielb1> no UB
[18:26:05] <seanmonstar> arielb1: i'd just like to increase the optimizations of `match e {}` when you have something like `Result<u8, Void>`, which would mark the Err arm as unreachable
[18:26:27] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[18:26:36] <arielb1> I mean, *const Void is a pointer that does not point to anywhere useful
[18:26:42] <arielb1> just don't dereference it and you will be fine
[18:27:00] <eddyb> derefering *const () is harmless
[18:27:03] <eddyb> *dereferencing
[18:27:31] <eddyb> Void on the other hand - who knows
[18:27:36] <eddyb> future compiler devs, maybe
[18:27:54] <arielb1> if you cast it, you can get a pointer that points to somewhere useful
[18:27:54] <arielb1> that's fine too - this is the way raw pointers work
[18:28:05] <eddyb> match e {} is a language wart and it's hard to reconcile it with useful approaches
[18:28:36] <eddyb> the sane thing to do would be to replace it with a panic
[18:29:13] <eddyb> right now its sole purpose is UB
[18:29:16] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[18:29:53] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:30:07] <eddyb> playbot: match unsafe{enum V{}*(0 as *mut V)}{}
[18:30:09] -playbot- <anon>:9:30: 9:44 error: cannot move out of dereference of unsafe pointer
[18:30:09] -playbot- <anon>:9         match unsafe{enum V{}*(0 as *mut V)}{}
[18:30:09] -playbot- output truncated; full output at: http://bit.ly/1GkP489
[18:30:13] <eddyb> erm
[18:30:24] <eddyb> playbot: match *unsafe{enum V{}&*(0 as *mut V)}{}
[18:30:26] -playbot- output truncated; full output at: http://bit.ly/1cxTIBM
[18:30:29] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Ping timeout: 121 seconds)
[18:30:33] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[18:30:52] * seanmonstar points at unsafe {}
[18:31:34] <eddyb> oh, I wonder...
[18:31:44] <eddyb> playbot: println!("am I alive?"); match *unsafe{enum V{}&*(0 as *mut V)}{}
[18:31:46] -playbot- am I alive?
[18:31:46] -playbot- playpen: application terminated abnormally with signal 4 (Illegal instruction)
[18:32:42] <arielb1> eddyb: *that* would be the same even if V wasn't a void
[18:32:46] <arielb1> you dereference a null
[18:32:48] <arielb1> instant UB
[18:33:12] <eddyb> playbot: unsafe { *(0 as *const ()) }
[18:33:13] -playbot- ()
[18:33:21] <eddyb> arielb1: unless it's 0-sized :P
[18:33:23] *** Quits: davebettin (textual@moz-rnhkmd.bendcable.com) (Connection closed)
[18:33:27] <arielb1> playbot: match *unsafe { *(0 as *const u32) }
[18:33:27] -playbot- <anon>:10:5: 10:6 error: expected one of `.`, `{`, or an operator, found `}`
[18:33:27] -playbot- <anon>:10     });
[18:33:27] -playbot- output truncated; full output at: http://bit.ly/1GkPsnc
[18:34:51] <eddyb> is `unreachable` UB or not?
[18:34:52] *** Quits: _Vi (vi@moz-bbs.vhj.131.104.IP) (Ping timeout: 121 seconds)
[18:34:52] *** Joins: ncarrillo (textual@moz-hr3gaj.subnet.rcn.com)
[18:34:52] <arielb1> eddyb: still UB
[18:34:52] <arielb1> playbot: match *unsafe { *(0 as *const u32) } { x => x }
[18:34:52] <arielb1> unreachable is UB
[18:34:52] -playbot- <anon>:9:15: 9:45 error: type `u32` cannot be dereferenced
[18:34:53] -playbot- <anon>:9         match *unsafe { *(0 as *const u32) } { x => x }
[18:34:53] -playbot- output truncated; full output at: http://bit.ly/1cxU9vS
[18:34:53] <eddyb> I would've expected non-conditional controlflow leading up to an explicit UB point to be erased
[18:34:53] <arielb1> playbot: match unsafe { *(0 as *const u32) } { x => x }
[18:34:53] -playbot- 0
[18:34:57] <eddyb> why does LLVM keep the println!?
[18:34:57] <eddyb> that only obscures UB
[18:34:57] <arielb1> see
[18:34:57] <arielb1> eddyb: the println before the UB
[18:34:57] <arielb1> it must
[18:35:04] <eddyb> but the println is unreachable
[18:35:06] <arielb1> consider the println was to a guardian process that will send you a SIGKILL after it reads a character
[18:35:44] <eddyb> wait, you mean side-effects is what's keeping that alive?
[18:35:56] <arielb1> or, more realistically, stdout points to an offsite log server
[18:36:12] <arielb1> that is secure from UB on the local program
[18:36:35] <eddyb> I'm not seeing the value in unreachable here
[18:37:08] <arielb1> eddyb: it is UB
[18:37:13] <arielb1> you can do anywhere you want for empty matches
[18:37:15] <eddyb> playbot: if "".len() == 0 { println!("am I alive?"); match *unsafe{enum V{}&*(0 as *mut V)}{} }
[18:37:17] -playbot- am I alive?
[18:37:17] -playbot- playpen: application terminated abnormally with signal 4 (Illegal instruction)
[18:37:27] <arielb1> eddyb: same thing as before
[18:37:32] <arielb1> "guardian process"
[18:38:12] <eddyb> LLVM has to be able to optimize something specifically because of unreachable
[18:38:19] <eddyb> because otherwise we'd just use the abort intrinsic
[18:38:29] <eddyb> which happens to do the exact same thing in this case
[18:38:44] <cmr> eddyb: http://blog.regehr.org/archives/1096 indicates that in general that's not the case.
[18:39:29] <eddyb> I could've sworn I've seen it in action before, but I can't remember the pattern
[18:39:53] <cmr> I'm sure there are some cases where it works.
[18:40:00] <arielb1> playbot: fn f(a: u32) -> u32 { if a == 0 { match *unsafe{enum V{}&*(0 as *mut V)}{} } else {42} } f(0)
[18:40:02] -playbot- output truncated; full output at: http://bit.ly/1GkQjE8
[18:40:49] <eddyb> arielb1: thanks :D
[18:40:50] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:41:28] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[18:41:53] *** Quits: flaper87 (flaper87@moz-fnn.1e9.132.209.IP) (Ping timeout: 121 seconds)
[18:42:02] <eddyb> we have this special construct that is good only for causing such kind of UB. an abort intrinsic call would be saner
[18:42:25] <cmr> I don't see what's special about it.
[18:43:17] <arielb1> eddyb: illegal enum variants also reach an unreachable
[18:43:26] <arielb1> I mean, if you have enum X { A, B }
[18:43:35] <arielb1> and transmute::<u8, X>(2)
[18:43:41] <eddyb> that's for the default case, though
[18:43:55] <arielb1> every variant of a Void enum is illegal
[18:43:56] <eddyb> there are control paths that don't end up at unreachable
[18:44:36] <eddyb> cmr: the type system knowns it's unreachable and it's implemented as an UB special-case
[18:44:46] <arielb1> eddyb: because these enums are inhabited
[18:45:01] <arielb1> eddyb: special-case?
[18:45:15] <arielb1> there's a special case in match checking
[18:45:42] <eddyb> ah, trans might be clever here and leave it to the default case
[18:46:10] <eddyb> why would anyone write match x {} *ever*?
[18:46:16] <arielb1> eddyb: macros
[18:46:30] <arielb1> also, GADTs (if we have them)
[18:46:31] <eddyb> oh dear that's even worse
[18:46:38] <arielb1> generics (if we make that work)
[18:46:44] <eddyb> the ability to write macros that have UB as a special-case
[18:46:51] <eddyb> arielb1: we can't fix generics
[18:46:57] <eddyb> because you didn't want to and I gave up
[18:47:02] <eddyb> unless you mean Rust 2.0
[18:47:03] <arielb1> I mean, Result<(), Void>
[18:47:14] <arielb1> you don't have to match Err
[18:47:23] <arielb1> but that's not a match {}
[18:47:52] <arielb1> I think, if you have an fn<T>(...) -> T, and you call it with T=Void
[18:48:00] <arielb1> then you can match on that to get your bottom
[18:48:20] <eddyb> I wouldn't care as much if it would just abort
[18:48:31] <arielb1> eddyb: this is not a special case
[18:48:50] <arielb1> same as `*unsafe { 0xcccccccc as *const u32 }`
[18:48:52] *** Joins: flaper87 (flaper87@moz-fnn.1e9.132.209.IP)
[18:48:54] <arielb1> that's also not a special case
[18:48:58] <arielb1> I mean, the UB-ness
[18:49:12] <arielb1> (the * needs to be within the unsafe of course)
[18:49:14] <eddyb> zero-sized types are *always safe to dereference*
[18:49:20] <eddyb> that's a guarantee
[18:49:29] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[18:49:38] <eddyb> except uninhabited types are also zero-sized as far as a generic can see
[18:49:39] <arielb1> safe as in not aborting?
[18:50:04] <eddyb> safe as in producing a valid value for every possible pointer value
[18:50:12] <arielb1> zero-sized types can have a destructor that is not appropriate to call
[18:50:23] <arielb1> so they aren't perfectly harmless
[18:51:01] <eddyb> playbot: vec![(), (), (), ()].iter().map(|x| x as *const _).collect::<Vec<_>>()
[18:51:02] -playbot- <anon>:8:5: 8:9 error: unable to infer enough type information about `_`; type annotations required [E0282]
[18:51:03] -playbot- <anon>:8     show({
[18:51:03] -playbot- output truncated; full output at: http://bit.ly/1cxW17P
[18:51:07] <eddyb> playbot: vec![(), (), (), ()].iter().map(|x| x as *const ()).collect::<Vec<_>>()
[18:51:09] -playbot- [0x1, 0x1, 0x1, 0x1]
[18:51:24] <arielb1> and...
[18:51:26] <arielb1> I know that
[18:51:31] <arielb1> but () is inhabited
[18:51:38] <eddyb> that's interesting, I would've expected 0x1, 0x2, 0x3, 0x4 or something
[18:51:39] <seanmonstar> arielb1: your example of Result<(), Void>, you currently *do* need to match the Err case. however if you do `match r { Ok(x) => (), Err(e) => match e {} }`, the entire match statement will be optimized to a simple mov
[18:51:46] <arielb1> we know that because *you inserted it into the Vec*
[18:51:48] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[18:51:59] *** Joins: larhat (Adium@moz-vlo5br.cable.virginm.net)
[18:52:18] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[18:52:18] <eddyb> make dereferences of pointers to uninhabited types aborts
[18:52:21] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[18:52:25] <arielb1> you can't create values of random types and expect anything sane to happen
[18:52:30] <eddyb> and I'll sleep like a baby
[18:52:45] <seanmonstar> babies sleep horribly
[18:52:54] *** Quits: flaper87 (flaper87@moz-fnn.1e9.132.209.IP) (Ping timeout: 121 seconds)
[18:53:16] <eddyb> why would we even allow uninhabited types to be copyable? what does that mean?
[18:53:28] <arielb1> eddyb: that if you have one instance of that type, you can copy it
[18:53:35] <eddyb> cmr: it doesn't help that talking about uninhabited types becomes phylosophical
[18:53:40] <arielb1> but if you have an instance of that type
[18:53:41] <arielb1> you have UB
[18:53:43] <seanmonstar> however, you shouldnt ever get an instance of it in safe code
[18:53:44] <arielb1> so you can copy it
[18:53:48] <eddyb> whatever that word is spelled
[18:53:54] <arielb1> seanmonstar: not even in unsafe code
[18:54:03] <eddyb> arielb1: it's not UB *once* you get the value
[18:54:10] <arielb1> eddyb: it is
[18:54:14] <eddyb> because that would make it kinda safe
[18:54:20] <cmr> It's not possible to have a value of an uninhabited type. That's a meaningless statement.
[18:54:28] <eddyb> arielb1: it's not until you do match x {}
[18:54:32] <eddyb> or something else (?)
[18:54:55] <eddyb> arielb1: there is 0 information communicated to LLVM about any kind of UB if you just create one of these values out of nothing
[18:55:08] <arielb1> eddyb: that does not make it defined
[18:55:19] <arielb1> it just makes it we-still-didn't-exploit-it-yet
[18:55:26] <eddyb> it does make it more of a footgun than it should be
[18:55:32] <eddyb> because *we know* when we create such a value
[18:56:04] <arielb1> I would be fine with making dereferencing raw pointers to uninhabited types be UB
[18:56:06] <arielb1> or abort
[18:56:09] <arielb1> that's a valid kind of UB
[18:56:23] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[18:56:41] <eddyb> if that happens, then unsafe code is waaay less likely to accidentally create one of these on purpose
[18:57:23] <eddyb> and abstractions built with unsafe code would have to make use of unsafe traits if they do something which would create uninhabited values out of nothing
[18:57:35] <arielb1> eddyb: why?
[18:57:41] <eddyb> that's less likely to be an accidental issue, but you might never know
[18:58:00] <arielb1> could you give an example for where you need unsafe traits?
[18:58:03] <arielb1> Vec doesn't
[18:58:14] <arielb1> containers don't
[18:58:24] <arielb1> they only give you what you put into them
[18:58:38] <arielb1> putting values of uninhabited types into them is UB/impossible
[18:58:48] <arielb1> therefore, you can't get values of uninhabited types from them
[18:59:35] <arielb1> if you have a type that creates values "out of nowhere", even if they are zero-sized
[18:59:36] <arielb1> that is bad
[18:59:42] <arielb1> already bad
[19:00:14] <arielb1> I mean, you can use a zero-sized type to synchronize access to some resource
[19:00:17] <eddyb> hence unsafe traits to opt into this ability
[19:00:25] <arielb1> into what ability?
[19:00:25] <cmr> Opt into what ability?
[19:00:35] <eddyb> creating the value out of nothing
[19:00:42] <eddyb> or it could just use Default, I guess
[19:00:44] <arielb1> eddyb: *that* trait is called Default
[19:00:45] <seanmonstar> how could you do that? there is no value to create
[19:01:01] <eddyb> seanmonstar: you wouldn't implement the trait for uninhabited types
[19:01:10] <eddyb> (if you would, it's an unsafe impl and your problem)
[19:01:33] *** Joins: sigma (sigma@moz-im7cik.range86-135.btcentralplus.com)
[19:01:40] <seanmonstar> can you even? you have to return a value from the fn default() -> T, and you cant make one...
[19:01:50] *** Joins: ff (flaper87Moz@moz-gc8je6.ip57.fastwebnet.it)
[19:01:51] <arielb1> seanmonstar: you can diverge
[19:02:02] <arielb1> T: Default does not imply T inhabited
[19:02:12] <seanmonstar> right
[19:02:13] <eddyb> my point was that you'd be resposnible (via the unsafe trait), instead of the abstraction being broken for some types
[19:02:21] <arielb1> eddyb: what abstraction?
[19:02:24] <seanmonstar> but how can you implement Default on an uninhabited type
[19:02:31] <eddyb> arielb1: one that makes values out of nothing
[19:02:36] <arielb1> impl Default for Void { fn default() -> Self { loop {} } }
[19:02:37] <eddyb> seanmonstar: by panicking
[19:02:40] <eddyb> or whatever
[19:02:46] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:02:56] <seanmonstar> well sure
[19:03:04] <seanmonstar> but then you have a panic
[19:03:04] <eddyb> arielb1: you mentioned something about Drop. what about zero-sized + Copy?
[19:03:21] <seanmonstar> arielb1: isn't that loop UB?
[19:03:25] <arielb1> seanmonstar: no
[19:03:26] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[19:03:37] <seanmonstar> i thought i read infinite loops were ub
[19:03:38] <arielb1> because that is entirely safe code
[19:03:38] <eddyb> arielb1: nevermind
[19:03:47] <eddyb> seanmonstar: where did you read such a thing :P?
[19:03:48] *** Quits: ff (flaper87Moz@moz-gc8je6.ip57.fastwebnet.it) (Quit: 1.1.1)
[19:03:52] <arielb1> C11 makes that UB
[19:04:03] <eddyb> why would they do that?
[19:04:08] <arielb1> because they can
[19:04:17] <nathan7> so they can run an infinite loop in five seconds, clearly
[19:05:04] <nathan7> We all know C is great... it does infinite loops in 5 seconds!
[19:05:35] <seanmonstar> i dont see an issue with that impl of Default tho... it wont ever return and so you wont get a value of Void
[19:06:19] <eddyb> in safe code, it's perfectly safe. that's the sane version in my book, not the broken one
[19:06:38] <eddyb> this is getting a bit ridiculous
[19:06:52] <seanmonstar> i dont even know what is being argued :D
[19:07:19] <nathan7> I was thinking about the Result<T, Void> case
[19:07:31] <eddyb> arielb1: with enough care, we should be able to throw away variants containing uninhabited types and trans match appropriatelly, without requiring changes in matches
[19:07:33] <seanmonstar> nathan7: thats what prompted my asking about in here
[19:07:38] <nathan7> like, repr(Result<T, Void>) == repr(T)
[19:07:48] <nathan7> and the resulting matching stuff
[19:07:54] <eddyb> what's interesting then is that you'd get the current match x {} behavior from Result<Void, Void>
[19:08:06] <eddyb> which you can't construct, so... just be careful in unsafe code :D
[19:08:14] <nathan7> you get this in Idris because you inherently don't need to prove that case
[19:09:08] <nathan7> and you get a safe, non-panicking fn(Result<T, Void>) -> T etc
[19:09:26] <nathan7> like, the prime use case for me is associated error types
[19:09:28] <seanmonstar> eddyb: specifically, i'd hope for the compiler to be able to handle matches of Result<T, Void>, such as in the try! macro. all the Err arms with returns could basically jsut be deleted
[19:10:05] <nathan7> I had an `unsafe trait Uninhabited {}` for this
[19:10:08] <seanmonstar> nathan7: yea exactly. such as FromStr<Err=Void>
[19:10:13] <nathan7> yeah
[19:10:15] *** Joins: flaper87 (flaper87Moz@moz-gc8je6.ip57.fastwebnet.it)
[19:10:28] <eddyb> seanmonstar: there would be no values to branch to those arm's blocks from
[19:10:47] <seanmonstar> eddyb: rephrase
[19:11:05] <eddyb> enum Foo<A, B, C> { A(A), B(B), C(C) }
[19:11:36] <eddyb> Foo<Void, bool, i32> would be a two-variant enum, with discriminants 0 and 1
[19:11:50] <eddyb> (as far as trans::_match is concerned)
[19:11:53] <seanmonstar> sure
[19:11:56] <nathan7> playbot: enum Void {}; let x: Result<i32, Void> = Ok(42); match x { Ok(_) => {}, Err(x) => panic!("wut") }
[19:11:57] -playbot- ()
[19:12:17] <eddyb> and matching over it, there would be branches for 0 and 1, which would lead to the appropriate arms
[19:12:38] <eddyb> if you had an arm for A, that wouldn't be reached because there is no discriminant value for it
[19:12:57] <eddyb> seanmonstar: in your Result<T, Void> case, that makes the enum unary, so there's no branch at all
[19:13:09] *** Quits: flaper87 (flaper87Moz@moz-gc8je6.ip57.fastwebnet.it) (Quit: 1.1.1)
[19:13:42] <eddyb> arielb1, seanmonstar, cmr: thanks for helping me overcome my paranoia :)
[19:13:49] <seanmonstar> eddyb: that's what i would like the compiler to do. currently, it doesnt, unless you include the `match e {}` inside the Err arm
[19:13:56] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:14:07] <eddyb> seanmonstar: but even then, it still has the larger size
[19:14:10] <arielb1> could you create an RFC for making deref of uninhabitable abort?
[19:14:30] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[19:14:40] <eddyb> I can try. that reminds me I have like 3 or 4 small RFCs to write :D
[19:16:09] <seanmonstar> eddyb: yea, a separate optimization is treating Result<T, Void> as sizeof T
[19:16:31] <eddyb> seanmonstar: it's... not really
[19:16:38] <eddyb> seanmonstar: if you do it separately, it's more work
[19:16:50] <edward-san> can someone recap the most important updates from nightly so far?
[19:17:01] <edward-san> *important fixes
[19:17:05] <eddyb> edward-san: "this week in Rust" should help
[19:17:06] <XMPPwocky> edward-san: as in, from 1.0 on?
[19:17:08] <edward-san> *important features
[19:17:13] <edward-san> XMPPwocky, yes
[19:17:20] <edward-san> eddyb, oh, it exists?
[19:17:22] <edward-san> where^
[19:17:24] <edward-san> *?
[19:17:53] <seanmonstar> eddyb: well, if uninhabited types get proper treatment in the compiler, then both could be solved. currently, trans::_match special cases empty enums, every where else an empy enum is treated as `enum Void { Void }`
[19:18:02] *** Joins: _Vi (vi@moz-bbs.vhj.131.104.IP)
[19:18:19] <eddyb> I know of at least 2 other "this week in X" which were inspired by Rust. that reminds me I need to check the LLVM one
[19:18:49] <XMPPwocky> This week in This week in X...
[19:19:28] <eddyb> doener: time to use this for Option<&T>? "The dereferenceable_or_null attribute will now be exploited by the loop invariant code motion pass."
[19:19:43] <eddyb> (i.e. what iterators produce ;;))
[19:21:10] <seanmonstar> eddyb: https://goo.gl/AfubQ2
[19:21:44] <seanmonstar> ideally, both would output the same asm
[19:22:55] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[19:24:54] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:25:15] *** Joins: flaper87 (flaper87@moz-fnn.1e9.132.209.IP)
[19:25:47] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[19:32:40] *** chmanchester|afk is now known as chmanchester
[19:34:47] <reem> eddyb seanmonstar: I have some tools for that in the void crate (extension traits for Result<T, Void> and Result<Void, T>)
[19:35:18] <seanmonstar> reem: yea i saw. i'm interested in the work needed to get the compiler to do it for all empty enums
[19:35:52] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:35:52] <reem> That would be great
[19:36:03] <seanmonstar> since even using rust-void, using try! on a Result<T, RustVoid> wont be optimized
[19:36:25] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[19:37:14] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Connection closed)
[19:37:14] *** Quits: larhat (Adium@moz-vlo5br.cable.virginm.net) (Quit: Leaving.)
[19:37:20] *** Joins: larhat (Adium@moz-vlo5br.cable.virginm.net)
[19:39:40] <eddyb> try_void!? no thanks :D
[19:43:33] *** Joins: A205B064 (A205B064@moz-9s9nhk.nap.wideopenwest.com)
[19:44:52] <pcwalton> acrichto: ping
[19:45:02] *** Quits: semarie (semarie@moz-ols.hu0.7.50.IP) (A TLS packet with unexpected length was received.)
[19:46:14] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[19:46:49] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:47:23] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[19:48:02] *** Quits: sigma (sigma@moz-im7cik.range86-135.btcentralplus.com) (Connection closed)
[19:48:48] <bstrie> SimonSapin: a comment on HN seems to imply that racket is using wtf-8 as well, do you know if this is true?
[19:48:59] *** Quits: flaper87 (flaper87@moz-fnn.1e9.132.209.IP) (Ping timeout: 121 seconds)
[19:53:18] *** Joins: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP)
[19:53:37] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[19:55:55] <edward-san> eddyb, I see a 'this week in rust' but stopped at 18th may
[19:55:58] *** Joins: flaper87 (flaper87@moz-fnn.1e9.132.209.IP)
[19:56:14] <eddyb> hmm, were there no newer ones?
[19:56:22] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:56:26] <edward-san> is this the link: http://this-week-in-rust.org/ ?
[19:56:30] <acrichto> pcwalton: pong
[19:57:45] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[19:57:47] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:58:21] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[20:00:51] *** Joins: genbattle (genbattle@moz-4v0.gkd.16.182.IP)
[20:04:44] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[20:05:10] *** Joins: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu)
[20:06:15] *** Quits: ncarrillo (textual@moz-hr3gaj.subnet.rcn.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:08:44] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:09:19] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[20:09:20] <pcwalton> acrichto: was just discussing how to improve perf of the workqueue on ARM
[20:09:26] <pcwalton> with aturon 
[20:09:39] <pcwalton> it's not performing well due to memory barrier problems. we have a couple of strategies though
[20:10:17] <acrichto> oh interesting
[20:11:37] *** Joins: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net)
[20:12:50] <SimonSapin> bstrie: yes, although they don’t call it that
[20:13:07] <pcwalton> acrichto: the solution isn't likely going to be to move to acquire/release, since until ARM64 that doesn't actually do anything different from SeqCst (although relaxed does)
[20:13:11] <SimonSapin> bstrie: https://simonsapin.github.io/wtf-8/#implementations
[20:14:11] <SimonSapin> bstrie: Racket and Scheme 48’s usage of WTF-8 pre-date the spec and the name
[20:15:00] *** Joins: bdero1 (bran@moz-1h9.8fo.42.70.IP)
[20:15:03] *** Quits: bdero (bran@moz-1h9.8fo.42.70.IP) (Quit: Leaving.)
[20:16:08] <pcwalton> acrichto: instead, we can either try to reduce memory barriers between each atomic operation by moving a few to Relaxed, or we can avoid contention on the workqueue by just gobbling up a bunch of nodes sequentially before inserting them into the work stealing deques
[20:16:48] *** Joins: bdero (bran@moz-1h9.8fo.42.70.IP)
[20:16:48] *** Quits: bdero1 (bran@moz-1h9.8fo.42.70.IP) (Quit: Leaving.)
[20:19:12] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:19:48] *** Joins: ncarrillo (textual@moz-hr3gaj.subnet.rcn.com)
[20:19:51] *** Quits: kushal (kdas@moz-iq5.378.143.114.IP) (Ping timeout: 121 seconds)
[20:19:53] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[20:21:15] *** Joins: bkearns (Adium@moz-rudtng.static.wiline.com)
[20:21:41] *** Joins: erz (erz@moz-fiq1tl.broadband.corbina.ru)
[20:22:07] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[20:22:40] *** Joins: willem (willem@moz-facs2s.dynamic.upc.nl)
[20:26:30] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[20:27:43] *** Joins: akhileshs (akhilesh@moz-8h6801.ga.comcast.net)
[20:30:07] <akhileshs> Hi, I'm new to Rust's type system, and I'm curious as to how linear/affine types are implemented. Any pointers on where to get started?
[20:30:10] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:30:45] *** Joins: iitaku (textual@moz-da5bg2.ocn.ne.jp)
[20:31:18] <kimundi> akhileshs: What exactly do you want to know? Compiler internals?
[20:32:35] *** Quits: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[20:34:08] *** Quits: munksgaard (munksgaard@moz-urnkl5.u.parknet.dk) (Ping timeout: 121 seconds)
[20:37:15] *** Joins: ConnorDo_ (ConnorDoyle@moz-hud.3ra.116.199.IP)
[20:38:27] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (Ping timeout: 121 seconds)
[20:39:59] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[20:41:08] *** Quits: iitaku (textual@moz-da5bg2.ocn.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzz…)
[20:42:09] <simukis> Gankro: how about just posting the copy of your comment (https://github.com/rust-lang/rfcs/issues/1149#issuecomment-108607875)
[20:42:18] <simukis> I can give you copy of the comment I got @ my mail
[20:43:29] *** Joins: zmack (zmack@moz-htpein.home.aster.pl)
[20:44:54] <Gankro> simukis: In retrospect it was a bit... harsh
[20:47:18] <bstrie> SimonSapin: ah, here I thought it was an entirely new invention :)
[20:47:18] <akhileshs> To make my question more specific, could someone point me to the parts in the typechecker where types get consumed/moved values aren't used a second time? 
[20:47:28] <arielb1> akhileshs: borrowc
[20:47:30] <arielb1> *borrowck
[20:47:31] *** Quits: zmack (zmack@moz-htpein.home.aster.pl) (Ping timeout: 121 seconds)
[20:47:36] <arielb1> in librustc_borrowck
[20:47:45] <SimonSapin> bstrie: "independant re-discovery" ?
[20:48:10] <steveklabnik> Manishearth: nice!
[20:51:22] <kimundi> bstrie: Which HN thread is that?
[20:51:48] <bstrie> kimundi: https://news.ycombinator.com/item?id=9651011
[20:52:10] <kimundi> thanks
[20:59:18] *** Quits: ConnorDo_ (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[21:00:08] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[21:00:35] *** Joins: zmack (zmack@moz-qdq.e19.24.188.IP)
[21:01:28] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[21:01:28] *** ChanServ sets mode: +o pcwalton
[21:04:21] *** Quits: bdero (bran@moz-1h9.8fo.42.70.IP) (Ping timeout: 121 seconds)
[21:07:09] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[21:08:27] *** Quits: Kingsquee (kingsley@moz-3fm07c.bchsia.telus.net) (Quit: Konversation terminated!)
[21:08:40] *** Quits: jgallagher (john@moz-d5e8oc.hfc.comcastbusiness.net) (Client exited)
[21:09:34] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[21:14:19] *** Joins: marcusklaas (marcus@moz-14bm7d.upc-g.chello.nl)
[21:15:36] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Connection closed)
[21:16:49] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[21:18:25] <Gankro> language/compiler team people: how viable is such a mechanism: https://github.com/rust-lang/rfcs/pull/1034#issuecomment-107871861 (aliasing methods so that you can do a back+forwards compat method rename)?
[21:19:14] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[21:20:12] *** Quits: erz (erz@moz-fiq1tl.broadband.corbina.ru) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:22:51] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[21:23:05] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[21:26:38] <eddyb> Gankro: what's the issue?
[21:27:32] <Gankro> eddyb: it seems like a slam dunk to *me*, but I don't know language stuff, so I'm asking first :)
[21:27:47] <eddyb> no, I mean, what would that solve?
[21:27:58] <eddyb> overriding one of them would also implement the other?
[21:28:45] <Gankro> eddyb: Yeah
[21:29:10] <eddyb> and only allow implementing one of them?
[21:29:15] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[21:29:17] <Gankro> Yeah
[21:29:28] <eddyb> that should work
[21:29:47] <Gankro> You can't build a circular default impl in this case because there already existed a default impl for the old one
[21:29:56] <eddyb> easiest way is actually #[deprecate(renamed_to="foo")] fn bar
[21:30:07] <eddyb> if you don't want to add syntax for it
[21:30:25] <Gankro> If that works it seems fine
[21:31:05] <eddyb> not sure if acrichto will like it, but that way you focus on the actual implementation and not start another bikeshed :P
[21:34:12] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:34:26] *** Joins: _alexr_ (alessandror@moz-i6d2in.ip47.fastwebnet.it)
[21:34:59] *** Quits: _alexr_ (alessandror@moz-i6d2in.ip47.fastwebnet.it) (Quit: BitchX: for distribution only with a new PC)
[21:36:12] *** Parts: aminb (aminb@moz-b13.071.236.104.IP) ()
[21:39:27] *** Joins: jdm (jdm@moz-mu9.06r.98.75.IP)
[21:39:30] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
[21:42:31] *** Parts: akhileshs (akhilesh@moz-8h6801.ga.comcast.net) ("Leaving")
[21:43:21] *** Quits: nham (nham@moz-lglsfe.il.comcast.net) (Ping timeout: 121 seconds)
[21:48:22] *** Quits: ncarrillo (textual@moz-hr3gaj.subnet.rcn.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:50:54] *** Quits: eibwen (eibwen@moz-v8obbc.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[21:51:14] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[21:52:42] *** Quits: davebettin (textual@moz-acc.cl4.35.72.IP) (Quit: My Mac has gone to sleep. ZZZzzz…)
[21:54:15] *** Quits: zmack (zmack@moz-qdq.e19.24.188.IP) (Connection closed)
[21:55:16] *** Quits: gsingh93 (gulshan@moz-ln1ktu.st3l.iv8o.0004.2601.IP) (Ping timeout: 121 seconds)
[22:02:36] *** Joins: GBGamer (npm@moz-bpa.e0n.56.172.IP)
[22:02:42] *** Quits: GBGamer (npm@moz-bpa.e0n.56.172.IP) (Connection closed)
[22:04:34] *** Joins: nrc (nrc@moz-14pjgj.xtra.co.nz)
[22:04:34] *** ChanServ sets mode: +o nrc
[22:08:17] *** Joins: ncarrillo (textual@moz-mke7jn.cable.rcn.com)
[22:10:40] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[22:13:34] *** Quits: bkearns (Adium@moz-rudtng.static.wiline.com) (Quit: Leaving.)
[22:14:03] *** Quits: kwantam (kwantam@moz-1adqok.DYNAPOOL.NYU.EDU) (Quit: WeeChat 1.1.1)
[22:15:09] *** Quits: arielb1 (Ariel@moz-9he9ta.red.bezeqint.net) (Connection closed)
[22:16:13] *** Joins: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at)
[22:16:19] *** Quits: ncarrillo (textual@moz-mke7jn.cable.rcn.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:18:47] <bluss> I'm suggesting this syntax #[renamed(from="size_hint", since="1.2.0")] fn len_hint(&self) -> ..
[22:20:16] *** Quits: dinfuehr (dinfuehr@moz-jgtob1.highway.telekom.at) (Ping timeout: 121 seconds)
[22:20:36] <nathan7> I liked the fn foo =, really
[22:20:50] <nathan7> though that does mean meddling with the grammar
[22:20:57] <nathan7> but it's an identifier and all
[22:26:13] *** Quits: new_one (new_one@moz-ps5j1c.fs1g.619c.a880.2604.IP) (Quit: WeeChat 1.1.1)
[22:26:34] *** Joins: new_one (new_one@moz-ps5j1c.fs1g.619c.a880.2604.IP)
[22:29:32] *** Joins: bkearns (Adium@moz-rudtng.static.wiline.com)
[22:31:32] *** Joins: madmalik (uid13697@moz-lfin5p.brockwell.irccloud.com)
[22:35:33] *** Quits: willem (willem@moz-facs2s.dynamic.upc.nl) (Quit: leaving)
[22:37:37] *** Joins: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP)
[22:39:33] *** Quits: rovar_ (rovar@moz-96effg.dyn.optonline.net) (Ping timeout: 121 seconds)
[22:41:03] *** Joins: bdero (bran@moz-uiog92.biz.rr.com)
[22:41:39] *** Quits: nicknikolov (nicknikolov@moz-k0r.8sn.209.90.IP) (Ping timeout: 121 seconds)
[22:42:26] *** Joins: woboats (tatterdemal@moz-a0dnkb.ca.comcast.net)
[22:43:08] *** Quits: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com) (Connection closed)
[22:43:09] *** Joins: swgillespie (swgillespie@moz-o29.3un.220.167.IP)
[22:43:28] *** Joins: [o__o] ([o__o]@moz-4s2t5k.compute-1.amazonaws.com)
[22:45:06] *** Quits: bdero (bran@moz-uiog92.biz.rr.com) (Ping timeout: 121 seconds)
[22:49:29] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[22:49:35] *** Joins: kwantam (kwantam@moz-1adqok.DYNAPOOL.NYU.EDU)
[22:51:15] *** Joins: James (quassel@moz-8qs8a3.range86-148.btcentralplus.com)
[22:53:00] <Gankro> fn foo = might be useful for broader uses
[22:53:08] <Gankro> renamed is more focused, though
[22:53:41] <Gankro> bluss: Do you want to knock out an RFC since it was your idea, or should I?
[22:54:55] <bluss> Gankro: you are free to do so
[22:55:48] <Gankro> Shoot, I almost tricked you :P
[22:56:19] <bluss> I can write it later in the week but I have no rush to rename anything really :)
[22:59:47] *** Quits: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu) (Connection closed)
[23:01:36] *** Quits: zxq9 (ceverett@moz-qsm369.mesh.ad.jp) (Quit: Konversation terminated!)
[23:01:51] *** Joins: Jesin (Jesin@moz-t88s6v.cc.lehigh.edu)
[23:04:14] *** Quits: bkearns (Adium@moz-rudtng.static.wiline.com) (Quit: Leaving.)
[23:05:07] *** Joins: bkearns (Adium@moz-rudtng.static.wiline.com)
[23:06:54] *** Joins: adu (ajr@moz-0foa9t.md.comcast.net)
[23:07:21] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[23:09:27] *** Quits: edward-san (Edward`san@moz-6u9adl.retail.telecomitalia.it) (Quit: Watt is love? Baby, don't Hertz me. Don't Hertz me, no morse.)
[23:10:24] *** Joins: nham (nham@moz-lglsfe.il.comcast.net)
[23:11:31] *** Quits: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP) (A TLS packet with unexpected length was received.)
[23:12:22] *** Joins: ConnorDoyle (ConnorDoyle@moz-hud.3ra.116.199.IP)
[23:14:52] *** Quits: jdm (jdm@moz-mu9.06r.98.75.IP) (Quit: )
[23:16:20] <acrichto> WindowsBunny: ping
[23:16:26] <WindowsBunny> acrichto: hi
[23:16:38] <acrichto> WindowsBunny: hm, so I'm wondering if you can help me with this LTCG thing
[23:16:51] <WindowsBunny> acrichto: I feel like I should get some numbers on whether /LTCG actually affects linker performance negatively
[23:16:58] *** Joins: dinfuehr (dinfuehr@moz-rb39fm.highway.telekom.at)
[23:17:06] <acrichto> WindowsBunny: sure, I think I'm just totally lost
[23:17:14] <WindowsBunny> Passing /LTCG or not passing it, has no effect
[23:17:16] <acrichto> so my situation is that I'm trying to add msvc support to libssh2-sys
[23:17:18] <WindowsBunny> except on the time taken
[23:17:26] <acrichto> libssh2 does have a windows build system, and it compiles everything with /GL
[23:17:38] <acrichto> but when rustc links it all together, all the symbols are undefined
[23:17:46] <nathan7> Gankro: fn= has a way better use, actually — pulling in methods from associated types
[23:17:47] <acrichto> yet when I manually take out the /GL, everythign works
[23:18:02] <acrichto> WindowsBunny: yet if I manually pass /LTCG to the linker, you're correct in that it didn't magically fix anything, it still has unresolved symbols
[23:18:15] <acrichto> WindowsBunny: do you know if there's something special that needs to happen to activate LTCG?
[23:18:21] *** Quits: Astrum|Lap (Astrum|Lap@moz-7enfbr.co.comcast.net) (Client exited)
[23:18:21] <WindowsBunny> > If you do not explicitly specify /LTCG when you pass /GL or MSIL modules to the linker, the linker eventually detects this and restarts the link by using /LTCG.
[23:18:27] <acrichto> WindowsBunny: or perhaps, is moving libssh2.lib into libssh2_sys-xxxxx.lib causing problems?
[23:18:37] <acrichto> hm...
[23:18:43] <acrichto> so then why am I getting unresolved symbol errors?
[23:19:10] <WindowsBunny> acrichto: Oh, when compiling libssh2_sys, are you shoving the compiled C bit into the rlib?
[23:19:15] <acrichto> WindowsBunny: yes
[23:19:29] <WindowsBunny> acrichto: ooooo, I bet that's it :D
[23:19:34] <acrichto> hmm.... how so?
[23:19:41] <acrichto> does the normal .lib have some special flags?
[23:19:59] <WindowsBunny> Somehow llvm-ar is losing some critical information
[23:20:13] <acrichto> that would be surprising to me, but I wouldn't put it past it
[23:20:43] <acrichto> lemme try to run some experiments I think
[23:20:48] <Gankro> bluss: Hmm... it's tempting to allow this for traits and structs too
[23:20:56] <WindowsBunny> acrichto: You'd have to do some fancy analysis of the C .lib compiled with /GL, a version without /GL, and the rlib with the /GL version and the non-/GL version
[23:21:01] *** Quits: dinfuehr (dinfuehr@moz-rb39fm.highway.telekom.at) (Ping timeout: 121 seconds)
[23:21:20] <acrichto> WindowsBunny: "you" in this case being... ?
[23:21:30] <WindowsBunny> acrichto: Whoever is analyzing why it isn't working :D
[23:21:35] <acrichto> ah
[23:21:35] <bluss> Gankro: but they can already be renamed with `pub use`
[23:21:41] <acrichto> gonna see if I can get a small repror
[23:22:07] <Gankro> bluss: Can you impl a pub use?
[23:22:07] <bluss> Gankro: oh ok, that doesn't give a good deprecation message though
[23:22:17] <WindowsBunny> acrichto: But I'm pretty convinced its just that /GL modules have some sort of special section or metadata which llvm-ar is not transferring to the rlib in a way that link.exe understands
[23:22:44] <bluss> Gankro: I'm sure you can, if I understand you correctly
[23:23:43] *** Quits: swgillespie (swgillespie@moz-o29.3un.220.167.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:24:26] *** Joins: swgillespie (swgillespie@moz-o29.3un.220.167.IP)
[23:25:02] <acrichto> WindowsBunny: hm yes, looks like this may be the case
[23:25:27] <acrichto> WindowsBunny: if foo.lib is passed directly into the linker, it works, but if foo.lib goes into libfoo.rlib, and then *that's* passed to the linker, it does not work
[23:25:52] <WindowsBunny> acrichto: yep, its a bug with llvm-ar, so not much we can do until thats fixed :D
[23:26:10] <acrichto> WindowsBunny: well... I wouldn't say that
[23:26:13] <acrichto> still looking into it
[23:28:23] <Gankro> bluss: acrichto: burntsushi: huon: aturon: https://github.com/rust-lang/rfcs/pull/1150
[23:29:20] *** Quits: killercup (killercup@moz-723bo4.dip0.t-ipconnect.de) (Quit: Bye)
[23:29:50] <huon> Gankro: some examples would help
[23:30:03] <Gankro> huon: examples?
[23:30:17] <eddyb> over time we'll grow enough annotations to allow automatic refactoring after stable API improvements
[23:30:24] <eddyb> Gankro: an example of the size_hint change
[23:30:37] <huon> Gankro: yeah, of how it would be used
[23:30:57] <huon> also mentioning the interaction with traits since that's the motivating path
[23:31:18] <huon> and currently the only deprecated-renaming we can't do via other means
[23:31:21] <huon> (AFAIK)
[23:32:00] <huon> I'm definitely in favour of the idea, and I'd be interested to hear what others think about that proposed implementation (it seems fine to me)
[23:32:46] <Gankro> Yeah for sure. I kinda raced it out just to get someone to point out the obvious flaws.
[23:32:48] <Gankro> :P
[23:33:50] <eddyb> I hope it can be done with a minimal footprint, i.e. only in trait and impl collection
[23:34:26] <eddyb> you should be able to point two ty::Method at the same DefId
[23:34:37] *** Quits: Rusky1 (russell@moz-fh1jo9.slkc.qwest.net) (Quit: Leaving.)
[23:34:46] *** Joins: Rusky (russell@moz-fh1jo9.slkc.qwest.net)
[23:34:53] <eddyb> I'm just hoping there's no code iterating over the list of AST methods
[23:35:16] <eddyb> (there's likely something like that for associated types)
[23:35:46] <Gankro> eddyb: My proposal of giving the alias weaker shadowing properties might be harder
[23:35:54] <Gankro> But maybe that's a one liner in rustc
[23:36:42] <eddyb> not sure what you mean by that? conflicting methods?
[23:36:52] <eddyb> or import shadowing?
[23:37:42] <Gankro> eddyb: my proposal is that the old name should be silently shadowable in imports
[23:38:00] <eddyb> yeah, that shouldn't be terribly hard
[23:38:11] <eddyb> cue to nrc fighting resolve
[23:38:53] <eddyb> did we ever implement the multiple glob shadowing logic?
[23:39:22] <eddyb> playbot-mini: mod foo { pub struct A; } mod bar { pub struct A; } use foo::*; use bar::*; fn main() {}
[23:39:23] -playbot-mini- <anon>:1:69: 1:76 error: a value named `A` has already been imported in this module [E0251]
[23:39:23] -playbot-mini- <anon>:1 mod foo { pub struct A; } mod bar { pub struct A; } use foo::*; use bar::*; fn main() {}
[23:39:23] -playbot-mini- output truncated; full output at: http://bit.ly/1IetS18
[23:42:39] *** Quits: joneshf-laptop (joneshf@moz-l4h.b5s.208.98.IP) (Ping timeout: 121 seconds)
[23:43:24] *** Quits: eddyb (eddyb@moz-c0q.mv7.25.188.IP) (Ping timeout: 121 seconds)
[23:43:26] *** Joins: larsberg (Adium@moz-mfl.g5u.215.61.IP)
[23:47:27] <Gankro> nrc: ahaha, I litterally saw the RFC and was like "what do we need traits for implementing mutexes for..."
[23:47:46] *** Quits: James (quassel@moz-8qs8a3.range86-148.btcentralplus.com) (Ping timeout: 121 seconds)
[23:48:31] *** Quits: harrisonclarke (harrisoncla@moz-6v8.jf9.227.142.IP) (Connection closed)
[23:58:28] *** Joins: davebettin (textual@moz-acc.cl4.35.72.IP)
