[00:10:07] *** Joins: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net)
[00:13:45] *** Quits: reyre (reyre@moz-C6577D11.dsl.bell.ca) (Client exited)
[00:24:03] *** Joins: tjc (tjc@moz-87C014D8.tmodns.net)
[00:27:45] *** Quits: tjc (tjc@moz-87C014D8.tmodns.net) (Quit: zzzzzzzzzz)
[00:28:07] *** Joins: tjc (tjc@moz-87C014D8.tmodns.net)
[00:35:14] *** Quits: tjc (tjc@moz-87C014D8.tmodns.net) (Ping timeout)
[00:38:40] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[00:38:53] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[00:38:58] *** Joins: tjc (tjc@moz-9201A642.tmodns.net)
[00:39:13] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[00:42:02] *** Quits: tjc (tjc@moz-9201A642.tmodns.net) (Quit: Places to go, people to annoy)
[00:53:55] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[00:55:43] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[01:02:29] *** Joins: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com)
[01:35:11] *** Parts: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net) ()
[01:50:51] *** Joins: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[01:52:34] *** Quits: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[01:54:27] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[01:56:17] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[02:09:03] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[02:55:00] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[02:56:47] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[03:37:31] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[03:37:31] *** ChanServ sets mode: +qo dherman dherman
[03:55:32] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[03:55:39] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[03:57:24] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[04:04:16] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:21:51] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:21:51] *** ChanServ sets mode: +qo dherman dherman
[04:56:03] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[04:57:00] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[04:57:58] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Ping timeout)
[05:15:02] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[05:21:20] *** Joins: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP)
[05:24:11] *** Joins: vivekg (uid10501@moz-E77DEB21.irccloud.com)
[05:46:44] *** Quits: victorporof (victorporo@A9267B9A.768EFFB3.9B1E38F4.IP) (Quit: victorporof)
[06:36:59] *** Quits: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[06:59:40] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[07:39:51] *** Quits: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[07:43:36] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Client exited)
[07:44:03] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[07:45:46] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Ping timeout)
[07:53:24] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[07:58:06] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[08:06:48] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[08:13:38] *** Joins: Nefzaoui (chatzilla@74D388EC.8C82CAFA.360EF119.IP)
[08:19:58] *** Joins: Adityab (Adityab@moz-5117C42E.dip0.t-ipconnect.de)
[08:22:11] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[08:41:36] *** Joins: Debloper (debloper@moz-88FF8AE8.redhat.com)
[08:42:14] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[08:47:02] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[09:05:35] *** Quits: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com) (Ping timeout)
[09:12:29] *** Joins: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net)
[09:12:56] *** Joins: yichoi (yichoi@5AB4884B.FCC4549.14D5B978.IP)
[09:50:29] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[10:04:11] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[10:47:26] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[11:16:40] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[11:18:31] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Ping timeout)
[11:44:13] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[11:46:02] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Ping timeout)
[11:47:10] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[11:49:17] *** bjz_ is now known as boring
[11:51:33] *** boring is now known as bjz
[11:52:40] *** bjz is now known as boring
[11:52:49] *** boring is now known as bjz
[11:53:04] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Bye!)
[11:53:08] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[12:05:42] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Quit: Computer has gone to sleep.)
[12:18:53] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[12:31:12] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Client exited)
[12:42:02] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[12:51:39] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[12:52:02] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[12:54:20] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[13:06:01] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[13:13:19] *** Quits: Nefzaoui (chatzilla@74D388EC.8C82CAFA.360EF119.IP) (Ping timeout)
[13:16:32] *** bhearsum|afk is now known as bhearsum
[13:35:06] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[13:52:34] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[13:53:34] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[13:53:51] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[13:56:54] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[14:01:49] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[14:36:34] *** Joins: reyre_ (reyre@moz-2E2F18CB.senecacollege.ca)
[14:37:24] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Ping timeout)
[14:37:54] *** reyre_ is now known as reyre
[14:51:17] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[14:51:46] *** Joins: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP)
[14:57:16] *** Quits: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com) (Ping timeout)
[15:10:25] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Quit: Lost terminal)
[15:13:17] *** Quits: reyre (reyre@moz-2E2F18CB.senecacollege.ca) (Client exited)
[15:13:35] *** Joins: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP)
[15:20:26] *** Joins: Nefzaoui (chatzilla@74D388EC.8C82CAFA.360EF119.IP)
[15:22:00] *** Joins: sankha93 (Instantbir@A67ECFA2.4F1E6D7D.E7DAB6F9.IP)
[15:24:57] *** Joins: mccr8 (mccr8@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:34:20] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[15:52:31] *** Joins: jdm (jdm@F2D29657.F60B0462.67AC9B1.IP)
[15:58:52] *** Joins: caitp (caitp@moz-9FE842F.cpe.net.cable.rogers.com)
[16:14:11] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[16:18:50] *** Quits: Debloper (debloper@moz-88FF8AE8.redhat.com) (Quit: Leaving.)
[16:26:49] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[16:27:39] *** Quits: Nefzaoui (chatzilla@74D388EC.8C82CAFA.360EF119.IP) (Quit: ChatZilla 0.9.90 [Firefox 22.0/20130618035212])
[16:34:41] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[16:38:56] *** Joins: seth (seth@moz-42C5FAA8.nc.res.rr.com)
[16:42:36] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[16:52:00] *** Joins: lmandel (lmandel@8B192B20.1F93A08E.ADB88A9.IP)
[16:52:11] *** Joins: dherman (dherman@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:52:11] *** ChanServ sets mode: +qo dherman dherman
[16:52:33] <jack> https://etherpad.mozilla.org/Servo-meeting-weekly
[16:52:36] <jack> agenda bashing
[16:53:12] *** Quits: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net) (Ping timeout)
[16:57:19] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Quit: Leaving.)
[16:58:20] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[16:58:22] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[16:58:56] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[16:59:07] <kmc> attempting to vidyo in
[17:00:01] <dherman> is it not in CYA?
[17:00:08] <dherman> I'm apparently the only one in the vidyo room
[17:00:32] *** Joins: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP)
[17:00:35] <kmc> i just tried to call and got no response
[17:00:48] <dherman> ah there's jack
[17:01:12] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:01:20] <kmc> "User did not answer the call"
[17:03:34] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[17:03:37] <kmc> i'm in now
[17:04:27] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:04:49] *** Joins: eholk (eholk@moz-39F1DC8F.uconnect.utah.edu)
[17:06:52] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:08:56] <kmc> jdm: I can implement your suggested fix for https://github.com/mozilla/servo/issues/570
[17:09:09] <jdm> please do :)
[17:10:14] <kmc> so the issue is that local_data_pop will invoke the dtor a second time?
[17:11:01] <kmc> and that happens ultimately at Â«map[index] = None;Â» inside task::local_data_priv::local_get_helper?
[17:11:27] <jdm> I'm not entirely clear how the dtor gets invoked to start with; perhaps we're trying to annihilate all task memory and therefore run destructors
[17:11:39] <jdm> but yes, I can imagine that it would cause the dtor to run twice
[17:13:32] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[17:16:11] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[17:23:14] *** Joins: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net)
[17:33:57] *** Joins: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:41:56] *** Joins: dzbarsky1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[17:42:10] *** Quits: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[17:42:52] *** dzbarsky1 is now known as dzbarsky
[17:51:14] *** Joins: mcclurmc (mcclurmc@moz-8D61EFD1.cable.virginmedia.com)
[17:54:03] *** Quits: sankha93 (Instantbir@A67ECFA2.4F1E6D7D.E7DAB6F9.IP) (Quit: He will be back!)
[18:08:26] *** jdm is now known as jdm|f00ding
[18:12:21] *** Joins: harth (heather@moz-3C999954.hsd1.ca.comcast.net)
[18:15:02] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[18:17:54] *** Quits: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com) (Quit: Leaving.)
[18:21:38] *** Quits: Adityab (Adityab@moz-5117C42E.dip0.t-ipconnect.de) (Quit: Adityab)
[18:22:01] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[18:22:03] *** Joins: eschweic (Adium@moz-BBE3ABD.mv.mozilla.com)
[18:22:08] <SimonSapin> Re more email on dev-servo: I agree. In January~February before I joined I was surprised by how little there was there. Based on git commits there is obviously stuff going on, but itâ€™s hard to know what from the outside
[18:25:42] *** Quits: SimonSapin (simon@88F51059.F3BBB17D.144F44FA.IP) (Ping timeout)
[18:26:14] *** Quits: harth (heather@moz-3C999954.hsd1.ca.comcast.net) (Client exited)
[18:29:52] *** Joins: jet (jet@moz-BE33DA21.fw1.sfo1.mozilla.net)
[18:30:07] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[18:33:32] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:49:01] *** Joins: Adityab (Adityab@C78A4F2D.5E545589.16E13E53.IP)
[18:53:12] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:56:53] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[18:57:49] *** jdm|f00ding is now known as jdm
[19:03:48] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[19:04:06] *** Parts: ehsanul (irc@moz-D1FFCC4A.hsd1.ca.comcast.net) ()
[19:05:05] <kmc> i fixed the segfault but now i'm getting Â«memory_region.cpp:73: void memory_region::free(void*): Assertion `false && "live_allocs < 1"' failed.Â» inside element::finalize, called from the JS GC
[19:05:50] <kmc> so maybe the GC is running after/during destroying the script context
[19:06:18] <jdm> hmm, interesting
[19:06:22] <jdm> kmc: what's the full stack trace?
[19:06:48] <kmc> any specific thoughts or should I just keep digging? right now i'm looking at the various dtors in js::rust and seeing what's called when
[19:07:04] <kmc> jdm: http://pastebin.mozilla.org/2636379
[19:07:07] <jdm> kmc: that indicates that there are no rust allocations existing any more
[19:07:27] <jdm> so we're dropping the compartment, I see
[19:07:28] <kmc> because the task is dead?
[19:08:08] <jdm> how fun; scripttask is being dropped, leading to the JS stuff being dropped, and spidermonkey runs a GC
[19:08:26] <jdm> which then kills our dom tree, which tries to free rust memory
[19:08:42] <jdm> presumably that's what's going on here based on all the glue_drop calls
[19:09:33] <kmc> ok
[19:10:20] <kmc> and freeing rust memory fails because the task is already dead? or for another reason?
[19:11:07] <jdm> I'm not entirely sure
[19:11:38] <jdm> oh, yeah, it sure looks like it
[19:11:57] <jdm> since the whole task is just ScriptTask::new and script_task.start()
[19:12:06] <jdm> so when we drop it, the task is on its way out
[19:12:37] <jdm> kmc: I suspect the solution is an explicit teardown phase
[19:12:38] *** Joins: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk)
[19:12:53] <jdm> where we destroy the JS stuff while the rust task is still valid
[19:14:47] *** Joins: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[19:16:02] *** Joins: harth (heather@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:21:00] *** Quits: jet (jet@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: jet)
[19:21:50] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[19:25:25] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[19:31:57] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[19:32:35] *** Quits: seth (seth@moz-42C5FAA8.nc.res.rr.com) (Input/output error)
[19:33:11] <kmc> ok
[19:38:25] <kmc> i'm calling local_data_pop(global_script_context_key) from handle_exit_msg() which is ordinary task code, so the task should still be valid, but maybe there's a problem with the ordering wrt other things that happen in handle_exit_msg()
[19:38:33] *** Joins: seth (seth@moz-42C5FAA8.nc.res.rr.com)
[19:38:37] *** Joins: Nefzaoui (chatzilla@74D388EC.8C82CAFA.360EF119.IP)
[19:39:29] *** Quits: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com) (Quit: tikue)
[19:40:19] <jdm> calling it from handle_exit_msg sounds fine to me
[19:41:24] <jdm> oh, wait
[19:41:54] * jdm tries to remember all the places that call global_script_context() now
[19:43:16] <jdm> it should probably be the last thing that occurs after explicitly tearing down the JS stuff
[19:43:49] <kmc> hm I'm still getting the crash even without popping the local_data
[19:43:58] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:44:30] <kmc> so I guess this is a different bug; something is going wrong while calling dtors on the components of ScriptTask
[19:44:40] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[19:46:15] <kmc> the crash happens at JS_DestroyContext inside Drop for Cx
[19:46:41] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[19:46:43] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Input/output error)
[19:47:43] *** Quits: seth (seth@moz-42C5FAA8.nc.res.rr.com) (Input/output error)
[19:52:00] *** Joins: jet (jet@moz-BE33DA21.fw1.sfo1.mozilla.net)
[19:57:22] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
[20:01:40] *** Joins: tikue (tkuehn@moz-BBE3ABD.mv.mozilla.com)
[20:02:00] *** Joins: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com)
[20:04:12] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[20:05:23] *** Joins: bz (bzbarsky@moz-A28C5395.bstnma.fios.verizon.net)
[20:05:39] <bz> Does anyone know whether dherman is following the servo list?
[20:06:30] <dherman> bz: I am, though sometimes forget to keep up
[20:06:31] <jdm> bz: it sounds like it, since he made reference to a couple messages
[20:06:58] <bz> dherman!
[20:07:01] <dherman> bz!
[20:07:07] <bz> dherman: what probem are you trying to solve with mutable protos?
[20:07:17] <dherman> oh, it was just a thought
[20:07:17] <bz> dherman: (in today's meeting minutes)
[20:07:22] <bz> Sure; I
[20:07:23] <dherman> lazy prototype allocation
[20:07:27] <bz> Ah
[20:07:28] <dherman> it's probably not sufficient
[20:07:36] <dherman> since you need to hook into anything that might need the prototype
[20:07:39] <dherman> to trigger the allocation
[20:07:41] <bz> right
[20:07:42] <bz> OK
[20:07:55] <dherman> it was just me speaking before I think
[20:08:22] <dherman> as usual, since I do the former more than I do the latter
[20:09:02] <bz> lol
[20:09:05] <bz> OK, thanks
[20:09:07] * bz writes mail
[20:11:08] *** Quits: reyre (reyre@86C3727C.33EE9F8A.1139E686.IP) (Client exited)
[20:13:04] <jack> what's TI?
[20:13:25] <jdm> jack: type inference?
[20:13:27] <jdm> what's the context?
[20:13:33] <jack> bz's email
[20:13:42] <bz> Type inference
[20:14:05] <bz> The thing where the JS engine tries to semi-statically prove things about what properties objects have and the types of those properties
[20:14:09] <bz> mutating prototype chains make that .... hard
[20:14:21] <dherman> yes
[20:14:30] <bz> So if you mutate an objects proto chain the JS engine stops trying to optimize any property access on that object
[20:14:32] <dherman> though we do always have the option of special-casing information in the engine
[20:14:37] <dherman> I'll reply on list though
[20:14:43] <bz> right
[20:15:00] <bz> If we can do something along the lines of "this is a mutation of the proto chain, but nothing depends on the old proto chain"....
[20:15:03] <bz> Then it might be ok
[20:17:53] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:19:27] <dherman> replied
[20:29:21] *** Joins: dzbarsky1 (Adium@moz-BBE3ABD.mv.mozilla.com)
[20:29:38] *** Quits: dzbarsky (Adium@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[20:31:51] *** dzbarsky1 is now known as dzbarsky
[20:45:10] <jdm> tikue: thinking about it further, discussing iframe stuff on IRC is fine. I think we should probably post summaries of our thoughts/architecture fairly regularly, though
[20:46:00] <tikue> jdm: sure, that sounds good with me
[20:46:51] <tikue> jdm: let me see if I can summarize my thoughts at the moment
[20:47:26] <jdm> great
[20:49:59] *** Quits: Nefzaoui (chatzilla@74D388EC.8C82CAFA.360EF119.IP) (Ping timeout)
[20:51:30] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[20:52:38] *** Joins: reyre (reyre@6ED76315.415986EB.47C41102.IP)
[20:54:05] *** Quits: Adityab (Adityab@C78A4F2D.5E545589.16E13E53.IP) (Quit: Adityab)
[20:56:32] <tikue> jdm: https://gist.github.com/tkuehn/3cd74205f9054e5e1804
[20:56:37] <tikue> thoughts on iframe resizing
[20:56:48] * jdm reads
[20:57:10] * tikue fixes typo
[20:57:40] <tikue> one thing to note is that the script and layout tasks need to synchronize iframe id's somehow
[20:58:16] *** Joins: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl)
[20:58:29] *** Quits: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP) (Quit: victorporof)
[21:00:05] <jack> So i think triggering off the render state isn't useful. somehow we need to trigger off the Paint message
[21:00:27] <tikue> jack: trigger what?
[21:01:20] <jdm> tikue: so the goal here is to notify child frame layout tasks that the parent is done reflow?
[21:01:39] *** Quits: reyre (reyre@6ED76315.415986EB.47C41102.IP) (Client exited)
[21:02:00] <tikue> jdm: the parent may not be done with reflow -- I don't know the inner workings of layout but it seems plausible that the size of one element could be computed before reflow finishes
[21:02:03] <jack> tikue: i need to know when to write the png
[21:02:12] <tikue> jack: ah ok
[21:02:30] <jack> maybe i should just write it out in the composite function
[21:02:41] <jdm> it feels unintuitive to me that we have to bounce to the constellation to do so; why don't we have some kind of list of child layout tasks in a more localized place?
[21:02:41] <jack> the issue is that it gets called twice
[21:02:42] <tikue> jdm: so the layout could fire off multiple iframe size messages as they're computed
[21:03:04] <tikue> jdm: they have to go through the script task, since the script task handles reflow
[21:04:07] <jdm> tikue: ok, but is there some reason we can't have a list of child layout tasks in the script task?
[21:04:29] <tikue> jdm: it will need that anyway, so yeah I think we can avoid going through the constellation
[21:04:43] <tikue> jdm: unless there is something I'm forgetting, but I don't think so
[21:05:00] <tikue> ah hold on
[21:05:32] <jack> tikue: the issue is really how do i know which one is the final composite, other than hardcoding it to 2
[21:06:07] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[21:06:21] <jack> I suppose i could inspect if the scene has any children and just assume it's finished when it's not empty
[21:06:33] <tikue> jack: I'm not sure how to know which is the final composite. I suppose one option is to wait for one message from each node
[21:06:51] <tikue> jack: the compositor is going to need to have a representation of the frame tree anyway, to know who is allowed to paint
[21:08:13] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:08:33] *** Joins: seth (seth@moz-42C5FAA8.nc.res.rr.com)
[21:08:51] <jack> oh man, i didn't even think of the multi-painter case.
[21:09:04] <jack> but you are probably right.
[21:09:27] <jack> just wait for non-empty scenes from all painters
[21:10:15] <tikue> jack: yeah, but you should talk to eschweic about this -- I'm not sure how many paint messages a renderer usually sends 
[21:10:43] <tikue> jack: (what with the new per-tile rendering)
[21:12:03] <tikue> jdm: do you remember why I put a pointer to the script task in the page struct? https://gist.github.com/tkuehn/becfdd332d3c162f625e
[21:12:31] <tikue> jdm: trying to get rid of any cyclical references if possible...
[21:13:03] <jdm> I recall pointing that out before
[21:13:09] <jdm> I was not aware of a need for it
[21:14:04] <tikue> ok cool
[21:14:12] *** Joins: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[21:15:08] *** Joins: reyre_ (reyre@moz-9002CDDA.cpe.net.cable.rogers.com)
[21:16:13] *** Quits: reyre (reyre@moz-9002CDDA.cpe.net.cable.rogers.com) (Ping timeout)
[21:18:08] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[21:19:20] *** Parts: bz (bzbarsky@moz-A28C5395.bstnma.fios.verizon.net) ()
[21:20:16] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[21:20:27] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:24:34] *** reyre_ is now known as reyre
[21:29:09] *** Joins: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP)
[21:35:26] *** Quits: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP) (Ping timeout)
[21:36:27] *** Joins: Nefzaoui (chatzilla@74D388EC.8C82CAFA.360EF119.IP)
[21:36:45] <jack> you can't use `return` in a closure?
[21:39:06] <tikue> jack: i didn't know that, but my guess would be due to ambiguity about where it returns to
[21:39:36] <cmr> do-blocks can't have return, but I thought they were usable in |x| { ... } form... maybe not
[21:39:39] <jack> pcwalton: how do i break early from a closure, or is this just a limitation of Rust?
[21:39:56] <pcwalton> jack: it's a limitation of Rust but we could probably fix it
[21:40:00] <pcwalton> easier to do after "for" is gone
[21:45:28] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[21:45:47] *** bhearsum is now known as bhearsum|afk
[21:50:33] *** Quits: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net) (Ping timeout)
[21:52:20] <jack> i can't check for non-empty scene. it's always got children.
[21:52:35] <jack> hardcoding it to two or sending some kind of chaser message i think are the only options
[21:59:06] <eschweic> when is composite called the first time?
[22:01:45] <jack> ugh. i am so confused. composite() is called once, but if i write out the GL pixels, it's all black.
[22:01:53] <jack> if i call compsoite again by hand, the pixels are correct.
[22:02:04] <tikue> that'sâ€¦weird
[22:02:07] <jack> the pixels on the screen are fine
[22:02:48] <jack> maybe glReadPixels reads from the bakc buffer?
[22:04:30] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[22:16:51] *** Quits: SimonSapin (simon@moz-D0C2F181.zone2.bethere.co.uk) (Ping timeout)
[22:29:39] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[22:34:12] *** Joins: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP)
[22:36:03] *** Quits: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP) (Ping timeout)
[22:38:30] *** Quits: Nefzaoui (chatzilla@74D388EC.8C82CAFA.360EF119.IP) (Ping timeout)
[22:40:25] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[22:46:55] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[22:52:03] *** Joins: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net)
[22:53:04] *** Quits: leonvv (leonvv@moz-7D83A5F1.ip.telfort.nl) (Client exited)
[22:56:05] <tikue> I don't like 8-hour work days. I feel like I spend a decent chunk each day trying to remember what I was thinking the day before. +1 for 16-hour work days and instead of 5 day work weeks we have 3-day work sprints?
[22:56:21] <jdm> heh
[22:59:03] <pcwalton> jack: it is possible to set different buffers for draw and read in the platform specific GL initialization
[22:59:09] <pcwalton> I don't know if that's your problem but it's worth keeping in mind.
[23:00:26] *** Joins: ehsanul (irc@moz-A9E56CFE.hfc.comcastbusiness.net)
[23:34:43] *** Joins: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP)
[23:36:31] *** Quits: victorporof (victorporo@864CC037.542EA61F.70D60F75.IP) (Ping timeout)
[23:41:08] *** Quits: mccr8 (mccr8@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: mccr8)
[23:42:25] *** Quits: dherman (dherman@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: dherman)
[23:45:20] *** Joins: ghservo (ghservo@AC22872E.6A2AE50.F3114085.IP)
[23:45:20] <ghservo> [13rust-azure] 15seanshpark closed pull request #25: Added some Canvas Path functions (06master...06master)  02http://git.io/DQLrFA
[23:45:20] *** Parts: ghservo (ghservo@AC22872E.6A2AE50.F3114085.IP) ()
[23:48:06] <bjz> pcwalton: if you *were* to move to lmath, would it be ok if you had a few Servo-specific traits/types? For example I'm not sure if SideOffsets2D fits in to the lib.
[23:48:14] <pcwalton> that's fine
[23:57:07] *** Quits: eatkinson (eatkinson@moz-BBE3ABD.mv.mozilla.com) (Quit: eatkinson)
