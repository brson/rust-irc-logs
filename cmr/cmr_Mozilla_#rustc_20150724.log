[00:01:48] *** Quits: marcusklaas (marcus@moz-0ol9oe.chello.nl) (Client exited)
[00:03:37] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[00:35:26] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[00:43:56] *** Quits: brson (brson@moz-qjbkeh.mtv2.mozilla.com) (Quit: leaving)
[01:39:42] *** Joins: bkoropoff (bkoropoff@moz-kthi5c.wa.comcast.net)
[01:43:55] <bkoropoff> nrc: ping
[02:12:20] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[02:43:52] *** Quits: kimundi (kimundi@moz-4gvoif.8lpn.sem7.57bc.2002.IP) (Ping timeout: 121 seconds)
[02:49:57] *** Joins: kimundi (kimundi@moz-opd.h2h.188.87.IP)
[02:58:16] *** Joins: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP)
[02:58:20] <nrc> bkoropoff: pong
[03:09:29] <nrc> unpong - about to go mobile
[03:24:16] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[03:53:12] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[03:58:48] <Luqman> nrc: no worries, just means i gotta hunt down someone else :P
[04:07:05] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[04:37:30] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[05:02:29] *** Quits: aatch (james@moz-i1k1ks.tlms.2o1v.e006.2406.IP) (Quit: Leaving)
[05:03:21] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[05:58:36] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[06:10:13] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[06:34:59] *** Quits: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com) (Quit: )
[06:35:08] *** Joins: rdgawdzi (sid91768@moz-mt7qcd.highgate.irccloud.com)
[07:06:33] *** Joins: laumann (thomas@moz-3m6.3kq.109.2.IP)
[07:29:28] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[07:34:30] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[07:34:44] *** Quits: bkoropoff (bkoropoff@moz-kthi5c.wa.comcast.net) (Client exited)
[07:44:37] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[07:54:53] *** Joins: doener (doener@moz-fnh.n4j.147.5.IP)
[08:21:32] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[08:44:53] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[09:01:29] <eddyb> nmatsakis, jroesch: hmm, wouldn't fullfilcx do better with a VecDeque rather than just a simple Vec of obligations?
[09:02:28] <eddyb> I used a VecDeque in the eager filter/fullfil logic in Coerce::coerce_unsized
[09:02:34] <eddyb> and I'm wondering if it can be generalized
[09:04:59] * eddyb wonders if Vec![] would've been a better choice, when looking at two lines containing VecDeque::new() and vec![]
[09:35:35] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[10:09:11] <pnkfelix> eddyb: regarding gh26403
[10:09:50] <pnkfelix> eddyb: I agree that pointing Rc<Trait> directly at the backing data (and using negative offsets for the preceding ref-count) is the right fix for "the long term"
[10:10:43] <pnkfelix> eddyb: but it seems like it would still be something one would opt-into via some explicit notation in the definition for Rc<T>, no?
[10:11:04] <eddyb> pnkfelix: it could just be done for all structures with a trailing field that may be unsized
[10:11:07] <pnkfelix> eddyb: i mean, while i could *imagine* trying to do it automatically, it seems like a real foot-gun
[10:11:13] <eddyb> if we don't do that, we need to keep the codegen for both
[10:11:26] <eddyb> pnkfelix: working with raw pointers... yeah
[10:11:29] <pnkfelix> eddyb: that was what I was working my way towards
[10:11:44] <pnkfelix> eddyb: i.e. adopt aatch's 3rd option as the general purpose solution
[10:11:58] <pnkfelix> eddyb: but file a bug saying "we really don't want to be doing this in many cases at all"
[10:12:25] <pnkfelix> eddyb: with a description of the right scheme and a list of the places where it should be deployed
[10:12:30] <eddyb> it's too easy to do allocate(sizeof(Struct<T>)) and cast it to *mut Struct<T> - and that would break if Struct starts allowing unsized T's
[10:13:18] <pnkfelix> eddyb: I'm sorry, I cannot tell what that statement is arguing for or against
[10:13:49] <eddyb> I'm agreeing that it's a footgun
[10:13:56] <eddyb> to do it automatically
[10:14:00] <pnkfelix> eddyb: okay, thanks for clarifying.  :)
[10:14:12] <eddyb> I don't really mind opt-in as long as it's not overengineered
[10:14:38] <pnkfelix> well, just don't put me in  charge of it
[10:14:42] <eddyb> regarding the other issue, size_of_val returning the wrong value. I'm not sure TBQH
[10:14:52] <pnkfelix> that will help reduce the potential for over-engineering.  :)
[10:15:05] <pnkfelix> eddyb: I'm looking at the size_of_val thing now myself
[10:15:16] <eddyb> 20 bytes, that's 8 + 8 + 4
[10:15:36] <pnkfelix> eddyb: right, I figure someone thinks there's supposed to be a drop flag on the end
[10:15:39] <pnkfelix> embedded in the result
[10:15:52] <eddyb> I was going to say that drop flags are the only thing that makes sense
[10:15:55] <pnkfelix> eddyb: but I haven't confirmed that hypothesis
[10:16:04] <eddyb> and I recall a TODO in the trans code for that computation
[10:16:26] <eddyb> removing drop flags should fix the issue entirely ;)
[10:16:50] <pnkfelix> eddyb: true,  I guess that would be another path
[10:17:02] <eddyb> I'm pretty sure the older issue would result in a smaller or equal size
[10:17:29] <eddyb> since it doesn't take into account the alignment of the unsized field (or it might, in the size_of_val case. I'm not sure atm)
[10:18:03] <eddyb> wait, no, it's trickier than that
[10:18:16] <eddyb> pnkfelix: the drop flag ends up being after the unsized field, which is pretty messy
[10:18:27] <pnkfelix> eddyb: that's the strange thing
[10:18:36] <pnkfelix> eddyb: is that I thought nrc's code doesn't even attempt to maintain the flag 
[10:18:44] <pnkfelix> eddyb: so maybe we just need to stop adding it on?
[10:19:21] <pnkfelix> eddyb: (although  at one point I did try adding `#[unsafe_no_drop_flag]` to the test and I thought that didn't fix things
[10:19:34] <pnkfelix> eddyb: (which would seem to contradict this whole discussion.  let me see...)
[10:19:36] <eddyb> I see no point in trying to fix this size_of_val issue in a convoluted way instead of prioritizing the removal of interior drop flags
[10:19:51] <pnkfelix> eddyb: the reason
[10:19:54] <eddyb> pnkfelix: it might ignore the flag in this path
[10:20:02] <pnkfelix> eddyb: is that I want --enable-debug to start working again
[10:20:03] <eddyb> err, the attribute to remove the flag
[10:20:13] <pnkfelix> eddyb: so that I can actually make progress incrementally
[10:20:24] <pnkfelix> eddyb: on patches to remove the drop flags
[10:20:39] <eddyb> don't tell me you have a circular dependency here :P
[10:20:46] <pnkfelix> eddyb: see, there's a circular thing here.  (The circularity goes away if you remove "incrementality" from the development process)
[10:21:08] <pnkfelix> eddyb: anyway, I promise I won't spend too long on the size_of_val issue
[10:22:33] <eddyb> I looked into coercions today and, yeah, seems that I was wasting time waiting on jroesch's snapshottable fullfilcx, the use of snapshots during coercion attempts can be reduced to two smaller bits, and what I want to add is outside those
[10:31:58] *** Joins: eddyb_ (eddyb@moz-j5m.32b.126.86.IP)
[10:34:59] *** Quits: eddyb (eddyb@moz-hhq.qs4.25.188.IP) (Ping timeout: 121 seconds)
[10:40:04] *** Joins: arielb1 (Ariel@moz-1hdjvc.cablep.bezeqint.net)
[10:55:22] *** eddyb_ is now known as eddyb
[11:48:24] *** Joins: iu (iu@moz-6263qv.cc.cmu.edu)
[12:13:17] *** Quits: jroesch (sid26078@moz-o13a59.charlton.irccloud.com) (Quit: )
[12:13:33] *** Joins: jroesch (sid26078@moz-rp9ic4.irccloud.com)
[12:32:44] *** Parts: iu (iu@moz-6263qv.cc.cmu.edu) ()
[12:34:45] <nmatsakis> eddyb: no, I don't think a VecDeque is what we want; for one thing, we want to track the full tree, for error messages and improved caching ability
[12:35:03] <eddyb> oh, right, that bit
[13:08:00] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Connection closed)
[13:08:38] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[14:14:00] *** Quits: laumann (thomas@moz-3m6.3kq.109.2.IP) (Ping timeout: 121 seconds)
[14:14:15] *** Joins: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de)
[14:14:27] *** Quits: killercup (killercup@moz-4udt1b.dip0.t-ipconnect.de) (Quit: Bye)
[15:23:01] <eddyb> nmatsakis: was the trait selection regression my fault?
[15:23:26] <eddyb> I thought it was inside a probe before my changes, as well. I'll have to check it
[15:26:05] <nmatsakis> eddyb: it was your change that caused it, but no big thing
[15:26:15] <nmatsakis> eddyb: we did it both ways before
[15:26:26] <eddyb> I may have mistakenly micro-optimized
[15:27:03] <eddyb> nmatsakis: I don't see why you changed everything, though
[15:27:11] <eddyb> it seems like the fix is just one line
[15:28:32] <nmatsakis> eddyb: because I found the old code opaque, no offence
[15:28:44] <nmatsakis> that is, not horribly so, I just thought it was not as clear as it could be.
[15:28:47] <eddyb> I find the new code opaque
[15:28:57] <eddyb> *shrug*
[15:29:01] <eddyb> (also less efficient)
[15:29:07] <nmatsakis> it is less efficient, I agree.
[15:29:45] <eddyb> wait
[15:29:51] <eddyb> nmatsakis: you removed some of the sanity checking
[15:30:09] <eddyb> which means you can write it as a for loop instead of while let
[15:30:31] <eddyb> nmatsakis: and you can use commit_if_ok instead of probe
[15:30:39] <eddyb> if you want to go down that route
[15:31:14] <eddyb> it's shorter and more efficient than the old code, my code, or yours
[15:31:22] <nmatsakis> I started out with a for loop
[15:31:26] <nmatsakis> I jsut thought that the way I wrote it was clearer
[15:31:34] <nmatsakis> it separates out the "select the thing"
[15:31:39] <nmatsakis> from "sum up all the things that come before the match"
[15:31:46] <nmatsakis> the only real inefficiency is building up the vector
[15:31:50] <nmatsakis> which is very transient
[15:31:54] <eddyb> also matching twice!
[15:32:07] <nmatsakis> well, ok, in this case we can match once, your'e right
[15:32:14] <nmatsakis> normally that's not an option but in this particular case we can
[15:32:19] <nmatsakis> (since we already did the matching in select)
[15:32:44] <nmatsakis> ok, I'll rewrite that part
[15:32:48] <nmatsakis> why not
[15:34:07] <eddyb> https://github.com/rust-lang/rust/blob/master/src/test/compile-fail/destructure-trait-ref.rs#L38
[15:34:28] <eddyb> I don't know where that Sized error comes from
[15:34:45] <eddyb> but it disappears if I isolate coerce_unsized's snapshot from the rest of the coercion logic
[15:35:00] <eddyb> (and I get "type `Box<T>` cannot be dereferenced")
[15:35:13] <eddyb> I can't see how that isolation can affect anything but error messages
[15:35:52] <eddyb> might need a crater run though
[15:51:41] <arielb1> nmatsakis: I might even put the index within the ObjectCandidate
[15:52:48] <arielb1> (nitpick)
[15:53:40] *** Quits: mystor (sid79584@moz-761b3h.charlton.irccloud.com) (Quit: )
[15:53:48] *** Joins: mystor (sid79584@moz-o585r8.ealing.irccloud.com)
[17:12:53] *** Quits: arielb1 (Ariel@moz-1hdjvc.cablep.bezeqint.net) (Quit: Ex-Chat)
[17:27:37] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[17:27:45] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (A TLS packet with unexpected length was received.)
[17:49:45] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[18:23:27] *** Joins: brson (brson@moz-l8ebtf.sfo1.mozilla.com)
[18:23:27] *** ChanServ sets mode: +qo brson brson
[18:28:25] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[18:54:45] *** Quits: brson (brson@moz-l8ebtf.sfo1.mozilla.com) (Connection closed)
[18:58:06] *** Joins: killercup (killercup@moz-f6o3r9.dip0.t-ipconnect.de)
[18:58:46] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[19:10:18] <eddyb> nmatsakis: not sure if we were supposed to do things to the spreadsheet
[19:10:42] <nmatsakis> eddyb: writing a 1 is fine :)
[19:11:04] <eddyb> I saw the second row and thought I might as well, in case I miss the mail or something else comes up
[19:11:41] <eddyb> I want Mir. I want peace
[19:12:07] <nmatsakis> eddyb: any exciting PRs I should highlight in the compiler subteam report? 
[19:12:17] <nmatsakis> that you can think of off the top of your head
[19:12:20] <nmatsakis> from last two weeks or so
[19:12:47] <nmatsakis> I thought maybe https://github.com/rust-lang/rust/pull/27050
[19:13:13] <eddyb> if anything happened, I probably wasn't paying enough attention
[19:13:33] <eddyb> nmatsakis: ah, but that's not merged yet :(
[19:13:44] <nmatsakis> yeah
[19:13:47] <nmatsakis> but its' still of interest
[19:14:09] <eddyb> https://github.com/rust-lang/rust/pulls?q=is%3Apr+is%3Aclosed+author%3Arust-lang%2Fcompiler
[19:14:10] <nmatsakis> meh, I'll just leave it off
[19:14:12] <eddyb> this doesn't work :(
[19:14:18] <nmatsakis> I should try to keep track better
[19:14:25] <nmatsakis> been a busy couple of weeks for me (in personal life)
[19:14:32] <nmatsakis> (and work, of course :)
[19:15:47] <eddyb> me too, I... I've probably told waaay too many people that I managed to get in the best uni in Romania. big deal :P
[19:16:05] <nmatsakis> eddyb: hey, I hadn't heard!
[19:16:06] <nmatsakis> that's great!
[19:16:15] <eddyb> oh I thought you were around the last time I ranted about it
[19:16:24] <nmatsakis> if I was, I didn't see
[19:16:40] <eddyb> the Polytechnic uni, it's basically engineering everything
[19:17:10] <eddyb> there's a Faculty of Engineering in Foreign Languages, which has sections equivalent to the top ones in other faculties
[19:17:24] <eddyb> but smaller and in English, French and German
[19:17:56] <eddyb> the best one is (obviously :P) CS&IT, in English. that's where I am
[19:18:45] <eddyb> the whole thing was rushed, I didn't know this existed a month ago
[19:19:31] <eddyb> but it's already payed off, finally I have classmates who care about programming and building cool things :D
[19:47:22] *** Joins: LinuxBunny (Retep998@moz-vlal7g.east.verizon.net)
[19:48:12] *** Joins: achanda (achanda@moz-s19.c8s.234.98.IP)
[19:52:21] *** Joins: achanda_ (achanda@moz-qv7q4n.ca.comcast.net)
[19:52:51] <jroesch> eddyb: congrats! that's good news
[19:53:06] <eddyb> thanks! :D
[19:53:19] <jroesch> I hadn't seen it either, had my head down in papers and code the last week
[19:53:19] *** Quits: achanda (achanda@moz-s19.c8s.234.98.IP) (Ping timeout: 121 seconds)
[19:54:55] <jroesch> eddyb: what is the school year like for the university? does it start soon?
[19:56:57] <eddyb> jroesch: 1st of October
[19:57:08] <eddyb> so I have two more months
[19:57:14] *** Quits: LinuxBunny (Retep998@moz-vlal7g.east.verizon.net) (Ping timeout: 121 seconds)
[19:58:55] <jroesch> cool, its about when I start school again
[19:59:18] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[19:59:23] *** Quits: achanda_ (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[20:09:22] <nmatsakis> eddyb: (sorry, lost internet) congratulations again, that's great 
[20:10:16] <eddyb> it better be, cause I'm doing 4 years of it :D
[20:10:20] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[20:15:43] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[20:16:09] <nagisa> eddyb: PhD?
[20:16:19] <eddyb> pfffffft
[20:16:26] <eddyb> nagisa: I'm not even 20!
[20:16:38] <nagisa> eddyb: oh, so we are pretty similar then!
[20:16:52] <eddyb> finished highschool this year
[20:18:57] *** Joins: arielb1 (Ariel@moz-1hdjvc.cablep.bezeqint.net)
[20:19:36] <nagisa> eddyb: I donâ€™t know about Romania, but in my lands the best uni was pretty underwhelming so far (am 2 years in). Mostly because everything is oriented towards people who are less experienced, yknow.
[20:20:30] <nagisa> I wish you to have it better :)
[20:20:47] <eddyb> engineering. robots. I hope we get access to the cool labs
[20:20:59] <eddyb> pretty sure eletronics is mandatory anyway
[20:21:53] <eddyb> but yeah, there's no knowing how it's like until you go the distance
[20:34:46] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[20:38:55] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[20:43:06] <jroesch> I found some courses to be hit and miss in my ugradd
[20:43:25] <jroesch> mostly dependent on professor 
[20:43:43] <Elaine> I've not enjoyed my undergrad education in the slightest.
[20:44:17] <jroesch> acrichto: described the OS course he TA'd at CMU sounded like a blast
[20:45:49] <jroesch> Elaine: I found that the graduate courses were the best, ugrad has to cater to the average student and is usually dumb-ed down or full of busy work
[20:52:17] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[20:52:45] <eddyb> I don't even know what graduate and undergraduate mean
[20:55:47] <nagisa> undergraduate = first 4 years; graduate = more years; PhD = even more years after that. Something like that.
[20:55:51] <jroesch> graduate (M.S + PhD), ugrad (bachelors)
[20:56:08] <jroesch> depends on what country you go to school in a well
[20:56:42] <jroesch> US often times the M.S and PhD will be awarded as part of the same program, in Europe you sometimes have to get one before the other
[20:56:56] <jroesch> some US schools require you to obtain them in order as well
[20:57:16] <jroesch> pretty sure Berkeley and MIT work that way from my grad school visits 
[21:07:10] *** Quits: Manishearth (manishearth@moz-uc30rq.anapnea.net) (Connection closed)
[21:07:14] *** Joins: manishearth (manishearth@moz-uc30rq.anapnea.net)
[21:07:14] *** ChanServ sets mode: +ao manishearth manishearth
[21:08:11] *** Quits: manishearth (manishearth@moz-uc30rq.anapnea.net) (Quit: Lost terminal)
[21:08:22] *** Joins: manishearth (manishearth@moz-uc30rq.anapnea.net)
[21:08:22] *** ChanServ sets mode: +ao manishearth manishearth
[21:23:04] <eddyb> jroesch: ahhh, yeah, all 3 stages are separated here
[21:28:21] *** Quits: arielb1 (Ariel@moz-1hdjvc.cablep.bezeqint.net) (Quit: Ex-Chat)
[22:07:24] *** Joins: achanda_ (achanda@moz-qv7q4n.ca.comcast.net)
[22:07:44] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[22:28:28] *** Quits: achanda_ (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[22:51:47] *** Quits: killercup (killercup@moz-f6o3r9.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[23:22:03] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[23:27:12] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[23:31:06] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[23:43:02] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[23:45:16] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[23:45:45] *** Joins: bkoropoff (bkoropoff@moz-kthi5c.wa.comcast.net)
[23:45:56] <bkoropoff> Hello, hello
[23:47:32] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
