[00:00:10] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[00:00:22] *** Quits: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch) (Quit: Leaving.)
[00:00:29] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[00:00:41] *** Joins: ryeguy (ryeguy@9C569A0.5D1143CD.E8644521.IP)
[00:00:57] *** Joins: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch)
[00:01:02] *** Joins: blank_name (blank_name@463DB555.53526368.6D228269.IP)
[00:01:17] <kimundi> strcat: Better than having them unfiled :)
[00:02:25] *** Joins: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP)
[00:02:43] *** Quits: hhhhhhhhhh (mike@moz-6C356074.stcatz.ox.ac.uk) (Quit: WeeChat 0.4.3)
[00:03:55] *** Joins: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP)
[00:03:56] *** ChanServ sets mode: +ao dherman dherman
[00:05:48] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[00:07:10] *** Quits: eholk (eholk@moz-BA312F07.crest.iu.edu) (Quit: eholk)
[00:07:34] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[00:07:44] *** Quits: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net) (Input/output error)
[00:08:12] <pcwalton> down to 238 type errors
[00:08:21] <strcat> pcwalton: more Vec<T>?
[00:08:24] <pcwalton> yes
[00:08:25] <pcwalton> in librustc
[00:08:56] <eddyb> that might complicate the second PR
[00:09:07] *** Quits: steffenomak (steffenoma@moz-FB0A4BEB.student.uu.se) (Ping timeout)
[00:09:08] <eddyb> the first one should get a r+ soon
[00:09:46] <huon> eddyb: don't you just love rebases? :P
[00:09:47] <ChrisMorgan> strcat: you can use attr in a macro and pass it #[doc = "…"]
[00:09:53] <eddyb> pcwalton: any idea where nmatsakis is/what he is doing?
[00:09:57] <huon> lenary: you could ask on stack overflow
[00:10:13] <pcwalton> eddyb: he's presenting proposals atm
[00:10:20] <eddyb> DST?
[00:10:23] <strcat> ChrisMorgan: true, but at a certain point it's much easier to just leave these 8 lines of code outside of the macro ;p
[00:10:30] <strcat> they're just type definitions
[00:10:37] <huon> lenary: (at least, it will make getting an answer more asynchronous and not rely on someone being here right now.)
[00:10:41] <eddyb> huon: but complicated rebases mean I have to recompile and test etc. :(
[00:10:41] <strcat> imo it's much easier to read them this way
[00:10:56] <strcat> (otherwise, it's not as clear that one has NoPod)
[00:10:59] <huon> lenary: I don't think we have good docs about handling this case that I can just point you at
[00:11:07] <huon> unfortunately :(
[00:11:09] <lenary> :(
[00:11:26] <lenary> i've reduced the number of errors, certainly
[00:11:28] <lenary> thank you
[00:11:41] <lenary> still getting lots of 'use of moved value'
[00:11:44] <eddyb> pcwalton: I think I bug him a bit too much already :P. "presenting proposals" sounds interesting, can't wait to hear about them
[00:11:52] <pcwalton> oh, I'm sure it's no problem
[00:11:53] *** Quits: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch) (Quit: Leaving.)
[00:12:47] <huon> lenary: the mailing list is also an option
[00:13:15] *** Joins: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net)
[00:14:21] *** Quits: stevegury (stevegury@636AC086.5999CED5.71743E61.IP) (Client exited)
[00:14:41] <ChrisMorgan> I suspect that questions about *using* Rust are better on Stack Overflow at present—the mailing list is primarily about developing the language and is a rather chaotic place at present.
[00:15:11] *** Quits: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net) (Ping timeout)
[00:15:52] <strcat> s/developing the language/bikeshedding and arguing about other languages/ ;)
[00:16:03] <eddyb> ChrisMorgan: oh dear I thought there are no new ML posts.... I was looking at the February page
[00:16:06] *** Quits: zimbatm (zimbatm@moz-D4F596B.cable.virginm.net) (Input/output error)
[00:16:21] <ChrisMorgan> strcat: alas, too true
[00:16:25] *** Joins: stevegury (stevegury@636AC086.5999CED5.71743E61.IP)
[00:16:34] <ChrisMorgan> eddyb: just imagine, then we could get things done!
[00:16:44] <strcat> I do enjoy arguing about pointless stuff when I'm bored though
[00:16:45] * ChrisMorgan is too cynical :P
[00:16:47] *** Joins: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net)
[00:17:04] <jdm> if I have a field of type Option<extern "C" fn(..)>
[00:17:07] <huon> eddyb: calendars are complicated :P
[00:17:18] <jdm> how can I find out what the fn pointer's value is?
[00:17:24] <jdm> via println
[00:17:34] <huon> transmute to *u8?
[00:17:43] <jdm> good call
[00:17:44] <ChrisMorgan> huon: "There *must* be another day or two in February!"
[00:17:45] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:17:50] <strcat> jdm: although something to keep in mind is that rust doesn't consider function addresses to be significant
[00:17:59] <eddyb> ChrisMorgan: haha yeah
[00:18:02] <jdm> strcat: what's that mean?
[00:18:06] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[00:18:12] <eddyb> jdm: you can have copies
[00:18:20] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:18:34] <strcat> jdm: we allow LLVM to merge functions even when it changes two functions to end up with the same address
[00:18:41] <huon> jdm: LLVM can merge two functions with different names if they have the same contents
[00:18:44] <eddyb> ohh we do that?
[00:18:47] <strcat> eddyb: yes
[00:18:48] <jdm> ok, thanks for the heads up
[00:18:51] <strcat> and I want us to do it for globals too
[00:18:54] *** Joins: nszceta (hax@moz-E6CA8D6.hsd1.pa.comcast.net)
[00:18:56] <eddyb> so transmute wrappers can be merged?
[00:19:06] <strcat> eddyb: yes, but we can't use mergefunc yet
[00:19:12] <eddyb> strcat: well, we already cache strings, so that's good
[00:19:20] <eddyb> I wish the string name would indicate its content
[00:19:28] <strcat> eddyb: and mergefunc won't be run at -O0
[00:19:29] <eddyb> instead of being str55123
[00:19:37] <strcat> and probably not at -O1 either
[00:19:40] <strcat> it breaks debugging too much
[00:20:23] <strcat> the thin wrapper functions should be marked inline(always) if a) having them in the debugger isn't viewed as important and b) the code is *smaller* with inline(always)
[00:20:47] <strcat> in most cases, I think the first reason will prevent getting rid of them at public API boundaries...
[00:20:56] <strcat> but it's important to avoid them internally
[00:21:02] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[00:21:02] <strcat> (in hot code paths)
[00:21:16] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[00:21:21] *** Joins: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP)
[00:21:30] <strcat> the pass dealing with inline(always) is faster than doing codegen
[00:21:34] *** Quits: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP) (Quit: Lost terminal)
[00:21:53] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[00:21:54] <eddyb> strcat: hmm, mergefunc can result in better perf cache-wise, right?
[00:21:58] <strcat> eddyb: yes
[00:22:12] <strcat> eddyb: they are also investigating merging similar functions
[00:22:15] <strcat> and factoring out the differences
[00:22:19] <strcat> but that's an --opt-size thing
[00:22:24] <eddyb> riight
[00:22:26] <strcat> you probably wouldn't usually want it
[00:22:56] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[00:23:46] <strcat> huon: https://github.com/mozilla/rust/pull/12697 r?
[00:23:50] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:23:54] *** Quits: hoverbear (hoverbear@moz-51AA3137.wireless.uvic.ca) (Quit: Taking a nap.)
[00:24:33] <huon> oh, only libsyntax needs #[allow(deprecated)]? that's pretty cool.
[00:24:43] <strcat> huon: well and I did librustc since it will need it soon
[00:24:44] <huon> oh, and librustc
[00:24:55] <strcat> it technically doesn't atm but it definitely uses map a lot
[00:24:57] *** kimundi is now known as zz_kimundi
[00:24:57] <huon> why append and append_one?
[00:25:10] <huon> other than not being methods, they seem useful?
[00:25:24] <huon> (they move, not allocate.)
[00:25:39] <strcat> huon: hm, I guess they're okay then
[00:25:45] <strcat> I just marked them because they're free fns
[00:25:57] <strcat> I'll undo that
[00:26:05] <doomlord_> today i can't seem to link/run rust on android :( i was manually linking it yesterday
[00:26:42] <strcat> huon:     fn append(self, rhs: &str) -> ~str;
[00:26:45] <strcat> consistency! :(
[00:27:05] <huon> also, could you write `#[deprecated="prefer `.iter().map(...)` instead"]` or something, to guide users to what to use
[00:27:16] <huon> (it's printed with the warning.)
[00:27:43] <strcat> huon: I somewhat doubt that anyone uses it other than libsyntax/librustc... ;p
[00:27:51] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[00:27:52] <huon> strcat: what's the comparison with str's append?
[00:28:02] <strcat> huon: totally different ;s
[00:28:15] <strcat> well not really
[00:28:23] <huon> strcat: I would expect some people do use vec.map directly
[00:28:27] <huon> oh, wait vec_ng
[00:28:37] <strcat> huon: yeah I am not going to bother with vec.rs
[00:28:38] <eddyb> strcat: pfft the ML... but then I find pearls like this https://news.ycombinator.com/item?id=7052518
[00:28:39] <huon> either way, message is low cost to add
[00:28:46] <strcat> huon: true
[00:28:58] <strcat> huon: but it's going to be a long explanation...
[00:29:24] *** Joins: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com)
[00:29:39] <huon> strcat: doesn't have to be, just describe the replacement
[00:29:47] <huon> no need for the underlying reason
[00:30:14] <huon> if they really want to know the reason, they can git blame or ask here.
[00:30:57] <strcat> huon: there
[00:31:04] *** Quits: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com) (Ping timeout)
[00:31:06] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:31:30] <ryeguy> what does _ng stand for?
[00:31:36] <eddyb> newgen
[00:31:39] <huon> next gen
[00:31:42] <eddyb> err
[00:31:44] <eddyb> >:(
[00:31:46] <strcat> it will be renamed to vec.rs
[00:31:53] <strcat> the current vec.rs can become slice.rs
[00:31:53] <ryeguy> ah, that was my next question 
[00:31:54] <huon> strcat: trailing ` after map's )
[00:31:57] <huon> r=me
[00:32:15] <eddyb> strcat: or array, even
[00:32:15] *** Quits: stevegury (stevegury@636AC086.5999CED5.71743E61.IP) (Quit: stevegury)
[00:32:27] <strcat> eddyb: imo slice is a better name
[00:32:39] <eddyb> maybe. we'll see
[00:32:50] <strcat> vector (Vec<T>), slice [T], and array [T, ..n] which is a subtype of a slice
[00:33:08] <eddyb> so ~[T] is an owned slice, instead of owned array?
[00:33:20] <eddyb> Rc<[T]> ref-counted slice, instead of ref-counted array?
[00:33:20] <strcat> eddyb: yes
[00:33:44] <eddyb> I don't mind slice, I just feel like it fits &[T] better than anything else
[00:33:50] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[00:34:04] <strcat> C++ has std::array and std::vector, where the former is a fixed-size array
[00:34:09] <strcat> so imo it's clearer
[00:34:16] <strcat> and C arrays are also like std::array
[00:34:22] <eddyb> DST [T] is dynarray, right?
[00:34:24] <strcat> Go also has the same split
[00:34:36] <strcat> eddyb: hm? I'd call [T] a slice
[00:34:46] <eddyb> no, I mean, in C++14
[00:34:56] <eddyb> can one do dynarray<dynarray<T>>, btw? or did I ask this already?
[00:35:01] <strcat> eddyb: dunno, they removed part of the standard
[00:35:06] <eddyb> ohh :/
[00:35:11] <strcat> go look at the draft, they just released it
[00:35:18] <strcat> will be released as a standard soon
[00:35:26] <strcat> 'soon' -> sometime this year ;p
[00:36:22] <aatch> I think that `[T]`, as the DST, being slice is better because it's not too hard to add ownership into it.
[00:37:34] *** Joins: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu)
[00:37:38] <aatch> but making &[T] not a slice would be confusing
[00:37:41] *** jorendorff is now known as jorendorff_away
[00:37:47] *** Joins: sindork_ (sindork@ABFA98AB.DD47BB48.F7A44A1B.IP)
[00:37:48] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[00:37:57] <eddyb> aatch: &[T] being borrowed array is weird?
[00:38:17] <eddyb> though you're right, I'd rather keep slice for &[T]
[00:38:31] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:38:36] *** Quits: Guest (textual@moz-310FD28A.dynamic.caiway.nl) (Quit: Computer has gone to sleep.)
[00:38:56] <aatch> eddyb, kinda. I think slice gets across thats its a fixed size better.
[00:38:58] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[00:39:10] <aatch> since you have a slice of memory
[00:39:37] <eddyb> I'm okay with slice of memory :)
[00:39:42] *** Quits: rpearl (rpearl@moz-2B41ACB5.andrew.cmu.edu) (Quit: leaving)
[00:39:56] <strcat> eddyb: I'd rather just call them all slices + say array for [T, ..n]
[00:40:06] <strcat> and 'vector' for dynamic array
[00:40:27] <strcat> eddyb:  I'd like to say & is a reference across all the docs too...
[00:40:27] <aatch> strcat, that was what I was getting at.
[00:40:40] *** Quits: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it) (Ping timeout)
[00:40:44] <strcat> 'borrow a reference'
[00:40:54] <strcat> but when just talking about the type, just 'reference'
[00:41:12] <strcat> it doesn't really need to be repeated over and over that they're borrowed ;p
[00:41:23] <strcat> makes it less approachable to people from other languages imo
[00:41:27] *** Quits: sindork_ (sindork@ABFA98AB.DD47BB48.F7A44A1B.IP) (Quit: http://quassel-irc.org - Chat comfortably. Anywhere.)
[00:41:27] <strcat> sounds scary
[00:41:41] <strcat> certainly sounded scary to me when I was learning rust
[00:42:10] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:42:23] <aatch> &[T] -> reference to a slice, ~[T] -> slice that you own.
[00:42:23] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[00:42:57] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:43:47] *** Joins: zimbatm (zimbatm@moz-D4F596B.cable.virginm.net)
[00:43:52] *** Quits: derek_c (derek@moz-A4716BAD.cit.cornell.edu) (Ping timeout)
[00:45:12] *** Joins: sruggier (sruggier@moz-B9FB4CF4.cpe.pppoe.ca)
[00:45:28] *** Quits: zimbatm (zimbatm@moz-D4F596B.cable.virginm.net) (Ping timeout)
[00:45:54] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[00:47:24] *** Joins: sigma (sigma@C91C7F36.70518F41.9D18269F.IP)
[00:48:09] *** Joins: josh (josh@moz-244364B2.cable.virginm.net)
[00:51:58] *** Quits: sruggier (sruggier@moz-B9FB4CF4.cpe.pppoe.ca) (Quit: Leaving.)
[00:52:30] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[00:52:35] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[00:52:49] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[00:53:02] *** Joins: Siosm (quassel@moz-9911B053.fr)
[00:54:17] *** Quits: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it) (Ping timeout)
[00:54:48] <pcwalton> down to 104 errors
[00:55:08] *** Quits: bjustin (bjustin@moz-8FC28563.sierrabravo.net) (Quit: Textual IRC Client: www.textualapp.com)
[00:56:37] <strcat> meh, someone actually sent me an off-list email complaining that I referred to rust's libraries as the 'standard library' even though rust doesn't have a standard
[00:56:49] * strcat shrugs
[00:56:59] <huon> does Python have a standard?
[00:57:01] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[00:57:02] <strcat> no
[00:57:21] <eddyb> lol
[00:57:24] <sfackler> strcat: that's pretty nuts
[00:57:24] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Input/output error)
[00:57:29] *** Quits: ecr (chatzilla@moz-10C88DA7.dyn.cs.washington.edu) (Ping timeout)
[00:57:44] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[00:57:50] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[00:58:42] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[00:58:42] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Connection reset by peer)
[00:58:55] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[00:59:56] <sfackler> "I'd just like to interject for a moment...."
[01:00:54] <mcpherrin> strcat: wait, what?  Was the protest about referring to, say, libcollections as part of "the standard library" vs libstd?
[01:01:15] <mcpherrin> seems pointlessly picky
[01:01:15] <strcat> mcpherrin: they don't want to to call libstd the 'standard library' because rust doesn't have a standard
[01:01:29] <ChrisMorgan> That be drivel.
[01:01:29] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[01:01:32] <mcpherrin> strcat: Oh, I understand.  That's even more pointlessly pickey
[01:01:48] <eddyb> strcat: better than a standard written in Microsoft Word
[01:01:55] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[01:02:05] <eddyb> rust.doc: not even once
[01:02:07] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[01:02:20] *** Quits: tigrou3tac (fabien@moz-6E2397FF.fbx.proxad.net) (Ping timeout)
[01:02:41] <aatch> It is the standard library, all modern implementations of Rust have the same libraries available.
[01:02:42] <mcpherrin> eddyb: It could be worse, Corel Wordperfect
[01:02:42] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Ping timeout)
[01:03:01] <mcpherrin> which would be fitting as lawyers still like to use wordperfect for legal docs for some reason.
[01:03:03] <eddyb> aatch: then redbrain's gcc-rs isn't "modern"? :P
[01:03:06] <mcpherrin> also, french canadians.
[01:03:17] <aatch> eddyb, is it even "complete" :P
[01:03:20] *** Quits: sigma (sigma@C91C7F36.70518F41.9D18269F.IP) (Ping timeout)
[01:03:28] *** Quits: judder (maradukewa@A4DC519F.6379DA33.78E362FE.IP) (Ping timeout)
[01:03:31] <eddyb> aatch: partial forever
[01:03:38] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[01:03:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:04:17] <aatch> (don't get me wrong, props to redbrain for doing it, just that it's like including toy compilers when talking about C)
[01:04:41] <eddyb> aatch: I think he wanted to make binaries outputted by gcc-rs work with a rustc built libstd
[01:04:49] *** Quits: patpat (patpat@moz-1599AAE4.as13285.net) (Ping timeout)
[01:04:52] *** Quits: Jemaclus (Jemaclus@4EEAB704.5843BA5A.D4E4C7A5.IP) (Quit: Leaving...)
[01:05:22] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[01:05:27] <aatch> eddyb, that would be cool. Difficult, but cool.
[01:05:28] <strcat> writing another trans backend would be a much smaller project
[01:05:45] <eddyb> strcat: it's his (employer's) time
[01:06:07] <eddyb> people write ridiculous contraptions all the time
[01:06:16] *** Quits: lawrence (lawrence@moz-931A1591.wireless.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:06:34] <eddyb> I just hope someone considers a LLVM backend instead of a GCC frontend for embedded Rust
[01:07:14] <eddyb> since the LLVM backend can be reused by a lot of tools
[01:08:33] <eddyb> strcat: huon had an interesting idea, do all the checking using rustc and then gcc-rs can do simplified compilation to GCC's IR whatever
[01:08:53] <eddyb> if --pretty typed worked, you wouldn't even need inference
[01:09:10] *** jdm sets mode: -b KindOne!*@*
[01:09:10] <eddyb> but that's just a backend with an extraneous frontend =))
[01:09:22] <strcat> eddyb: or make it use libsyntax/librustc and save a lot of duplicate of work ;p
[01:09:28] <strcat> duplication*
[01:09:57] *** Quits: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net) (Ping timeout)
[01:09:58] <eddyb> I can see a random new contributor bind GCC in trans
[01:10:06] <eddyb> out of the blue
[01:10:57] <strcat> we're going to get more and more tied to LLVM though so meh
[01:11:01] <strcat> probably won't happen
[01:11:12] *** Joins: james4k (james@moz-9BB5AE72.consolidated.net)
[01:11:14] * strcat is happy with just an LLVM backend
[01:11:32] <eddyb> strcat: if only that avr port was better maintained :/
[01:11:37] <eddyb> who needs PICs, right :P?
[01:11:44] <strcat> used to be LLVM IR -> GCC IR
[01:11:56] <eddyb> what?
[01:12:38] *** Joins: kris (kris@moz-6D20263F.fullrate.dk)
[01:13:49] *** Quits: alkino (alkino@moz-53CAAA6D.w92-151.abo.wanadoo.fr) (Ping timeout)
[01:13:49] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[01:14:04] *** Joins: dougxxx (dougxxx@moz-2801788.perm.iinet.net.au)
[01:14:33] *** Joins: kngl (Adium@40AE2BF6.ABCDAFD6.7C797F8E.IP)
[01:14:48] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[01:15:11] *** Joins: lawrence (lawrence@moz-931A1591.wireless.utoronto.ca)
[01:15:18] *** YourBestFriend is now known as sam113101_afk
[01:16:02] *** sam113101_afk is now known as YourBestFriend
[01:17:26] *** Quits: lawrence (lawrence@moz-931A1591.wireless.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:20:04] *** Quits: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:21:56] *** Quits: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: azita)
[01:22:15] *** Joins: patpat (patpat@moz-1599AAE4.as13285.net)
[01:27:46] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[01:28:15] *** Joins: Savago (Savago@moz-679D1D3C.hsd1.ca.comcast.net)
[01:28:53] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[01:29:27] *** Joins: jmmk (jmmk@moz-588F65EA.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[01:30:50] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[01:31:14] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[01:32:16] <strcat> can macros expand to methods yet?
[01:32:48] <huon> no
[01:32:54] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[01:34:00] *** Joins: derek_c (derek@moz-F57DC3E8.cit.cornell.edu)
[01:34:09] *** Joins: ecr (chatzilla@6C565B0A.A19A88BC.64990CF8.IP)
[01:35:28] *** Quits: eibwen (kvirc@moz-7F98B089.dip0.t-ipconnect.de) (Ping timeout)
[01:36:18] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[01:37:58] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[01:39:59] *** Joins: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net)
[01:42:36] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:42:39] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Ping timeout)
[01:42:39] *** Joins: claudiu_ (claudiu@moz-7D1F0258.thefacebook.com)
[01:44:34] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:44:36] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Ping timeout)
[01:44:50] *** Quits: bmu (chatzilla@moz-A87574A6.hsd1.pa.comcast.net) (Ping timeout)
[01:47:05] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[01:48:32] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[01:49:56] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[01:50:21] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Ping timeout)
[01:50:28] *** Quits: ecr (chatzilla@6C565B0A.A19A88BC.64990CF8.IP) (Ping timeout)
[01:51:01] *** Quits: claudiu_ (claudiu@moz-7D1F0258.thefacebook.com) (Connection reset by peer)
[01:51:07] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[01:52:06] *** Joins: dman (user@moz-3CCCC137.nwrknj.fios.verizon.net)
[01:52:19] <dman> Is it possible to define new types at runtime in rust?
[01:53:20] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[01:53:28] <pyon> dman:  Rust is statically typed.
[01:53:49] <pyon> dman: Why exactly would you want to define new types at runtime?
[01:55:01] *** Quits: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it) (Ping timeout)
[01:55:02] *** Joins: pradeep (pradeep@5AB4884B.FCC4549.14D5B978.IP)
[01:55:21] *** Joins: Valloric (Valloric@moz-288722BA.hsd1.ca.comcast.net)
[01:56:21] <dman> I want to be able to compile user defined kernels at runtime in my program. The user might choose to bind one or more "columns" in their kernel. I would like to generate a new struct definition corresponding to the columns the user picked and then apply the kernel over a buffer of that newly defined composite type.
[01:56:32] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[01:56:55] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:57:17] <strcat> dman: rust doesn't have any runtime code generation
[01:57:24] <dman> ah I see
[01:57:49] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[01:57:51] <dman> the quest for an embeddable compiled language continues
[01:57:54] <strcat> it's also statically typed so there's no way you would be able to create a new type or even delay a type error to runtime
[01:58:13] <strcat> types are completely gone at runtime
[01:58:44] <dman> I am currently using c++ and using raw memory buffers which i pack manually
[01:59:00] <strcat> dman: LLVM has MCJIT which can do runtime code generation
[01:59:24] <dman> and was trying to explore if i could switch to some language that while being efficient would allow me to more naturally attack my use case
[01:59:28] <strcat> so in theory you could compile C/C++/Rust or other languages with LLVM frontends to bits of optimized code at runtime
[01:59:29] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[01:59:41] <strcat> but you'd need to link against LLVM and use the LLVM APIs
[01:59:53] <dman> ah - interesting
[01:59:54] <strcat> librustc may eventually provide MCJIT bindings but it doesn't atm
[02:00:02] <strcat> we'd need it for a REPL
[02:00:29] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[02:00:29] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Connection reset by peer)
[02:00:36] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[02:01:04] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Connection reset by peer)
[02:01:15] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[02:01:35] *** Joins: nozzle (Mibbit@1EB7F923.28BE7003.DDE5D3F6.IP)
[02:02:22] <dman> thanks for the pointer strcat - will look at mcjit
[02:02:51] *** Joins: quux00 (uid24415@moz-E77DEB21.irccloud.com)
[02:03:15] *** Joins: mib_6uugpi (Mibbit@moz-1BB03833.lnk.telstra.net)
[02:03:24] <nozzle> can anyone tell me more about the "cannot borrow immutable dereference of & pointer as mutable" error
[02:04:03] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[02:05:16] *** Quits: asmyers (quassel@moz-71754EDC.hsd1.md.comcast.net) (Ping timeout)
[02:05:32] <quux00> I'm reading some Rust-0.10 code (been in 0.9 so far) and I'm seeing the try! macro.  Can someone explain what that does?  I can't find any documentation on it (pointers to that would be great).
[02:07:22] *** Joins: asmyers (quassel@moz-71754EDC.hsd1.md.comcast.net)
[02:07:55] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[02:08:03] *** Joins: Erik_ (Erik_S@moz-6691E309.hlrn.qwest.net)
[02:08:29] *** Quits: oxum (anonymous@5B2B4DB0.BBE46712.520CDC98.IP) (Quit: Bye..)
[02:08:46] *** Joins: oxum (anonymous@5B2B4DB0.BBE46712.520CDC98.IP)
[02:08:51] *** Quits: oxum (anonymous@5B2B4DB0.BBE46712.520CDC98.IP) (Quit: ...)
[02:10:40] *** Quits: nrc (nrc@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 30.0a1/20140303030201])
[02:10:49] <nozzle> quux00 have you looked at this? (also has link to source code) http://static.rust-lang.org/doc/master/std/macros/macro.try.html
[02:11:00] *** Quits: jmmk (jmmk@moz-588F65EA.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Ping timeout)
[02:11:40] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[02:12:14] <ChrisMorgan> nozzle: given a &T, you cannot get a &mut T out of it.
[02:13:09] *** Joins: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca)
[02:13:14] *** Quits: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: dherman)
[02:13:25] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[02:13:48] *** Quits: pcwalton (pcwalton@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: pcwalton)
[02:13:59] *** Quits: brson (brson@4A08E125.708C0A12.C7EEF3A2.IP) (Ping timeout)
[02:14:27] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Input/output error)
[02:14:53] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[02:14:59] *** Joins: pongad (pongad@moz-7E8AAD2E.res.gatech.edu)
[02:16:06] *** Joins: jmmk (jmmk@moz-588F65EA.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[02:16:36] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[02:19:16] *** Quits: ryeguy (ryeguy@9C569A0.5D1143CD.E8644521.IP) (Quit: )
[02:20:20] *** Quits: bharadwaj (uid11995@moz-5F4AA75A.irccloud.com) (Quit: Connection closed for inactivity)
[02:22:50] *** Quits: luz (lu.cy@moz-CD18B14B.customer.cdi.no) (Connection reset by peer)
[02:23:04] *** Joins: luz (lu.cy@moz-CD18B14B.customer.cdi.no)
[02:23:20] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[02:23:53] <quux00> nozzle: thanks.
[02:23:56] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[02:24:03] *** Quits: asmyers (quassel@moz-71754EDC.hsd1.md.comcast.net) (Ping timeout)
[02:24:19] <quux00> So is try! is not related to try?  In other words, try! is not for spawning a new task.
[02:26:56] *** Quits: Sorella (queen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Quit: It is tiem!)
[02:28:07] <Eridius> quux00: correct
[02:28:26] <Eridius> just one reason I thought try!() was a confusing name, but there were no good alternatives that people liked
[02:29:27] <Havvy> do_or_do_not!()
[02:29:44] <quux00> OK.  I'll have to play with it.  I see that it's wrapping IoResult, but I"m not sure yet why it's useful.  Don't you still have to test the result value just as you would with IoResult directly?
[02:30:00] *** Quits: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net) (Ping timeout)
[02:30:26] *** Joins: sruggier (sruggier@moz-B9FB4CF4.cpe.pppoe.ca)
[02:30:27] *** Joins: p1start (rewi@moz-A082F561.adsl.xtra.co.nz)
[02:30:48] *** Quits: dapz (textual@moz-F958911.hsd1.ca.comcast.net) (Ping timeout)
[02:31:38] *** Joins: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net)
[02:31:55] <nozzle> ChrisMorgan: thanks I think that's leading me in the right direction
[02:33:08] <ChrisMorgan> quux00: it's the return that makes it useful. It means that if your thing returns Result<T, E> and you call something that returns Result<U, E>, you can immediately unwrap the result, return the error if it is in fact an error, by using `try!(call())`.
[02:33:23] <ChrisMorgan> quux00: for clarification, IoResult is Result<T, IoError>.
[02:34:23] *** Quits: echristo (echristo@3246441A.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[02:36:15] <dougxxx> Is a macro for that really the right fix?
[02:36:37] <dougxxx> Seems like its just working around the problems of using Result<> and Option<>
[02:36:46] <pongad> Is anyone else having issue with maketest lto_smoke?
[02:36:52] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[02:38:33] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[02:38:36] <pyon> e
[02:39:00] *** Quits: q66 (q66@moz-32555B.dab.02.net) (Quit: Leaving)
[02:39:32] *** Quits: pyon (Mibbit@6B56F365.A9B419CB.1C8C8CE9.IP) (Quit: brb)
[02:39:35] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[02:40:57] *** Quits: leowoe (Leo@moz-CBB8D564.dip0.t-ipconnect.de) (Ping timeout)
[02:41:09] *** Quits: derek_c (derek@moz-F57DC3E8.cit.cornell.edu) (Ping timeout)
[02:41:22] *** Joins: leowoe (Leo@moz-A5AF6850.dip0.t-ipconnect.de)
[02:42:04] *** Joins: derek_c (derek@moz-F57DC3E8.cit.cornell.edu)
[02:42:37] *** Joins: pyon (user@6B56F365.A9B419CB.1C8C8CE9.IP)
[02:43:57] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[02:43:57] *** Joins: bollu (bollu@31CCE710.7065DDB9.6D6A344F.IP)
[02:44:29] *** Joins: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net)
[02:44:43] *** Quits: nimish (quassel@6CD90D4F.B586C2A4.5F29FBA5.IP) (Connection reset by peer)
[02:44:43] *** Joins: nimish (quassel@6CD90D4F.B586C2A4.5F29FBA5.IP)
[02:44:59] <bollu> Question: can  the strings returned by string.split(' ').collect() (which returns ~[&str]) be stored for as long as I want? 
[02:45:19] <bollu> I think I can, since & is "borrowed" and I can keep it borrowed as long as I want
[02:45:23] <bollu> but... I'm not sure
[02:45:28] *** Quits: jmmk (jmmk@moz-588F65EA.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Ping timeout)
[02:45:44] *** Quits: kris (kris@moz-6D20263F.fullrate.dk) (Ping timeout)
[02:46:06] <strcat> bollu: they have a lifetime
[02:46:09] <dougxxx> If you use an explicit lifetime you don't have to guess I suppose. 
[02:46:11] <strcat> they can't outlive what they point at
[02:46:13] <dougxxx> fn v1<'a> (a:~[&'a str]) -> ~[&'a str] {
[02:46:13] <dougxxx>   return a;
[02:46:13] <dougxxx> }
[02:46:22] <dougxxx>  let x = v1("Hello World".split(' ').collect());
[02:46:36] <dougxxx> You could use a specific lifetime instead if you wanted
[02:46:39] <strcat> dougxxx: that doesn't change it
[02:46:52] <strcat> 'a is only in scope for the function v1, the lifetime is the same
[02:46:52] <bollu> dougxxx: they're generated while parsing, I don't store them forever
[02:46:56] <dougxxx> If you use the lifetime from a containing struct wouldn't it?
[02:47:17] <bollu> although I *do* want to store a string type "forever"
[02:47:17] <strcat> dougxxx: it already has the longest possible lifetime inferred
[02:47:37] <bollu> can I create a ~str from an &str? (stupid question maybe)
[02:47:44] <strcat> bollu: yes, to_owned
[02:47:48] <bollu> ty
[02:47:52] <strcat> it allocates and copies it
[02:48:05] <bollu> strcat: yeah, that was what I knew as well - that it figures out the longest lifetime possible
[02:48:31] <bollu> also, why does str.split() return &str ? wouldn't it be easier if it returned ~str ?
[02:48:59] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[02:49:27] <strcat> bollu: because that would be inefficient
[02:49:32] <strcat> most of the time, you can use &str
[02:49:46] *** Quits: derek_c (derek@moz-F57DC3E8.cit.cornell.edu) (Ping timeout)
[02:49:54] <strcat> it returns an iterator of slices because it doesn't require any allocation/copies
[02:50:06] *** Quits: astroch (astroch@moz-538474D8.itc.virginia.edu) (Ping timeout)
[02:50:13] <dougxxx> strcat: hm, maybe my understanding of lifetimes is still hazy. If you have an impl<'a> ... { pub fn blah<'a> ... the lifespan is from the struct right? Not the function?
[02:50:17] <bollu> strcat: ah, makes perfect sense
[02:50:46] <bollu> strcat: if I'm storing those slices in a struct, I have to convert those &str into ~str right?
[02:50:53] <strcat> bollu: not necessarily
[02:51:05] <bollu> strcat: okay, so when should I do what? :)
[02:51:11] <strcat> bollu: if the compiler can see that the struct doesn't outlive what these point out, you can store them in it
[02:51:35] <strcat> dougxxx: that's not really correct
[02:51:38] <bollu> strcat: but it's "neater" to copy them? or not?
[02:51:48] <strcat> bollu: it's nicer to not copy them
[02:51:50] *** Quits: leowoe (Leo@moz-A5AF6850.dip0.t-ipconnect.de) (Quit: Leaving.)
[02:51:55] <dougxxx> What does <'a> on an impl mean then?
[02:51:58] <strcat> but it would be easier in many cases to copy them
[02:52:10] <strcat> dougxxx: <'a> in an impl/struct/function doesn't mean anything alone
[02:52:13] <strcat> it brings a lifetime into scope
[02:52:19] <strcat> called 'a
[02:52:41] <dougxxx> yes, but if you have a' used in multiple places its the *same* lifetime isn't it?
[02:52:45] <strcat> dougxxx: no
[02:52:49] <dougxxx> wat
[02:52:57] <dougxxx> That makes no sense.
[02:52:59] <strcat> dougxxx: it is scoped
[02:53:25] <strcat> it works exactly like a type parameter
[02:53:42] <strcat> fn foo<'a>() {} only declares 'a for the scope of the function `foo`
[02:54:05] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[02:54:08] <dougxxx> yes, but what does struct Blah<'a> { ... } do then?
[02:54:21] <dougxxx> If the a' isn't related to the a' in the function implementations
[02:54:21] <strcat> declares a lifetime called 'a for the scope of that struct
[02:54:25] <strcat> it doesn't do anything alone
[02:54:48] <strcat> dougxxx: it works like fn foo<TypeParam>() {} and struct Foo<TypeParam> {}
[02:54:56] <strcat> there's no connection between that function foo and struct Foo
[02:55:14] <strcat> it's just like giving a parameter the same name as a field in the struct
[02:55:32] *** Quits: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net) (Connection reset by peer)
[02:55:44] *** Joins: Ralith (ralith@moz-67D4EB93.customer.broadstripe.net)
[02:55:47] *** Quits: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it) (Ping timeout)
[02:55:55] <bollu> if I have an Enum of basic types, how do I print it? 
[02:56:10] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[02:56:15] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[02:56:26] <strcat> bollu: #[deriving(Show)] enum { ... } and then you can print it with the default formatter
[02:56:33] <strcat> at least I think deriving works for enums ;p
[02:56:36] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:56:53] <bollu> umm.. a concrete example? :)
[02:57:24] <bollu> nvm, found it in the docs
[02:57:45] <strcat> rusti: #[deriving(Eq, Show)] struct Foo(u32, u32); let x = Foo(2, 3); let y = Foo(5, 10); println!("{} {}", x == y, x)
[02:57:45] -rusti- false Foo(2, 3)
[02:57:46] -rusti- ()
[02:57:53] <bollu> ty
[02:57:56] <strcat> it makes an impl of Show for you
[02:58:05] <strcat> you could also do it by hand if you don't want the derived version
[02:58:28] *** Joins: ryeguy (ryeguy@9C569A0.5D1143CD.E8644521.IP)
[02:58:32] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[02:58:59] *** Quits: p1start (rewi@moz-A082F561.adsl.xtra.co.nz) (Ping timeout)
[03:00:10] *** Joins: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net)
[03:00:14] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[03:00:20] *** Quits: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net) (Quit: )
[03:01:04] <bollu> okay, length of an array in rust? :)
[03:01:50] <mcpherrin> rusti: ["a","b"].length()
[03:01:51] -rusti- <anon>:10:9: 10:27 error: type `[&'static str, .. 2]` does not implement any method in scope named `length`
[03:01:51] -rusti- <anon>:10         ["a","b"].length()
[03:01:51] -rusti-                   ^~~~~~~~~~~~~~~~~~
[03:01:51] -rusti- error: aborting due to previous error
[03:01:51] -rusti- application terminated with error code 101
[03:01:52] <rweir> what would you guess it would be?
[03:01:57] <mcpherrin> rusti: ["a","b"].len()
[03:01:59] -rusti- 2u
[03:02:07] <mcpherrin> ooops :)
[03:02:16] <bollu> lol thanks :)
[03:02:20] <bollu> I tried length() too
[03:02:38] <mcpherrin> it's .length() in the (non-rust) codebase I'm working on :P
[03:03:15] <bollu> and, where 
[03:03:19] <bollu> :)
[03:03:21] <bollu> nvm
[03:03:38] *** Joins: untwisted (untwisted@moz-60D579DC.hsd1.ca.comcast.net)
[03:03:52] <bollu> how do I skip a loop iteration in rust?
[03:04:19] <sfackler> bollu: continue
[03:05:27] <bollu> thanks! I'll have to file a bug report, Sublime Text's syntax highlighter didn't show continue as a keyword. so I was confused
[03:05:53] <sfackler> sublime's rust package is super out of date
[03:06:03] <sfackler> it's also not part of the main rust project fyi
[03:06:45] <bollu> oh, didn't know that. thanks for the info!
[03:07:03] <bollu> sfackler: any idea if they'd accept a pull request?
[03:07:40] *** Quits: kanru (kanru@moz-99690620.hinet-ip.hinet.net) (Ping timeout)
[03:09:10] <bollu> thanks a lot everyone, settings is finally workingy!
[03:09:33] <sfackler> no idea, might as well try, or fork the thing
[03:10:19] <bollu> sfackler: thanks. will look into it 
[03:10:45] <bollu> sfackler: can I disable logging of one module indivisually?
[03:10:50] *** jorendorff_away is now known as jorendorff
[03:12:04] *** Joins: ercxx (ercan@moz-88DD3A7E.dyn.optonline.net)
[03:13:18] <sfackler> bollu: I think RUST_LOG=debug,some::module=error should do it
[03:13:23] *** Joins: derek_c (derek@moz-DA4FB9D2.cit.cornell.edu)
[03:13:37] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[03:14:06] *** Quits: enos (jkingyens@moz-F6D5BB14.mycingular.net) (Ping timeout)
[03:14:38] *** Quits: james4k (james@moz-9BB5AE72.consolidated.net) (Ping timeout)
[03:16:34] *** Joins: onelson_ (owen@18CF7301.95770028.5B6BFE7D.IP)
[03:16:47] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:17:03] <bollu> sfackler: those are enviorment variables correct?
[03:18:08] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[03:18:13] *** Joins: oxum (anonymous@E0F72687.FE7DDF00.520CDC98.IP)
[03:19:24] *** Joins: sproing (Mibbit@moz-81E95E89.unassigned.ntelos.net)
[03:19:53] <sfackler> RUST_LOG is, yeah
[03:20:48] <sproing> in the library of functions, whats does an apostrophe mean when written next to a variable in a type definition? ex: fn chars<'r>(&'r mut self) -> Chars<'r, Self>
[03:20:52] *** Quits: cajbir (farv@moz-EC11DA4D.members.linode.com) (Ping timeout)
[03:21:33] <ChrisMorgan> bollu: `loop` used to be used instead of `continue`
[03:21:42] <cmr> sproing: it is a named lifetime
[03:21:47] <ryeguy> sproing: http://static.rust-lang.org/doc/master/guide-lifetimes.html#named-lifetimes
[03:22:02] <ryeguy> might want to start with the tutorial first if you havent read that yet
[03:22:12] *** Quits: Peng (mnordhoff@moz-D5175E95.mattnordhoff.net) (Ping timeout)
[03:23:13] *** Joins: enos (jkingyens@moz-F6D5BB14.mycingular.net)
[03:23:22] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[03:23:56] <ryeguy> is there a way to disable the feature that causes println!() to be discarded during passing tests?
[03:24:42] *** Quits: josh (josh@moz-244364B2.cable.virginm.net) (Quit: josh)
[03:25:22] *** Quits: zmike (discomfito@moz-975BC507.hsd1.ct.comcast.net) (Quit: ah. I see.)
[03:26:04] *** Joins: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net)
[03:26:05] *** Quits: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP) (Quit: ziad)
[03:26:06] *** Quits: sproing (Mibbit@moz-81E95E89.unassigned.ntelos.net) (Quit: http://www.mibbit.com ajax IRC Client)
[03:28:17] *** Joins: zmike (discomfito@moz-975BC507.hsd1.ct.comcast.net)
[03:29:58] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[03:30:04] *** Quits: sk (sk@35CFDE22.E993C7C3.78DD174B.IP) (Input/output error)
[03:30:09] *** Quits: dman (user@moz-3CCCC137.nwrknj.fios.verizon.net) (Client exited)
[03:30:30] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Quit: Leaving...)
[03:30:36] *** Joins: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net)
[03:30:47] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[03:31:03] *** Quits: Tuba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[03:31:31] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Input/output error)
[03:31:56] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[03:34:09] <pongad> I am having a little difficulty compiling from master, apparently make check doesn't like `lto_smoke`. Is anyone having this issue?
[03:34:16] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[03:34:23] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[03:34:23] *** Quits: Savago (Savago@moz-679D1D3C.hsd1.ca.comcast.net) (Quit: Savago)
[03:35:04] <pongad> It complains about there being two `rust_swap_registers`s
[03:35:20] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[03:35:25] *** Joins: jmmk (jmmk@moz-588F65EA.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com)
[03:35:35] *** Joins: willingc (willingc@moz-26EF7B5B.sd.sd.cox.net)
[03:36:09] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[03:37:03] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[03:39:49] *** Quits: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net) (Quit: stevegury)
[03:40:00] *** Joins: josh (josh@moz-244364B2.cable.virginm.net)
[03:41:39] <bollu> does 
[03:42:20] *** Quits: willingc (willingc@moz-26EF7B5B.sd.sd.cox.net) (Client exited)
[03:42:20] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[03:42:22] *** Quits: josh (josh@moz-244364B2.cable.virginm.net) (Quit: josh)
[03:42:28] <sfackler> pongad: I run into that every once in a while as well. I'm not totally sure what's going on with it
[03:42:33] <sfackler> acrichto: ^ ?
[03:42:37] *** Quits: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net) (Quit: )
[03:42:40] *** Joins: willingc (willingc@moz-26EF7B5B.sd.sd.cox.net)
[03:43:16] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:43:31] <pongad> sfackler: I think it might be make clean? Did that just now and trying again
[03:43:50] *** Joins: shmoo (Mibbit@FC9E3A07.67684BE1.DDE5D3F6.IP)
[03:44:22] *** Quits: willingc (willingc@moz-26EF7B5B.sd.sd.cox.net) (Ping timeout)
[03:44:52] *** Joins: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net)
[03:44:53] *** Joins: capt_redbeard (Adium@moz-4998C3D0.ok.ok.cox.net)
[03:45:22] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:45:26] <bollu> if I have 2 files - a.rs and b.rs, how do I include the contents of b.rs into a.rs WITHOUT creating a module in b.rs ?
[03:45:36] *** Quits: sruggier (sruggier@moz-B9FB4CF4.cpe.pppoe.ca) (Ping timeout)
[03:45:37] <capt_redbeard> I'm learning the generics and traits system im rust. I keep getting this error: src/main.rs:29:18: 29:28 error: attempted access of field `text` on type `&T`, but no field with that name was found
[03:45:37] <capt_redbeard> src/main.rs:29   println!("{}", state.text);
[03:45:39] <capt_redbeard> any ideas?
[03:46:07] <cmr> capt_redbeard: need more code to tell for sure.
[03:46:18] <cmr> bollu: `mod b;` does not create a module in b.rs
[03:46:23] <cmr> bollu: (in a.rs, that is)
[03:46:26] <capt_redbeard> cmr: i'll get a gist up
[03:46:33] <bollu> thanks! lemme try
[03:46:43] <bollu> thanks! lemme try
[03:47:00] <bollu> yeah, that worked @cmr :) ty
[03:47:16] <capt_redbeard> cmr: https://gist.github.com/kylecook80/9360794
[03:47:38] *** Joins: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net)
[03:47:45] <cmr> capt_redbeard: you can't access fields on generics.
[03:47:55] <cmr> capt_redbeard: the only information you have about them is that the implement the traits you list.
[03:48:13] <cmr> it's not like a C++ template where you can do whatever and it will just be a compile failure.
[03:48:24] <pongad> Rust's generics is more Javaey and less C++cy
[03:48:31] <cmr> (also, you don't need to say `-> ()` on main, it's implicit)
[03:48:40] <cmr> (can just say `fn main() { ... }`)
[03:48:52] *** Quits: comex (comex@moz-2484CD28.compute-1.amazonaws.com) (Ping timeout)
[03:48:57] <capt_redbeard> Ok, I see. So if I added a method called text() that access the field for me, would that work?
[03:49:02] <cmr> yup.
[03:49:04] <capt_redbeard> and thanks for the tip on that return
[03:49:08] <capt_redbeard> cmr: ok sweet thank you
[03:49:17] <cmr> it would probably look like:
[03:49:33] <cmr> `fn text<'a>(&'a self) -> &'a str { self.text.as_slice() }`
[03:49:42] <cmr> so as to avoid extra allocations.
[03:50:11] *** Quits: untwisted (untwisted@moz-60D579DC.hsd1.ca.comcast.net) (Ping timeout)
[03:50:15] <bollu> is this code in a rust kind of style? I have a feeling I'm using it way too much like C++ >_< https://github.com/bollu/equniox/blob/master/src/Init/mod.rs
[03:50:25] <bollu> and yes, the repo name is a typo :)
[03:50:32] *** Joins: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net)
[03:50:44] <capt_redbeard> cmr: OK thanks for the code bit. I'll look into the as_slice() method as I am not familiar with it.
[03:51:32] <cmr> bollu: https://github.com/mozilla/rust/wiki/Note-style-guide is the style guide.
[03:51:44] <cmr> note that where you have stuff like
[03:51:46] <cmr>  let value = from_str::<int>(valueStr).unwrap();
[03:51:48] <cmr> return Int(value);
[03:51:58] <cmr> can just be `Int(from_str(value_str).unwrap())`
[03:52:06] *** Joins: Peng (mnordhoff@moz-D5175E95.mattnordhoff.net)
[03:52:13] *** Quits: shmoo (Mibbit@FC9E3A07.67684BE1.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:52:14] <bollu> @cmr: hmm, okay. 
[03:52:19] *** Quits: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP) (Client exited)
[03:53:37] *** Joins: cajbir (farv@moz-EC11DA4D.members.linode.com)
[03:54:24] <nozzle> anyone know what Bus error: 10 means? 
[03:54:30] *** Joins: willingc (willingc@moz-26EF7B5B.sd.sd.cox.net)
[03:54:44] <cmr> nozzle: usually means same thing as a segmentation fault, or unaligned access.
[03:54:49] *** Joins: comex (comex@moz-2484CD28.compute-1.amazonaws.com)
[03:54:50] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[03:55:29] <bollu> this is going to sound stupid, but why spaces over tabs? 
[03:55:48] <cmr> bollu: there's no very good technical reason for it...
[03:55:55] <cmr> it's just one of those things that people fight over
[03:56:03] <sp3d> you can hit space with either hand so it's faster than having to block on the left hand becoming idle to hit tab
[03:56:11] *** Quits: willingc (willingc@moz-26EF7B5B.sd.sd.cox.net) (Ping timeout)
[03:56:26] *** Quits: zz_kimundi (kimundi@moz-82D1D1B3.dip0.t-ipconnect.de) (Ping timeout)
[03:56:31] *** Quits: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it) (Ping timeout)
[03:57:05] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[03:57:31] *** Quits: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net) (Ping timeout)
[03:57:39] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[03:57:50] <nozzle> cmr: thanks for info. Would it be right to assume it has to do something with my implementation, or is it a bug I should be reporting?
[03:58:06] <cmr> nozzle: are you using any unsafe code?
[03:58:11] *** Joins: willingc (willingc@moz-26EF7B5B.sd.sd.cox.net)
[03:58:29] *** Joins: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net)
[03:58:35] <capt_redbeard> cmr: Ok so how would I access methods that aren't implemented on a trait but on that struct itself? signature is: fn set_game_state<T: GameState>(state: T)
[03:59:05] <bollu> capt_redbeard: you're building a game? is your code public? I'd love to see!
[03:59:13] <cmr> capt_redbeard: you still can't do that :( the method needs to be part of the trait the you are bounding the type parameter by (the ": GameState" in "T: GameState")
[03:59:16] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[03:59:41] *** Joins: zz_kimundi (kimundi@moz-A54DBA56.dip0.t-ipconnect.de)
[03:59:52] <nozzle> cmr: actually yes. I'm using it for a MutexArc since I couldn't store a LruCache within a RWArc without some issues
[03:59:56] <capt_redbeard> cmd: D: Oh man, ok.
[03:59:58] *** zz_kimundi is now known as kimundi
[04:00:24] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:00:26] <capt_redbeard> bollu: Well, it's just an experiment. It is actually for me game development course at my university. But I'll be more than happy to put it up on Github! It is pretty much a mess xD
[04:00:42] <cmr> nozzle: then it's probably your fault.
[04:00:56] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[04:00:56] <cmr> nozzle: OS X?
[04:00:59] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[04:01:06] <cmr> I don't know the exact set of conditions that can lead to a Bus Error.
[04:01:12] <nozzle> cmr: I'm actually quite glad to hear that. And yes, is that an issue?
[04:01:12] <bollu> capt_redbeard: thanks! I like reading engine code :) 
[04:01:17] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Input/output error)
[04:01:37] <cmr> nozzle: not an issue, it's just where I usually see that Bus Error.
[04:01:42] *** Joins: sruggier (sruggier@moz-B9FB4CF4.cpe.pppoe.ca)
[04:01:48] <cmr> bollu: you would probably enjoy #rust-gamedev :)
[04:01:57] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[04:02:14] <bollu> @cmr: yeah, kimundi pointed me there! I want to get a hang of /rust/ first. 
[04:05:11] <ChrisMorgan> Would someone else like to answer http://stackoverflow.com/questions/22188088/what-does-a-scoped-lifetime-in-rust-actually-mean? I suspect that I won't do the best job of explaining it.
[04:05:24] <capt_redbeard> bollu: I had the same attitude first, but I found out that theres really no better way to learn rust than to do what you like. I have found it quite an awesome experience learning Rust while programming a game engine.
[04:06:36] <aatch> ChrisMorgan, given that I plan on giving a talk about lifetimes, I'll give it go.
[04:06:44] <ChrisMorgan> Good!
[04:07:08] <cmr> aatch: one question I've had a few people ask me is "what *is* a lifetime though?"
[04:07:12] *** Quits: nfroidure (nfroidure@moz-65B09039.w90-18.abo.wanadoo.fr) (Ping timeout)
[04:07:15] <cmr> Like, they think it's some sort of object or other.
[04:07:23] <cmr> or even a sort of class
[04:07:30] <aatch> cmr, pretty much the first half of my talk is about that.
[04:07:31] <cmr> So I think this might be a shortcoming of our docs.
[04:07:39] <cmr> they don't explain that it's purely used to drive static safety analysis
[04:07:40] *** Joins: josh (josh@moz-244364B2.cable.virginm.net)
[04:07:59] <aatch> Agreed, it's not a complex idea, just new and poorly explained
[04:08:24] <capt_redbeard> cmr: aatch: When I was first learning lifetimes, I had the same trouble. I found the docs lacking (especially since they aren't in the main tutorial). It just mentions the ' syntax in passing without giving good examples imo.
[04:08:33] <cmr> it probably has the lowest docs to complexity ratio of anything in rust.
[04:08:39] <cmr> capt_redbeard: agree.
[04:08:42] <aatch> capt_redbeard, I know.
[04:08:42] <cmr> I did too.
[04:09:22] <aatch> The manual doesn't actually mention the lifetime syntax anywhere, despite using a `lifetime` production in the syntax defintions later
[04:10:20] *** Quits: nszceta (hax@moz-E6CA8D6.hsd1.pa.comcast.net) (Input/output error)
[04:12:22] <cmr> does it mention their semantics at all?
[04:12:50] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[04:13:14] *** Quits: willingc (willingc@moz-26EF7B5B.sd.sd.cox.net) (Client exited)
[04:13:24] <mib_6uugpi> Has any development started on a new package manager since rustpkg was ditched?
[04:13:45] <cmr> mib_6uugpi: I have https://github.com/cmr/cargo-lite but it's not intended to be official.
[04:14:40] <nozzle> so my code now compiles without the use of an unsafe block, but now I'm getting this error
[04:14:48] <nozzle> task '<unnamed>' failed at 'assertion failed: `(left == right) && (right == left)` (left: `22i32`, right: `0i32`)'
[04:14:53] <nozzle> You've met with a terrible fate, haven't you?
[04:15:00] <nozzle> fatal runtime error: Could not unwind stack, error = 5 Abort trap: 6
[04:15:00] *** Quits: jmmk (jmmk@moz-588F65EA.c3-0.smr-ubr1.sbo-smr.ma.cable.rcn.com) (Ping timeout)
[04:15:11] <cmr> nozzle: oh yikes, that's bad.
[04:15:19] <cmr> nozzle: *now* you can open an issue ;)
[04:15:20] <mib_6uugpi> ah nice. But nothing has started on the 'official' package manager? Will there one?
[04:15:27] <nozzle> oh boi
[04:15:46] *** Joins: bakkdoor (bakkdoor@moz-3329154D.osnanet.de)
[04:15:48] <nozzle> cmr: thanks for the guidance
[04:15:51] <cmr> mib_6uugpi: nothing has been anounced. brson has stated that they're going to contract someone with domain expertise to work on the official package manager.
[04:16:28] <mib_6uugpi> oh ok. good idea. Thanks
[04:16:44] <capt_redbeard> bollu: Ok so here it is. https://github.com/kylecook80/RustGameEngine It currently doesn't compile and doesn't actually do anything! But keep an eye on it as it'll start to grow over the next few days.
[04:16:55] *** Joins: p1start (rewi@moz-A082F561.adsl.xtra.co.nz)
[04:17:00] <cmr> capt_redbeard: awesome, good lucks!
[04:17:02] <cmr> *luck
[04:17:14] <cmr> I too am working on a game, for a computer graphics course.
[04:17:28] <cmr> currently getting https://github.com/cmr/hgl-rs up to snuff.
[04:17:57] <capt_redbeard> cmr: Thank you! The professor teaches the game programming course in java (BLECK) so I decided to do ruby first, and now transition to rust.
[04:18:11] <capt_redbeard> Ohh! I'll keep an eye on hgl-rs!
[04:18:32] *** Joins: jroweboy (Mibbit@moz-18814A6B.provo.static.broadweavenetworks.net)
[04:19:34] *** Quits: nozzle (Mibbit@1EB7F923.28BE7003.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:19:51] *** Joins: mzewuiorc (raymondvar@moz-434DF81C.hsd1.va.comcast.net)
[04:22:43] <ChrisMorgan> Every time I see "hgl-rs" I think Mercurial.
[04:23:12] *** Quits: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net) (Quit: Sharp)
[04:23:21] *** Joins: bmu (chatzilla@moz-A87574A6.hsd1.pa.comcast.net)
[04:24:40] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[04:24:58] *** Quits: WebeWizard (WebeWizard@moz-7CCD1DAE.ks.ks.cox.net) (Client exited)
[04:26:22] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[04:26:24] *** Quits: bakkdoor (bakkdoor@moz-3329154D.osnanet.de) (Quit: Leaving...)
[04:30:12] *** Joins: panitaliemom (Mibbit@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[04:30:20] *** Quits: panitaliemom (Mibbit@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: http://www.mibbit.com ajax IRC Client)
[04:30:27] *** Joins: mib_nogvnn (Mibbit@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[04:30:54] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Connection reset by peer)
[04:30:57] <jroweboy> ChrisMorgan: Hey! I'm trying to update rust-http to the latest master, and in the test-suite, you have functions like assert_invalid that are causing "failed to find an implementation of trait std::fmt::Show for T" errors. Any advice on how to fix these?
[04:31:04] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[04:31:24] <ChrisMorgan> jroweboy: I was just in the process of updating them a while ago!
[04:31:36] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:31:41] <mib_nogvnn> Are the instructions at https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust still valid for building rust?
[04:32:04] <mib_nogvnn> valid for building rust on Windows that is
[04:32:18] <cmr> mib_nogvnn: they should be.
[04:32:19] <ChrisMorgan> jroweboy: it's occurring because assert_eq! is now using {} rather than {:?}, so types must implement std::fmt::Show.
[04:32:20] *** Joins: Blub\1 (wry@620605B3.71150E1A.237AE2BA.IP)
[04:32:27] *** Quits: Blub\0 (wry@620605B3.71150E1A.237AE2BA.IP) (Ping timeout)
[04:32:40] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:32:47] <ChrisMorgan> jroweboy: and [T, ..N] cannot do that
[04:32:49] <klutzy> mib_nogvnn: I think so
[04:33:05] <mib_nogvnn> I'm getting a few errors when trying to build libuv. the first: c:\mingw\include\mswsock.h:125:20: error: 'WSAPOLLFD' was not declared in this scope
[04:34:00] <klutzy> mib_nogvnn: what version of gcc do you use? (gcc --version)
[04:34:24] <mib_nogvnn> 4.8.1
[04:34:29] *** Joins: nszceta (hax@moz-E6CA8D6.hsd1.pa.comcast.net)
[04:35:13] <pongad> nmatsakis: Does `Arc` not use Atomic already?
[04:35:23] <mib_nogvnn> is that too new?
[04:35:30] <klutzy> mib_nogvnn: it's known issue of mingw but it should not occur since we locally solve it
[04:35:34] <klutzy> hmm
[04:35:53] <jroweboy> ChrisMorgan: Ah, I was wondering what the root cause of that was. Any idea on how long it will take to refactor the code then? I need to get my code compiling that relies on rust-http soonish :) Thanks for letting me know what the issue is!
[04:35:59] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[04:36:22] <jroweboy> I mean, if you won't be fixing it for a while, I'll need to hack away at it and get it updated either way
[04:36:22] <ChrisMorgan> jroweboy: it was just a matter of changing [T, ..N] to ~[T] or &[T].
[04:36:24] <mib_nogvnn> hrm, I may have accidentally been building a very old version of rust
[04:36:28] <cmr> pongad: it does, why?
[04:36:48] <mib_nogvnn> hrm, nevermind. that's not it. I just made sure I'm building master
[04:36:49] *** Parts: mzewuiorc (raymondvar@moz-434DF81C.hsd1.va.comcast.net) ()
[04:36:57] *** jorendorff is now known as jorendorff_away
[04:37:08] <jroweboy> Andddd you've already pushed haven't you ;) Thanks a bunch for the changes!
[04:37:31] <pongad> cmr: #12625 proposes using `Atomic` for `Arc`.
[04:37:47] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[04:37:47] *** Quits: enos (jkingyens@moz-F6D5BB14.mycingular.net) (Connection reset by peer)
[04:38:13] <cmr> pongad: ah, different atomic type.
[04:38:24] <pongad> cmr: Oh?
[04:38:24] <klutzy> mib_nogvnn: in short, one of recent mingw header uses WSAPOLLFD, but they forgot to define it
[04:38:35] <klutzy> mib_nogvnn: so we locally defined to workaround: https://github.com/mozilla/rust/blob/03c5342419fe49d060f2ea26f77ae3e716945a90/src/etc/mingw-fix-include/winsock2.h
[04:39:00] <klutzy> but it seems that it doesn't work with your build..
[04:39:31] <pongad> cmr: Has it landed? I don't see in the docs
[04:39:32] <cmr> pongad: yeah, I'm pretty it's thinking of a mysterious Atomic<T> type... would have to ask nmatsakis specifically.
[04:39:37] <cmr> pongad: no.
[04:39:45] *** jorendorff_away is now known as jorendorff
[04:39:52] <sfackler> aaaack
[04:39:56] <pongad> cmr: Gotcha
[04:39:59] <pongad> cmr: Thanks :D
[04:40:07] <sfackler> I just spent an hour trying to track down a bug that turned out to be an =- instead of a -=
[04:40:14] <cmr> pongad: if you want something to do I'd recommend a different issue for now :)
[04:40:15] <ChrisMorgan> jroweboy: yeah, it took three attempts to get it right, as I haven't rebuilt Rust yet.
[04:40:17] <cmr> sfackler: ouch!
[04:40:23] *** jorendorff is now known as jorendorff_away
[04:40:28] <klutzy> mib_nogvnn: could you check the result of `grep __MINGW_MAJOR_VERSION /mingw/include/_mingw.h`? it should show #define <var> 4
[04:41:03] <pongad> cmr: I'm running a test on making `Rc` use `Cell` right now. I guess I can stop there for the time being.
[04:41:10] <cmr> jjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjjj
[04:41:12] <cmr> eugh
[04:41:19] <cmr> I hate it when I do that :(
[04:41:23] <cmr> ohhhhh I just figured it out
[04:41:26] <pongad> cmr: Or send a PR only on the first part then come back later
[04:41:28] <cmr> ctrl-j = enter
[04:41:33] <cmr> pongad: sounds good
[04:41:43] <pongad> cmr: Alright!
[04:42:16] <pongad> cmr: Actually, before submitting a PR is it necessary to do full make check? Or does NO_BENCH work ok?
[04:42:35] <cmr> pongad: NO_BENCH is fine
[04:42:44] <cmr> ... usually ;p
[04:42:54] <cmr> it's better to a a full make check, but I know I don't always do that...
[04:43:05] <pongad> :P
[04:43:15] *** Quits: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net) (Quit: )
[04:43:27] <pongad> We'll just need to make rustc faster then no one will mind :D
[04:43:45] *** Quits: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net) (Quit: stevegury)
[04:45:36] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[04:45:41] <pongad> The Freeze trait is being removed right?
[04:45:54] *** Joins: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net)
[04:45:57] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:46:14] <aatch> Hmm, I'm not completely happy with my answer but I don't think I have enough time to work on it for several days.
[04:46:48] *** Joins: rohanpm (quassel@9A927BA5.89CBB463.4206AA37.IP)
[04:47:04] <cmr> pongad: unknown.
[04:47:06] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[04:47:08] *** Quits: nszceta (hax@moz-E6CA8D6.hsd1.pa.comcast.net) (Input/output error)
[04:47:09] <cmr> pongad: or, rather, undecided.
[04:47:35] <aatch> Also, re-reading his question, I think people have been lying to him. Or at least been overly-pedantic.
[04:47:39] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[04:47:48] <cmr> dougxxx: ^
[04:47:59] *** Quits: josh (josh@moz-244364B2.cable.virginm.net) (Quit: josh)
[04:48:04] <pongad> cmr: Alright. After changing Rc to use `Cell`. SOme tests fail on stuffs not implementing Freeze
[04:48:11] <dougxxx> hm?
[04:48:20] <cmr> dougxxx: you asked that question on stackoverflow right?
[04:48:33] <cmr> http://stackoverflow.com/questions/22188088/what-does-a-scoped-lifetime-in-rust-actually-mean?
[04:48:37] <pongad> cmr: I'm not sure where it came come, since `Rc` doesn't ask for types to implement Freeze right?
[04:48:45] <dougxxx> ah, I asked two, one about liofetimes and the other about result
[04:48:45] <dougxxx> yep
[04:48:51] <cmr> pongad: I honestly do not know.
[04:49:03] <cmr> pongad: afraid I don't know lots of details about Rc etc :(
[04:49:10] *** Quits: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[04:49:22] <pongad> cmr: Will take your advice and work on other things for the time being :D
[04:49:24] <mib_nogvnn> klutzy: yup, I'm getting: grep __MINGW_MAJOR_VERSION /mingw/include/_mingw.h
[04:49:57] <mib_nogvnn> hrm, this is unfortunate. building on Linux is soo easy!
[04:50:08] <klutzy> blame mingw! :p
[04:50:15] <mib_nogvnn> I will
[04:50:32] <mib_nogvnn> so, what I'm trying to do is make sure that my PR builds on Windows
[04:50:40] <mib_nogvnn> since its failed a few times
[04:51:06] <mib_nogvnn> would I be able to ask someone to run a @try build for me?
[04:51:11] *** Joins: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net)
[04:51:14] <cmr> mib_nogvnn: sure, which PR?
[04:51:47] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:52:19] <mib_nogvnn> https://github.com/mozilla/rust/pull/12300 - I haven't pushed my latest changes though
[04:52:41] <mib_nogvnn> I'll reboot, push my changes, and ask again
[04:52:44] <mib_nogvnn> thanks!
[04:53:19] <klutzy> mib_nogvnn: you may just open /mingw/include/mswsock.h and remove `int WSAAPI WSAPoll(WSAPOLLFD, ULONG, INT);` line
[04:53:29] <klutzy> it's the source of failure
[04:53:32] <cmr> mib_nogvnn: you might also just slap an #[allow(uppercase_variables)] on libc
[04:53:49] <cmr> It's probably better to match the windows naming identically than enforce our style....
[04:53:54] <cmr> particularly in ffi
[04:54:22] <mib_nogvnn> yeah, that's what I was originally thinking of doing, but after I was asked to change it to just warn on the first character instead of the full name
[04:54:37] <mib_nogvnn> I figured I'd try to limit it to just the offending windows definitions
[04:55:24] <mib_nogvnn> yeah, I don't plan on changing any of the actually definitions since they are purposefully in windows style as opposed to Rust style
[04:55:27] <aatch> dougxxx, I've got to got now, but I'll be back on tomorrow (my time, it's 6pm here) if you have any more questions feel free to grab me then or send me a PM.
[04:55:34] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[04:55:38] *** Quits: capt_redbeard (Adium@moz-4998C3D0.ok.ok.cox.net) (Quit: Leaving.)
[04:55:51] <dougxxx> cheers~ might do. I think I need a bit of time to digest your answer.
[04:57:15] *** Quits: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it) (Ping timeout)
[04:57:41] *** Joins: epall (epall@moz-FA29BBA2.lightspeed.sntcca.sbcglobal.net)
[04:59:25] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[05:00:57] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[05:01:08] *** Joins: earlzlap (earlz@moz-483E1E31.neo.res.rr.com)
[05:01:23] *** Joins: davidkrauser (david@7DFD833F.77429D6C.147D8111.IP)
[05:01:58] *** Quits: heftig (heftig@moz-B4B4AC28.dip0.t-ipconnect.de) (Ping timeout)
[05:02:23] <mib_nogvnn> klutzy: removing that line does seem to be getting my compile to move along. thanks!
[05:02:36] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[05:03:31] *** Parts: davidkrauser (david@7DFD833F.77429D6C.147D8111.IP) ()
[05:04:26] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:06:42] *** Quits: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net) (Quit: Konversation terminated!)
[05:06:50] *** Joins: heftig (heftig@moz-656F0540.dip0.t-ipconnect.de)
[05:07:05] *** Joins: brandonson (SingingBoy@610D90A5.EE9B234.1ECA502.IP)
[05:07:29] *** Quits: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP) (Ping timeout)
[05:07:47] <mib_nogvnn> wow - the windows build is super, super slow
[05:08:36] *** Joins: maxli (Instantbir@moz-1650391B.hsd1.ca.comcast.net)
[05:09:10] <mib_nogvnn> at least building LLVM is
[05:10:16] <mib_nogvnn> aaaaand, I've hit more errors. I think I'll just disable the lint for the whole module.
[05:10:18] <mib_nogvnn> thanks all!
[05:10:24] *** Quits: mib_nogvnn (Mibbit@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: http://www.mibbit.com ajax IRC Client)
[05:10:55] *** Joins: tcsc (tcsc@moz-5E71BAD9.hsd1.ma.comcast.net)
[05:11:45] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:12:25] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[05:12:56] *** Joins: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net)
[05:13:11] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[05:13:59] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[05:15:39] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[05:15:55] *** Joins: Anupkumar (uid16774@moz-A42E5B7B.irccloud.com)
[05:16:48] <enix> back in linux. so much better than Windows, especially on a hiDPI screen.
[05:17:41] <cmr> wow, windows still hasn't worked out the hidpi stuff? They've already been through a rough dpi transition once in life, you'd think they would have learned.
[05:18:11] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[05:19:07] *** Quits: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:19:08] <enix> some stuff works. some stuff is quite ugly. Chrome for example.
[05:19:33] *** Quits: epall (epall@moz-FA29BBA2.lightspeed.sntcca.sbcglobal.net) (Quit: epall)
[05:19:41] <enix> HiDPI doesn't work all that great on Linux yet, but, with some tweaking, most of the text look pretty good.
[05:19:56] <sp3d> GTK has been doing a lot of HiDPI work recently
[05:21:05] <enix> I'm using KDE. some stuff is still way too small, but at least everything shows up clearly.
[05:22:56] *** Joins: alinab (alina@moz-94EAE39D.alinab.org)
[05:26:10] *** Joins: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net)
[05:28:32] *** Joins: aravindavk (aravinda@moz-BD0CADEE.redhat.com)
[05:29:16] *** Quits: pongad (pongad@moz-7E8AAD2E.res.gatech.edu) (Quit: Leaving)
[05:32:04] *** Quits: ski (ski@moz-E5796727.student.chalmers.se) (Quit: Lost terminal)
[05:33:41] <comex> metro is fully high DPI safe, though, right?
[05:34:12] <ChrisMorgan> So I understand. (But I haven't used it.)
[05:34:39] *** Quits: bollu (bollu@31CCE710.7065DDB9.6D6A344F.IP) (Ping timeout)
[05:35:02] *** Quits: Erik_ (Erik_S@moz-6691E309.hlrn.qwest.net) (Ping timeout)
[05:35:09] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[05:35:30] <comex> (i've been wondering whether it was a good idea for Apple to abandon the "old" resolution independence in favor of @2x)
[05:35:32] <comex> on OS X.
[05:36:03] *** Quits: dougxxx (dougxxx@moz-2801788.perm.iinet.net.au) (Ping timeout)
[05:36:12] <comex> but i never actually wrote programs for the old version, so maybe the new one is just better and it will support arbitrarier resolutions eventually
[05:36:49] <cmr> the old way was basically postscript in the UI, wasn't it?
[05:36:52] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[05:37:03] * cmr not familiar with apple tech
[05:37:50] *** Quits: orospakr (orospakr@moz-4514BEF2.cpe.teksavvy.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:37:51] *** Joins: dougxxx (dougxxx@moz-2801788.perm.iinet.net.au)
[05:38:29] * comex shrug, that's how Quartz in general is described (well, as PDF)
[05:38:30] * ChrisMorgan was never impressed with the @2x approach, preferring genuinely scalable—though precise at specific resolutions—techniques
[05:40:34] <comex> I wonder what happens if you force backingScaleFactor to a specific value
[05:40:36] *** Joins: lpy (lpy@52067FC0.F09091A8.1348A864.IP)
[05:40:41] *** Quits: pyon (user@6B56F365.A9B419CB.1C8C8CE9.IP) (Quit: restart)
[05:41:00] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[05:42:03] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: Taking a nap.)
[05:42:41] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Quit: Leaving...)
[05:42:58] *** Quits: ryeguy (ryeguy@9C569A0.5D1143CD.E8644521.IP) (Quit: )
[05:43:37] *** Joins: tgkokk (tgkokk@moz-E589AF21.home.otenet.gr)
[05:44:00] *** Quits: btipling (btipling@moz-D51E0AEB.xen.prgmr.com) (Ping timeout)
[05:44:24] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:46:11] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:46:21] *** Quits: earlzlap (earlz@moz-483E1E31.neo.res.rr.com) (Ping timeout)
[05:46:53] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[05:47:10] *** Joins: samx (sami@moz-D9DA5773.dyn.optonline.net)
[05:47:29] *** Quits: samx (sami@moz-D9DA5773.dyn.optonline.net) (Quit: This computer has gone to sleep)
[05:47:49] *** Quits: tgkokk (tgkokk@moz-E589AF21.home.otenet.gr) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[05:47:59] *** Quits: quux00 (uid24415@moz-E77DEB21.irccloud.com) (Quit: Connection closed for inactivity)
[05:50:34] *** Joins: untwisted (untwisted@moz-60D579DC.hsd1.ca.comcast.net)
[05:51:16] *** Joins: nlminhtl|home (ignotus@moz-4CB8A1D.site.volia.net)
[05:51:18] *** Quits: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net) (Quit: Konversation terminated!)
[05:52:55] *** Quits: dougxxx (dougxxx@moz-2801788.perm.iinet.net.au) (Ping timeout)
[05:54:13] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Client exited)
[05:54:33] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[05:56:20] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[05:57:38] *** Quits: zmthy (zmthy@moz-C2881CC3.ecs.vuw.ac.nz) (Quit: leaving)
[05:57:54] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:58:02] *** Quits: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it) (Ping timeout)
[05:58:32] *** Quits: derek_c (derek@moz-DA4FB9D2.cit.cornell.edu) (Ping timeout)
[05:59:40] *** Quits: tcsc (tcsc@moz-5E71BAD9.hsd1.ma.comcast.net) (Quit: bye!)
[06:00:23] *** Joins: dougxxx (dougxxx@moz-2801788.perm.iinet.net.au)
[06:00:42] <acrichto> sfackler: that error normally means that you just need a 'make clean'
[06:01:55] *** Quits: canhtak (canhtak@moz-46C3B4C8.wl.t.ulaval.ca) (Quit: canhtak)
[06:02:06] <ChrisMorgan> sfackler: at least one of the examples in your rust-postgres docs is out of date (crate root, extra::time → extern crate time)
[06:03:27] *** Quits: aravindavk (aravinda@moz-BD0CADEE.redhat.com) (Ping timeout)
[06:04:48] *** Joins: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP)
[06:04:48] *** ChanServ sets mode: +ao dherman dherman
[06:05:50] *** Quits: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp) (Ping timeout)
[06:05:57] <jroweboy> This doesn't seem right, I have a use std::default::Default; at the top of my file, but its not letting me make a default value for a field with ..Default::default() Has that syntax changed?
[06:06:08] *** Joins: yusukesuzuki (yusukesuzu@moz-43160292.net218219047.t-com.ne.jp)
[06:06:16] <cmr> jroweboy: nope, should work. what's the error?
[06:06:57] <jroweboy> oh wait, I'm silly, it was throwing the error in a file WITHOUT use std::default::Default... that was dumb of me :)!
[06:07:05] <cmr> :)
[06:07:32] *** Joins: rveach (kvirc@410D297A.C7FE7DD2.1302FB2C.IP)
[06:07:51] <jroweboy> sweet, now my rust is up to date so I can continue working on fixing lifetime errors that I have no clue how to resolve :p
[06:11:37] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Quit: wilmoore)
[06:11:50] *** Joins: darthdeus (darthdeus@EEC5B4DB.3B96A244.4E88690D.IP)
[06:12:28] *** Joins: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net)
[06:12:28] *** ChanServ sets mode: +o huon
[06:13:50] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:14:14] *** Joins: benjamin_ (benjamin@moz-A67B45F0.dip0.t-ipconnect.de)
[06:14:29] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[06:15:15] *** Quits: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net) (Ping timeout)
[06:15:58] *** Joins: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net)
[06:16:09] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[06:16:18] *** Joins: derek_c (derek@moz-F57DC3E8.cit.cornell.edu)
[06:16:36] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[06:18:49] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[06:24:10] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[06:24:19] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[06:24:34] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[06:31:31] *** Quits: indirect (indirect_m@moz-FE554AD3.hsd1.ca.comcast.net) (Ping timeout)
[06:33:11] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[06:34:18] *** Joins: daschl (Adium@moz-DC6DE6E2.vie.surfer.at)
[06:34:54] *** Joins: indirect (indirect_m@moz-50A5DDED.hsd1.ca.comcast.net)
[06:35:21] *** Joins: edwardw (edwardw@E6E87FA7.354F6412.B9C6B12A.IP)
[06:35:29] *** Quits: lpy (lpy@52067FC0.F09091A8.1348A864.IP) (Ping timeout)
[06:36:08] *** Quits: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP) (Ping timeout)
[06:37:29] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[06:39:14] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[06:39:21] *** Joins: aravindavk (aravinda@moz-BD0CADEE.redhat.com)
[06:39:40] *** Joins: ski (ski@moz-E5796727.student.chalmers.se)
[06:39:48] *** Joins: ofeldt- (ofeldt@moz-7573E33E.dip0.t-ipconnect.de)
[06:39:50] *** Joins: brson (brson@F16146EB.9D3722BB.58DC3EE6.IP)
[06:39:50] *** ChanServ sets mode: +ao brson brson
[06:40:28] *** Quits: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net) (Quit: stevegury)
[06:40:55] *** Quits: ofeldt (ofeldt@moz-5993F1EF.dip0.t-ipconnect.de) (Ping timeout)
[06:42:25] <cceckman> Hey, folks. I'm missing some understanding about lifetime specifiers- I'm trying to declare a delegate type (I think it'd be called in C#)- basically, a function signature- and I'm getting a compile error for missing a lifetime specifier.
[06:42:47] <cceckman> The line at issue is as follows:
[06:42:53] <cceckman> pub type serialReceiveHandler = |&u8, uint| -> ();
[06:43:01] <cceckman> Hints, things to read up on?
[06:43:40] <cmr> cceckman: so that's a closure
[06:43:58] <jroweboy> Hmm, have you tried declaring it as a fn(u8, unit) -> (); ?
[06:44:35] <jroweboy> so like pub type serialReceiveHandler =  fn(u8, unit) -> (); 
[06:44:41] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[06:45:02] *** Quits: aravindavk (aravinda@moz-BD0CADEE.redhat.com) (Ping timeout)
[06:45:07] *** Quits: mib_6uugpi (Mibbit@moz-1BB03833.lnk.telstra.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:45:21] <Yurume> cceckman: another way to do that is `pub type serialReceiveHandler<'a> = 'a |&u8, uint|;`.
[06:45:47] <Yurume> bare fn types can only be used with standalone functions (no environments attached) and considerably simpler
[06:46:09] <Yurume> closure types with lifetime are more general but bound to the lifetime, which may or may not suit your needs.
[06:46:13] <cmr> I don't know C# but in rust these are just function pointers.
[06:46:13] <cceckman> Hm, okay. "bare function" meaning a pure function?
[06:46:16] *** Quits: indirect (indirect_m@moz-50A5DDED.hsd1.ca.comcast.net) (Quit: Oh, bother.)
[06:46:24] <cmr> no, function pointer, no environment (not a closure)
[06:46:28] <Yurume> no outer environment.
[06:46:32] <cmr> rust doesn't have a concept of purity.
[06:46:46] <Yurume> (if your notion of purity is that of FP languages)
[06:47:01] <cceckman> jroweboy: thank you, did fix the error- trying to understand the reason why it's correct. :-)
[06:47:10] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[06:47:19] <jroweboy> What do you mean by no environment (I'm actually fighting through some function pointer errors my self :p )
[06:48:37] <cceckman> So a fn declaration would have to be a global fn (not a method), whereas a closure type could be an anonymous lambda,method, etc.
[06:48:40] <cmr> Closures (https://en.wikipedia.org/wiki/Closure_%28computer_programming%29), which in rust have the syntax `|args| -> return_type` can "capture" or refer to values that are outside of their own scope.
[06:48:42] <Yurume> jroweboy: let x = 42; fn foo() -> uint { x /* this is invalid */ } let bar = || x /* this is valid */;
[06:49:01] <jroweboy> ccekman: I wish I knew why it worked :/ I'm trying to figure these things out myself. I found this info here http://static.rust-lang.org/doc/master/complement-cheatsheet.html#how-do-i-store-a-function-in-a-struct
[06:49:39] <cmr> cceckman: methods are unfortunately not first class, you can never use them where a function or closure is wanted.
[06:50:03] <jroweboy> cmr: Yurume: that was a surprisingly clear explanation! Thanks for that
[06:50:24] *** Joins: Ferreus (ferreus@moz-3AB29841.dip0.t-ipconnect.de)
[06:50:38] <cceckman> Okay, that makes sense. Though- is calling ThisClass::instanceMethod(someInstance) supported as an equivalent of someInstance.instanceMethod() ?
[06:50:50] <cmr> not yet, but it is a planned feature.
[06:50:59] <cmr> at that point, methods *will* be first class :)
[06:51:18] <Yurume> (called UFCS, "Unified Function Call Syntax", I think)
[06:52:07] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[06:52:08] *** Joins: indirect (indirect_m@moz-50A5DDED.hsd1.ca.comcast.net)
[06:52:19] <cceckman> Sure- at the very least, with that support, you can fake it with a closure: |args : tp| -> retTp { meth(args) }
[06:52:24] *** Quits: oxum (anonymous@E0F72687.FE7DDF00.520CDC98.IP) (Ping timeout)
[06:52:32] <cmr> yup
[06:53:00] *** Quits: heftig (heftig@moz-656F0540.dip0.t-ipconnect.de) (Ping timeout)
[06:54:00] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[06:54:26] *** Joins: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net)
[06:54:32] *** Quits: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net) (Quit: puzzler)
[06:55:13] <cceckman> Awesome. Thanks, folks!
[06:55:42] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[06:55:52] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[06:56:03] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[06:56:21] *** Joins: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net)
[06:56:23] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[06:56:30] *** Quits: echristo (echristo@moz-1892C634.hsd1.ca.comcast.net) (Quit: echristo)
[06:57:05] *** Joins: fabiand (fabiand@moz-E905B6C.adsl.alicedsl.de)
[06:57:09] *** Quits: bmu (chatzilla@moz-A87574A6.hsd1.pa.comcast.net) (Ping timeout)
[06:57:43] *** Quits: fabiand (fabiand@moz-E905B6C.adsl.alicedsl.de) (Quit: Verlassend)
[06:57:46] *** Joins: fabiand (fabiand@moz-E905B6C.adsl.alicedsl.de)
[06:57:59] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[06:58:53] *** Quits: fabiand (fabiand@moz-E905B6C.adsl.alicedsl.de) (Quit: Verlassend)
[06:59:21] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[06:59:22] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[06:59:32] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[06:59:40] *** Joins: aravindavk (aravinda@moz-BD0CADEE.redhat.com)
[06:59:48] *** Joins: fabiand (fabiand@moz-E905B6C.adsl.alicedsl.de)
[07:01:18] <utkarsh> is there any Hoogle like thing for Rust? I could only find https://github.com/dbp/rustle, which is dead.
[07:01:28] *** Joins: lpy (lpy@2932A109.56B853B.8C13C571.IP)
[07:01:40] <cmr> utkarsh: unfortunately not.
[07:02:31] <utkarsh> is there any easy way to extract type signatures from source?
[07:03:00] <cmr> not super easily, but look at the json rustdoc outputs.
[07:03:18] <cmr> dbp was at one point going to integrate rustle with the new rustdoc's plugin support, but he never did.
[07:04:18] <cmr> but rustdoc emits precise data about the types of everything.
[07:04:24] *** Joins: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net)
[07:04:36] *** Joins: skade (skade@moz-F3F67608.pools.arcor-ip.net)
[07:04:38] *** Quits: brson (brson@F16146EB.9D3722BB.58DC3EE6.IP) (Ping timeout)
[07:05:39] *** Joins: brson (brson@F16146EB.9D3722BB.58DC3EE6.IP)
[07:05:39] *** ChanServ sets mode: +ao brson brson
[07:06:25] *** Joins: mgottschlag (quassel@moz-F89A5731.cust.bluewin.ch)
[07:07:12] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[07:12:27] *** Quits: maxli (Instantbir@moz-1650391B.hsd1.ca.comcast.net) (Ping timeout)
[07:12:48] *** Quits: lpy (lpy@2932A109.56B853B.8C13C571.IP) (Ping timeout)
[07:13:28] *** Joins: zztr (Thunderbir@moz-CA50D606.dsl.static.sonic.net)
[07:14:16] *** Quits: nlminhtl|home (ignotus@moz-4CB8A1D.site.volia.net) (Ping timeout)
[07:15:12] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[07:15:53] *** flaper87|afk is now known as flaper87
[07:15:54] *** Joins: alkino (alkino@moz-53CAAA6D.w92-151.abo.wanadoo.fr)
[07:16:53] *** Quits: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: dherman)
[07:17:12] *** Quits: jeaye (jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[07:17:37] <jroweboy> I have a mut static Option<T> type and with the latest rust I'm getting a "mutable static items are not allowed to have destructors" Is using Option<T> = None for a static type not allowed anymore?
[07:17:40] *** Joins: nlminhtl|home (ignotus@moz-4CB8A1D.site.volia.net)
[07:18:06] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[07:19:03] <Eridius> jroweboy: Option<T> is fine, but T can't have a destructor
[07:19:38] *** Joins: ziad (ziad@moz-C0318336.hsd1.ca.comcast.net)
[07:20:15] <jroweboy> Oh no! when did this start? hrmm... I don't know how I'll rewrite it without a mut static
[07:20:17] <Eridius> jroweboy: the problem is statics with destructors will never run their destructors. In the absence of rtabort or libc::abort(), all values with destructors will normally destruct eventually. But not statics. So it was decided that statics shouldn't be able to have destructors
[07:20:44] *** Quits: nlminhtl|home (ignotus@moz-4CB8A1D.site.volia.net) (Quit: Konversation terminated!)
[07:21:43] <jroweboy> Eridius: That does sound completely reasonable. But now that that is the case I need to figure something out to cover my use case then :)
[07:22:25] <Eridius> as long as you're using a mut static, you've already conceeded to using unsafe code, so you could just use a ~T, store it in a *T, and use forget() to prevent the value from actually destructing when you first store it
[07:24:26] <jroweboy> I would much prefer to not use safe code, but I'm not sure how I could avoid it. In my project, I have a wrapper to lib pcre that needs to be a mutable struct. Well, the main struct I would have stored it in is immutable and I can't change that. So I opted for a mut static
[07:24:42] <Eridius> and the struct needs a destructor?
[07:24:54] <Eridius> also, if the main struct is immutable, just use Cell<T>
[07:24:58] <Eridius> that encapsulates mutability
[07:25:56] <jroweboy> This is why I ask these things on the IRC. I have a real hard time finding these things out without someone on the IRC saying "Why not just do this?" I'll give Cell<T> a shot.
[07:26:03] <Eridius> :D
[07:26:13] <cmr> jroweboy: #rust is the best documentation right now
[07:26:21] <cmr> (thankfully. we'd be screwed without it!)
[07:26:28] <Eridius> oh hrm, Cell says it only accepts Pod. really?
[07:26:33] *** Quits: mgottschlag (quassel@moz-F89A5731.cust.bluewin.ch) (Ping timeout)
[07:26:42] <edwardw> RefCell then
[07:26:43] <Eridius> ah, RefCell<T>
[07:27:02] *** Joins: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP)
[07:27:03] <Eridius> looks like Cell just copies its value, RefCell is what introduces the dynamically-checked borrowing
[07:28:29] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[07:28:49] <jroweboy> Ok, I'll check out RefCell :) Thanks!
[07:30:28] <cmr> RefCell isn't going to be threadsafe, so using it doesn't help a ton with static muts....
[07:30:36] *** Quits: darthdeus (darthdeus@EEC5B4DB.3B96A244.4E88690D.IP) (Quit: Leaving...)
[07:30:48] <Eridius> cmr: he said he was using the static mut because he couldn't store it in his immutable struct
[07:30:54] <Eridius> so I'm saying put a RefCell<T> in the immutable struct
[07:31:02] <Eridius> I'm assuming the point is it needs to be mutable
[07:31:05] *** Quits: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[07:31:08] <cmr> oh ok
[07:31:13] * cmr wasn't paying close attention
[07:32:00] *** Quits: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net) (Quit: killerswan)
[07:32:11] <jroweboy> cmr: That could be an issue. I'm writing a web framework using rust-http, and so I'm implementing a server and it looks like it spawns a process for each request. I'm not sure if that would cause a problem or not though
[07:34:22] <Eridius> jroweboy: if you need cross-task access to a shared resource, MutexArc is your friend. That uses a mutex to ensure only one task accesses its value at a time
[07:35:24] *** Joins: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net)
[07:36:11] <jroweboy> I guess I'll just use MutexArc. I had problems earlier (had my code segfault) because the pcre struct was cloned. Where is mutexArc located at?
[07:36:15] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:36:36] <Eridius> libsync iirc
[07:37:52] *** Joins: t4nk905 (bzlandfill@moz-833C28A3.hsd1.va.comcast.net)
[07:37:56] *** Quits: Valloric (Valloric@moz-288722BA.hsd1.ca.comcast.net) (Quit: Valloric)
[07:38:08] <utkarsh> cmr, rustdoc's json really has lots of info. How do I run it on the whole Rust repo? It says it can process only one file at a time.
[07:38:40] <cmr> utkarsh: it processes one crate at a time.
[07:38:41] <Eridius> utkarsh: it processes one crate at a time
[07:38:47] <Eridius> cmr: :D
[07:38:53] <cmr> Eridius: Iad a period, I win
[07:38:56] <cmr> *I had
[07:38:58] <cmr> :P
[07:39:05] <Eridius> I'm in a separate discussion at the same time in person. I win :P
[07:39:12] * cmr conceeds
[07:40:07] <cmr> utkarsh: there's no make target to generate json, but there defeinitely should be.
[07:40:32] *** Quits: kngl (Adium@40AE2BF6.ABCDAFD6.7C797F8E.IP) (Ping timeout)
[07:40:55] <cmr> if you open an issue I can try and add tomorrow.
[07:40:57] *** Joins: kngl (Adium@40AE2BF6.ABCDAFD6.7C797F8E.IP)
[07:41:00] <cmr> cc @cmr
[07:41:44] <t4nk905> hi
[07:42:05] <t4nk905> I need help with ARC
[07:42:16] <t4nk905> i have a vector
[07:42:35] <t4nk905> that I'm wrapping with a ARC
[07:43:19] <t4nk905> so I have some_list_arc.access( |queue| { ... });
[07:43:27] <t4nk905> is anyothere?
[07:43:36] <cmr> t4nk905: yes
[07:43:39] <cmr> keep going :)
[07:43:40] <t4nk905> awesome
[07:43:43] <t4nk905> ok :)
[07:43:51] <t4nk905> so if I do something like
[07:44:09] <t4nk905> queue.push(temp);
[07:44:14] <t4nk905> in the "..." area
[07:44:15] <t4nk905> it works fine
[07:44:17] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[07:44:23] <t4nk905> however, since it's a queue, I want to iterate through it
[07:44:30] <geomyidae> Is thestringer's repo behind again/
[07:44:40] <cmr> geomyidae: no, should be up to date.
[07:44:50] <cmr> geomyidae: though he mentioned the builder server is under heavy load
[07:44:50] <t4nk905> and do something like for i in range (0, queue.len()) { let var = queue[i] }
[07:44:52] <geomyidae> I'm getting breakage on travis that I'm not seeing locally
[07:45:02] <t4nk905> that gives me an error
[07:45:03] <geomyidae> (2 or 3 days now)
[07:45:06] <cmr> geomyidae: which breakage specficially?
[07:45:23] <t4nk905> error: cannot move out of dereference of & pointer
[07:45:32] <geomyidae> cmr: https://travis-ci.org/colemickens/rust-packet
[07:45:35] <Eridius> t4nk905: `let var = queue[i]` is trying to move out of the vector
[07:45:40] <geomyidae> error: failed to find an implementation of trait std::fmt::Show for packet::Ethertype
[07:45:41] <Eridius> t4nk905: just use `for var in queue.iter() { ... }`
[07:45:48] <t4nk905> ...
[07:45:53] <t4nk905> genius
[07:46:00] <t4nk905> wait will that work lol?
[07:46:08] <cmr> geomyidae: oh, looks like it is 3 days beind :(
[07:46:16] <geomyidae> thestringer or travis?
[07:46:24] *** Quits: victorporof (victorporo@moz-FFB76956.cpe.net.cable.rogers.com) (Quit: victorporof)
[07:46:24] <cmr> thestinger
[07:46:27] <Eridius> t4nk905: you could modify your code as `let var = &queue[i]` if you want, but using the iterator is a much better way to iterate
[07:46:33] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[07:46:43] *** Quits: kngl (Adium@40AE2BF6.ABCDAFD6.7C797F8E.IP) (Quit: Leaving.)
[07:46:52] <t4nk905> so like
[07:46:53] <geomyidae> Oh well. I get far better than what I pay for :) I just thought I'd seen an update more recently than that.
[07:46:57] *** Joins: marianoguerra (marianogue@moz-542D9D16.dip0.t-ipconnect.de)
[07:47:00] <t4nk905> I'm trying to insert something in the middle of the queue
[07:47:15] *** Quits: untwisted (untwisted@moz-60D579DC.hsd1.ca.comcast.net) (Ping timeout)
[07:47:30] <t4nk905> for that do you recommend using iterator?
[07:47:42] <Eridius> t4nk905: is it insert then break, or do you keep iterating?
[07:47:49] <t4nk905> basically I want the queue to be sorted (not really a queue, really a list)
[07:48:15] <t4nk905> so basically i want to insert it to the right index
[07:48:18] <t4nk905> an then break out
[07:48:25] <t4nk905> and*
[07:48:37] <t4nk905> so insert then break
[07:48:40] <t4nk905> to answer your question
[07:49:24] *** Quits: blindrenderer (blindrende@B323C515.54C85F70.2125B4DC.IP) (Ping timeout)
[07:50:02] <t4nk905> so which do you recommend? use & to set it to borrowed?
[07:50:38] <Eridius> t4nk905: I think you're going to run into a borrowck error either way, since you're going to have an active borrow on the vector when you want to mutate it
[07:50:39] <jroweboy> t4nk905: if you are sorting you could try this? http://static.rust-lang.org/doc/master/std/vec/trait.MutableVector.html#tymethod.sort_by
[07:50:50] <Eridius> so fundamentally what you really need is an expression that returns the index to insert the new value in
[07:50:58] <t4nk905> exactly
[07:51:04] <t4nk905> @eridius
[07:51:06] <Eridius> jroweboy: if the vector is already sorted, pushing a new element and then re-sorting the whole vector is kind of overkill
[07:51:08] <t4nk905> i want to find the right index
[07:51:15] *** Quits: alan_andrade (alan_andra@moz-7559582E.hsd1.ca.comcast.net) (Input/output error)
[07:51:24] <t4nk905> once I have the right index
[07:51:30] <t4nk905> i can just insert it outside the forloop
[07:51:41] <jroweboy> Eridius: Oops, didn't see that it was already sorted :) 
[07:51:46] <t4nk905> :)
[07:51:46] <Eridius> interestingly, I don't see any existing methods that help with finding the index at which something could be inserted to preserve sorting
[07:52:04] <t4nk905> hmm 
[07:52:11] <t4nk905> hopefully I can find the right index
[07:52:21] <t4nk905> then, outside the forloop I can just do 
[07:52:24] <Eridius> t4nk905: basically you want to find the index of the first value that's greater than your desired value?
[07:52:36] <t4nk905> exactly, something like that
[07:52:49] <t4nk905> if there's a way to do it without error inside the loop
[07:53:08] <t4nk905> but at a high level, I should be able to do it with the index
[07:53:27] <t4nk905> btw, I appreciate the help! a lot
[07:53:34] <t4nk905> prolly saved me like 2 hours of just screwing around
[07:54:21] <Eridius> well I mean you could do something like `let mut idx = None; for (i, val) in queue.iter() { if val > new_val { idx = Some(i); break; } }; match idx { None => queue.push(new_val), Some(x) queue.insert(x, new_val) }`
[07:54:31] <Eridius> that's not a binary search of course
[07:54:43] *** Quits: rveach (kvirc@410D297A.C7FE7DD2.1302FB2C.IP) (Ping timeout)
[07:54:57] *** Joins: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net)
[07:55:11] *** Joins: jclements (jclements@moz-440F24A8.lightspeed.mtryca.sbcglobal.net)
[07:55:50] *** Quits: benjamin_ (benjamin@moz-A67B45F0.dip0.t-ipconnect.de) (Quit: Verlassend)
[07:56:03] <Eridius> t4nk905: of course, I don't know what you're using the vector for. You might want to consider other data structures too. collections::treemap::TreeSet implements a Set as a self-balancing binary search tree
[07:56:19] <Eridius> requires your value to implement TotalOrd, but that's it. Of course, being a Set, it can't store two values that are equal
[07:56:22] <Eridius> but I don't know if you want that
[07:56:49] <t4nk905> unfortunately
[07:56:55] <t4nk905> this is for a hw
[07:57:00] <Eridius> ah
[07:57:01] <t4nk905> and they are using a vector
[07:57:02] <t4nk905> :(
[07:57:11] <Eridius> ok well, the for loop there should get you started
[07:57:13] <t4nk905> ya
[07:57:13] * Eridius heads to bed
[07:57:22] <t4nk905> i think you gave me enough information
[07:57:24] <t4nk905> thank you man
[07:57:29] *** Quits: thesnowdog (doug@70C52BD5.CDB23781.6F17036B.IP) (Ping timeout)
[07:57:31] <Eridius> np
[07:57:39] <jroweboy> t4nk905: You have a class in rust or you can use any language?
[07:57:46] *** Quits: zztr (Thunderbir@moz-CA50D606.dsl.static.sonic.net) (Quit: zztr)
[07:57:49] <t4nk905> technically
[07:57:56] <t4nk905> we could have used any language for this assignment
[07:58:00] *** Joins: Guest_ (textual@6D4B99D4.86870777.66E0D391.IP)
[07:58:00] <t4nk905> but prof gave starter code in rust
[07:58:03] <t4nk905> and I want to learn rust
[07:58:07] <t4nk905> I like what rust attempts
[07:58:12] <t4nk905> but as a C programmer for like
[07:58:16] <t4nk905> 6 years
[07:58:21] <t4nk905> i have a hard time transitioning
[07:58:29] <t4nk905> and I struggle with simple stuff
[07:58:29] *** pmoore|away is now known as pmoore
[07:58:42] <t4nk905> in rust
[07:58:49] <t4nk905> but I want to get good at it!
[07:59:54] <jroweboy> I know that feeling :) It gets easier though. I've only been using rust for 2 months now, and I am finally wrapping my head around the simple things I think
[08:00:57] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[08:05:05] *** Joins: thesnowdog (doug@9FBB32C3.9D0B7490.6F17036B.IP)
[08:05:53] *** Quits: Anupkumar (uid16774@moz-A42E5B7B.irccloud.com) (Quit: Connection closed for inactivity)
[08:06:54] *** Joins: mouse (mouse@moz-373942D2.dhcp.yndx.net)
[08:07:15] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Ping timeout)
[08:07:19] *** Quits: thesnowdog (doug@9FBB32C3.9D0B7490.6F17036B.IP) (Ping timeout)
[08:08:15] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[08:08:25] *** Joins: bvssvni (Mibbit@moz-C4579D6F.bb.online.no)
[08:12:02] *** Quits: onelson_ (owen@18CF7301.95770028.5B6BFE7D.IP) (Ping timeout)
[08:12:15] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Ping timeout)
[08:12:22] *** Quits: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net) (Quit: carllerche)
[08:12:43] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Input/output error)
[08:14:19] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[08:16:24] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[08:17:10] *** Quits: marianoguerra (marianogue@moz-542D9D16.dip0.t-ipconnect.de) (Ping timeout)
[08:18:50] *** Joins: thesnowdog (doug@88FE1F50.9D0B7490.6F17036B.IP)
[08:19:18] *** Joins: vadimcn (chatzilla@FB06B64.76F9E272.DA40C4B3.IP)
[08:21:23] *** Quits: Guest_ (textual@6D4B99D4.86870777.66E0D391.IP) (Quit: Computer has gone to sleep.)
[08:21:31] <dougxxx> can you link a library with rust using an absolute path to a static library? #[link(name = "/Users/x/rust-v8/build/src/v8/out/native/libv8_base.x64.a", kind = "static")]
[08:21:38] <dougxxx> well, no, it doesn't work
[08:21:52] <dougxxx> but something like that, instead of using -L 
[08:22:36] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:23:17] *** Quits: derek_c (derek@moz-F57DC3E8.cit.cornell.edu) (Quit: Leaving)
[08:24:33] *** Quits: alkino (alkino@moz-53CAAA6D.w92-151.abo.wanadoo.fr) (Ping timeout)
[08:25:01] *** Quits: patpat (patpat@moz-1599AAE4.as13285.net) (Ping timeout)
[08:25:07] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[08:25:08] <jroweboy> dougxxx: Just curious, but what would be the point of doing it like that?
[08:25:17] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[08:25:32] <dougxxx> Not having to copy all your static libraries from ten different places into one place so you can call rustc -Lblah
[08:25:54] <dougxxx> It's the difference between having a cmake build generate a single rust file from a template
[08:26:08] <dougxxx> and having cmake generate a complicated (O_o) build script with multiple -L calls 
[08:26:13] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[08:26:39] <dougxxx> (or do some bizaar POST_BUILD step that copies created targets from various places into a single folder)
[08:27:20] <dougxxx> (for static linking, specifically)
[08:27:25] <jroweboy> Hmm, I didn't think about that as a possible benefit of that syntax. I'm no contributor, but if you don't get a response, I would think that would be a great thing to bring up on the mailing list
[08:27:35] *** Quits: ercxx (ercan@moz-88DD3A7E.dyn.optonline.net) (Quit: WeeChat 0.4.3)
[08:27:46] <jroweboy> I'm not sure who else is around right now
[08:29:05] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[08:29:12] *** Quits: indirect (indirect_m@moz-50A5DDED.hsd1.ca.comcast.net) (Ping timeout)
[08:29:35] * dougxxx greps rust source to see if there are any useful examples... 
[08:29:37] <dougxxx> :P
[08:30:12] *** Joins: indirect (indirect_m@moz-50A5DDED.hsd1.ca.comcast.net)
[08:30:18] <dougxxx> yeah, doesn't look like it. might flick a thread on the mailing list.
[08:30:34] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[08:31:02] <jroweboy> Its quite possible that its one of those intended things that just hasn't been implemented yet :)
[08:31:05] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[08:31:30] <jroweboy> (currently I'm using the copy into one folder method in my project :p)
[08:32:05] <paupau> Is `(obj as &mut Any).as_mut::<Derived>().unwrap()` how you might downcast (mutably)?
[08:32:57] <paupau> rustc seems to ignore my plea and leave the result as the base type.
[08:33:31] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[08:33:34] *** Joins: alan_andrade_ (alan_andra@moz-7559582E.hsd1.ca.comcast.net)
[08:33:54] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[08:35:07] *** Joins: nfroidure (nfroidure@moz-65B09039.w90-18.abo.wanadoo.fr)
[08:35:34] *** Quits: alan_andrade_ (alan_andra@moz-7559582E.hsd1.ca.comcast.net) (Ping timeout)
[08:36:00] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Input/output error)
[08:36:41] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[08:37:48] *** Joins: nkoep (nik@moz-10914ED.pool.mediaways.net)
[08:41:02] *** Joins: steffenomak (steffenoma@moz-FB0A4BEB.student.uu.se)
[08:42:44] <paupau> no, wait, I think that was the return type not being constrained enough.
[08:42:56] *** Quits: MP2E (cray@moz-EB1E242D.lv.lv.cox.net) (Quit: pow)
[08:43:11] *** Joins: kris (kris@moz-6D20263F.fullrate.dk)
[08:43:52] *** Quits: edwardw (edwardw@E6E87FA7.354F6412.B9C6B12A.IP) (Quit: Leaving...)
[08:47:10] *** Joins: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP)
[08:48:50] *** Quits: skade (skade@moz-F3F67608.pools.arcor-ip.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:50:30] *** Joins: heftig (heftig@moz-D746319F.unitymedia.biz)
[08:51:46] *** Quits: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: azita)
[08:52:18] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[08:52:29] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[08:54:43] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[08:55:26] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[08:57:39] *** Joins: oxum (anonymous@F94B60C3.9C15B13F.520CDC98.IP)
[09:00:19] *** Joins: eibwen (kvirc@moz-46F76C74.dip0.t-ipconnect.de)
[09:02:34] *** Quits: cceckman (cceckman@moz-135DFDD5.bootp.virginia.edu) (Ping timeout)
[09:02:55] *** Quits: sawrubh|bot (~sawrubhbo@moz-E0F149F7.members.linode.com) (Ping timeout)
[09:05:47] *** Joins: benjamin_ (benjamin@moz-A67B45F0.dip0.t-ipconnect.de)
[09:06:36] *** Joins: sawrubh|bot (~sawrubhbo@moz-E0F149F7.members.linode.com)
[09:07:00] <t4nk905> hi is anyone there?
[09:07:11] *** Joins: jviereck (Adium@moz-5F2A758D.ethz.ch)
[09:07:27] <t4nk905> anyone there? I need some help with LruCache
[09:07:34] <t4nk905> http://static.rust-lang.org/doc/0.9/extra/lru_cache/struct.LruCache.html
[09:07:41] <t4nk905> if anyone there, please let me know
[09:07:49] <Yurume> yeah?
[09:07:51] *** Quits: fhahn (fhahn@moz-7924DB5C.vie.surfer.at) (Ping timeout)
[09:07:52] <t4nk905> hey there
[09:08:01] <t4nk905> so I'm trying to have a global cache
[09:08:07] <Yurume> IRC tip: just ask around, IRC is asynchronous and anyone can reply to your question anytime.
[09:08:12] *** Quits: jviereck (Adium@moz-5F2A758D.ethz.ch) (Quit: Leaving.)
[09:08:19] *** Joins: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net)
[09:08:21] <t4nk905> static mut cache: LruCache<int, int> = LruCache::new(100);
[09:08:24] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[09:08:26] *** Quits: puzzler (puzzler@moz-979AD744.hsd1.mi.comcast.net) (Quit: puzzler)
[09:08:30] <t4nk905> but that seems to blow up
[09:08:51] <t4nk905> i want to do some application level caching
[09:08:56] <t4nk905> and I have a global cache
[09:08:56] <Yurume> static mut does not have a destructor.
[09:09:02] *** Joins: jviereck (Adium@moz-5F2A758D.ethz.ch)
[09:09:04] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:09:04] *** Quits: jviereck (Adium@moz-5F2A758D.ethz.ch) (Client exited)
[09:09:09] <t4nk905> so how should I do it?
[09:09:21] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[09:09:36] <Yurume> depends, do you use tasks?
[09:09:42] <eddyb> t4nk905: why do you want it to be global?
[09:09:54] <t4nk905> I do use tasks, but
[09:10:00] <t4nk905> why wouldn't I want it to be global
[09:10:03] <eddyb> global resources are bad
[09:10:08] <Yurume> yeah, more preferably you should avoid global states
[09:10:11] <t4nk905> basically I'm making a webserver
[09:10:12] <eddyb> for both safety and design
[09:10:19] <t4nk905> like with just localhost
[09:10:24] <t4nk905> and I have a queue of requests
[09:10:25] <Yurume> t4nk905: routing pattern?
[09:10:26] <eddyb> t4nk905: it's much better to pass a context around
[09:10:29] <t4nk905> and I want to cache them
[09:10:32] <t4nk905> if they local
[09:10:40] <t4nk905> (the requests, that is)
[09:10:46] <Yurume> that tremendously depends on the architecture.
[09:10:54] <eddyb> keep the cache in your Server structure
[09:11:05] <jroweboy> eddyb: what do you mean pass a context around?
[09:11:05] <t4nk905> so where would I set it up?
[09:11:17] <eddyb> t4nk905: as in, construct?
[09:11:17] <t4nk905> i mean, this is a hw
[09:11:20] <t4nk905> yes
[09:11:34] <t4nk905> basically everytime
[09:11:36] <eddyb> when you construct the server structure, you have to give a value to the cache
[09:11:46] <jroweboy> (sorry, I'm writing something similar so I'm curious to see what your input is)
[09:11:48] <Yurume> conceptually, an web server is a function from request to response, and actual networking occurs somewhere else. so you can make a "middleware" which wraps the existing function to cache request-to-response pairs.
[09:12:01] <t4nk905> of course
[09:12:02] <eddyb> Yurume: that's a more complicated design
[09:12:04] <t4nk905> that's ideal
[09:12:12] <eddyb> t4nk905: I assume you construct the server once and then it will keep serving requests
[09:12:23] <t4nk905> exactly
[09:12:26] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[09:12:28] *** Parts: dougxxx (dougxxx@moz-2801788.perm.iinet.net.au) (Leaving...)
[09:12:30] <Yurume> eddyb: depends, I really don't know about t4nk905's current design though
[09:12:40] <eddyb> t4nk905: when you do that, create the cache as a field of the server structure
[09:12:43] <t4nk905> but eddyb got it right
[09:12:47] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:12:50] <t4nk905> oh
[09:12:53] <eddyb> cache: LruCache::new(100)
[09:12:53] <t4nk905> ok that's fair
[09:12:58] <t4nk905> no that makes too much sense
[09:13:02] <t4nk905> can't do it 
[09:13:05] <t4nk905> (sarcasm)
[09:13:07] <t4nk905> thank you
[09:13:07] <eddyb> lol?
[09:13:13] <eddyb> np
[09:13:15] <t4nk905> :)
[09:13:36] *** Quits: ash_ (ash@15DEC023.DFC68827.9C33A531.IP) (Ping timeout)
[09:13:54] <eddyb> jroweboy: in t4nk905's case, their context is the Server structure. they're already passing it around, so the cache can sit in there
[09:14:13] <eddyb> jroweboy: it is preferred to pass borrowed pointers or arcs (if you have multiple tasks) with your data in them
[09:14:13] <t4nk905> right
[09:14:19] <eddyb> jroweboy: rather than store them globally
[09:14:20] <t4nk905> jroweboy
[09:14:25] <t4nk905> are you in my class or something lol?
[09:14:29] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[09:14:34] <t4nk905> how do you what I'm supposed to do
[09:14:50] <eddyb> maybe. I've seen like 4 people from that class
[09:14:59] <jroweboy> t4nk905: probably not :p I'm writing a web framework as a side project that just happened to get adopted as a group project
[09:15:01] <t4nk905> wait
[09:15:05] <t4nk905> I totally misread that
[09:15:09] <t4nk905> it's late
[09:15:12] <t4nk905> :/
[09:15:17] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[09:15:20] <t4nk905> but eedyb thank you
[09:15:24] <t4nk905> let me see what I can do
[09:15:31] <eddyb> good luck!
[09:16:02] *** Joins: fhahn (fhahn@moz-7924DB5C.vie.surfer.at)
[09:16:17] <eddyb> I'm not disappointed by how much closer 0.9 is to master than 0.7/0.8 were, last year's class
[09:16:55] <eddyb> the main thing is the conditions we've removed since. and maybe ~[T] -> Vec<T> will be completed soon, but the APIs are relatively stable
[09:16:57] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[09:17:04] <eddyb> even if they moved from extra to other libraries
[09:17:05] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[09:17:12] *** Joins: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com)
[09:17:12] <Yurume> Vec<T> landing countdown anyone?
[09:17:32] <eddyb> Yurume: pcwalton spews "errors left" sometimes
[09:17:47] <eddyb> you can make a graph and extrapolate
[09:18:05] <jroweboy> eddyb: In my case though, I'm passing around a borrowed pointer to a Request object that has a context inside of it. But I'm having trouble modifing the context from the view functions since I can't move the context out of the borrowed pointer
[09:18:18] <eddyb> jroweboy: you can use RefCell
[09:18:42] *** Quits: kris (kris@moz-6D20263F.fullrate.dk) (Ping timeout)
[09:18:44] *** Joins: kris (kris@moz-B3A044B.dk.customer.tdc.net)
[09:18:47] <jroweboy> What exactly is RefCell (I only just learned of it today in a seperate question)
[09:18:50] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[09:18:58] <eddyb> it ref-counts your borrows
[09:19:05] <eddyb> instead of the compiler doing so
[09:19:15] <eddyb> many & or one &mut are allowed
[09:19:26] <eddyb> (just like the actual borrow checker in the compiler)
[09:19:59] *** Joins: jviereck (Adium@moz-5F2A758D.ethz.ch)
[09:20:02] <eddyb> and you'd replace &RefCell<T> with RWArc<T> if you needed to share that context across tasks, btw
[09:20:10] <Yurume> eddyb: linear interpolation suggests -7000 errors left at this right moment
[09:20:27] <eddyb> lolz
[09:20:39] <Yurume> two data points, horribly inaccurate :p
[09:20:44] <eddyb> there's more
[09:20:51] <Yurume> uh, where?
[09:20:52] <Yurume> https://botbot.me/mozilla/rust/search/?q=errors+left
[09:21:00] <jroweboy> Yurume: some of those negative errors landed in my program :p 
[09:21:15] <Yurume> jroweboy: whoops!
[09:21:33] <eddyb> Yurume: more data here https://docs.google.com/spreadsheet/ccc?key=0AmYOd6rv-l1OdHpIQkEwWmlneUtqVXNCV0RJUktRamc&usp=sharing#gid=0
[09:22:05] <jroweboy> eddyb: It just doesn't seem right to use RefCounting since at any given time, there is only one function that uses the Request object and then passes it on the next
[09:22:12] *** Quits: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com) (Client exited)
[09:22:15] <eddyb> jroweboy: then use &mut
[09:22:25] <eddyb> that's what &mut means, one holder
[09:22:45] <Yurume> eddyb: uh, an order of 3,000 errors?
[09:22:58] <eddyb> Yurume: that may have been something else
[09:23:01] <Yurume> 2014-09 seems... the far future.
[09:23:16] <eddyb> he finished it anyways
[09:23:24] <eddyb> if it was the pattern stuff
[09:23:39] <jroweboy> Hmmm... I'll give that a shot then. That actually make a lot of sense. I have to first fix the mysterious "capacity overflow" error I caused somehow. 
[09:23:54] <eddyb> jroweboy: nmatsakis even wanted to *replace* &mut with &my/&move (complete ownership over the contents, but not the allocation) because they'd have almost identical semantics
[09:25:02] *** Joins: marianoguerra (marianogue@moz-70A170F.hsi8.kabel-badenwuerttemberg.de)
[09:25:16] <eddyb> so &'a move T could do anything with the contents, including dropping them, and its actual lifetime 'a indicates when the allocation would be freed
[09:25:34] <eddyb> I guess you wouldn't want something that powerful for mutable borrows, hmpf
[09:25:43] *** Quits: jlong (jlong@moz-6DFDE846.socal.res.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[09:26:30] <jroweboy> It does seem like the mut keyword means different things though. At least the way I see it when you type let mut x you are saying I want a mutable var, but when you say fn(&mut x) I wouldn't think that meant move. I can see why the move keyword wasn't added as well though
[09:26:48] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[09:27:22] *** Joins: skade (skade@moz-F3F67608.pools.arcor-ip.net)
[09:27:57] *** Quits: alinab (alina@moz-94EAE39D.alinab.org) (Quit: leaving)
[09:28:22] <jroweboy> Its one of those times where I just didn't fully understand what mut meant so I didn't know that if I wanted something moved I needed to make it mutable :) Before this I just had it copied each time :p
[09:29:07] *** Joins: alinab (alina@moz-94EAE39D.alinab.org)
[09:29:38] *** Quits: ziad (ziad@moz-C0318336.hsd1.ca.comcast.net) (Quit: ziad)
[09:31:23] *** Quits: mbx (mbebenita@moz-B45FE61C.hsd1.ca.comcast.net) (Quit: mbx)
[09:31:58] <jroweboy> So I'm getting a "capacity overflow" error which means I'm allocating a vector thats too large. But I don't get this info until runtime and the message does not include the call stack. Is there anyway I can find out what is causing the issue?
[09:32:13] <eddyb> is it a task failure?
[09:32:23] <jroweboy> running it in gdb is just giving me memory addresses. I think its a task failure
[09:32:37] <jroweboy> task 'main' failed at
[09:32:47] <eddyb> b rust_fail before run
[09:32:50] *** Joins: patpat (patpat@9E957BB5.933C45AA.98F3E2B5.IP)
[09:33:03] <eddyb> jroweboy: did you read the tutorial? if so and there were problems, opening an issue/commenting an existing one/posting to the mailing list/subreddit about it would be appreciated
[09:33:04] *** Quits: t4nk905 (bzlandfill@moz-833C28A3.hsd1.va.comcast.net) (Quit: CGI:IRC (Ping timeout))
[09:33:09] <eddyb> feedback, basically. we like feedback
[09:33:31] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[09:34:12] *** Quits: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) (Ping timeout)
[09:35:40] <jroweboy> Sure! I'll probably send out some feedback on documentation at least by the end of the semester. As I mentioned, my little rust project just suddenly became a group project so now I'm going to be swamped :/
[09:35:58] <jroweboy> No one in my group knows rust besides me
[09:36:42] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[09:36:44] *** Quits: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP) (Connection reset by peer)
[09:37:02] *** Quits: patpat (patpat@9E957BB5.933C45AA.98F3E2B5.IP) (Ping timeout)
[09:37:30] <jroweboy> But that'll give me some more perspective on teaching rust and I can see what struggles they are experiencing. Yes I did read the tutorial, but most of the time a tutorial never seems to cover what I want and then I'll ask a question in the IRC and I find out the info was in some other location like the cheatsheet for example
[09:38:00] <eddyb> jroweboy: read all the things!
[09:38:10] *** Quits: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com) (Ping timeout)
[09:41:17] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[09:41:57] *** Joins: redShadow (redShadow@9BDAF02B.D15F9219.1CCF65D9.IP)
[09:42:11] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[09:43:36] <jroweboy> so then, for example, you said put a breakpoint at rust_fail. Where would I find that in the documentation? I looked for it in the tutorial and the manual and didn't see it, I ended up finding that by a google search which brought a gist of someone's gdb output in it. I just find it hard to find things :S
[09:43:55] *** Joins: josh (josh@moz-C1D9FC5F.meeting.ietf.org)
[09:44:04] <eddyb> jroweboy: we need a debugging guide
[09:44:44] *** Quits: kris (kris@moz-B3A044B.dk.customer.tdc.net) (Ping timeout)
[09:44:48] *** Quits: p1start (rewi@moz-A082F561.adsl.xtra.co.nz) (Ping timeout)
[09:44:52] *** Joins: kris (kris@moz-147EE6DF.diku.dk)
[09:45:24] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:45:56] *** Joins: vmx (vmx@moz-91256D27.pools.arcor-ip.net)
[09:46:33] *** Joins: marwy (user@41303A68.5C2AEEF8.CFA44423.IP)
[09:46:55] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[09:47:46] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:48:03] *** Joins: meyer (Mibbit@moz-A9CF56E4.hsd1.ca.comcast.net)
[09:48:08] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[09:48:29] <meyer> Hello. I was wondering what the idiomatic solution to "cannot provide an extension implementation where both trait and type are not defined in this crate" is.
[09:48:46] <eddyb> meyer: what's the trait?
[09:48:53] <meyer> TotalOrd
[09:48:57] <eddyb> sometimes you can wrap the type in a newtype
[09:48:59] <meyer> And FileStat is the type
[09:49:26] <eddyb> struct TotalOrdFileStat(FileStat); and impl TotalOrd on that
[09:49:34] <meyer> Alright, I should probably have tried that first
[09:49:34] <meyer> And
[09:49:45] <eddyb> this is somewhat idiomatic for equality/ordering traits
[09:49:54] <meyer> Is that different than type TotalOrdFileStat = FileStat;?
[09:49:55] <meyer> Or
[09:49:59] <eddyb> it is
[09:50:00] <meyer> Does that only work for function types?
[09:50:09] <eddyb> type is just a type alias
[09:50:22] <eddyb> the two names are for the same type, FileStat
[09:50:38] <eddyb> what I gave you is a tuple struct with one field, aka a newtype
[09:50:49] <meyer> Thanks
[09:50:53] <meyer> If you happen to know
[09:51:09] <meyer> Why can't I use just a type alias, and why is it an issue in the first place?
[09:51:43] <eddyb> as I've said a type alias is *just* an alias, it changes nothing
[09:52:03] *** Joins: t4nk249 (bzlandfill@moz-833C28A3.hsd1.va.comcast.net)
[09:52:24] <meyer> But a struct with a single field is the same in memory, isn't it? As in, if I were to unsafely cast between them, it would work?
[09:52:33] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[09:52:40] <eddyb> sure
[09:53:01] <eddyb> it's a thin wrapper that you can attach semantical differences to
[09:53:26] <meyer> Alright.
[09:53:27] <eddyb> and the other thing is an issue because imagine what would happen if 3 crates would have orphan impls (impl Trait for Type where both Trait and Type are outside the crate the impl is in) for the same trait/type pair
[09:53:44] <eddyb> you couldn't use those crates toghether
[09:54:12] *** Quits: nomme (nomme@moz-A30B1161.a336.priv.bahnhof.se) (Ping timeout)
[09:54:13] *** Quits: jclements (jclements@moz-440F24A8.lightspeed.mtryca.sbcglobal.net) (Quit: jclements)
[09:54:27] *** Joins: Guest (textual@moz-D0D2522.host.hu.nl)
[09:54:29] <meyer> I should probably read up on method dispatch in Rust before I try to understand why this is an issue
[09:54:33] <meyer> Thanks for the help!
[09:54:39] <eddyb> it's not related to method dispatch
[09:55:19] *** Joins: ecr (chatzilla@E940BDD3.FBC7597F.11F8506F.IP)
[09:55:20] <eddyb> it would require us to deny certain crates being used together, if they would use those orphan impls (which are forbidden now)
[09:55:40] *** Joins: richard|s (mindginati@moz-A13DCAA3.dyn.cust.vf.net.nz)
[09:55:48] <t4nk249> hey eddyb
[09:55:52] <meyer> But why wouldn't using "type" to alias types work, then?
[09:56:00] <meyer> The compiler would be able to tell the difference
[09:56:02] <eddyb> type only aliases
[09:56:04] <meyer> Between each implementation
[09:56:10] <t4nk249> so I was doing cache: LruCache::new(50), but that seems to give me errors 
[09:56:11] *** Joins: dave1629_ (dave@moz-17578A1A.hsd1.va.comcast.net)
[09:56:17] <meyer> Or no? Is that discarded?
[09:56:18] <eddyb> meyer: there is no difference between the alias and the original type
[09:56:29] <eddyb> that's what I'm trying to tell you :P
[09:56:40] <t4nk249> along the lines of "error: `self` is not allowed in this context"
[09:56:42] <eddyb> it's like a typedef, except with even less differences
[09:56:59] <eddyb> t4nk249: are you in Server::new?
[09:56:59] <meyer> Ah. Alright.
[09:57:03] <t4nk249> self.cache.put(path,File::open(path));
[09:57:21] <t4nk249> exactly
[09:57:25] <eddyb> meyer: that's why it's "alias" and not "newtype" (which you can create with tuple structs)
[09:57:39] <t4nk249> well that's where I did "cache: LruCache::new(50),"
[09:57:41] <t4nk249> which is fine
[09:57:42] <eddyb> t4nk249: there is no self, only maybe a local variable in which you have created a Server
[09:58:02] <t4nk249> ugh
[09:58:04] <eddyb> let mut server = Server {...}; server.cache.put(...);
[09:58:05] <t4nk249> you are right
[09:58:10] <t4nk249> why am I so dumb
[09:58:15] <eddyb> and then just server at the end to return it
[09:58:15] <t4nk249> its so late
[09:58:22] <meyer> eddyb: Alright. That makes sense. 
[09:58:41] <eddyb> the crate conflict is pretty much the only reason against the orphan impls - also see http://www.haskell.org/haskellwiki/Orphan_instance
[09:59:21] <eddyb> Haskell type class => Rust trait, Haskell instance => Rust impl
[10:00:10] <t4nk249> eddyb
[10:00:17] <t4nk249> should I wrap the cache with an arc?
[10:00:30] <eddyb> do you want to share it with other tasks?
[10:00:32] <t4nk249> it will be accessed by multiple tasks
[10:00:34] <t4nk249> yes
[10:00:37] <t4nk249> it's a cache
[10:00:39] <eddyb> use RWArc then
[10:00:41] <t4nk249> so I think that it should be
[10:00:41] <t4nk249> ok
[10:00:47] <t4nk249> not mutex?
[10:00:52] <eddyb> that has a RWLock, so you can read from multiple tasks
[10:01:00] <eddyb> only locks when writing
[10:01:13] <t4nk249> gotcha!
[10:01:15] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Quit: Busying myself...)
[10:01:37] *** Joins: patpat (patpat@9E957BB5.933C45AA.98F3E2B5.IP)
[10:01:45] <eddyb> MutexArc is rarely useful, IMO. not sure if it's more performant than a RWArc... maybe we could remove it?
[10:02:08] *** Joins: alexherbo2 (alexherbo2@moz-2B1B8045.w83-199.abo.wanadoo.fr)
[10:02:09] <eddyb> Arc<Mutex<T>> would then be the way to do the same thing, if you still need it
[10:02:12] <t4nk249> if it's not adding more
[10:02:15] <t4nk249> then ya remove it
[10:02:21] <eddyb> can't wait for those shiny new kinds
[10:02:27] <t4nk249> eddyb
[10:02:32] <t4nk249> are you in the dev team?
[10:02:38] <eddyb> t4nk249: just a contributor
[10:02:39] <t4nk249> for rust
[10:02:41] <t4nk249> oh ok
[10:02:47] <t4nk249> awesome
[10:02:55] <jroweboy> eddyb: I just barely finished replacing my mut statics with a Mutex arc though :'(
[10:03:06] <eddyb> jroweboy: why not RWArc?
[10:03:14] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[10:03:32] <meyer> eddyb: (Thanks again, I'm heading out)
[10:03:33] <jroweboy> Because someone on IRC suggested a MutexArc :) I actually don't know the difference
[10:03:46] <eddyb> jroweboy: the difference is that RWArc lets you read concurrently
[10:03:49] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[10:03:50] *** Quits: meyer (Mibbit@moz-A9CF56E4.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[10:03:51] <jroweboy> I'm guessing the RWArc allows many readers
[10:03:55] <jroweboy> but locks for write
[10:04:02] <eddyb> yupp. less contention on the lock
[10:04:14] <eddyb> (if that's the right word. I dunno. I just pick up terminology as I go :P)
[10:04:28] <eddyb> t4nk249: being able to give &ThreadSafeContainer to other tasks and mutate it, that's cool. no need for atomically ref-counting heap allocations
[10:04:38] <eddyb> parallel hash maps - boy oh boy
[10:04:52] *** Quits: jviereck (Adium@moz-5F2A758D.ethz.ch) (Quit: Leaving.)
[10:05:01] <jroweboy> That is actually much better for my application. I think I'll switch now that I know about RWArc
[10:05:05] <t4nk249> uh crap
[10:05:07] <t4nk249> i get an error
[10:05:11] <t4nk249> with "freeze
[10:05:13] <t4nk249> so I'm doing this
[10:05:14] <t4nk249> cache: RWArc<LruCache<~Path, Option<File>>>
[10:05:23] <t4nk249> in the struc
[10:05:25] <t4nk249> struct*
[10:05:30] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[10:05:33] <eddyb> I wonder if File is shareable
[10:05:50] <eddyb> well, no Share yet. but Send+Freeze now
[10:06:08] <t4nk249> i am using rust 0.9
[10:06:14] *** Joins: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com)
[10:06:15] <t4nk249> (not 0.10)
[10:06:35] <eddyb> t4nk249: and this? http://static.rust-lang.org/doc/0.9/std/io/fs/struct.File.html
[10:06:50] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[10:06:52] <t4nk249> that's what I'm using
[10:07:06] <eddyb> ohh that's actually sendable. cool
[10:07:11] <eddyb> so must be the LruCache
[10:07:16] <t4nk249> ya it's sendable
[10:07:26] <t4nk249> but I don't know what freeze means
[10:07:35] <t4nk249> as in "lock?"
[10:07:40] <eddyb> &T with T freeze cannot change its contents
[10:07:44] <t4nk249> ok
[10:07:46] <eddyb> * Freeze
[10:07:54] *** Quits: Tobba (Tobba@moz-462B7F7F.ias.bredband.telia.com) (Ping timeout)
[10:08:01] <t4nk249> so what do you suggest?
[10:08:01] <eddyb> if it's not Freeze, you can have something like Cell or RefCell, mutating through &
[10:08:10] <t4nk249> hm
[10:08:11] <eddyb> where's the LruCache docs?
[10:08:20] <t4nk249> well there's no docs but there's this
[10:08:32] <t4nk249> http://static.rust-lang.org/doc/0.9/extra/lru_cache/struct.LruCache.html
[10:08:44] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[10:08:49] <eddyb> http://static.rust-lang.org/doc/0.9/src/extra/home/rustbuild/scratch/rust/src/libextra/lru_cache.rs.html#56-61
[10:08:51] <eddyb> bah!
[10:08:51] <t4nk249> but it's lacking description
[10:08:56] <eddyb> looks freeze
[10:09:07] <eddyb> *Freeze I should say (to not confuse you)
[10:09:10] *** Quits: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net) (Quit: killerswan)
[10:09:22] <eddyb> t4nk249: so what's the actual error?
[10:09:28] <eddyb> maybe it's pointing at something else
[10:09:45] *** Quits: wilmoore (wilmoore@moz-71431C3A.hsd1.co.comcast.net) (Ping timeout)
[10:09:54] <t4nk249> ok
[10:09:57] <t4nk249> let me copy it
[10:09:58] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[10:10:13] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[10:10:32] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[10:10:36] *** Joins: ziad (ziad@moz-C0318336.hsd1.ca.comcast.net)
[10:10:39] <t4nk249> error: instantiating a type parameter with an incompatible type `extra::lru_cache::LruCache<~std::path::posix::Path,std::option::Option<std::io::fs::File>>`, which does not fulfill `Freeze`
[10:10:50] <t4nk249> path?
[10:11:44] <t4nk249> can I put a unsafe block in structs?
[10:11:51] <eddyb> hehe no
[10:11:54] <t4nk249> lol
[10:12:26] *** Joins: aepsil0n (eduard@moz-B5507714.hsi8.kabel-badenwuerttemberg.de)
[10:12:31] <eddyb> someone is working on better error messages for that btw
[10:12:39] <t4nk249> awesome
[10:12:49] <t4nk249> i mean, it's not awful
[10:12:52] <t4nk249> not like gcc
[10:12:53] <eddyb> with paths to the thing that is causing the entire thing to not be Freeze
[10:12:53] <t4nk249> hahaha
[10:12:59] <eddyb> too many "thing"s sorry
[10:13:06] <eddyb> t4nk249: lol GCC
[10:13:13] <t4nk249> our favorite compiler
[10:13:18] <eddyb> I remember what a big deal clang's nice errors were
[10:13:24] <t4nk249> yea
[10:13:29] <eddyb> http://static.rust-lang.org/doc/0.9/src/std/home/rustbuild/scratch/rust/src/libstd/path/posix.rs.html#42-45
[10:13:36] <eddyb> looks Freeze to me. so wtf?
[10:14:00] <t4nk249> wtf
[10:14:16] *** Joins: jviereck (Adium@moz-8B8C3A96.ethz.ch)
[10:14:19] <eddyb> t4nk249: you can create a small file
[10:14:19] *** Joins: hansjorg (hansjorg@moz-41C5CE61.redpill-linpro.com)
[10:14:30] <eddyb> fn test<T: Freeze>(){}
[10:14:34] <t4nk249> lso
[10:14:37] <t4nk249> also*
[10:14:42] <t4nk249> let cache = self.cache.clone();
[10:14:46] <t4nk249> also blows up in a same way
[10:14:49] <t4nk249> but here there is a self
[10:14:54] <eddyb> fn main() {test::<File>();}
[10:14:59] <t4nk249> fn listen(&mut self) 
[10:15:05] *** Quits: josh (josh@moz-C1D9FC5F.meeting.ietf.org) (Quit: josh)
[10:15:17] <eddyb> you can probe types until you find the culprit
[10:15:25] <t4nk249> ?
[10:15:32] <t4nk249> what do you mean?
[10:15:40] <eddyb> fn test<T: Freeze>(){} fn main() {test::<File>();}
[10:15:42] <eddyb> try to compile that
[10:15:49] <eddyb> it will check whether File is Freeze
[10:15:59] <t4nk249> in a new file?
[10:16:01] <eddyb> yupp
[10:16:16] <eddyb> I don't have 0.9 otherwise I'd pipe that with echo and check myself :D
[10:17:19] <jroweboy> quick question, but does anything weird stick out to you about my constructor here? https://github.com/jroweboy/oxidize/blob/master/src/oxidize.rs#L102
[10:17:27] <t4nk249> so I did this
[10:17:31] <t4nk249> "use std::io::fs::File;  fn test<T: Freeze>(){} fn main() {test::<File>();}"
[10:17:35] <t4nk249> made that file
[10:17:36] <t4nk249> and I get
[10:17:44] <t4nk249> error: instantiating a type parameter with an incompatible type `std::io::fs::File`, which does not fulfill `Freeze` test.rs:3 fn test<T: Freeze>(){} fn main() {test::<File>();}
[10:17:46] <t4nk249> so.....
[10:18:00] <eddyb> check Path
[10:18:12] <eddyb> File includes Path in it
[10:18:27] <jroweboy> looking at gdb, the code gets to this constructor, and then starts to call unwind which makes me think that it has the issue in those lines of code
[10:18:39] <eddyb> although... priv fd: ~RtioFileStream // I think I assumed that's Freeze and it may not be :/
[10:20:01] <t4nk249> what do you mean?
[10:20:05] <t4nk249> check Path?
[10:20:21] <eddyb> nevermind
[10:20:24] <t4nk249> OH
[10:20:25] <t4nk249> sorry
[10:20:27] <kimundi> jroweboy: Nothing in that function should cause unwinding that I know of... I'd suspect compile_routes
[10:20:28] <t4nk249> ya I can check it
[10:20:43] <eddyb> rusti: fn is_freeze<T: Freeze>(){} is_freeze::<~Clone>();
[10:20:44] -rusti- <anon>:10:37: 10:56 error: instantiating a type parameter with an incompatible type `~std::clone::Clone:Send`, which does not fulfill `Freeze`
[10:20:45] -rusti- <anon>:10         fn is_freeze<T: Freeze>(){} is_freeze::<~Clone>();
[10:20:45] -rusti-                                               ^~~~~~~~~~~~~~~~~~~
[10:20:45] -rusti- error: aborting due to previous error
[10:20:45] -rusti- application terminated with error code 101
[10:20:48] <eddyb> rusti: fn is_freeze<T: Freeze>(){} is_freeze::<~Clone:Freeze>();
[10:20:49] -rusti- ()
[10:20:55] *** Joins: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[10:21:00] <eddyb> t4nk249: it's in the File code itself :(
[10:21:02] <kimundi> jroweboy: That is, nothing apart from the call to compile_routes would cause a unwind, I mean
[10:21:08] <t4nk249> :(
[10:21:11] <t4nk249> so
[10:21:17] <t4nk249> what do you suggest?
[10:21:29] <t4nk249> how can I use this LRUcache?
[10:21:42] <t4nk249> sorry if that's a vague question
[10:21:55] <eddyb> why do you need the File there?
[10:22:00] <t4nk249> maybe I don't
[10:22:02] <t4nk249> you are right
[10:22:07] <t4nk249> Here's my reasoning
[10:22:09] <jroweboy> kimundi: I didn't see it on the call stack at the error, so I didn't think that it would be, but at the same time I see what you mean. Hmm... well... I'll work on it tommorw, its far too late to think right now. Thanks!
[10:22:10] <eddyb> that's how you solve problems :P
[10:22:20] <t4nk249> rofl
[10:22:23] *** Joins: cceckman (cceckman@moz-135DFDD5.bootp.virginia.edu)
[10:22:27] <t4nk249> but this is why I thought I needed it
[10:22:45] <eddyb> opening a File is cheap compared to reading it. you don't need to cache anything at that point
[10:22:51] <eddyb> because the OS is already caching the FS
[10:22:55] <t4nk249> right
[10:22:59] <eddyb> and/or the raw blocks of your HDD
[10:23:02] <t4nk249> so what should my value be?
[10:23:11] <t4nk249> right I mean my computer is already caching it
[10:23:15] <t4nk249> my path?
[10:23:18] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Client exited)
[10:23:19] <eddyb> ~[u8] if you want to hold the entire files in memory
[10:23:21] <t4nk249> and what would be my value?
[10:23:21] *** Quits: Guest (textual@moz-D0D2522.host.hu.nl) (Quit: Computer has gone to sleep.)
[10:23:33] <t4nk249> is that a good idea?
[10:23:39] <eddyb> caching is good when there's something to do, like apply syntax highlighting to code files
[10:23:47] <t4nk249> so let me ask you this
[10:23:54] <t4nk249> the capacity in the LRU cache
[10:23:56] <t4nk249> is not based on size
[10:24:02] <t4nk249> it's based on the number of items
[10:24:05] <eddyb> yupp
[10:24:11] <t4nk249> so what if the stuff is really large
[10:24:13] <eddyb> you have to cap manually based on RAM etc. if you want that
[10:24:25] <t4nk249> how?
[10:24:33] <eddyb> I'm not even sure we have an easy way of checking the used/available memory in std
[10:24:34] <jroweboy> kimundi: yep you are correct :) I put a println at the start and end of compile_routes and it only prints the start
[10:24:50] <t4nk249> so maybe
[10:24:50] <eddyb> it varies from OS to OS
[10:24:53] <t4nk249> right
[10:24:54] <t4nk249> i'm sure
[10:24:58] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Ping timeout)
[10:25:04] <t4nk249> but that might end up with buggy code
[10:25:10] <t4nk249> basically 
[10:25:17] <eddyb> you should cap it at 256MB total RAM usage or something like that
[10:25:23] <t4nk249> right, that's how I would
[10:25:26] <t4nk249> make the cache
[10:25:26] <eddyb> config/command line flag if you want flexibility
[10:25:28] <t4nk249> honestly
[10:25:35] <t4nk249> not based on items, but based of size
[10:25:39] <kimundi> ah, good old println debugging... best kind of debugging.
[10:26:00] <eddyb> t4nk249: you can add/subtract from a total as you go, I think. unless the LRU cache doesn't provide feedback when it drops things
[10:26:02] <t4nk249> but ya like i guess I could do that
[10:26:35] *** Quits: jroweboy (Mibbit@moz-18814A6B.provo.static.broadweavenetworks.net) (Quit: http://www.mibbit.com ajax IRC Client)
[10:26:46] <t4nk249> also the LRU cache
[10:26:52] <t4nk249> does it's own eviction
[10:27:00] <t4nk249> like I won't need to worry about it right?
[10:27:19] <kimundi> eddyb: Btw did Deref land?
[10:27:27] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[10:27:31] <eddyb> t4nk249: want to be safe? struct CachedData {total: RWArc<uint>, data: ~[u8]} impl Drop for CachedData {fn drop(&mut self) {self.total.write(|total| *total -= self.data.len())}}
[10:27:37] *** Joins: mawuli (mawuli@moz-A89BBCE.com.gh)
[10:27:39] <eddyb> RAII ^^
[10:28:04] <eddyb> t4nk249: that way, when the LRU cache drops extra entries, they will subtract themselves from the total
[10:28:15] <t4nk249> o
[10:28:18] <eddyb> not sure if Arc<AtomicUint> works yet, that would be even better :P
[10:28:25] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[10:28:30] <eddyb> kimundi: the first patch
[10:28:36] <eddyb> not the automatic overloaded one
[10:28:46] <t4nk249> it sort of works
[10:28:46] <eddyb> kimundi: nmatsakis will review today
[10:28:47] <t4nk249> i tried it
[10:28:53] <t4nk249> but RWArc is better
[10:29:00] <t4nk249> or what I want do here
[10:29:12] *** Joins: Ms2ger (Ms2ger@moz-394FABD5.ugent.be)
[10:29:19] *** Joins: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net)
[10:29:19] *** ChanServ sets mode: +o huon
[10:29:22] <eddyb> t4nk249: did you understand the Drop magic above? or was I just confusing noise?
[10:29:34] <t4nk249> i'm trying to understand it
[10:29:39] <t4nk249> so at a high level
[10:29:50] <t4nk249> you are saying that
[10:29:51] <eddyb> it's a destructor, if you know other OOP languages
[10:29:53] *** Joins: onix (Mibbit@moz-AA65C711.lns20.adl2.internode.on.net)
[10:30:06] <t4nk249> ya I know java and python
[10:30:20] <t4nk249> ya I'm familiar with destructors but they aren't really emphasized in java
[10:30:29] <eddyb> leak all the things!
[10:30:34] <t4nk249> lol
[10:30:44] <t4nk249> but I know destructors from c++
[10:30:52] <kimundi> eddyb: Ah, so explicit * works, but not implicit? Or is this just necessary groundwork?
[10:30:57] <t4nk249> and i have used valgrid etc
[10:31:02] <t4nk249> to debug leaks
[10:31:04] <eddyb> kimundi: yupp
[10:31:17] <eddyb> implementing Drop just *adds* something more to do when the structure is destroyed
[10:31:21] <t4nk249> so you created CachedData
[10:31:23] *** Quits: brson (brson@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: leaving)
[10:31:32] <eddyb> before its fields are destroyed
[10:31:43] <t4nk249> why is it neccessary?
[10:31:53] <eddyb> to subtract from the total used size
[10:31:59] *** Joins: awidegreen (awidegreen@moz-DAF62FE3.dip0.t-ipconnect.de)
[10:32:03] <eddyb> since you don't know when the LruCache will drop things
[10:32:17] <eddyb> to make room for new entries
[10:32:27] <t4nk249> so I'm supposed to use this
[10:32:30] <t4nk249> with LruCache
[10:32:31] <t4nk249> ?
[10:32:40] <t4nk249> i'm not sure how LruCache will know
[10:32:41] <eddyb> LruCache<Path, CachedBuffer> or something like that
[10:32:53] *** Joins: Guest (textual@moz-D0D2522.host.hu.nl)
[10:33:01] <eddyb> LruCache just drops things, causing the Drop impl to be called
[10:33:07] <eddyb> standard destructor practice
[10:33:32] <t4nk249> OH
[10:33:40] <t4nk249> so basically we do so 
[10:33:48] <t4nk249> we can check whether
[10:33:53] <t4nk249> the cache is full based on it's size
[10:34:02] <t4nk249> and if it is, then we won't
[10:34:14] *** Quits: Guest (textual@moz-D0D2522.host.hu.nl) (Quit: Computer has gone to sleep.)
[10:34:22] <t4nk249> so I need to update 
[10:34:26] <t4nk249> cachceddata
[10:34:34] <t4nk249> cacheddata
[10:34:37] *** Joins: claudiu (claudiu@81B10C62.5F4BC945.49B2C1AE.IP)
[10:34:53] <t4nk249> ya... don't think I got it
[10:35:08] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[10:35:08] <eddyb> bleah, I'm not sure this will work quite nicely
[10:35:11] <eddyb> I mean, detecting a limit
[10:35:22] <t4nk249> right
[10:35:24] <eddyb> you'd end up not inserting anything when the cache is full-ish
[10:35:25] <t4nk249> ok suppose
[10:35:30] <eddyb> which is bad
[10:35:33] <t4nk249> right
[10:35:43] <t4nk249> ok so suppose this
[10:35:47] <eddyb> does the cache have a way to get the oldest item?
[10:35:51] <t4nk249> assuming this isn't an issue
[10:35:54] <t4nk249> like the files are 
[10:35:57] <t4nk249> aren't like 2gb
[10:36:01] <eddyb> hehe
[10:36:03] <t4nk249> lol
[10:36:09] <t4nk249> i'm doing hhtpperf
[10:36:14] <t4nk249> and the largest file is 512 mb
[10:36:22] <eddyb> you can check whether total + candidate - oldest > max_allowed
[10:36:25] <eddyb> that's saner
[10:36:34] <t4nk249> ahh
[10:36:37] <t4nk249> wait, that is saner lol
[10:36:51] <eddyb> but only if oldest will be removed when you insert candidate
[10:37:00] <t4nk249> it's still not comprehensize
[10:37:02] <eddyb> so only subtract oldest if the LR cache is full
[10:37:05] <t4nk249> it's still not comprehensiv*e
[10:37:07] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[10:37:08] <eddyb> *LRU
[10:37:17] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[10:37:21] <eddyb> (full, as in filled with items, nothing to do with memory usage)
[10:37:24] <t4nk249> i will have to keep track of oldest?
[10:37:31] <eddyb> the cache should have a method for it
[10:37:31] <t4nk249> right I know what you meant
[10:37:50] <doomlord_> this is driving me up the wall 
[10:38:01] <doomlord_> this worked yesterday :(
[10:38:03] <t4nk249> I don't see it
[10:38:06] <eddyb> t4nk249: I am learning alongside you
[10:38:08] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[10:38:12] <eddyb> strcat would totally know better
[10:38:14] <t4nk249> i appreciate it
[10:38:25] <t4nk249> eddyb, i don't mean tto put you on the spot
[10:38:28] <t4nk249> or anything
[10:38:47] <eddyb> t4nk249: okay, so cache.len() == cache.capacity() will tell you whether it's full
[10:38:50] <t4nk249> OK how about this
[10:38:57] <t4nk249> i just do a sanity check
[10:39:02] <t4nk249> before adding to cache
[10:39:04] <eddyb> but it doesn't give you a way to get the oldest :/
[10:39:21] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Ping timeout)
[10:39:31] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[10:39:49] <t4nk249> right
[10:39:51] <t4nk249> ok that's cool
[10:39:54] <t4nk249> but here's what I'm thinking
[10:40:04] *** Joins: claudiu_ (claudiu@CB447DD5.6B10AC3.E2F59BBC.IP)
[10:40:10] <t4nk249> can I just give you a high level idea
[10:40:15] <t4nk249> of what I'm thinking
[10:40:26] *** Quits: ecr (chatzilla@E940BDD3.FBC7597F.11F8506F.IP) (Ping timeout)
[10:40:27] <t4nk249> not worrying about large files 
[10:40:32] *** Quits: claudiu (claudiu@81B10C62.5F4BC945.49B2C1AE.IP) (Ping timeout)
[10:40:33] <t4nk249> tell me if it makes sense
[10:40:46] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[10:41:10] <t4nk249> so basically I have a function called "respond" which takes in a stream, and the path to the file
[10:41:26] *** Joins: enes (enes@94A2F410.98B711F4.86C678D5.IP)
[10:41:28] <t4nk249> (static files, aka paths to local files)
[10:41:40] <t4nk249> so to really optimize it
[10:41:50] <t4nk249> I should cache the actual files (the data in it)
[10:42:06] <eddyb> don't forget to try http://localhost:8080/../../../../../../../etc/passwd
[10:42:18] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[10:42:18] *** Quits: enes (enes@94A2F410.98B711F4.86C678D5.IP) (Quit: Leaving...)
[10:42:27] <t4nk249> ok
[10:42:34] <eddyb> since the most naive designs are vulnerable to LFI :P
[10:42:38] <t4nk249> why would I try psswd?
[10:42:39] <t4nk249> lol
[10:42:44] <t4nk249> ok
[10:42:47] <t4nk249> good idea
[10:42:54] <t4nk249> but so if I understand LruCache right
[10:43:00] <t4nk249> I need to actually use put
[10:43:12] <t4nk249> to put the (path,data) pair
[10:43:15] <t4nk249> in it
[10:43:19] <t4nk249> and then use get
[10:43:28] <t4nk249> err no
[10:43:30] <t4nk249> I first do get
[10:43:32] <t4nk249> if I get None
[10:43:35] <t4nk249> then I put it
[10:43:37] <t4nk249> right?
[10:43:53] <eddyb> yupp
[10:44:03] <t4nk249> how about this
[10:44:06] <t4nk249> I just do a sanity check lol
[10:44:18] <t4nk249> if the data is > 128MB
[10:44:23] <eddyb> instead of doing relative(http_dir, get_path), you should do relative(http_dir, absolute(get_path)) or something like that to remove the .., as if you were doing /../..  - that's just my two cents
[10:44:23] <t4nk249> don't add it to cache
[10:44:28] <eddyb> good idea
[10:44:38] <t4nk249> if it's larger
[10:44:39] <eddyb> I think that's what other web servers do
[10:44:41] <t4nk249> just load from disk
[10:44:49] <t4nk249> oh really? 
[10:44:59] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[10:45:03] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[10:45:07] <eddyb> a limit on the file size
[10:45:11] <t4nk249> yea
[10:45:16] <t4nk249> seems like a very sane idea lol
[10:45:22] <eddyb> I mean, I may have seen this in the apache config
[10:45:37] <t4nk249> technically
[10:45:39] *** Quits: trobertson (quassel@moz-A4AC319.sd.sd.cox.net) (Connection reset by peer)
[10:45:44] <t4nk249> this LruCache is application level
[10:45:45] <eddyb> oh and you need to check timestamps :P
[10:45:50] <t4nk249> so it's really just caching it in RAM
[10:45:54] <eddyb> yupp
[10:46:00] <t4nk249> crap
[10:46:08] <t4nk249> i was hoping LruCache
[10:46:12] <t4nk249> does the timestamp checks
[10:46:21] <eddyb> LruCache is just a container
[10:46:33] <eddyb> nothing to do with files
[10:46:35] <eddyb> or paths
[10:46:35] <t4nk249> you mean it's not a magic black box (sarcasm)
[10:46:36] <t4nk249> lol
[10:46:38] <t4nk249> ya
[10:46:41] <t4nk249> makes sense
[10:46:48] <t4nk249> shit
[10:46:55] <t4nk249> timestamps...
[10:47:01] <eddyb> I'm like an evil prof now
[10:47:11] <eddyb> just a few months ago I was the victim
[10:47:16] <t4nk249> hahaha no
[10:47:16] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[10:47:21] <t4nk249> you are a helpful prof
[10:47:32] <t4nk249> but ya I gotta do time stamps
[10:47:33] <t4nk249> obviously
[10:47:38] <eddyb> you thought you could get this done by 4am?
[10:47:40] <eddyb> NOPE
[10:47:40] <t4nk249> no
[10:47:45] <t4nk249> i got till 12:am
[10:47:49] <t4nk249> and this is the only part left
[10:47:51] <t4nk249> the cache
[10:47:56] <eddyb> have some more work tasks!
[10:48:03] <t4nk249> but i mean it's not a lot lines
[10:48:17] <t4nk249> but of course, i'm newbie in rust
[10:48:28] *** Joins: ganitsu (ganitsu@moz-5FF1A2BC.dialup.adsl.anteldata.net.uy)
[10:48:32] <t4nk249> so everything takes longer
[10:48:47] <t4nk249> haha ya honestly
[10:48:50] <t4nk249> i'm gonna be up
[10:48:53] <t4nk249> until I get it
[10:48:56] <t4nk249> i'm stubborn like that
[10:49:09] <eddyb> what was I doing an hour ago? ah, removing @ from librustc. by first adding more. totally legit
[10:49:27] <t4nk249> hahaha
[10:49:34] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[10:49:35] <t4nk249> yes, that's a good way to do things
[10:49:47] <t4nk249> let me just go ahead and clean this code up... wait a second
[10:50:11] <eddyb> type Session = @Session_; I renamed Session_ to Session and then replaced Session with @Session
[10:50:22] <eddyb> it's actually a noop step so I can see the @ ;)
[10:50:32] <t4nk249> lol
[10:50:33] <eddyb> if you, like, want to know what you interrupted
[10:50:42] <eddyb> context switches!
[10:50:52] <t4nk249> just gotta make sure
[10:50:54] <t4nk249> people know it
[10:51:13] <t4nk249> but it's readable enough
[10:51:13] <t4nk249> so 
[10:51:20] <eddyb> well, I'm going to now replace those @ with &
[10:51:33] <t4nk249> any hints
[10:51:37] <t4nk249> on how to get timestamps?
[10:51:38] <eddyb> twenty more structures will have <'a> on them
[10:51:42] <eddyb> t4nk249: FileStat
[10:51:47] <t4nk249> DONE
[10:51:51] <t4nk249> right right
[10:51:55] <t4nk249> ok
[10:52:26] <t4nk249> so I need to store the path, time stamp
[10:52:33] <t4nk249> and data
[10:52:59] <t4nk249> can I make the key like (path stamp) (space delim)
[10:53:08] <t4nk249> is that a good idea? lol
[10:53:16] <eddyb> leave only the path in the key
[10:53:20] <eddyb> put the timestamp in the value
[10:53:25] <t4nk249> not the data?
[10:53:37] <eddyb> LruCache<Key, Value>
[10:53:45] <t4nk249> no i know what you are saying
[10:53:52] <t4nk249> but I want faster access to data
[10:53:53] *** Quits: richard|s (mindginati@moz-A13DCAA3.dyn.cust.vf.net.nz) (Quit: brb)
[10:54:08] <eddyb> you can structure the value type any way you want
[10:54:08] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[10:54:10] <t4nk249> so how will I do that if the Value is not the Data in bytes
[10:54:23] <eddyb> tuple, tuple struct, regular struct
[10:54:32] <eddyb> enum if you have multiple types of cache entries etc.
[10:54:39] <t4nk249> ok so 
[10:54:49] <t4nk249> so path in key
[10:54:58] <t4nk249> and then make the value a tupe of timestamp and data?
[10:55:12] <eddyb> sure
[10:55:30] <t4nk249> in tuple in rust just (x,y)
[10:55:35] <t4nk249> like in python
[10:55:36] <eddyb> yuss
[10:55:39] <t4nk249> awesome
[10:55:48] <t4nk249> let me go try this
[10:57:09] *** Quits: nkoep (nik@moz-10914ED.pool.mediaways.net) (Client exited)
[10:57:31] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[10:57:50] *** Quits: patpat (patpat@9E957BB5.933C45AA.98F3E2B5.IP) (Ping timeout)
[11:00:33] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[11:01:31] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[11:02:13] *** Joins: maximilian (max@moz-493D272A.ethz.ch)
[11:02:37] <maximilian> anybody awake?
[11:02:45] <Ms2ger> Nope
[11:02:58] <maximilian> I've been googling a bit, but I'm not quite sure on the status of calling out from C to rust
[11:03:21] <huon> #[no_mangle] pub extern "C" fn foo() { ... }
[11:03:27] <maximilian> I'm writing a horrible fortran program, and I would like to try using rust for a few bits
[11:03:36] <maximilian> how to link?
[11:03:39] <huon> will crate a `foo` symbol in the compiled library
[11:03:45] <huon> compile with either...
[11:03:49] * huon checks the exact invocation
[11:04:02] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[11:04:21] <huon> --crate-type dylib (to get a dynamic lib, e.g. .so on linux, .dll on windows)
[11:04:22] <eddyb> will crate?
[11:04:26] <eddyb> teehee
[11:04:33] <maximilian> possible to create static lib?
[11:04:35] <huon> --crate-type staticlib to get a .a
[11:04:38] <maximilian> awesome
[11:05:11] <huon> only a subset of libstd is usable without starting a runtime
[11:05:20] *** Joins: patpat (patpat@9E957BB5.933C45AA.98F3E2B5.IP)
[11:05:29] <huon> (you can start a runtime inside a C callback, though)
[11:05:30] <maximilian> is starting a runtime possible?
[11:05:33] <huon> yeah
[11:05:45] <eddyb> it's better if you start the runtime on initialization
[11:05:48] <huon> http://static.rust-lang.org/doc/master/native/index.html
[11:06:10] <huon> native::start(argv, argc, proc() { ... })
[11:06:24] <eddyb> something like my_rusty_project_init called from C that starts the native runtime on the current thread
[11:06:30] <huon> will block until the proc has quit and any spawned tasks are dead
[11:06:33] <eddyb> you may need a callback from C though
[11:06:49] <huon> eddyb: creating a runtime blocks
[11:07:15] <eddyb> so my_rusty_project_with_runtime(function_to_call_rust_stuff_from_c_in)
[11:07:16] <maximilian> blocks until runtime is started, or just blocks until runtime isn't needed anymore?
[11:07:17] <huon> having a background rust runtime will need to create a new thread for it
[11:07:33] <huon> maximilian: blocks until the Rust code running inside the runtime has finished
[11:07:34] <eddyb> maximilian: blocks until the code needing the runtime exists
[11:07:38] <eddyb> *exits
[11:08:00] <eddyb> so you have to run the relevant code within its proc, otherwise you'll lose the runtime
[11:08:01] <huon> much of lib standard is independent of the runtime
[11:08:07] <eddyb> which is nice
[11:08:10] <huon> even channels for communication
[11:08:21] <eddyb> it's mostly IO that uses the runtime
[11:08:27] <eddyb> and spawning new tasks
[11:08:27] <huon> the major thing that's not is complicated IO and task spawning
[11:08:35] <huon> (println!() still works though)
[11:08:45] <eddyb> sane fallbacks <3
[11:08:46] * huon and eddyb repeat each other
[11:09:04] <eddyb> the Lich King and I are one
[11:09:23] <huon> I'm the lich king? :S
[11:09:47] <eddyb> you're the older one, I guess so
[11:10:14] <huon> only slightly
[11:10:27] <eddyb> oh, right. silly me :P
[11:12:44] *** Joins: nomme (nomme@moz-FED8EFBC.a336.priv.bahnhof.se)
[11:13:34] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[11:15:32] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[11:16:30] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[11:19:34] <maximilian> ok, so I put together a demo, but when compiling/linking it all together with gcc, I get a bunch of linker errors, "std.rs:(.text+0x9933d): undefined reference to `pthread_join'"
[11:19:36] <maximilian> etc
[11:20:12] *** Joins: q66 (q66@moz-8A2AC0E.dab.02.net)
[11:20:38] <huon> maximilian: -lpthread
[11:20:49] <huon> passed to gcc
[11:20:51] *** Joins: io2 (io2@moz-EE406A5.home.otenet.gr)
[11:22:12] <maximilian> cool it works
[11:22:13] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[11:22:18] <maximilian> gcc test_include.c test.a -lpthread -lm -ldl -o test
[11:22:25] <huon> \o/
[11:22:29] <maximilian> needed pthread, math functions, and -ldl
[11:22:32] <maximilian> for dlopen
[11:22:33] <maximilian> etc
[11:23:49] <maximilian> if I want to pass in a "vector" (pointer to array in C), what type do I use?
[11:24:05] <maximilian> or is there a page with types for the ffi?
[11:24:08] <huon> *T or *mut T
[11:24:12] *** Joins: hhhhhhhhhh (mike@moz-E08362B7.stcatz.ox.ac.uk)
[11:24:14] <huon> there's http://static.rust-lang.org/doc/master/guide-ffi.html
[11:24:21] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[11:24:25] *** Quits: glaebhoerl (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Connection reset by peer)
[11:24:33] <huon> and http://static.rust-lang.org/doc/master/std/libc/index.html with a pile of type aliases
[11:24:34] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[11:24:50] <huon> (e.g. std::libc::c_int since C's int != Rust's int)
[11:25:09] <hansjorg> huon: could you change hiho.io -> rust-ci.org in the topic?
[11:25:34] <hansjorg> doesn't need the last /rust-ci/ either
[11:26:13] * huon needs to work out how to drive IRC...
[11:26:37] *** Quits: Ferreus (ferreus@moz-3AB29841.dip0.t-ipconnect.de) (Ping timeout)
[11:27:18] *** huon changes topic to '#rust'
[11:27:26] <huon> err, crap
[11:27:41] <huon> um, does anyone have the old topic handy?
[11:27:46] <hansjorg> I've got it, one sec
[11:27:52] *** Joins: ozten (ozten@moz-87FC77D4.hsd1.wa.comcast.net)
[11:27:54] <hhhhhhhhhh> "enum struct variants are experimental and possibly buggy" are they really buggy :p
[11:27:59] <hansjorg> The Rust language | logs: https://botbot.me/mozilla/rust | conduct: https://github.com/mozilla/rust/wiki/Note-development-policy#conduct | package integration: http://rust-ci.org/ |  1.0 issues: bit.ly/1dM8ii2 | if room is moderated, register with nickserv to talk
[11:28:13] *** huon changes topic to 'The Rust language | logs: https://botbot.me/mozilla/rust | conduct: https://github.com/mozilla/rust/wiki/Note-development-policy#conduct | package integration: http://rust-ci.org/ | 1.0 issues: bit.ly/1dM8ii2 | if room is moderated, register with nickserv to talk'
[11:28:25] <hansjorg> great, thanks :)
[11:28:28] <huon> np
[11:29:06] <huon> hhhhhhhhhh: they do have some bugs with them
[11:29:10] <huon> small ones
[11:29:47] <hhhhhhhhhh> huon: am i likely to encounter them without specifically trying to break them
[11:30:04] <doomlord_> is there any difference between #[no_mangle] extern "C" fn ....  and #[no_mangle]  extern fn ....
[11:30:32] *** Quits: jviereck (Adium@moz-8B8C3A96.ethz.ch) (Ping timeout)
[11:30:39] <eddyb> doomlord_: don't think so
[11:31:27] <huon> hhhhhhhhhh: probably not
[11:31:37] <huon> doomlord_: extern now defaults to "C" abi in all instances
[11:32:07] <doomlord_> and you should definitely be able to call #[no_mangle] extern fn .... from c, right?
[11:32:12] *** Quits: benjamin_ (benjamin@moz-A67B45F0.dip0.t-ipconnect.de) (Ping timeout)
[11:32:22] <huon> doomlord_: with `pub`, yes
[11:32:34] *** Quits: aravindavk (aravinda@moz-BD0CADEE.redhat.com) (Ping timeout)
[11:32:36] <doomlord_> i'm getting these functions showing up when i query the libraries with 'nm' ... its linking ok  .... yes i've got pub
[11:33:12] <doomlord_> #[no_mangle]    pub extern fn rusty_android()->libc::c_int { 99 }  // 2days ago i could call this... today i cant :(
[11:33:34] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[11:34:08] *** Quits: t4nk249 (bzlandfill@moz-833C28A3.hsd1.va.comcast.net) (Quit: CGI:IRC (Ping timeout))
[11:34:34] <doomlord_> i'm seeing 'rusty_android' in my generated library, but also "_ZN13rusty_android10__rust_abiE
[11:34:52] <doomlord_> is 'rusty_android' a C shim that it generates, calling the latter 
[11:35:39] <huon> yes
[11:35:57] <huon> (i believe that's regarded as a bug)
[11:36:02] <maximilian> how to create a vector ([f64]) from a pointer passed in from C? I'm looking at the ffi page, and I can do the opposite, but I'm not sure if I can go backwards
[11:36:07] <huon> doomlord_: "can't call back"
[11:36:19] <huon> maximilian: extra::c_vec has a wrapper type
[11:36:26] <maximilian> cool
[11:36:32] <huon> on which you can call .as_slice() to get a &[f64]
[11:36:35] <doomlord_> huon - C can call rust, right?  ... i'm sure i had this actually running 2days ago
[11:36:42] <huon> doomlord_: yes, that's correct
[11:36:57] <maximilian> @doomlord: I'm testing this right now
[11:36:58] <huon> i was asking about the symptoms (e.g. segfaults/error messages)
[11:38:22] <doomlord_> "nm" shows a function it can't find with U i guess, i just tried to insert a call to a function that *isn't* there to see if i get a linked error. i dont, i'm building a .so.   but it shows me '   U rusty_foo' (rusty_foo doesn't exist)
[11:38:24] <huon> maximilian: (you'll need to know the length too, btw)
[11:38:27] <maximilian> huon: How does c_vec know the length?
[11:38:34] <huon> maximilian: you pass it to it
[11:38:34] <maximilian> or as_slice(length)
[11:38:47] <huon> on construction
[11:38:58] <doomlord_> my problem seems to be if a rust function is *linked*, even if it isn't reached, the parent C code doesn't run
[11:39:05] <huon> maximilian: http://static.rust-lang.org/doc/master/extra/c_vec/struct.CVec.html#method.new
[11:39:16] <doomlord_> but it could be that the .so "has something missing" perhaps.
[11:39:30] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[11:39:42] <huon> doomlord_: you're compiling a C program as simple as `int main() { rusty_foo(); return 0;}`, right?
[11:39:45] *** Joins: dranov (dranov@6AB7D91E.82C4B75C.FB866788.IP)
[11:39:57] *** Joins: zimbatm (zimbatm@moz-D4F596B.cable.virginm.net)
[11:40:02] <maximilian> ahh
[11:40:03] <huon> (if not, does that work, when passed -lrust-library)
[11:40:20] <doomlord_> huon i wish :) i'm trying to get rust on android - i'm using an NDK sample with a main.c and all sorts of malarchy. It produces a .so which gets packaged. That's what has to run :)
[11:40:53] <doomlord_> 2 days ago i had it working ... through manual build commands .. seems i can't remember exactly what i did , even though i took a note..
[11:41:38] *** Joins: Ferreus (ferreus@moz-F3FF31FF.dip0.t-ipconnect.de)
[11:42:00] <huon> are you passing the correct linking flags?
[11:42:04] * huon guesses
[11:42:11] <doomlord_> i have no idea what they would be :) 
[11:42:26] <doomlord_> i dont know my way around the android makefiles
[11:42:29] <huon> -lname_of_rust_lib-<hash>-v0.0
[11:42:33] * huon shrugs
[11:42:37] <huon> I don't either :P
[11:42:41] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[11:43:03] <doomlord_> one more possibility arises - i thought creating a .so would complain if it doesn't find anything needed when you build it
[11:43:13] <doomlord_> maybe it *doesn't* and i've got things i need to link into the .so
[11:43:40] <doomlord_> i've just thought of this after seeing 'U ...' from nm after trying to see if i icould make creating the so fail.
[11:44:35] <maximilian> huon: how to create CVec? let i = extra::c_vec::CVec(i_ptr,vec_len).as_slice();
[11:45:16] <maximilian> i'm getting error: unresolved name `extra::c_vec::CVec`
[11:46:28] <huon> maximilian: CVec::new()
[11:46:28] <hhhhhhhhhh> "mismatched types: expected `&[shapes::Shape]` but found `&[shapes::Shape, .. 1]` (expected vector but found &-ptr)" what can i do about that
[11:46:30] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[11:46:47] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:47:02] <huon> you probably have `let v = [1]; foo(&v)` right?
[11:47:07] <hhhhhhhhhh> yea
[11:47:08] <huon> (or something like that?)
[11:47:29] <huon> either `foo(v)` (fixed length vectors coerce to &[] automatically)
[11:47:37] <huon> or `let v = &[1];`
[11:47:41] <maximilian> huon: yeah.. I just figured that out
[11:47:49] *** Joins: t4nk899 (bzlandfill@moz-833C28A3.hsd1.va.comcast.net)
[11:47:53] <maximilian> newbie alert..
[11:47:58] <huon> (special cased to be the constructor of &[], &([1]) makes a &([T, .. 1]))
[11:48:01] * huon sirens
[11:48:11] <huon> maximilian: (don't worry :) )
[11:48:22] <hhhhhhhhhh> huon: thanks
[11:48:35] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:48:56] <huon> maximilian: you may need to "root" the CVec to make the slice last long enough
[11:49:22] <huon> `let i_cvec = CVec::new(ptr, len); let i_slice = i_cvec.as_slice();`
[11:49:37] <huon> or else the lifetime will be too short and the compiler will complain at you
[11:49:46] <maximilian> i just hit that
[11:49:47] <maximilian> thanks
[11:50:24] *** Joins: autra (augustin@A14DAE84.7F753DD1.EE2CA32B.IP)
[11:50:42] <maximilian> works!
[11:50:51] <doomlord_> Through a lot of random faffing around, I find my ".so" doesn't contain __android_log_print,  which i would have thought it needs
[11:51:11] <maximilian> ok. So i had to wrap that CVec::new() call in an unsafe block
[11:51:24] <doomlord_> i thought that came from -llog , which i do have in the link command
[11:51:25] <maximilian> how to get the value I wrapped out of the unsafe block?
[11:51:31] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[11:51:38] *** Joins: aravindavk (aravinda@moz-BD0CADEE.redhat.com)
[11:51:40] <huon> maximilian: yep, because you're basically asserting to the compiler that the raw `i_ptr` is a valid pointer
[11:51:45] <huon> (which it can't verify otherwise)
[11:51:55] <huon> `let c_vec = unsafe {CVec::new(ptr, len)};`
[11:52:00] <huon> everything is an expression <3
[11:52:09] <huon> (well, nearly everything...)
[11:52:11] <maximilian> awesome.
[11:52:29] *** Joins: Soarez (Soarez@2CC54C74.962BAB29.F7A44A1B.IP)
[11:52:52] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[11:53:02] <maximilian> hmm
[11:53:25] <doomlord_> Servo supposedly runs on android, but i imagine that also has a complex makefile that I wont be able to decipher..
[11:54:02] <huon> doomlord_: servo is open source... you could check :P
[11:54:09] <doomlord_> i've looked :)
[11:54:21] <doomlord_> makefiles are write-only
[11:54:23] <huon> heh
[11:54:42] <Ms2ger> Correct
[11:56:18] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Quit: Leaving...)
[11:56:22] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[11:56:48] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[11:56:56] <hhhhhhhhhh> ok how can i make something satisfy send? specifically: http://ix.io/aWK
[11:56:57] *** Quits: Ms2ger (Ms2ger@moz-394FABD5.ugent.be) (Ping timeout)
[11:57:24] <huon> by not putting any non-send things in it
[11:57:26] <kimundi> hhhhhhhhhh: It need to contain only things that are Send themself
[11:57:28] <huon> (e.g. @, or Rc)
[11:57:32] <huon> or &
[11:57:44] <huon> where do you need send?
[11:57:56] <hhhhhhhhhh> i don't understand why a reference wouldn't be sendable
[11:58:03] <huon> btw, the explicit `return a;` can be written `a` (without the semi colon)
[11:58:03] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[11:58:24] <hhhhhhhhhh> i want to make an instance of SimpleWorld and then have lots of threads use it
[11:58:32] <huon> hhhhhhhhhh: because the owning thread might deallocate what the & points too, leaving the receiving thread with a dangling pointer
[11:58:53] <hhhhhhhhhh> huon: don't lifetimes solve this or am i misunderstanding them
[11:58:57] <huon> while sending a ~ between threads moves it, so the original thread no longer has any control
[11:58:59] <huon> not with threads
[11:59:09] <huon> they're independent entities
[11:59:16] <huon> running concurrently
[11:59:24] <hhhhhhhhhh> can i avoid having to copy the entire SimpleWorld for every thread
[11:59:48] <huon> we *are* getting a Share kind that's similar to thread which will allow libraries to expose a safe fork-join interface to allow things like this
[11:59:51] <huon> use an Arc
[11:59:52] *** Parts: Soarez (Soarez@2CC54C74.962BAB29.F7A44A1B.IP) ()
[12:00:08] <huon> http://static.rust-lang.org/doc/master/sync/struct.Arc.html for immutable shared memory
[12:00:10] <hhhhhhhhhh> searching the docs only gives me UnsafeArc
[12:00:13] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[12:00:17] <huon> http://static.rust-lang.org/doc/master/sync/struct.MutexArc.html
[12:00:18] <kimundi> hhhhhhhhhh: references and lifetimes are inherently rooted to the callstack. If you send it to another thread, then that one has its own callstack, with no connection to the one the reference points at. So the the thread you send from could exit or overwrite the memory with other data, and you get a dangling pointer
[12:00:22] <huon> for muttable shared memory
[12:00:27] <hhhhhhhhhh> oh it's not in std
[12:00:29] <huon> hhhhhhhhhh: (it's in the sync crate, on master)
[12:00:44] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Quit: Leaving...)
[12:01:42] <huon> hhhhhhhhhh: so what one would do there is to have a ~[Shape] placed in an Arc that all threads have access too
[12:01:53] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[12:02:01] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[12:02:19] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[12:02:36] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[12:02:38] <hhhhhhhhhh> huon: could i make SimpleWorld hold a [ Shape ] and then create a ~SimpleWorld
[12:02:44] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[12:02:46] *** Joins: paldepind (simon@8C529550.87451125.F2979BBF.IP)
[12:02:50] <huon> hhhhhhhhhh: not now, no
[12:02:53] <maximilian> thanks guys
[12:02:56] <maximilian> lunch time
[12:02:59] *** jorendorff_away is now known as jorendorff
[12:03:01] <huon> requires DST (dynamically sized types)
[12:03:06] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[12:03:14] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[12:03:23] <huon> hhhhhhhhhh: the duplication of types when you need ~[] sometimes and &[] others is annoying
[12:03:28] * huon doesn't like it at all
[12:03:33] <hhhhhhhhhh> hmmm
[12:03:41] <hhhhhhhhhh> i am going to need NotSoSimpleWorlds in the near future
[12:03:56] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Ping timeout)
[12:04:00] <hhhhhhhhhh> which will contain quadtrees etc
[12:04:22] <ChrisMorgan> This "Language to replace C" thread has become quite toxic.
[12:05:53] <doomlord_> i've verified i can link another *c* source in my android.so, and call that, via my own makefile, not using 'ndk-build'
[12:05:57] <hhhhhhhhhh> huon: am i out of luck :d
[12:06:06] <huon> hhhhhhhhhh: no?
[12:06:30] *** Quits: heftig (heftig@moz-D746319F.unitymedia.biz) (Quit: Quitting)
[12:06:34] <huon> hhhhhhhhhh: I guess I don't understand the implications of containing a quadtree
[12:06:34] <doomlord_> but as soon as i try calling an [no_mangle] pub extern fn from rust... even though nm sees it .. it all fails
[12:06:42] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[12:06:48] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[12:06:54] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[12:07:15] <hhhhhhhhhh> huon: i could also have said binary tree
[12:07:23] <hhhhhhhhhh> huon: or anything which needs a lot of pointers
[12:07:34] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[12:07:57] <doomlord_> ChrisMorgan, which thread where :)
[12:08:06] <ChrisMorgan> doomlord_: mailing list
[12:08:38] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[12:10:30] *** Joins: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP)
[12:10:53] <huon> hhhhhhhhhh: and you'll sometimes need ~ and sometimes need &?
[12:11:04] *** Joins: leowoe (Leo@moz-CEF2400C.inf.uni-konstanz.de)
[12:11:17] <huon> hhhhhhhhhh: could use a Ptr<T> trait impld for ~T and &T to abstract the common operations
[12:11:18] <hhhhhhhhhh> huon: i think i can get away with ~ actually and this appears to be working
[12:11:31] <huon> i.e. Foo<T, P: Ptr<T>> { x: P }
[12:11:33] <huon> oh, ok
[12:11:38] <hhhhhhhhhh> thanks
[12:12:01] <huon> ~ does bring the temptation to use .clone though... resist it ;P
[12:12:25] *** Quits: anasyrma (x@moz-DE175E38.caltech.edu) (Ping timeout)
[12:12:43] <hhhhhhhhhh> wait
[12:12:48] <hhhhhhhhhh> i can clone an Arc right
[12:12:54] <huon> yes
[12:12:57] <hhhhhhhhhh> pHEW
[12:13:10] <huon> (and it's cheap: just a ref count bump)
[12:13:34] <huon> (well, an atomic one; but as long as you're not doing it in a tight loop it should be fine.)
[12:13:34] <hhhhhhhhhh> ok project saved
[12:13:35] <hhhhhhhhhh> thanks
[12:13:37] <huon> <3
[12:13:54] <whitequark> huon: why would doing an atomic bump in a tight loop be problematic?
[12:14:01] *** Joins: anasyrma (x@moz-DE175E38.caltech.edu)
[12:14:09] <whitequark> you'll have the relevant line in cache at all times anyway
[12:14:14] <huon> whitequark: just significantly more expensive than a non-atomic bump
[12:14:18] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[12:14:18] *** Joins: tgkokk (tgkokk@moz-E589AF21.home.otenet.gr)
[12:14:18] <whitequark> hm
[12:14:26] <huon> because of synchronisation
[12:14:53] <whitequark> huon: can you point me to benchmarks/analysis? not questioning, just curious
[12:15:06] <huon> (I guess the real problem is when you have multiple threads doing that, causing memory barriers etc. to thrash)
[12:15:20] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[12:15:43] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[12:15:45] <huon> let arc = Arc::new(1); for _ in range(0, 1000000) { arc.clone(); }
[12:15:50] <huon> and the same with Rc
[12:15:58] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[12:16:00] <whitequark> as I understood it, the only difference between atomic rmw and regular rmw is that the core ensures the relevant line will remain in its cache in E state at all times
[12:16:01] <huon> (i haven't actually measured it...)
[12:16:04] <hhhhhhhhhh> if i have something like `enum T { A { a : f64 }, B { b : f64 } }` can i do anything like `match t { A => handleA, b => handleB }`
[12:16:18] <whitequark> hence should be no difference between rmw and atomic rmw when there is no contention
[12:16:28] <huon> whitequark: aiui, half the problem of C++'s shared_ptr is the atomic counts
[12:16:42] <hhhhhhhhhh> or do i ahve to do `A { a } => handleA( a ),`
[12:16:47] <huon> but yeah, I'd believe that contention is necessary to see a significant difference
[12:17:01] <eddyb> hhhhhhhhhh: the latter
[12:17:19] * whitequark would expect no difference at all. well, let's check...
[12:17:19] <huon> hhhhhhhhhh: handleA(a), preferably :P
[12:17:30] <huon> whitequark: for the single threaded case?
[12:17:36] *** Joins: tigrou3tac (fabien@moz-6E2397FF.fbx.proxad.net)
[12:17:37] <hhhhhhhhhh> thanks
[12:17:50] <whitequark> huon: yes
[12:19:10] <whitequark> grr, no recent rust checkout
[12:19:18] <doomlord_> hmm, emit asm and inspect that
[12:19:48] <whitequark> doomlord_: obviously asm would be different. lock inc instead of inc, or something like that on x86
[12:20:13] <whitequark> it's just that based on my understanding of how atomics work in modern processors, they should not have an intrinsic inefficiency
[12:20:35] <doomlord_> ARM
[12:21:01] <doomlord_> sorry i'm having a tangential conversation with myself 
[12:21:04] <whitequark> on ARMv7 you would have ldrex/strex pairs, essentially same thing on lower level
[12:21:39] <whitequark> tbh I never worked or investigated multicore arms so no idea about that, but they *probably* work in a similar way
[12:21:53] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[12:22:10] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[12:22:33] *** Quits: tgkokk (tgkokk@moz-E589AF21.home.otenet.gr) (Ping timeout)
[12:22:44] <huon> test atomic    ... bench:        17 ns/iter (+/- 1)
[12:22:44] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[12:22:44] <huon> test nonatomic ... bench:         4 ns/iter (+/- 0)
[12:23:00] <huon> #[bench]
[12:23:00] <huon> fn atomic(bh: &mut BenchHarness) { let ptr = Arc::new(10); bh.iter(|| ptr.clone()) }
[12:23:09] <whitequark> very fascinating
[12:23:12] <huon> (and s/Arc/Rc/.)
[12:23:18] <whitequark> huon: I want to poke that further.
[12:23:41] <huon> whitequark: https://gist.github.com/huonw/b1d693054748464b5a23
[12:23:48] * whitequark grumbles and waits for LLVM to build
[12:23:56] <doomlord_>   idont need the 'morestack' stuff anymore, right?
[12:24:08] <doomlord_> (for c/rust interop)
[12:24:14] <whitequark> I think it's still there, to check for stack overflows in rust
[12:24:25] <doomlord_> but do i need a #[..] to use it
[12:24:25] <whitequark> despite removal of split stacks
[12:24:38] <huon> yep
[12:24:46] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[12:24:54] <whitequark> #[no_split_stack]; or something
[12:25:17] <doomlord_> i'm definitely seeing my rust extern function has a wrapper doing __morestack stuff that then calls a mangled rust function
[12:25:28] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[12:25:39] <doomlord_> rusty_android: .... yada  ... bl __morestack .... bl _ZN13rusty_android10__rust_abiE
[12:25:47] <whitequark> well... write a dummy __morestack: bx lr
[12:25:54] *** Quits: dave1629_ (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629_)
[12:26:17] <huon> #[no_mangle] pub extern "C" __morestack() { loop {} }
[12:26:20] <huon> or whatever
[12:26:40] *** Quits: aravindavk (aravinda@moz-BD0CADEE.redhat.com) (Ping timeout)
[12:26:40] <whitequark> huon: loop{}?
[12:26:49] <huon> infinite loop
[12:26:55] <huon> I guess abort() would be better...
[12:27:03] <whitequark> I think the problem is that prelude checks for stack limit in some TLS slot
[12:27:13] <doomlord_> its got morestack compiled in ok, i find that inthe library
[12:27:16] <whitequark> and if you don't initialize that TLS slot you'll probably hit __morestack immediately
[12:27:29] <whitequark> doomlord_: you can use --emit-llvm and then llc to avoid inserting __morestacks
[12:27:37] <whitequark> that's what I do
[12:27:47] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[12:28:06] *** Joins: dave1629_ (dave@moz-17578A1A.hsd1.va.comcast.net)
[12:28:49] <eddyb> we had an attribute for it
[12:28:59] <eddyb> it was deprecated even if it still worked
[12:29:01] <whitequark> mentioned above
[12:29:05] <doomlord_> yeah i remember that and had to remove it
[12:29:26] <eddyb> whitequark: sorry
[12:29:34] <whitequark> eddyb: np :)
[12:29:42] <whitequark> no_split_stack is still used by rust itself
[12:29:47] <doomlord_> this is the moment whwere i regret getting into rust.. imobilized not able to compile something
[12:30:14] <whitequark> doomlord_: try --emit-llvm and then llc on the emitted file
[12:30:49] <whitequark> sorry, can't help you further until I get a more recent checkout up and running
[12:31:00] <doomlord_> ---emit ir
[12:32:07] <doomlord_> thats interesting i've not looked at much ir
[12:32:16] <huon> whitequark: btw, are you on a system with nightlies? https://github.com/mozilla/rust/wiki/Doc-packages,-editors,-and-other-tools
[12:32:21] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[12:33:02] <doomlord_> usual extention for ir is ? 
[12:33:06] <whitequark> doomlord_: .bc
[12:33:26] <whitequark> huon: Debian. I've some patches for rust in queue, so I'll have to compile anyway
[12:33:47] <huon> ok
[12:33:50] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[12:34:17] *** Quits: patpat (patpat@9E957BB5.933C45AA.98F3E2B5.IP) (Ping timeout)
[12:34:29] *** Joins: mr_trousers (Mibbit@moz-9A46D3D.dsl.teksavvy.com)
[12:35:03] <doomlord_> heh llc doesn't like it
[12:35:09] <whitequark> doomlord_: what does it say
[12:35:10] <whitequark> ?
[12:35:30] <doomlord_> llc: hello_android.bc:11:60: error: invalid use of function-only attribute
[12:35:30] <doomlord_> declare void @llvm.memcpy.p0i8.p0i8.i32(i8* nocapture, i8* nocapture readonly, i32, i32, i1) unnamed_addr #0
[12:35:42] <whitequark> ohh you have a version mismatch between rust's llvm and your llvm
[12:35:59] <whitequark> llc -version
[12:36:07] <whitequark> what LLVM version does it report?
[12:36:10] <doomlord_> i was about to say, arm/android .. oops
[12:36:53] <whitequark> sure, I remember. that shouldn't matter, in general.
[12:37:06] <whitequark> llvm is multiplatform in that it doesn't build for a single target only
[12:37:09] <doomlord_> 3.2
[12:37:25] <doomlord_> lets see if i have an llc in the rust build  dir...
[12:37:33] *** Joins: josh (josh@moz-C1D9FC5F.meeting.ietf.org)
[12:37:37] <whitequark> yep, I think you should
[12:38:34] *** Joins: Ms2ger (Ms2ger@moz-7A72B442.ugent.be)
[12:39:12] <doomlord_> And that is v 3.5svn :)
[12:39:25] <doomlord_> that works fine
[12:39:57] <doomlord_> right - now i do indeed get some asm without morestack
[12:41:20] *** Quits: dave1629_ (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629_)
[12:41:27] <whitequark> doomlord_: morestack is inserted by a custom attribute rust gives to llvm codegen
[12:41:36] <whitequark> if you just generate asm or object file with llc, morestack won't be therer
[12:41:50] <whitequark> llc -filetype=asm source.bc 
[12:41:56] <doomlord_> thats' part of Rusts' LLVM patches?
[12:42:12] <whitequark> it's upstreamed mostly, I think rust only adds morestack support for android
[12:42:37] <doomlord_> llc -filetype=obj to emit machinecode right
[12:42:38] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[12:43:26] *** Quits: eevee (eevee@moz-A8156E13.lv.lv.cox.net) (Ping timeout)
[12:43:30] *** Quits: onix (Mibbit@moz-AA65C711.lns20.adl2.internode.on.net) (Quit: http://www.mibbit.com ajax IRC Client)
[12:43:32] <whitequark> yep
[12:43:51] <whitequark> also llc has its own -O flag, you should pass same value as to compiler there
[12:43:54] <whitequark> for best results
[12:44:01] <doomlord_> ok i linked all that, it was interesting to see... its not fixing my problem though
[12:44:21] <doomlord_> however i have another avenue to see, what could possibly be different between linking rust and c into this .so
[12:44:40] <doomlord_> i could write an equivalent .c and check the IR perhaps
[12:44:49] <whitequark> good idea
[12:45:07] <doomlord_> the distressing thing is.. its not crashing on reaching the function - its not running the program if its even linked
[12:45:09] *** Joins: canhtak (canhtak@moz-46C3B4C8.wl.t.ulaval.ca)
[12:46:04] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[12:49:01] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[12:49:54] *** Quits: io2 (io2@moz-EE406A5.home.otenet.gr) (Quit: )
[12:50:25] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[12:52:18] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[12:54:07] *** Joins: eevee (eevee@moz-A8156E13.lv.lv.cox.net)
[12:54:37] <doomlord_>  http://pastebin.com/bGu7Kp1m <<<<< 2 source file containing a single c/rust function compiled to asm.... if i link the rust version, my android library doesn't work :(
[12:54:55] *** Joins: judder (maradukewa@A4DC519F.6379DA33.78E362FE.IP)
[12:55:14] <doomlord_> first question, is it even thumb mode
[12:55:23] <eddyb> is android thumb-only?
[12:55:30] <eddyb> I think you have to use a flag for thumb
[12:55:54] <Ms2ger> Okay, folks, I've got an interesting issue
[12:55:56] <whitequark> doomlord_: armv5te, hence thumb
[12:55:58] <doomlord_> i dont remember doing that when i got it working 2 days ago
[12:56:12] <whitequark> oh, not in rustc
[12:56:22] <doomlord_> the C function works, so it would seem thumb is needed. the android toolchain tells me somethig about thumb aswell
[12:56:22] *** Joins: nical (nico@87C1F78E.1DE10CA8.D8E68FF6.IP)
[12:56:31] <whitequark> doomlord_: try rustc -C target-cpu=thumbv5
[12:56:53] <Ms2ger> I've got a trait (JSValConvertible) that handles converting JS values <--> rust values, and I implement that trait for the types I use
[12:57:06] *** Joins: Anupkumar (uid16774@moz-A42E5B7B.irccloud.com)
[12:57:10] <doomlord_> previously its been '--target=arm-linux-androideabi' - are those mutually compatible
[12:57:21] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[12:57:38] <whitequark> hang on
[12:57:57] <Ms2ger> For most types, knowing the type is sufficient, but for some, there's multiple ways of converting js -> rust, so I need to pass an additional argument to the conversion function
[12:58:04] <Ms2ger> Is there any way to do that?
[12:58:20] <whitequark> doomlord_: yes, I think you need to pass both.
[12:58:30] <eddyb> Ms2ger: how do you use the trait?
[12:58:39] <eddyb> Ms2ger: do you call a method on it?
[12:58:53] <hhhhhhhhhh> if i have `enum T { A { a : f64 }, B { b : f64 } }` can i write a function that accepts only things of type A
[12:58:59] <Ms2ger> Right now, I'm calling JSValConvertible::from_jsval(val), basically
[12:59:02] <eddyb> hhhhhhhhhh: A is not a type
[12:59:04] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[12:59:17] <eddyb> hhhhhhhhhh: you should use A(A) and struct A {a: f64} if you want that
[12:59:17] <hhhhhhhhhh> eddyb: ok :d
[12:59:29] <Ms2ger> hhhhhhhhhh, I think I've seen a suggestion for that feature on nmatsakis's blog, fwiw
[12:59:33] <eddyb> Ms2ger: you can have a second method
[12:59:35] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[12:59:45] <eddyb> or a different trait
[13:00:05] <eddyb> Ms2ger: with variadic generics, you could overload on arity
[13:00:15] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:00:29] <eddyb> Ms2ger: but do you plan to make the invocation nicer?
[13:00:48] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[13:01:03] <Ms2ger> I was hoping for something like an argument whose type depends on the type I'm implementing the trait for
[13:01:08] <Ms2ger> Does that make any sense? :)
[13:01:16] <eddyb> Ms2ger: make the trait generic
[13:01:28] <Ms2ger> Hmm
[13:01:43] <eddyb> we don't have associated types yet
[13:01:52] <eddyb> but in most cases generic traits are equivalent
[13:02:22] <Ms2ger> So something like trait JSValConvertible<AddlData> { fn from_jsval(jsval, AddlData); }?
[13:02:28] *** Quits: kvanb (kvanb@moz-1A7A80B8.lnse4.win.bigpond.net.au) (Quit: kvanb)
[13:02:38] <eddyb> Ms2ger: I would suggest making it a different method
[13:02:45] <Ms2ger> Fair
[13:02:50] <Ms2ger> So something like trait JSValConvertible<AddlData> { fn from_jsval_with_data(jsval, AddlData); }?
[13:02:51] <eddyb> if it's going to be () for most types
[13:02:58] <eddyb> yeah, sure
[13:03:01] <doomlord_> https://github.com/mozilla/rust/wiki/Doc-building-for-android <<< doesn't mention any thumb parameter
[13:03:19] <eddyb> doomlord_: maybe a different --target triple?
[13:03:23] <eddyb> I'm not exactly sure
[13:03:26] <Ms2ger> And then impl JSValConvertible<StringConversionBehavior> for ~str {...}?
[13:03:31] <eddyb> doomlord_: I know LLVM has flags for this stuff
[13:03:34] <eddyb> Ms2ger: yeah
[13:03:37] <Ms2ger> Hmm
[13:03:48] <Ms2ger> Sounds worth a try
[13:04:14] <doomlord_> i can't find the right target-cpu option anyway
[13:05:28] *** Joins: benjamin_ (benjamin@moz-A67B45F0.dip0.t-ipconnect.de)
[13:05:52] <doomlord_> i'm sure i had this working and didn't have any manual selection of thumb - is it possible i've lost that by emiting LLVM IR and then assembling it
[13:06:10] <eddyb> are you doing that?
[13:06:17] <doomlord_> (how can i check that, perhaps a tool will tell me what CPU architecture a library is in)
[13:06:23] <eddyb> file
[13:06:31] <doomlord_> i am going through al sorts of convoluted paths here :)
[13:06:35] <eddyb> doomlord_: you need to pass target options to llc
[13:06:43] <whitequark> doomlord_: no, not possible. target is embedded into bitcode
[13:06:54] <whitequark> eddyb: llc should pull the target cpu from bitcode
[13:07:04] <eddyb> no
[13:07:11] <doomlord_> ok can i check what target cpu a generated library is (.a )
[13:07:20] <eddyb> llc can be passed flags to generate all kinds of crazyness
[13:07:31] <eddyb> I've accidentally enabled SSE in kernel code
[13:07:44] <whitequark> hm
[13:08:13] *** Joins: asmyers (quassel@F7FD79FB.9A737B8F.FAA4474F.IP)
[13:08:44] <eddyb> the bytecode has a data layout (which is just the bit sizes for i8/i16/i32/i64 AFAIK)
[13:09:03] <whitequark> bytecode also has target triple at least
[13:09:08] <whitequark> bitcode*
[13:09:18] <eddyb> in the IR form, there's not a triple, at least not all the time
[13:09:26] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[13:09:39] <whitequark> well, it's optional
[13:09:42] <eddyb> bytecode bitcode why do there have to be two ways of saying it?
[13:09:51] <whitequark> bitcode is the only correct way
[13:09:57] <whitequark> when talking about llvm
[13:10:03] <mr_trousers> eddyb: lol at the bit about SSE
[13:10:13] <whitequark> doomlord_: ok, I rechecked and you do have to pass -mcpu to llc
[13:10:24] <eddyb> mr_trousers: never go native CPU selection in kernel code
[13:10:54] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[13:11:13] <doomlord_> as i think i had this working without mentioning thumb, i'm trying to see what just compiling rustc --target=arm-linux-androideabi is giving me
[13:11:51] *** Joins: pczarn (Mibbit@moz-69A55FA.izacom.pl)
[13:12:04] <doomlord_> hello_android: ELF 32-bit LSB shared object, ARM, version 1 (SYSV), dynamically linked, not stripped
[13:12:14] *** Quits: mr_trousers (Mibbit@moz-9A46D3D.dsl.teksavvy.com) (Quit: http://www.mibbit.com ajax IRC Client)
[13:12:30] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[13:12:38] <eddyb> doomlord_: hmm, not sure if that knows about thumb
[13:12:49] <eddyb> maybe readelf will bring up some flags?
[13:13:27] <doomlord_> grrr
[13:13:49] *** Joins: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP)
[13:13:53] <doomlord_> if i build "--crate-type=lib" (.a) ... whatever i emit , file doesn't tell me anything useful
[13:13:57] <doomlord_> "current ar archive"
[13:14:10] <doomlord_> eddyb have you run anything on android recently ?
[13:14:10] <eddyb> doomlord_: unpack it
[13:14:10] <whitequark> doomlord_: ar x file.a, then use file on objects inside
[13:14:31] <eddyb> doomlord_: I managed to start the emulator, that's all :P
[13:14:40] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[13:15:00] <doomlord_> hello_android.o: ELF 32-bit LSB relocatable, ARM, version 1 (GNU/Linux), not stripped
[13:15:10] <doomlord_> that *should* say thumb, i guess
[13:15:10] <eddyb> ccx.sess.warn(msg.to_str() + " -- do not commit like this!");
[13:15:14] <eddyb> ^^ what?
[13:16:20] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[13:16:23] <eddyb> it's... dead code
[13:16:37] *** Quits: maximilian (max@moz-493D272A.ethz.ch) (Quit: Leaving)
[13:16:37] <whitequark> doomlord_: for cortex-m3 I pass --target thumbv7m-none-eabi -C target-cpu=cortex-m3 to rustc, and -mcpu=cortex-m3 to llc
[13:16:56] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[13:17:18] *** Joins: aeqwa (aeqwa@moz-F798473B.dsl.tropolys.de)
[13:18:12] <doomlord_> can rustc list the available targets
[13:18:22] *** jorendorff is now known as jorendorff_away
[13:18:43] <eddyb> that would be nice, but I doubt it. maybe llc can
[13:19:04] <whitequark> it can't
[13:19:28] <whitequark> there's a huge combinatorial explosion of possible triples anyway, see ftp://ftp.cs.vu.nl/pub/minix/__trash/llvm-3.2.src/lib/Support/Triple.cpp
[13:19:40] <eddyb> 3.2... old
[13:19:48] *** Quits: leowoe (Leo@moz-CEF2400C.inf.uni-konstanz.de) (Quit: Leaving.)
[13:19:59] <whitequark> doesn't matter, in trunk it is the same
[13:20:16] <whitequark> https://github.com/llvm-mirror/llvm/blob/master/lib/Support/Triple.cpp
[13:20:33] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[13:20:35] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[13:20:58] <eddyb> they've probably added all the AAarch - wait, unchanged?
[13:21:17] <whitequark> well, largely
[13:21:25] <whitequark> they did add aarch and the like
[13:21:26] <eddyb> right
[13:21:58] <doomlord_> turning it from --target=arm-linux-androideabi to --target=thumb-linux-androideabi ... it can't find much
[13:22:45] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[13:22:46] <doomlord_> i should give up and post a question asynchronously which someone who;s worked on servo can answer
[13:22:58] <doomlord_> perhaps :)
[13:23:09] <eddyb> doomlord_: you might need to rebuild your rustc
[13:23:22] <eddyb> maybe just the libraries, but I'm not sure it works without a reconfigure
[13:25:44] *** Quits: steffenomak (steffenoma@moz-FB0A4BEB.student.uu.se) (Ping timeout)
[13:26:59] *** Parts: judder (maradukewa@A4DC519F.6379DA33.78E362FE.IP) ()
[13:27:22] *** Joins: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl)
[13:27:32] *** Joins: edwardw (edwardw@4112974A.B4358688.30F15291.IP)
[13:27:42] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[13:29:33] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[13:33:32] <nmatsakis> eddyb: btw, I never wanted to *replace* &mut with &move
[13:34:37] <eddyb> nmatsakis: sorry, I must've understood it wrong
[13:34:57] <eddyb> maybe that &my wasn't the current &move
[13:35:17] *** Quits: t4nk899 (bzlandfill@moz-833C28A3.hsd1.va.comcast.net) (Quit: CGI:IRC (Ping timeout))
[13:35:20] <nmatsakis> right :)
[13:35:31] <doomlord_> http://www.reddit.com/r/rust/comments/1zmgxt/compiling_rust_for_android_apks_what_options/ <<< i hope someone can shed light later.
[13:35:57] *** Joins: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP)
[13:36:05] <nmatsakis> eddyb: I wanted to s/mut/my/ to emphasize that *uniqueness* is the real thing we are tracking. After I lost that argument, I wanted to repurpose the my keyword for something else...so it's kind of confusing :)
[13:36:24] <nmatsakis> (but I've since come up with an alternate scheme I prefer so that we don't need that either)
[13:36:30] <eddyb> oh?
[13:36:51] <eddyb> do you have an alternative to &move through trait objects?
[13:37:12] <eddyb> I think glaebhoerl_ used that in a few places to emulate pass-by-value
[13:37:54] <nmatsakis> eddyb: yes. in short, I just wanted to make pass-by-value work for dst types. basically you'd be able to move them but only by passing a parameter.
[13:38:23] * glaebhoerl_ really needs to make some progress in writing up various RFCs :(
[13:38:49] *** Joins: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch)
[13:38:52] * eddyb added a few examples to his variadic generics one... won't make implementing them faster :P
[13:38:53] <glaebhoerl_> with both &move and &out, the value is in being able to tie the lifetimes of things together
[13:39:14] <glaebhoerl_> otherwise &move is more or less semantically equivalent to pass-by-value and &out to `return`
[13:39:27] <eddyb> Vec::new(a, b, c) works with variadic generics, maybe that's a reason to push for them?
[13:39:44] <eddyb> glaebhoerl_: it's nice that it works through trait objects
[13:39:53] <kimundi> eddyb: Hm? Do you need more reasons to push for them?
[13:40:01] <eddyb> hehe
[13:40:12] <glaebhoerl_> eddyb: yeah, but that can be accomplished other ways like what nmatsakis alludes to
[13:40:25] <eddyb> his allusion is lost on me
[13:40:41] <nmatsakis> glaebhoerl_: this is less flexible than &move , but avoids a third type of references.
[13:40:45] <nmatsakis> and I thnk it's "good enough"
[13:40:49] <nmatsakis> that's mainly why I prefer it
[13:41:12] <eddyb> I did think of a way of passing self by value in traits
[13:41:13] *** Joins: rveach (kvirc@410D297A.C7FE7DD2.1302FB2C.IP)
[13:41:23] <eddyb> I think it was basically &move with no syntax changes
[13:41:29] * kimundi just leans back and listens to the smart people
[13:41:36] <Ms2ger> &move? &out?
[13:41:37] <glaebhoerl_> eddyb: I think the right way to express Vec::new would be uints as generics parameters so you can abstract over the length of a fixed-length array, and/or a macro
[13:41:41] <eddyb> requires a wrapper in the vtable
[13:41:45] <Ms2ger> What year is it?
[13:41:51] <glaebhoerl_> like maybe you could use variadic generics for it, but I don't think it's "the" compelling use case
[13:42:02] <eddyb> glaebhoerl_: I already know "how"
[13:42:08] <glaebhoerl_> (the compelling use case is abstracting over functions/closure with different numbers of arguments)
[13:42:15] <eddyb> and this applies to any container constructor
[13:42:20] <kimundi> Ms2ger: Its 2016, why do you ask?
[13:42:28] <Ms2ger> Eek
[13:42:36] <Ms2ger> What am I doing in a class I took in 2014?
[13:42:48] <kimundi> Dunno, overslept?
[13:42:55] * eddyb slaps Ms2ger around a bit with a trout
[13:43:01] <eddyb> that should help with the amnesia
[13:43:02] <Ms2ger> A wet trout, heathen
[13:43:04] *** Joins: patpat (patpat@moz-1599AAE4.as13285.net)
[13:43:37] <glaebhoerl_> don't see why you got to hurt the trout, it ain't harmed anyone
[13:44:34] <kimundi> (Seriously though, I'd like to see a write up about all these &move, &my, &out etc ideas sometime, even if they are not planned to get implemented)
[13:44:35] <eddyb> nmatsakis: do you have *any idea* what "warn_not_to_commit" and "do_not_commit_warning_issued" were for?
[13:44:41] <eddyb> nmatsakis: I just removed them as dead code
[13:44:44] <glaebhoerl_> (anyway, need to be doing other things atm, just popped in to scold myself for not writing RFCs faster.)
[13:45:03] <eddyb> kimundi: type lambdas!
[13:45:14] <eddyb> let's just throw the cube in
[13:45:43] <glaebhoerl_> (type lambdas is something we probably shouldn't want, if the experience from scala is any guide)
[13:45:49] <kimundi> If I need to start coding 4 dimensionally, I'm gonna get grumpy
[13:46:00] <eddyb> kimundi: and dizzy!
[13:46:05] <eddyb> that's the worst part
[13:46:05] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[13:46:25] <eddyb> glaebhoerl_: I wasn't being serious :)
[13:46:26] <nmatsakis> eddyb: that's fine, they were a hack I put in long ago, there was some compile time switches I would set to true sometimes 
[13:46:28] *** Joins: steffenomak (steffenoma@moz-FB0A4BEB.student.uu.se)
[13:46:36] <nmatsakis> eddyb: and I didn't want to commit the code with those still set to TRUE
[13:46:51] <nmatsakis> eddyb: this was back before we had bors, reviews, or anything but brson + pcwalton and I hacking next to each other
[13:47:04] * nmatsakis waxes nostalgic
[13:47:07] <eddyb> the three rusketeers?
[13:47:11] <nmatsakis> ;)
[13:47:18] <glaebhoerl_> kimundi: again I want to get something written up (though it's competing with like 5 other things I want to get written up), but until then: https://github.com/mozilla/rust/issues/10672#issuecomment-32342797
[13:47:25] *** Joins: io2 (io2@moz-EE406A5.home.otenet.gr)
[13:47:39] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:47:39] <eddyb> nmatsakis: reminds me of the gamedev projects I took part in that all fell out :/
[13:47:49] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[13:47:50] <eddyb> and, well, project pedigree
[13:47:57] <nmatsakis> eddyb: the tree was burning like 75% of the time without bors ;) (actually, that wasn't quite true then, but it was definitely true later)
[13:48:10] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[13:48:23] <eddyb> burning bush
[13:48:31] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[13:49:15] <eddyb> bleah, this cleanup stopped being fun when you have to .sess => .sess() in a million places
[13:49:21] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:49:24] <eddyb> s/you/I/
[13:50:03] <kimundi> Hm, interesting
[13:51:38] <kimundi> So &out == pointer to unitialized memory you can move into, &move == pointer to to initialized memory you can move from and &mut == combination of both, a pointer to initialized memory that you can change but not deinitialize?
[13:52:40] *** Joins: fabiand_ (fabiand@moz-E905B6C.adsl.alicedsl.de)
[13:52:47] *** Quits: fabiand_ (fabiand@moz-E905B6C.adsl.alicedsl.de) (Quit: fabiand_)
[13:53:03] *** Joins: dschatzberg (dschatzber@moz-B15FAF67.bu.edu)
[13:53:35] <eddyb> kimundi: &move out T == &mut T
[13:53:52] <eddyb> that's... interesting
[13:53:56] <glaebhoerl_> ...hm, really?
[13:54:10] <eddyb> mut is actually a contraction of Move oUT =))
[13:54:20] <eddyb> nmatsakis: composability!
[13:55:18] <glaebhoerl_> (oh never mind, I was thinking you wrote `&move &out T == &mut T`, which is untrue)
[13:56:00] <eddyb> in is already a keyword
[13:56:03] <eddyb> let's not also take out
[13:56:24] <eddyb> the concept is purely a philosophical one
[13:56:51] *** Quits: ash_ (ash@7A58EC93.5D486009.8E31DDFD.IP) (Ping timeout)
[13:57:02] *** Quits: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch) (Quit: Leaving.)
[13:57:39] *** Joins: Guest (textual@moz-310FD28A.dynamic.caiway.nl)
[13:58:00] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[13:58:14] *** Quits: Sgeo (quassel@moz-4E71E7BB.dyn.optonline.net) (Connection reset by peer)
[13:58:14] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[13:58:57] <glaebhoerl_> kimundi: anyway basically yes, all three imply temporary ownership of the pointee, &out starts out uninitialized and carries the obligation to initialize, &move is the reverse (initialized -> deinitialized), and &mut starts and ends initialized
[13:58:58] *** Joins: jaras (textual@1CDC5701.A48867D7.52E4E107.IP)
[13:59:33] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:59:49] *** Quits: tav (tav@moz-7F8C7893.range31-52.btcentralplus.com) (Quit: tav)
[13:59:53] *** Joins: Sorella (queen@9D963F5D.DF5D8AE7.54BCAB54.IP)
[13:59:56] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[14:00:12] <eddyb> glaebhoerl_: so if boxing were implementing using a trait
[14:00:29] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[14:00:42] <eddyb> wait, no, nevermind
[14:00:53] *** Joins: Rusky (russell@moz-173BA32C.slkc.qwest.net)
[14:00:54] <glaebhoerl_> not sure what you were going to say, but yes:
[14:00:57] <eddyb> but I was thinking &out could be used outside of a return value
[14:00:57] *** Joins: victorporof (victorporo@moz-FFB76956.cpe.net.cable.rogers.com)
[14:01:16] <eddyb> to enforce the in-place initialization semantics
[14:01:18] <glaebhoerl_> trait Box<T> { fn alloc<'s>(&out 's self) -> &out 's T; }
[14:01:32] <eddyb> yeah, something like that
[14:01:52] <glaebhoerl_> you have an Rc<T>, alloc initializes the Rc part and return the obligation to initialize the T
[14:01:57] <glaebhoerl_> *returns
[14:02:02] <eddyb> and Vec<T> could have a grow method
[14:02:06] <glaebhoerl_> yep
[14:02:07] <eddyb> that returns &out [T]
[14:02:17] <eddyb> interesting stuff
[14:02:27] <glaebhoerl_> hard part is around fail!() :)
[14:02:40] <eddyb> because it's total, yeah :/
[14:02:44] <glaebhoerl_> and "moving out of smart pointers" / "DerefMove" in general
[14:04:32] <eddyb> DerefMove will be hard to implement for something like Uniq<T>
[14:04:40] <eddyb> current method lookup will break
[14:05:21] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Quit: Leaving.)
[14:06:20] <glaebhoerl_> (further interesting points: if you make an `&out` to an initialized `let mut` variable, that implies first deinitializing it, just like when you do assignment. and the difference between affine types and linear types is that affine can be used *at most* once, while linear has to be used *exactly* once. based on this, Rust types with destructors are *linear*: the exactly one use is either the code explicitly moving out of it, or 
[14:06:22] <glaebhoerl_> failing that, the destructor "using" it.)
[14:06:23] *** Joins: leowoe (Leo@moz-CEF2400C.inf.uni-konstanz.de)
[14:06:55] <glaebhoerl_> (and then &mut would be affine, though I guess you could also think of it as having an empty destructor...)
[14:07:16] * nmatsakis reads scrollback briefly
[14:07:54] <eddyb> glaebhoerl_: &mut is already affine
[14:07:54] <nmatsakis> &out WOULD be handy but I'm not sure how to cope with failure (plus we are all wary of a third ref type)
[14:08:10] <eddyb> maybe try to implement in the library?
[14:08:17] <glaebhoerl_> eddyb: I didn't mean would in a future tense sense
[14:08:30] <glaebhoerl_> just... "following this logic" or smth
[14:08:38] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[14:08:51] *** Joins: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch)
[14:09:08] *** Joins: puzzler (puzzler@moz-CD721145.hsd1.mi.comcast.net)
[14:09:16] *** Quits: awidegreen (awidegreen@moz-DAF62FE3.dip0.t-ipconnect.de) (Ping timeout)
[14:09:31] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[14:11:47] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[14:12:02] *** Joins: jackneill (jackneill@moz-AF0277B.pool.digikabel.hu)
[14:12:34] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[14:13:43] *** Joins: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se)
[14:13:49] *** Quits: nical (nico@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[14:13:50] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[14:14:02] *** Joins: sbalmos (quassel@CA5677B6.576D0C1.ED2EFC1B.IP)
[14:14:34] *** Quits: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP) (Ping timeout)
[14:14:53] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[14:15:05] *** Joins: nical (nico@87C1F78E.1DE10CA8.D8E68FF6.IP)
[14:15:38] *** Joins: kngl (Adium@moz-18BD1C.ipv4.evonet.be)
[14:16:11] <glaebhoerl_> nmatsakis: there's two-and-a-half separate issues around &out and failure: (1) what if something else fails during an &out borrow, and (2) what if the &out is dropped and its destructor runs and invokes fail!(). (1) is not actually a problem, because the &out's destructor will then be invoked, and then you have failing-while-failing and process abort (not pretty, but not unsafe). (2), if the &out points to a stack var, is also not a 
[14:16:13] <glaebhoerl_> problem, because before the &out borrow ends, the stack var is still considered uninitialized (so its destructor won't run). (2), if the &out points inside a smart pointer alloc (as with `trait Box` and `Rc` above), *is* a problem, but it's exactly the same problem as you have around `DerefMove`.
[14:16:32] *** Quits: awidegreen (awidegreen@moz-9FADBE94.a357.priv.bahnhof.se) (Ping timeout)
[14:16:33] *** Joins: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP)
[14:17:13] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[14:17:29] <nmatsakis> What &out destructor?
[14:17:58] <nmatsakis> hmm
[14:18:03] <glaebhoerl_> well the idea was that the obligation to initalize would be enforced dynamically, by having &out's destructor invoke fail!()
[14:18:18] <nmatsakis> oh ok, I didn't know that part ;)
[14:18:30] <eddyb> can't you enforce it statically?
[14:18:41] <eddyb> if it's part of the language
[14:18:51] *** Joins: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca)
[14:18:57] *** Quits: Guest (textual@moz-310FD28A.dynamic.caiway.nl) (Quit: Computer has gone to sleep.)
[14:19:06] <glaebhoerl_> nmatsakis: (iirc we discussed it in the github issue, which is why I assumed it)
[14:19:09] <eddyb> I guess we don't have a must_use-like concept that is enforced
[14:19:18] <nmatsakis> glaebhoerl_: perhaps so, sorry, forgot :)
[14:20:09] <eddyb> so that's what linear means?
[14:20:13] <eddyb> affine + must use
[14:20:19] <glaebhoerl_> eddyb: yeah the issue is around generic functions
[14:20:34] <glaebhoerl_> there's no way to prevent a generic fn from dropping a value
[14:20:38] <eddyb> oh, the opt-in annotation issue
[14:20:43] <eddyb> (also seen with unsized)
[14:20:59] *** Joins: tgkokk (tgkokk@moz-E589AF21.home.otenet.gr)
[14:21:05] <glaebhoerl_> you could make it work by requiring explicit `T: Drop` bounds on all fns that want to drop a T, but that would be onerous and not worth it imo
[14:21:28] <eddyb> I'd rather have a kind for it
[14:21:42] <eddyb> <T: !NotLinear>
[14:21:47] <glaebhoerl_> so to be clear the idea is that &out's destructor would fail!(), *and* if the compiler can see the types, and sees that an &out isn't being initialized, it would issue a warning or an error
[14:22:01] <eddyb> in the spirit of <T: !Sized>
[14:22:17] <glaebhoerl_> so fail!() would only be a "runtime surprise" if you actually do pass &out to a generic fn which drops it
[14:22:20] <eddyb> glaebhoerl_: that's sketchy
[14:22:41] <eddyb> I'd rather allow such linear values explicitly
[14:22:42] *** Joins: arturo (Thunderbir@moz-4F69776.superkabel.de)
[14:23:13] *** Joins: Guest (textual@moz-310FD28A.dynamic.caiway.nl)
[14:23:27] <eddyb> nmatsakis: hmm, was a non-textual annotation for unsized type bounds considered?
[14:23:42] <eddyb> @ looks fat to me, though it may cause confusion
[14:23:52] <eddyb> T+?
[14:24:04] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[14:24:07] <nmatsakis> I didn't consider it
[14:24:17] <nmatsakis> but could be nice
[14:24:24] <eddyb> we need to strike a good balance
[14:24:59] <nmatsakis> note that `unsized` is not the same as `!Sized` -- that is, unsized would mean *might not be sized* not *known not to be sized*
[14:25:16] <eddyb> my !Trait is whacky
[14:25:23] <nmatsakis> (something I realized yesterday while toying around with different notations)
[14:25:30] <glaebhoerl_> anyway, I really do need to be doing other things right now, so discussion T.B.C. some other time :)
[14:25:33] <eddyb> I use it mostly to mean "remove this built-in bound"
[14:25:39] * glaebhoerl_ goes back to doing the other things
[14:25:50] <eddyb> -Sized might make more sense then
[14:26:20] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[14:26:23] <eddyb> <T: Foo - Sized> hehe
[14:26:44] <hhhhhhhhhh> i am trying to put a UnionWorld (http://ix.io/aWO) in an Arc and i get this: instantiating a type parameter with an incompatible type `worlds::union::UnionWorld`, which does not fulfill `Freeze`
[14:26:52] <eddyb> glaebhoerl_: I think we already have type lambdas...
[14:26:55] <hhhhhhhhhh> i don't see why UnionWorld doesn't fulfill freeze
[14:27:06] *** Joins: Kynes (Kynes@moz-3DC6C6E7.mit.edu)
[14:27:15] <eddyb> glaebhoerl_: it's slightly more visible in rust because our pointers are on the left
[14:27:35] <eddyb> which means type @T = Rc<T>; suddenly makes more sense
[14:28:01] <eddyb> type Foo<A, B> = (B, A); is a type lambda. you just can't be generic over it
[14:28:14] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[14:28:25] <eddyb> I guess it's a function? and a lambda would be inline?
[14:28:35] * eddyb goes back to simple monkey refactoring
[14:29:51] *** Joins: FreeFull (freefull@moz-FCD0664E.as13285.net)
[14:30:16] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[14:30:32] *** Quits: arturo (Thunderbir@moz-4F69776.superkabel.de) (Ping timeout)
[14:32:00] <kimundi> hhhhhhhhhh: What is the definition of Wolrd?
[14:32:03] <kimundi> World*
[14:32:04] *** Joins: jforcada (Mibbit@moz-999BCFEA.red-80-28-98.adsl.static.ccgg.telefonica.net)
[14:32:06] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[14:32:18] <hhhhhhhhhh> kimundi: a trait with intersects/intersection methods
[14:32:45] <kimundi> ah, its a trait, my bad
[14:33:12] <kimundi> does pub struct UnionWorld {	w1 : ~World:Freeze,	w2 : ~World:freeze,} work?
[14:33:16] <glaebhoerl_> that's not what's referred to as type lambdas... iirc type lambdas are if you already have HKT, and you also allow higher-kinded type variables which represent functions on types (as opposed to just type constructors). but I might not be remembering totally precisely.
[14:33:22] <glaebhoerl_> (^eddyb)
[14:33:29] <kimundi> I think trait objects are per default just asumed to have the Send bound
[14:33:37] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[14:33:58] <hhhhhhhhhh> kimundi: UnionWorld::new starts throwing: mismatched types: expected `~worlds::World:Freeze` but found `~worlds::World:Send`
[14:34:03] *** Quits: rveach (kvirc@410D297A.C7FE7DD2.1302FB2C.IP) (Ping timeout)
[14:34:17] <eddyb> glaebhoerl_: so <T> Result<Vec<T>, IoError> would be a type lambda?
[14:34:23] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[14:34:27] <eddyb> bleah he left
[14:34:32] <kimundi> ~World:Freeze+Send
[14:34:52] <kimundi> (Unless you don't care about Send)
[14:35:03] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[14:35:08] <hhhhhhhhhh> expected bounds `Send+Freeze` but found bounds `Send`
[14:35:17] <hhhhhhhhhh> i need to put it in an Arc so i need Send
[14:35:26] <kimundi> Both the struct fields and the new signature ned to take the same type
[14:35:31] <hhhhhhhhhh> oh right
[14:35:34] <eddyb> hhhhhhhhhh: replace ~World with ~World:Freeze+Send everywhere
[14:35:43] <kimundi> so ~World:Send+Freeze for both I think
[14:35:44] <hhhhhhhhhh> ok that compiles
[14:35:45] <hhhhhhhhhh> thanks
[14:36:19] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:36:20] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[14:36:21] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:36:33] <hhhhhhhhhh> what exactly does this syntax mean
[14:37:22] <kimundi> hhhhhhhhhh: Okay, so a trait object like ~World can contain any type that implements World, and allows you to call the methods of World on it
[14:37:42] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Quit: Leaving...)
[14:38:18] <kimundi> hhhhhhhhhh: That type itself can implement other traits though, and have other properties, which while not relevant to the API of the trait object, are relevant for the situations where you can use the type
[14:38:44] *** Joins: maximilian (max@moz-493D272A.ethz.ch)
[14:38:54] <nmatsakis> eddyb: I was seriously considering -Sized :)
[14:38:56] <hhhhhhhhhh> so i could also do something like f( w : World : Show ) { println!( "{}", w ); }
[14:39:07] <hhhhhhhhhh> even if World does not require an impl of Show
[14:39:11] <eddyb> no, sadly
[14:39:12] <kimundi> hhhhhhhhhh: Not really, for reasons I don't know
[14:39:17] <eddyb> those are builtin bounds
[14:39:20] <hhhhhhhhhh> rofl ok
[14:39:24] <hhhhhhhhhh> but close enough?
[14:39:30] <eddyb> empty kind traits that specify properties
[14:39:43] <eddyb> World+Show (if it were valid syntax) would be one way
[14:39:56] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:40:04] <kimundi> hhhhhhhhhh: Send and Freeze are build in traits that types automatically implement. They signify properties of the type
[14:40:08] <eddyb> (valid syntax and the feature being implemented, that is)
[14:40:32] <hhhhhhhhhh> ok
[14:40:41] <hhhhhhhhhh> cheers again :p
[14:40:58] <kimundi> hhhhhhhhhh: "Send" means the type deeply owns everything in it, which means it can be taken as one isolated value and put anywhere, including send between tasks
[14:41:46] <kimundi> hhhhhhhhhh: "Freeze" means the type is deeply immutable, which is important if you want to share references to it between different tasks like with Arc
[14:41:56] <hhhhhhhhhh> alright
[14:42:18] <eddyb> Pod is plain old data
[14:42:20] <kimundi> For example something like Rc<T> is not Freeze, because it reference counts in a non-atomic way
[14:42:30] <eddyb> are there other kinds?
[14:42:47] <kimundi> Pod, Send, Freeze, 'static ... 
[14:43:05] <eddyb> I always forget 'static
[14:43:36] *** Quits: dranov (dranov@6AB7D91E.82C4B75C.FB866788.IP) (Ping timeout)
[14:44:11] *** Quits: mawuli (mawuli@moz-A89BBCE.com.gh) (Ping timeout)
[14:44:13] <kimundi> hhhhhhhhhh: So "~Trait:Send+Freeze" is a different type than "~Trait:", the first one is restricted to only those types implementing trait that are also Freeze and Send, while the latter can contain literally all types implementing Trait
[14:44:30] <hhhhhhhhhh> yeah
[14:44:50] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[14:45:22] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[14:45:32] *** Joins: bollu (bollu@31CCE710.7065DDB9.6D6A344F.IP)
[14:45:46] *** Quits: aeqwa (aeqwa@moz-F798473B.dsl.tropolys.de) (Quit: WeeChat 0.4.3)
[14:45:58] <bollu> how would I do a ternary operator like thing in rust?
[14:46:02] *** Quits: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP) (Ping timeout)
[14:46:12] <bollu> myVariable = if something (someValue) else (otherValue)
[14:46:14] <doomlord_> if {} else {}
[14:46:24] <doomlord_> literally like that
[14:46:33] <bollu> doomlord_: O_O those are /expressions/ in rust?
[14:46:37] <doomlord_> rust statements are usually expressions :) yes
[14:46:43] <doomlord_> match is aswell , really nice
[14:46:45] <eddyb> everything is an expression in rust
[14:46:47] <bollu> respect x1000
[14:46:49] <bollu> thanks!
[14:46:51] <eddyb> that is not an item
[14:46:57] <eddyb> statements are purely syntax sugar :P
[14:47:27] <bollu> man, I lurve rust!
[14:47:28] <doomlord_> if you talk to a PURE functoinal programmer, they'll tell you its statements still :)
[14:47:35] <eddyb> (I'm technically slightly exaggerating)
[14:47:35] <kimundi> nmatsakis: You are the type system expert, what would the difference be between these (partially hypothetical) notations be? `~TraitA:TraitB`, `~TraitA+TraitB` and `~TraitAB, with TraitAB: TraitA+TraitB` ?
[14:47:36] <bollu> doomlord_: no thank you ;)
[14:47:46] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[14:47:49] <kimundi> (As in, are they all distinct?)
[14:47:49] <eddyb> but you can consider ; to be an operator
[14:47:54] <doomlord_> Rust is multiparadigm but with a more functional flavour than c++ ... i like it 
[14:48:03] <eddyb> that ignores the value of the previous expression
[14:48:17] <bollu> eddyb: the way ; at the end of a block returns nothing?
[14:48:21] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[14:48:23] <doomlord_> yes
[14:48:29] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[14:48:38] *** Quits: Ms2ger (Ms2ger@moz-7A72B442.ugent.be) (Ping timeout)
[14:49:07] <doomlord_> its a lovely language now if only i could figure out the android build process :)
[14:49:08] <kimundi> I always see { ... expr; } as suagr for { ... expr; () }
[14:49:15] *** Quits: tgkokk (tgkokk@moz-E589AF21.home.otenet.gr) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[14:49:23] <eddyb> operator;<T, U>(_: T, value: U) -> U {value}
[14:49:35] <nmatsakis> kimundi: uuuuh... :) hard to say what hypothetical syntax might mean
[14:49:36] <eddyb> the value can be empty as sugar for ()
[14:49:44] <doomlord_> does C++14 infer lambda types as well as rust does yet
[14:49:53] <nmatsakis> kimundi: but I guess ~(TraitA+TraitB) would be an object with two vtables
[14:50:02] <nmatsakis> kimundi: ~TraitA:TraitB would not be legal 
[14:50:27] *** Joins: teosz (teosz@5D5DCF1A.2AC6D428.9E74FAD6.IP)
[14:50:30] <nmatsakis> kimundi: (because -- as I interpret it -- the `:` syntax is used for traits with no methods, i.e., bounds that just restrict the set of types )
[14:50:41] <kimundi> nmatsakis: Yeah, I realize the question is kinda unanswerable :) Mainly I'm just confused to this day why we have trait bounds, if trait inhertance would express the same thing in my mind
[14:50:43] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[14:50:45] <nmatsakis> kimundi: and ~TraitAB would be an object with one vtable (the trait TraitAB)
[14:50:48] *** Quits: jforcada (Mibbit@moz-999BCFEA.red-80-28-98.adsl.static.ccgg.telefonica.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:50:49] <eddyb> doomlord_: auto auto = auto auto?
[14:51:04] <eddyb> needs more punctuation but you get the idea
[14:51:07] <bollu> eddyb: what?
[14:51:12] <nmatsakis> kimundi: well, adding a new trait is not the same --
[14:51:20] <nmatsakis> kimundi: take TraitAB for example
[14:51:22] *** Joins: benjamin_____ (benjamin@moz-7273BCF0.dip0.t-ipconnect.de)
[14:51:29] <kimundi> yeah
[14:51:36] <nmatsakis> kimundi: even if TraitAB doesn't add any new methods, just because you implement TraitA and TraitB doesn't mean you implement TraitAB,
[14:51:37] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[14:51:45] <kimundi> true
[14:51:49] <nmatsakis> kimundi: i.e. maybe implementing TraitAB is a way to indicate that you meet some add'l semantic requirements
[14:51:58] <eddyb> nmatsakis: I would think ~(TraitA+TraitB) would have one vtable, like TraitAB
[14:52:06] <eddyb> nmatsakis: instead of, you know, being unsized*2
[14:52:07] *** Quits: benjamin_ (benjamin@moz-A67B45F0.dip0.t-ipconnect.de) (Ping timeout)
[14:52:49] <nmatsakis> eddyb: I guess it depends how we wanted to do it, I'd have to work it all through, but I think there are transformatoins you'd like to do that are trivial if you have N vtables and hard otherwise
[14:53:10] <nmatsakis> maybe not though, maybe you can always encode it with a tree of vtables
[14:53:15] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Connection reset by peer)
[14:53:20] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[14:53:23] <eddyb> the layout will always be the same
[14:53:33] <eddyb> so it's not like you have dynamic offsets
[14:53:33] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[14:53:43] *** Quits: teosz (teosz@5D5DCF1A.2AC6D428.9E74FAD6.IP) (Connection reset by peer)
[14:53:57] <bollu> in rSFML, I'm able to use WindowStyle Close but not any of the other styles
[14:53:59] <nmatsakis> I'm thinking primarily of coercing from ~(TraitA+TraitB) to ~TraitA
[14:54:00] <bollu> http://rust-sfml.org/doc/rsfml/window/enum.WindowStyle.html <- docs
[14:54:03] <bollu> any idea why?
[14:54:11] <nmatsakis> but I guess that's not particularly different
[14:54:25] <bollu> I literally replace "Close" with "Fullscreen" and I get an unresolved name error
[14:54:25] <eddyb> nmatsakis: it's not different than upcasting TraitAB
[14:54:37] <eddyb> nmatsakis: and it fits well with the DST5 transforms
[14:54:38] <nmatsakis> sure. ok.
[14:55:08] *** Quits: Guest (textual@moz-310FD28A.dynamic.caiway.nl) (Quit: Computer has gone to sleep.)
[14:55:20] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[14:55:21] <eddyb> being about to coerce ~MultiContraption to &Any is one of the nice things I want :D
[14:55:30] <mrmonday> whoever came up with bootstrapping compilers? what a pita :<
[14:55:35] *** Joins: WebeWizard (WebeWizard@moz-7CCD1DAE.ks.ks.cox.net)
[14:55:40] <eddyb> mrmonday: make rustc-stage1
[14:55:49] <eddyb> also, Many might even end up in the libstd
[14:56:24] <eddyb> one usecase I can imagine is optional Show impls in something like task failure that now uses Any
[14:56:26] <bollu> is there any way I can check a crate for symbols and stuff?
[14:56:34] <eddyb> bollu: how low level?
[14:56:45] <mrmonday> eddyb: it's mostly annoying because of my unmerged changes, so I have to build master, then checkout my branch and build that
[14:56:45] <eddyb> there's always nm, objdump and rabin2
[14:56:46] <bollu> eddyb: higher the better
[14:57:07] <eddyb> mrmonday: why build master?
[14:57:26] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[14:57:27] <eddyb> bollu: I have a script prettifying some of the mangling hacks we use
[14:57:50] *** Joins: bjustin (bjustin@moz-8FC28563.sierrabravo.net)
[14:57:50] <eddyb> c++filt does well for the simple contexts
[14:57:54] *** Joins: bakkdoor (bakkdoor@moz-F108DEDE.dip.osnanet.de)
[14:58:38] *** Joins: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP)
[14:58:44] *** Joins: orospakr (orospakr@moz-4514BEF2.cpe.teksavvy.com)
[14:59:15] <bollu> eddyb: I want to see what's in the WindowStyle enum of rSFML
[14:59:19] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Ping timeout)
[14:59:28] <bollu> cause I'm not able to access some of it's members
[14:59:32] <eddyb> that won't show up in symbols
[14:59:35] <eddyb> just look at the source
[14:59:47] <mrmonday> eddyb: I can never seem to get my stuff to build otherwise if I pull but haven't merged for a while
[14:59:57] <bollu> eddyb: grepping didn't reveal anything. It's referenced all over the place but it's never defined as far as I can see
[15:00:02] <eddyb> mrmonday: git pull --rebase parent master
[15:00:10] <kimundi> nmatsakis: I'm always thinking that maybe one could make a "trait bound" a seperate thing. Like, "TraitA + TraitB + TraitC" becomes a notation for a single trait bound, and not the syntax for specifying multiples. Then bound generics and trait objects would restrict their content with this notation: fn foo<T: A+B> takes the trait bound "A+B", and ~A+B is a trait object that can contain only those types fulfilling this bound. Which would ma
[15:00:10] <kimundi> ke fn foo<T: A+Freeze>> and ~A+Freeze analogue for example. But maybe this is not a useful way to split it up...
[15:00:10] <canhtak> bollu: the others style should work they are reexport in the window module.
[15:00:11] <eddyb> mrmonday: or upstream master, depends how you named your mozilla remote
[15:00:17] <bollu> nvm, found it 
[15:00:21] <mrmonday> only way to get it working seems to be to pull, compile master, then switch to my branch pull/merge and compile
[15:00:25] <bollu> eddyb: thanks for the help
[15:00:30] <bollu> canhtak: you too :)
[15:00:33] <canhtak> bollu: you should access them like this : se rsfml::window::Fullscreen
[15:00:37] <canhtak> oh ok
[15:00:51] *** Quits: josh (josh@moz-C1D9FC5F.meeting.ietf.org) (Quit: josh)
[15:01:04] <bollu> canhtak: will try that
[15:01:07] <eddyb> mrmonday: that means you're doing it wrong
[15:01:34] <eddyb> there's at least like 5 modes you can screw up even the simplest of setups
[15:01:39] *** Quits: kris (kris@moz-147EE6DF.diku.dk) (Ping timeout)
[15:01:41] <mrmonday> I don't doubt it, but it's the only way it seems to work :<
[15:01:42] <eddyb> s/modes/ways
[15:01:51] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[15:01:51] <bollu> canhtak: Thanks, that worked
[15:01:58] <eddyb> mrmonday: did you try git pull --rebase mozilla-remote master?
[15:02:05] *** Joins: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP)
[15:02:06] <eddyb> that's what I use to update my branch
[15:02:14] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:02:16] <bollu> canhtak: can I include it in some way so that I don't have to refer to the complete path
[15:02:24] <bollu> eddyb: why rebase? won't pull work? >_<
[15:02:28] *** Joins: josh (josh@moz-C1D9FC5F.meeting.ietf.org)
[15:02:30] <eddyb> pull merges
[15:02:33] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[15:02:40] <eddyb> you don't want merge when you have a working branch
[15:02:57] <kimundi> eddyb: I sMany making progress?
[15:03:06] <eddyb> kimundi: need DST to clean it up a bit
[15:03:08] <bollu> eddyb: that's only if you're messing around with your history yes?
[15:03:10] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[15:03:12] <eddyb> the basic design is there and simple
[15:03:27] <canhtak> bollu: you can include it like you include every think else, in the same way that you include Close.
[15:03:30] <kimundi> Stuff like dynamically querying for and calling a trait is stuff I'd like to see possible
[15:03:38] <eddyb> bollu: rebase makes it look like you made all the changes after the last merged PR in mozilla/master
[15:03:47] <bollu> eddyb
[15:03:50] <eddyb> kimundi: you can implement it as a lookup in a hashmap of vtables :P
[15:04:07] <eddyb> bollu: which you need to keep PRs clean
[15:04:18] <mrmonday> eddyb: yup, but my branch rarely compiles straight off after that :(
[15:04:18] <eddyb> otherwise there will be merge commits in your PR
[15:04:22] <eddyb> which is nono
[15:04:28] <bollu> eddyb: hmm, yeah. true.
[15:04:43] <eddyb> rebase is simpler to deal with when it breaks
[15:05:00] <eddyb> I wish git stash pop rebases by default
[15:05:08] <bollu> canhtak: I'm an idiot >_<. Thanks!
[15:05:59] *** Quits: josh (josh@moz-C1D9FC5F.meeting.ietf.org) (Quit: josh)
[15:06:41] <canhtak> bollu: no problem ! i've write the sfml bindings so if you have problems and if i'm here feel free to tell me!
[15:06:48] <nmatsakis> kimundi: yeah there is some kind of generalization possible there
[15:06:49] <bollu> rusti: let x = if true { 1; } else { 2; } ; x
[15:06:49] -rusti- ()
[15:06:59] <bollu> canhtak: thanks for the help :)
[15:07:04] <bollu> what type is x ?
[15:07:13] <bollu> empty tuple?
[15:07:53] *** Joins: ChrisOei (cinch@moz-30D80888.hsd1.ca.comcast.net)
[15:08:16] *** Quits: canhtak (canhtak@moz-46C3B4C8.wl.t.ulaval.ca) (Quit: canhtak)
[15:08:31] <edwardw> bollu: it is a unit
[15:08:57] <eddyb> (also known as a 0-tuple)
[15:09:03] <eddyb> well, 0-tuple aka unit
[15:09:15] *** Quits: io2 (io2@moz-EE406A5.home.otenet.gr) (Quit: )
[15:09:17] <eddyb> bollu: are the semicolons intentional?
[15:09:21] <eddyb> rusti:  if true { 1 } else { 2 }
[15:09:22] -rusti- 1
[15:09:25] <bollu> eddyb: yep. was checking
[15:09:37] <bollu> rusti: let x :int = if true { 1; } else { 2; } ; x
[15:09:37] -rusti- <anon>:10:22: 10:48 error: mismatched types: expected `int` but found `()` (expected int but found ())
[15:09:37] -rusti- <anon>:10         let x :int = if true { 1; } else { 2; } ; x
[15:09:38] -rusti-                                ^~~~~~~~~~~~~~~~~~~~~~~~~~
[15:09:38] -rusti- error: aborting due to previous error
[15:09:38] -rusti- application terminated with error code 101
[15:09:42] <bollu> nice
[15:09:42] *** Quits: bakkdoor (bakkdoor@moz-F108DEDE.dip.osnanet.de) (Quit: Linkinus - http://linkinus.com)
[15:10:02] <bollu> eddyb: is there anyway to force you to use return at the end of a block?
[15:10:18] <eddyb> return as in, "return foo;"?
[15:10:20] <bollu> eddyb: I think that the ; at the end of a block is a disaster waiting to happen kind of thing
[15:10:21] *** Quits: mojoB (mojoB@moz-A4312114.static.exetel.com.au) (Ping timeout)
[15:10:23] <bollu> eddyb: yes
[15:10:32] <eddyb> return returns from the current function
[15:10:38] <kimundi> bollu: In practice, it actually isn't
[15:10:40] <eddyb> rusti:  if true { 1 } else { 2; }
[15:10:40] -rusti- pastebinned 5 lines of output: http://sprunge.us/NBMd
[15:10:46] <eddyb> there's an error for that
[15:10:51] <eddyb> usually you get type mismatches
[15:11:09] <bollu> eddyb: that makes sense. 
[15:11:11] <kimundi> bollu: "return foo;" Can be seen as _strictly_ early return from a function
[15:11:29] <eddyb> code is so much cleaner without return
[15:11:39] <bollu> eddyb: a matter of perspective I think :)
[15:11:43] <eddyb> value flow is natural in Rust
[15:11:48] <eddyb> bollu: you'll get used to it
[15:11:48] <kimundi> As in, fn foo() { return; } could be seen as returning early, before the implicit () expression at the end is reached
[15:11:53] <edwardw> expression wins!
[15:11:54] *** Quits: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch) (Quit: Leaving.)
[15:12:02] <eddyb> kimundi: and the () at the end becomes !
[15:12:02] <bollu> kimundi: Yep, got what you meant
[15:12:08] <eddyb> and whatnot
[15:12:13] *** Joins: maxli (Instantbir@moz-1650391B.hsd1.ca.comcast.net)
[15:12:39] <eddyb> return; has type !, if true {return;} has type (), because it may not always return
[15:12:50] <eddyb> rusti: let x = return; x
[15:12:51] -rusti- pastebinned 8 lines of output: http://sprunge.us/KAKN
[15:12:53] <bollu> ! is a ... type?
[15:13:03] <kimundi> I also was skeptical at first... But its really no problem in practice, and you very soon get the problem of _not_ having this in other languages ;)
[15:13:12] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[15:13:13] <eddyb> bollu: the above example is not a type error per say
[15:13:21] <eddyb> bollu: it's an inference error
[15:13:22] <FreeFull> Return is first-class?
[15:13:24] *** Quits: ChrisOei (cinch@moz-30D80888.hsd1.ca.comcast.net) (Client exited)
[15:13:25] <eddyb> yupp
[15:13:28] <eddyb> like everything else
[15:13:38] <FreeFull> So if you put return in x, what can you do with it?
[15:13:40] <bollu> eddyb: that makes no sense >_<
[15:13:44] <sp3d> bollu: https://en.wikipedia.org/wiki/Bottom_type
[15:13:45] <eddyb> FreeFull: nothing, it's !
[15:13:54] <bollu> bollu: oh, oh, can I write continuations with it?
[15:13:57] <FreeFull> So there is no point doing that?
[15:13:58] <eddyb> rusti: let x = return; ()
[15:13:59] -rusti- pastebinned 8 lines of output: http://sprunge.us/VCEJ
[15:14:09] *** Joins: aravindavk (aravinda@92FE829C.82463742.C28A6AA4.IP)
[15:14:16] <eddyb> that () has type !. it propagates excessively
[15:14:16] <bollu> like, store the return at a point, pass it around and then execute that return somewhere else?
[15:14:19] <bollu> that would be awesome!
[15:14:21] <eddyb> bollu: nope
[15:14:26] <bollu> eddyb: aww
[15:14:40] <eddyb> it's not impossible, but our return produces a value which means "unreachable"
[15:14:40] <FreeFull> rusti: if true { let x = return; }; ()
[15:14:41] -rusti- <anon>:10:23: 10:33 error: cannot determine a type for this local variable: unconstrained type
[15:14:41] -rusti- <anon>:10         if true { let x = return; }; ()
[15:14:41] -rusti-                                 ^~~~~~~~~~
[15:14:41] -rusti- error: aborting due to previous error
[15:14:41] -rusti- application terminated with error code 101
[15:14:46] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[15:14:56] <eddyb> FreeFull: oh yeah, locals and stuff can't have !
[15:15:07] <eddyb> sorry for the confusion that may have caused :P
[15:15:31] <eddyb> rusti: if true { let x: int = return; }; ()
[15:15:32] -rusti- <anon>:10:23: 10:24 warning: unused variable: `x`, #[warn(unused_variable)] on by default
[15:15:32] -rusti- <anon>:10         if true { let x: int = return; }; ()
[15:15:32] -rusti-                                 ^
[15:15:41] <kimundi> rusti: let x: ! = fail!("foo"); x
[15:15:41] <eddyb> rusti: if false { let _x: int = return; }; ()
[15:15:42] -rusti- <anon>:10:16: 10:17 error: expected type, found token NOT
[15:15:42] -rusti- <anon>:10         let x: ! = fail!("foo"); x
[15:15:42] -rusti-                          ^
[15:15:42] *** Joins: mojoB (mojoB@moz-A4312114.static.exetel.com.au)
[15:15:42] -rusti- application terminated with error code 101
[15:15:42] -rusti- ()
[15:15:48] <kimundi> haha
[15:15:49] <bollu> eddyb: if a person has a degree in semantics, can I expect them to know about bottom and the hindley milner type system?
[15:15:51] <eddyb> kimundi: only in return types
[15:15:59] <kimundi> yeah
[15:15:59] <FreeFull> rusti: if true { let x : int = return; x }
[15:15:59] -rusti- pastebinned 6 lines of output: http://sprunge.us/LNDa
[15:16:05] *** Joins: Guest (textual@moz-310FD28A.dynamic.caiway.nl)
[15:16:08] <eddyb> bollu: ! just means impossible aka unreachable in Rust
[15:16:10] <FreeFull> rusti: if true { let x : int = return; x } else { 0 }
[15:16:11] -rusti- pastebinned 6 lines of output: http://sprunge.us/QWKM
[15:16:25] <FreeFull> I see
[15:16:28] <bollu> rusti: {return return } //I expect a syntax error
[15:16:29] -rusti- pastebinned 8 lines of output: http://sprunge.us/jWcM
[15:16:34] <eddyb> FreeFull: x gets ! because it's after return
[15:16:47] <eddyb> bollu: you can only put ! in return types, meaning "this function will never return"
[15:16:47] <FreeFull> So the return in the let gets executed
[15:16:50] <maximilian> Is there a way to shape a pointer coming from C into a multidimensional vector/array?
[15:17:01] <eddyb> maximilian: not yet
[15:17:05] <maximilian> I can get it into a vector using "Cvec"
[15:17:06] <maximilian> ok
[15:17:06] *** Quits: Guest (textual@moz-310FD28A.dynamic.caiway.nl) (Quit: Computer has gone to sleep.)
[15:17:14] <eddyb> maximilian: DST will hopefully include [[[T]]] and such abstractions
[15:17:33] <maximilian> eddyb: DST?
[15:17:38] <eddyb> dynamically sized types
[15:17:39] <bollu> eddyb: what's the point of that? 
[15:17:40] <maximilian> ah
[15:17:44] <eddyb> which would be (*T, uint, uint, uint)
[15:17:50] <eddyb> bollu: functions that can't return? abort
[15:17:50] <sp3d> rusti: fn f() -> () {return return return return return}
[15:17:51] -rusti- <anon>:10:9: 10:58 warning: code is never used: `f`, #[warn(dead_code)] on by default
[15:17:51] -rusti- <anon>:10         fn f() -> () {return return return return return}
[15:17:51] -rusti-                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[15:17:51] -rusti- ()
[15:17:59] <bollu> eddyb: ah, I see
[15:18:01] <eddyb> bollu: failure
[15:18:01] <kimundi> maximilian: http://smallcultfollowing.com/babysteps/blog/2014/01/05/dst-take-5/
[15:18:05] <sp3d> return return return!
[15:18:08] <bollu> lol 
[15:18:15] <bollu> yeah, that was cool :)
[15:18:32] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[15:19:07] <bollu> rusti: fn f () -> | | -> () { return | | } //is this correct? I think not...
[15:19:07] -rusti- <anon>:10:43: 10:44 error: unexpected token: `}`
[15:19:07] -rusti- <anon>:10         fn f () -> | | -> () { return | | } //is this correct? I think not...
[15:19:07] -rusti-                                                     ^
[15:19:07] -rusti- application terminated with error code 101
[15:19:20] <bollu> okay, whoops. how do I return a lambda?
[15:19:23] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[15:19:26] <kimundi> becuase the ! type unifies with everything, you can do stuff like "let x = match foo { A => "A", B => "B", C => return;  };" and not get atype error
[15:19:52] <nmatsakis> whoever wrote this, I am grateful: # <help> \(^o^)/
[15:19:52] <nmatsakis> #
[15:19:52] <nmatsakis> # Greetings, adventurer! The Rust Build System is at your service.
[15:19:53] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[15:20:02] <kimundi> haha
[15:20:08] <kimundi> nmatsakis: where is that written?
[15:20:12] <nmatsakis> kimundi: in the Makefile
[15:20:20] <edwardw> "make help
[15:20:26] <edwardw> "make help"
[15:20:40] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[15:20:43] <kimundi> haha
[15:21:02] <FreeFull> How do I check if an integer is in a certain range? Is there a method for it, or should I just use  x > a && x < b?
[15:21:04] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[15:21:49] <kimundi> btw, I think there is something broken in the makefile: "make check-stage1" seems to not build libsyntax and then complains
[15:22:22] <kimundi> FreeFull: Don't think we have something fancier than that
[15:22:47] *** Joins: jdsanders (Adium@moz-EB8DC389.hlrn.qwest.net)
[15:22:51] <kimundi> I guess in theory one could write something like range(a,b).is_inside(x)
[15:23:08] <eddyb> a..b.contains(x)
[15:23:14] <FreeFull> sp3d: All those returns remind me of how in Haskell you can do do do do do do do do
[15:23:16] <eddyb> I would love to see that work
[15:23:42] *** Quits: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl) (Quit: Computer gone to sleep - Zzzz...)
[15:23:47] <kimundi> FreeFull: We could do do do do do in Rust do, before we got rid of do  :(
[15:24:01] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[15:24:09] <bollu> kimundi: can we implement python's sweet "min < x < max"
[15:24:23] <bollu> royal we of course :)
[15:24:27] <eddyb> at least in Rust it would be a type error to do bool < int
[15:24:29] <FreeFull> bollu: I'd rather not have that sort of weirdness
[15:24:35] <utkarsh> is it possible to do function overloading?
[15:24:38] <eddyb> until someone adds an orphan impl for that
[15:24:43] <FreeFull> x.in_range(min,max) would be fine
[15:24:44] <eddyb> utkarsh: not built-in
[15:24:45] <bollu> FreeFull: but it looks so close to math. it's gorgeous 
[15:24:53] <eddyb> utkarsh: you can work around that limitation using traits
[15:25:02] <eddyb> utkarsh: if you want to overload on the type of one argument, for example
[15:25:10] <kimundi> FreeFull: That could definitly work
[15:25:23] <kimundi> FreeFull: The question is, what kind of range do you mean? ;)
[15:25:23] <utkarsh> eddyb, I wanted to overload both sides :/
[15:25:36] <eddyb> utkarsh: can do that too
[15:25:37] <kimundi> (a,b), [a,b), (a,b] or [a,b]
[15:25:40] <eddyb> utkarsh: you just can't overload on arity
[15:25:45] *** Joins: mye (mye@moz-51785099.dip0.t-ipconnect.de)
[15:25:46] <FreeFull> kimundi: Probably [a,b) for consistency
[15:25:51] <eddyb> kimundi: <a, b>
[15:25:58] <kimundi> FreeFull: Yeah
[15:26:02] <bollu> kimundi: yeah, exactly. but I prefer ]a, b[ more than (a, b)
[15:26:04] <eddyb> first class bra ket support pls
[15:26:15] <eddyb> bollu: OMG
[15:26:15] <kimundi> with range_inclusive for [a, b]
[15:26:19] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[15:26:19] *** Quits: aravindavk (aravinda@92FE829C.82463742.C28A6AA4.IP) (Ping timeout)
[15:26:21] <jdsanders> unable to build this morning: "No rule to make target: `.../mk/llvm.mk'. Stop"
[15:26:23] <eddyb> bollu: that's... actually doable
[15:26:31] <utkarsh> eddyb, any pointers?
[15:26:32] <eddyb> bollu: as long as the first ] doesn't close an array
[15:26:32] <bollu> eddyb: what, really? whoa, nice!
[15:26:40] <jdsanders> maybe i just need to reconfigure...
[15:26:43] <eddyb> bollu: as in, implementable
[15:26:52] <kimundi> jdsanders: Did you ./configure ?
[15:27:00] <bollu> eddyb: idk, my math professor always writes it that way. yeah, I realized what you meant
[15:27:05] <eddyb> bollu: we have lifetime issues with most of these fancy potential sugars we might want to add
[15:27:07] *** Joins: josh (josh@moz-C1D9FC5F.meeting.ietf.org)
[15:27:12] <eddyb> oops. damn you nmatsakis
[15:27:14] *** jorendorff_away is now known as jorendorff
[15:27:14] *** Joins: derek_c (derek@moz-55529DC3.cit.cornell.edu)
[15:27:16] <FreeFull> It's funny working on Rust code with C code alongside as a reference
[15:27:17] <eddyb> bollu: we have parsing issues
[15:27:22] <kimundi> jdsanders: Ususally need to do that, yeah. At least if there where llvm updates
[15:27:22] <bollu> anybody want to enlighten me how to implement this? I'd love to see this work
[15:27:24] <jdsanders> kimundi: d'oh, did now, my bad
[15:27:29] <bollu> eddyb: aww crap.
[15:27:43] <eddyb> bollu: you have to handle ] that is a mismatch with a [, basically
[15:28:10] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[15:28:11] <eddyb> bollu: and treat it as a different token - after which a [ can come to "close" the original ]
[15:28:25] <bollu> eddyb: hmm, yeah. that is a problem :( it would lead to ambiguity wouldn't it?
[15:28:40] <eddyb> for []a, b[] yeah
[15:28:57] <eddyb> but you could write [(]a, b[)]
[15:29:02] <eddyb> that looks so funky though =))
[15:29:09] *** Quits: derek_c (derek@moz-55529DC3.cit.cornell.edu) (Quit: Leaving)
[15:29:18] *** Joins: derek_c (derek@moz-55529DC3.cit.cornell.edu)
[15:29:28] *** Quits: derek_c (derek@moz-55529DC3.cit.cornell.edu) (Quit: Leaving)
[15:29:34] <bollu> yeah, that tosses readability out of the window
[15:29:37] *** Joins: derek_c (derek@moz-55529DC3.cit.cornell.edu)
[15:29:38] <FreeFull> Does vec_ng not have indexing?
[15:29:49] <FreeFull> Or do I just have an old version?
[15:29:52] <eddyb> FreeFull: we may get better indexing traits soon
[15:30:07] *** Joins: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP)
[15:30:07] <kimundi> I think ord!(a < x <= y <= b) would be the most useful to have
[15:30:07] <bollu> FreeFull: I too was disappointed to learn this.
[15:30:24] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Input/output error)
[15:30:28] <eddyb> either wycats or I will have to just implement them
[15:30:29] <FreeFull> How would I do the equivalent of foo[bar] += 1; with vec_ng right now?
[15:30:44] <kimundi> FreeFull: mutable iterators
[15:30:45] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[15:30:47] <eddyb> FreeFull: as_mut or as_mut_slice is the most generic way
[15:30:50] <eddyb> kimundi: what?
[15:30:52] <kimundi> or that
[15:31:09] <bollu> kimundi: ord! is a macro that implements comparison ?
[15:31:16] <eddyb> bollu: if you implement it
[15:31:19] <bollu> I remember reading something vaguely
[15:31:24] <eddyb> it shouldn't be particularily difficult
[15:31:24] <kimundi> well, foo[bar] += 1; sounds like iteraton to me
[15:31:37] <FreeFull> kimundi: bar is practically random
[15:31:37] *** Joins: aravindavk (aravinda@92FE829C.82463742.C28A6AA4.IP)
[15:31:51] <kimundi> FreeFull: Ah, okay.
[15:31:56] <eddyb> bollu: Ord is a trait which can be used to overload <, <=, >, >=
[15:32:19] <bollu> but  (something)! is a macro, not a trait.
[15:32:23] *** Quits: Ferreus (ferreus@moz-F3FF31FF.dip0.t-ipconnect.de) (Ping timeout)
[15:32:32] <FreeFull> kimundi: I'm generating buddhabrots
[15:32:36] <eddyb> bollu: yupp
[15:32:48] <kimundi> bollu: It could be a macro that desugars to a < x && x <= y && y <= b
[15:32:51] <eddyb> just pointing out where you might have heard about Ord
[15:33:08] <bollu> oh, okay. thanks!
[15:33:24] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[15:33:50] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[15:34:10] <bollu> make
[15:34:11] <kimundi> (Or rather, that would desugar to "let (ref a, ref x, ref y, ref b) = (a,x,y,b); *a < *x && *x <= *y && *y <= *b")
[15:34:14] <bollu> wait, sorry
[15:34:48] <bollu> wait, sorry
[15:34:50] <bollu> damn! 
[15:35:24] <kimundi> rusti: let (a,x,y,b) = (1,2,3,4); let (ref a, ref x, ref y, ref b) = (a,x,y,b); *a < *x && *x <= *y && *y <= *b
[15:35:24] -rusti- true
[15:35:36] <kimundi> huh, that worked on first try
[15:35:42] *** Quits: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:35:47] *** Joins: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca)
[15:36:09] *** Parts: pczarn (Mibbit@moz-69A55FA.izacom.pl) ()
[15:36:30] *** Quits: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[15:36:57] *** Joins: pczarn (pczarn@moz-69A55FA.izacom.pl)
[15:37:07] *** Joins: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP)
[15:37:08] *** ChanServ sets mode: +ao dherman dherman
[15:37:16] <kimundi> Now if only macros could generate binding names
[15:37:46] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[15:37:56] *** Quits: bollu (bollu@31CCE710.7065DDB9.6D6A344F.IP) (Connection reset by peer)
[15:38:16] <kimundi> wait, procedural macros can do that
[15:38:36] *** Joins: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl)
[15:39:06] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:39:26] *** Joins: Kruppe (user@moz-16610622.dynamic.uwaterloo.ca)
[15:40:02] *** Joins: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net)
[15:40:22] *** Quits: maxli (Instantbir@moz-1650391B.hsd1.ca.comcast.net) (Ping timeout)
[15:40:46] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Input/output error)
[15:40:59] *** Joins: bharadwaj (uid11995@moz-5F4AA75A.irccloud.com)
[15:41:06] *** Quits: Kruppe (user@moz-16610622.dynamic.uwaterloo.ca) (Ping timeout)
[15:41:23] *** Quits: hoverbear (hoverbear@moz-86FCBF4B.gv.shawcable.net) (Quit: Taking a nap.)
[15:41:26] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[15:41:51] *** Quits: aravindavk (aravinda@92FE829C.82463742.C28A6AA4.IP) (Ping timeout)
[15:42:17] *** Joins: darthdeus (darthdeus@EEC5B4DB.3B96A244.4E88690D.IP)
[15:42:43] *** Joins: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP)
[15:42:48] *** Quits: victorporof (victorporo@moz-FFB76956.cpe.net.cable.rogers.com) (Quit: victorporof)
[15:43:13] *** Quits: darthdeus (darthdeus@EEC5B4DB.3B96A244.4E88690D.IP) (Connection reset by peer)
[15:43:47] *** Joins: bollu (bollu@31CCE710.7065DDB9.6D6A344F.IP)
[15:44:16] *** Quits: edwardw (edwardw@4112974A.B4358688.30F15291.IP) (Quit: Leaving...)
[15:44:16] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[15:44:30] *** Joins: matematikaadit (adit@B1C2301D.7E96007.B0C328E3.IP)
[15:44:44] *** Quits: alexherbo2 (alexherbo2@moz-2B1B8045.w83-199.abo.wanadoo.fr) (Ping timeout)
[15:46:11] *** Joins: alexherbo2 (alexherbo2@moz-2B1B8045.w83-199.abo.wanadoo.fr)
[15:47:45] *** Quits: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[15:48:51] <FreeFull> eddyb: I don't see as_mut in vec_ng.rs, so I suppose I'll have to use as_mut_slice
[15:49:16] <hhhhhhhhhh> can you adjust the priorities of threads from in rust
[15:49:29] *** Joins: soumyaC (uid15286@moz-E77DEB21.irccloud.com)
[15:51:04] <bharadwaj> Hello! Is there anyone I can talk to about getting started on GSoC rust project?
[15:51:10] *** Joins: voxpopuli (fanservice@F9737B0C.D6003D29.689607DE.IP)
[15:51:11] *** Joins: Ms2ger (Ms2ger@60B493FD.C305EAEC.F15B0BB3.IP)
[15:51:44] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[15:51:58] <paldepind> I'm calling a C function that want a pointer. What is the recommended way to do that?
[15:52:17] <paldepind> I've seen this: glGenBuffers(1, unsafe { ptr::addr_of(&buf) });
[15:52:27] <paldepind> But it looks kinda ... unsafe? ;)
[15:52:38] *** Joins: Guest (textual@moz-310FD28A.dynamic.caiway.nl)
[15:52:44] <Ms2ger> It does :)
[15:53:02] <paldepind> There has to be a better way?
[15:53:12] <Ms2ger> What's the exact signature?
[15:54:05] <eddyb> &T decays to *T
[15:54:07] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[15:54:25] <Ms2ger> I like "decays" :)
[15:54:28] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[15:54:33] <eddyb> Ms2ger: C++ terminology AFAIK
[15:54:57] *** Joins: mindcat (mindcat@EEFCDFAE.7EE3DE8.F956842C.IP)
[15:55:04] <paldepind> Ms2ger: This is what i looks like in C: glGenBuffers(	GLsizei n, GLuint * buffers);
[15:55:22] <paldepind> It's gl-rs I'm using btw.
[15:55:45] <Ms2ger> Then I'm pretty sure ptr::addr_of(&buf) is broken
[15:55:58] <Ms2ger> And &buf should Just Work(tm)
[15:56:09] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[15:56:10] <paldepind> eddyb: So I can do glGenBuffers(1, &buf);
[15:56:16] <kimundi> wait, wait
[15:56:16] <Ms2ger> Yep
[15:56:21] <kimundi> what type is buf
[15:56:43] <pczarn> perhaps glGenBuffers(1, buf.as_ptr()) if buf is a vec
[15:56:55] <Ms2ger> Oh, duh
[15:57:01] *** Joins: aravindavk (aravinda@DEC02659.F5CD2BD8.C0FE4824.IP)
[15:57:17] <paldepind> GLuint. The C function expects an array, but when only passing a single item one can just pass its address.
[15:57:34] <kimundi> if buf is a mutable vector, glGenBuffers(buf.len(), buf.as_ptr()), if it is a mutable GLuint, glGenBuffers(1, &buf)
[15:57:45] <Ms2ger> Or &mut buf
[15:57:48] <eddyb> &mut buf evne
[15:57:49] <eddyb> *even
[15:57:58] <kimundi> if buf is a mutable vector, glGenBuffers(buf.len(), buf.as_ptr()), if it is a mutable GLuint, glGenBuffers(1, &mut buf), that is
[15:58:06] <Ms2ger> Depending on whether the binding isn't stupid
[15:58:06] <eddyb> and .as_mut_ptr() in the vector case
[15:58:18] <mindcat> I forgot how do that now, I mean "1" * 3 = "111" in rust
[15:58:26] <kimundi> Hm, the binding should take *mut
[15:58:34] <Ms2ger> (The spidermonkey bindings use non-mut *T for outparams)
[15:58:37] <kimundi> rusti: "1".repeat(3)
[15:58:37] -rusti- ~"111"
[15:58:40] <kimundi> mindcat: ^
[15:58:44] <mindcat> oh thanks
[15:59:01] <Ms2ger> Which means that let mut foo = ...; GetFoo(&foo) gives an unused-mut warning
[15:59:24] <paldepind> kimundi: Thanks. I'll try it out.
[15:59:41] <kimundi> Ms2ger: Well, it should be let mut foo = ...; GetFoo(&mut foo) and a type error ;)
[15:59:47] <mrmonday> is it possible to use the collections library from within libstd? I can't seem to get it working
[16:00:27] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[16:00:33] <kimundi> afaik no, it would introduce a cyclic dependency
[16:00:52] <mrmonday> well that's really annoying
[16:01:12] *** Joins: epall (epall@moz-FA29BBA2.lightspeed.sntcca.sbcglobal.net)
[16:01:12] <mrmonday> HashMap was in std before so I was able to use it, no idea what I'm menna do now :S
[16:01:13] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[16:01:24] <paldepind> >.<  It appears the bindings to glGenBuffers is an unsafe function and can only be used in an unsafe function
[16:01:39] *** Quits: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP) (Quit: leaving)
[16:01:50] <Ms2ger> So, yeah, unsafe { glGenBuffers(1, &buf) }
[16:01:56] <strcat> mrmonday: what are you trying to do with it?
[16:02:04] <strcat> just move it back to libstd if there's a good reason to use it in libstd
[16:02:28] <strcat> for example, using it for TLS, or using it in a GC implementation
[16:02:48] *** Quits: derek_c (derek@moz-55529DC3.cit.cornell.edu) (Ping timeout)
[16:03:24] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[16:03:27] <paldepind> Thanks for the help! :)
[16:03:35] *** Quits: epall (epall@moz-FA29BBA2.lightspeed.sntcca.sbcglobal.net) (Quit: epall)
[16:03:38] <mrmonday> using it to get a list of network interfaces on the machine, currently returning a map of ~str, ~NetworkInterface
[16:03:51] <eddyb> btw, someone can make TLD immutable but not frozen, while I'm doing other menial things
[16:03:52] <mrmonday> I could probably just return a list, but then my logic becomes really complicated :\
[16:03:58] <mrmonday> or vector rather
[16:03:58] *** Joins: lawrence (lawrence@moz-E38FC3B2.wireless.utoronto.ca)
[16:04:02] *** Quits: samx (sami@3EB32A7C.10A53EE3.77834EAA.IP) (Quit: This computer has gone to sleep)
[16:04:08] <eddyb> remove the task_local::get_mut function and all its machinery
[16:04:36] <cmr> eddyb: why?
[16:04:48] <eddyb> I want to allow returning task-local references which are just a non-Send TaskLocal<T> which hides a &'static T and implements Deref
[16:04:51] *** Quits: mouse (mouse@moz-373942D2.dhcp.yndx.net) (Quit: Ex-Chat)
[16:05:06] <mrmonday> (possibly the most annoying thing for me about changing between languages is the different terminology used for lists/arrays/vectors/arraylists/whatever... Everyone just gets confused why I'm using a different data structure :3)
[16:05:11] <bollu> how do I take a function pointer in rust?
[16:05:29] <cmr> bollu: fn foo(x: fn()) { x() }
[16:05:33] <eddyb> cmr: mutable TLD makes it more complicated while replicating the unsafe machinery behind RefCell or the old Cell
[16:05:52] *** Joins: arturo (Thunderbir@moz-E83B14F0.superkabel.de)
[16:05:59] <bollu> @cmr: can i use "type" to alias a function pointer ? 
[16:06:01] <cmr> paldepind: https://github.com/cmr/hgl-rs
[16:06:07] <strcat> mrmonday: how are you getting the list of network interfaces anyway?
[16:06:10] <cmr> bollu: yes, `type foo = fn();`
[16:06:12] <eddyb> mrmonday: return an iterator
[16:06:18] <kimundi> mrmonday: Would it be possible to factor out the networking stuff your working on into its own crate instead?
[16:06:20] <bollu> @cmr: thanks
[16:06:20] <eddyb> mrmonday: then it can be collected to a HashMap
[16:06:22] <strcat> dealing with netlink on linux seems like it'll be annoying
[16:06:35] <bollu> @cmr: this function pointer can be a member of a struct ?
[16:06:37] <strcat> dunno how it's done elsewhere
[16:06:39] <eddyb> mrmonday: Iterator<(~str, Interface)> that is
[16:06:44] <kimundi> bollu: yes
[16:06:50] <bollu> thanks!
[16:06:50] <cmr> bollu: yes. http://static.rust-lang.org/doc/master/complement-cheatsheet.html#how-do-i-store-a-function-in-a-struct
[16:07:00] <eddyb> lol
[16:07:09] <bollu> this will make writing the event loop sooo much easier
[16:07:13] <eddyb> too bad it's just one of the few things in there
[16:07:20] <eddyb> bollu: so you haven't used trait objects yet?
[16:07:23] <paldepind> cmr: Thanks for the link! I'm currently just getting started with OpenGL so I don't think it's appropriate for me atm. I'm learning from C++ tutorials.
[16:07:31] <mrmonday> strcat: getifaddrs() currently
[16:07:37] <bollu> eddyb: nope. haven't run into a usecase yet
[16:07:45] <eddyb> bollu: event loops is one usecase
[16:07:51] *** Joins: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP)
[16:07:51] <paldepind> cmr: But ou will get a GitHub star :)
[16:07:57] <bollu> eddyb: have some code lying around ? :)
[16:08:01] <eddyb> bollu: if you want them to behave like async callbacks
[16:08:06] <eddyb> not really, it's just a pattern
[16:08:07] <cmr> paldepind: I wrote it by following tutorials :) At the very least it has examples of how to correctly bind the various functions.
[16:08:11] <bollu> eddyb: no, async is not required
[16:08:16] <mrmonday> eddyb: thanks, I'll try that. I'm mostly just using a hashmap because it was simplest in terms of implementation
[16:08:20] <eddyb> bollu: not truly async, but callbacks
[16:08:28] <bollu> eddyb: yep, I want callbacks
[16:08:38] <doomlord_> NDK's .so - file says "libs/armeabi/libnative-activity.so: ELF 32-bit LSB shared object, ARM, version 1 (SYSV), dynamically linked, stripped
[16:08:38] <doomlord_> "
[16:08:44] <mrmonday> kimundi: I suppose it could be, gonna try and just get rid of the hashmap dependency instead for now though
[16:08:59] <paldepind> cmr: Good point! I'm currently surfing through a bunch of Rust OpenGL projects whenever I'm in doubt (which is all the time)
[16:09:05] <doomlord_> if i use rustc to make a .so - i get the same it seems - rusty_android.so: ELF 32-bit LSB shared object, ARM, version 1 (SYSV), dynamically linked, not stripped
[16:09:08] *** Quits: puzzler (puzzler@moz-CD721145.hsd1.mi.comcast.net) (Quit: )
[16:09:15] *** Parts: jdsanders (Adium@moz-EB8DC389.hlrn.qwest.net) ()
[16:09:23] <bollu> paldepind: how much math do you know? 
[16:09:35] <kimundi> doomlord_: (except for the stripped part ;))
[16:10:06] <bollu> because 3d code gets pretty heavy into math after a short while
[16:10:10] <doomlord_> but might one still be thumb and the other not
[16:10:27] <cmr> doomlord_: might be able to check objdump or readelf?
[16:10:31] <bollu> eddyb: how do I use trait objects to implement callbacks?
[16:11:36] *** Quits: paldepind (simon@8C529550.87451125.F2979BBF.IP) (Quit: paldepind)
[16:11:51] *** Quits: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP) (Ping timeout)
[16:11:59] *** Joins: dylukes (dylukes@moz-9CC4D97.wireless.pitt.edu)
[16:12:01] *** Quits: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[16:12:05] *** Quits: josh (josh@moz-C1D9FC5F.meeting.ietf.org) (Quit: josh)
[16:12:28] <eddyb> trait Handler {fn handle(&self, event: EventInfo);} impl Handler for FooHandler {...} let handler = ~FooHandler as ~Handler; // now multiple ~Handler's, coming from different types, can be put in a vector and called .handle(event) upon
[16:12:34] <eddyb> bollu: ^^ I hope that makes sense
[16:13:01] <doomlord_> just saying ARM , and no further architecture information ; i see a dissasemble option, no luck with that yet, i'll look at the objects..
[16:13:24] *** Joins: canhtak (canhtak@moz-E7F2DD45.dsl.bell.ca)
[16:13:27] *** Joins: josh (josh@moz-C1D9FC5F.meeting.ietf.org)
[16:14:20] <bollu> I got it till the let handler = ~FooHandler as ~Handler
[16:14:38] <bollu> what does that do?
[16:15:16] *** Joins: nszceta (hax@moz-E458A7C0.pharm.pitt.edu)
[16:17:39] <bvssvni> bollu: converts to a pointer that looks up methods via vtable
[16:17:56] *** Joins: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP)
[16:17:56] *** Joins: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch)
[16:17:58] *** Quits: alexherbo2 (alexherbo2@moz-2B1B8045.w83-199.abo.wanadoo.fr) (Ping timeout)
[16:18:20] *** Joins: jeaye (jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[16:18:26] <eddyb> bollu: sorry, I was afk for a few minutes there
[16:18:38] <bollu> bvssvni: so it tells it to tread ~FooHandler (a derived class type) as ~Handler (a base class type) ?
[16:18:43] <bollu> edyyb: np :)
[16:18:50] <eddyb> it's not OOP
[16:19:07] <bollu> eddyb: eh, I'm using derived and base in the vtable sense
[16:19:08] <eddyb> rather, ~FooHandler (a pointer) become an opaque pointer to a vtable attached
[16:19:21] *** Quits: maximilian (max@moz-493D272A.ethz.ch) (Quit: Leaving)
[16:19:25] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[16:19:27] <bollu> eddyb, what happens if I omit that line?
[16:19:38] <kimundi> type error
[16:19:43] <eddyb> well, it coerces automatically now, in some cases
[16:19:45] <bollu> hmm. 
[16:19:50] <kimundi> Its like casting to an interface in a sense
[16:19:53] <eddyb> so you can have ~FooHandler to a function expecting ~Handler
[16:19:55] <kimundi> right
[16:19:56] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[16:20:02] <eddyb> s/have/give
[16:20:03] <kimundi> Ididally its implicit these days
[16:20:11] <bollu> Ideally* I think
[16:20:12] <eddyb> rusti: (~40 as ~Add<uint, uint>) + 2
[16:20:13] *** Joins: jroweboy (Mibbit@moz-18814A6B.provo.static.broadweavenetworks.net)
[16:20:14] -rusti- pastebinned 11 lines of output: http://sprunge.us/hPTM
[16:20:28] <eddyb> lol
[16:20:31] <eddyb> rusti: (~40u as ~Add<uint, uint>) + 2
[16:20:31] -rusti- <anon>:10:9: 10:39 error: binary operation `+` cannot be applied to type `~std::ops::Add<uint,uint>:Send`
[16:20:32] -rusti- <anon>:10         (~40u as ~Add<uint, uint>) + 2
[16:20:32] -rusti-                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[16:20:32] -rusti- error: aborting due to previous error
[16:20:32] -rusti- application terminated with error code 101
[16:20:35] <cmr> eddyb: ~Add doesn't implement Add
[16:20:50] <cmr> because it uses the Self type.
[16:20:50] <eddyb> hmm, I may have broke that
[16:20:53] <FreeFull> http://sprunge.us/aETR?rust How can I improve this code?
[16:20:58] <eddyb> cmr: no it doesn't
[16:21:11] <cmr> eh? fn add(&self, other: &Self)
[16:21:23] <eddyb> it's Add<Rhs, Result> for Lhs
[16:21:28] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[16:21:33] <eddyb> cmr: my Many demo does this so I know it worked
[16:21:37] <cmr> ohhh
[16:21:40] <cmr> yes indeed
[16:21:41] <cmr> my bad
[16:21:42] <Ms2ger> nmatsakis, fwiw, I think (*foo).bar() is less readable than foo.get().bar()
[16:21:50] <eddyb> Ms2ger: foo.bar() now
[16:21:53] <eddyb> or soon, rather
[16:21:54] <bollu> FreeFull: mandelbrot set?
[16:22:00] <FreeFull> bollu: buddhabrots
[16:22:04] <eddyb> cmr: I made it overly conservative recently
[16:22:05] <Ms2ger> eddyb, heh, Servo
[16:22:09] *** Joins: AvianFlu (AvianFlu@moz-723527FF.nycmny.fios.verizon.net)
[16:22:21] <eddyb> Ms2ger: so just my first PR?
[16:22:25] <eddyb> that's... sucky
[16:22:35] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[16:22:36] <eddyb> use my branch directly!
[16:22:39] <Ms2ger> Nothing right now, I think
[16:22:40] <bollu> FreeFull: TIL! it looks beautiful
[16:23:05] <FreeFull> Although the code doesn't generate the most beautiful buddhabrots yet =P
[16:23:17] <eddyb> rusti: ~42 as ~ToStr
[16:23:20] -rusti- ~std::to_str::ToStr:Send
[16:23:31] <eddyb> rusti: (~42 as ~ToStr).to_str()
[16:23:32] -rusti- ~"42"
[16:23:46] <eddyb> bollu: ^^ so the type is not known but you can still call (some) methods
[16:23:49] *** Quits: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com) (Quit: Leaving)
[16:23:51] *** Quits: [o__o] (~o__o@604A2740.DB688352.F4ADE383.IP) (Input/output error)
[16:24:03] *** Joins: [o__o] (~o__o@604A2740.DB688352.F4ADE383.IP)
[16:24:09] <bollu> eddyb: that was enlightening I suppose. but why the ~Trait? isn't a Trait an abstract thing?
[16:24:13] <eddyb> rusti: [~42 as ~ToStr, ~~"foo" as ~ToStr].map(|x| x.to_str())
[16:24:14] -rusti- ~[~"42", ~"foo"]
[16:24:15] <bollu> how can you say I "own" a Trait?
[16:24:25] <eddyb> you own data with a trait interface
[16:24:36] <bollu> eddyb: ah. 
[16:24:39] <eddyb> DST will give us SmartPointer<Trait>
[16:24:54] <eddyb> which is SmartPointer<T> which forgot its type and learned Trait methods for T
[16:25:00] *** Joins: mawuli (mawuli@moz-A89BBCE.com.gh)
[16:25:28] <eddyb> right now it's just &Trait, &mut Trait and ~Trait
[16:25:51] <bollu> rusti: { (~ as Drop) } //doubt this will work
[16:25:53] -rusti- pastebinned 7 lines of output: http://sprunge.us/NGCD
[16:25:53] *** Quits: murph1 (murph@moz-F07B75BF.oracle.com) (Ping timeout)
[16:25:57] <eddyb> bollu: see my example above, with the vector. that's the main usecase
[16:26:04] <bollu> rusti: { (~"a" as Drop) } //doubt this will work
[16:26:05] -rusti- pastebinned 8 lines of output: http://sprunge.us/IdAf
[16:26:12] <bollu> eddyb: I'm just messing around ^_^
[16:26:26] <eddyb> which is to put different types in the same container
[16:26:29] <eddyb> rusti: ~~"a" as ~Drop
[16:26:30] -rusti- <anon>:10:9: 10:23 error: failed to find an implementation of trait std::ops::Drop for ~str
[16:26:30] -rusti- <anon>:10         ~~"a" as ~Drop
[16:26:30] -rusti-                   ^~~~~~~~~~~~~~
[16:26:30] -rusti- application terminated with error code 101
[16:26:32] *** Joins: victorporof (victorporo@13F2CEC5.7672369.D8E68FF6.IP)
[16:26:33] <bollu> rusti: { (~"a" as ~Drop) }
[16:26:34] -rusti- <anon>:10:12: 10:25 error: can only cast an ~-pointer to a ~-object, not a ~str
[16:26:34] -rusti- <anon>:10         { (~"a" as ~Drop) }
[16:26:34] -rusti-                      ^~~~~~~~~~~~~
[16:26:36] -rusti- error: aborting due to previous error
[16:26:38] -rusti- application terminated with error code 101
[16:26:45] <jroweboy> Now that mut static object cannot have destructors, what is the recommended way to have replace a mut static HashMap? On IRC yesterday, someone suggested using a mut static () and using forget to store a HashMap in there, but that is giving me capacity overflow errors (I think this was suggested, but its possible I misunderstood their comment)
[16:26:49] *** Quits: matematikaadit (adit@B1C2301D.7E96007.B0C328E3.IP) (Quit: Leaving)
[16:26:49] <eddyb> bollu: ~str is a type, but it's not ~T with T = str
[16:27:00] <eddyb> bollu: it's a bit more complicated without DST :(
[16:27:15] <bollu> eddyb: okay! np :) 
[16:27:18] <eddyb> jroweboy: don't use globals if you can avoid it
[16:27:58] <jroweboy> eddyb: I haven't found a way to avoid it as of yet :/ When I can think of a way I will change it in an instant.
[16:28:11] <eddyb> how come?
[16:28:22] <eddyb> jroweboy: do you have context size restrictions?
[16:28:28] <eddyb> imposed by, say, a C API?
[16:28:44] <bollu> is "EventHandler" a god trait hane?
[16:28:46] <eddyb> (even then, you can box a ~Context and get away with it)
[16:28:46] <bollu> good*
[16:28:53] <eddyb> bollu: sure
[16:28:54] <FreeFull> rusti: ~~"a" as Drop
[16:28:55] -rusti- pastebinned 8 lines of output: http://sprunge.us/XjSW
[16:28:59] <eddyb> ~Drop even
[16:29:12] <eddyb> and doesn't work because drop glue doesn't require implementing Drop
[16:29:36] *** kimundi is now known as zz_kimundi
[16:30:34] <bollu> eddyb: looks like my silly experiment has a lot of deep connections :) 
[16:30:38] <eddyb> bollu: you can even implement it for 'static |EventInfo| or fn(EventInfo) so a compact function can be used instead of a trait implementation, when you don't need to capture context
[16:31:03] <bollu> eddyb: I'd much rather it being a trait.
[16:31:05] <jroweboy> eddyb: I can't think of a way to handle reverse routing in my web framework without them. I have a fn reverse(View, HashMap<str,str>) -> string that looks up the view in the hashmap and computes the url from that.
[16:31:06] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[16:31:09] <bollu> but I see your point
[16:31:16] <eddyb> bollu: I mean, have your cake and eat it too
[16:31:25] <eddyb> impl EventHandler for fn(EventHandler)
[16:31:27] <eddyb> err
[16:31:30] <eddyb> fn(EventInfo)
[16:31:32] <bollu> eddyb: what?
[16:31:41] <eddyb> so you can use ~my_callback as ~EventHandler
[16:31:45] <bollu> you're implementing a trait on a free function ?
[16:31:50] <eddyb> yupp
[16:31:54] <eddyb> well, a function type
[16:31:55] <bollu> that's nuts
[16:31:58] <eddyb> bollu: traits are not OOP
[16:32:14] <eddyb> they don't have data layout requirements, they're almost completely orthogonal
[16:32:16] <bollu> eddyb: yeah, I keep forgetting :)
[16:32:26] <eddyb> you can implement them on any type
[16:32:44] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:32:46] <jroweboy> The reverse fn doesn't have any access to the routes though, and I'm not sure how to change the design to allow that, so for now the computed reverse routes are sitting in a global hashmap
[16:32:51] <Havvy> impl MyTrait for () { ... }
[16:32:55] <eddyb> jroweboy: can't you pass them around?
[16:33:01] *** Quits: leowoe (Leo@moz-CEF2400C.inf.uni-konstanz.de) (Quit: Leaving.)
[16:33:04] *** Joins: Ferreus (ferreus@moz-D32BC6B4.lsn.wtnet.de)
[16:33:17] <eddyb> Havvy: and ~() can require 0 heap bytes
[16:33:25] <eddyb> so it looks like an allocation
[16:33:30] <eddyb> but it's free
[16:33:46] <Havvy> Is that how you do symbols?
[16:33:59] <eddyb> &'static ZeroSizedStruct, but yeah
[16:34:17] <eddyb> Rust is like the opposite of Java
[16:34:27] <bollu> rusti: fn a () {} ; impl Drop for a () { println("~a") }; 
[16:34:28] -rusti- <anon>:10:38: 10:39 error: expected `{` but found `(`
[16:34:28] -rusti- <anon>:10         fn a () {} ; impl Drop for a () { println("~a") }; 
[16:34:28] -rusti-                                                ^
[16:34:28] -rusti- application terminated with error code 101
[16:34:38] <bollu> rusti: fn a () {} ; impl Drop for a  { println("~a") }; 
[16:34:38] -rusti- <anon>:10:41: 10:48 error: unexpected token: `println`
[16:34:39] -rusti- <anon>:10         fn a () {} ; impl Drop for a  { println("~a") }; 
[16:34:39] -rusti-                                                   ^~~~~~~
[16:34:39] -rusti- application terminated with error code 101
[16:34:41] <eddyb> instead of leaking, it doesn't require heap allocation to produce heap pointers :D
[16:34:50] <eddyb> bollu: you need to write the method
[16:34:58] <bollu> ah, whoops!
[16:35:00] <eddyb> bollu: and a isn't a type, it's a value
[16:35:14] <bollu> rusti: fn a () {} ; impl Drop for a  { fn drop() { println("~a") }  }; 
[16:35:15] -rusti- pastebinned 8 lines of output: http://sprunge.us/jZIj
[16:35:26] <bollu> eddyb: meaning?
[16:35:33] <eddyb> impl Drop for fn() would be the equivalent of my example
[16:35:43] <eddyb> but Drop is in another crate and fn() is a primitive, so you can't do that
[16:35:54] <eddyb> (it would change the meaning of code within libstd, among other things)
[16:35:58] <bollu> hmm. okay. 
[16:36:11] *** Joins: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com)
[16:36:28] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:36:54] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[16:37:18] <jroweboy> eddyb: I don't see a reason to pass around the routes to each of the views besides this one need for reverse routes. I could theoretically make a singleton, but that just sounds like a worse idea... 
[16:38:01] <eddyb> jroweboy: if it's a context, and especially if it's task-local, passing it around is mostly harmless
[16:38:04] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[16:38:16] <eddyb> I would even make the operation a method on the context
[16:38:27] <bollu> eddyb: "mostly harmless" <- a reference?
[16:38:35] <hhhhhhhhhh> when doing pattern matching on struct enums, is there a way to indicate i don't care about a field
[16:38:49] <eddyb> bollu: it adds an extra pointer to each function call
[16:39:01] <bvssvni> jroweboy: I often design two abstraction levels in code, one for passing around and breaking down application state and one for doing the work in a application agnostic way
[16:39:10] <eddyb> bollu: so if it's in a very hot loop, it might slightly affect performance
[16:39:15] <jroweboy> hhhhhhhh: you can use _ to say you don't care
[16:39:21] <eddyb> bollu: but otherwise, it's just a pointer being passed around
[16:39:36] <bollu> eddyb: oh, okay. got it. but it's a __reference counted__ pointer no?
[16:39:44] <jroweboy> bvssvni: What exactly do you mean? I"m not sure I understand
[16:39:47] <hhhhhhhhhh> jroweboy: error: obsolete syntax: struct wildcard
[16:39:52] <hhhhhhhhhh> jroweboy: however it does tell me to use .. instead
[16:39:52] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[16:40:06] *** Joins: derek_c (derek@moz-55529DC3.cit.cornell.edu)
[16:40:08] <eddyb> bollu: &T isn't refcounted :P
[16:40:32] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[16:40:36] <bvssvni> jroweboy: to create a struct for application data, one for settings etc. and put them together in one state struct
[16:40:37] <eddyb> hhhhhhhhhh: {..}, (..), (_, _)
[16:40:56] <eddyb> hhhhhhhhhh: we had {_} meaning {..} at one point, that's what the error is about
[16:40:58] <bollu> eddyb: ohhh, I think I see. 
[16:41:12] <bollu> rusti: {} == ()
[16:41:13] -rusti- <anon>:10:12: 10:14 error: unexpected token: `==`
[16:41:13] -rusti- <anon>:10         {} == ()
[16:41:13] -rusti-                      ^~
[16:41:13] -rusti- application terminated with error code 101
[16:41:17] <eddyb> and Arc, sure... but even then, you don't have to clone it
[16:41:25] <bvssvni> jroweboy: then when you do an action, you work your way down and pass the stuff to the functions that do the complex logic
[16:41:34] <eddyb> only cloning an Arc will cause an atomic refcount
[16:41:42] <eddyb> (and destroying an Arc, of course)
[16:42:00] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[16:42:19] <jroweboy> bvssvni: So in your workflow, what would be the differences between the app data struct and the settings one?
[16:42:47] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[16:42:55] <bvssvni> jroweboy: usually, yes, because app data could be stored in separate files etc.
[16:42:57] *** Joins: murph1 (murph@moz-F07B75BF.oracle.com)
[16:43:24] *** Quits: rocode (rocode@moz-B9927398.clsp.qwest.net) (Quit: Leaving)
[16:43:45] <bvssvni> jroweboy: if you have some graphics code, like ellipse(color, rect)
[16:43:50] <bollu>  error: reference to trait `EventHandler` where a type is expected; try `@EventHandler`, `~EventHandler`, or `&EventHandler`
[16:44:01] <bvssvni> jroweboy: then the color is taken from the settings and rect from the data
[16:44:18] <bollu> why can't I have "handlers: ~[EventHandler]" ? cause size isn't known?
[16:44:23] <eddyb> bollu: yupp
[16:44:26] <bollu> okay.
[16:44:32] <eddyb> bollu: ~[~EventHandler]
[16:44:48] <bvssvni> jroweboy: I am terrible at explaining this :P
[16:44:50] <eddyb> keep in mind that zero-sized heap allocations will become free (if they already aren't)
[16:45:05] <eddyb> so struct Foo; ~Foo won't touch memory
[16:45:12] <bollu> how do I insert something into an array? (by array I mean [] )
[16:45:16] <eddyb> .push
[16:45:19] <bollu> thanks
[16:45:24] <bollu> then what does .insert() do?
[16:45:38] <strcat> bollu: inserts at an index (shifts the array over)
[16:45:57] <FreeFull> rusti: () == {}
[16:45:59] -rusti- true
[16:46:03] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[16:46:14] <bollu> rusti: {} == ()
[16:46:14] -rusti- <anon>:10:12: 10:14 error: unexpected token: `==`
[16:46:14] -rusti- <anon>:10         {} == ()
[16:46:14] -rusti-                      ^~
[16:46:14] -rusti- application terminated with error code 101
[16:46:16] <bollu> ...
[16:46:22] <eddyb> {} == () doesn't work because {}{}{} has to work
[16:46:29] *** pmoore is now known as pmoore|dinner
[16:46:31] <eddyb> rusti: {} -5
[16:46:32] -rusti- -5
[16:46:32] <bollu> okay...
[16:46:44] <bollu> rusti: {} - {} 
[16:46:45] -rusti- <anon>:10:12: 10:16 error: cannot apply unary operator `-` to type `()`
[16:46:45] -rusti- <anon>:10         {} - {} 
[16:46:45] -rusti-                      ^~~~
[16:46:45] -rusti- error: aborting due to previous error
[16:46:45] -rusti- application terminated with error code 101
[16:46:47] <eddyb> otherwise you'd need semicolons after everything
[16:46:56] <bollu> rusti: {} - { 5 }
[16:46:57] -rusti- -5
[16:47:03] <bollu> hmm. interesting I suppose
[16:47:04] <jroweboy> bvssvni: And I'm terrible at understanding things :( So app settings can be stored in some manner. You have a parser put the settings into struct, and the you put the settings into the main data struct?
[16:47:12] <eddyb> bollu: it's like a ; after the first {}
[16:47:21] <bollu> yeah, I *think* I got it
[16:47:27] <bollu> but I'm not sur e:)
[16:47:29] <bollu> sure*
[16:47:29] <FreeFull> rusti: {}; == ()
[16:47:29] *** Havvy is now known as Havvy|shower
[16:47:29] -rusti- <anon>:10:13: 10:15 error: unexpected token: `==`
[16:47:29] -rusti- <anon>:10         {}; == ()
[16:47:30] -rusti-                       ^~
[16:47:30] -rusti- application terminated with error code 101
[16:47:37] *** Quits: lawrence (lawrence@moz-E38FC3B2.wireless.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[16:47:53] <bvssvni> jroweboy: yes, then you can create methods for reading settings independent of the main data struct
[16:48:06] <bvssvni> jroweboy: each function knowing as little as possible
[16:48:08] <bollu> help? https://gist.github.com/bollu/00789370ee13d0adeee2 
[16:48:18] <bollu> not able to use traits correctly
[16:48:21] *** Quits: Kxepal (Miranda@moz-510CB007.pppoe.mtu-net.ru) (Ping timeout)
[16:48:31] *** Quits: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch) (Quit: Leaving.)
[16:48:36] <jroweboy> do you have an example project on github or something that illustrates it? I think that would help me :)
[16:48:45] *** Joins: Kxepal (Miranda@moz-8A62DD41.pppoe.mtu-net.ru)
[16:48:52] *** Joins: tav (tav@moz-DC3DA8DF.hari.cable.virginm.net)
[16:49:12] *** Joins: analyst74 (analyst74@9D2B184F.DE01D124.4EFEDE71.IP)
[16:49:31] <eddyb> jroweboy: struct Context {/*hashmaps go here*/} impl Context {fn do_operation(&self, ...) {/* can use dem hashmaps here, from self*/}}
[16:49:41] *** Quits: tav (tav@moz-DC3DA8DF.hari.cable.virginm.net) (Quit: tav)
[16:49:43] <bvssvni> jroweboy: I'll try finding something
[16:49:55] <eddyb> bvssvni: name that method handle_event
[16:50:01] <eddyb> err, bollu ^^
[16:50:05] <eddyb> bollu: and add &self to it
[16:50:24] <eddyb> also, eventPump => EventPump
[16:50:29] <bvssvni> jroweboy: is it ok if it is not Rust?
[16:50:41] <eddyb> bollu: or &mut self if you want that
[16:50:42] <bollu> ?
[16:50:54] <eddyb> bollu: the trait method has to include self
[16:51:00] <eddyb> otherwise it's a static method
[16:51:10] <jroweboy> bvssvni: Probably, as long as its not in Intercal ^.^
[16:51:11] <bollu> ah, got it working
[16:51:14] <bvssvni> jroweboy: I have not written apps in Rust yet, only libraries
[16:51:24] <bollu> what's wrong with it being a static method in this case? :)
[16:51:35] <bollu> like, not what I wanted, but what's wrong?
[16:51:39] <eddyb> bollu: it's not callable from an object
[16:51:41] *** Quits: dylukes (dylukes@moz-9CC4D97.wireless.pitt.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[16:51:51] <eddyb> bollu: not even a normal type implementing EventHandler
[16:51:59] <bollu> so it's different from C++ then.
[16:52:07] <bollu> eddyb: what do you mean? 
[16:52:10] <eddyb> bollu: you can't do value.static_method(), you need to do Trait::static_method()
[16:52:24] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:52:29] <bollu> oh. can I do StructType::staic_method() ?
[16:52:34] <bollu> static*
[16:52:42] <bollu> yeah, you can
[16:52:46] <bollu> I've done it I think
[16:52:59] <bollu> yep, you can :)
[16:53:29] <bollu> eddyb: better? https://gist.github.com/00789370ee13d0adeee2
[16:53:41] <eddyb> yupp
[16:53:46] <bollu> good to know!
[16:53:54] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[16:54:00] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[16:54:04] <bvssvni> jroweboy: https://github.com/bvssvni/thebeast/blob/master/thebeast.js#L1084
[16:54:19] <eddyb> hehe JS
[16:54:31] *** Quits: derek_c (derek@moz-55529DC3.cit.cornell.edu) (Ping timeout)
[16:54:38] <bvssvni> jroweboy: this function call passes a settings and a scene object
[16:55:09] <bvssvni> jroweboy: all functions that takes settings and scene are application abstractions
[16:55:15] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[16:55:33] <bollu> bvssvni: aptly named 
[16:56:16] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[16:56:18] <bvssvni> jroweboy: I have no formal distinction between these two levels here, which makes it hard to find
[16:56:42] <bvssvni> jroweboy: https://github.com/bvssvni/thebeast/blob/master/thebeast.js#L891
[16:56:47] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[16:56:55] <bvssvni> jroweboy: this function does not depend on settings or scene
[16:56:56] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[16:57:13] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Quit: Leaving)
[16:57:15] <bollu> how do I write a constructor for EventPump?
[16:57:23] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[16:57:23] <jroweboy> bvssvni: Thanks for the example! Looks like I've got some refactoring to do then :) I guess it is a little confusing for me since I'm writing a library in rust, so  don't actually have control over the main function, but I have ways around that
[16:57:25] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[16:57:25] <bollu> I want an empty ~[~EventHandler]
[16:57:30] <eddyb> ~[]
[16:57:38] <bollu> oh, okay. what about the type?
[16:57:44] <bollu> inferred?
[16:57:44] <eddyb> it infers
[16:58:00] <eddyb> especially if it's a field of EventPump {...}
[16:58:06] <eddyb> inference there is trivial
[16:58:06] <bollu> yep
[16:58:17] <bollu> I still think EventPump is a terrible name :/
[16:58:24] <eddyb> EventManager?
[16:58:36] <eddyb> EventLoop? (especially if it wraps a lower level event loop)
[16:58:50] <bvssvni> jroweboy: just remember it is ok to have more objects representing states
[16:58:56] <bollu> eh, kind of. 
[16:59:00] *** zz_kimundi is now known as kimundi
[16:59:05] *** Joins: darthdeus (darthdeus@EEC5B4DB.3B96A244.4E88690D.IP)
[16:59:21] <bollu> it takes low level events and sends them to other subsystems which convert it into high level usable events
[16:59:25] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[16:59:28] *** Quits: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[16:59:45] <bollu> like, it helps convert keyPress Up to PLAYER_JUMP
[16:59:50] <bollu> that way
[17:00:21] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[17:00:45] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:01:07] <bvssvni> jroweboy: here is an architecture I use for desktop apps in C# http://isprogrammingeasy.blogspot.no/search?q=desktop
[17:01:42] <bvssvni> jroweboy: it looks impractical, but it worked well a 200 000 lines of code project
[17:02:14] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[17:02:18] <bvssvni> jroweboy: Rust got a much better type system, so it gives you more design space
[17:02:21] *** Joins: dylukes (dylukes@moz-9CC4D97.wireless.pitt.edu)
[17:02:25] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[17:02:31] <jroweboy> I'll give it a read then! I've got to get going right now though, but thanks for the design feedback!
[17:02:40] <bollu> bvssvni: neat! 
[17:02:52] <bollu> I liked the Actions v/s Advisors bit
[17:02:54] *** Joins: zztr (Thunderbir@moz-CA50D606.dsl.static.sonic.net)
[17:02:58] *** Quits: jroweboy (Mibbit@moz-18814A6B.provo.static.broadweavenetworks.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:03:01] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[17:04:22] *** Joins: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP)
[17:04:48] *** Quits: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: dherman)
[17:05:50] <bvssvni> bollu: you still need good libraries to build the app on top of :)
[17:06:01] *** Joins: untwisted (untwisted@moz-60D579DC.hsd1.ca.comcast.net)
[17:06:16] *** Quits: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP) (Quit: dave1629)
[17:06:51] *** Quits: benjamin_____ (benjamin@moz-7273BCF0.dip0.t-ipconnect.de) (Ping timeout)
[17:07:42] *** Quits: Taneb (Taneb@moz-AA8D754D.hacksoc.org) (Ping timeout)
[17:07:51] *** Joins: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net)
[17:07:58] <bollu> bvssvni: that's true for everything we do :)
[17:08:05] <bvssvni> the things Rust have can make large application design better is things like phantom types
[17:08:05] *** Quits: claudiu_ (claudiu@CB447DD5.6B10AC3.E2F59BBC.IP) (Connection reset by peer)
[17:08:16] <bvssvni> and the way traits work
[17:08:20] *** Joins: claudiu (claudiu@81B10C62.5F4BC945.49B2C1AE.IP)
[17:08:32] *** Joins: lawrence (lawrence@moz-E38FC3B2.wireless.utoronto.ca)
[17:10:00] *** Quits: claudiu (claudiu@81B10C62.5F4BC945.49B2C1AE.IP) (Ping timeout)
[17:10:53] *** Joins: hjr3 (hradtke@moz-699EABC0.lsanca.fios.verizon.net)
[17:11:20] *** Joins: Taneb (Taneb@moz-AA8D754D.hacksoc.org)
[17:11:49] *** nical is now known as nical|away
[17:13:14] *** Quits: alex__ (alex@moz-7421D6C9.mc.videotron.ca) (Connection reset by peer)
[17:14:01] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:14:08] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[17:14:32] *** Joins: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca)
[17:14:34] *** Quits: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net) (Ping timeout)
[17:14:55] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[17:15:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:15:44] *** Joins: pcwalton (pcwalton@F16146EB.9D3722BB.58DC3EE6.IP)
[17:15:44] *** ChanServ sets mode: +ao pcwalton pcwalton
[17:16:06] *** Quits: jcmoyer_ (jc@moz-40035C19.sta.embarqhsd.net) (Ping timeout)
[17:16:21] *** Quits: Guest (textual@moz-310FD28A.dynamic.caiway.nl) (Quit: Computer has gone to sleep.)
[17:16:22] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[17:16:43] *** Joins: tiffany (kawaii@moz-FC0DB29D.dhcp.embarqhsd.net)
[17:17:35] *** Joins: leowoe (Leo@moz-A5AF6850.dip0.t-ipconnect.de)
[17:17:58] <bollu> https://gist.github.com/6c15b89397bc50421b05 <-  error: missing lifetime specifier
[17:18:32] *** Havvy|shower is now known as Havvy
[17:18:34] *** Joins: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP)
[17:18:39] <eddyb> bollu: struct RenderPump<'a> {window: &'a Window, ...}
[17:18:59] <eddyb> bollu: struct definitions and the type of an impl have to be fully qualified, lifetime-wise
[17:19:00] <bollu> but isn't it obvious that Window will live as long as RenderPump lives?
[17:19:03] <eddyb> no
[17:19:08] <eddyb> it could be 'static
[17:19:11] <Ms2ger> You can't just stick a borrowed pointer in a struct without telling where you borrowed it from
[17:19:31] <bollu> I don't think I understand. example?
[17:19:42] *** Joins: blindrenderer (blindrende@AFFD8E17.329A1D83.D01D599A.IP)
[17:19:49] *** Quits: josh (josh@moz-C1D9FC5F.meeting.ietf.org) (Quit: josh)
[17:20:00] <kimundi> Doe anyone know of an easy way to ignore all files that have merge conflicts in a git rebase ?
[17:20:03] <eddyb> bollu: it's not something that can be done without global inference, which we are opposed against
[17:20:13] <eddyb> kimundi: git rebase --some-flag
[17:20:25] <eddyb> I think the conflict message gives you the options
[17:20:32] <eddyb> --continue after you've resolved and two others
[17:21:08] <kimundi> eddyb: I can skip the patch, but that skips all changed files, no?
[17:21:19] <eddyb> kimundi: you can always git checkout branch-you-want-to-keep-those-files-from merge-failure-1 merge-failure-2 etc.
[17:21:32] <eddyb> I don't think you want to skip the patch
[17:21:43] <kimundi> right, point is I don't want to list individual files :)
[17:22:10] <eddyb> I don't know then
[17:22:18] <bollu> eddyb: so, what are the downsides of global inference?
[17:22:24] *** Joins: arielb1 (Mibbit@moz-30536B86.bb.netvision.net.il)
[17:22:25] <kimundi> okay... thanks anyway :)
[17:22:26] <eddyb> bollu: unspecified APIs
[17:22:36] <doomlord_> i was just looking for a double ended queue, there's one i can use, just curious if thats' a tiled-array or not
[17:22:42] <bollu> ? gimme an example :)
[17:22:46] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[17:22:50] <Ms2ger> doomlord_, there's two
[17:23:07] <bollu> oh, also, is there a ring buffer ?
[17:23:10] <Ms2ger> doomlord_, there's a linked list one and a vector one
[17:23:23] <Ms2ger> Yes, RingBuffer
[17:23:27] <kimundi> bollu: fn foo(x)
[17:23:30] <bollu> ty
[17:23:31] *** Joins: victorporof_ (victorporo@13F2CEC5.7672369.D8E68FF6.IP)
[17:23:34] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[17:23:42] <kimundi> bollu: You write a library using foo(), but have no idea what type it is
[17:23:48] <Ms2ger> bollu, hrm, or at least I thought it was called that
[17:23:54] <kimundi> or rather what what types it takes
[17:24:05] *** Quits: victorporof (victorporo@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[17:24:09] <eddyb> bollu: and it only gets worse from there. we don't like to think about it because it's... bad
[17:24:19] <eddyb> it's almost dynamic typing
[17:24:19] <bollu> eddyb: okay :)
[17:24:28] <Ms2ger> Oh wow, extra only has 5 modules left?
[17:24:29] <bollu> eddyb: ah, I see. 
[17:24:34] <kimundi> bollu: And even if you find out, something inconsequential could change in the library that exposes foo() changing the infereed type to something completly different
[17:24:39] <eddyb> from a readability POV
[17:24:54] <eddyb> bollu: and type checking would take forever and use much more RAM
[17:24:59] <bollu> hmm
[17:25:05] <bollu> I see.
[17:25:10] <Ms2ger> bollu, collections::ringbuf::RingBuf
[17:25:15] <bollu> ty Ms2ger
[17:25:23] <bollu> and thanks for the explaination
[17:25:36] *** Joins: jmmk (jmmk@moz-3BDBD2C0.hfc.comcastbusiness.net)
[17:25:57] *** Joins: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP)
[17:26:34] <bollu> Ms2ger: how does one define "front" and "back" for a full ring buffer?
[17:26:38] <bollu> or an empty one too
[17:26:47] *** Joins: mbx (mbebenita@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[17:26:58] <Ms2ger> You'll need to look at the code for that :)
[17:27:06] <bollu> okay, will do!
[17:27:27] <bollu> It just seems strange is all. I've always seen ring buffers being unidirectional >_>
[17:28:06] <bollu> http://static.rust-lang.org/doc/master/std/iter/trait.Extendable.html <- use case? (or how to use) ?
[17:28:28] <doomlord_> i can see impl Deque<T> for DList<T> but its telling me it doesn't implemnet it... i've made sure i've got a mutable one as far as i can tell
[17:29:05] *** Quits: autra (augustin@A14DAE84.7F753DD1.EE2CA32B.IP) (Ping timeout)
[17:29:10] <doomlord_> let &mut rw:&'static mut RustWin = get_rust_win(); rw.event_queue.push_front(*e);  <<< that should have gien me an error if it isn't mutable, right :)
[17:29:15] *** Joins: maxli (Instantbir@moz-1650391B.hsd1.ca.comcast.net)
[17:30:51] <bollu> how do I use a lifetime specifier again? 
[17:31:21] <bvssvni> bollu: &'a
[17:31:23] <doomlord_> what context
[17:31:31] *** Joins: mib_2mdgox (Mibbit@moz-975B5431.dyn.optonline.net)
[17:31:40] *** Quits: mib_2mdgox (Mibbit@moz-975B5431.dyn.optonline.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:31:46] <bollu> pub fn new<`a>(window: &`a Window) 
[17:31:53] <bvssvni> bollu: if it is a closure then 'a ||
[17:32:02] <bollu> ../src/Window.rs:61:13: 61:14 error: unknown start of token: `
[17:32:02] <bollu> ../src/Window.rs:61 	pub fn new<`a>(window: &`a Window) {
[17:32:07] <eddyb> bollu: it's not ` but '
[17:32:08] <bollu> no, not a closure
[17:32:13] <bollu> oh, stupid me :)
[17:32:16] <bvssvni> bollu: wrong char
[17:32:28] *** Joins: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net)
[17:32:32] <bvssvni> ' not `
[17:32:39] <eddyb> bollu: and you don't need to put it in function argument types, unless you need it for something like a return type
[17:33:17] <bollu> eddyb: okay. how do I specify that a member "window: &Window" has a bound lifetime?
[17:33:25] *** Quits: maxli (Instantbir@moz-1650391B.hsd1.ca.comcast.net) (Ping timeout)
[17:33:25] *** Joins: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net)
[17:33:45] <eddyb> bollu: a structure member?
[17:33:53] <bollu> yeah
[17:33:55] <eddyb> window: &'a Window
[17:34:03] <eddyb> in a struct Foo<'a> {...}
[17:34:16] *** Joins: Jemaclus (Jemaclus@4EEAB704.5843BA5A.D4E4C7A5.IP)
[17:34:18] <bollu> ah, I was missing the struct Foo <'a>
[17:34:19] <bvssvni> you mean in the constructor?
[17:34:38] *** Quits: matp (matp@moz-16FE1E05.matp.at) (Quit: Bye!)
[17:34:56] <bvssvni> bollu: I first write the code without lifetime specifiers, and then put them in until Rust stops complaining
[17:35:10] *** Joins: turon (Mibbit@moz-BD95F12.tampfl.fios.verizon.net)
[17:35:13] <bollu> https://gist.github.com/6c15b89397bc50421b05 ../src/Window.rs:60:17: 60:19 error: use of undeclared lifetime name `'a`
[17:35:16] <bollu> ../src/Window.rs:60 impl RenderPump<'a> {
[17:35:19] <kimundi> bollu: lifetime names are like generic type parameters in that regard: struct Foo<'a, T> { data: &'a T } fn foo<'b, U>(t: Foo<'b, U>) { ... }
[17:35:40] *** Joins: nif (nif@F16146EB.9D3722BB.58DC3EE6.IP)
[17:35:45] <bollu> kimundi: I'm trying to use them but the compiler keeps telling me they're undefined >_<
[17:35:55] <bollu> undeclared*
[17:35:57] <bvssvni> bollu: impl<'a>
[17:36:22] <kimundi> bollu: Like generic type paramters, you need to declare them in a <> block behind the typename that tries to use them
[17:36:30] *** Joins: echristo (echristo@3246441A.D6CCE4AE.77834EAA.IP)
[17:36:32] *** Joins: mpiechotka (mpiechotka@moz-4F93BBB9.dynamic.mnet-online.de)
[17:36:36] <bollu> ../src/Window.rs:60:11: 60:21 error: wrong number of lifetime parameters: expected 1 but found 0
[17:36:39] <bollu> ../src/Window.rs:60 impl<'a>  RenderPump{
[17:36:41] <doomlord_> http://pastebin.com/4pzQjCiS  <<< what am i doing wrong with these DLists :(
[17:36:48] <eddyb> bollu: impl<'a> RenderPump<'a>
[17:37:02] <kimundi> or, in case of a generic impl, behind the impl keyword
[17:37:11] <bollu> why? ;_; that's just... verbose
[17:37:35] <eddyb> it's an impl generic over the lifetime
[17:37:38] <kimundi> bollu: It makes sense
[17:37:43] <eddyb> and then you "feed" that lifetime into RenderPump
[17:37:59] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:38:03] <bvssvni> bollu: there is certainly a reason for it, but I wouldn't dwell into it, I like to stay sane
[17:38:10] <bollu> okay, I suppose I see that point of view :)
[17:38:23] <bollu> ../src/Window.rs:62:16: 62:17 error: expected `:` but found `>`
[17:38:23] *** Quits: mawuli (mawuli@moz-A89BBCE.com.gh) (Ping timeout)
[17:38:23] <bollu> ../src/Window.rs:62 		RenderPump<'a> { window: window, renderers: ~[] }
[17:38:28] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[17:38:32] <bollu> https://gist.github.com/6c15b89397bc50421b05
[17:38:35] <kimundi> "For all lifetime 'a, implement these methods on the instanciation of the type RenderPump<'a>"
[17:38:39] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[17:38:43] *** Quits: StarLight (StarLight@moz-598C8E4D.dynamic.avangarddsl.ru) (Ping timeout)
[17:38:44] <eddyb> bollu: no need for it there
[17:39:00] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Quit: Leaving...)
[17:39:02] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:39:04] <eddyb> bollu: most of the time you don't have named lifetimes, so you couldn't explicitly say what the lifetimes were
[17:39:07] *** Quits: mye (mye@moz-51785099.dip0.t-ipconnect.de) (Quit: mye)
[17:39:14] <eddyb> when constructing a struct like that
[17:39:39] <bollu> I didn't understand that statement at all
[17:39:46] <eddyb> remove the <'a>
[17:39:51] <bvssvni> bollu: you forgot to specify a return type of 'new'
[17:39:53] <eddyb> from the struct construction
[17:39:54] <bollu> like, I have a named lifetime in this case, so why can't I "tag" it?
[17:40:00] <eddyb> in that case you can
[17:40:02] <bollu> bvssvni: yep, I got it to compile. thanks!
[17:40:03] <bvssvni> bollu: -> RenderPump<'a>
[17:40:14] <eddyb> bollu: but that cases is rare
[17:40:20] <eddyb> those cases are rare, even
[17:40:51] <bollu> so, here, since I have only one named lifetime it automatically assigns 'a to RenderPump ?
[17:40:57] <bollu> like, what's going on?
[17:41:00] <eddyb> well, it does local inference
[17:41:06] *** Parts: aepsil0n (eduard@moz-B5507714.hsi8.kabel-badenwuerttemberg.de) ()
[17:41:11] <kimundi> bollu: "RenderPump{ window: window, renderers: ~[] }" is a expression that creates a value of type RenderPump<'a>, with a infered lifetime 'a. Its the same as not needing to specify the type in something like "let x = 5u;"
[17:41:19] <eddyb> just like Some(x) works without specifying the type
[17:41:52] *** Joins: victorporof (victorporo@13F2CEC5.7672369.D8E68FF6.IP)
[17:41:52] <bollu> hmm. 
[17:42:07] *** Quits: victorporof_ (victorporo@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[17:42:07] <bollu> but it's a compiler error to explicity denote *which* lifetime?
[17:42:25] <kimundi> yes, but not neccessarly intentionally so :)
[17:42:26] <bollu> if I have multiple lifetimes like the example (you?) showed me other day
[17:42:34] *** Joins: StarLight (StarLight@moz-FC8F398D.dynamic.avangarddsl.ru)
[17:42:35] <bollu> kimundi: okay!
[17:42:45] *** Joins: pauls (pauls@moz-BFEF1F22.ccs.neu.edu)
[17:42:49] <eddyb> I really want impl Trait for Foo to be equivalent to impl<'a> Trait for Foo<'a>, if I have a lifetime and I don't use 'a
[17:42:52] <kimundi> Many errors where/are simply legacy, or noone ever needing the functionality
[17:43:13] <eddyb> I mean, it's needed if I use 'a, I just don't all the time and it is verbose then
[17:43:27] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[17:43:35] *** Joins: heftig (heftig@moz-656F0540.dip0.t-ipconnect.de)
[17:43:47] <bollu> I'm finding the whole lifetime thing a little too hacky >_< guess I just need to get used to it
[17:43:49] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[17:44:00] <kimundi> bollu: Also, in _expressions_, generic arguments get annotated as name::<...>, not name<...>, so if it would work, it would be "RenderPump::<'a> { window: window, renderers: ~[] }"
[17:44:01] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[17:44:17] *** Joins: brson (brson@F16146EB.9D3722BB.58DC3EE6.IP)
[17:44:17] *** ChanServ sets mode: +ao brson brson
[17:44:33] <bollu> kimundi: thanks for the info! I'll probably forget though ;)
[17:44:36] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[17:44:40] <bvssvni> haha
[17:44:42] *** Quits: pcwalton (pcwalton@F16146EB.9D3722BB.58DC3EE6.IP) (Ping timeout)
[17:44:55] <kimundi> bollu: Its basically a secondary generic system running in parallel to a regular one, just with scopes instead of types :P
[17:45:04] <arielb1> actually, I think having a default struct lifetime that live as long as the struct would be nice
[17:45:17] <arielb1> remove much annotation
[17:45:24] <eddyb> arielb1: but that's not what <'a> is ;)
[17:45:39] <eddyb> there's a subtle magic to it
[17:45:54] *** Quits: ganitsu (ganitsu@moz-5FF1A2BC.dialup.adsl.anteldata.net.uy) (Quit: WeeChat 0.4.1)
[17:45:55] *** Joins: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP)
[17:45:57] <arielb1> Having &'a S be &'a S<default: 'a>
[17:46:01] <kimundi> arielb1: And its also not how lifetimes work :)
[17:46:05] <bollu> eddyb: how are lifetimes implemented?
[17:46:07] <eddyb> struct Foo<'a>(&'a Bar) doesn't mean *directly* that Bar lives longer than Foo
[17:46:12] <arielb1> I know
[17:46:12] <bvssvni> when returning an struct with lifetime, the compiler makes sure borrowed pointers outlive the struct
[17:46:25] <eddyb> arielb1: it doesn't require Bar to live longer than Foo
[17:46:29] <eddyb> arielb1: it doesn't have to
[17:46:32] <kimundi> bollu: Its a pure static analysis at compile time - at runtime they don't exist
[17:46:32] *** Joins: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za)
[17:46:45] <bollu> kimundi: soo... C++ level code?
[17:46:46] <arielb1> In Foo<'a>(&'a Bar)?
[17:46:47] *** Quits: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP) (Quit: valentin)
[17:46:59] <arielb1> Can 'a exit while a struct with 'a exists?
[17:47:04] <bollu> oh, wait, the compiler is bootstrapped right? :(
[17:47:12] <bollu> damn, I was hoping I could read the code
[17:47:17] <eddyb> arielb1: you can only construct Foo with a Bar that lives longer
[17:47:19] <kimundi> bollu: Hm? ah.
[17:47:20] <eddyb> bollu: you... can
[17:47:28] <arielb1> lt(Bar) must be > lt(Foo)
[17:47:31] <bollu> if it's rust I doubt i'll understand it :)
[17:47:38] <arielb1> I think
[17:47:40] <eddyb> arielb1: that's not implied
[17:47:44] *** Joins: nkoep (nik@moz-10914ED.pool.mediaways.net)
[17:47:47] <Jemaclus> i like it when I come here to ask a question, and then in the process of typing out my question, I answer it myself.
[17:47:47] <arielb1> can you have a counterexample?
[17:47:56] *** Joins: capt_redbeard (Adium@45231B7.66CFC1C7.18422E69.IP)
[17:48:00] <eddyb> arielb1: you just can't construct a structure with a reference to something that doesn't exist
[17:48:12] <kimundi> Jemaclus: Precognitive rubber ducks!
[17:48:21] <capt_redbeard> anyone know what this could be? !!! (resolving module in lexical scope) module wasn't actually a module!
[17:48:21] <eddyb> arielb1: and if it's borrowed, it can't die for as long as it's borrowed
[17:48:26] <Jemaclus> kimundi: indeed
[17:48:31] <eddyb> arielb1: the named lifetime is just being generic
[17:48:34] <bollu> kimundi: were lifetimes present from the start ?
[17:48:42] <bollu> in the language that is
[17:48:53] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Input/output error)
[17:48:53] <eddyb> nope
[17:48:56] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[17:48:57] <kimundi> bollu: No, the Rust language has changed _a lot_
[17:49:02] <bvssvni> capt_redbeard: can you gist some code?
[17:49:04] <Jemaclus> I feel like RosettaCode solutions miss the point sometimes.
[17:49:09] <arielb1> If you have fn<'a> f(&'a Foo)
[17:49:16] <arielb1> the 'a must be longer then f's runtime
[17:49:22] <arielb1> lifetime parameters must be live
[17:49:27] <bollu> in that case, how did they bootstrap the compiler if the language changed around so much?
[17:49:32] <eddyb> arielb1: but not directly
[17:49:37] <kimundi> bollu: There was a time where it had typestate, and everything was garbage collected 
[17:49:38] <eddyb> arielb1: the lifetime doesn't require that
[17:49:42] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[17:49:43] <bollu> build new features and scrap old features /using/ old features?
[17:49:45] <bstrie> bollu: very, very arduously
[17:49:46] <capt_redbeard> bvssvni: https://gist.github.com/kylecook80/9372526
[17:49:48] <Jemaclus> For example, one of the tasks is a Quicksort... the PHP example just says "sort($foo)"... which I guess technically works, but... I dunno. I would rather see how PHP would implement the algorithm itself.
[17:49:48] <bollu> kimundi: typestate?
[17:50:00] *** Quits: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP) (Ping timeout)
[17:50:12] <arielb1> If you have a live Foo<'something>, then the lifetime of Foo is not larger then 'something
[17:50:21] <bvssvni> capt_redbeard: compiler error? (and change the language to Rust in the gist)
[17:50:27] <eddyb> arielb1: only because you can't *construct* it without something that's not alive yet
[17:50:27] <arielb1> (of that borrow of Foo)
[17:50:29] <kimundi> bollu: Building new features using old features is exactly what is happening, and slows the whole "upgrading the compiler to the newest code" precces down considerably :)
[17:50:41] <eddyb> arielb1: you can use transmute to create impossible cases like that
[17:50:46] <eddyb> arielb1: lifetimes are just generics
[17:50:52] <bollu> in that case, why bootstrap? 
[17:50:56] <arielb1> You can use transmute to do EVERYTHING
[17:50:59] <bollu> as a test for the language?
[17:50:59] *** Quits: dylukes (dylukes@moz-9CC4D97.wireless.pitt.edu) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[17:51:00] <arielb1> doesn't count
[17:51:10] <capt_redbeard> bvssvni: Refresh
[17:51:18] <bollu> someone tell me what this magical "transmute" is
[17:51:27] <arielb1> it's like reinterpret_cast
[17:51:27] <eddyb> bollu: maybe you don't know what we mean by bootstrapping
[17:51:38] <eddyb> bollu: the compiler is written in Rust
[17:51:43] <eddyb> bollu: *current* Rust
[17:51:46] <arielb1> you can do everything you want
[17:51:46] <kimundi> bollu: Thats a main reason - also way more efficient if you don't need to context switch between compiler source and compiler input :P
[17:51:47] <bollu> eddyb: use the current version of the language to write the next version of te compiler
[17:51:51] <bollu> yeah exactly
[17:51:53] <arielb1> cast integers to pointers and write through them
[17:52:01] <arielb1> cast types to integer arrays to get the pointers you want
[17:52:07] *** Quits: lawrence (lawrence@moz-E38FC3B2.wireless.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[17:52:36] <bollu> kimundi: that's a funny point :)
[17:53:10] *** Quits: redShadow (redShadow@9BDAF02B.D15F9219.1CCF65D9.IP) (Quit: Leaving)
[17:53:12] <bvssvni> capt_redbeard: what is happening? Rust thinks it is a module and then it's not a module?
[17:53:23] <kimundi> bollu: Its an important - the language would evolve way more slower otherwise
[17:53:37] <capt_redbeard> bvssvni: When I compile, thats the error it gives me. I don't know why. I think my syntax is correct so I don't know whats wrong.
[17:53:47] <bvssvni> capt_redbeard: is Menu declared a file Menu.rs?
[17:53:47] *** Joins: josh (josh@moz-244364B2.cable.virginm.net)
[17:53:48] <bollu> kimundi: but it also makes the process of evolving harder yes?
[17:53:58] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Ping timeout)
[17:53:58] <bollu> what if you discover a bug in the language?
[17:53:59] <arielb1> having a default type parameter that (at least by default) is equal to the lifetime of the container would be nice
[17:54:04] <capt_redbeard> bvssvni: its menu.rs (no caps
[17:54:04] <arielb1> reduce annotation burden
[17:54:07] <bollu> you'd have to unroll loads of versions
[17:54:15] <kimundi> bollu: Eh, not really
[17:54:16] <capt_redbeard> bvssvni, I can post that file as wel
[17:54:22] <arielb1> so when you discover a struct needs to hold a borrowed member you can just add it
[17:54:28] <arielb1> and not change all structs containing it
[17:54:29] <bvssvni> capt_redbeard: would be helpful
[17:54:36] <arielb1> and all structs containing these
[17:54:48] <bollu> you... sidestep the bug and write a non-buggy next compiler version? :)
[17:55:11] <kimundi> bollu: Generally, there is not chanche for a bug so big that it would invaliate even one version of the compiler to surface
[17:55:15] <capt_redbeard> bvssvni: posted.
[17:55:31] *** Joins: nano (nano@moz-ED77243C.superkabel.de)
[17:55:55] <kimundi> bollu: And the bugs there are can usually be sidestepped - after all, if they couldn't be, they'd be found directly
[17:56:02] <bvssvni> capt_redbeard: I think the old code disappeared
[17:56:03] *** Quits: capt_redbeard (Adium@45231B7.66CFC1C7.18422E69.IP) (Connection reset by peer)
[17:56:06] <bollu> kimundi: so, when I "make" rust, it first builds a subset of rust and is then bootstrapped? 
[17:56:10] *** Joins: capt_redbeard (Adium@45231B7.66CFC1C7.18422E69.IP)
[17:56:18] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[17:56:18] <bollu> how does the build process work?
[17:56:20] *** Joins: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP)
[17:56:33] <kimundi> bollu: It just downloads a recent version from a amazon server ;)
[17:56:42] <bollu> kimundi: that's cheating! :)
[17:56:49] <bvssvni> capt_redbeard: there is 'new' function in the Menu impl
[17:56:51] <eddyb> arielb1: I don't think I've managed to convince you
[17:56:53] <bollu> so it's impossible to build rust?
[17:56:57] <bollu> from scratch?
[17:56:57] <bvssvni> capt_redbeard: *no
[17:57:23] <kimundi> bollu: The alternative is to to rebuild and rebuild every single step back to the original OCaml Rust bootstrap compiler
[17:57:27] *** Quits: kngl (Adium@moz-18BD1C.ipv4.evonet.be) (Ping timeout)
[17:57:38] <bvssvni> capt_redbeard: 'new' is not a default constructor in Rust, it needs to be declared
[17:57:41] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[17:57:42] *** Quits: hoverbear (hoverbear@726D908C.44E18222.E74D50F2.IP) (Quit: Taking a nap.)
[17:57:47] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[17:57:58] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[17:58:08] <capt_redbeard> bvssvni: ohhh thats right. Ok I'll see what I can do. Thanks for looking.
[17:58:23] <bollu> kimundi: so it's theoretically possible?
[17:58:44] <arielb1> eddyb: If you have fn<'a, 'b> f(&'a Foo<'b>), then the lifetime of members of Foo must be at least 'a
[17:58:50] <kimundi> bollu: Theoretical, yes
[17:59:06] <bollu> hm okay
[17:59:07] <kimundi> bollu: Practical, I think it would be faster to start from scratch with the current language
[17:59:12] <bollu> ../src/main.rs:31:25: 31:31 error: cannot borrow `window` as mutable because it is also borrowed as immutable <- why not?
[17:59:17] <bollu> kimundi: lol, really?
[17:59:31] <kimundi> bollu: As I said, anacient Rust has nothing in common with modern Rust
[18:00:02] <bollu> kimundi: how long have you been around? ever since ancient rust? :)
[18:00:03] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[18:00:13] *** Quits: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP) (Quit: dave1629)
[18:00:23] <eddyb> arielb1: no, it has to be exactly 'a
[18:00:27] <eddyb> arielb1: no more, no less
[18:00:35] <arielb1> they may live longer
[18:00:36] <arielb1> of course
[18:00:45] <arielb1> they don't NEED to be destroyed after 'a
[18:00:48] <arielb1> because covariance
[18:00:57] <kimundi> And there are _enough_ irregularities inbetween that you couldn't just setup a automated script to build it from scratch
[18:00:58] <bvssvni> bollu: because when you take & you can't then take &mut
[18:01:04] *** Quits: aravindavk (aravinda@DEC02659.F5CD2BD8.C0FE4824.IP) (Ping timeout)
[18:01:12] <kimundi> bollu: Nah, I'm here for somewhat over an year
[18:01:24] <bvssvni> bollu: the old & needs to run out of scope
[18:01:25] *** Quits: leowoe (Leo@moz-A5AF6850.dip0.t-ipconnect.de) (Quit: Leaving.)
[18:01:35] *** Joins: pcwalton (pcwalton@F16146EB.9D3722BB.58DC3EE6.IP)
[18:01:35] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:01:36] <bollu> so, how do I reimplement it?
[18:01:39] <bollu> can I take a ~ ?
[18:01:45] <arielb1> bollu: you can't have a & and &mut to the same object at the same time
[18:01:45] <kimundi> Rust back then was already very similar to today - it just had more @ ;)
[18:01:59] <bollu> so, I change both to &mut ?
[18:02:09] <bollu> kimundi: that was the "boxed" thing right?
[18:02:11] <arielb1> you can't have two &muts either
[18:02:14] <bollu> -_-
[18:02:18] <arielb1> where's the code?
[18:02:23] <bollu> okay, so how do I share an object?
[18:02:23] <arielb1> what are you trying to do?
[18:02:24] <eddyb> arielb1: thing is, nothing enforces lifetimes living longer or anything like that
[18:02:26] *** Joins: wilmoore (wilmoore@moz-1248C037.mystrotv.com)
[18:02:27] <bvssvni> bollu: add some brackets { let x = &y; }, or gist some code
[18:02:31] <doomlord_> in an unsafe block how do i get a *mut T  from a mut Option<~T>  ;  i've tride various things , like   (&(*g_rustwin.unwrap())) as *mut RustWin   <<< (i didn't want unsafe code for this but its not letting me do what i want ; its messy global based interface to glut :( )
[18:02:36] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[18:02:40] <eddyb> arielb1: it's just type inference applied to lifetimes
[18:02:59] <bollu> just a se
[18:03:22] <bvssvni> doomlord: as *mut T?
[18:03:30] <bvssvni> doomlord_: ^
[18:03:33] <bollu> https://gist.github.com/64511e73a4d0fb4a68b3
[18:03:49] <kimundi> bollu: If you want to share something between different parts of code, without being able to express it with references or RefCell, you'd use shared ownership pointers, like Rc<T> or Arc<T>
[18:03:54] <doomlord_> thats one of the things i've tried.. i'll paste
[18:03:56] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[18:04:10] <kimundi> bvssvni: won't work
[18:04:13] <bollu> hmm. if I don't keep it as a member, things would be fine?
[18:04:26] <arielb1> bollu: you need to close renderpump
[18:04:27] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[18:04:29] <arielb1> before closing window
[18:04:32] <kimundi> "as" only works for a few specific build in cases, and not for any library types at all
[18:04:40] <doomlord_> http://pastebin.com/HZzSDUGr
[18:04:44] <arielb1> so that renderpump won't see the closed window
[18:04:45] <bollu> it's complaining about poll()
[18:04:45] *** Quits: untwisted (untwisted@moz-60D579DC.hsd1.ca.comcast.net) (Ping timeout)
[18:05:01] <arielb1> poll should take a &window
[18:05:07] <arielb1> and renderpump should (probably) too
[18:05:07] <Ms2ger> doomlord_, match g_rustwin { None => ptr::null(), Some(ref x) => &**x as *RustWin as *mut RustWin }?
[18:05:18] <arielb1> and express mutability with Cell/RefCell
[18:05:35] *** Joins: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP)
[18:05:47] <Ms2ger> Or match g_rustwin { None => ptr::null(), Some(ref x) => &mut **x as *mut RustWin }?
[18:05:54] <arielb1> who uses renderpump?
[18:06:00] <arielb1> I don't see a reference to it
[18:06:02] <bvssvni> bollu: renderPump owns a &mut window
[18:06:16] <bvssvni> bollu: you can call poll via renderPump, but not on window
[18:06:25] <doomlord_> ok i've not looked into Cell etc... i probably should.. lets just see if i can get this to work
[18:06:42] <arielb1> what does renderPump do?
[18:06:44] <arielb1> how it is called
[18:07:01] *** Joins: capt_redbeard1 (Adium@1F201A45.DF6E5361.18422E69.IP)
[18:07:01] <bollu> bvssvni, arielb1: modified it, should work properly now
[18:07:02] <arielb1> I think it's probably better to give renderPump the window only when its drawing
[18:07:02] <doomlord_> Ms2ger that worked with 'ptr::mut_null()' thanks
[18:07:16] <Ms2ger> Np
[18:07:18] *** Quits: capt_redbeard (Adium@45231B7.66CFC1C7.18422E69.IP) (Ping timeout)
[18:07:34] *** Joins: dranov (dranov@moz-94025FE6.residential.rdsnet.ro)
[18:07:38] *** Quits: capt_redbeard1 (Adium@1F201A45.DF6E5361.18422E69.IP) (Connection reset by peer)
[18:07:47] <arielb1> bollu: how did you fix it?
[18:07:53] *** Joins: capt_redbeard (Adium@30EDB697.E4EA2998.18422E69.IP)
[18:08:00] *** Quits: capt_redbeard (Adium@30EDB697.E4EA2998.18422E69.IP) (Quit: capt_redbeard)
[18:08:19] <bollu> stopped holding window in my object
[18:08:25] <bollu> now passing it whenever I use it
[18:08:28] <arielb1> sure
[18:08:32] <arielb1> that's the best option
[18:08:33] <bollu> don't hold onto window basically
[18:08:40] <bollu> arielb1: yeah, thought so
[18:08:50] *** jorendorff is now known as jorendorff_away
[18:08:50] *** Quits: pcwalton (pcwalton@F16146EB.9D3722BB.58DC3EE6.IP) (Ping timeout)
[18:08:51] <bollu> but I'm a little worried about the overhead
[18:08:52] <bollu> let's see
[18:09:06] <arielb1> I typically do it like this in S
[18:09:08] <arielb1> JS
[18:09:09] *** jorendorff_away is now known as jorendorff
[18:09:29] <arielb1> essentially - I regenerate the DOM every time I touch it
[18:10:39] *** Quits: carllerche (carllerche@moz-CA3FF5F1.hsd1.or.comcast.net) (Quit: carllerche)
[18:12:02] <bvssvni> bollu: looks nice
[18:12:21] <mindcat> rusti: let 密码 : ~str = "password"; 密码
[18:12:22] -rusti- pastebinned 14 lines of output: http://sprunge.us/aaPg
[18:13:01] *** Joins: Matthias247 (Miranda@moz-678B5E4A.hsi2.kabel-badenwuerttemberg.de)
[18:13:04] <bvssvni> mindcat: unicode only works in strings?
[18:13:09] <kimundi> mindcat: Theoretically possible, but currently disabled per default
[18:13:35] *** Quits: sawrubh|bot (~sawrubhbo@moz-E0F149F7.members.linode.com) (Connection reset by peer)
[18:13:37] <kimundi> bvssvni: In principle, it works for identifers
[18:13:50] <mindcat> it is possible define "let" as "setting" or "设"?
[18:14:03] <kimundi> Not without hacking the compiler
[18:14:34] <bollu> mindcat: I find it nice how one symbol maps to a whole word :)
[18:14:35] <mindcat> oh, I have to hack compiler :D
[18:14:55] *** Joins: untwisted (untwisted@moz-60D579DC.hsd1.ca.comcast.net)
[18:15:00] <mindcat> well, that's I want answers
[18:15:04] *** Quits: soumyaC (uid15286@moz-E77DEB21.irccloud.com) (Quit: Connection closed for inactivity)
[18:15:05] *** Joins: p1start (rewi@moz-A082F561.adsl.xtra.co.nz)
[18:15:37] *** Joins: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP)
[18:15:44] *** Quits: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP) (Quit: dave1629)
[18:16:45] <nano> unicode is evil
[18:17:39] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:17:45] <bollu> https://gist.github.com/bollu/3c077ebe86cb9b7ec099 <-  error: type `Window::RenderPump` does not implement any method in scope named `pump`
[18:17:47] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:18:33] *** Quits: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP) (Ping timeout)
[18:19:17] <bvssvni> bollu: did you forgot a 'use'?
[18:19:22] <eddyb> bollu: does it have self?
[18:19:35] <bollu> sigh, no
[18:19:38] <bollu> eddyb: thanks
[18:19:43] <eddyb> hehehe
[18:19:49] <bollu> but the compiler error is /totally/ misleading >_<
[18:20:08] <mindcat> I just see http://en.wikipedia.org/wiki/Easy_Programming_Language
[18:20:28] <mindcat> It is popular in china
[18:20:35] <bollu> ../src/main.rs:42:25: 42:32 error: cannot borrow immutable dereference of & pointer as mutable
[18:20:38] <bollu> ../src/main.rs:42         renderPump.pump(&window);
[18:20:42] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Quit: Leaving)
[18:20:54] <bollu> that means... ?
[18:21:10] <bollu> I'm not borrowing an "immutable dereference"
[18:21:11] <kimundi> is pump defined as taking &mut ?
[18:21:52] <bollu> https://gist.github.com/bollu/3c077ebe86cb9b7ec099
[18:21:54] <bollu> yeah
[18:22:03] *** Quits: arielb1 (Mibbit@moz-30536B86.bb.netvision.net.il) (Quit: http://www.mibbit.com ajax IRC Client)
[18:22:09] <bollu> but window is created as a mutable Window too
[18:22:18] <bvssvni> bollu: .pump(&mut window);
[18:22:36] *** Joins: sawrubh|bot (~sawrubhbo@moz-E0F149F7.members.linode.com)
[18:22:46] <kimundi> Ah, yeah, what bvssvni said
[18:23:22] <bollu> umm, can't it figure out I need to borrow it mutably?
[18:23:25] <bollu> it seems odd
[18:23:36] *** Joins: frogzilla (Mibbit@E87770CF.F746F57.CC1A2609.IP)
[18:23:37] <bollu> I know, I complain too much >_<
[18:23:38] <kimundi> bollu: Btw, I have that gist language=rust probelm too - the solution is to just _name_ the gist as "foo.rs" or so :)
[18:23:39] *** Joins: doener (doener@moz-C68F600D.unity-media.net)
[18:23:42] <bvssvni> bollu: whenever you & instead of &mut, it is immutable
[18:24:18] <mindcat> I just see E program language is bad thing
[18:24:24] <bollu> kimundi: oh, thanks! bvssvni: what does that accomplish? it knows the signature of both the function and the window. it can just use it..
[18:24:28] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[18:24:43] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[18:24:45] *** Joins: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP)
[18:24:46] <kimundi> bollu: The idea behind separating immutability and mutability is explicit that you need to _choose_ which one to take. If it where inferred everywhere, it would be the same as everything being mutable :)
[18:24:47] <mindcat> Windows only
[18:24:49] <bvssvni> bollu: it makes it possible to see what happens locally
[18:25:39] <bollu> ah, that explaination makes sense. thanks!
[18:25:46] *** Joins: ecr (chatzilla@moz-6B73682D.dhcp4.washington.edu)
[18:26:01] <bvssvni> bollu: you'll get used to it :P
[18:26:36] <bollu> anyone know how to mass-delete gists?
[18:26:45] <bollu> I have ~20 private gists that are all buggy :)
[18:27:32] *** Joins: alkino (alkino@moz-53CAAA6D.w92-151.abo.wanadoo.fr)
[18:27:37] * bvssvni never deletes gists *shrugs*
[18:27:39] *** Quits: ziad (ziad@moz-C0318336.hsd1.ca.comcast.net) (Quit: ziad)
[18:27:48] *** Joins: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP)
[18:27:51] <bollu> xD
[18:28:11] *** Quits: frogzilla (Mibbit@E87770CF.F746F57.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:28:26] *** Joins: aravindavk (aravinda@8406DA31.EDB517A2.BB883D3E.IP)
[18:28:30] <bollu> okay, went through each of them and clicked delete >_>
[18:28:50] <mrmonday> where did std::unstable::intrinsics disappear to?
[18:29:39] *** Quits: asmyers (quassel@F7FD79FB.9A737B8F.FAA4474F.IP) (Client exited)
[18:30:08] *** Joins: Guest (textual@moz-310FD28A.dynamic.caiway.nl)
[18:30:48] <acrichto> mrmonday: std::intrinsics
[18:30:50] <bvssvni> mmonday: looks like it is moved one level up
[18:31:17] <mrmonday> okie dokie, thanks :)
[18:31:18] <kimundi> Question: Who here would consider vec::append and vec::append_one as deprecated legacy stuff?
[18:31:20] *** Quits: p1start (rewi@moz-A082F561.adsl.xtra.co.nz) (Ping timeout)
[18:31:25] <acrichto> me!
[18:31:51] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[18:31:51] * kimundi got confirmation from core dev, deletes them.
[18:32:02] <acrichto> you may want to wait for a little longer
[18:32:09] <acrichto> pcwalton has almost removed ~[T] entirely
[18:32:19] <acrichto> and extra churn may be difficult
[18:32:21] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:32:34] <mrmonday> what's happening to ~[T] exactly?
[18:32:42] <acrichto> we're migrating to Vec<T>
[18:32:55] <acrichto> it's planned in the future that ~[T] is not a growable vector
[18:33:03] <bvssvni> nice
[18:33:09] <mrmonday> mmk
[18:33:12] <acrichto> but rather it'll be frozen in length but still owned (and therefore mutable)
[18:33:14] <kimundi> mrmonday: Replaced by Vec<T>, then removed from the language, then later remerging as the composition of ~T with the new dynamically sized type [T]
[18:33:45] <mrmonday> really wanna get my changes in soon so I don't have to spend so much time fixing language changes
[18:33:56] <mrmonday> gonna have a lot of late nights these next few days
[18:34:24] *** Joins: asmyers (quassel@F7FD79FB.9A737B8F.FAA4474F.IP)
[18:34:38] <mrmonday> ugh, I hate when git auto-merges stuff in a way that deletes things :(
[18:35:13] <kimundi> acrichto: I know, I have a patch I was working on on and off, then pcwalton started invalidating huge chunks of it. ;) Right now, I'm mostly just looking for things that got carried over to Vec<T> that should go
[18:35:32] <mindcat> →_←
[18:35:37] <mindcat> XD
[18:36:40] <kimundi> Hah, append and append_one acttually got carried over to vec_ng
[18:39:29] *** Joins: edwardw (edwardw@4112974A.B4358688.30F15291.IP)
[18:39:40] *** Quits: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) (Connection reset by peer)
[18:39:58] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[18:41:13] *** Joins: rveach (kvirc@410D297A.C7FE7DD2.1302FB2C.IP)
[18:41:34] <doomlord_> Being able to move code from one module to another without faffing around with headers, so nice..
[18:43:24] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[18:43:39] *** Joins: mawuli (mawuli@moz-A89BBCE.com.gh)
[18:43:49] *** Quits: Kxepal (Miranda@moz-8A62DD41.pppoe.mtu-net.ru) (Quit: Kxepal)
[18:43:53] *** Quits: murph1 (murph@moz-F07B75BF.oracle.com) (Ping timeout)
[18:44:03] *** Joins: Kxepal (Miranda@moz-8A62DD41.pppoe.mtu-net.ru)
[18:44:09] *** Joins: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP)
[18:44:25] <jmmk> doomlord_ I've never personally used C++, but are you required to create a .h file that stays in sync with your main .c file?
[18:44:40] *** Quits: canhtak (canhtak@moz-E7F2DD45.dsl.bell.ca) (Quit: canhtak)
[18:44:40] *** Quits: josh (josh@moz-244364B2.cable.virginm.net) (Quit: josh)
[18:45:01] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[18:45:09] <mcpherrin> jmmk: C++ is generally much more header-heavy than C
[18:45:14] <bvssvni> jmmk: yes, but in C++ it is .cpp
[18:45:16] *** Joins: capt_redbeard (Adium@45231B7.66CFC1C7.18422E69.IP)
[18:45:17] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[18:45:24] *** Quits: capt_redbeard (Adium@45231B7.66CFC1C7.18422E69.IP) (Quit: capt_redbeard)
[18:45:27] <doomlord_> right, its the interaction of Classes and Headers that always bugged me in C++
[18:45:48] <doomlord_> in C it was a little easier because basically the act of putting something in a header was 'public' 
[18:45:54] *** Joins: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net)
[18:46:10] <strcat> doomlord_: not really the case
[18:46:17] <strcat> unless you used PIMPL, which has overhead
[18:46:23] <strcat> and you can use PIMPL in C++ too
[18:47:01] <doomlord_> if you didn't use C++ class methods, you had more opportunities to avoid putting unecassery things in headers
[18:47:16] <strcat> doomlord_: methods don't need to be defined in headers
[18:47:20] <doomlord_> and i never used PIMPL, i never liked the idea of adding unnecasery overhead just for the way headers work
[18:47:21] <mcpherrin> C++ header-only libraries are amusing
[18:47:28] *** Joins: ziad (ziad@B20586FB.BDB3D91.6E370BFC.IP)
[18:47:36] <strcat> mcpherrin: rust's libstd is pretty close to that
[18:47:40] <doomlord_> methods need to be declared in headers along with the class, unless the whole class isn't used elsewhere
[18:48:05] <strcat> doomlord_: the method definitions don't need to be in the header
[18:48:11] <doomlord_> sure the definitions dont..
[18:48:21] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[18:48:21] *** ChanServ sets mode: +o jdm
[18:48:30] <doomlord_> but you need to bounce back and forth between the header and the source file when writing lots of internal code
[18:48:31] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[18:48:50] <strcat> headers do a pretty reasonable job of describing the ABI
[18:48:52] <doomlord_> you planned the 'interface'.. (the public part).. but then when you're implementing you still usually need to add internal helper functions (private stuff)
[18:49:11] <doomlord_> ABI or API
[18:49:45] <doomlord_> of course you can still drop back to functions in C++ but then your code starts looking inconsistent
[18:50:10] *** Joins: Savago (Savago@F0CE5436.E820043D.D4C04133.IP)
[18:50:30] <strcat> rust doesn't support stable ABIs and compilation units can't have cyclic dependencies
[18:50:30] <kimundi> Please someone tell me whether this is a joke: http://huvrtech.com/ Oo
[18:51:11] <doomlord_> can you always eliminate a cyclic dependancy by breaking something apart more
[18:51:22] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Ping timeout)
[18:51:29] <strcat> doomlord_: no
[18:51:38] <strcat> rust doesn't allow you do make compilation as incremental
[18:51:45] <strcat> it's just how crates are designed
[18:51:50] <Ms2ger> Sadly
[18:51:55] <strcat> you can have two C files using functions from each other
[18:51:58] <strcat> compiled independently
[18:52:19] <strcat> ofc if you use LTO, it's all one big compilation unit anyway
[18:52:21] <doomlord_> so you can get a situation where you can't fix it by creating more crates?
[18:52:22] <strcat> but for a debug build it's very nice
[18:52:26] <bvssvni> kimundi: what is the technology?
[18:52:34] <strcat> doomlord_: yes, crates don't permit compilation to be split up as much as you can in C
[18:52:40] <strcat> doomlord_: you can't have cyclic dependencies like that
[18:53:19] <strcat> doomlord_: and rust doesn't make a distinction between implementation and interface, so you need to recompile programs every time a library is updated
[18:53:19] *** Quits: untwisted (untwisted@moz-60D579DC.hsd1.ca.comcast.net) (Ping timeout)
[18:53:22] <doomlord_> can you think of a quick example to demonstrate
[18:53:26] <Ms2ger> I think that might end up being one of the biggest pain points for Servo
[18:53:28] <strcat> there are sacrifices made for the nice crate semantics
[18:53:46] <kimundi> bvssvni: The only piece of information I could find on this site is "strong electromagnet" - I'm pretty skeptical, but so far I didn't see anything that I could pinpoint as obviously wrong :P
[18:53:50] <doomlord_> are you saying headers are in fact a virtue :(
[18:53:59] <strcat> doomlord_: lets say you have an allocator, a vector and a map
[18:54:05] <strcat> well w/e
[18:54:15] <bvssvni> kimundi: I have seen a hoverboard based on super conductors, but it requires a strong magnet field
[18:54:25] <strcat> doomlord_: I'm saying that rust's crates are not a strict improvement over the C model
[18:54:31] <bvssvni> kimundi: wouldn't work over normal ground
[18:54:47] *** Quits: ivan (ivan@moz-531C3EC9.members.linode.com) (Ping timeout)
[18:54:47] *** Quits: Edwards (MeltdownMo@moz-B62E1D6B.members.linode.com) (Ping timeout)
[18:54:51] *** Quits: nszceta (hax@moz-E458A7C0.pharm.pitt.edu) (Input/output error)
[18:54:57] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[18:55:03] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Ping timeout)
[18:55:14] <bvssvni> kimundi: one can create rail tracks though
[18:55:17] <doomlord_> is this something i've simply never noticed because headers deal with it?
[18:55:22] *** Quits: sawrubh|bot (~sawrubhbo@moz-E0F149F7.members.linode.com) (Ping timeout)
[18:55:24] *** Quits: daschl (Adium@moz-DC6DE6E2.vie.surfer.at) (Quit: Leaving.)
[18:55:31] *** Quits: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net) (Quit: killerswan)
[18:55:39] <doomlord_> i'm finding it hard to imagine a situation where a cyclic dependancy can't be fixed by breaking something apart more
[18:55:41] *** Quits: nanotech (nanotech@moz-DD3580FD.members.linode.com) (Ping timeout)
[18:55:51] *** Quits: Caseus (bacon@moz-9F046088.members.linode.com) (Ping timeout)
[18:55:55] *** Quits: xales (xales@moz-7DEA692E.forevernothing.com) (Ping timeout)
[18:56:04] *** Quits: bstrie (ben@moz-D5A1D0F5.members.linode.com) (Ping timeout)
[18:56:14] *** Quits: skelly (hl@moz-55F978C0.org) (Ping timeout)
[18:56:15] <doomlord_> crates still allow defining the equivalent of templated code, right? generic functions as some sort of metadata rather than actual object code
[18:56:21] *** Quits: doy (doy@moz-8F23663C.net) (Ping timeout)
[18:56:33] *** Quits: petantik (oz@moz-20EC2160.net) (Ping timeout)
[18:56:45] *** Joins: doy (doy@moz-8F23663C.net)
[18:57:04] *** Joins: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP)
[18:57:14] *** Quits: mawuli (mawuli@moz-A89BBCE.com.gh) (Ping timeout)
[18:57:16] *** Quits: ekiara (emk@moz-9B1940E9.tech.co.ke) (Ping timeout)
[18:57:24] *** Joins: nrc (nrc@F16146EB.9D3722BB.58DC3EE6.IP)
[18:57:25] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[18:57:30] <cmr> kimundi: I'll believe it when I see it
[18:57:32] *** Quits: carter (carter@moz-58F59B3A.members.linode.com) (Ping timeout)
[18:57:33] *** Joins: soumyaC (uid15286@moz-E77DEB21.irccloud.com)
[18:57:38] <doomlord_> getting rid of header files is probably about 50% of my motivation for looking at rust
[18:57:38] *** Quits: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP) (Ping timeout)
[18:58:02] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[18:58:15] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Input/output error)
[18:58:20] <strcat> doomlord_: foo() and bar() are mutually recursive functions
[18:58:24] <strcat> one is in foo.c, one is in bar.c
[18:58:30] <kimundi> cmr: Yeah, kinda my thinking
[18:58:31] <mcpherrin> doomlord_: yes, generics are monomorphised for the particular type parameters
[18:58:40] <strcat> C can compile them independently of each other
[18:58:44] <hhhhhhhhhh> will it ever be possible to have multiple implementations of Mul etc for a type
[18:58:44] <strcat> there are far more examples than that though
[18:58:46] *** Joins: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[18:59:02] *** Quits: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) (Ping timeout)
[18:59:06] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[18:59:12] <strcat> doomlord_: all it needs is the ABI for the bar function to compile foo, and the ABI of the foo function to compile bar
[18:59:14] <hhhhhhhhhh> eg it would be nice to have Mul< Vec3, f64 > for scaling and Mul< Vec3, Vec3 > for pointwise multiplication
[18:59:25] *** Quits: doy (doy@moz-8F23663C.net) (Ping timeout)
[18:59:43] <SiegeLord> I solved that problem using traits
[18:59:46] <doomlord_> well couldn't that in principle be fixed by adding a declaration to rust
[18:59:58] <strcat> doomlord_: doubt it
[19:00:00] <doomlord_> double-dispatch traits?
[19:00:28] <strcat> I don't think it's a huge issue
[19:00:28] <doomlord_> you kind of already do this for interfaceing with C, right?
[19:00:32] *** Joins: mawuli (mawuli@moz-A89BBCE.com.gh)
[19:00:43] <doomlord_> could you just declare your cyclic functions as extern "C" :)
[19:00:48] <strcat> doomlord_: yes, but that's a wart... it should automatically read the headers
[19:00:51] <strcat> doomlord_: that's not safe
[19:00:59] <SiegeLord> I don't think I used double dispatch
[19:01:00] *** Joins: ekiara (emk@moz-9B1940E9.tech.co.ke)
[19:01:03] *** Joins: pcwalton (pcwalton@F16146EB.9D3722BB.58DC3EE6.IP)
[19:01:03] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:01:13] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:01:13] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:01:14] *** Joins: carter (carter@moz-58F59B3A.members.linode.com)
[19:01:21] *** Joins: nanotech (nanotech@moz-DD3580FD.members.linode.com)
[19:01:21] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[19:01:27] <doomlord_> SiegeLord was the trait already specific to the first parameter
[19:01:30] *** Joins: Edwards (MeltdownMo@moz-B62E1D6B.members.linode.com)
[19:01:43] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:01:43] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:01:44] *** Quits: wilmoore (wilmoore@moz-1248C037.mystrotv.com) (Ping timeout)
[19:01:45] <doomlord_> (i thought you needed double-dispatch if you wanted to make something overload on 2 parameters)
[19:01:55] *** Joins: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP)
[19:02:04] <doomlord_> (i was curious to know if there was a better way..)
[19:02:13] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:02:13] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:02:20] *** Joins: mgottschlag (quassel@moz-DF7A2B6A.cust.bluewin.ch)
[19:02:22] <SiegeLord> Maybe you could think of it as double dispatch, but it's just a common interface in my case
[19:02:24] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:02:34] <SiegeLord> The scalar essentially implements Index that always returns the same thing
[19:02:39] <strcat> doomlord_: the way headers/includes work is that the header declares an ABI, and then includes declare a dependency
[19:02:43] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:02:43] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:02:49] <strcat> so tools like qmake look through the files to find the includes, and count those as deps
[19:02:50] <SiegeLord> And for multiplication, I require RHS to have an implementation of Index and length
[19:02:50] *** Joins: ivan (ivan@moz-531C3EC9.members.linode.com)
[19:02:57] *** Joins: Caseus (bacon@moz-9F046088.members.linode.com)
[19:03:01] <strcat> and then they can do *automatic* incremental compilation without any restructuring of the code
[19:03:09] <doomlord_> strcat well, moving from C to C++ i described the problem i felt..
[19:03:34] <strcat> doomlord_: I'm not saying headers are a good way to do this
[19:03:36] <doomlord_> in C you could put forward declarations of structs in headers, and declare function prototypes.. just the 'interface' - then declaere the struct body in 'internal headers' or inside
[19:03:43] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:03:43] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:03:43] <strcat> just that rust's way isn't really an improvement
[19:03:51] <strcat> headers a very poor way to do what they do
[19:03:51] *** Joins: murph1 (murph@moz-29F9DAC6.oracle.com)
[19:03:51] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[19:03:53] <doomlord_> in C++ , if you wanted to use the method-call syntax .. you had to put *everything* in the header, always.
[19:04:02] <doomlord_> C++ basically made headers worse.
[19:04:08] *** Joins: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP)
[19:04:13] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:04:13] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:04:15] <strcat> it would be much better to just declare stuff in the module and then auto-generate an ABI file
[19:04:35] <Ms2ger> Boo, headers and boo, crates
[19:04:44] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:04:44] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:04:44] *** Joins: bstrie (ben@moz-D5A1D0F5.members.linode.com)
[19:05:13] <doomlord_> there was one workaround i saw - to match the C method - where you declared class Foo{ ...interface cfunctions...} ... and you never included that header in the implementation.. you made another header class Foo {... the real Foo, public functions, private functions }  ... of course you couldn't use constructors
[19:05:13] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:05:13] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:05:14] <strcat> rust's module system isn't designed to tackle this problem though
[19:05:22] <strcat> I don't really think it can be retroactively added in
[19:05:32] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[19:05:32] <strcat> it's not the end of the world though
[19:05:33] *** Quits: skade (skade@moz-F3F67608.pools.arcor-ip.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:05:39] *** Quits: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) (Ping timeout)
[19:05:42] *** Joins: skelly (hl@moz-55F978C0.org)
[19:05:43] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[19:05:43] *** Quits: brianloveswords (brianloves@moz-CB223D1E.members.linode.com) (Max SendQ exceeded)
[19:05:48] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[19:06:01] *** kmc sets mode: +b brianloveswords!brianloves@moz-CB223D1E.members.linode.com
[19:06:06] <doomlord_> i had wondered if the best, hypothetical build system for rust would compile incrmentally at a granularity lower than crates or even files
[19:06:20] <doomlord_> at least dividing it up to file level..
[19:06:38] <doomlord_> crates do seem too large a unit usually
[19:06:51] <strcat> it would mean redesigning name resolution and modules
[19:07:06] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[19:07:12] <doomlord_> i mean if manpower was no object.. you could implement a whole new compiler
[19:07:18] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Input/output error)
[19:07:26] <doomlord_> but make it semantically the same output
[19:07:26] *** Quits: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net) (Ping timeout)
[19:07:28] <strcat> also we use a *lot* of generic code
[19:07:41] <strcat> it's questionable whether incremental compilation is actually a good thing for rust in the first place
[19:07:45] <bvssvni> generics in Rust is like a language in itself
[19:07:51] *** Quits: hjr3 (hradtke@moz-699EABC0.lsanca.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[19:07:54] *** Joins: valentin1 (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP)
[19:08:00] <strcat> since you end up getting copies of the generic code for each compilation unit
[19:08:01] <kmc> bvssvni: not as much as in C++ :)
[19:08:05] <doomlord_> isn't incremental compilation the only way to really leverage parallelism
[19:08:09] <strcat> generics in rusts are barely another language
[19:08:12] <bvssvni> kmc: yeah, I have heard that
[19:08:17] <strcat> lifetimes and type parameters work essentially the same way
[19:08:20] <doomlord_> or at least the best way. i suppose it can be a big pipeline too
[19:08:37] <doomlord_> i got the impression some sort of incremental system would help completions
[19:08:38] *** Quits: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP) (Ping timeout)
[19:08:38] <kmc> doomlord_: if LLVM supported it we could do codegen for different functions in parallel
[19:08:45] <strcat> kmc: intel implemented it
[19:08:48] <strcat> just didn't land yet
[19:08:48] <Ms2ger> Mm, more memory usage
[19:09:21] <eddyb> strcat: I just looked at the relevant code
[19:09:23] <strcat> Ms2ger: not really, function passes are cheap
[19:09:25] <doomlord_> for starters doesn't context free grammar mean you can generate the AST's for each source file in parallel
[19:09:32] <strcat> Ms2ger: the module pass can't really run in parallel
[19:09:34] <strcat> and that's the big code
[19:09:37] <strcat> s/code/cost/
[19:09:48] <bstrie> doomlord_: that's not a bottleneck
[19:09:49] <eddyb> strcat: we could just not enable multithreading in LLVM when we don't need it
[19:10:07] <eddyb> like, outside of rustdoc
[19:10:14] <eddyb> I've heard it's a performance penalty
[19:10:23] <strcat> rustdoc needs LLVM? ;s
[19:10:24] <doomlord_> but wouldn't the AST go a long way to figuring out dependancies between modules and hence what you can parallelize on the next pass
[19:10:39] *** Joins: skade (skade@moz-F3F67608.pools.arcor-ip.net)
[19:10:43] <eddyb> strcat: rustdoc uses LLVM in parallel
[19:10:48] <cmr> eddyb: what?
[19:10:57] <eddyb> on different contexts
[19:11:02] <eddyb> as in, entire different crates
[19:11:04] <strcat> doomlord_: so you have a generic function, two modules use it
[19:11:11] <strcat> doomlord_: who is responsible for generating it, and where is it output?
[19:11:31] <cmr> eddyb: you mean in the test runner?
[19:11:41] <eddyb> cmr: rustdoc test runner?
[19:11:54] <eddyb> if it's compiletest I'll feel a bit stupid. though I'm just repeating what others have said
[19:11:54] <cmr> rustdoc::test
[19:11:55] <doomlord_> wouldn't the generic function be defined in 'another module' if 2 modules use it, and its instantiation in each module could be quite different (requiring different inlining, potentially)
[19:11:57] <strcat> doomlord_: imo you'll be doing so much locking that it's not going to work out
[19:12:01] <eddyb> cmr: yeah, that
[19:12:25] <doomlord_> well i'm not about to try this out myself :)
[19:12:28] *** Joins: kvanb (kvanb@moz-1A7A80B8.lnse4.win.bigpond.net.au)
[19:12:31] <strcat> doomlord_: if you make each module get their own instantiations, you'll slow down compilation time a *huge* amount
[19:12:39] <strcat> doomlord_: will also cause extreme code bloat
[19:12:43] <cmr> eddyb: I don't think it does...
[19:12:50] <strcat> rust's stdlib is quite comparable to a C++ library like boost
[19:12:53] <strcat> it's nearly all generic/inline code
[19:12:58] <eddyb> cmr: then why the heck do we pay for multithreaded LLVM?
[19:13:11] <strcat> doomlord_: I don't think the C assumptions about incremental compilation will hold for rust
[19:13:19] <strcat> just like they don't hold with very generic C++
[19:13:20] <doomlord_> but isn't that the point of generics .. they're a common pattern that is instantiated quite differently most of the places its used.... don't generics - especially collections - heavily rely on the ability to inline out various things
[19:13:21] <cmr> eddyb: shenanigans?
[19:13:28] <eddyb> cmr: at least it's rustc code, so it can be disabled easily, if we want to test it
[19:13:31] <Ms2ger> strcat, rust or rustc?
[19:13:33] *** Quits: nical|away (nico@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[19:13:37] <strcat> Ms2ger: rust
[19:13:37] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[19:14:08] <strcat> if you ended up recompiling vectors and iterators for nearly every module, I can't see how compilation time would be improved
[19:14:13] <strcat> even if you were doing it on 4 cores instead of 1
[19:14:15] <eddyb> cmr: feel free to compare it... though LLVM running times vary so much in irsy :(
[19:14:21] <doomlord_> and isn't it the case with modern multicore CPUs that you can often speed things up by something that might be slower on a single core machine - repeated work but done independantly is sometimes worthwhile
[19:14:26] <strcat> vectors, iterators, layers and layers of pointer/cast/intrinsic wrappers
[19:14:29] <doomlord_> (thats sometimes the case in low level graphics..)
[19:15:15] *** Quits: marwy (user@41303A68.5C2AEEF8.CFA44423.IP) (Quit: ERC Version 5.3 (IRC client for Emacs))
[19:15:34] <doomlord_> i dont know how the stages look, but might it mean splitting what you call "compiling"... compile the vectors & iterators up to "a certain point" that is serial & common everywhere, then compile the final stage 'in each module that its' used'
[19:15:51] <strcat> doomlord_: 90% of compilation time is spent in LLVM
[19:15:54] <eddyb> doomlord_: if only it were that simple
[19:16:10] <eddyb> doomlord_: run rustc with -Z time-passes if you want to see an overview
[19:16:13] <strcat> doomlord_: there's almost no point of parallel execution of the rest, it goes pretty darn fast
[19:16:30] <eddyb> strcat: there is some benefit to partial execution
[19:16:40] <strcat> imo, the answer will be designing libraries differently
[19:16:41] <eddyb> and maybe then you could do parallel on that, but it's almost pointless
[19:16:42] <strcat> not changing rustc
[19:16:57] <strcat> I do not expect any major speedups from parallelization
[19:17:15] <eddyb> everything up to and including type checking is relevant to IDEs
[19:17:17] <cmr> at most you get a few seconds from typeck and resolve.
[19:17:19] *** Quits: kvanb (kvanb@moz-1A7A80B8.lnse4.win.bigpond.net.au) (Quit: kvanb)
[19:17:28] <strcat> and then 2-3 mins in LLVM
[19:17:31] <Ms2ger> Some people did not expect more than 5 computers to be necessary in the US :)
[19:17:31] <cmr> best case.
[19:17:43] <eddyb> cmr: we can shave a lot from that yak that is typeck
[19:18:01] <strcat> when you consider that 90% of time is spent in LLVM
[19:18:05] <bvssvni> would it be possible to do type checking without compilation?
[19:18:11] *** Quits: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za) (Ping timeout)
[19:18:16] <cmr> bvssvni: already can, rustdoc does it.
[19:18:17] <strcat> I can't see why you would want to duplicate more code by splitting it up and instantiating the same things more than once
[19:18:17] <doomlord_> i usually have a lot of faith in parallelization, but i know its potentially a huge amount of work re-designing code to use it
[19:18:27] <doomlord_> it can be a re-write, a complete re-think
[19:18:41] <eddyb> doomlord_: good luck with that
[19:18:42] <strcat> doomlord_: again, 90% of the time is spent in LLVM
[19:18:50] <bvssvni> cmr: then I should use rustdoc if I want faster iterations between code and checking?
[19:18:52] <eddyb> rewrite LLVM in Rust
[19:18:56] <doomlord_> i'm not expecting it to happen in the rust community any time soon :)
[19:18:57] <strcat> it's not a rustc problem, it's a *rust* problem
[19:19:05] <cmr> bvssvni: no, rustc --no-trans
[19:19:10] <strcat> rustc is not as bad as people make it out to be
[19:19:16] <eddyb> then you can use memory safety primitives to go fast in parallel
[19:19:27] <eddyb> which Rust has but not C++
[19:19:27] <strcat> it doesn't make great IR at a low-level, but it's not like it spits out 10x more than clang
[19:19:39] <strcat> try compiling boost spirit code with clang
[19:19:43] <eddyb> no thanks
[19:19:54] <bvssvni> cmr: thanks :)
[19:20:02] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[19:20:03] <strcat> you include a few lines of boost spirit calls and it goes from 0.5s -> 10s
[19:20:11] <strcat> pretty much what happens with rust...
[19:20:28] <strcat> imo there's not going to be a compiler solution, we'll get a few more 10-15% speedups
[19:20:38] <strcat> we'll make a lot of barely noticeably micro-optimizations too
[19:20:47] <strcat> the rest needs to be a culture shift
[19:20:55] <doomlord_> someone might ask if the 10% -> 90% split rust->LLVM is a case of rust assuming brute force use of LLVM, however I completely get the logic that LLVM should handle cross langauge issues and you want to leverage it as much as possible.
[19:21:02] <strcat> start designing code to compile quickly and perform well at --opt-level=0 and --opt-level=1
[19:21:07] <strcat> it's not rustc's fault
[19:21:23] <eddyb> strcat: that means we have to clean up trans, though
[19:21:33] <eddyb> it can produce much better IR in some cases
[19:21:34] <strcat> I'm mostly talking about libraries
[19:21:37] <strcat> eddyb: sure
[19:21:40] <strcat> eddyb: rustc can be improved
[19:21:44] <doomlord_> so is my itch to go back to C for simple interfaces actually still valid r.e. software build times..
[19:21:44] <strcat> but not a 2x or 3x speed improvement
[19:22:01] <eddyb> strcat: not needing SROA to devirtualize would be a big bonus to things like iterators and Option's map
[19:22:12] <bvssvni> 10% of 10% speedup is 1%
[19:22:21] <strcat> eddyb: that's a language change
[19:22:27] <doomlord_> if LLVM later improves that 1% is more
[19:22:29] <strcat> (getting rid of boxed closures as the default)
[19:22:35] <eddyb> strcat: that too
[19:22:52] <strcat> LLVM will likely get slower over time, not faster
[19:22:55] <eddyb> strcat: but a boxed closure doesn't have to be completely opaque to LLVM \ SROA
[19:23:02] <strcat> because it's going to catch up with GCC in terms of optimization features
[19:23:20] <eddyb> it is right now because we put pointers behind pointers, tons of allocas etc.
[19:23:20] *** Quits: aravindavk (aravinda@8406DA31.EDB517A2.BB883D3E.IP) (Ping timeout)
[19:23:41] <doomlord_> how much compilation can be pipelined rather than parallized (I know pipelining is a form of parallelizing) ... i suppose LLVM is doing heavy whole program analysis that is a bottleneck
[19:23:41] <strcat> atm LLVM takes something like 65% of the time as GCC, but it used to be faster, and it will continue getting slower ;p
[19:23:56] <zwarich> strcat: generally speaking (this may have changed since I worked on it every day) the optimizer and code generator were speeding up despite adding features, since we optimized the implementation of existing things when we added new things
[19:24:05] <zwarich> strcat: more of the slowdown came from the frontend
[19:24:08] <eddyb> doomlord_: it uses graphs, updating relevant portions etc.
[19:24:13] <strcat> zwarich: from C++11, etc.? or just fixing bugs
[19:24:23] <erickt> strcat: one effect that might counteract LLVM getting slower over time is if the rumored LLVM-backed JavaScript backend gets into production Safari
[19:24:29] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Connection reset by peer)
[19:24:31] <zwarich> strcat: new language features, fixing bugs, new warnings, etc. not sure anyone ever found out
[19:24:37] <strcat> erickt: safari won't be using it as a baseline compiler
[19:24:41] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[19:24:59] <eddyb> strcat: how could you even used typed IR for baseline JIT :P?
[19:25:02] <strcat> they'll no doubt have a fast interpreter and a fast JIT before passing bits to LLVM
[19:25:08] <eddyb> without making it useless
[19:25:16] <erickt> strcat: oh? is apple using llvm as a background compiler?
[19:25:20] <eddyb> s/used/use
[19:25:29] *** Joins: xales (xales@moz-7DEA692E.forevernothing.com)
[19:25:32] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[19:25:39] *** Joins: daschl (Adium@moz-DC6DE6E2.vie.surfer.at)
[19:25:39] <eddyb> erickt: LLVM is typed and can use the information that the baseline JIT produces
[19:25:44] <doomlord_> i'm still on a pendulum here. once i actually start writing rust code , its great.. enums, and I'm really enjoying lack of headers, and the expression oriented syntax. Then i get little doubts like what you're talking about now.. build times, or the fact i'm having to faff around to get code on android
[19:25:44] <zwarich> strcat: I think the tiering goes interpreter / fast JIT / slow JIT / LLVM
[19:25:54] <doomlord_> and I miss IDE with completions
[19:25:57] <eddyb> erickt: v8's optimizing JIT has an IR close to LLVM's
[19:26:07] *** Joins: petantik (oz@moz-20EC2160.net)
[19:26:08] *** Quits: valentin1 (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP) (Quit: valentin1)
[19:26:10] <eddyb> erickt: just specialized for JS
[19:26:14] *** Joins: paupau (posttext@moz-377BE2CD.hsd1.ca.comcast.net)
[19:26:20] *** Joins: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP)
[19:26:20] *** ChanServ sets mode: +ao dherman dherman
[19:26:21] *** Joins: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP)
[19:26:23] <strcat> anyway
[19:26:33] <strcat> imo this is a language/library and culture issue
[19:26:34] <mcpherrin> doomlord_: a lot of those things are growing pains and should get better...
[19:26:35] <eddyb> erickt: while the baseline compiler doesn't use SSA at all, it's more like our rustc's trans, working on the AST
[19:26:39] <bvssvni> doomlord_: you should wait for 1.0 before making any big decisions
[19:26:46] <strcat> parallel function passes won't make compiling layers and layers of thin wrappers faster
[19:26:51] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[19:26:51] <strcat> because they're split into many functions
[19:26:57] <strcat> most of rust's optimization takes place after inlining
[19:27:22] <eddyb> strcat: I think we could improve the situation by running function passes as we trans
[19:27:25] <doomlord_> when i go back to C++... header files and 'const' everywhere really grates :)
[19:27:39] <eddyb> strcat: and causing things like immediate inlining
[19:27:48] <strcat> eddyb: inline is a module pass
[19:27:51] <doomlord_> i should go back to C lol.
[19:27:59] <strcat> eddyb: function passes never do inline, etc. 
[19:27:59] <zwarich> another thing that might help is doing SSA construction on the fly in trans instead of relying on mem2reg
[19:28:06] *** Joins: hjr3 (hradtke@moz-699EABC0.lsanca.fios.verizon.net)
[19:28:09] *** Quits: daschl (Adium@moz-DC6DE6E2.vie.surfer.at) (Ping timeout)
[19:28:18] <eddyb> strcat: don't we trans "in order"?
[19:28:21] <strcat> zwarich: if you use #[no_std] and write rust like C, it already compiles quickly
[19:28:36] <strcat> people keep repeating that rustc is slow over and over but I don't really think it's true
[19:28:41] <strcat> no, it doesn't generate IR as well as clang
[19:28:45] <strcat> but no, it's not incredibly slow
[19:28:51] *** Joins: geoffhill (geoffhill@moz-95FF7399.members.linode.com)
[19:28:54] <strcat> and it's not responsible for --opt-level=0 and --opt-level=1 being so slow
[19:29:14] <eddyb> strcat: that is, when we've finished producing IR for function f, all the functions it calls and the functions those functions call etc. should be already present, no?
[19:29:27] <eddyb> strcat: then we can run a module pass on just f
[19:29:38] <doomlord_> one thing that makes me worry is that compile speed will be related to IDE completion speed
[19:29:47] <strcat> eddyb: you can't run a module pass 'on just f'
[19:29:49] <eddyb> doomlord_: that's up to and including typeck
[19:29:51] <strcat> a module pass is on the module
[19:30:09] <doomlord_> oh so that might be half of the 10% or something
[19:30:09] <eddyb> strcat: right. but only "touch" f
[19:30:12] <erickt> zwarich: I thought mem2reg was pretty fast. If I recall correctly, clang uses it
[19:30:23] <strcat> erickt: clang generates SSA form stuff at -O0
[19:30:26] <strcat> we don't
[19:30:32] *** Parts: nchapman (sid15818@moz-E77DEB21.irccloud.com) ()
[19:30:34] *** Joins: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net)
[19:30:34] <eddyb> zwarich: I am pushing for that :D
[19:30:42] <strcat> and clang is 'legacy code', it doesn't necessarily do the best thing
[19:30:50] <doomlord_> LLVM is pretty big right, 1.5mloc ?
[19:31:01] <strcat> first-class aggregates, etc. didn't use to exist
[19:31:02] <doomlord_> clang is 1.5mloc ?
[19:31:05] <strcat> and we don't need to follow C ABI rules
[19:31:16] <eddyb> zwarich: we can produce beautiful IR from Rust code, we just don't do it yet
[19:31:25] <eddyb> strcat: hang on a second... can we do additive optimizations?
[19:31:32] <zwarich> erickt: yeah it's been optimized pretty well now (I wrote a lot of the current code in mem2reg), but it still might help to avoid constructing all of those allocas and the eliminating them
[19:31:51] <eddyb> strcat: add a function, run module passes again... nevermind maybe it's stupid
[19:32:03] <erickt> strcat: if they generate SSA at -O0, do you know why do they use mem2reg for -O1+?
[19:32:07] <eddyb> zwarich: it does help
[19:32:18] <strcat> erickt: because they don't *only* generate SSA form stuff
[19:32:26] <strcat> they do it when it's convenient
[19:32:37] <strcat> really though, this is a red herring
[19:32:42] <strcat> rustc is why rust compiles slowly
[19:32:48] <strcat> try using #[no_std], try comparing it to clang
[19:32:51] <zwarich> Clang basically never generates any phis itself, the main exception is the ternary operator
[19:32:52] <strcat> rustc is faster than clang
[19:32:55] <strcat> try it
[19:33:00] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[19:33:10] <eddyb> zwarich: I have a PR that shows both a compilation ime reduction and a RAM usage reduction, from replacing allocas with SSA values in a few special cases
[19:33:15] <strcat> rustc isn't why rust compiles slowly*
[19:33:20] <strcat> w/e though
[19:33:28] <zwarich> eddyb: oh cool, got a link?
[19:33:54] *** Joins: arielb1 (eran@moz-E6742496.red.bezeqint.net)
[19:34:05] <eddyb> zwarich: but it could be better than that because we still use DPS (destination passing style, I think) for constructing all sorts of intermediary values
[19:34:10] <eddyb> zwarich: https://github.com/mozilla/rust/pull/12424
[19:34:17] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[19:34:37] *** Quits: LU324 (asdf@moz-864C7465.dyn.embarqhsd.net) (Ping timeout)
[19:35:00] <mindcat> rusti: let a : || = |b| {};a(1)
[19:35:02] -rusti- pastebinned 8 lines of output: http://sprunge.us/UZDU
[19:35:09] *** Joins: canhtak (canhtak@moz-E7F2DD45.dsl.bell.ca)
[19:35:14] *** Joins: LU324 (asdf@moz-864C7465.dyn.embarqhsd.net)
[19:35:20] <mindcat> rusti: let a : |u8| = |b| {};a(1)
[19:35:21] -rusti- <anon>:10:25: 10:26 warning: unused variable: `b`, #[warn(unused_variable)] on by default
[19:35:21] -rusti- <anon>:10         let a : |u8| = |b| {};a(1)
[19:35:21] -rusti-                                   ^
[19:35:21] -rusti- ()
[19:35:29] <mindcat> right
[19:35:44] <zwarich> eddyb: I'm not sure if you've seen this paper: http://pp.info.uni-karlsruhe.de/publication.php?id=braun13cc (slides are there too)
[19:35:56] <bvssvni> rusti:  let a : |u8| = |_| {};a(1)
[19:35:56] -rusti- ()
[19:36:01] <zwarich> eddyb: it's about the folklore algorithm for on-the-fly SSA construction
[19:36:09] <eddyb> zwarich: but...
[19:36:24] <eddyb> zwarich: I don't see why it would matter how you construct your SSA
[19:36:35] <eddyb> zwarich: we translate the AST to IR
[19:36:46] <mindcat> rusti: fn l(_ : uint) {print!{"{}", _} };l(2)
[19:36:46] -rusti- <anon>:10:38: 10:39 error: unexpected token: `_`
[19:36:46] -rusti- <anon>:10         fn l(_ : uint) {print!{"{}", _} };l(2)
[19:36:47] -rusti-                                                ^
[19:36:47] *** Joins: io2 (io2@moz-EE406A5.home.otenet.gr)
[19:36:48] -rusti- application terminated with error code 101
[19:36:50] *** Quits: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net) (Quit: stevegury)
[19:36:55] <zwarich> eddyb: well you just want to make sure you get the minimum number of phis
[19:36:57] <mindcat> rusti: fn l(_ : uint) {print!{"123"} };l(2)
[19:36:58] -rusti- 123()
[19:37:03] <eddyb> zwarich: we don't output phis
[19:37:15] *** Joins: gwty (gwtypc@CFCDB47B.132F4848.B29E8538.IP)
[19:37:15] <zwarich> eddyb: ah, I am suggesting that you could ;-)
[19:37:56] <bvssvni> mindcat: oh it's an L, I was thinking it was | for a second
[19:38:06] <eddyb> zwarich: let x = if {a} else {b}; could be quite compact with phis
[19:38:08] <mindcat> bvssvni: XD
[19:38:20] <strcat> redesigning metadata would help a lot
[19:38:39] <eddyb> strcat: I compressed the tag values so they all fit in one byte :P
[19:38:46] <eddyb> there were spaces all over the place
[19:38:50] *** Joins: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca)
[19:38:57] <strcat> for example atm, it's so bloated that we compress it all
[19:39:02] <strcat> which means it all has to be read, doesn't it?
[19:39:06] <strcat> rather than just mmap + seek around
[19:39:21] <mindcat> `{}` is important.
[19:39:22] <strcat> if anything, we should write an AST compression algorithm
[19:39:33] <strcat> and only compress the inner parts that there's no need to seek through
[19:39:55] <eddyb> strcat: we should just encode a CFG
[19:39:56] <bvssvni> I look forward to Rust obfuscation contests
[19:40:00] <strcat> I bet the patterns are common enough that a simple pre-made dictionary is better
[19:40:06] <eddyb> zwarich: if/when we switch to using a CFG instead of an AST, that paper might come in handy
[19:40:07] * kmc is surprised but pleased to see that a static int variable can be used as a constant pattern to match that int
[19:40:26] <eddyb> kmc: that's how C enums work :P
[19:41:05] <strcat> kmc: there's some scary stuff in rust
[19:41:10] <strcat> struct Foo(int, int);
[19:41:27] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:41:28] <strcat> not only does that declare a type Foo, it declares a function 'fn Foo(int, int) -> Foo' ;)
[19:41:36] <eddyb> zwarich: we could easily do some preoptimizations instead of relying on LLVM to mem2reg and whatnot
[19:41:43] <strcat> rusti: struct Foo(int, int); Foo
[19:41:44] -rusti- fn(int, int) -> main::Foo
[19:41:45] <kmc> it's a bit dodgy because if the static isn't scope, it'll turn into a match-everything variable pattern
[19:42:03] <kmc> but the unreachable case analysis should catch that most of the time
[19:42:04] <eddyb> struct Foo(int); impl Foo {} will create Foo in all three namespaces
[19:42:13] <kmc> with a not-terribly-useful error message
[19:42:22] <eddyb> a type, a value and a module
[19:42:38] <bvssvni> strcat: so if I impl a trait for fn Foo(int, int) -> Foo, I will have a method only visible when constructing the type?
[19:42:42] <eddyb> IMO we should only create the module when we have static impls
[19:42:43] <kmc> eddyb: huh? why does that create a module?
[19:42:48] <eddyb> kmc: the impl
[19:42:49] *** Joins: stevegury (stevegury@moz-171801E.hsd1.ca.comcast.net)
[19:42:57] <eddyb> kmc: so you can call static methods like Foo::new()
[19:43:00] <kmc> i see
[19:43:11] *** Quits: killerswan (kevincantu@moz-CC0DC654.hsd1.ca.comcast.net) (Quit: killerswan)
[19:43:14] <strcat> bvssvni: you can't impl a trait for a specific function
[19:43:22] <strcat> you can only impl a trait for a type
[19:43:39] <Luqman> eddyb: at least it doesn't try to create a new module for every impl block anymore
[19:43:41] <kmc> eddyb: are there other consequences (besides namespacing) of static methods going into a pseudo-module?
[19:43:55] <eddyb> kmc: don't think so
[19:44:22] <eddyb> rusti: struct Foo; impl Option<Foo> {}
[19:44:22] -rusti- <anon>:10:26: 10:37 error: found module name used as a type: impl main::Option<Foo>::Option<Foo> (id=20)
[19:44:22] -rusti- <anon>:10         struct Foo; impl Option<Foo> {}
[19:44:22] -rusti-                                    ^~~~~~~~~~~
[19:44:22] -rusti- application terminated with error code 101
[19:44:33] <eddyb> kmc: ^^ that fails in resolve instead of coherence
[19:44:39] *** Quits: canhtak (canhtak@moz-E7F2DD45.dsl.bell.ca) (Quit: canhtak)
[19:44:50] *** Joins: zwick (user@moz-4E8B077.hsd1.mi.comcast.net)
[19:44:58] <paupau> can a macro add a field to a struct?
[19:45:07] <eddyb> paupau: only a procedural macro
[19:45:11] <eddyb> paupau: a mutator, to be precise
[19:45:18] <paupau> Oh my
[19:45:29] <mindcat> rusti: use std::iter::Range; Range::<uint>(0,9)
[19:45:30] <eddyb> what?! it looks like that struct is evolving
[19:45:30] <doomlord_> if you could declare 'member functions' (not for vtables obviously) outside of a C++ class, that would ease my pain with C++ but i already know C++ people hate that idea. 
[19:45:31] -rusti- <anon>:10:31: 10:44 error: unresolved name `Range`.
[19:45:31] -rusti- <anon>:10         use std::iter::Range; Range::<uint>(0,9)
[19:45:31] -rusti-                                         ^~~~~~~~~~~~~
[19:45:31] -rusti- error: aborting due to previous error
[19:45:31] -rusti- application terminated with error code 101
[19:45:44] <paupau> eddyb: haha. So that would be the loadable syntax extension stuff?
[19:45:49] <eddyb> paupau: yupp
[19:45:50] <doomlord_> ^( ease some of my pain..)
[19:45:54] <paupau> cool
[19:46:02] <doomlord_> they';re just regular functions with a parameter in a different place
[19:46:07] <mindcat> rusti: use std::iter::Range; Range
[19:46:07] -rusti- <anon>:10:31: 10:36 error: unresolved name `Range`.
[19:46:07] -rusti- <anon>:10         use std::iter::Range; Range
[19:46:08] -rusti-                                         ^~~~~
[19:46:08] -rusti- error: aborting due to previous error
[19:46:08] -rusti- application terminated with error code 101
[19:46:14] <eddyb> rusti: struct Foo; enum MOption<T> {MSome(T), MNone} impl MOption<Foo> {}
[19:46:15] -rusti- pastebinned 7 lines of output: http://sprunge.us/VVOY
[19:46:15] *** Joins: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za)
[19:46:21] *** Joins: rustybot (Mibbit@moz-1C68F6E0.hsd1.va.comcast.net)
[19:46:25] <strcat> paupau: methods aren't items and macros can only expand to certain things like items/exprs
[19:46:26] <eddyb> kmc: ^^ that works
[19:46:45] <paupau> okay, so I can't do like struct Foo { bar: int, my_mixin!() }
[19:46:48] <strcat> paupau: method macros could most likely be supported, but it'd take some work
[19:46:50] <eddyb> kmc: so resolve fails if it's not an outer type used in a regular impl
[19:46:54] <strcat> paupau: yeah, can't expand a macro there
[19:46:55] *** Quits: Guest (textual@moz-310FD28A.dynamic.caiway.nl) (Quit: Computer has gone to sleep.)
[19:46:58] *** Joins: canhtak (canhtak@moz-E7F2DD45.dsl.bell.ca)
[19:46:58] <rustybot> is it busy now? does anyone mind if i ask a question unrelated to rust? instead about client server communication?
[19:47:18] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[19:47:20] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Ping timeout)
[19:47:47] <Ms2ger> I think you can try :)
[19:48:00] <eddyb> zwarich: you could talk with nmatsakis about that potential CFG - when he's not busy, that is :P
[19:48:04] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:48:15] *** Quits: rveach (kvirc@410D297A.C7FE7DD2.1302FB2C.IP) (Ping timeout)
[19:48:34] <eddyb> strcat: btw, I think we don't output a dictionary for idents
[19:48:46] * edwardw thinks eddyb really wants his CFG
[19:48:48] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:49:25] <eddyb> strcat: if that's true, the encoded AST always ends up larger than the original source code with insignificant spaces removed
[19:49:27] <rustybot> Ms2ger:  im having trouble with how different components of a system communicate with eachother. for example, if i create an html website on my localhost, how can my c program get that text off the server?
[19:49:35] <eddyb> strcat: which is just lame
[19:49:39] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[19:50:00] *** Quits: mpiechotka (mpiechotka@moz-4F93BBB9.dynamic.mnet-online.de) (Client exited)
[19:50:03] <mindcat> rusti: while false {} else {print!("Hello World!")}
[19:50:04] -rusti- pastebinned 7 lines of output: http://sprunge.us/PgEA
[19:50:30] <Ms2ger> You find a http library :)
[19:50:38] <mindcat> `while .. else ..` doesn't work :S
[19:50:39] <kmc> rustybot: using a HTTP client library, for example http://curl.haxx.se/libcurl/
[19:51:07] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Connection reset by peer)
[19:51:13] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[19:51:43] <eddyb> mindcat: why would it work?
[19:51:59] <eddyb> what would it do?
[19:52:12] <mindcat> eddyb: just like python did
[19:52:12] <mcpherrin> rustybot: The short version is: Open a tcp connection to the server on port 80 (using a socket).  Send a string like "HTTP 1.0 GET /\r\n\r\n" over the socket, and the server sends back the file at that URL
[19:52:22] *** Joins: lunaryorn (lunaryorn@moz-3052D772.dynamic.mnet-online.de)
[19:52:27] <eddyb> does rust-http not have a client yet?
[19:52:32] <strcat> it does have a client
[19:52:45] <strcat> use rust-http, or if you need fancy stuff (proxy support, or other protocols) then use libcurl
[19:53:18] *** Quits: vmx (vmx@moz-91256D27.pools.arcor-ip.net) (Quit: Leaving)
[19:53:23] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Ping timeout)
[19:53:39] <bvssvni> rustybot: https://github.com/chris-morgan/rust-http
[19:53:44] <strcat> 'DICT, FILE, FTP, FTPS, Gopher, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, POP3, POP3S, RTMP, RTSP, SCP, SFTP, SMTP, SMTPS, Telnet and TFTP'
[19:53:55] <strcat> (is why curl is nice, + most libs don't even have socks proxy support... etc.)
[19:53:57] <kmc> I think describing how to speak HTTP is outside the scope of this channel >___>
[19:54:06] <kmc> Servo uses rust-http's client
[19:54:28] <mcpherrin> kmc: but how will it support gopher???
[19:54:34] <strcat> we should probably have stuff like socks support in libstd
[19:54:59] <eddyb> strcat: a stream adaptor?
[19:55:09] *** Joins: MP2E (cray@moz-EB1E242D.lv.lv.cox.net)
[19:55:11] <strcat> no just part of the tcp implementation
[19:55:30] <mindcat> eddyb: `while false .. else ..` equal loop { if false {..} else {..;break}  }
[19:55:42] <mindcat> eddyb: `while false .. else ..` equal `loop { if false {..} else {..;break}  }`
[19:55:49] <strcat> well, and UDP
[19:56:06] * strcat sighs at UDP
[19:56:17] <eddyb> mindcat: but that's... useless. at least the way you describe it
[19:56:17] *** Quits: rustybot (Mibbit@moz-1C68F6E0.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:56:18] <mcpherrin> why sigh? UDP is the only usable network transport ;)
[19:56:25] * mmalecki sighs at TCP
[19:56:27] <strcat> why can't everyone just use SCTP
[19:56:42] <eddyb> mindcat: the way you wrote it, the "else" thing always execute after you exit the while loop
[19:56:45] <kmc> at some point Python's "for ... else" came up on the Rust mailing list and people spent a while being confused about what it even does in Python and I took this as a strong indication that it shouldn't be added to Rust =)
[19:56:46] * edwardw dreams of Erlang like binary match in rust
[19:56:47] <strcat> mcpherrin: yeah, why would you care if the other end received what you sent anyway? :P
[19:57:13] <kmc> UDP isn't a transport protocol; it's a thin layer which lets you write your own transport protocol in userspace
[19:57:17] <kmc> sometimes that's useful.
[19:57:30] <Ms2ger> kmc, it's quite useful in some circumstances
[19:57:52] <mindcat> eddyb: but, when while true, and break
[19:57:58] <mcpherrin> strcat: I'll accept SCTP :-)
[19:58:08] <mindcat> eddyb: `else ..` would not execute
[19:58:12] <strcat> kmc: well, UDP is useful for implementing SCTP when the OS is bad ;)
[19:58:13] <eddyb> mindcat: oh, I see
[19:58:14] *** Quits: hjr3 (hradtke@moz-699EABC0.lsanca.fios.verizon.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[19:58:18] <eddyb> mindcat: that's... quite specific
[19:58:25] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[19:58:28] <strcat> kmc: iirc that's what webrtc does?
[19:58:33] <mcpherrin> strcat: why am I bothering to shave off 100 nanos from my networking hardware if you're going to spend half a second faffing about with TCP :( :(
[19:58:38] <ecr> mindcat: I think you might be able to replicate while...else using breaks to labels. I'll play around with it.
[19:58:58] <Ms2ger> mcpherrin, reliability
[19:58:58] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[19:58:59] <eddyb> ecr: yupp
[19:59:06] <strcat> Ms2ger: sctp is reliable, it's also fast ;p
[19:59:13] *** Quits: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za) (Ping timeout)
[19:59:34] <strcat> Ms2ger: it doesn't force you to send all the data in order though, you can concurrently send/receive messages
[19:59:37] <mcpherrin> Quix or whatever the crome folk are up to doesn't seem terrible
[19:59:40] <eddyb> ecr, mindcat: 'outer: loop{ while cond {.... break 'outer; ... } /*else*/ code; break;}
[19:59:45] <strcat> but you can order them if you want...
[19:59:54] *** kmc sets mode: -b brianloveswords!brianloves@moz-CB223D1E.members.linode.com
[20:00:03] <strcat> mcpherrin: quix? never heard of it
[20:00:04] <mindcat> ecr: I just... describe python did
[20:00:06] <strcat> wat?
[20:00:06] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[20:00:07] *** Joins: judder (maradukewa@A4DC519F.6379DA33.78E362FE.IP)
[20:00:10] <mindcat> eddyb: I just... describe python did
[20:00:13] *** Joins: brianloveswords (brianloves@moz-CB223D1E.members.linode.com)
[20:00:21] <Ms2ger> s//what/
[20:00:29] *** Quits: urbanserj (urbanserj@3E28BD5F.398BF19F.86BD9C9E.IP) (Ping timeout)
[20:00:36] <mcpherrin> strcat: sorry, Quic
[20:00:44] <mcpherrin> http://en.wikipedia.org/wiki/QUIC
[20:00:50] <strcat> mcpherrin: neat, never heard of that either ;)
[20:00:56] <kimundi> Ms2ger: Great, no we have an infinte expansion :P
[20:01:08] <eddyb> strcat: I know QUIC because I enabled it about:flags and it broke youtube
[20:01:12] <eddyb> *it in
[20:01:13] <strcat> isn't this just a reinvention of sctp though
[20:01:21] <eddyb> most likely
[20:01:25] <mcpherrin> strcat: yeah, it's SCTP in userspace :P
[20:01:27] <aatch> whatwhatwhatwhatwhatwhatwhatwhat
[20:01:45] <eddyb> go home aatch, you're not a pelican
[20:01:46] <mindcat> rusti
[20:01:47] <mcpherrin> strcat: but not compatible with sctp over udp, unfortunately
[20:01:51] <strcat> mcpherrin: windows :(
[20:01:53] * strcat sighs
[20:02:05] <mcpherrin> exokernel plz
[20:02:10] <eddyb> rusti: print!("mindcat: NOPE"); if true { return;}
[20:02:10] <mindcat> rusti: while "2" { print!("what") }
[20:02:10] -rusti- mindcat: NOPE
[20:02:11] -rusti- <anon>:10:15: 10:18 error: mismatched types: expected `bool` but found `&'static str` (expected bool but found &'static str)
[20:02:11] -rusti- <anon>:10         while "2" { print!("what") }
[20:02:11] -rusti-                         ^~~
[20:02:11] -rusti- error: aborting due to previous error
[20:02:11] -rusti- application terminated with error code 101
[20:02:15] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[20:02:19] <mindcat> rusti: while "2" == "2" { print!("what") }
[20:02:21] <mcpherrin> If I'm gonna turn my browser into an OS, might as well do it efficiently
[20:02:24] -rusti- line longer than 10000 characters, bailing out
[20:02:34] <mindcat> XD
[20:03:46] *** Quits: ecr (chatzilla@moz-6B73682D.dhcp4.washington.edu) (Ping timeout)
[20:03:48] <strcat> mcpherrin: meh, once they're all using processes for each site instance, it won't be as much of a reinvention of the OS
[20:04:19] <mcpherrin> strcat: I mean more in terms of providing graphics, network, user input, etc abstractions
[20:04:22] *** Joins: urbanserj (urbanserj@3E28BD5F.398BF19F.86BD9C9E.IP)
[20:04:37] <strcat> mcpherrin: pnacl + pepper ;P
[20:04:50] <mindcat> rusti: return to LC
[20:04:50] -rusti- <anon>:10:19: 10:21 error: expected one of `;`, `}` but found `LC`
[20:04:50] -rusti- <anon>:10         return to LC
[20:04:50] -rusti-                             ^~
[20:04:50] -rusti- application terminated with error code 101
[20:04:54] <mindcat> rusti: return
[20:04:54] -rusti- pastebinned 8 lines of output: http://sprunge.us/FOQX
[20:05:03] *** Joins: mpiechotka (mpiechotka@moz-4F93BBB9.dynamic.mnet-online.de)
[20:05:09] <mcpherrin> mindcat: mind playing with rusti in a PM?
[20:05:15] <mcpherrin> thanks :)
[20:05:33] <strcat> mcpherrin: websockets make me sad
[20:05:34] <mindcat> mcpherrin: what?
[20:05:45] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[20:05:54] <mcpherrin> mindcat: you can /msg rusti so the rest of us don't have to watch :)
[20:06:01] <strcat> mcpherrin: it claims to be a message-based protocol but it's really not :(
[20:06:11] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[20:06:19] *** Quits: hoverbear (hoverbear@EBFA78B5.F19E5E7B.E74D50F2.IP) (Quit: Taking a nap.)
[20:06:35] <strcat> and it does a bunch of weird stuff to continue working despite it pretending to be http
[20:06:44] <mindcat> mcpherrin: no, I not gonna play rusti
[20:06:55] <mcpherrin> Can you do peer to peer connections in javascript yet?
[20:06:59] <mcpherrin> through webrtc or something?
[20:07:06] <Ms2ger> mcpherrin, PeerConnection?
[20:07:10] <strcat> + websockets started out using null-terminated strings
[20:07:12] <Ms2ger> strcat, ah, legacy
[20:07:16] <paupau> can I have a heterogeneous rust list without using Any?
[20:07:24] <paupau> mcpherrin: hihi
[20:07:25] <strcat> to actually send all text/binary, you need to ask for 'binary'
[20:07:32] <strcat> Ms2ger: yeah, but it's a new standard
[20:07:46] <strcat> meh. ;p
[20:07:51] <mcpherrin> paupau: oh hi
[20:07:58] <Ms2ger> strcat, still, legacy constraints
[20:08:09] <strcat> Ms2ger: apparently they did the http handshake part because they expected web servers to serve both http and websockets
[20:08:14] <strcat> which is... not the case and not going to be the case
[20:08:25] <mcpherrin> Ms2ger: looks shiny.  I kinda want to implement BGP or BATMAN or something so you can have a shiny peer to peer something based on that I guess
[20:08:26] <mindcat> oh, it is not possible to make...
[20:08:28] <strcat> Ms2ger: and then since they pretended to be http, they had to work around http proxies
[20:08:36] <Ms2ger> Anyway
[20:08:40] <Ms2ger> Ship has sailed
[20:08:43] <strcat> and there's no excuse for null-terminated strings!
[20:09:00] *** Quits: mgottschlag (quassel@moz-DF7A2B6A.cust.bluewin.ch) (Ping timeout)
[20:09:08] <strcat> Ms2ger: guess so, it'll just be replaced by another real message-based protocol down the road ;p
[20:09:19] <bvssvni> mindcat: does /msg rusti prints out to you personally?
[20:09:35] <Ms2ger> strcat, that's not a bet I'd make
[20:09:42] *** Joins: jlong (jlong@moz-6DFDE846.socal.res.rr.com)
[20:09:49] *** Quits: Jemaclus (Jemaclus@4EEAB704.5843BA5A.D4E4C7A5.IP) (Client exited)
[20:09:51] *** Quits: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP) (Ping timeout)
[20:09:55] <mindcat> rusti: #[inline] let fib : |uint| = |x| {if x < 2 { 1 } else {fib(x - 2) - fib(x - 1)} };fib(5)
[20:09:55] -rusti- <anon>:10:17: 10:18 error: expected item after attributes
[20:09:55] -rusti- <anon>:10         #[inline] let fib : |uint| = |x| {if x < 2 { 1 } else {fib(x - 2) - fib(x - 1)} };fib(5)
[20:09:55] -rusti-                           ^
[20:09:55] -rusti- error: aborting due to previous error
[20:09:55] -rusti- application terminated with error code 101
[20:09:57] *** Joins: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za)
[20:10:08] <mindcat> bvssvni: I mean this ^
[20:10:12] <strcat> Ms2ger: webrtc looks ridiculously sane, clearly mozilla/google can make a working standard together
[20:10:23] <strcat> ;)
[20:10:34] *** Quits: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: azita)
[20:10:38] <bvssvni> mindcat: rusti runs inside an expression, so I don't think one can use annotations
[20:10:42] *** Joins: mgottschlag (quassel@moz-DF7A2B6A.cust.bluewin.ch)
[20:10:54] <Ms2ger> strcat, well, Google can dump a massive, riddled-with-bugs C codebase and get it pushed into browsers, yes :/
[20:11:07] <strcat> Ms2ger: as in webrtc?
[20:11:07] *** Joins: ecr (chatzilla@moz-6B73682D.dhcp4.washington.edu)
[20:11:10] * strcat shrugs
[20:11:18] <mindcat> rusti: inline let fib : |uint| = |x| {if x < 2 { 1 } else {fib(x - 2) - fib(x - 1)} };fib(5)
[20:11:18] -rusti- <anon>:10:16: 10:19 error: expected one of `;`, `}` but found `let`
[20:11:18] -rusti- <anon>:10         inline let fib : |uint| = |x| {if x < 2 { 1 } else {fib(x - 2) - fib(x - 1)} };fib(5)
[20:11:18] -rusti-                          ^~~
[20:11:18] -rusti- application terminated with error code 101
[20:11:30] <mindcat> doesn't work
[20:11:31] <Ms2ger> strcat, yes
[20:11:49] *** Quits: nrc (nrc@F16146EB.9D3722BB.58DC3EE6.IP) (Ping timeout)
[20:12:07] <strcat> Ms2ger: oh well, better than google talkplugin / skype / facetime
[20:12:10] <Ms2ger> http://www.webrtc.org/webrtc-native-code-package
[20:12:39] <bvssvni> mindcat: remove 'inline' and declare a fib function
[20:12:46] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Client exited)
[20:12:48] <strcat> Ms2ger: is it really particularly buggy?
[20:12:55] <strcat> like, more so than other C libraries
[20:12:58] <strcat> ;p
[20:13:08] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[20:13:12] <strcat> (*cough* ffmpeg/gstreamer)
[20:13:21] <bvssvni> mindcat: try write '/msg rusti 2+2', I want to check if I see the output
[20:13:40] <strcat> bvssvni: you won'
[20:13:42] <strcat> t
[20:13:47] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[20:13:48] <mindcat> bvssvni: if this function is visible only a function?
[20:13:52] <strcat> rusti responds on the channel you message it on
[20:14:04] <strcat> if you send a private message, it sends back a private message
[20:14:05] <bvssvni> strcat: ok, thanks
[20:14:12] <strcat> it's not just in one channel either
[20:14:26] <arielb1> a few weeks ago it wasn't this way
[20:14:41] <bvssvni> mindcat: not visible
[20:14:48] *** Quits: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net) (Ping timeout)
[20:14:55] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[20:15:10] <mindcat> bvssvni: well, I mean...
[20:15:33] <mindcat> https://gist.github.com/mindcat/9375665
[20:15:37] <kimundi> bvssvni: function definitions are mutually recursively visible. But closure constructors are values, which inherently are not.
[20:16:11] <bvssvni> kimundi: was talking about rusti
[20:16:24] *** Quits: fabiand (fabiand@moz-E905B6C.adsl.alicedsl.de) (Client exited)
[20:16:25] <kimundi> So fn rec() { rec() } works, while let rec = || rec(); does not because the latter expects a name "rec" is scope before the local variable definition
[20:16:30] *** Quits: marianoguerra (marianogue@moz-70A170F.hsi8.kabel-badenwuerttemberg.de) (Ping timeout)
[20:16:59] <kimundi> er, mindcat ^
[20:16:59] <paupau> Is there any way to do heterogeneous lists? basically ~[Slot<Any>] where: struct Slot<T> { val: ~T } ?
[20:17:02] <bvssvni> kimundi: I know, was talking about the rusti output channel
[20:17:09] <strcat> paupau: yes, use an enum
[20:17:11] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:17:27] <strcat> or a trait object, or Any, but use an enum if you know the types in advance
[20:17:34] *** Quits: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP) (Connection reset by peer)
[20:17:36] <paupau> I don't know them in advance, yeah.
[20:18:20] <paupau> my slot struct actually looks like: struct Slot { key: &'static TypeDescriptorThing<T>, value: ~T }
[20:18:37] <paupau> there's no way to conceal the T without HKT or existential types or something right?
[20:18:59] *** Joins: TimAbraldes (quassel@moz-BF4D134B.hsd1.or.comcast.net)
[20:19:20] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[20:19:27] *** Joins: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com)
[20:19:38] <aatch> paupau, you might be able to use one of the marker fields.
[20:19:50] <aatch> marker types*
[20:20:05] <paupau> aatch: oh cool!
[20:20:11] <aatch> ... actually, no.
[20:20:43] <mindcat> kimundi: then first egg or chicken?
[20:20:43] <aatch> Since you'd need it to be completely variant.
[20:20:51] <paupau> Guess I should just &Any it. maybe a little unsafe magic.
[20:21:08] *** Quits: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com) (Ping timeout)
[20:21:08] <aatch> and we only have invariant, covariant and contravariant
[20:21:42] <paupau> hmm I'll have to read up on that
[20:22:00] *** Quits: Kynes (Kynes@moz-3DC6C6E7.mit.edu) (Quit: Leaving)
[20:22:15] <kimundi> mindcat: You can see it as static definitions all existing at the same time, while local variables exists sequentially according to the program flow
[20:22:44] <kimundi> rusti: let a = 5u; let a = a; let a = a; let a = a; a
[20:22:45] -rusti- 5u
[20:22:52] <aatch> it's more for types that have a parameter but don't use it in the definition.
[20:22:58] <kimundi> 4 'a' variables existing after each other
[20:23:22] <paupau> "let a = a" flashbacks of nonhalting haskell programs...
[20:23:27] <strcat> Ms2ger: what browsers really need is GPG integration ;P
[20:23:39] <strcat> it's too bad gpgme is under a braindead license
[20:23:43] <Ms2ger> PGP? :)
[20:23:46] <mindcat> rusti: fn LOOP(){LOOP()};LOOP()
[20:23:46] -rusti- task '<main>' has overflowed its stack
[20:23:46] -rusti- application terminated abnormally with signal 4 (Illegal instruction)
[20:23:57] <aatch> kimundi, no the best example, since uint is copyable.
[20:24:00] *** Joins: hacker_sam (hacker_sam@C0FE520A.661C02A7.B0CE379A.IP)
[20:24:00] *** Quits: edwardw (edwardw@4112974A.B4358688.30F15291.IP) (Quit: Leaving...)
[20:24:00] <aatch> not*
[20:24:04] <mindcat> kimundi: it equal to ^ ?
[20:24:13] <aatch> rusti: let a = ~5u; let a = a; let a = a; let a = a; a
[20:24:14] -rusti- ~5u
[20:24:19] *** Quits: sk (sk@61A494B3.BA40E8A.AAC02D62.IP) (Ping timeout)
[20:24:19] <strcat> Ms2ger: yeah, but I do mean gpg specifically, because it's really the only good open-source implementation + you need the tooling it comes with
[20:25:01] *** Quits: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:25:03] *** Joins: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca)
[20:25:07] <kimundi> mindcat: what do you mean? 
[20:25:08] <strcat> Ms2ger: ridiculous to have a library like that under GPL though
[20:25:15] <strcat> :(
[20:25:20] <strcat> not even LGPL
[20:25:35] <strcat> if you ever wonder why hardly anything supports signing/encryption - it's crap like that.
[20:25:37] *** Joins: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com)
[20:25:39] <Ms2ger> I'm not going to say anything about GPL
[20:25:53] *** Quits: Anupkumar (uid16774@moz-A42E5B7B.irccloud.com) (Quit: Connection closed for inactivity)
[20:25:57] <strcat> GPL is fine for an application, but a *library*?
[20:26:09] <mindcat> kimundi: or I don't know what exist you mean
[20:26:12] <kimundi> mindcat: "rusti: fn LOOP(){LOOP()};LOOP()" can be seen equivalent to "rusti: fn LOOP(){ LOOP(); } fn main() { LOOP(); }"
[20:26:15] <strcat> especially when it's pretty much the only sane way for people to be securing their emails
[20:26:29] <kimundi> mindcat: local variables
[20:26:44] <mindcat> rusti: fn LOOP(){LOOP()};LOOP(
[20:26:45] -rusti- pastebinned 7 lines of output: http://sprunge.us/PEPB
[20:26:51] <mindcat> rusti: main()
[20:26:51] -rusti- task '<main>' has overflowed its stack
[20:26:52] -rusti- application terminated abnormally with signal 4 (Illegal instruction)
[20:27:17] <kimundi> rusti: let a = 5; println!("{}", a);
[20:27:18] -rusti- 5
[20:27:18] -rusti- ()
[20:27:22] *** Joins: AndyB (andyb@5EA08F51.9875BCA6.DDE5D3F6.IP)
[20:27:26] <kimundi> rusti: println!("{}", a); let a = 5;
[20:27:26] -rusti- pastebinned 9 lines of output: http://sprunge.us/MJTD
[20:27:43] <strcat> rusti: use std::iter::count; let mut xs = Vec::new(); for x in count(0, 1) { xs.push(x) }
[20:27:43] -rusti- pastebinned 11 lines of output: http://sprunge.us/aWEV
[20:27:44] <kimundi> mindcat: ^^I mean that - variables need to be declared before they are used
[20:27:56] <strcat> rusti: use std::iter::count; let mut xs = std::vec_ng::Vec::new(); for x in count(0, 1) { xs.push(x) }
[20:28:02] -rusti- timeout triggered!
[20:28:15] <kimundi> mindcat: But static items, like function definition can go in either order
[20:28:21] <AndyB> Okay, I have a really stupid question. If I have an owned pointer, how do I access it in a loop? i.e. I created a BufferedReader and want to read from it in a loop, but the compiler says 'cannot borrow `bf` as mutable more than once at a time'
[20:28:30] <mindcat> kimundi: ok...
[20:28:40] <kimundi> rusti: fn foo() { println!("{}", 5) } fn bar() { foo(); } bar();
[20:28:40] -rusti- 5
[20:28:41] -rusti- ()
[20:28:49] <kimundi> rusti: fn bar() { foo(); } fn foo() { println!("{}", 5) } bar();
[20:28:49] -rusti- 5
[20:28:50] -rusti- ()
[20:28:52] <kimundi> both is valid
[20:28:55] *** Quits: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP) (Quit: dave1629)
[20:29:00] * strcat is glad rusti can be up-to-date now
[20:29:16] <mindcat> kimundi: then local variables not?
[20:29:27] <Ms2ger> Wasn't rust_begin_unwind the thing to break on?
[20:29:50] <mindcat> kimundi: I see that what did you mean
[20:30:02] <kimundi> mindcat: local variables are not, because they are causally connected - a function execution starts at the top, and proceeds to the button
[20:30:07] <Luqman> Ms2ger: rust_fail
[20:30:22] <Ms2ger> Thank you, kind stranger
[20:30:24] <kimundi> botton*
[20:30:41] <mindcat> kimundi: and stackoverflow :D
[20:30:41] <Ms2ger> bottom?
[20:30:54] <kimundi> Ms2ger: eh, whatever :P
[20:31:03] *** Quits: paupau (posttext@moz-377BE2CD.hsd1.ca.comcast.net) (Ping timeout)
[20:31:30] <Ms2ger> :)
[20:31:41] <mindcat> kimundi: what different for global variables?
[20:32:34] <mindcat> kimundi: or global functions
[20:32:41] *** Joins: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP)
[20:32:53] <mindcat> local or global, what matter.
[20:32:59] <kimundi> mindcat: Rusts global variables (which are called "statics") are just as mutualy recursive as function definitions - all items are.
[20:33:25] <kimundi> rusti: static X: uint = 1; static Y: uint = X + 10; Y
[20:33:26] -rusti- 11u
[20:33:32] *** Joins: paupau (posttext@moz-377BE2CD.hsd1.ca.comcast.net)
[20:33:34] <kimundi> rusti: static Y: uint = X + 10; static X: uint = 1; Y
[20:33:35] -rusti- 11u
[20:33:45] <kimundi> because they are also fixed at compile time
[20:34:11] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[20:34:12] *** Quits: cceckman (cceckman@moz-135DFDD5.bootp.virginia.edu) (Client exited)
[20:34:17] *** Joins: cceckman (cceckman@moz-135DFDD5.bootp.virginia.edu)
[20:34:29] <kimundi> mindcat: the important thing here is that "static ..." and "fn ..." are nothing special inside a function, they are exactly the same as outside of one
[20:35:17] <kimundi> rusti: mod foo { static Y: uint = X + 10; static X: uint = 1; fn bar() { println!("{}", Y); } } foo::bar();
[20:35:19] -rusti- <anon>:10:98: 10:106 error: function `bar` is private
[20:35:19] -rusti- <anon>:10         mod foo { static Y: uint = X + 10; static X: uint = 1; fn bar() { println!("{}", Y); } } foo::bar();
[20:35:19] -rusti-                                                                                                            ^~~~~~~~
[20:35:19] -rusti- error: aborting due to previous error
[20:35:19] -rusti- application terminated with error code 101
[20:35:26] <mindcat> rusti fn l() -> uint { static x : |uint| { if x > 10 { return x } else { x += 1 } } }; l()
[20:35:27] <kimundi> rusti: mod foo { static Y: uint = X + 10; static X: uint = 1; pub fn bar() { println!("{}", Y); } } foo::bar();
[20:35:28] -rusti- 11
[20:35:28] -rusti- ()
[20:35:46] *** Quits: zimbatm (zimbatm@moz-D4F596B.cable.virginm.net) (Connection reset by peer)
[20:36:01] <mindcat> rusti fn l() -> uint { static x : |uint| { if x > 10 { return x } else { x += 1 } } }; l()
[20:36:07] <kimundi> need the ":"
[20:36:15] <mindcat> rusti: fn l() -> uint { static x : |uint| { if x > 10 { return x } else { x += 1 } } }; l()
[20:36:15] -rusti- <anon>:10:44: 10:45 error: expected `=` but found `{`
[20:36:16] -rusti- <anon>:10         fn l() -> uint { static x : |uint| { if x > 10 { return x } else { x += 1 } } }; l()
[20:36:16] -rusti-                                                      ^
[20:36:16] -rusti- application terminated with error code 101
[20:36:22] *** Joins: zimbatm (zimbatm@moz-D4F596B.cable.virginm.net)
[20:36:27] <mindcat> rusti: fn l() -> uint { static x : |uint| = { if x > 10 { return x } else { x += 1 } } }; l()
[20:36:28] -rusti- <anon>:10:89: 10:90 error: expected `;` but found `}`
[20:36:28] -rusti- <anon>:10         fn l() -> uint { static x : |uint| = { if x > 10 { return x } else { x += 1 } } }; l()
[20:36:28] -rusti-                                                                                                   ^
[20:36:28] -rusti- application terminated with error code 101
[20:36:34] <mindcat> rusti: fn l() -> uint { static x : |uint| = { if x > 10 { return x } else { x += 1 } }; }; l()
[20:36:35] -rusti- <anon>:10:37: 10:43 error: missing lifetime specifier
[20:36:36] -rusti- <anon>:10         fn l() -> uint { static x : |uint| = { if x > 10 { return x } else { x += 1 } }; }; l()
[20:36:36] -rusti-                                               ^~~~~~
[20:36:36] -rusti- error: aborting due to previous error
[20:36:36] -rusti- application terminated with error code 101
[20:36:36] -concrete.mozilla.org- *** Channel msg/noticeflood detected (limit is 10 per 10 seconds), setting mode +M
[20:36:36] *** concrete.mozilla.org sets mode: +M 
[20:36:45] <mindcat> ohh
[20:36:47] *** Joins: askalski (akuda@2BA4E5A7.CC7751E8.6712E96B.IP)
[20:37:20] <mindcat> rusti: fn l() -> ~uint { static x : |~uint| = { if x > 10 { return x } else { x += 1 } }; }; l()
[20:37:20] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[20:37:20] -rusti- <anon>:10:38: 10:45 error: missing lifetime specifier
[20:37:20] -rusti- <anon>:10         fn l() -> ~uint { static x : |~uint| = { if x > 10 { return x } else { x += 1 } }; }; l()
[20:37:20] -rusti-                                                ^~~~~~~
[20:37:20] -rusti- error: aborting due to previous error
[20:37:21] -rusti- application terminated with error code 101
[20:38:01] <mindcat> rusti: fn l() -> uint { static x : |&uint| = { if x > 10 { return x } else { x += 1 } }; }; l()
[20:38:02] -rusti- <anon>:10:37: 10:44 error: missing lifetime specifier
[20:38:02] -rusti- <anon>:10         fn l() -> uint { static x : |&uint| = { if x > 10 { return x } else { x += 1 } }; }; l()
[20:38:02] -rusti-                                               ^~~~~~~
[20:38:02] -rusti- error: aborting due to previous error
[20:38:03] -rusti- application terminated with error code 101
[20:38:43] <mindcat> I don't want to try now :S
[20:39:07] *** Joins: sigma (sigma@C91C7F36.70518F41.9D18269F.IP)
[20:39:09] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[20:39:49] <paupau> pointer comparison, how do I?
[20:39:54] <paupau> transmute to void*
[20:39:55] <paupau> ?
[20:40:03] <o11c> /msg rusti, please ...
[20:40:30] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Quit: Leaving...)
[20:40:31] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[20:41:40] *** concrete.mozilla.org sets mode: -M 
[20:41:46] <bvssvni> paupau: as uint, then =
[20:42:22] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:42:29] *** Joins: marianoguerra (marianogue@moz-70A170F.hsi8.kabel-badenwuerttemberg.de)
[20:42:35] *** Joins: [squiddy] (squiddy@moz-767EF079.dynamic.cablesurf.de)
[20:42:45] *** Quits: lunaryorn (lunaryorn@moz-3052D772.dynamic.mnet-online.de) (Quit: )
[20:42:50] <paupau> okay, thanks
[20:43:35] *** Joins: matp (matp@moz-16FE1E05.matp.at)
[20:43:56] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:44:15] <mindcat> rusti: let table : ~[uint] = std::iter::count(2,n + 2).to_owned_vec();
[20:44:15] -rusti- <anon>:10:50: 10:51 error: unresolved name `n`.
[20:44:15] -rusti- <anon>:10         let table : ~[uint] = std::iter::count(2,n + 2).to_owned_vec();
[20:44:15] -rusti-                                                            ^
[20:44:15] -rusti- error: aborting due to previous error
[20:44:16] -rusti- application terminated with error code 101
[20:44:21] <mindcat> rusti: let table : ~[uint] = std::iter::count(2,10 + 2).to_owned_vec();
[20:44:22] -rusti- <anon>:10:31: 10:72 error: mismatched types: expected `~[uint]` but found `~[int]` (expected uint but found int)
[20:44:22] -rusti- <anon>:10         let table : ~[uint] = std::iter::count(2,10 + 2).to_owned_vec();
[20:44:22] -rusti-                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[20:44:25] -rusti- error: aborting due to previous error
[20:44:27] -rusti- application terminated with error code 101
[20:44:36] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Input/output error)
[20:45:11] <mindcat> rusti: version
[20:45:12] -rusti- "rustc 0.10-pre (fbe26af 2014-03-02 17:36:28 -0800)"
[20:45:16] *** Joins: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP)
[20:45:22] *** Quits: jackneill (jackneill@moz-AF0277B.pool.digikabel.hu) (Ping timeout)
[20:45:23] <mindcat> oh no, update again
[20:45:38] <sfackler> mindcat: seriously, /msg rusti
[20:45:42] <kmc> mindcat: you can talk to rusti in private message; you don't need to spam the channel
[20:46:20] *** Quits: olivernn (olivernigh@moz-7CE0F8.access.mtnbusiness.co.za) (Ping timeout)
[20:46:29] <mindcat> after I will do it, thanks
[20:47:16] *** Quits: Ferreus (ferreus@moz-D32BC6B4.lsn.wtnet.de) (Quit: WeeChat 0.4.4-dev)
[20:47:24] *** Quits: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it) (Quit: Leaving.)
[20:49:11] *** Joins: davidkrauser (dkrauser@moz-F53923FE.tunnelr.com)
[20:52:50] *** Quits: silven (quassel@moz-F81D3961.a328.priv.bahnhof.se) (Client exited)
[20:53:12] <dnyy> probably a dumb question, since I know nothing low level languages. but how could i implement a trait on strings, since there's no bare str type? i got 2.do_things() to work fine, but stuck on how to do it on strings.
[20:53:18] *** Parts: davidkrauser (dkrauser@moz-F53923FE.tunnelr.com) ()
[20:53:37] <bvssvni> dnyy: you can do it for ~str
[20:54:04] <eddyb> or &str
[20:54:26] <eddyb> dnyy: with DST, there will be a bare str type that you can impl traits on
[20:54:52] *** Quits: blindrenderer (blindrende@AFFD8E17.329A1D83.D01D599A.IP) (Ping timeout)
[20:54:57] <bvssvni> eddyb: how long before DST comes?
[20:55:14] <kmc> dnyy: you probably want to implement it for &str if you can, because you can get a &str from a ~str but not the other way around (unless you copy)
[20:55:35] *** Quits: geoffhill (geoffhill@moz-95FF7399.members.linode.com) (Quit: )
[20:56:05] <eddyb> bvssvni: DST comes when DST wants
[20:56:31] <bvssvni> eddyb: is it coming to 1.0?
[20:56:40] <eddyb> we're talking next few weeks
[20:56:46] <bvssvni> :O
[20:56:54] <bvssvni> cool!
[20:57:21] <eddyb> would be faster if I could get things done and if nmatsakis wasn't so busy with... well, I think he's too busy with DST plans to review related PRs =))
[20:57:40] <eddyb> help is welcome
[20:57:45] *** Quits: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl) (Quit: Computer gone to sleep - Zzzz...)
[20:57:48] * kmc wonders what operations will be supported on bare str
[20:58:14] <eddyb> kmc: &self on str is &str, as today
[20:58:15] <kmc> it seems like &str is still a lot more useful, because it can be a slice within a larger string
[20:58:22] <eddyb> ~self is ~str etc.
[20:58:22] <kmc> ok
[20:58:42] *** Quits: marianoguerra (marianogue@moz-70A170F.hsi8.kabel-badenwuerttemberg.de) (Ping timeout)
[20:58:43] *** Joins: doy (doy@moz-8F23663C.net)
[20:58:48] <kmc> so the big win is instantiating generic code with T = str?
[20:58:59] <eddyb> Rc<str>
[20:59:05] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[20:59:17] <eddyb> CowArc<str> is C++'s std::string as far as I've heard
[20:59:50] *** Joins: nrc (nrc@F16146EB.9D3722BB.58DC3EE6.IP)
[21:00:10] <kmc> I thought COW fell out of favor for std::string
[21:00:25] <strcat> kmc: it's banned by C++11
[21:00:45] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[21:00:47] <eddyb> ohh? why?
[21:00:53] <eddyb> I thought it was useful, somehow
[21:01:04] <kmc> eddyb: how will Rc<str> work, though?  Rc<T> allocates an RcBox<T> { value: T, count: uint } but that will itself be a DST so how is the allocation allowed?
[21:01:14] <strcat> eddyb: perhaps it's useful on enormous strings
[21:01:19] <strcat> atomic refcounting isn't cheap
[21:01:26] <eddyb> mkay
[21:01:32] <strcat> and the indirection it introduces isn't cheap either
[21:01:45] <strcat> also it doesn't work very well
[21:01:46] <eddyb> kmc: nmatsakis is thinking of using str/N for static strings
[21:01:48] <kmc> I'm surprised that the C++11 standard even makes implementation demands like that
[21:01:54] *** Joins: carllerche (carllerche@moz-2B516F15.hsd1.or.comcast.net)
[21:01:54] *** Joins: Jemaclus (Jemaclus@4EEAB704.5843BA5A.D4E4C7A5.IP)
[21:01:55] <eddyb> I'd say &'static str/N is best for constants
[21:02:02] <eddyb> or add auto-ref to everything
[21:02:02] <strcat> kmc: C++98 has all kinds of demands like that too
[21:02:08] <strcat> there are time complexity requirements, etc.
[21:02:10] <eddyb> otherwise you'll write &"foo" all the damn time
[21:02:13] <botond> eddyb: kmc: they're not exactly implementation demands
[21:02:18] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:02:23] <eddyb> kmc: something like Rc::new(*"foo") could work
[21:02:27] <botond> rather, the standard specifies what operations are allowed to invalidate iterators
[21:02:27] <kmc> time complexity seems different
[21:02:27] <strcat> kmc: for example, std::map pretty much has to be an rbtree
[21:02:32] *** Joins: geoffhill (geoffhill@moz-95FF7399.members.linode.com)
[21:02:45] <botond> C++11 says that e.g. non-const operator[] is not allowed to invalidate iterators
[21:02:54] <eddyb> kmc: I want let x: Rc<str> = box "foo"; to work nonetheless, and that can be implementer for each smart pointer with the current &'static str
[21:02:57] <botond> this means non-const operator[] cannot copy/reallocate the string
[21:02:58] <kmc> botond: ah, I see
[21:03:06] <botond> and therefore it cannot be COW
[21:03:09] <strcat> kmc: with std::map, insert can't invalidate any iterators and delete can only invalidate an iterator pointing at the deleted element
[21:03:14] <strcat> kmc: so you basically have to have node per element
[21:03:18] <strcat> can't use a b-tree
[21:03:34] <strcat> they have lots of requirements like that causing implementations to be very similar
[21:03:36] <eddyb> sounds awful
[21:03:41] <strcat> it's not awful
[21:03:50] <zwarich> unordered_map isn't any better really :(
[21:04:00] <strcat> unordered_map pretty much requires that you use chaining
[21:04:06] <eddyb> restrictions like one node per element just because there aren't borrow semantics in the language
[21:04:15] <strcat> eddyb: no, that's not why
[21:04:26] <eddyb> strcat: isn't it how we avoid invalidating iterators?
[21:04:31] <strcat> the iterator invalidation rules are there because they're useful
[21:04:31] <kmc> eddyb: will this function Just Work with T = str?  pub unsafe fn new_unchecked(value: T) -> Rc<T> { Rc{ptr: transmute(~RcBox{value: value, count: 1})} }
[21:04:31] *** Quits: askalski (akuda@2BA4E5A7.CC7751E8.6712E96B.IP) (Quit: Wychodzi)
[21:04:43] <strcat> eddyb: I think you're missing the point.
[21:04:52] <strcat> it's useful to be able to modify a container as you're iterating over it
[21:04:56] <eddyb> strcat: not really, just comparing everything to Rust
[21:04:58] *** Quits: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net) (Ping timeout)
[21:05:01] <strcat> without the guarantee, code would be less efficient
[21:05:14] <eddyb> kmc: it would work with T = str/N
[21:05:17] *** Joins: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net)
[21:05:22] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[21:05:24] <strcat> eddyb: rust doesn't let you write code to that level of efficiency without unsafe {}
[21:05:28] <o11c> strcat: honestly, I think the best way of thinking about that bit is how databases do it
[21:05:32] <paupau> Is there any way to write to a mut newtype-style tuple-struct?
[21:05:52] <kmc> eddyb: where N is a size, part of the static type of the string?
[21:05:57] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[21:05:59] *** Joins: jvoorhis (jvoorhis@moz-C34F9C32.hfc.comcastbusiness.net)
[21:06:00] <eddyb> kmc: yupp
[21:06:14] <eddyb> paupau: pattern-matching
[21:06:16] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[21:06:18] <eddyb> paupau: with ref mut inside
[21:06:25] <paupau> eddyb: ahh makes sense
[21:06:28] <paupau> thanks
[21:06:29] <o11c> databases say, roughly "at any point while you're iterating, you don't know exactly how many elements there are"
[21:06:37] <kmc> eddyb: ok, but that means i can't dynamically create a string of statically-unknown size and then put it inside Rc<str> (even by copy)
[21:06:43] <strcat> o11c: that's not the invalidation issue though
[21:06:47] <o11c> in other words: you need to preserve iterators-from-iterating
[21:07:04] <o11c> but possibly you could break other stuff
[21:07:13] <eddyb> kmc: right, that's why I kinda want boxing a &str to SmartPtr<str> to work in general
[21:07:22] *** Quits: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[21:07:23] <kmc> ok
[21:07:24] *** Joins: lawrence (lawrence@moz-D2AE8C65.chestnutresnet.utoronto.ca)
[21:07:25] <eddyb> kmc: it's not easier with vectors either
[21:07:29] <kmc> not sure how to implement that
[21:07:42] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[21:07:56] <strcat> they make the guarantees because it allows you to mutate it without abandoning your iteration state
[21:07:59] *** Quits: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net) (Ping timeout)
[21:08:00] <kmc> seems like this also makes Rc<Trait> useless
[21:08:04] <strcat> rust could make similar guarantees for unsafe code
[21:08:13] <strcat> we already rely on guarantees like this
[21:08:17] <strcat> they're just unstated
[21:08:20] <kmc> or (relevant to my interests) DList<Trait>
[21:08:45] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[21:09:00] *** Joins: tikue (tkuehn@CB7FC854.FAD414BA.D74CC41D.IP)
[21:09:00] <eddyb> kmc: you implement it with memcpy, usually
[21:09:05] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Input/output error)
[21:09:31] <eddyb> kmc: but it works fine with static sizes and T -> Trait
[21:09:38] <eddyb> Rc<T> coerces to Rc<Trait> under DST
[21:09:51] *** Quits: dranov (dranov@moz-94025FE6.residential.rdsnet.ro) (Ping timeout)
[21:09:54] <eddyb> even Rc<RefCell<T>> -> Rc<RefCell<Trait>>
[21:10:11] <kmc> what do you mean?
[21:10:23] <eddyb> DSTs are produced by pointer coercions
[21:10:33] <aatch> kmc: http://smallcultfollowing.com/babysteps/blog/2014/01/05/dst-take-5/
[21:10:36] <eddyb> including smart pointers
[21:10:39] * kmc reads
[21:10:50] <aatch> (I happened to already have it open...)
[21:11:25] *** Quits: ecr (chatzilla@moz-6B73682D.dhcp4.washington.edu) (Ping timeout)
[21:11:54] <paupau> what does <T: 'static> mean? T must be known at compile time?
[21:12:08] <aatch> paupau, that it has to have a static lifetime.
[21:12:16] <aatch> Don't normally see it like that though.
[21:12:18] <kmc> paupau: it means T can't contain any refs that aren't &'static
[21:12:21] <kmc> iirc
[21:12:29] <kmc> (it's always the case with generics that T is known at compile time)
[21:12:38] <paupau> okay
[21:12:50] *** Joins: Houm (Houm@moz-25669AA8.fbx.proxad.net)
[21:13:09] <arielb1> does rust still use segmented stacks?
[21:13:28] <kmc> arielb1: they don't grow but the checks are still in, in order to detect stack overflow (some of the time)
[21:13:47] <arielb1> why is stack overflow only detected some of the time?
[21:13:52] <strcat> it detects stack overflow if it occurs in rust, but it can and does often occur in C code called by rust
[21:14:01] <arielb1> can't you catch SIGSEGV?
[21:14:25] <strcat> arielb1: there's no guarantee that you get SIGSEGV on stack overflow without instrumenting the code.
[21:14:26] <kmc> arielb1: that's like catching dangling pointers or use-after-free with SIGSEGV
[21:14:30] <bvssvni> what is happening here? https://gist.github.com/bvssvni/9376726
[21:14:41] <arielb1> don't you only need a guard page?
[21:14:42] <kmc> it works when you get lucky, but in general the result is arbitrary (or attacker-controlled) memory corruption
[21:14:42] *** Quits: tikue (tkuehn@CB7FC854.FAD414BA.D74CC41D.IP) (Quit: tikue)
[21:14:53] <arielb1> and access %rsp after decrementing it
[21:14:55] <arielb1> once per page
[21:15:10] <arielb1> you even get the exception in good positions
[21:15:16] <strcat> arielb1: gcc has -fcheck-stack to do that, but most code isn't compiled with it
[21:15:21] <strcat> arielb1: LLVM doesn't support it.
[21:15:25] <kmc> arielb1: we have to be ABI compatible
[21:15:30] *** Quits: [squiddy] (squiddy@moz-767EF079.dynamic.cablesurf.de) (Quit: Leaving)
[21:15:33] <strcat> arielb1: you also can't throw an exception
[21:15:42] *** Joins: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net)
[21:15:43] <kmc> 1 guard page isn't enough because the C function's stack frame could be larger
[21:15:45] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[21:15:49] <strcat> kmc: with -fcheck-stack it is
[21:15:50] <arielb1> doesn't C check
[21:15:53] <strcat> arielb1: no
[21:15:54] <arielb1> every page?
[21:15:56] <kmc> strcat: right
[21:15:56] <strcat> arielb1: no
[21:16:02] <eddyb> arielb1: just alloca
[21:16:04] <arielb1> thats only a problem if you use vla
[21:16:08] <strcat> arielb1: no
[21:16:10] *** Quits: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net) (Ping timeout)
[21:16:14] <arielb1> or a very massive function
[21:16:19] <strcat> which exist
[21:16:19] <eddyb> haha no it's the other way around
[21:16:22] <kmc> C is the supreme champion of undefined behavior, it definitely does not require catching stack overflow :)
[21:16:23] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[21:16:28] <arielb1> you need a really big function to use more then 4k stack
[21:16:30] <arielb1> without vla
[21:16:32] *** Joins: Guest__ (textual@moz-310FD28A.dynamic.caiway.nl)
[21:16:41] <eddyb> VLA can use alloca which is designed to probe the space to bring it into existence
[21:16:46] <kmc> arielb1: void foo() { char buf[8192]; }
[21:16:51] <strcat> kmc: I don't think it talks about stacks at all
[21:16:52] <eddyb> arielb1: recursion
[21:17:03] <kmc> arielb1: of course this is bad code but we can't just assume bad code doesn't exist...
[21:17:05] <strcat> kmc: I think it probably requires infinitely large stacks but ofc you can't really do that ;)
[21:17:12] <arielb1> with recursion you check every iteration
[21:17:14] <arielb1> in the call
[21:17:15] <aatch> the C standard does not mention stacks if I recall correctly.
[21:17:36] <strcat> arielb1: that's not enough
[21:17:39] <kmc> eddyb: fun fact, if you try to use VLA and alloca together in GCC, everything explodes
[21:17:48] <bvssvni> is this a bug in the compiler? https://gist.github.com/bvssvni/9376726
[21:18:00] <aatch> C doesn't actually have a concept of stack-allocated variables, just automatic variables.
[21:18:00] <arielb1> if every function uses less then 4k and every call is checked
[21:18:06] *** Quits: victorporof (victorporo@13F2CEC5.7672369.D8E68FF6.IP) (Quit: victorporof)
[21:18:09] <arielb1> by the cpu
[21:18:13] <arielb1> then 1 guard page is enough
[21:18:16] <strcat> arielb1: the implementation details needed to catch all stack overflows not caused by buffer overflows are known, it's what -fcheck-stack does
[21:18:27] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Client exited)
[21:18:28] <strcat> arielb1: yes but there's no guarantee functions use less than 4K
[21:18:33] <strcat> there are often huge arrays on the stack
[21:18:41] <arielb1> that's bad style
[21:18:49] <aatch> arielb1, and?
[21:18:58] <strcat> I wouldn't call it bad style to put more than 4K on the stack
[21:19:01] <kmc> arielb1: what position are you arguing for at this point?
[21:19:03] <strcat> it's very common
[21:19:34] <aatch> We don't know what's happening in C code, so pretty much anything goes at that point.
[21:19:35] <kmc> arielb1: yes, it is possible to catch all stack overflows when the C code is compiled with -fcheck-stack and/or is free of "bad style"
[21:19:41] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:19:46] <strcat> putting 65536 buffers on the stack for I/O isn't at all uncommon
[21:19:54] *** Quits: mpiechotka (mpiechotka@moz-4F93BBB9.dynamic.mnet-online.de) (Quit: mpiechotka)
[21:20:07] <kmc> arielb1: but Rust does not impose those requirements when linking to a C library so it's not relevant for us
[21:20:07] <strcat> kmc: well, -fcheck-stack catches all stack overflows caused by valid writes to variables on the stack and calls ;)
[21:20:08] *** Quits: pczarn (pczarn@moz-69A55FA.izacom.pl) (Input/output error)
[21:20:15] <strcat> and clang/LLVM don't support -fcheck-stack
[21:20:31] *** Joins: mihneadb (mihneadb@moz-6B31F5AA.static.ziggozakelijk.nl)
[21:20:44] <kmc> strcat: fair enough
[21:20:47] <arielb1> fair enough
[21:20:50] <strcat> I don't know of a linux distro using -fcheck-stack anyway
[21:21:00] <kmc> also I'm interested by the claim that alloca / VLAs do runtime checks because I know of several pieces of software that got pwned that way...
[21:21:04] <aatch> bvssvni, it's not a bug.
[21:21:09] <strcat> even security conscious ones seem to only use -fstack-protector which is to catch buffer overflows onto the stack
[21:21:15] <arielb1> why isn't it the default
[21:21:21] <strcat> arielb1: non-zero cost
[21:21:39] <strcat> and there are far easier ways to break C code
[21:21:39] <bvssvni> aatch: should not the lifetime be inferred here?
[21:21:40] <aatch> Oh wait, I'm not sure
[21:21:43] <arielb1> if you're not checking vla/alloca you have security bugs
[21:21:45] <aatch> give me a moment.
[21:21:58] *** Quits: tigrou3tac (fabien@moz-6E2397FF.fbx.proxad.net) (Ping timeout)
[21:22:01] <strcat> arielb1: this is a problem without vla/alloca
[21:22:03] <arielb1> and if a functino uses a 64k io buffer
[21:22:10] <strcat> vla/alloca are checked by -fstack-protector
[21:22:14] <arielb1> then a few cycles stack checking isn't so bad
[21:22:16] <strcat> which is enabled by most linux distros
[21:22:21] <arielb1> not by default?
[21:22:33] <arielb1> vla/alloca?
[21:23:00] <strcat> doubt it's checked by default with a vanilla gcc
[21:23:14] <arielb1> thats horribly unsafe
[21:23:16] <strcat> some distros patch their gcc to put -fstack-protector on by default
[21:23:41] <strcat> most enable it for their packages
[21:24:01] <strcat> arielb1: either way, only -fcheck-stack actually checks for overflow from large uninit blocks on the frame
[21:24:02] <kmc> horribly unsafe: the C way
[21:24:10] <strcat> and no one seems to use -fcheck-stack
[21:24:32] *** Quits: asmyers (quassel@F7FD79FB.9A737B8F.FAA4474F.IP) (Ping timeout)
[21:24:50] *** Quits: voxpopuli (fanservice@F9737B0C.D6003D29.689607DE.IP) (Ping timeout)
[21:24:57] <kmc> arielb1: also, avoiding huge things on the stack is a lot harder when they are opaque structs, or C++ nonsense expanded from N layers of templates
[21:25:18] <arielb1> opaque structs on the stacks?
[21:25:30] <arielb1> then it's not opaque
[21:25:52] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[21:26:20] <aatch> bvssvni, there might be a subtle bug there, but if I added the closure lifetime to the type of f, it works.
[21:26:34] <aatch> I think the bug *might* be that the first one works.
[21:26:42] <arielb1> why does rust use __more_stack again?
[21:26:51] <bvssvni> aatch: yeah, that is a problem because this is often left out in traits
[21:26:52] <strcat> arielb1: because LLVM doesn't support an equivalent to -fcheck-stack
[21:27:03] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:27:17] <strcat> so we still use the 'segmented stack' support although we don't use segmented stacks
[21:27:21] <arielb1> and rust can allocate big buffers on the stack
[21:27:37] <bvssvni> aatch: both should be prevented or both should work
[21:27:57] <aatch> bvssvni, I think it's the first option.
[21:28:07] <strcat> arielb1: or just large objects
[21:28:17] <arielb1> 4k objects?
[21:28:20] <bvssvni> aatch: so you think the bug is the first one that work?
[21:28:27] <aatch> bvssvni, yeah.
[21:28:28] <kmc> sure. objects can contain buffers, for example :)
[21:28:41] <strcat> arielb1: there are some pretty enormous structs in librustc
[21:29:02] <strcat> when you've included 20 levels of structs inside each other, they start getting pretty big
[21:29:07] <kmc> arielb1: and I meant opaque in the sense of programmers being expected to think about what's in it or how big it is
[21:29:28] <strcat> rust takes a pretty black and white approach to memory safety
[21:29:36] <strcat> so the stack overflow checks are a hard requirement
[21:29:39] <arielb1> of course rust should check
[21:29:51] <arielb1> so the problem is LLVM
[21:29:52] <strcat> they can be replaced with more efficient checks taking advantage of the guard page
[21:29:56] <strcat> yes
[21:29:58] <arielb1> which can't do checks efficiently
[21:30:03] <strcat> it can on windows
[21:30:04] <bvssvni> aatch: should I post an issue?
[21:30:06] <strcat> ;p
[21:30:08] <aatch> bvssvni, yeah.
[21:30:26] <strcat> although it doesn't appear to work 100% on windows
[21:30:37] <aatch> Looks like the two different examples use different inferred lifetimes for the return value.
[21:30:48] <aatch> return value type, rather
[21:31:02] <arielb1> do they plan to support it?
[21:31:51] <strcat> arielb1: they wouldn't reject a patch adding solid support for it
[21:31:51] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:31:52] *** Joins: Jesin (Jesin@moz-3A2C5D36.washdc.fios.verizon.net)
[21:31:54] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[21:32:27] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:32:42] *** Quits: arielb1 (eran@moz-E6742496.red.bezeqint.net) (Ping timeout)
[21:34:47] *** Joins: arielb1 (arielb1@moz-E6742496.red.bezeqint.net)
[21:35:06] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[21:35:08] *** Joins: Sharp (Sharp@19388942.6B775EBE.DC877F3B.IP)
[21:35:45] *** Quits: Ms2ger (Ms2ger@60B493FD.C305EAEC.F15B0BB3.IP) (Quit: nn)
[21:35:55] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[21:35:58] *** Joins: victorporof (victorporo@moz-FFB76956.cpe.net.cable.rogers.com)
[21:37:24] *** Quits: skade (skade@moz-F3F67608.pools.arcor-ip.net) (Ping timeout)
[21:37:57] *** Quits: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: azita)
[21:38:34] <mindcat> AM 05:38....
[21:38:37] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Client exited)
[21:38:44] * mindcat -> bed
[21:38:58] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[21:39:31] *** Joins: blindrenderer (blindrende@A2CE7C46.1B0BFAF2.580BDDEE.IP)
[21:39:41] *** Quits: steveklabnik (steev@B1BA5385.27F34CF7.5670445F.IP) (Ping timeout)
[21:40:01] *** Quits: blindrenderer (blindrende@A2CE7C46.1B0BFAF2.580BDDEE.IP) (Quit: Leaving)
[21:40:08] *** Quits: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP) (Quit: dave1629)
[21:40:31] *** Quits: nlminhtl (ignotus@moz-4CB8A1D.site.volia.net) (Ping timeout)
[21:41:17] * mindcat just can not get bed because he want continue do something that
[21:41:22] <bvssvni> aatch: I am not sure whether &'a || is always &'a 'a || or not
[21:41:26] *** Joins: blindrenderer (blindrende@A2CE7C46.1B0BFAF2.580BDDEE.IP)
[21:41:40] <bvssvni> aatch: https://github.com/mozilla/rust/issues/12717
[21:42:11] <mindcat> 
[21:42:14] <mindcat> :w
[21:42:15] <mindcat> :q
[21:42:17] *** Quits: mindcat (mindcat@EEFCDFAE.7EE3DE8.F956842C.IP) (Quit: leaving)
[21:43:04] *** Joins: steveklabnik (steev@B1BA5385.27F34CF7.5670445F.IP)
[21:44:43] *** Joins: claudiu_ (claudiu@moz-7D1F0258.thefacebook.com)
[21:44:43] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Connection reset by peer)
[21:45:28] *** Joins: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP)
[21:47:07] *** Joins: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[21:47:32] *** Quits: blindrenderer (blindrende@A2CE7C46.1B0BFAF2.580BDDEE.IP) (Ping timeout)
[21:48:04] *** Quits: claudiu_ (claudiu@moz-7D1F0258.thefacebook.com) (Ping timeout)
[21:48:45] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[21:48:59] *** Joins: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP)
[21:49:28] *** Joins: askalski (akuda@2BA4E5A7.CC7751E8.6712E96B.IP)
[21:51:49] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:52:06] *** Quits: evanm (evanm@636AC086.5999CED5.71743E61.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[21:52:45] *** Joins: pongad (pongad@moz-7E8AAD2E.res.gatech.edu)
[21:53:24] <pongad> huon: I want to work on removing index from str, but I don't really know where to start. Could you point me in the right direction? xD
[21:53:39] <huon> pongad: I don't know where to look
[21:54:12] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:54:17] <pongad> huon: It has compiler support right? It's not just a lib somewhere
[21:54:18] <huon> (I was actually going to work it out then do it myself... but if you're doing it that's even easier. :) )
[21:54:24] <huon> yes, compiler support
[21:54:40] <pongad> Do you know who I should ask?
[21:55:04] *** Quits: Savago (Savago@F0CE5436.E820043D.D4C04133.IP) (Quit: Savago)
[21:55:09] *** Joins: aeqwa (aeqwa@moz-F798473B.dsl.tropolys.de)
[21:55:21] *** Joins: blindrenderer (blindrende@CFA55475.329A1D83.D01D599A.IP)
[21:55:46] *** Quits: geoffhill (geoffhill@moz-95FF7399.members.linode.com) (Input/output error)
[21:55:46] <strcat> pongad: src/librustc/middle/typeck/check/mod.rs
[21:55:53] <strcat> ExprIndex
[21:56:19] *** Quits: dave1629 (dave@EDB1BDB2.9B1DA26B.DDE5D3F6.IP) (Quit: dave1629)
[21:56:33] <pongad> strcat: Thanks. I'll see what I do. This is the first time I'm working on a compiler, so please forgive rookie mistakes :D
[21:57:03] *** Quits: dschatzberg (dschatzber@moz-B15FAF67.bu.edu) (Input/output error)
[21:57:06] <strcat> pongad: looks like the basic removal is just removing a line from index_sty in middle/ty.rs
[21:57:18] <strcat> but then there's probably a fair bit of code to strip out elsewhere
[21:57:30] <strcat> dunno where. trans no doubt
[21:57:33] <strcat> constant eval maybe
[21:57:37] <tiffany> how do you make an owned closure?
[21:57:45] <tiffany> the syntax I thought was normal is now obsolete, apparently
[21:57:47] <strcat> tiffany: there are only borrowed closures and procs now
[21:58:01] <strcat> proc() {}
[21:58:05] <strcat> (can only be executed once)
[21:58:10] <tiffany> so I can't use closures for what I'm doing
[21:58:25] <strcat> we don't have very powerful closures yet.
[21:58:35] <strcat> thankfully the old mess is gone'
[21:58:37] *** rweir is now known as bob2_
[21:58:42] *** bob2_ is now known as rweir
[21:58:42] *** Quits: zimbatm (zimbatm@moz-D4F596B.cable.virginm.net) (Ping timeout)
[21:58:43] <strcat> there's room to do something good now
[21:59:59] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[22:00:25] *** Quits: analyst74 (analyst74@9D2B184F.DE01D124.4EFEDE71.IP) (NickServ (GHOST command used by Bill))
[22:00:47] <strcat> cmr: https://github.com/mozilla/rust/pull/12718 r? missed two.
[22:01:08] *** Quits: zmike (discomfito@moz-975BC507.hsd1.ct.comcast.net) (Quit: ah. I see.)
[22:01:40] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[22:01:40] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[22:03:28] <bvssvni> aatch: https://gist.github.com/bvssvni/9377568
[22:03:42] *** Quits: zwick (user@moz-4E8B077.hsd1.mi.comcast.net) (Client exited)
[22:04:04] <bvssvni> aatch: it is weird
[22:04:16] *** Joins: zimbatm (zimbatm@moz-D4F596B.cable.virginm.net)
[22:04:26] *** Joins: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP)
[22:04:55] <bvssvni> aatch: if you remove 'a from the () impl, it infers the lifetime correctly
[22:05:15] <bvssvni> aatch: but then the impl on Action fails
[22:05:26] <bvssvni> got a Heisenbug!
[22:05:30] *** Joins: zmike (discomfito@moz-975BC507.hsd1.ct.comcast.net)
[22:05:32] *** Joins: marianoguerra (marianogue@moz-79E5D862.dip0.t-ipconnect.de)
[22:05:58] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[22:07:38] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Ping timeout)
[22:07:44] *** Joins: ecr (chatzilla@moz-E43ECA51.dhcp4.washington.edu)
[22:08:54] <pongad> I just realized, why is it `oxidize` and not `compile`?
[22:08:59] *** Quits: nano (nano@moz-ED77243C.superkabel.de) (Connection reset by peer)
[22:09:47] <bvssvni> pongad: rust oxidizes when getting in touch with air?
[22:09:51] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Input/output error)
[22:09:56] *** Joins: enos (jkingyens@moz-B0C1B161.hsd1.ca.comcast.net)
[22:10:15] <pongad> bvssvni: I should have caught that
[22:10:22] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[22:10:55] *** Quits: AndyB (andyb@5EA08F51.9875BCA6.DDE5D3F6.IP) (Quit: AndyB)
[22:10:55] <kmc> rust is already oxidized
[22:11:37] <MP2E> ^ it's the metal that oxidizes into rust
[22:11:43] *** Joins: mye (mye@moz-51785099.dip0.t-ipconnect.de)
[22:12:03] *** Quits: lucian (lucian@moz-8408FDFA.cable.virginm.net) (Ping timeout)
[22:12:13] *** Quits: nrc (nrc@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 30.0a1/20140304030204])
[22:13:52] *** Joins: mib_rvu2f6 (Mibbit@moz-B7DF7953.bootp.virginia.edu)
[22:14:35] <mib_rvu2f6> Hey, I have a path variable used to open a file. How would I go about seeing the type of file (check if it's .html)
[22:14:37] <bvssvni> kmc: ah
[22:14:49] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Ping timeout)
[22:14:53] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[22:15:12] <bvssvni> kmc: I suggest switching to .iron instead of .rs
[22:15:18] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[22:15:24] <kmc> or .fe for short
[22:15:25] *** flaper87 is now known as flaper87|afk
[22:15:28] <bvssvni> ;)
[22:15:59] *** Quits: Jemaclus (Jemaclus@4EEAB704.5843BA5A.D4E4C7A5.IP) (Client exited)
[22:16:26] *** Joins: asmyers (quassel@moz-71754EDC.hsd1.md.comcast.net)
[22:16:31] <pongad> Does the current string[i] give the ith byte of the string?
[22:16:55] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[22:17:07] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[22:17:16] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[22:18:02] *** Quits: victorporof (victorporo@moz-FFB76956.cpe.net.cable.rogers.com) (Quit: victorporof)
[22:18:09] *** Joins: AndyB (andyb@397481FB.21C2548F.DDE5D3F6.IP)
[22:18:22] <bvssvni> mib_rvu2f6: http://static.rust-lang.org/doc/master/std/str/trait.StrSlice.html#tymethod.ends_with
[22:18:35] <strcat> pongad: yes
[22:19:12] <pongad> strcat: So str[i] and str.as_bytes()[i] is completely the same right? Except without the conversion
[22:19:19] <strcat> yeah
[22:19:27] <pongad> Thanks so much!
[22:19:38] <strcat> also len() and as_bytes().len() are the same
[22:22:42] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[22:22:44] <mib_rvu2f6> bvssvni: thanks. My only concern is converting my path to a string. How would I go about that in order to call that method
[22:23:14] *** Joins: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch)
[22:24:15] <bvssvni> mib_rvu2f6: does .to_str() work?
[22:25:17] *** Joins: lucian (lucian@moz-8408FDFA.cable.virginm.net)
[22:26:35] <bvssvni> mib_rvu2f6: it has a .to_c_str() but I can't find .to_str() in the docs
[22:27:02] *** Quits: sigma (sigma@C91C7F36.70518F41.9D18269F.IP) (Ping timeout)
[22:28:16] <ChrisMorgan> std::fmt::Show (format!("{}", self)) has supplanted ToStr, though ToStr still exists as precisely format!("{}", self).
[22:28:20] *** Quits: canhtak (canhtak@moz-E7F2DD45.dsl.bell.ca) (Quit: canhtak)
[22:30:07] *** Quits: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[22:30:31] *** Joins: derek_c (derek@moz-15E5E94B.cit.cornell.edu)
[22:30:47] <bvssvni> Path does not implement Show
[22:30:57] *** Quits: jagtalon (sid24114@moz-E77DEB21.irccloud.com) (Ping timeout)
[22:30:59] *** Joins: jdm (jdm@CAB30FBD.8F96AEA7.2D179A7D.IP)
[22:30:59] *** ChanServ sets mode: +o jdm
[22:31:20] <strcat> bvssvni: not all paths are unicode
[22:31:49] <strcat> there's 'display' or something
[22:32:03] *** Joins: canhtak (canhtak@moz-E7F2DD45.dsl.bell.ca)
[22:32:37] *** Joins: jagtalon (sid24114@moz-E77DEB21.irccloud.com)
[22:32:46] <bvssvni> mib_rvu2f6: http://static.rust-lang.org/doc/master/std/path/trait.GenericPath.html#method.filename_display
[22:33:16] <bvssvni> mib_rvu2f6: perhaps you can use this and then .to_str().end_with( ... )
[22:33:39] *** Quits: derek_c (derek@moz-15E5E94B.cit.cornell.edu) (Quit: Leaving)
[22:34:25] <bvssvni> mib_rvu2f6: *ends_with
[22:35:07] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[22:35:26] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Ping timeout)
[22:35:40] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[22:36:03] *** Quits: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: dherman)
[22:36:12] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[22:36:57] *** Quits: c74d (c74d@moz-E2EAC718.oc.oc.cox.net) (Ping timeout)
[22:37:11] <bvssvni> mib_rvu2f6: this is perhaps exactly what you looking for http://static.rust-lang.org/doc/master/std/path/trait.GenericPath.html#method.extension_str
[22:38:44] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Ping timeout)
[22:39:04] *** Joins: claudiu (claudiu@moz-7D1F0258.thefacebook.com)
[22:39:20] <pcwalton> 70 tests failing
[22:39:24] *** Joins: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP)
[22:39:25] <pcwalton> when ~[T] removed
[22:39:31] <pcwalton> well, 70 run-pass tests
[22:39:38] <eddyb> removed o_O?
[22:39:57] <eddyb> pcwalton: don't you need a snapshot for that?
[22:40:03] <eddyb> hmm, maybe not
[22:40:06] <pcwalton> removed from the tests
[22:41:03] *** Joins: bmu (chatzilla@moz-A87574A6.hsd1.pa.comcast.net)
[22:41:14] <paupau> does RefCell: Send?
[22:41:24] <eddyb> I hope not
[22:41:32] <eddyb> well, depends
[22:41:34] <strcat> why not?
[22:41:45] <eddyb> right, if you own it...
[22:41:49] <eddyb> Send but not Share
[22:41:53] *** Quits: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: azita)
[22:42:40] <paupau> what kinds of things are going to be Share? anything mutable?
[22:42:58] <eddyb> paupau: thread safe through &T
[22:43:22] <eddyb> so Atomic, Mutex, RwLock.... I think
[22:43:29] <paupau> hmm ok
[22:43:32] <eddyb> then you have all the parallel containers you can make
[22:43:33] *** Quits: cacteye (Mibbit@moz-362CDC0.fttp.sta.comporium.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:43:43] <mib_rvu2f6> bvssvni: that last one did the trick. It compiles at least. Thanks!
[22:43:46] <eddyb> that strcat and pcwalton know much more about than me
[22:44:13] <paupau> ah, so &mut int: Share, interesting
[22:44:20] *** Quits: pongad (pongad@moz-7E8AAD2E.res.gatech.edu) (Ping timeout)
[22:45:02] <eddyb> paupau: &mut T could be Share but only because it's immutable through &T :P
[22:45:35] <paupau> Hmm...
[22:45:42] *** Joins: evanm (evanm@636AC086.5999CED5.71743E61.IP)
[22:45:47] <eddyb> the interesting ones are non-Freeze but Share
[22:46:02] <eddyb> mutable through &T yet in a thread-safe manner
[22:46:19] <arielb1> Freeze means really deeply immutable?
[22:46:26] <eddyb> now, yes
[22:46:29] <arielb1> would a file descriptor be Freeze?
[22:46:37] <eddyb> why not?
[22:46:56] <arielb1> because it points to something mutable
[22:46:56] *** Quits: mye (mye@moz-51785099.dip0.t-ipconnect.de) (Quit: mye)
[22:46:58] <arielb1> inside
[22:46:58] <mcpherrin> fds have some mutabilityness about them, like osition in the file
[22:47:00] *** Joins: Jemaclus (Jemaclus@4EEAB704.5843BA5A.D4E4C7A5.IP)
[22:47:16] <eddyb> but that's inside the kernel
[22:47:27] <mcpherrin> that's visible to userspace though
[22:47:47] <eddyb> if you use a C API that takes T*, you'll mark it as *mut T and you'll need &mut T to call that function
[22:47:50] <eddyb> mcpherrin: interesting issue
[22:47:57] <eddyb> more of an API-level one, though
[22:48:13] <paupau> thanks for the info
[22:48:14] <eddyb> you should take &mut self when wrapping something with internal state
[22:48:24] <paupau> see y'all around
[22:48:36] <arielb1> eddyb: unless it's thread-safe
[22:48:38] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[22:48:44] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[22:48:46] <o11c> when I wrapped an API the other day, I made all the impl's take &mut self even though the rust struct was just a C pointer that never changed
[22:48:48] <arielb1> which fds are
[22:48:54] <eddyb> arielb1: thread safety is orthogonal though
[22:49:08] <arielb1> thread-safe things can't take &mut self
[22:49:17] <arielb1> otherwise you couldn't really share them
[22:49:50] *** Joins: pongad (pongad@moz-7E8AAD2E.res.gatech.edu)
[22:49:51] <eddyb> I dunno there, someone more experienced than me could voice in
[22:50:16] <eddyb> arielb1: there's also the shallow (nmatsakis calls it "interior") Freeze concept, which wouldn't go through pointers, and would be useful for determining whether the storage of a type require mutable memory
[22:50:16] *** Quits: teosz (teosz@5F23F990.D75A9DA0.3EA6AAD8.IP) (Quit: Lost terminal)
[22:50:21] *** Quits: paupau (posttext@moz-377BE2CD.hsd1.ca.comcast.net) (Quit: out)
[22:50:31] <eddyb> arielb1: like, .rodata vs .data and SSA values vs allocas (in LLVM IR)
[22:51:11] <pongad> Does anyone know what `#[lang="uniq_str_eq"]` does?
[22:51:27] <eddyb> ~"foo" patterns
[22:51:29] *** Joins: azita (Azita@F16146EB.9D3722BB.58DC3EE6.IP)
[22:51:39] *** Quits: hhhhhhhhhh (mike@moz-E08362B7.stcatz.ox.ac.uk) (Quit: WeeChat 0.4.3)
[22:51:41] <eddyb> should just use str_eq IMO. but that is going away anyways
[22:52:12] <arielb1> that makes more sense then "all references that rust can track are truly constant"
[22:52:15] <eddyb> pcwalton: hang on, didn't you remove ~"" alongside ~[] patterns some time ago? any reason for that lang item to be alive
[22:52:18] <ecr> eddyb, arielb1: you need to use &mut on things with internal state even if they're threadsafe. if you just use &, then the optimizer will be free to reorder effectful operations. I ran into this while implementing I/O in newrt.
[22:52:31] <pcwalton> yeah, it's probably dead
[22:52:35] *** Joins: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP)
[22:52:39] *** Quits: AndyB (andyb@397481FB.21C2548F.DDE5D3F6.IP) (Quit: AndyB)
[22:52:56] <eddyb> ecr: or mark it as Freeze
[22:53:00] *** Joins: t4nk528 (bzlandfill@81E7F515.4F63199.DDE5D3F6.IP)
[22:53:03] <arielb1> ecr: then how std::Cell ever works
[22:53:04] <arielb1> ?
[22:53:07] <pongad> eddyb: I'm trying to remove indexing from strings, for some reaason that line gets flagged as an internal compiler error
[22:53:10] <eddyb> err, NoFreeze
[22:53:15] <pongad> eddyb: Which it probably was
[22:53:15] *** Quits: TimAbraldes (quassel@moz-BF4D134B.hsd1.or.comcast.net) (Ping timeout)
[22:53:30] <t4nk528> Is there a function that finds the total number of bytes in a file?
[22:53:32] <eddyb> arielb1: that's not Freeze
[22:53:38] <eddyb> t4nk528: use FileStat
[22:53:54] *** Quits: arturo (Thunderbir@moz-E83B14F0.superkabel.de) (Ping timeout)
[22:54:28] <pongad> Is it possible for me to just remove the #[lang="uniq_str_eq"]
[22:54:28] <pongad> then?
[22:54:29] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:54:46] *** Quits: Guest__ (textual@moz-310FD28A.dynamic.caiway.nl) (Ping timeout)
[22:54:46] <eddyb> pongad: look in librustc/middle/lang_items.rs for its definition
[22:54:52] <eddyb> pongad: and grep for its 3 names
[22:54:56] <arielb1> Of course Freeze ≸ thread-safe
[22:55:00] <eddyb> pongad: to see if it's actually dead
[22:55:01] <pongad> eddyb: Will do
[22:55:18] <arielb1> If you access mutable external-to-process-state then you have Freeze but not thread-safe
[22:55:24] <eddyb> have we decided on removing &str indexing? I didn't hear about that
[22:55:43] <t4nk528> thanks
[22:55:52] <arielb1> Of course atomics are non-Freeze but thread-safe
[22:55:59] <eddyb> arielb1: take &mut for the methods that modify that state
[22:56:01] *** Quits: blindrenderer (blindrende@CFA55475.329A1D83.D01D599A.IP) (Quit: Leaving)
[22:56:02] <eddyb> problem solved
[22:56:09] <arielb1> That would make them useless
[22:56:10] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[22:56:16] <arielb1> because you could only have a single reference
[22:56:21] <eddyb> requiring a mutable file to read or write?
[22:56:25] <eddyb> sounds pretty normal
[22:56:33] <eddyb> arielb1: use RWArc<File> & stuff
[22:56:56] <eddyb> which ensures you don't read/write concurrently from different threads
[22:57:04] <arielb1> Of course an fd being non-Freeze won't be too bad actually
[22:57:09] <arielb1> if you use read(2)
[22:57:15] <arielb1> I doubt the optimizer reorders system calls
[22:57:19] <eddyb> taking &mut feels saner
[22:57:47] <eddyb> arielb1: they're library calls
[22:58:12] <pongad> eddyb: I saw huon's issue on GitHub, I'm not entirely sure how many people like the idea
[22:58:24] <arielb1> but they make system calls
[22:58:34] <arielb1> the optimizer shouldn't reorder system calls
[22:58:38] <pongad> eddyb: But it doesn't really change a whole lot because you can just do   str.as_slice()[i]   right?
[22:58:40] <eddyb> arielb1: LLVM doesn't see system calls
[22:58:47] <eddyb> pongad: as_bytes() you mean
[22:59:00] <arielb1> read(2) is the library call that makes a system call
[22:59:00] <pongad> eddyb: Yeah, I keep mixing the two up
[22:59:16] <arielb1> as distinct from fread(3) - which is a library call that needn't make a system call
[22:59:32] <eddyb> arielb1: LLVM only sees function calls that can do anything
[22:59:53] <eddyb> arielb1: like read/write global state
[23:00:00] <arielb1> if they can do anything then it can't reorder them
[23:00:04] <eddyb> so it shouldn't reorder them
[23:00:14] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[23:00:21] *** Quits: mgottschlag (quassel@moz-DF7A2B6A.cust.bluewin.ch) (Ping timeout)
[23:00:33] <pongad> eddyb: So, `uniq_str_eq_fn` is dead, `UniqStrEqFnLangItem` is not though, it's at exactly one place is `_math.rs`. I don't really know what it's doing there
[23:00:49] *** Joins: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp)
[23:01:07] <eddyb> pongad: that's pattern matching
[23:01:19] <eddyb> pongad: where it was used before, check if anything can reach it
[23:01:39] <eddyb> rusti: match ~"foo" {~"foo" => true, _ => false}
[23:01:40] -rusti- true
[23:01:45] <eddyb> pcwalton: huh?
[23:01:57] <eddyb> rusti: match ~[0] {~[_] => true, _ => false}
[23:01:57] -rusti- <anon>:10:21: 10:25 error: mismatched types: expected `~[<generic integer #0>]` but found a `~`-box pattern
[23:01:58] -rusti- <anon>:10         match ~[0] {~[_] => true, _ => false}
[23:01:58] -rusti-                               ^~~~
[23:01:58] -rusti- error: aborting due to previous error
[23:01:58] -rusti- application terminated with error code 101
[23:02:16] <eddyb> pcwalton: did you actually remove ~str patterns? or just ~[]?
[23:02:18] *** Quits: claudiu (claudiu@moz-7D1F0258.thefacebook.com) (Ping timeout)
[23:02:25] <pcwalton> dunno, maybe I didn't remove ~str
[23:02:26] <pcwalton> I forget
[23:02:31] *** Quits: fyolnish (fyolnish@moz-49396AB9.dynamic.ppp.asahi-net.or.jp) (Ping timeout)
[23:03:03] <eddyb> ~str as a type requires a Str or GrowableStr in the library, wrapping Vec<u8>
[23:03:32] <arielb1> should an fd be Send?
[23:03:49] <pongad> eddyb: To get there, you need to match with `ty::ty_str(ty::vstore_uniq)`. According to pcwalton that's no longer a thing right?
[23:03:55] <eddyb> arielb1: sure, Send means you move ownership from one task to another
[23:04:02] <eddyb> pongad: still is, sorry
[23:04:16] *** Quits: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com) (Quit: brendan)
[23:04:21] <pongad> eddyb: Just realized that myself, found a ton of them
[23:04:22] *** Joins: claudiu (claudiu@moz-33191099.thefacebook.com)
[23:04:28] <eddyb> pongad: see how ~[] patterns throw an error while ~"" stil works
[23:05:09] *** Quits: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch) (Quit: Leaving.)
[23:05:12] *** Quits: bjustin (bjustin@moz-8FC28563.sierrabravo.net) (Quit: Textual IRC Client: www.textualapp.com)
[23:05:43] <pongad> eddyb: Right...
[23:05:51] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:06:54] <esummers_> Do enums always allocate enough space for their largest variant (even if they are immutable)?  I assume yes, but want to make sure.
[23:07:06] <bblum> yes
[23:07:06] <mcpherrin> Yes
[23:07:21] <esummers_> Thanks
[23:07:23] <mcpherrin> Well they allocate slightly more than the largest variant
[23:07:25] <mcpherrin> since they need a tag
[23:07:31] <esummers_> right
[23:08:50] <pongad> A dumb question, if ~[] is gone, how do you dynamically allocate a vector?
[23:09:22] *** Quits: bvssvni (Mibbit@moz-C4579D6F.bb.online.no) (Quit: http://www.mibbit.com ajax IRC Client)
[23:09:25] *** Quits: Jemaclus (Jemaclus@4EEAB704.5843BA5A.D4E4C7A5.IP) (Client exited)
[23:09:27] <eddyb> pongad: Vec
[23:09:36] <Havvy> Wait, what? ~[] is gone? Since when?
[23:09:41] <arielb1> since dst
[23:09:43] <eddyb> Havvy: since tomorrow
[23:09:54] <eddyb> according to pcwalton
[23:10:05] <eddyb> arielb1: the future is awesome!
[23:10:16] <Havvy> Will ~[] ever come back?
[23:10:42] *** Joins: Jemaclus (Jemaclus@4EEAB704.5843BA5A.D4E4C7A5.IP)
[23:10:44] <arielb1> It is becoming Vec<T>
[23:10:54] <eddyb> Havvy: as DST ~[T] == ~([T])
[23:10:55] <arielb1> because of DST
[23:11:11] <sp3d> that syntax will mean an owned fixed-size array like eddby says
[23:11:19] <sp3d> eddyb*
[23:11:23] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[23:11:28] <mcpherrin> You can't resize a ~([T]) right?
[23:11:31] <arielb1> new ~[T] = owned pointer to fixed-size array
[23:11:44] *** Joins: leowoe (Leo@moz-A5AF6850.dip0.t-ipconnect.de)
[23:11:50] *** Quits: io2 (io2@moz-EE406A5.home.otenet.gr) (Input/output error)
[23:11:58] <arielb1> mcpherrin: you can but it doesn't have a capacity
[23:12:05] <arielb1> so you need to track it yourself
[23:12:24] *** Joins: io2 (io2@moz-EE406A5.home.otenet.gr)
[23:12:29] <pongad> So for dynamic array, you do `Vec<int> v; v.append(3);`?
[23:12:41] <arielb1> something like that
[23:12:45] *** Quits: ecr (chatzilla@moz-E43ECA51.dhcp4.washington.edu) (Quit: ChatZilla 0.9.90.1 [Firefox 28.0/20140227174348])
[23:12:47] *** Quits: askalski (akuda@2BA4E5A7.CC7751E8.6712E96B.IP) (Quit: Wychodzi)
[23:12:47] <cmr> in rust?
[23:12:55] *** Joins: askalski (akuda@2BA4E5A7.CC7751E8.6712E96B.IP)
[23:12:59] <arielb1> let v: Vec<int>
[23:13:05] <cmr> let v = Vec::new(); v.push(3);
[23:13:14] <cmr> or, let v = vec!(3);
[23:13:19] <pongad> Oh duh, been using too much C++
[23:13:23] <eddyb> cmr: I want Vec::new(3) :/
[23:13:31] <cmr> (I think it'd be Vec::new([]) actually)
[23:13:34] <eddyb> or vec![3] but it's still hacky as a macro
[23:13:42] <strcat> cmr: no, Vec::new()
[23:13:48] <strcat> cmr: there's vec!(1, 2, 3)
[23:13:50] <arielb1> doesn't Vec::new(3) create an array of 3 zeros
[23:13:50] <eddyb> someone fix that already
[23:13:50] *** Quits: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net) (Quit: dave1629)
[23:13:51] <arielb1> ?
[23:13:52] *** Quits: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:14:00] *** Joins: brendan (brendaneic@moz-DFAA4E15.p2p.sfo1.mozilla.com)
[23:14:11] <strcat> cmr: a method is problematic because it can't move from a slice
[23:14:15] *** Quits: marianoguerra (marianogue@moz-79E5D862.dip0.t-ipconnect.de) (Ping timeout)
[23:14:18] <SiegeLord> Oh darn, going to have to change my vector macro name >_<
[23:14:28] <eddyb> arielb1: lol no
[23:14:37] <eddyb> arielb1: what the heck is a "zero"?
[23:14:39] *** Quits: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com) (Ping timeout)
[23:14:45] <pongad> So, is removing ~str still happening?
[23:14:57] *** Joins: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP)
[23:14:57] *** ChanServ sets mode: +ao dherman dherman
[23:14:58] <eddyb> pongad: it might be a temporary oversight
[23:15:04] <arielb1> C++ std::vector does it
[23:15:07] *** Joins: johnsoft (johnsoft@moz-7E09A266.neo.res.rr.com)
[23:15:08] <arielb1> also python bytearray
[23:15:18] <eddyb> arielb1: Vec<T> is not a byte array
[23:15:56] <eddyb> pcwalton: struct UniqStr {priv bytes: Vec<u8>} and reimplement std::str?
[23:15:58] <strcat> arielb1: rust doesn't have optional parameters
[23:16:08] <pcwalton> we're discussing that
[23:16:10] <arielb1> that C++ feature is evil
[23:16:11] <pongad> eddyb: It's just that if we agree to do it, I kind of want to try my hands on it. I just got this thing called free time back, itching to use it :D
[23:16:47] <strcat> arielb1: I tend to agree, but some people want to add it to rust :)
[23:17:06] <pongad> I like Rust's lack of overloading myself :D
[23:17:20] <eddyb> pongad: try on being a dropout for size... but I still don't have enough time to do everything I want
[23:17:38] *** Joins: dave1629 (dave@moz-17578A1A.hsd1.va.comcast.net)
[23:17:45] <arielb1> overloading by argument count isn't that bad
[23:17:59] <eddyb> arielb1: I want overloading for Vec::new(a, b, c, ...)
[23:18:06] <eddyb> is that too much to have?
[23:18:27] <arielb1> that's variadic generics
[23:18:28] <eddyb> (it's doable with variadic generics, fyi)
[23:18:33] <eddyb> yeah, heh
[23:18:39] <strcat> C++ doesn't actually encourage variadic templates when you have the same type for each
[23:18:47] <strcat> you'll notice that the stdlib uses std::initializer_list instead
[23:18:50] *** Quits: mib_rvu2f6 (Mibbit@moz-B7DF7953.bootp.virginia.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[23:18:56] <Havvy> I'd rather see Vec::of(a, b, c)
[23:18:56] <strcat> for example, min({x, y, 5, z})
[23:19:03] <eddyb> strcat: we need &move [T] though
[23:19:13] *** Joins: josh (josh@moz-244364B2.cable.virginm.net)
[23:19:15] <arielb1> &move [T]?
[23:19:36] <Havvy> Making Vec::new() work the same way as JS's `new Array()` is a mistake.
[23:19:55] <eddyb> Havvy: the mistake there is the one argument case
[23:20:13] <eddyb> new Array(5) creates 5 holes
[23:20:16] <Havvy> Yep.
[23:20:18] <eddyb> instead of [5]
[23:20:21] *** Quits: bharadwaj (uid11995@moz-5F4AA75A.irccloud.com) (Quit: Connection closed for inactivity)
[23:20:23] <eddyb> I wouldn't want that
[23:20:44] <eddyb> not to mention there's no holes/zeroes in Rust (if you ignore the uninit/init intrinsics)
[23:20:54] *** Joins: valentin (Thunderbir@9A1975C1.39CE2EE.E400A05F.IP)
[23:21:00] <eddyb> strcat: and then you can go Vec<T> => Rc<[T]> without cloning
[23:21:07] *** Quits: askalski (akuda@2BA4E5A7.CC7751E8.6712E96B.IP) (Quit: Wychodzi)
[23:21:13] <eddyb> strcat: but it's a tough language feature to implement etc. etc.
[23:21:37] <strcat> Vec<T> -> ~[T] will have to shrink_to_fit() if we change free to take a length
[23:21:44] *** Joins: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch)
[23:21:47] <arielb1> eddyb: do you mean by copying the Ts
[23:21:51] <arielb1> but not their contents?
[23:22:02] <eddyb> shallow copies, yeah
[23:22:17] <arielb1> Won't that be MoveIterator<T>?
[23:22:31] <arielb1> ArrayMoveIterator<T>
[23:22:45] *** Joins: marwy (user@41303A68.5C2AEEF8.CFA44423.IP)
[23:22:45] <eddyb> you go implement a MoveIterator for [T, ..N]
[23:23:04] <eddyb> I guess it's not entirely impossible
[23:24:03] <pcwalton> 8 run-pass test failures...
[23:25:11] <pongad> Now that I think about it, why is `ty::ty_str(ty::vstore_uniq)` treated differently from `ty::ty_str(_)`?
[23:25:21] <mrmonday> what's changed about assert_eq recently? getting the error "error: failed to find an implementation of trait fmt::Show for [u8, .. 20]" where I wasn't before
[23:26:00] <eddyb> pongad: I think ~"foo" destroyes the string
[23:26:11] <eddyb> pongad: it seems to be kinda useless
[23:26:19] <ChrisMorgan> mrmonday: it's changed from using {:?} (Poly, reflection-based, implemented for all types) to using {} (Show, defined by type, implemented only when you do).
[23:26:20] *** Joins: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP)
[23:26:21] <eddyb> mrmonday: {:?} => {}
[23:26:36] *** Quits: vikstrous (v@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[23:26:38] <ChrisMorgan> mrmonday: [T, ..N] cannot implement Show, so you'll need to switch it to having ~[T] or &[T].
[23:27:01] <mrmonday> alright, I'll .as_slice() it then
[23:27:10] <ChrisMorgan> https://github.com/chris-morgan/rust-http/commit/8fe7e7d0987343ef542b02f56744e88166ebda08 and https://github.com/chris-morgan/rust-http/commit/c679052112d031eb27b6d3541fc4f7c9703e7c10 show what I did in such a case in rust-http
[23:27:18] <ChrisMorgan> .as_slice() would also work fine.
[23:27:20] *** Joins: c74d (c74d@moz-E2EAC718.oc.oc.cox.net)
[23:27:26] <arielb1> talking about weird references, what's the best way of having Uninitialised<T>?
[23:27:41] <ChrisMorgan> arielb1: unsafe { std::mem::uninit() }
[23:27:50] <arielb1> without unsafe
[23:27:54] <arielb1> interface
[23:27:59] <eddyb> nope
[23:28:01] <ChrisMorgan> You can't.
[23:28:04] <sp3d> Option<T>
[23:28:07] <eddyb> uninitialized is not safe *by definition*
[23:28:10] <ChrisMorgan> Having an uninitialised value is inherently unsafe.
[23:28:12] <eddyb> sp3d: that's initialized ;)
[23:28:17] <sp3d> not with a T
[23:28:46] <arielb1> I mean API-safe Uninitialised<T>
[23:28:52] <ChrisMorgan> arielb1: what are you trying to do?
[23:29:08] *** Joins: alisdair (textual@E1CEBB1A.D061F0C9.AA6AEE7B.IP)
[23:30:02] <eddyb> probably something unsafe
[23:30:03] <pongad> eddyb: I'm confused. `#[lang="uniq_str_eq"]` uses method `uniq_str_eq_fn` but that method is never defined...
[23:30:20] <eddyb> pongad: it's macro. magic
[23:30:42] <eddyb> it defines an enum and accessor methods
[23:30:51] <sp3d> I don't see what one would achieve with Uninitialised<T>; to initialize it you'd need a value and it seems like the init function would just be id?
[23:30:57] *** Quits: nkoep (nik@moz-10914ED.pool.mediaways.net) (Quit: Leaving)
[23:30:58] <arielb1> so that you can pass it to a function and the function must initialise it
[23:31:03] <arielb1> like out in C#
[23:31:06] <eddyb> arielb1: aaaah
[23:31:09] <sp3d> ah
[23:31:12] <pongad> eddyb: Oh...
[23:31:15] <eddyb> we discussed that earlier, that's &out T
[23:31:21] <arielb1> does it exist
[23:31:26] <eddyb> (which we don't have and let's not use that keyword)
[23:31:28] <ChrisMorgan> That's not a pattern you do in Rust at present.
[23:31:43] <eddyb> you can efficiently return large structures, so it's not a problem
[23:31:50] <pongad> eddyb: Do you think I should hold off removing str indexing until change to remove ~str lands?
[23:31:52] *** Joins: frogzilla (Mibbit@E87770CF.F746F57.CC1A2609.IP)
[23:32:09] <eddyb> pongad: you can remove pattern matching on ~"foo"
[23:32:18] <eddyb> pongad: since it's completely useless
[23:32:19] *** Joins: twi (Adium@moz-9F0310CC.cust.vodafonedsl.it)
[23:32:23] *** Joins: tcsc (tcsc@moz-5E71BAD9.hsd1.ma.comcast.net)
[23:32:24] <ChrisMorgan> arielb1: yes; if you truly do want it to be uninitialised, then you simply don't need to worry about it in Rust—just return a large struct, that's fine.
[23:32:36] <eddyb> however, we want it a bit, for other constructs
[23:32:38] *** Quits: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP) (Quit: dherman)
[23:32:58] <eddyb> arielb1: you shouldn't be allowed to read from it before reading, which means it has to transform
[23:33:08] <pongad> You mean deleting the `#[lang="uniq_str_eq"]` declaration? or remove the entire line from the lang_items table?
[23:33:25] <eddyb> pongad: both and the syntax for ~"foo" patterns
[23:33:31] <eddyb> patterns, not expressions
[23:33:52] *** Quits: Rusky (russell@moz-173BA32C.slkc.qwest.net) (Ping timeout)
[23:33:57] <eddyb> arielb1: so it should have a method that takes a value and returns a &mut T
[23:34:26] <eddyb> Out<'a, T>::init(self, value: T) -> &'a mut T
[23:34:30] *** Joins: Rusky (russell@moz-173BA32C.slkc.qwest.net)
[23:34:45] <eddyb> nmatsakis: cc ^^
[23:35:03] <eddyb> pongad: you have to prevent dropping it though :/
[23:35:21] <eddyb> as in, going out of scope without calling init
[23:35:25] *** Joins: alan_and_ (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net)
[23:35:29] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:35:36] <pongad> eddyb: I'm confused :D
[23:35:47] <eddyb> pongad: bad tab complete, sorry
[23:35:49] *** Quits: alan_andrade (alan_andra@moz-B2C44770.car1.sanfrancisco1.level3.net) (Ping timeout)
[23:36:17] <eddyb> arielb1: that was for you, re: dropping. I think the term is "linear value" which we can't really enforce yet
[23:36:18] <pongad> eddyb: Ah, ok. Sorry that I keep bugging you, but how do I remove the syntax? :D
[23:36:35] <eddyb> pongad: edit src/libsyntax/parse/parser.rs
[23:37:02] <arielb1> you can call abort in drop
[23:37:10] <eddyb> I'd rather not
[23:37:31] <ChrisMorgan> arielb1: calling abort is a bad idea.
[23:37:32] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:37:51] <eddyb> arielb1: runtime failure for things you can enforce at compile time is just being silly
[23:37:54] <pongad> eddyb: Wait, ~"" is still in use right? I just `git grep '~"' and it shows up everywhere
[23:38:03] <eddyb> pongad: *pattern* not expression
[23:38:13] <eddyb> pongad: as in, ~"" used inside a match
[23:38:25] <pongad> OH
[23:38:31] <eddyb> that's what pattern means :P
[23:38:37] *** Joins: dherman (dherman@F16146EB.9D3722BB.58DC3EE6.IP)
[23:38:37] *** ChanServ sets mode: +ao dherman dherman
[23:38:42] <eddyb> unless we use it to mean something different, which we do all the time =)))
[23:38:49] <eddyb> pongad: we're so bad, sorry :)
[23:38:50] *** Quits: frogzilla (Mibbit@E87770CF.F746F57.CC1A2609.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:39:01] <eddyb> inb4 "speak for yourself"
[23:39:09] <pongad> eddyb: All good! xD
[23:39:41] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[23:39:47] *** Joins: jensnock_ (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[23:40:57] *** Quits: guitsaru (uid26318@moz-31ABA2C0.irccloud.com) (Quit: Connection closed for inactivity)
[23:41:27] *** Quits: marwy (user@41303A68.5C2AEEF8.CFA44423.IP) (Client exited)
[23:43:03] *** Quits: turon (Mibbit@moz-BD95F12.tampfl.fios.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[23:43:47] <arielb1> something like http://pastebin.com/wk8fm9V8
[23:43:56] <arielb1> assuming #[private_destructor] exists
[23:43:58] *** Joins: alinab_ (alina@moz-94EAE39D.alinab.org)
[23:44:06] *** Quits: alinab_ (alina@moz-94EAE39D.alinab.org) (Quit: alinab_)
[23:44:17] <eddyb> arielb1: why a closure?
[23:44:59] *** Joins: nrc (nrc@F16146EB.9D3722BB.58DC3EE6.IP)
[23:44:59] <eddyb> arielb1: also, you need to return &'a mut T
[23:45:11] <arielb1> Because I want initr to return the SAME
[23:45:14] <arielb1> pointer
[23:45:30] <eddyb> that run thing is a hack
[23:45:30] *** Quits: rohanpm (quassel@9A927BA5.89CBB463.4206AA37.IP) (Quit: http://quassel-irc.org - Chat comfortably. Anywhere.)
[23:45:37] <eddyb> arielb1: you can take things by value ;)
[23:45:43] <eddyb> also also by mutable borrow
[23:45:43] *** Quits: Taneb (Taneb@moz-AA8D754D.hacksoc.org) (Ping timeout)
[23:45:55] <eddyb> actually, you kinda do that, but not nicely
[23:46:25] *** Joins: Taneb (Taneb@moz-AA8D754D.hacksoc.org)
[23:46:46] <arielb1> initr should initialise the Uninitialised<T> of course
[23:47:00] <eddyb> arielb1: you don't need a closure for init though
[23:47:05] <eddyb> can totally take a value
[23:47:12] <arielb1> but then I copy T
[23:47:20] <pongad> eddyb: Was looking into removing the pattern, I think this comment is an issue "// HACK: parse ~"..." as a literal of a vstore ~str"
[23:47:24] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:47:27] <eddyb> arielb1: only if you explicitly force optimizations off
[23:47:29] <arielb1> I'm assuming the closure will be inlined in practice
[23:47:42] <kimundi> so will by value
[23:47:49] <eddyb> arielb1: a closure is harder to optimize than removing a copy
[23:48:01] <eddyb> especially if you capture stuff
[23:48:05] <eddyb> (which you need to)
[23:48:19] <eddyb> pongad: is that in pattern parsing?
[23:48:29] <pongad> eddyb: yeah
[23:48:34] <eddyb> rip that out
[23:48:49] *** Joins: pepper_chico (pepper_chi@moz-37BD872E.dsl.telesp.net.br)
[23:49:36] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Connection reset by peer)
[23:49:37] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[23:49:42] <pepper_chico> hey, what compilation phase is this "oxydize"?
[23:49:51] <eddyb> compile_and_link
[23:50:09] <pongad> eddyb: I'm not sure I can rip that out without causing the whole thing to explode, it looks like that code is used for other forms of parsing too
[23:50:28] <pongad> Unless ~ is not allowed in patterns in general
[23:50:32] <eddyb> pongad: is it used for all literals?
[23:50:47] <eddyb> pongad: as in, does ~"foo" the expression and ~"foo" the pattern share code?
[23:51:04] <eddyb> ~ is allowed in patterns, that shouldn't be a problem
[23:51:09] *** Quits: jviereck (Adium@moz-7859BAFE.dclient.hispeed.ch) (Quit: Leaving.)
[23:51:24] *** Quits: blank_name (blank_name@463DB555.53526368.6D228269.IP) (Ping timeout)
[23:51:30] <pongad> eddyb: There's a block of code that's used whenever `sub.node` matches `PatLit(e)`
[23:51:46] <pongad> eddyb: I assume it matches a lot more than just ~"abc"
[23:51:53] <eddyb> pongad: you don't remove the entire thing
[23:51:58] <eddyb> you remove ~"foo"
[23:52:03] <eddyb> let me just check
[23:52:25] <pongad> Line 2841
[23:52:53] <eddyb> pongad: it's just for patterns, not all expressions
[23:53:16] <eddyb> pongad: you basically remove this case ExprLit(lit) if lit_is_str(lit) => {
[23:53:22] <pepper_chico> oh, ok then
[23:53:31] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:53:41] <pongad> eddyb: Oh right! I see it now
[23:53:51] <pongad> Sorry, never worked on compilers before :(
[23:53:56] <eddyb> that makes the hack go away
[23:54:12] <eddyb> since it's just pat = PatUniq(sub) for everything
[23:54:22] <eddyb> this has an amusing result
[23:54:42] <pongad> But then ~"" patterns will still compile right, since it will go to `_ => PatUniq(sub)`?
[23:54:48] *** Joins: blank_name (blank_name@463DB555.53526368.6D228269.IP)
[23:55:06] *** Quits: arielb1 (arielb1@moz-E6742496.red.bezeqint.net) (Ping timeout)
[23:55:08] <eddyb> rusti: match ~("foo") {~("foo") => true, _ => false}
[23:55:09] -rusti- <anon>:10:32: 10:33 error: expected `,` but found `)`
[23:55:09] -rusti- <anon>:10         match ~("foo") {~("foo") => true, _ => false}
[23:55:09] -rusti-                                          ^
[23:55:09] -rusti- application terminated with error code 101
[23:55:18] <eddyb> pongad: it will work like that ^^
[23:55:23] <eddyb> rusti: match ~("foo") {~&"foo" => true, _ => false}
[23:55:24] -rusti- true
[23:55:28] <eddyb> or this, I guess
[23:55:48] <eddyb> pongad: so ~"foo" becomes a valid pattern for ~&'static str
[23:56:04] <eddyb> well, ~&str, the value is ~&'static str
[23:56:15] <eddyb> pongad: which should be handled by str_eq and not uniq_str_eq
[23:56:17] <pongad> eddyb: I feel like this discussion is too complicated for my mind to follow :D
[23:56:24] <pongad> eddyb: I see
[23:56:32] <pongad> eddyb: Kind of.
[23:56:44] <doomlord_> is there anything special i should know about writing to a  static mut g_foo=Option<~T>; i have an initialize funtion that writes Some( T{...initializaztion} ) .. debug prints of g_foo shows something ... but later acess shows 'None' .. weird
[23:56:54] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (No route to host)
[23:56:56] <eddyb> pongad: it will cause errors in code/tests, so be prepared to rewrite a few pieces of unidiomatic rust ;)
[23:57:03] *** Joins: spott_ (spott@moz-5158CBDE.colorado.edu)
[23:57:12] <eddyb> pongad: it certainly doesn't make sense to pattern-match against ~"foo" because you destroy the string
[23:57:28] <pongad> eddyb: YOu will?
[23:57:39] <eddyb> isn't that what uniq_str_eq does?
[23:57:43] <eddyb> doesn't it take ~str?
[23:57:48] *** Joins: mib_4niga7 (Mibbit@29CCD9A4.7A4BEA29.5471C235.IP)
[23:57:48] *** Quits: jmmk (jmmk@moz-3BDBD2C0.hfc.comcastbusiness.net) (Ping timeout)
[23:58:13] <eddyb> doomlord_: you're asking for race conditions
[23:58:29] <doomlord_> theres' only one thread - it can certainly be given a mutex
[23:58:34] <pongad> eddyb: Right, I see it now.
[23:58:53] *** Quits: Rym (WUT@7001AAD.5D2765E2.51C6DE68.IP) (Ping timeout)
[23:59:01] <pongad> You match it then you give it away immediately
[23:59:03] <eddyb> pongad: can grep for ~".*" => or something like that
[23:59:29] <doomlord_> my application will only have one 'main' thread and many worker threads.
[23:59:51] <pongad> eddyb: Running make check right now, should see errors soon :D
