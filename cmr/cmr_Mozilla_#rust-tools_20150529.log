[00:39:47] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[01:07:14] *** Quits: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[01:14:52] *** Joins: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com)
[01:14:52] *** ChanServ sets mode: +qo acrichto acrichto
[02:08:09] *** Joins: c74d3 (c74d3a4ebb6@moz-rhs0n6.mggc.hibn.4404.2002.IP)
[02:09:26] *** Quits: c74d (c74d3a4ebb6@moz-0ersgu.oc.cox.net) (Ping timeout: 121 seconds)
[02:09:45] *** c74d3 is now known as c74d
[02:14:49] *** Joins: Tuba (Tobba@moz-o13d22.bredband.telia.com)
[02:17:09] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[02:20:03] *** Tuba is now known as Tobba
[03:16:23] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[05:13:45] *** Joins: c74d3 (c74d3a4ebb6@moz-0ersgu.oc.cox.net)
[05:14:46] *** Quits: c74d (c74d3a4ebb6@moz-rhs0n6.mggc.hibn.4404.2002.IP) (Ping timeout: 121 seconds)
[05:15:22] *** c74d3 is now known as c74d
[07:06:03] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[07:25:00] *** Joins: Tobba (Tobba@moz-6oh.7ki.21.217.IP)
[10:25:14] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[12:19:05] *** Quits: Tobba (Tobba@moz-6oh.7ki.21.217.IP) (Ping timeout: 121 seconds)
[13:25:43] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[15:24:55] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[16:42:09] <edunham> added PDX IPs to the bastion firewall. the office is 206.169.237.176/28 and 207.126.102.128/28 and I added the same rules as the other offices have.
[16:44:19] <acrichto> edunham: hurray for fewer hops!
[16:44:34] <acrichto> at some point I had a chain of like 5 ssh hops to get to the bastion
[16:44:40] <acrichto> I don't even remember what they all were...
[17:19:27] <acrichto> edunham: you have access to the heroku console, right?
[17:20:06] <edunham> acrichto: yep, i have crates-io access
[17:20:12] <edunham> thank you for setting that up
[17:20:18] <acrichto> edunham: oh np :)
[17:20:23] <acrichto> so you should take a look at the graphs right now
[17:20:25] <acrichto> https://i.imgur.com/ibBy9g2.png
[17:20:30] <acrichto> that's.. not good
[17:20:44] <acrichto> I just found a fix for that, but I'm sad it took me so long to realize it was a problem :(
[17:20:51] <acrichto> not sure if it's easy to set up alerts for stuff like that
[17:21:00] <edunham> ok, found the graphs in the ui
[17:21:03] <acrichto> (just something to keep in mind)
[17:21:12] <acrichto> I'll file an issue on crates.io
[17:26:38] * edunham makes a note to research the options and update the issue
[17:28:11] <acrichto> edunham: so currently I have some alerting set up through pingdom.com for crates.io, but it's super basic and just tells me when the site is down
[17:28:29] <acrichto> it's got more features, but they all cost money, which I'm not sure if it's worth it just yet
[17:28:39] <edunham> ok, can i get access to that?
[17:28:40] <acrichto> do you know of any free services which do more fancy checks?
[17:28:48] <acrichto> unfortunately it's just a one user thing :(
[17:28:49] <steveklabnik> pagerduty? i forget what their free tier offers
[17:28:53] <acrichto> you have to pay for more than one
[17:28:54] <acrichto> oooh
[17:28:55] <edunham> oh ok
[17:29:07] <edunham> we can look into pagerduty free tier
[17:29:09] * acrichto checks
[17:29:10] <steveklabnik> ahh apparently all paid
[17:29:13] <steveklabnik> http://www.pagerduty.com/pricing/
[17:29:16] <steveklabnik> or at least, looks like
[17:29:34] <acrichto> hm looks like they just have free trieals yeah
[17:30:41] <edunham> it'd also be possible to spin up something of our own, but might not actually be cheaper once you count in all the time that goes into maintaining it
[17:31:52] <acrichto> edunham: yeah :(
[17:33:32] <edunham> what's the user impact of a crates.io latency spike like that?
[17:33:51] <acrichto> pretty bad unfortunately
[17:33:55] <acrichto> all cargo downloads take 500ms long
[17:34:00] <acrichto> longer*
[17:34:06] <acrichto> and all requests to crates.io take 500ms longer
[17:34:16] <acrichto> and crates.io makes a lot of requests being an ember app
[17:35:25] <edunham> ok
[17:36:01] <edunham> logistically, what's the right workflow for me to go about getting an infra tag added to the crates.io issue tracker and applied to the infra bugs?
[17:36:25] <edunham> easiest for everyone else would be for me to just get added to a team with permissions that'd let me do it myself
[17:36:37] <edunham> but i'm not sure what the politics around that are, since such teams typically come with a commit bit
[17:37:15] <acrichto> ah unfortunately you have to have write access to a repo to modify tags I think
[17:37:19] <steveklabnik> yes
[17:37:25] <acrichto> which is not great :(
[17:37:31] <acrichto> but I can just add you to the repo
[17:38:24] * edunham pinky promises not to use the perms for committer stuff
[17:38:43] <acrichto> hehe
[17:39:33] <edunham> at least, not unless someone explicitly tells me i'm allowed to start acting like a committer :)
[17:42:37] <edunham> wow, yeah, I just went looking for a way to manage tracker-specific perms in case they added it recently and there's nothing
[17:42:56] <edunham> another reason some projects prefer external trackers, i guess
[17:48:37] <acrichto> edunham: this is one of the... "few" deficiencies of github bugs :P
[17:49:17] * edunham throws an email over the wall into gh support going "guys there really should be a way to do this"
[17:49:24] <edunham> not like it'll actually help, but it makes me feel better
[17:50:03] <acrichto> edunham: see you'd think they'd listen to us b/c we're such a large project on github
[17:50:10] <acrichto> but it hasn't worked out like that in the past :(
[17:50:32] * edunham makes mental note to acquire github engineers' cards at oscon and hassle them directly
[17:51:06] <edunham> i mean, i never expect complaining to make an actual difference, but sometimes it does
[17:51:45] <acrichto> that I would definitely believe!
[18:01:53] <edunham> hmm, new relic has a free tier http://newrelic.com/application-monitoring/pricing
[18:02:26] <acrichto> does newrelic have something other than a ruby agent though?
[18:02:52] <edunham> supports java, node, php, python, ruby https://devcenter.heroku.com/articles/newrelic
[18:03:13] <edunham> also, just for my edification, what was the fix you found for the latency issue?
[18:03:41] <steveklabnik> we should lean on tilde to make a rust agent, since it already is ;)
[18:03:42] <steveklabnik> haha
[18:04:46] <acrichto> edunham: https://github.com/rust-lang/crates.io/commit/63e4acc7c1b4784c0398ea066fc917dd426d4194
[18:04:58] <acrichto> which is in turn picking up https://github.com/alexcrichton/bufstream/commit/d66cc302e583c04dd0e9ecfbdf78124683b7b8ca
[18:05:08] <acrichto> basically the buffered streams were not buffering
[18:05:11] <acrichto> causing massive slowdowns
[18:05:27] <edunham> ah, okay
[18:05:46] <edunham> steveklabnik: googling 'tilde monitoring' gets me https://www.skylight.io/ ; same thing?
[18:05:49] <acrichto> https://i.imgur.com/3NLg9eE.png <- this looks better
[18:06:01] <edunham> much :)
[18:06:03] <steveklabnik> yes, they're one of our first production users, and one of the founders is on rust core
[18:06:08] <steveklabnik> but it only monitors rails apps
[18:06:17] <acrichto> edunham: yeah the tilde monitoring agent (skylight) is written in Rust :)
[18:13:48] <edunham> looks like one can't get at heroku metrics through the API yet, either
[18:14:35] <edunham> although if i was going to poll the api with something temporary, i guess i could as well just measure the response times directly
[18:16:43] * edunham wonders whether anyone has written usable open source monitoring stuff in Rust yet
[18:17:17] <cmr> edunham: monitoring of what?
[18:17:56] <edunham> applications
[18:18:04] <edunham> like, the oversimplification would be "nagios clone"
[18:18:06] <cmr> What metrics?
[18:18:35] <cmr> Ah
[18:18:55] <edunham> in this case, alerting on a change in response time would've caught it
[18:19:09] <edunham> in real life it's nice to alert on application errors and stuff as well
[18:19:25] <cmr> (I ask because I've been working a bit on telemetry/remote monitoring tools for my game and it might be possible to extract/generalize it)
[18:20:08] <edunham> it'd be easiest and most generic to watch things like response time and http status codes and file presence/absence remotely, at first
[18:20:28] <edunham> solve the problem of instrumenting the server itself by just ignoring it :)
[18:20:43] <edunham> s/solve/"solve"
[18:25:33] <edunham> tbh right now i'm most scared of the fact that none of the AWS stuff is backed up in a way that I'm convinced I could successfully restore from
[18:31:16] <acrichto> edunham: yeah...
[18:32:06] <edunham> so I'm going to work out some kind of bandaid to make that slightly less terrifying until I can get those servers into config management
[19:14:07] <cmr> So, someone should definitely create a service tht I can point rustdoc.org to.
[19:48:37] <edunham> cmr: what do you have in mind?
[19:50:24] <cmr> edunham: Since rust-ci was abandoned everyone has been putting their docs on gh-pages, but it was nice to have everything on a single site.
[19:50:50] <edunham> so an aggregator of rust module docs?
[19:50:53] <cmr> Right.
[19:52:04] <edunham> sounds like a system that could be written in Rust :)
[20:06:29] <edunham> acrichto: When we were discussing the ec2 backups or lack thereof, you mentioned taking snapshots occasionally. Were you referring to the AWS imaging tool, or something else?
[20:08:48] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[20:13:53] <acrichto> edunham: hm, I'm not sure what tool I was referring to
[20:13:57] <acrichto> lemme check
[20:14:24] <edunham> if it's a tool available in the web UI, it's probably images.
[20:15:03] <acrichto> ah that's it
[20:15:08] <acrichto> I hit something liek "Create Image"
[20:15:12] <acrichto> some random button on there
[20:15:15] <edunham> ok, cool
[20:15:18] <edunham> i know where that button is
[20:15:19] <acrichto> aws does not want to load for me...
[20:15:21] <acrichto> it creates an AMI though
[20:15:24] <acrichto> I know that much!
[20:15:31] <edunham> yep, that's what the imaging button does
[20:15:50] <edunham> so the *-master, *.r-l.o, and bastion definitely need backups
[20:15:57] <edunham> one each of prod-slave-* as well
[20:16:02] <edunham> and, uhh, what's crater?
[20:16:18] <acrichto> none of the slaves should need backups
[20:16:22] <edunham> oh ok
[20:16:25] <acrichto> b/c they're all bootstrapped from their own AMIs
[20:16:32] <acrichto> they're all the rust-*-slave-* images
[20:16:36] <edunham> nice, if we have those AMIs already then we're cool
[20:16:48] <acrichto> the *-master images I believe don't have AMIs associated with them
[20:16:51] <edunham> oh hey, there's an AMI list over there
[20:16:56] <acrichto> and play.rust-lang.org has an AMI, but I don't think doc.rust-lang.org does
[20:17:16] <acrichto> well to answer your question, yeah *-master and *.r-l.o should all have backups of some form
[20:17:22] <acrichto> I don't know what our crater instance is doing
[20:17:24] <acrichto> brson would know more about that
[20:17:35] <acrichto> that's brson's tool for running huge regression tests over all Rust code on crates.io
[20:17:40] <edunham> oh, cool
[20:17:43] <acrichto> not sure how the EC2 instance comes into play
[20:18:37] * edunham errs on the side of extra backups
[20:21:36] <edunham> hmm. how badly would it break things to reboot the *.r-l.o and *-master instances? probably take down the sites momentarily and possibly make the builds super sad I guess  
[20:22:12] <edunham> a no-reboot image can't provide filesystem integrity guarantees...
[20:23:16] * edunham takes no-reboot images for now
[20:28:15] <acrichto> edunham: we probably don't want to reboot either
[20:28:22] <acrichto> I'd be scared to do so at least
[20:28:31] <edunham> yep, i took all no-reboots
[20:28:33] <acrichto> edunham: rebooting doc.rust-lang.org would take down all docs temporarily for example
[20:29:10] <edunham> I figure if we're gonna schedule downtime, which I would do before any intentional maintenance, I'd want to pack more improvements into the window
[20:30:06] <acrichto> seems fine
[20:30:16] <edunham> in a perfect world we'd have load balancing and redundancy and taking down any individual instance would be invisible to the end-user
[20:30:38] <acrichto> :D
[20:30:39] <edunham> but there are a few more impending fires to prevent before even starting on that
[20:31:38] <edunham> ok, my next most terrifying thing on my list is the fact that to my knowledge, only one person has ever been able to successfully build a servo snapshot.
[20:31:46] <cmr> wow you outdid yourself hiring an actual ops person, eh?
[20:32:04] <edunham> err? 
[20:32:18] <cmr> load balancing! redundancy! backups! what are these foreign concepts ;)
[20:32:21] <edunham> they hired an ops guy with a healthy sense of terror regarding single points of failure :)
[20:33:01] <cmr> our infrastructure may soon be worthy of the name.
[20:33:07] <edunham> aww, thanks :)
[20:34:05] <edunham> yeah all I have to do is leran to build a servo snapshot and make sure Rust isn't going to get embarrassingly abused by some recent CVEs, and I'll have the bandwidth to start looking at nice-to-haves like monitoring and configuration management :)
[22:00:47] <gleb> is there a manual for writing rustdoc tests (that live in src/test/rustdoc)?
[22:03:25] <cmr> gleb: I don't think so.
[23:21:53] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
