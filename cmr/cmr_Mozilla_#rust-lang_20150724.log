[00:03:37] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[02:12:20] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[04:07:05] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[07:29:28] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[07:34:30] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[07:44:37] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[08:21:32] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[09:35:35] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[12:13:17] *** Quits: jroesch (sid26078@moz-o13a59.charlton.irccloud.com) (Quit: )
[12:13:35] *** Joins: jroesch (sid26078@moz-rp9ic4.irccloud.com)
[17:27:37] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[18:20:09] <huon> nmatsakis: nrc: pnkfelix: crater report from feature gating #[repr(packed)] https://gist.github.com/huonw/09afdfac676eb3bda82b 
[18:20:29] * huon is looking through them now
[18:22:09] <huon> ok, seems `image` doesn't strictly need repr(packed)
[18:23:36] <huon> unsure about nix, asking carl
[18:24:32] <huon> tendril probably does want it, but it using other features anyway
[18:25:26] <huon> huh, not really sure what assimp-sys is doing at all
[18:26:36] <huon> stemmer definitely doesn't need it
[18:27:46] <huon> x86 does need it (using other unstable features too)
[18:28:21] <huon> http2parse is... unclear
[18:36:02] <huon> (http2parse is transmuting &[u8] to a &[ThePackedStruct] and hence wants the precise layout)
[18:37:03] <nmatsakis> huon: wacky.
[18:37:05] <nmatsakis> http!
[18:37:24] <huon> (assimp-sys looks like it needs it for FFI; the structs are declared as packed in C)
[18:37:31] <nmatsakis> huon: pnkfelix: nrc: I am thinking of promoting https://github.com/rust-lang/rfcs/pull/1214 to FCP, thoughts?
[18:37:48] <nmatsakis> I have to go through and update it based on feedback, but I feel like nobody objects to the high-level business, just a matter of getting the nits right
[18:38:01] <huon> <eljay> huon: well my assimp binding is basically abandoned for now if you are just worried about breaking things, and seems unlikely anyone is using it :P
[18:41:38] <nmatsakis> hmm I had wanted to move https://github.com/rust-lang/rfcs/pull/1129 to FCP, but it seems that the text is somewhat out of date
[18:41:45] <nmatsakis> I e-mailed japaric but got no response
[18:41:48] <nmatsakis> (a whileago)
[18:43:53] <huon> nl80211rs needs packed because the C structs are declared as packed
[18:45:05] <huon> unclear about openal, doesn't look like it's FFI
[18:45:39] <huon> elfloader needs exact layout
[18:46:10] <huon> x11cap needs the same
[18:46:39] <huon> will summarise in a form that's not an IRC dump in a bit
[18:51:07] <Elaine> it is used in ffi in openal but it doesn't need repr(packed)
[18:51:46] <huon> it looked to me like it was using an external openal-sys crate for the FFI?
[18:51:51] <huon> (but that's good, thanks)
[18:51:58] <Elaine> it passing pointers to those structs to openal
[18:52:16] <Elaine> nl80211rs doesn't need it
[18:52:25] <huon> why not?
[18:52:35] <Elaine> they're flat structs of some multiple of u32
[18:52:39] <Elaine> no padding to be had
[18:52:44] <huon> the alignment is lower
[18:52:48] <huon> 1 vs. 4
[18:53:05] <Elaine> #[repr(packed)] modifies alignment?
[18:53:05] <huon> at the very least, it's matching what the C code does
[18:53:30] <huon> yeah, a packed struct has no alignment restrictions on any field, including the first one
[18:53:39] <huon> (I think it's what C does too)
[18:53:51] <huon> anyway, gtg
[18:58:46] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[19:48:12] *** Joins: achanda (achanda@moz-s19.c8s.234.98.IP)
[19:52:21] *** Joins: achanda_ (achanda@moz-qv7q4n.ca.comcast.net)
[19:53:19] *** Quits: achanda (achanda@moz-s19.c8s.234.98.IP) (Ping timeout: 121 seconds)
[19:59:18] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[19:59:23] *** Quits: achanda_ (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[20:10:20] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[20:15:43] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[20:34:46] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[20:52:17] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[21:30:47] <nrc> nmatsakis: +1
[22:07:24] *** Joins: achanda_ (achanda@moz-qv7q4n.ca.comcast.net)
[22:07:44] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[22:23:53] <huon> nmatsakis: pnkfelix: nrc: https://gist.github.com/huonw/8262a4fb2da0a052f5f1\
[22:28:28] *** Quits: achanda_ (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[22:30:08] <nmatsakis> huon: so that leaves 4 stable crates that need packed?
[22:30:15] <nmatsakis> huon: which are those 4?
[22:30:37] <nmatsakis> oh I see
[22:31:15] <huon> oh, err, whoops, I mangled the link https://gist.github.com/huonw/8262a4fb2da0a052f5f1 is the clickable real one
[22:31:31] <nmatsakis> certainly doesn't seem terrible
[22:31:39] <huon> nmatsakis: let me put that info straight into the summary...
[22:31:40] <nmatsakis> but I'd prefer not to keep it feature-gated for long
[22:32:10] <nmatsakis> I'm a bit unclear on whether it's worth the trouble to feature-gate, vs just drafting an RFC that tries to make them safe
[22:32:17] <nmatsakis> and transitioning into it
[22:32:21] <nmatsakis> seems like a simple case where we could issue warnings
[22:33:15] <huon> well, I think we're going to cause breakage with making them safe
[22:33:26] <huon> e.g. derive essentially won't work
[22:33:37] <huon> (assuming we disallow internal references)
[22:34:55] <huon> hm, I appear to have miscounted something...
[22:35:44] <nmatsakis> huon: I know we'll cause breakage, that's why I said warning
[22:35:47] <nmatsakis> I mean
[22:35:52] <nmatsakis> we're going to cause breakage feature-gating them too?
[22:35:58] <nmatsakis> and eventually we plan to make them safe
[22:36:05] <nmatsakis> right?
[22:36:14] <nmatsakis> main reason I can see to feature gate is to buy time
[22:36:15] <nmatsakis> which is not a bad reason
[22:36:23] <nmatsakis> like if we want to ponder the change to make,
[22:36:26] <nmatsakis> or just don't feel like making it now
[22:36:37] <nmatsakis> this might be best policy
[22:41:18] <huon> (updated with a table)
[22:43:58] <huon> while we mull, I'll submit some PRs removing the unnecessary repr(packed)'s
[23:22:03] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[23:27:12] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Ping timeout: 121 seconds)
[23:31:06] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[23:43:02] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
[23:45:16] *** Joins: achanda (achanda@moz-qv7q4n.ca.comcast.net)
[23:47:32] *** Quits: achanda (achanda@moz-qv7q4n.ca.comcast.net) (Connection closed)
