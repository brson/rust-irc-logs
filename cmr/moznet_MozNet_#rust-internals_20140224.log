[00:05:20] *** Quits: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca) (Ping timeout)
[00:07:27] *** Joins: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca)
[00:11:05] *** Quits: eibwen (kvirc@moz-2C26CBA3.dip0.t-ipconnect.de) (Ping timeout)
[00:18:01] *** Joins: lpy (lpy@81B96B5C.F09091A8.1348A864.IP)
[00:20:44] *** Joins: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP)
[00:21:01] <huon> acrichto: ping
[00:28:01] <acrichto> huon: pong
[00:32:11] <huon> acrichto: are you working on fixing the rustdoc thing?
[00:32:45] <acrichto> not yet, no
[00:32:47] *** Quits: lpy (lpy@81B96B5C.F09091A8.1348A864.IP) (Client exited)
[00:32:53] <acrichto> with rustc?
[00:32:58] <huon> yeah
[00:33:09] <huon> ok: it seems it because they're all indented blocks, not ```-style blocks
[00:33:13] <huon> *it's
[00:33:13] *** Joins: lpy (lpy@81B96B5C.F09091A8.1348A864.IP)
[00:33:21] <acrichto> yeah I ran into one case of that in libstd
[00:33:25] <huon> there's no way to add notrust to those ones is there?
[00:34:55] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[00:35:08] *** Quits: lpy (lpy@81B96B5C.F09091A8.1348A864.IP) (Ping timeout)
[00:39:11] <acrichto> nah
[00:39:15] <acrichto> I had to enclose them in ``` fences
[00:39:44] <huon> nmatsakis may be slightly annoyed :(
[00:40:03] <huon> I wonder if we could have a "this comment isn't Rust" toggle?
[00:40:52] <huon> (i.e. to apply to the whole doc comment, not just each code block
[00:40:54] <huon> )
[00:41:11] <acrichto> hm I'm not sure if markdown has a syntax for something like that
[00:42:43] <Eridius> ``` isn't even markdown, it's github markdown
[00:42:46] <ChrisMorgan> You could go for something like Stack Overflow's "Put a <!-- language: lang-rust --> before the code block"â€¦
[00:43:03] <ChrisMorgan> Now all this trouble would be resolved with reStructuredTextâ€¦
[00:43:12] <huon> ChrisMorgan: :P
[00:43:34] <ChrisMorgan> huon: about my second line, I hope!
[00:43:44] <bjz> :)
[00:43:53] <huon> of course :)
[00:43:56] <ChrisMorgan> (I'm serious about the first. It's the best you'll get in Markdown.)
[00:44:40] <nrc> GitHub markdown ha a language specifier too - ```rust
[00:44:53] <nrc> er ` ` ` rust
[00:45:02] <nrc> but without the spaces
[00:46:59] <huon> nrc: yeah, rustdoc uses the 'notrust' "language" to work out when a block of code isn't meant to be tested/highlighted
[00:47:09] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[00:47:09] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/6vdNRQ
[00:47:09] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[00:50:01] <ChrisMorgan> nrc: (Feel free to completely ignore this line, it's unimportant.) Just to fill you in on some context you've probably missed, I'm the resident Markdown-hater. Most of my reasons are detailed in my rant part way through http://chrismorgan.info/blog/rust-docs-vision-presentation.html.
[00:52:04] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[00:52:05] <ghrust> [13rust] 15bors pushed 11 new commits to 06auto: 02http://git.io/spgdJw
[00:52:05] <ghrust> 13rust/06auto 14623e475 15Brian Anderson: test: 'ratcher' is not a word
[00:52:05] <ghrust> 13rust/06auto 14713ca7d 15Huon Wilson: std: mark two helper functions #[inline]....
[00:52:05] <ghrust> 13rust/06auto 14a8941c3 15Brian Anderson: std: Remove some nonsense from old std::io docs...
[00:52:07] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[00:53:15] *** Quits: tedh (tedh@moz-6F8EC49.central.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:55:15] <acrichto> huon: r? https://github.com/mozilla/rust/pull/12412
[00:55:38] <ChrisMorgan> https://www.wordnik.com/words/ratcher is interesting :-/
[01:04:39] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[01:05:26] <huon> acrichto: needs a rebase
[01:05:45] <acrichto> huon: sure, but it'll always need a rebase?
[01:06:46] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[01:07:31] <huon> acrichto: yeah, I'm reading over it now
[01:09:33] <acrichto> thanks
[01:15:17] <cmr> "But, I'd ratcher use the diode desing so I can make it give 4. 5v instead of a stright 5. 0v (because I don't want to blow my $250 mew gadget!)"
[01:32:49] <huon> acrichto: r? https://github.com/mozilla/rust/pull/12510
[01:32:52] <huon> (or anyone else)
[01:33:23] *** Joins: Guest_ (textual@16F167B.4C57D258.D8E8354F.IP)
[01:39:09] *** Joins: speckle (speckle@moz-AD109A29.hsd1.md.comcast.net)
[01:40:44] *** kimundi is now known as zz_kimundi
[01:43:34] <erickt> acrichto: want to continue the discussion about `Hash` and default typarams?
[01:44:02] <huon> acrichto: should #12510 have p=1? (since the docs are being generated at all)
[01:44:20] <huon> erickt: I assume you saw that the snapshot/Hash-usage landed?
[01:44:26] <erickt> I did!
[01:44:30] <erickt> very happy
[01:44:43] <huon> acrichto: *aren't being generated
[01:45:26] <acrichto> huon: that's fine
[01:46:05] <huon> it's a little annoying that it missed the rollup :(
[01:46:23] <nrc> can someone point me to some code to read to figure out how feature gates work please?
[01:46:43] <huon> nrc: librustc/front/feature_gate.r
[01:46:45] <huon> *.rs
[01:46:46] <acrichto> erickt: it seems a little orthogonal, I think the usage is fine I just think that allow(usage) should be denied
[01:47:06] <huon> nrc: they traverse the AST looking for (local) bad patterns
[01:47:21] <huon> e.g. macros with bad names, or use of @-boxes.
[01:47:25] *** Joins: lpy (lpy@81B96B5C.F09091A8.1348A864.IP)
[01:47:33] <nrc> huon: great, thank you!
[01:49:59] <erickt> acrichto: so do you think we should set `default_type_params` to `allow`? Or even just remove `default_type_params`?
[01:52:29] <acrichto> erickt: declaration and usage should both be gated by default
[01:52:48] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[01:53:02] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[01:54:55] <erickt> acrichto: which should be gated, `Hash` or `Hash<S>`?
[01:55:06] <acrichto> Hash<S>
[01:55:08] <acrichto> b/c that counts as usage
[01:55:26] <acrichto> feature gates in theory can be completely removed without breaking any code not using the feature
[01:55:33] <acrichto> but right now we're breaking code if we remove default type parameters
[01:57:58] <erickt> k
[02:02:07] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:02:07] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/spgdJw
[02:02:07] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:02:24] *** Quits: blank_name (blank_name@463DB555.53526368.6D228269.IP) (Ping timeout)
[02:02:33] *** Joins: blank_name (blank_name@463DB555.53526368.6D228269.IP)
[02:05:21] <brson> i did a rollup PR https://github.com/mozilla/rust/pull/12509, my merging a bunch of PR branches into another, leaving the originals open
[02:05:30] <brson> and bors closed them all simultaneously when the rollup passed
[02:05:35] <brson> :thumbsup:
[02:06:31] *** Quits: blank_name (blank_name@463DB555.53526368.6D228269.IP) (Ping timeout)
[02:06:57] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[02:06:57] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/QiIrkQ
[02:06:57] <ghrust> 13rust/06auto 14b48833d 15Huon Wilson: Update rustc/syntax docs now that rustdoc lexes all non-`notrust` code blocks....
[02:06:57] <ghrust> 13rust/06auto 147cc6b5e 15bors: auto merge of #12510 : huonw/rust/fix-compiler-docs, r=alexcrichton...
[02:06:57] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[02:07:36] <brson> and the queue went from 62 to 56 all at once
[02:08:23] *** Joins: blank_name (blank_name@463DB555.53526368.6D228269.IP)
[02:10:48] <huon> \o/
[02:13:55] <ChrisMorgan> Yes, bors needs to be taught optimism.
[02:16:30] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:18:23] <huon> ChrisMorgan: bors is open source :P
[02:18:31] * ChrisMorgan knows
[02:18:44] * ChrisMorgan just has too many things to do â˜º
[02:21:17] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[02:21:28] *** Quits: blank_name (blank_name@463DB555.53526368.6D228269.IP) (Ping timeout)
[02:23:26] *** Joins: blank_name (blank_name@463DB555.53526368.6D228269.IP)
[02:39:37] *** Joins: tedh (tedh@moz-6F8EC49.central.biz.rr.com)
[02:47:54] *** Quits: lpy (lpy@81B96B5C.F09091A8.1348A864.IP) (Client exited)
[03:05:30] *** Parts: tedh (tedh@moz-6F8EC49.central.biz.rr.com) (Textual IRC Client: www.textualapp.com)
[03:05:32] *** Joins: tedh (tedh@moz-6F8EC49.central.biz.rr.com)
[03:09:13] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[03:09:38] *** Quits: zz_kimundi (kimundi@moz-B191E9F0.dip0.t-ipconnect.de) (Ping timeout)
[03:13:09] *** Joins: zz_kimundi (kimundi@moz-D90B8D7C.dip0.t-ipconnect.de)
[03:13:10] *** zz_kimundi is now known as kimundi
[03:19:49] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:19:49] *** ChanServ sets mode: +qo brson brson
[03:20:12] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[03:20:15] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[03:20:15] *** ChanServ sets mode: +qo brson brson
[03:21:55] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[03:21:55] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/QiIrkQ
[03:21:55] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[03:26:53] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[03:26:53] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/IV4BIA
[03:26:53] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[03:26:55] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[03:26:55] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/T5ClWA
[03:26:55] <ghrust> 13rust/06auto 14317a253 15Nick Cameron: All uses of `extern fn` should mean `extern "C" fn`. Closes #9309.
[03:26:55] <ghrust> 13rust/06auto 143c2650b 15bors: auto merge of #12328 : nick29581/rust/abi, r=alexcrichton
[03:26:55] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[03:49:46] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:01:15] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[04:22:23] <nrc> How do you search for existing issues in GitHub?
[04:23:00] <Eridius> use the search field in the upper-left
[04:23:53] <nrc> Eridius: that seems to search the code, not the meta-data
[04:24:23] <nrc> oh, I just need to wait and not hit enter
[04:24:38] <Eridius> nrc: it searches everything
[04:24:47] <Eridius> then in the results page there's a toggle for code and issues
[04:25:41] <nrc> ah yes
[04:25:57] <nrc> faith is restored in GitHub (slightly)
[04:26:03] <nrc> thanks Eridius!
[04:26:13] <Eridius> heh, don't thank me yet. Finding issues is still hard
[04:28:03] *** Joins: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP)
[04:31:55] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:32:56] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[04:33:45] *** Joins: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:33:48] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[04:35:21] *** Quits: Jesse_ (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Connection reset by peer)
[04:35:27] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[04:37:02] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[04:37:02] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/T5ClWA
[04:37:02] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[04:37:21] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[04:41:53] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[04:41:53] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/1yhfEA
[04:41:53] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[04:41:55] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:41:55] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/yRm1iQ
[04:41:55] <ghrust> 13rust/06auto 1446c59d5 15Alex Crichton: Roll std::run into std::io::process...
[04:41:55] <ghrust> 13rust/06auto 1405f50e4 15bors: auto merge of #12380 : alexcrichton/rust/run-rewrite, r=brson...
[04:41:55] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:42:07] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[05:21:09] *** Quits: limeburst (me@247D1419.D73964AC.27A8748.IP) (Ping timeout)
[05:30:43] <brson> does anybody feel comfortable reviewing emacs rust-mode https://github.com/mozilla/rust/pull/12486
[05:31:11] <cmr> hah it has tests
[05:31:13] <cmr> that's brilliant
[05:33:31] <huon> brson: I think pnkfelix has some experience in that area
[05:33:36] <huon> (I may be misremembering)
[05:35:15] <brson> nrc: fyi i didn't make any progress on #12373, making bors warn about missing issue #s in commits
[05:35:28] <brson> nrc: I was thinking of adapting github.com/jdm/highfive
[05:35:37] <brson> which servo uses for linting pull requests
[05:36:14] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[05:36:46] <brson> i'm not sure when i'll get to it - if you want it soon you may want to take a pass at it
[05:37:07] <huon> colours! http://static.rust-lang.org/doc/master/collections/hashmap/index.html :)
[05:38:06] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[05:38:08] <cmr> Seldaek: could you perhaps look at getting a nicer color scheme? <3
[05:38:45] <cmr> also why are the two & different colors O_o
[05:40:08] <ChrisMorgan> The first one is highlighted as an operator while the second is highlighted as a keyword.
[05:40:14] <ChrisMorgan> .op and .kw-2
[05:40:49] *** Joins: lpy (lpy@81B96B5C.F09091A8.1348A864.IP)
[05:40:55] * ChrisMorgan would have liked to write tests for Rust's Vim support, especially indent, but it was too depressing with how many things it makes an utter mess of
[05:43:03] *** Joins: edwardw (edwardw@ED48E813.BF27AFA4.B9C6B12A.IP)
[05:44:58] <nrc> brson: yeah, it sounds like highfive might be a way forward
[05:45:10] <nrc> brson: I'll add it to the todo list :-)
[05:46:29] <cmr> brson: we agreed to get rid of AUTHORS.txt since all of that information is available in the git history, right?
[05:46:37] <cmr> (and just distribute it in tarballs)
[05:46:53] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[05:46:53] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/wXybdA
[05:46:53] <ghrust> 13rust/06auto 14b78b749 15Alex Crichton: Remove all ToStr impls, add Show impls...
[05:46:53] <ghrust> 13rust/06auto 147d0653e 15Alex Crichton: Remove deriving(ToStr)...
[05:46:54] <ghrust> 13rust/06auto 141949163 15bors: auto merge of #12412 : alexcrichton/rust/deriving-show, r=huonw...
[05:46:56] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[05:47:52] <cmr> bjz: https://github.com/mozilla/rust/pull/12382 you updated the cheatsheet <3
[05:48:12] <bjz> yaarp
[05:48:22] <cmr> hot fuzz reference?
[05:48:42] <bjz> o_o
[05:48:49] <bjz> possibly
[05:48:53] <cmr> http://www.youtube.com/watch?v=ir1sVy9JLyo
[05:49:02] <bjz> xD
[05:49:07] <bjz> love hot fuzz
[05:49:18] <bjz> I missed out let y = format!("{}", radix(5, 3))
[05:49:25] <bjz> in the cheetsheet
[05:49:31] <bjz> will have to add it
[05:50:10] <bjz> my sadness is that radix(_, _) is not extensible outside of the std :(
[05:50:18] <bjz> will have to figure out a way
[05:51:32] <huon> bjz: traits! \o/
[05:52:17] <cmr> erickt: anything on std::hash yet?
[05:52:38] <bjz> huon: radix() is currently enabled by implementing Show on RadixFmt for various concrete types
[05:53:29] <erickt> cmr: no, unfortunately
[05:53:32] <bjz> https://github.com/bjz/rust/blob/6943acd1a50b0c4d0d95e298c151aa796ae05269/src/libstd/fmt/num.rs#L149-L153
[05:54:22] <bjz> huon: you use it like https://github.com/bjz/rust/blob/6943acd1a50b0c4d0d95e298c151aa796ae05269/src/libstd/fmt/num.rs#L135-L145
[05:55:05] <bjz> so bloody coherence gets in the way xD
[05:55:26] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[05:55:26] *** ChanServ sets mode: +ao dherman dherman
[05:56:33] <bjz> in the way of a beautifully elegant solution to our lack of a `Radix` formatter trait (which, I don't think we should add)
[05:56:53] <bjz> but yeah, will have to think of a different way
[05:57:19] <bjz> cmr: writing TWiR?
[05:57:22] <cmr> yup
[05:58:06] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Client exited)
[05:58:42] <brson> cmr: no, we did not agree to get rid of AUTHORS.txt
[05:59:01] <cmr> don't know what I'm remembering then
[05:59:16] *** Joins: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net)
[05:59:45] <brson> i think some people were ok with generating it from git for distro in the tarballs, which may have been what you just said
[06:00:21] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Connection reset by peer)
[06:00:23] <cmr> https://github.com/mozilla/rust/wiki/Meeting-weekly-2013-09-24#wiki-authorstxt
[06:01:11] <cmr> https://github.com/mozilla/rust/issues/5037#issuecomment-25029146
[06:01:15] <cmr> those are what I was thinking of
[06:01:26] *** Joins: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net)
[06:01:57] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Connection reset by peer)
[06:06:02] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[06:06:53] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[06:06:54] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/sr3rnQ
[06:06:54] <ghrust> 13rust/06auto 14a9bd447 15Alex Crichton: Roll std::run into std::io::process...
[06:06:54] <ghrust> 13rust/06auto 14a5342d5 15bors: auto merge of #12380 : alexcrichton/rust/run-rewrite, r=brson...
[06:06:54] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:06:54] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[06:06:54] <ghrust> [13rust] 15bors 04force-pushed 06auto from 141949163 to 143c2650b: 02http://git.io/N3iJvQ
[06:06:54] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[06:08:44] *** Joins: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro)
[06:09:21] <cmr> Do we care about https://github.com/mozilla/rust/issues/414 anymore?
[06:10:16] <huon> Fuzzers are pretty good for finding bugs
[06:12:28] *** Quits: Guest_ (textual@16F167B.4C57D258.D8E8354F.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[06:15:01] <bjz> Is that like quickcheck?
[06:15:06] <cmr> no not at all.
[06:15:12] <cmr> much more stupid.
[06:15:16] <cmr> https://en.wikipedia.org/wiki/Fuzz_testing
[06:15:49] * bjz wishes for associated items
[06:15:52] <bjz> :(
[06:16:37] <eddyb> need an official wishing well
[06:17:23] <bjz> need it for `trait Ieee754` not to be unweildy
[06:18:29] <bjz> `fn foo<LB, I, T: Ieee754<LB, I>>(x: T)` - ick
[06:18:50] * ChrisMorgan agrees with "ick"
[06:19:02] <huon> 'LB'?
[06:19:06] <huon> and I?
[06:19:11] <bjz> pub trait Ieee754<LogBFormat, IntegralFormat>
[06:19:41] <huon> For the stdlib, I think binary32 and binary64 are the only ones that need modelling
[06:19:45] <huon> for now at least
[06:20:21] *** Quits: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca) (Quit: canhtak)
[06:20:23] <bjz> but still, they have separate LogBFormat and IntegralFormat types
[06:20:26] <bjz> no?
[06:20:33] <bjz> I could be wrong
[06:20:49] *** Joins: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net)
[06:20:57] <huon> oh, for frexp?
[06:21:01] <huon> yeah, I guess so :(
[06:21:10] <bjz> scaleb
[06:21:13] <bjz> logb
[06:21:20] <bjz> convertToIntegerTiesToEven
[06:21:31] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Connection reset by peer)
[06:21:36] <bjz> rootn
[06:21:39] <huon> bjz: btw, do you have a copy of the IEE754-2008 standard? (you can probably get it through your university library, if you still have access to that.)
[06:21:45] <bjz> yep, I do
[06:21:50] <huon> yeah, I guess so :(
[06:21:52] <huon> (cool)
[06:21:55] <bjz> pown
[06:22:24] <huon> Isn't logb -> Self?
[06:22:27] <bjz> fn scaleB(self, n: LogBFormat) -> Self;
[06:22:27] <bjz> fn logB(self) -> LogBFormat;
[06:22:27] <bjz> fn compound(self, n: LogBFormat);
[06:22:27] <bjz> fn rootn(self, n: LogBFormat) -> Self;
[06:22:27] <bjz> fn pown(self, n: LogBFormat) -> Self;
[06:22:34] <bjz> I think
[06:22:39] <bjz> I'll ckeck
[06:22:48] <huon> man logb says double logb(double), etc.
[06:22:56] <huon> for me, at least.
[06:23:09] <huon> I guess the libc routine doesn't necessarily follow IEEE754
[06:23:33] <eddyb> cmr: how's the pentacent bench marathon going :P?
[06:23:59] <cmr> eddyb: I interrupted it to play 32 hours of video games this weekend (sorry)
[06:24:07] <eddyb> hehe
[06:24:28] <huon> heh, a search for "pown ieee754" turns up https://gist.githubusercontent.com/jensnockert/4719287/raw/10e127eda87bd9a784b140298ec9130e4d28a08e/ieee754.rs as the 4th result
[06:24:44] <bjz> haha
[06:24:56] <bjz> might be your search history affecting it
[06:24:58] <huon> cmr: only 32 hours? what were you *wasting* the other 16 on??
[06:25:00] <cmr> huon: want to kick irsy while you're around? it's been rebenching... everything.
[06:25:11] <cmr> huon: don't forget friday night too!
[06:25:14] <huon> cmr: how far back?
[06:25:14] <cmr> but yes.
[06:25:21] <cmr> huon: I deleted the last 500
[06:25:29] <bjz> hmm
[06:25:31] <huon> ok
[06:25:34] <huon> I'll do that when I get home
[06:25:36] <bjz> logB(x) is the exponent e of x, a signed integral value, determined as though x were represented with infinite range and minimum exponent. Thus 1 â‰¤ scaleB(x, âˆ’logB(x)) < b when x is positive and finite.
[06:25:38] <cmr> thanks
[06:25:54] <bjz> "When logBFormat is a floating-point format, logB(NaN) is a NaN, logB(âˆž) is +âˆž, and logB(0) is âˆ’âˆž and signals the divideByZero exception. When logBFormat is an integer format, then logB(NaN), logB(âˆž), and logB(0) return language-defined values outside the range Â±2 Ã— (emax + p âˆ’ 1) and signal the invalid operation exception."
[06:26:10] <bjz> so LogB can change for a single type?
[06:26:19] <bjz> I mean logBFormat
[06:26:33] <bjz> or single function implementation
[06:26:50] <eddyb> https://github.com/mozilla/rust/pull/12492 woo
[06:27:00] <eddyb> so what now?
[06:27:07] <huon> bjz: what do you mean?
[06:27:37] <cmr> eddyb: make rustc use a cheaper hash :)
[06:27:45] <sfackler> that's weird
[06:27:45] <bjz> "For each supported arithmetic format, languages define an associated logBFormat to contain the integral values of logB(x). The logBFormat shall have enough range to include all integers between Â±2Ã—(emax+p) inclusive, which includes the scale factors for scaling between the finite numbers of largest and smallest magnitude."
[06:27:52] <bjz> "If logBFormat is an integer format, then the first operand and the floating-point result of scaleB are of the same format. If logBFormat is a floating-point format, then the following operations are homogeneous."
[06:27:55] <eddyb> cmr: I'm guessing HashMap isn't fully integrated yet
[06:27:59] <sfackler> if I have a loop label with the same name as a variable, I can't reference the variable
[06:28:02] <bjz> hmm
[06:28:19] <huon> bjz: it's just nonspecific about what the precise type used is
[06:28:24] <bjz> yeah
[06:28:27] <eddyb> sfackler: needs more namespaces
[06:28:28] <huon> it still has to be fixed for a given `source`
[06:28:33] <bjz> ah
[06:28:35] <edwardw> r? https://github.com/mozilla/rust/pull/12508
[06:28:37] <huon> sfackler: there's a bug about that, iirc
[06:28:57] <bjz> huon: would probably be better for it to be an integer
[06:29:17] <edwardw> huon: link to loop label vs. variable name?
[06:29:20] <sfackler> huon: it just showed up today looks like
[06:29:32] <sfackler> code that used to compile no longer does
[06:29:48] <huon> sfackler: oh, oops
[06:29:52] <sfackler> https://github.com/sfackler/rust-phf/commit/340c9342c224cd3a2f30ba1e4416c0ef632cb0b3#diff-07dab54936a5927f87ef6fab5253efd4L210
[06:29:57] * huon points at edwardw ;P
[06:30:09] <edwardw> hehe
[06:30:25] <huon> sfackler: file one, then
[06:30:34] <huon> bjz: that would be more "controlled", yeah
[06:31:07] <bjz> "In the operation descriptions that follow, languages define which of their types correspond to operands and results called int, intFormatOf, characterSequence, or conversionSpecification. Languages with both signed and unsigned integer types should support both signed and unsigned int and intFormatOf operands and results."
[06:31:25] <bjz> So is intFormatOf generic for the operation?
[06:31:55] <bjz> fn convertToIntegerTiesToEven<IntFormatOf>(self) -> IntFormatOf;
[06:32:12] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[06:32:15] <bjz> yay interpreting specs \o/
[06:32:34] <Yurume> bjz: make that an executable semantics :p
[06:32:34] <huon> find another implemention of IEEE754
[06:32:47] <bjz> Yurume: ?
[06:33:54] <Yurume> bjz: half joking, nevermind
[06:34:26] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[06:35:22] *** Joins: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net)
[06:35:25] <bjz> hmm, I think "intFormatOf indicates that the name of the operation specifies the integer destination format" means that you can implement it generically (section 5.1)
[06:36:19] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[06:36:23] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Connection reset by peer)
[06:36:27] *** Joins: arrrrrrr1 (arrrrrrrrr@moz-53AF4C1C.dynamic.qsc.de)
[06:37:18] <bjz> `integralFormat` seems to only be used on vector operations
[06:38:00] <huon> bjz: the length of the vector
[06:38:05] <bjz> yep
[06:38:09] <bjz> uint?
[06:38:13] <huon> yup
[06:38:36] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[06:38:37] <huon> btw, I'm not sure a full Ieee754 trait is appropriate for libstd
[06:38:50] <eddyb> libnum?
[06:38:54] <bjz> yeah, dunno
[06:39:01] <bjz> at least in the short term
[06:39:17] <bjz> eddyb: I have the Iee754 trait in num-rs atm
[06:39:42] <huon> bjz: btw, http://www.netlib.org/fdlibm/ and http://www.jhauser.us/arithmetic/SoftFloat.html are apparently software impls of the spec
[06:39:51] <bjz> yeah
[06:40:11] <bjz> I think jensnockert ported SoftFloat on his fork
[06:40:20] <huon> oh, awesome
[06:40:33] * huon should help on ieee754-rs
[06:40:46] <bjz> huon: I think on num-rs for now
[06:40:51] <bjz> you are welcome too
[06:41:33] <bjz> is there a way of merging num-rs into rust whilst keeping the history?
[06:42:05] <bjz> or maybe ieee754 should be a separate lib
[06:42:07] <bjz> dunno
[06:42:17] <huon> I think you can merge history like that
[06:42:22] <huon> you can certainly split it out
[06:42:23] * huon shrugs
[06:42:29] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[06:42:41] <eddyb> you could probably merge the two repos
[06:43:01] <eddyb> after moving num-rs code to the right spot
[06:43:16] <bjz> eddyb: yeah
[06:43:32] <bjz> move it into the right directory, then merge
[06:47:10] <cmr> there's some sort of filter-branch magic
[06:47:25] <cmr> linus once made a writeup on some crazy history merging he did
[06:47:29] <cmr> but I can never find it when I want it :(
[06:47:56] *** Joins: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net)
[06:48:39] <sfackler> filter branch is great
[06:48:58] <sfackler> bjz: i've done it before, but it's a bit weird to do
[06:49:36] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Ping timeout)
[06:49:40] <sfackler> you basically add num-rs as a new remote, fetch, check it out into a new branch, filter-branch it to move it to the right place and then rebase
[06:49:50] <sfackler> or just merge
[06:51:39] <bjz> makes sense
[06:51:47] <bjz> ish
[06:52:26] <bjz> the num-rs history is a little ugly though
[06:52:33] <bjz> might have to clean it up :/
[06:53:21] <bjz> I just think it would pay to keep a place to experiment before merging it in
[07:00:17] *** Quits: limeburst (me@247D1419.D73964AC.27A8748.IP) (Quit: leaving)
[07:00:22] *** Joins: limeburst (me@247D1419.D73964AC.27A8748.IP)
[07:00:27] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[07:00:40] <bjz> :/
[07:00:47] <bjz> how does one download http://www.netlib.org/fdlibm/?
[07:01:04] <Yurume> wget -r?
[07:01:47] <huon> bjz: http://www.validlab.com/software/
[07:01:50] <huon> maybe
[07:02:19] <bjz> oh http://gnuwin32.sourceforge.net/packages/fdlibm.htm
[07:04:06] <klutzy> https://android.googlesource.com/platform/external/fdlibm.git
[07:10:17] *** Quits: huon (Thunderbir@B11C0778.D5A1DCF.37681C44.IP) (Quit: huon)
[07:10:28] <edwardw> sfackler: #12512 confirmed. it is bad :(
[07:10:53] *** Joins: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net)
[07:11:21] <eddyb> "error: cannot apply unary operator `!` to type `Self`"
[07:11:36] <eddyb> so I fix my issue with operator overloads coming from bounds
[07:11:50] *** Quits: notmatt_ (notmatt@moz-9FB2565E.vc.shawcable.net) (Connection reset by peer)
[07:12:51] <eddyb> and there is just one occurrence in libstd where an operator overload is used from Self (probably in one of those integer traits)
[07:14:21] <eddyb> Bitwise::count_zeros
[07:15:50] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[07:16:57] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[07:16:57] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/sr3rnQ
[07:16:57] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[07:17:01] <acrichto> has anyone gotten emails from travis about builds failing/passing?
[07:17:37] <eddyb> if it does that, I'll have to tiptoe around it
[07:17:43] <eddyb> no more WIP PRs
[07:17:59] <acrichto> hm, I'll take that as a no
[07:18:03] <acrichto> that makes me sad :(
[07:19:14] <eddyb> I was getting mails from travis for eddyb/radare2
[07:19:29] <eddyb> but not from yesterday, no
[07:19:31] <acrichto> maybe travis doesn't email about PRs
[07:19:34] <acrichto> only pushes?
[07:19:43] * acrichto reads some more docs
[07:19:59] <eddyb> oh yeah, the mails I have are from pushes to my fork
[07:20:07] <acrichto> https://github.com/travis-ci/travis-ci/issues/1417
[07:20:07] <acrichto> oh
[07:21:50] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[07:21:50] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/7gdT7Q
[07:21:50] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[07:21:50] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[07:21:51] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/pR-d1Q
[07:21:51] <ghrust> 13rust/06auto 14b78b749 15Alex Crichton: Remove all ToStr impls, add Show impls...
[07:21:51] <ghrust> 13rust/06auto 143d1a53b 15Alex Crichton: Remove deriving(ToStr)...
[07:21:51] <ghrust> 13rust/06auto 14064f337 15bors: auto merge of #12412 : alexcrichton/rust/deriving-show, r=huonw...
[07:21:53] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[07:24:43] <bjz> wow, much warnings, much static analysis problems in fdlibm
[07:24:56] <bjz> :P
[07:26:09] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[07:27:37] <eddyb> nobody fixed src/librustc/middle/typeck/check/method.rs not being pulled in rustc deps?
[07:32:44] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[07:36:25] <eddyb> cmr: what is going on here? http://huonw.github.io/isrustfastyet/mem/
[07:37:37] <eddyb> kind of a big jump
[07:39:00] *** Quits: bytbox (s@moz-E1E7FAC3.washdc.fios.verizon.net) (Ping timeout)
[07:42:10] *** Joins: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[07:42:56] *** flaper87|afk is now known as flaper87
[07:49:44] <edwardw> to fix #12512, I feel like I must add a new AST node and then add a new visit_* or fold_* method to traits that traverse an AST. is that too big a change to propose?
[07:50:07] <eddyb> what would that node be?
[07:50:19] <edwardw> simply Label
[07:50:27] <edwardw> inside it a Ident
[07:50:53] <edwardw> so that I can distinguish it from normal Ident
[07:51:36] <eddyb> I don't like that approach
[07:52:06] <eddyb> a "normal" Ident can already be in one of 3 namespaces + named lifetimes
[07:52:08] <edwardw> yeah, me neither. but I simply can't see other ways to do so
[07:52:27] <edwardw> yep, Path and Lifetime
[07:52:52] <edwardw> PathSegment to be precise
[07:53:26] <eddyb> what piece of code would need this distinction for labels?
[07:53:52] <edwardw> if a variable name and a label name are the same
[07:54:07] <eddyb> a type can't conflict with a variable name
[07:54:28] <edwardw> label name is not a type, it is already a Ident now
[07:54:47] <edwardw> only that it is part of ExprLoop/ExprForLoop and ExprBreak/ExprAgain
[07:54:49] <eddyb> I'm just saying, they shouldn't clash in resolve at all
[07:55:03] <eddyb> just like types and variables don't clash
[07:55:11] <edwardw> they didn't, yes
[07:55:20] <edwardw> but not after being renamed
[07:55:22] * flaper87 is so happy to see travis doing its job
[07:56:14] <eddyb> edwardw: then the renaming is wrong
[07:56:46] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[07:56:49] <eddyb> you're not going to fix much by just having labels considered that different from Idents
[07:57:04] <edwardw> eddyb: it is wrong.
[07:57:22] <edwardw> to fix it, I need a way to distinguish labels from variable names
[07:57:52] <eddyb> I guess we only perform renaming in one of 4 namespaces
[07:58:14] <edwardw> not after my hygiene label patch landed :)
[07:58:26] <eddyb> *performed
[07:58:27] <edwardw> which also introduces the name clashing bug
[07:59:20] * edwardw sighs
[08:00:06] <eddyb> bleah, this kinda introduces the need for more resolve-like logic in expansion
[08:00:34] <eddyb> we could intertwine then, but that would cause all sorts of weird things
[08:00:42] <eddyb> *them
[08:00:56] <edwardw> eddyb: it already did https://github.com/mozilla/rust/issues/12512
[08:01:15] *** Joins: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP)
[08:01:25] <eddyb> mkay, so what I would do instead, is have more renaming kinds
[08:01:29] <eddyb> one for each namespace
[08:02:00] <edwardw> exactly, that's why I'm thinking of having a Label AST node
[08:02:19] <eddyb> so you can have <'a, a: Default> let mut a: a; 'a loop {a = Default::default();}
[08:02:24] <eddyb> with renaming in all namespaces
[08:02:50] <eddyb> edwardw: from what I understand, you want renaming triggered by `let` to not affect labels
[08:03:04] <edwardw> eddyb: correct
[08:03:11] <eddyb> what I'm saying is to apply the renames anyway
[08:03:29] <eddyb> but have two different kinds of renames
[08:03:51] <edwardw> not there's only one, namely to rename Ident
[08:03:56] <edwardw> not -> now
[08:04:04] <eddyb> and resolve will query the correct type, causing other renames to be ignored
[08:04:25] <eddyb> edwardw: they all would operate on Ident's
[08:05:04] <eddyb> edwardw: I'm talking about SyntaxContext_
[08:05:21] <eddyb> Rename (Ident,Name,SyntaxContext)
[08:05:33] <eddyb> you would have a RenameLocal, RenameLabel
[08:05:49] <eddyb> and in the future, RenameType, RenameLifetime and maybe even RenameMod
[08:06:07] <eddyb> you can put a RenameLocal on a label or lifetime
[08:06:13] <eddyb> resolve will just ignore it
[08:07:27] <edwardw> I don't see how that would work if everything is Ident in the end
[08:07:44] <edwardw> think the way recursive traverse works
[08:08:21] <edwardw> the very leaf of it would be a Ident; it can't tell itself living inside a label or var names
[08:08:34] <eddyb> yes
[08:08:41] <edwardw> so it has no choice but to apply the renaming
[08:08:53] <eddyb> *record* the renaming
[08:09:02] <eddyb> expansion doesn't rename anything
[08:09:06] <eddyb> it just records renames
[08:09:32] <eddyb> take a look at resolve_internal in ast_util, that's where the magic happens, and it's triggered from resolve
[08:10:07] *** Quits: lpy (lpy@81B96B5C.F09091A8.1348A864.IP) (Client exited)
[08:10:09] <eddyb> (now that I think of it, more SyntaxContext_ variants will be harder than having another field in the Rename variant, like a RenameKind)
[08:10:51] <edwardw> that's another way to introduce namespaces for renaming
[08:11:00] <eddyb> mhmm
[08:11:05] <eddyb> and it's future-proof
[08:11:37] <edwardw> so you like this idea more than a Label AST node, yes?
[08:11:44] <eddyb> (I don't like it for other reasons, but it's the least threatening evil IMO)
[08:12:03] <edwardw> a Label node is kind evil, lol
[08:12:49] <eddyb> edwardw: well, yeah, I like how rename kinds can work even with namespaces, where just the AST shape won't help
[08:13:26] <eddyb> and/or would require duplicating resolve logic in expansion
[08:13:58] <eddyb> edwardw: but it warrants a discussion with more than just the two of us
[08:14:49] <edwardw> sounds reasonably. let me sleep on the ideas and come up with a gist for further discussion
[08:16:55] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[08:16:55] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/gaDdyw
[08:16:55] <ghrust> 13rust/06auto 148985373 15Brian Anderson: std: Make atomics immutable. #11583...
[08:16:55] <ghrust> 13rust/06auto 14bea97a0 15bors: auto merge of #12430 : brson/rust/atomics, r=alexcrichton
[08:16:56] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[08:18:24] *** Joins: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net)
[08:18:26] *** Quits: edwardw (edwardw@ED48E813.BF27AFA4.B9C6B12A.IP) (Quit: Leaving...)
[08:18:54] *** Joins: edwardw (Mibbit@ED48E813.BF27AFA4.B9C6B12A.IP)
[08:19:07] *** Parts: edwardw (Mibbit@ED48E813.BF27AFA4.B9C6B12A.IP) ()
[08:23:20] <eddyb> <anon>:1:105: 1:108 error: binary operation `*` cannot be applied to type `&T`
[08:23:51] <huon> eddyb: is that good thing?
[08:24:07] <eddyb> huon: it's the testcase in https://github.com/mozilla/rust/issues/12402
[08:24:19] <eddyb> and everything compiles fine
[08:26:08] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:26:38] <huon> \o/
[08:26:40] <huon> wesome
[08:26:52] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[08:26:52] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14bea97a0 to 14a5342d5: 02http://git.io/N3iJvQ
[08:26:52] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[08:26:53] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[08:26:53] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/cYcV-w
[08:26:53] <ghrust> 13rust/06auto 14b78b749 15Alex Crichton: Remove all ToStr impls, add Show impls...
[08:26:53] <ghrust> 13rust/06auto 148761f79 15Alex Crichton: Remove deriving(ToStr)...
[08:26:54] <ghrust> 13rust/06auto 145ae9cfa 15bors: auto merge of #12412 : alexcrichton/rust/deriving-show, r=huonw...
[08:26:56] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[08:29:45] <eddyb> I don't like having an issue number in the commit because every commit every shows up on the issue page in question
[08:29:49] <eddyb> and it can be confusing :S
[08:31:03] *** Quits: glaebhoerl_ (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[08:35:36] *** Joins: Guest (textual@16F167B.4C57D258.D8E8354F.IP)
[08:37:21] <eddyb> huon: r? https://github.com/mozilla/rust/pull/12493
[08:37:26] <eddyb> (enough commits for you?)
[08:37:41] * huon hopes there's > 30
[08:37:50] <huon> gah, only 4! pathetic :P
[08:40:40] <huon> eddyb: I can look over it, but I don't know how that code works, sorry :)
[08:40:57] <eddyb> well, travis will tell us if I broke anything else
[08:41:15] * huon -> dinner
[08:41:55] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[08:41:55] <ghrust> [13rust] 15bors pushed 6 new commits to 06auto: 02http://git.io/dkfEeg
[08:41:56] <ghrust> 13rust/06auto 14768b96e 15Huon Wilson: green: remove ancient register-saving code....
[08:41:56] <ghrust> 13rust/06auto 1406e3e63 15Huon Wilson: flate: return CVec<u8> rather than copying into a new vector....
[08:41:56] <ghrust> 13rust/06auto 148b246fd 15Huon Wilson: green,native,rustuv: Replace many pointer `transmute`'s with `as` or referencing....
[08:41:58] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[08:41:58] <eddyb> huon: it takes all the available traits, looks in all of them (and their supertraits) for a method with the right name and pushes it in a list of candidates
[08:42:04] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:42:24] <eddyb> the tricky part is looking in trait bounds, but not picking anything from a trait other than the one you want
[08:43:57] <Seldaek> cmr: hm yeah that color scheme isn't great, but right now no time, writing it on the bottomless todo list :P
[08:53:03] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[08:53:08] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[08:53:48] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[08:56:50] <eddyb> "Watch out for a type like `enum t = @t`" what?
[09:06:32] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[09:07:05] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[09:15:03] <eddyb> let x = RefCell::new(0); *x.borrow_mut() = 4; print!("{:?} ", *x.borrow()); *x.borrow_mut() *= 3; println!("{:?}", *x.borrow());
[09:15:05] <eddyb> mm, lovely
[09:23:24] <ChrisMorgan> eddyb: soon to be `let x = RefCell::new(0); **x = 4; print!("{:?} ", **x); **x *= 3; println!("{:?}", **x);`?
[09:24:16] * ChrisMorgan will be glad to be rid of all [or at least most] of this `x.borrow().borrow_mut().get().borrow().borrow()` business
[09:28:23] *** Joins: glaebhoerl_ (glaebhoerl@moz-8E9FCD9A.pool.telenor.hu)
[09:31:27] *** Joins: aepsil0n (ebopp@moz-DFDD087A.ita.uni-heidelberg.de)
[09:38:09] *** Quits: glaebhoerl_ (glaebhoerl@moz-8E9FCD9A.pool.telenor.hu) (Ping timeout)
[09:38:50] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[09:38:50] <ghrust> [13rust] 15huonw 04force-pushed 06try from 1423c3770 to 149e8d5aa: 02http://git.io/k471pw
[09:38:50] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[09:39:37] *** Joins: glaebhoerl_ (glaebhoerl@moz-8E9FCD9A.pool.telenor.hu)
[09:41:30] * huon cries
[09:41:36] <huon> this PR will never land :(
[09:41:54] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[09:41:54] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/KyjH5Q
[09:41:54] <ghrust> 13rust/06auto 14dce87e5 15Alex Crichton: Move extra::json to libserialize...
[09:41:54] <ghrust> 13rust/06auto 14454a4d5 15bors: auto merge of #12453 : alexcrichton/rust/move-json, r=brson...
[09:41:54] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[09:41:58] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[09:41:58] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14e6663fc to 14a5342d5: 02http://git.io/N3iJvQ
[09:41:58] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[09:42:01] <huon> eddyb: I don't know the specifics of the code, so I can't tell if the implementation is "good" :)
[09:44:57] <eddyb> ChrisMorgan: sadly, no
[09:46:06] <eddyb> but for Rc<RefCell<HashMap<K, V>>>, x.borrow().borrow_mut().get().insert(k, v) will become x.borrow_mut().insert(k, v)
[09:46:48] <eddyb> huon: np, I just hope it won't bitrot there
[09:47:21] *** Quits: glaebhoerl_ (glaebhoerl@moz-8E9FCD9A.pool.telenor.hu) (Ping timeout)
[09:47:41] <huon> eddyb: it's not even 500 lines, it's fine :P
[09:48:42] <eddyb> actually, I care just because my deref fiddlings are on top of it
[09:49:57] *** Joins: glaebhoerl_ (glaebhoerl@moz-8E9FCD9A.pool.telenor.hu)
[09:53:00] <huon> eddyb: btw, the travis build failed
[09:53:30] <huon> heh, removing the `do` error message sunk you :P
[09:53:39] *** Quits: glaebhoerl_ (glaebhoerl@moz-8E9FCD9A.pool.telenor.hu) (Ping timeout)
[09:54:20] <eddyb> of course it did *sigh*
[09:55:36] <ChrisMorgan> eddyb: why can't it end up with all the borrow() and borrow_mut() gone?
[09:55:51] <ChrisMorgan> Is it just borrow_mut() not being tied together yet?
[09:56:28] <eddyb> borrow/borrow_mut return "handles"
[09:56:46] <eddyb> .get() on those can go away with DerefImm/DerefMut
[09:57:07] <huon> ChrisMorgan: please don't remove the explicit .borrow_mut() from RefCell :S
[09:57:15] <eddyb> but creating the handles themselves would be tricky
[09:57:19] <huon> the implicit borrows were part of the problem with @mut
[09:57:40] <ChrisMorgan> eddyb: so where did the .borrow() go in your line?
[09:58:09] <eddyb> Rc's .borrow() would go away
[09:58:28] <ChrisMorgan> So *some* borrow()s, but not all, will go away?
[09:58:33] <eddyb> yeah
[09:58:47] <eddyb> RefCell's borrow could also go away, if we make DerefImm very flexible
[09:59:14] <eddyb> and don't require it to return a &T
[09:59:44] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[10:00:05] <eddyb> but borrow_mut is not only hard to figure where to call, but also a footgun people want to keep explicit
[10:00:40] <ChrisMorgan> I thought that making it &mut *, *x OP= â€¦, &c. would be sufficient?
[10:01:38] <eddyb> those are for explicit dereferences
[10:02:04] <eddyb> borrow_mut is mostly used in .borrow_mut().get().method(...)
[10:02:17] * ChrisMorgan will just shut up and wait to see how it turns out â˜º
[10:02:48] * eddyb does the same and goes back to implementing it in adjustments. yay moar callee_id >_>
[10:07:52] <eddyb> huon: hmm, I don't get a notification
[10:08:10] <huon> eddyb: of travis failures?
[10:08:14] <eddyb> yeah
[10:08:22] <huon> yeah, it's travis bug
[10:08:32] <eddyb> https://travis-ci.org/mozilla/rust/pull_requests hehe
[10:08:38] <eddyb> they're piling up
[10:09:04] <eddyb> huon: I know about mails not being sent, I guess github notifications go under the same bug?
[10:09:10] <huon> eddyb: https://github.com/travis-ci/travis-ci/issues/1417
[10:09:19] <huon> oh, yeah, I guess so
[10:09:40] * huon will always be #1 rust travis build :P
[10:09:59] <huon> not quite the first passing one though...
[10:10:12] <eddyb> huon: now how do I amend the first of those 4 commits?
[10:10:13] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[10:10:27] <huon> eddyb: make a new commit and squash it via rebase -i
[10:10:30] <huon> is what I do
[10:10:30] <eddyb> that's one of the reasons I don't split changes into multiple commits :/
[10:10:42] <eddyb> huon: mkay, thanks
[10:10:48] <eddyb> (first time doing rebase -i)
[10:10:53] <huon> <3 rebase -i
[10:18:56] <eddyb> I wonder if I can use HEAD~1 with --onto
[10:19:14] <eddyb> would help with transplanting the wip commits
[10:19:54] <huon> <3 rebase -i
[10:20:37] <pcmattman> <3 rebase -i
[10:20:55] <bjz> <3 rebase -i
[10:21:01] <flaper87> <3 rebase -i
[10:21:06] <pcmattman> (I don't know what we're talking about but 'rebase -i' is the reason I can't stand using mercurial at work :P)
[10:21:15] * huon gets down on one knee: rebase -i, will you marry me?
[10:21:41] <flaper87> lol
[10:21:41] <huon> pcmattman: we're talking about rebase -i
[10:21:56] <huon> in case you didn't realise :P
[10:22:15] <eddyb> is there any GUI for it?
[10:22:24] <pcmattman> vim
[10:22:52] <huon> emacs
[10:23:01] <huon> <3 magit's rebase -i
[10:25:38] <eddyb> "use commit, but stop for amending"
[10:25:42] <eddyb> what does that mean?
[10:27:32] <ChrisMorgan> eddyb: make the commit, but do not continue merging until you rebase --continue: you can then go back to the commit and amend it with commit --amend.
[10:28:11] <huon> eddyb: you want `f` if you just wish to squash it straight into the parent
[10:28:19] <eddyb> while rebasing, git gui lets me stage arbitrary things
[10:28:20] <pcmattman> (without changing the commit message)
[10:28:42] <eddyb> huon: no, I want to modify the commit at the bottom of the stack :P
[10:29:01] <huon> isn't that just commit --amend without rebase -i?
[10:29:20] <eddyb> can I amend a commit that's not HEAD?
[10:29:22] <huon> oh, your bottom is the other way around/
[10:29:24] <huon> ?
[10:29:27] <huon> how confusing
[10:29:30] <eddyb> dammit, terminologies
[10:29:33] <eddyb> HEAD~4
[10:29:43] <huon> (the one true rebase -i shows older commits lower :P )
[10:30:00] <huon> erm
[10:30:02] <huon> newer commits
[10:30:13] <huon> whoops
[10:30:32] <eddyb> git config --global core.editor kwrite
[10:30:41] <pcmattman> git rebase -i HEAD~5, modify the one at HEAD~4, sorted
[10:30:42] <huon> eddyb: yeah either the amending one, or just make a new commit and then `f` it into the original one
[10:31:04] *** Quits: aepsil0n (ebopp@moz-DFDD087A.ita.uni-heidelberg.de) (Ping timeout)
[10:31:20] <pcmattman> a fixup commit is the easiest way to do the 'modify the one at HEAD~4'
[10:31:34] <eddyb> can I change the order?
[10:31:47] <huon> yes
[10:31:53] <eddyb> okay, that makes sense :D
[10:31:57] <huon> just reorder the lines if you're in a text editor
[10:32:14] <huon> eddyb: btw, re decompilers: http://dagger.repzret.org/update-feb-2014/ goes from machine code -> IR, apparently
[10:32:32] <huon> (from http://llvmweekly.org/issue/8 )
[10:32:40] <eddyb> huon: mine started in december 2012 *sigh*
[10:33:15] <eddyb> git rebase -i + a GUI editor => not bad :D
[10:34:27] <huon> eddyb: yeah, just pointing out some similar work; not saying it's better or worse than yours :)
[10:34:50] <eddyb> someone told me about dagger when it was first announced
[10:35:29] <eddyb> it could very well become much better, considering the amount of time I put into wiREd :/
[10:35:47] <huon> oh, ok
[10:36:56] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[10:36:56] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14454a4d5 to 14a5342d5: 02http://git.io/N3iJvQ
[10:36:56] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[10:36:59] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[10:36:59] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/TfcJnA
[10:36:59] <ghrust> 13rust/06auto 14b9d7f01 15OGINO Masanori: Exclude build metadata from equality checking....
[10:36:59] <ghrust> 13rust/06auto 147e60fc6 15bors: auto merge of #12454 : omasanori/rust/semver-eq, r=alexcrichton...
[10:37:00] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[10:38:20] <eddyb> git rebase --onto saner-overloads HEAD~1 deref
[10:38:39] <eddyb> okay, that worked, easier than looking up the commit hash >_>
[10:40:56] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[10:42:27] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 30.0a1/20140222030204])
[10:42:47] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[10:46:10] <eddyb> /// Convert from @fn()/~fn()/|| to ||
[10:46:16] <eddyb> I wonder what that does now
[10:46:45] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[10:47:36] <eddyb> it can coerce proc to ||, that's not good
[10:51:28] *** Joins: aepsil0n (ebopp@moz-EF530DCB.ita.uni-heidelberg.de)
[10:52:25] <huon> heh, there's a bug about that, iirc
[10:54:53] *** kimundi is now known as zz_kimundi
[10:55:02] <eddyb> so many things I can fix :P
[10:55:28] <huon> \o/
[10:55:36] <huon> so many individual commits you can make :P
[10:57:27] *** Quits: mawuli (mawuli@moz-36C70B7D.com.gh) (Client exited)
[10:58:05] <eddyb> this is pretty out of scope
[10:58:36] <huon> new PR, then
[11:00:46] <eddyb> huon: too much nesting in my brain!
[11:02:02] <huon> I know
[11:02:15] <eddyb> oh, I see this failing badly cross-PR
[11:02:18] <huon> just squash the whole rust history into a single commit, and open that as  PR :P
[11:02:32] <eddyb> s/PR/cross
[11:02:35] <eddyb> dammit
[11:02:40] <eddyb> *cross-crate
[11:05:08] <huon> those corrections amounted to 'cross-cross-crate', right? :P
[11:05:20] <eddyb> x-x-c
[11:06:11] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[11:07:11] <eddyb> pub type node_type_table = RefCell<HashMap<uint,t>>;
[11:07:32] <eddyb> lol, this wasn't using NodeId and nobody noticed?
[11:08:03] <eddyb> there are casts, probably added by me a few months back. oops
[11:08:04] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[11:08:09] *** arrrrrrr1 is now known as arrrrrrrrr
[11:16:44] *** Joins: glaebhoerl_ (glaebhoerl@moz-3590251D.kabelnet.hu)
[11:19:28] <nmatsakis> eddyb: re: explicit deref being mutable, that is incorrect, thanks to autoref, but it's the only thing I'd expect to work at a first pass
[11:19:52] *** Quits: Diamond (dick@moz-80556682.ks.ks.cox.net) (Quit: Leaving.)
[11:20:00] <eddyb> nmatsakis: huh?
[11:20:15] <eddyb> do you mean there's more cases than &mut *x, *x = y and *x OP= y?
[11:20:15] <nmatsakis> huon: (those ```nonrust...``` fences look fine to me)
[11:20:59] <nmatsakis> eddyb: yes, I do, e.g., (*map).insert(key, val)
[11:21:12] <eddyb> riiight
[11:21:38] <nmatsakis> but there's a kind of chicken-and-egg problem there
[11:22:34] <huon> nmatsakis: ok (just wanted to make sure you didn't come back to it and be surprised by the mutilation of your formatting :) )
[11:23:04] <eddyb> I'm pretty sure I know how to trigger DerefImm on x for x.foo and x.foo(...), my fix for overloading ops should help with that
[11:25:06] <eddyb> nmatsakis: chicken-and-egg with deref being applied and resolving the method signature that tells us whether it's &mut self or &self?
[11:26:06] <eddyb> ohh, I know how we can use the branching-on-mutability idea here
[11:27:14] <eddyb> nmatsakis: when looking up methods, at each deref level, branch on mutability and only consider methods that take the exact version of &self/&mut self
[11:27:27] <eddyb> this shouldn't record more candidates
[11:27:44] <eddyb> but it could be more involving
[11:29:08] <eddyb> nmatsakis: hmm, this gives us back the ability to return something other than a &T from the deref traits
[11:30:18] <eddyb> like Ref from RefCell
[11:30:54] *** zz_kimundi is now known as kimundi
[11:31:31] <eddyb> (each successful deref would require generating a callee_id, so we should also keep that in mind, wouldn't want to flood all the tables with data for deref calls we didn't end up using)
[11:34:12] <nmatsakis> eddyb: yeah, branching could work. it is not clear to me that we want to have the option of returning something other than &T, though.
[11:34:29] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[11:34:32] <nmatsakis> I suppose we could have a third trait
[11:34:35] <nmatsakis> perhaps this is what you were suggested
[11:34:37] <nmatsakis> *suggesting
[11:34:53] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[11:35:12] *** Quits: Guest (textual@16F167B.4C57D258.D8E8354F.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[11:35:13] <nmatsakis> i.e., DerefImm yields &'a T, DerefMut yields &'a mut T, and DerefCopy yields T
[11:35:47] <nmatsakis> eddyb: I guess we don't necessarily need to *branch*, or rather it's a bit more subtle,
[11:36:19] <nmatsakis> (since any time we use DerefImm, we could (potentially) use DerefMut, as an &mut T can itself be frozen to an &T)
[11:36:22] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[11:36:48] <eddyb> well, I was thinking of the (possibly common) &'a RefCell<T> => Ref<'a, T> case
[11:36:54] <nmatsakis> this is good though. I've been wanting to rewrite method lookup to be saner. This is far less sane than the plan I had in mind but perhaps, if designed in from the start, can be to work.
[11:37:18] <eddyb> nmatsakis: ohh, so if we start with &T, we don't need to branch at all, while for &mut T we need to consider an initial &T/&mut T choice
[11:37:39] <eddyb> since DerefImm and DerefMut both preserve mutability
[11:37:53] <nmatsakis> eddyb: hmm yes so actually DerefCopy isn't enough; I feel like we really want HKT for that. Well, I guess you could do the impl on the ref itself and take self by value.
[11:38:29] <nmatsakis> eddyb: I think we'd probably just try DerefImm and, if we get no matches, try DerefMut?
[11:38:53] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:39:07] <eddyb> yeah, that's what I had in mind for supporting it (self by value and return T). can't really inherit DerefMut from DerefImm with that though
[11:39:27] <nmatsakis> unfortunately, I have to run for a bit. 
[11:39:29] <huon> (would DerefByVal or DerefMove be a better name for DerefCopy? (i.e. is the plan for it to be restricted to Pod types?))
[11:39:37] <eddyb> nmatsakis: I don't really know, weird cases like &mut &&mut T confuse me
[11:39:39] <nmatsakis> I'm not really a fan of implementing Deref on the ref itself
[11:39:41] *** Joins: Guest (textual@16F167B.4C57D258.D8E8354F.IP)
[11:39:47] <nmatsakis> I prefer the current design I think
[11:39:59] <nmatsakis> with HKT we could eventually add support for RefCell -> Ref,
[11:40:02] <nmatsakis> but it's unclear we even want to
[11:40:09] <eddyb> mkay
[11:40:12] <nmatsakis> it's been pointed out before
[11:40:16] <nmatsakis> that this is a fallible operation
[11:40:22] <nmatsakis> and it's somewhat surprising to do it so silently
[11:40:49] <nmatsakis> I think removing the need to deref the *Ref* would be nice tho
[11:40:51] <nmatsakis> but that fits ok
[11:40:52] <nmatsakis> e.g.,
[11:40:57] <nmatsakis> table.borrow_mut().insert(...)
[11:41:04] <eddyb> mutating through &&mut is a borrowck error, right?
[11:41:09] <nmatsakis> should be
[11:41:26] <nmatsakis> there was a (recently closed) bug on this tho
[11:41:36] <nmatsakis> ok, I'll be back in a couple hours
[11:41:54] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[11:41:54] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/t43xwA
[11:41:54] <ghrust> 13rust/06auto 14b8fcaca 15Alex Crichton: test: Clean out the test suite a bit...
[11:41:54] <ghrust> 13rust/06auto 142c9a92d 15bors: auto merge of #12457 : alexcrichton/rust/fix-some-tests, r=brson...
[11:41:54] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[11:41:54] <eddyb> so calling a &mut self method shouldn't need to be considered for &&mut, other than to provide a proper error message :/
[11:41:57] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[11:41:57] <ghrust> [13rust] 15bors 04force-pushed 06auto from 147e60fc6 to 14a5342d5: 02http://git.io/N3iJvQ
[11:41:57] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[12:01:40] *** Quits: arrrrrrrrr (arrrrrrrrr@moz-53AF4C1C.dynamic.qsc.de) (Quit: arrrrrrrrr)
[12:03:15] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[12:07:00] *** Joins: gimpf (gimpf@moz-742D8834.adsl.highway.telekom.at)
[12:11:46] *** Joins: edwardw (edwardw@655F78EA.BF27AFA4.B9C6B12A.IP)
[12:11:54] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[12:11:54] <ghrust> [13rust] 15bors 04force-pushed 06auto from 142c9a92d to 14a5342d5: 02http://git.io/N3iJvQ
[12:11:54] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[12:13:51] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[12:17:14] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[12:20:33] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[12:25:05] *** Quits: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP) (Quit: leaving)
[12:26:12] *** Quits: Guest (textual@16F167B.4C57D258.D8E8354F.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[12:31:45] <strcat> it seems like the LLVM version changes every week
[12:31:47] <strcat> ;s
[12:32:35] *** Joins: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP)
[12:34:28] <huon> strcat: something about stacks on ARM Thumb
[12:34:30] * huon shrugs
[12:34:43] * strcat gave up on changing Eq/Ord
[12:35:43] <huon> :(
[12:37:26] <strcat> well I'm going to leave all 4 traits and rename them instead
[12:37:50] <strcat> Eq/Ord -> PartialEq/PartialOrd, TotalEq/TotalOrd -> Eq/Ord + inherit from the Partial ones
[12:37:56] <strcat> and the equals method can go away
[12:38:09] <strcat> Eq just means you implement PartialEq with sane semantics
[12:38:44] <eddyb> so Eq would be empty, just a marker on top of PartialEq?
[12:38:46] <strcat> that way all generic code will magically become correct, and partial ordering becomes opt-in (as most generic code isn't correct with it)
[12:38:48] <strcat> eddyb: yes
[12:38:55] <eddyb> good :D
[12:38:56] <strcat> Eq inherits from PartialEq
[12:39:03] <strcat> Ord inherits from Eq and PartialOrd
[12:39:08] <huon> I like Gabor's suggestion of EqOps and OrdOps
[12:39:22] <huon> i.e. make them explicitly operator overloading
[12:39:23] <strcat> huon: neither communicates that they are not equality/ordering
[12:39:28] <strcat> huon: they need laws either way
[12:39:33] <strcat> every trait needs laws or it is useless
[12:40:09] <strcat> I am fine with keeping them instead of removing them but they're going to have laws + correct names
[12:40:16] * strcat shrugs
[12:40:41] <strcat> I wanted a simple API but am totally fine with having a more complex one to make people happy if it's done right
[12:40:56] <eddyb> r? https://github.com/mozilla/rust/pull/12493
[12:41:13] <eddyb> there's no more test problems (thanks, travis)
[12:41:18] <strcat> there will be PartialEq/PartialOrd, Eq/Ord, and alternate floating point types implementing the total ordering
[12:41:41] <huon> eddyb: travis doesn't run the full suite
[12:41:46] <eddyb> huon: shush :)
[12:41:53] <strcat> everyone can get what they want (except people who want it simple... but that's a lost battle)
[12:42:11] <strcat> dunno what to do about deriving though
[12:42:16] <strcat> will need to figure that out
[12:42:19] <eddyb> is this one of those places where only nmatsakis has review rights?
[12:42:32] <eddyb> (typeck::check::method, that is)
[12:42:51] <huon> strcat: I'd be happy with just having Eq/Ord deriving, that implement PartialEq/PartialOrd internally
[12:42:57] <huon> (that's what the hash deriving does)
[12:43:00] <strcat> huon: yeah
[12:43:07] <strcat> it is going to be a huge pain to implement this though
[12:43:10] <huon> although that makes "surprise" traits
[12:43:25] <huon> I'm happy to do the deriving if you tell me what I need to do :)
[12:43:26] <strcat> huon: meh, I don't care, as long as it's *correct*
[12:43:31] <strcat> I give up at making it simple/predictable
[12:43:40] <strcat> but we can't have stuff that's blatantly wrong
[12:43:55] <eddyb> the "surprise" shouldn't be a surprise here, if you can't implement Eq without PartialEq
[12:44:11] <eddyb> and deriving only does total, no?
[12:47:36] <edwardw> actually, does travis present a typical moral hazard situation? with travis, I find myself pushing more often :D
[12:48:06] <eddyb> edwardw: until acrichto points it out publicly :P
[12:48:26] <edwardw> eddyb: ah, I didn't catch that one
[12:49:18] <huon> eddyb: no, deriving has Eq and Ord.
[12:49:21] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[12:50:34] <eddyb> huon: I meant, the derived implementation is only expected to perform correctly for total equality/ordering, no?
[12:51:06] <huon> no
[12:51:21] <huon> it is religious about calling every method on every field
[12:51:29] <huon> it doesn't fall back to the default methods
[12:51:34] <eddyb> okay then
[12:55:23] <strcat> huon: I don't know how to go about renaming the traits
[12:55:51] <eddyb> Eq => PartialEq, solve all the errors, then TotalEq => Eq
[12:55:59] <eddyb> at least that's how I would do it if I were to think first
[12:56:18] <eddyb> though I guess grep would work just as well
[12:56:25] <eddyb> but there's also the issue of bootstrapping
[12:56:28] <eddyb> (much fun)
[12:56:32] <strcat> eddyb: yes that's what I mean
[12:56:33] <strcat> deriving.
[12:56:42] <strcat> I am probably going to have to remove all the deriving
[12:56:46] <strcat> and add it back post-transition
[12:56:49] <strcat> huge pain
[12:57:40] <huon> strcat: could have the derivings under two names
[12:57:41] <strcat> odd 
[12:57:47] <strcat> /home/strcat/projects/rust/src/libstd/vec_ng.rs:117:9: 117:46 error: failed to find an implementation of trait cmp::Eq for T
[12:57:49] <strcat> /home/strcat/projects/rust/src/libstd/vec_ng.rs:117         self.as_slice().lt(&other.as_slice())
[12:57:58] <strcat> I don't think trait inheritance works at all
[12:59:28] * strcat doesn't get that error
[13:00:16] <eddyb> root_map looks like it could be easily broken by overloaded autoderefs
[13:00:24] *** Quits: edwardw (edwardw@655F78EA.BF27AFA4.B9C6B12A.IP) (Ping timeout)
[13:00:30] <eddyb> I'll be happy when we rip that out with the rest of @T
[13:03:34] *** Joins: jensnock_ (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[13:03:36] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[13:03:39] <strcat> wtf does it want an Eq impl for < for
[13:05:06] <eddyb> nmatsakis: hmm, search_for_some_kind_of_autorefd_method does try something for multiple mutabilities...
[13:05:38] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[13:05:56] *** Joins: edwardw_ (edwardw@96E7298D.3E260003.B9C6B12A.IP)
[13:07:03] <huon> strcat: Ord requires Eq?
[13:07:07] <strcat> no
[13:07:31] <strcat> I need to start over anyway with a plan for dealing with deriving
[13:07:42] <strcat> huon: try implemented Ord for vec_ng.rs
[13:07:50] <strcat> huon: it already does Eq/TotalOrd/TotalEq
[13:07:54] <strcat> just try adding an impl
[13:07:55] <strcat> you'll see
[13:08:19] <huon> how peculiar (I can't do it myself now, but I believe you)
[13:12:41] <strcat> https://github.com/mozilla/rust/issues/12519
[13:15:38] <huon> strcat: wait... is it because the slice impl requires Eq for T?
[13:16:07] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[13:16:07] <strcat> oh, it does
[13:16:10] <strcat> weird
[13:16:52] <strcat> reworded bug
[13:17:31] <strcat> huon: meh
[13:17:42] <strcat> it goes deeper
[13:20:04] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[13:20:11] <strcat> should Ord inherit from Eq?
[13:20:17] <strcat> I guess PartialOrd should inherit from PartialEq
[13:20:22] <strcat> so yeah
[13:20:26] <strcat> I'll just do that and call it a day
[13:21:54] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[13:21:54] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/JnB0PQ
[13:21:54] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[13:21:55] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[13:26:56] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[13:26:56] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/8fFUoA
[13:26:56] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[13:33:21] <strcat> I'm not sure what's going on with the comparison impls in btree.rs
[13:34:28] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[13:34:40] <huon> strcat: i'm not sure what's going one with anything in btree
[13:34:51] <huon> .clone().clone().clone() :(
[13:36:21] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[13:37:37] <strcat> well I mean the TotalOrd impl requires TotalEq for the value
[13:37:56] <strcat> seems like it would have to require TotalOrd
[13:37:56] <huon> o_O
[13:39:14] <huon> and the implementation doesn't seem to use TotalEq at all
[13:41:23] <strcat> meh I'll just add a slightly weird impl of Eq
[13:41:42] <huon> return true wouldn't be that much wrong-er than what's currently there
[13:41:48] <strcat> I just want to fix one thing >.<
[13:41:59] <strcat> always end up hitting 50 other issues
[13:42:07] <strcat> and decide to not bother
[13:42:22] <huon> (e.g. the Leaf's are ordered based on only their first element.)
[13:42:34] <huon> yeah, I've hit that too much too :(
[13:42:36] <strcat> well what should I do?
[13:42:43] <huon> for btree?
[13:42:52] <strcat> I want to make TotalEq inherit from Eq so I need to do something in btree.rs
[13:43:05] <strcat> should I add an incorrect Eq impl, or what?
[13:43:06] <huon> can't the Eq just acll the TotalEq?
[13:43:21] <strcat> I guess but it's not right
[13:43:26] * strcat shrugs
[13:43:32] <huon> another option is `unimplemented!()` and let nif deal with it
[13:43:47] <strcat> I'll call TotalEq
[13:43:54] <strcat> don't know who nif is
[13:44:31] *** Joins: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca)
[13:47:56] <huon> strcat: oh, sorry; she's the OPW intern working on btree.
[13:48:03] <strcat> huon: I think TreeMap used to do it wrong (fixed now) and this was copied from the older TreeMap
[13:48:09] <strcat> maybe
[13:48:11] <strcat> dunno
[13:48:22] <huon> ok
[13:48:29] * huon -> bed
[13:48:45] <strcat> this could definitely be simpler but I really don't want to be the one to clean it up
[13:51:56] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[13:54:49] *** Joins: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com)
[13:57:09] *** edwardw_ is now known as edwardw
[13:57:31] <edwardw> huon: night
[14:02:08] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[14:02:58] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[14:07:54] <pnkfelix> nmatsakis: ping
[14:11:19] *** Joins: Guest (textual@16F167B.4C57D258.D8E8354F.IP)
[14:12:54] <eddyb> I kindof want auto-deref+ref (reborrow) for everything now
[14:13:14] <eddyb> I guess just extending the current will make it work with Rc<T> => &T
[14:13:22] <eddyb> *current implementation
[14:14:18] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[14:16:10] <erickt> eddyb: ping
[14:16:40] <eddyb> erickt: pong
[14:17:57] <erickt> eddyb: good morning! acrichto asked that the lint `default_type_param_usage` be moved into the default_type_param feature gate
[14:18:46] <eddyb> it's a lint because we can't gate at the type level
[14:18:53] <erickt> eddyb: I vaguely remember you saying that was difficult, but I can't remember your argument.
[14:18:56] <erickt> ah right
[14:19:13] <eddyb> I guess I could emit an error directly when the feature gate is missing
[14:19:22] <eddyb> not sure why I didn't think of this before
[14:19:44] <eddyb> would have to save it as a flag somewhere, though
[14:19:54] <eddyb> erickt: how high of a priority is this?
[14:20:56] <eddyb> can deriving check the crate attributes for feature(default_type_params) to choose between a SipHash impl and something more generic?
[14:21:07] <erickt> eddyb: he wants to block my PR that makes hashmap generic with respect to the hasher on it
[14:21:20] <eddyb> bleah
[14:21:57] <erickt> I suppose we can talk more about this when acrichto comes online, this was just the first time I saw you in a couple days :)
[14:22:30] <eddyb> well, I was around yesterday
[14:22:52] <eddyb> (though, not for 6 hours, but I didn't see a ping)
[14:23:26] <erickt> hrm, dunno then. maybe I forgot to check yesterday :)
[14:25:23] <eddyb> I rarely get 10h of sleep these days, cut me some slack :P
[14:25:46] <eddyb> well, I'll try to fix it as well as I can and let travis decide whether I screw up
[14:25:58] <edwardw> My proposal for the Ident and hygiene problem, https://github.com/mozilla/rust/issues/12512#issuecomment-35890118. Any thoughts?
[14:26:13] <erickt> eddyb: thanks!
[14:26:52] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[14:26:52] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14ae0b9e2 to 146720977: 02http://git.io/N3iJvQ
[14:26:52] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[14:26:53] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[14:26:53] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/x6rXyw
[14:26:53] <ghrust> 13rust/06auto 14782f5fd 15Alex Crichton: rustc: Don't error on the rlib symlinks...
[14:26:53] <ghrust> 13rust/06auto 14e4831b9 15bors: auto merge of #12474 : alexcrichton/rust/issue-12459, r=brson...
[14:26:53] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[14:27:32] <edwardw> eddyb: erickt: huon: care take a minute to take a look?
[14:27:52] <edwardw> I promise it is a simple one
[14:28:23] <eddyb> edwardw: multiple SCTable's is interesting, the way I was thinking was to put the kind in the Rename variant of SyntaxContext_
[14:28:40] <eddyb> but that's (much) harder to implement correctly, I'd say
[14:28:49] <edwardw> that will make Ident bigger
[14:29:05] <edwardw> so potentially the memory footprint of compile
[14:29:08] <eddyb> Rename, not Ident
[14:29:14] <edwardw> ah, ok
[14:29:23] <edwardw> s/compile/compiler
[14:29:24] <eddyb> Ident holds two numbers
[14:29:33] <eddyb> SyntaxContext_ is the enum stored in SCTable
[14:29:44] <edwardw> I see
[14:29:59] <edwardw> you like the solution?
[14:31:30] <erickt> edwardw: unfortunately I got to run now, I'll try to check it out in an hour or so
[14:31:42] <edwardw> erickt: np
[14:34:27] <eddyb> edwardw: it's pretty good, considering we're talking about hygiene :P
[14:34:30] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[14:34:48] <edwardw> LOL
[14:34:51] <darnuria> anyone for reviewing it? https://github.com/mozilla/rust/pull/12472
[14:36:25] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[14:39:33] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[14:41:18] <eddyb> https://github.com/mozilla/rust/pull/12472#issuecomment-35891981 I couldn't resist giggling at that
[14:45:14] <darnuria> eddyb: That not a problem I assume that I am total newbie with git rebase and git with a LOT of persons :)
[14:46:13] <darnuria> eddyb: I am happy to make you laught ;)
[14:46:26] <eddyb> darnuria: not that
[14:46:29] *** Quits: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP) (Quit: Leaving...)
[14:46:32] <eddyb> "Remind me to show you my git work-flow at the meetup tomorrow night"
[14:46:52] *** Quits: gimpf (gimpf@moz-742D8834.adsl.highway.telekom.at) (Quit: Leaving.)
[14:48:04] <pnkfelix> eddyb: as in, not worthy of a github comment?
[14:48:09] <pnkfelix> eddyb: (which, in hindsight, is true)
[14:49:41] <eddyb> the only way I can explain my (silly) reaction would be "that's what she said" but pretend I didn't say that because it probably violates one of the rules of conduct
[14:49:59] <pnkfelix> eddyb: ah, now I see
[14:50:23] <darnuria> eddyb: I didnt get it. XD
[14:51:04] <pnkfelix> darnuria: There's probably some French analogue to the reference, you and I can discuss face-to-face tomorrow.
[14:52:43] <darnuria> pnkfelix: Ok. I imagine the worst :)
[14:53:03] *** Joins: daschl (daschl@moz-DC6DE6E2.vie.surfer.at)
[15:01:54] <eddyb> darnuria: about your actual question, what I do for rebasing against master is this: git pull --rebase parent master
[15:02:04] <eddyb> parent is the name of my mozilla/rust remote
[15:02:19] <eddyb> I've also seen "upstream" being used for the same purpose
[15:05:17] <darnuria> eddyb: Ah ! thanks :)
[15:05:59] <darnuria> not -i?
[15:07:13] <darnuria> The Idea is to squash my commit to have just one. :o
[15:07:22] *** Quits: tedh (tedh@moz-6F8EC49.central.biz.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[15:07:26] <eddyb> ahh, that kind of rebasing
[15:07:54] <darnuria> eddyb: Hey yes. The goal is to Purpose One commit for PR.
[15:08:04] <eddyb> I thought you just wanted to update your PR via rebasing (which is what we call rebasing most of the time)
[15:08:15] <eddyb> (sorry for the confusion)
[15:08:25] <darnuria> No problem git is so versatil :)
[15:13:02] <darnuria> eddyb: indeed I dont know if I must do it. I wanted to do it because some one advise me to do it for my previous PR
[15:13:55] <eddyb> I think the convention is to name what you want to do "squashing" and we sometimes do it, but only if the commits overlap a lot
[15:14:37] <eddyb> e.g. you're changing something back and forth based on review comments
[15:16:03] <darnuria> eddyb: Ok thanks thats clear. And there is a "right" way to do it? Every time I make a push -f I feel guilty so I think that not a good practice :o
[15:26:55] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[15:26:55] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14e4831b9 to 146720977: 02http://git.io/N3iJvQ
[15:26:55] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[15:26:56] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[15:26:56] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/QQ2wGg
[15:26:56] <ghrust> 13rust/06auto 14f60c2d1 15Brendan Zabarauskas: Remove std::bool::{Bool, all_values}...
[15:26:56] <ghrust> 13rust/06auto 14e5f29c3 15bors: auto merge of #12473 : bjz/rust/remove-bool, r=alexcrichton...
[15:26:56] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[15:34:28] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[15:36:20] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[15:37:54] *** Quits: Kxepal (Miranda@moz-31D2847C.pppoe.mtu-net.ru) (Ping timeout)
[15:41:55] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[15:41:55] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14e5f29c3 to 146720977: 02http://git.io/N3iJvQ
[15:41:55] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[15:41:56] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[15:41:56] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/12EYkw
[15:41:56] <ghrust> 13rust/06auto 14e679ed6 15Alex Crichton: Use lines_any() when parsing output form "ar"...
[15:41:56] <ghrust> 13rust/06auto 147e02510 15bors: auto merge of #12475 : alexcrichton/rust/issue-12471, r=brson...
[15:41:56] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[15:42:18] *** Joins: Kxepal (Miranda@moz-406769B7.pppoe.mtu-net.ru)
[15:47:17] <cmr> bjz: huon: thanks for policing the HN thread
[15:47:57] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[15:48:18] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[15:48:42] <Zr40> cmr: I noticed the thread was at #1 this morning :)
[15:49:57] *** Quits: daschl (daschl@moz-DC6DE6E2.vie.surfer.at) (Quit: Textual IRC Client: www.textualapp.com)
[15:50:01] <bjz> cmr: yay propaganda
[15:50:01] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[15:50:22] <cmr> yup!
[15:50:52] <bjz> I don't want to comment much more though, lest I look too much like a fanboi
[15:51:07] <bjz> :D
[15:51:24] <cmr> bjz: do you know how #[simd] is supposed to work?
[15:51:35] <cmr> and why none of the simd vectors implement any operations...
[15:51:41] <strcat> cmr: the compiler does
[15:51:43] *** Joins: OLIVIA345 (OLIVIA345@E44AAA16.6289F2F6.20F09BA6.IP)
[15:51:52] <strcat> only the built-in ops are supported atm
[15:51:56] <strcat> no shuffles or anything
[15:52:08] *** Quits: japaric (japaric@D3362D12.54A02F38.BFC118EE.IP) (Ping timeout)
[15:52:37] <bjz> woah, stuff actually works?
[15:52:47] <bjz> cmr: no clue at all
[15:53:12] <strcat> yes
[15:53:28] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:53:35] <OLIVIA345> play    choice combate  game   JUMBASTIC MAGEGO
[15:53:45] *** Quits: OLIVIA345 (OLIVIA345@E44AAA16.6289F2F6.20F09BA6.IP) (Client exited)
[15:54:45] <strcat> rusti: #[simd] struct v(f32, f32, f32, f32); v(2.2, 2.2, 2.2, 2.2) * v(4.4, 5.5, 9.9, 2.2)
[15:54:50] -rusti- timeout triggered!
[15:54:52] <strcat> rusti: #[simd] struct v(f32, f32, f32, f32); v(2.2, 2.2, 2.2, 2.2) * v(4.4, 5.5, 9.9, 2.2)
[15:54:57] -rusti- timeout triggered!
[15:54:58] <strcat> rusti: #[simd] struct v(f32, f32, f32, f32); v(2.2, 2.2, 2.2, 2.2) * v(4.4, 5.5, 9.9, 2.2)
[15:55:02] -rusti- main::v(9.68000031f32, 12.10000038f32, 21.77999878f32, 4.84000015f32)
[15:55:10] <cmr> magic.
[15:55:25] <eddyb> I don't think they are fully expressed in the type system
[15:55:46] <erickt> r? https://github.com/mozilla/rust/pull/12522
[15:55:58] <eddyb> a SIMD vector type, created with simd![f64, ..4] - that would be nice
[15:56:11] <erickt> ^ Hash cleanup PR 
[15:56:54] <eddyb> ahh, I was supposed to fix that feature gate, ended up procrastinating
[15:57:13] <erickt> ;)
[15:58:19] <eddyb> erickt: is there an issue for it?
[15:58:53] <erickt> eddyb: not that I know of
[15:59:04] <erickt> eddyb: want me to file one, or will you?
[15:59:18] <eddyb> I was just curious
[15:59:26] <eddyb> actually, I think acrichto opened an issue
[16:00:04] <eddyb> https://github.com/mozilla/rust/issues/12423
[16:05:30] *** Quits: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP) (Quit: leaving)
[16:09:26] *** Quits: pauls (pauls@moz-BFEF1F22.ccs.neu.edu) (Quit: Ignore me!!)
[16:12:41] *** Quits: carter (carter@moz-58F59B3A.members.linode.com) (Ping timeout)
[16:12:41] *** Quits: Edwards (MeltdownMo@moz-B62E1D6B.members.linode.com) (Ping timeout)
[16:12:50] *** Quits: friggle (friggle@moz-A607EAFA.members.linode.com) (Ping timeout)
[16:12:51] *** Joins: friggle (friggle@moz-A607EAFA.members.linode.com)
[16:12:53] *** Joins: Edwards (MeltdownMo@moz-B62E1D6B.members.linode.com)
[16:13:11] *** Joins: carter (carter@moz-58F59B3A.members.linode.com)
[16:14:03] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[16:16:03] <darnuria> eddyb: I must make a new PR with nice squashed commit? Or?
[16:16:11] <eddyb> not a new PR
[16:16:27] <eddyb> you can force push if you've squashed your commits
[16:16:32] <darnuria> Ok so I am oblige to push -f? =/
[16:17:03] <nmatsakis> pnkfelix: pong
[16:17:25] <darnuria> Ok some kitten will die. No problem. I prefers to ask push -f and git rebase are like bleach. ;)
[16:18:30] <eddyb> git lets you rewrite history, that doesn't make it less dangerous than in <insert your favorite Sci-Fi franchise here>
[16:18:53] <nmatsakis> eddyb: yes, I have r? "rights" in method, and yes it does do some search. I've been planning a rewrite which would have removed that search, but maybe it (or something similar) winds up being needed
[16:19:14] <eddyb> nmatsakis: but are you the only one?
[16:19:35] <eddyb> I wanted to be done with the operator overloads PR
[16:20:39] <eddyb> nmatsakis: if you have the time, r? https://github.com/mozilla/rust/pull/12493
[16:21:31] <eddyb> erickt: I hope this works: #[cfg(stage0)] #[allow(default_type_param_usage)];
[16:22:19] <darnuria> eddyb: Thanks. I think making mutable imutability(commit) is not a good thing :)
[16:22:20] <nmatsakis> eddyb: k
[16:22:27] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[16:23:00] <nmatsakis> eddyb: there is some further simplification needed on that, I think, though the changes I had in mind cause a lot of breakage around adding strings (because we accept more than I think we ought to --- well, not quite that simple)
[16:23:53] <eddyb> being able to do &* on Rc<[T]> and Rc<str> will be an interesting challenge
[16:24:04] <eddyb> (I guess any DST)
[16:24:08] <darnuria> So if anyone want to review it : https://github.com/mozilla/rust/pull/12472 it is a doc PR.
[16:24:21] <nmatsakis> eddyb: not sure why that should be challenging? 
[16:24:35] <eddyb> nmatsakis: because * produces a DST
[16:24:44] <cmr> that's new
[16:24:51] <cmr> LLVM ERROR: SSE register return with SSE disabled
[16:24:54] <nmatsakis> eddyb: so?
[16:25:02] <nmatsakis> eddyb: I mean, it'll be challenging before we implement DST :)
[16:25:06] <eddyb> well, I hope it will work nicely
[16:25:08] <nmatsakis> (and I don't think you should attempt it, of course)
[16:25:20] <nmatsakis> that is, implementing DST is orthogonal
[16:25:35] <nmatsakis> (I believe there is no particular issue)
[16:26:00] <eddyb> I guess *x is already weird in that it has a special lvalue "type"
[16:26:26] <nmatsakis> it's an lvalue expression you mean?
[16:26:41] <doener> cmr: sorry about #12494
[16:27:03] <eddyb> nmatsakis: yeah, and it has a special memory categorization
[16:27:26] <eddyb> it's &T/&mut T acting like C++ T&
[16:27:45] <eddyb> I ranted a few days ago on the subject, maybe I should've written my thoughts down
[16:27:51] *** darnuria is now known as darnuria|afk
[16:28:00] <eddyb> anyways, what do I do about unknown lints?
[16:28:25] <eddyb> libstd has #[allow(default_type_param_usage)]; and I just removed that
[16:28:41] <eddyb> will it cause a stage1 error?
[16:29:00] <cmr> not if you don't remove it from the known lint list
[16:29:10] <eddyb> (that is, I removed the lint in the compiler)
[16:29:27] <cmr> but just put a #[allow(unrecognized_lint)] with a snapshot comment.
[16:29:39] <eddyb> sweet :D
[16:30:53] *** Joins: rocode (rocode@moz-398826F7.clsp.qwest.net)
[16:32:21] <erickt> cmr: it's a day late, but I mailed rust-dev with an announcement about the new hash framework: https://mail.mozilla.org/pipermail/rust-dev/2014-February/008766.html
[16:32:43] <cmr> erickt: thanks!
[16:33:19] <eddyb> erickt: ahh, you're using #[allow(default_type_param_usage)] that I've just removed >_>
[16:33:24] * eddyb feels so bad
[16:33:35] <erickt> I did say it might break at any moment :)
[16:33:44] <eddyb> disclaimers <3
[16:34:29] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[16:36:21] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[16:37:18] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[16:38:06] <nmatsakis> eddyb: that battle (over explicit derefs vs distinguishing lvalue/rvalue) was fought a long time ago (I think by Algol?)
[16:38:33] <nmatsakis> anyway, I consider it decisively won :)
[16:39:09] <eddyb> well, I now see the usefulness of mem_categorization
[16:39:14] *** Joins: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP)
[16:39:23] *** Joins: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net)
[16:39:23] *** ChanServ sets mode: +ao dherman dherman
[16:40:00] <eddyb> certainly better to implement odd cases like *x there instead of every place that needs the information
[16:41:57] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[16:41:57] <ghrust> [13rust] 15bors 04force-pushed 06auto from 147e02510 to 146720977: 02http://git.io/N3iJvQ
[16:41:57] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[16:41:57] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[16:41:57] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/vjOesQ
[16:41:57] <ghrust> 13rust/06auto 14c9b1b70 15Florian Hahn: Remove some obsolete ignored tests...
[16:41:57] <ghrust> 13rust/06auto 14b156ff3 15bors: auto merge of #12476 : fhahn/rust/ignored-tests-update2, r=alexcrichton...
[16:41:58] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[16:42:25] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[16:42:29] <strcat> nmatsakis: I gave up on the total ordering by default for floats thing
[16:42:37] <strcat> lots of people are really opposed to it
[16:43:31] <nmatsakis> strcat: there still seems to be some question of whether having Ord + TotalOrd as distinct concepts makes any sense (tbh, I'm not 100% clear on the current set of traits, am I misinformed?)
[16:43:54] <nmatsakis> I'd personally be inclined just to have the operators + Ord, where Ord is a total ordering and not *necessarily* compatible with operators
[16:44:01] <strcat> nmatsakis: https://github.com/mozilla/rust/issues/12517
[16:44:19] <strcat> nmatsakis: well I decided that it's best to just clarify the existing situation
[16:44:33] <strcat> if a type implements TotalOrd, it means Ord is a total ordering
[16:44:41] * eddyb still wants Eq<Rhs, Ret>
[16:44:58] <strcat> the naming is wrong and the docstrings are unclear (but correct)
[16:45:21] <nmatsakis> strcat: did you intend to enforce that somehow?
[16:45:31] <strcat> nmatsakis: trait inheritance, beyond that no
[16:45:36] <strcat> nmatsakis: TotalEq won't have a method
[16:45:39] <eddyb> right now I wish I had a way to open a PR without triggering travis
[16:45:42] <strcat> implementing it just means Eq is a total ordering
[16:45:46] <nmatsakis> ok (because inheritance doesn't enforce anything)
[16:45:55] <strcat> nmatsakis: it makes you have to implement the other trait
[16:46:04] <nmatsakis> as I said
[16:46:07] <nmatsakis> doens't enforce anything
[16:46:11] <nmatsakis> what I meant was,
[16:46:16] <nmatsakis> doesn't enforce that you implement it in any particular way
[16:46:26] <strcat> any trait is that way
[16:46:43] <strcat> they still need laws
[16:46:50] <eddyb> asserts?
[16:46:56] <nmatsakis> I'm not criticizing,
[16:47:06] <nmatsakis> but there are some options 
[16:47:08] <eddyb> trait-enforced static asserts... sounds tempting
[16:47:19] <nmatsakis> e.g. with revised coherence rules,
[16:47:24] <eddyb> though even with those, you can't do much
[16:47:28] <nmatsakis> we might do "impl<O:Ord> PartialOrd for O
[16:47:42] <nmatsakis> but it's not really clear to me
[16:47:47] <nmatsakis> if PartialOrd as a trait makes any sense anyhow
[16:48:05] <strcat> nmatsakis: whether or not it makes sense, it already exists
[16:48:08] <eddyb> the comparisons make sense even without ordering, just as operator overloads
[16:48:18] <nmatsakis> strcat: yes, i'm discussing if we should remove it.
[16:48:27] <strcat> nmatsakis: as long as operator overloads are tied to a trait, we can't really
[16:49:16] <nmatsakis> we could distinct traits per operator (which is actually what I thought we have)
[16:49:28] <strcat> nmatsakis: I don't think that's any better
[16:49:37] <strcat> traits should be usable by generic code
[16:49:47] * strcat shrugs
[16:50:09] <strcat> I don't really see the point of allowing operator overloading if it doesn't have requirements
[16:50:23] <strcat> if == doesn't mean anything, why allow overloading it?
[16:50:33] <cmr> prettyness?
[16:50:33] <nmatsakis> of course it means someting
[16:50:40] <strcat> nmatsakis: not without laws on the traits
[16:50:41] <nmatsakis> just not what you might want it to mean in some contexts
[16:51:00] <eddyb> trait Ord: Cmp<Self, bool> {}
[16:51:06] <strcat> without laws on the traits it's just a symbol
[16:51:14] <strcat> doesn't mean equality
[16:51:18] <eddyb> and trait Eq: EqOps<Self, bool> {}
[16:51:24] <eddyb> but it's not much
[16:51:33] <nmatsakis> strcat: a == b => b == a, for example
[16:51:51] <eddyb> how could you enforce that?
[16:51:59] <nmatsakis> by fiat?
[16:52:01] <cmr> eddyb: you can't enforce these things in general.
[16:52:02] <nmatsakis> I'm not arguing against laws
[16:52:08] <nmatsakis> that is, there are conditions,
[16:52:15] <strcat> nmatsakis: well what I'm suggesting is that the operator traits only require a partial ordering
[16:52:18] <cmr> quickcheck-like things can help
[16:52:18] <nmatsakis> I'm just saying that reflexive (i.e., a == a, is that the right one?) is not one of them
[16:52:21] <nmatsakis> due to floats
[16:52:46] <nmatsakis> strcat: I tihnk at this point we're in agreement
[16:52:58] <nmatsakis> I don't especially care about PartialOrd vs distinct traits.
[16:53:00] <eddyb> cmr: well, I was considering analyzing optimized LLVM code...
[16:53:08] <pnkfelix> nmatsakis: Am I correct that https://github.com/mozilla/rust/issues/10320#issuecomment-35905330 is trying to present two options on the "palette of options"  Due to markdown difficulties its a little tricky to parse your bullets.
[16:53:15] <cmr> eddyb: halting problem, sorry :)
[16:53:22] <nmatsakis> pnkfelix: oh, yes, stupid markdown renumbering things
[16:53:26] <strcat> this is spread over 20 bugs
[16:53:28] <strcat> which doesn't help
[16:53:30] <eddyb> cmr: riiight, vectors and stuff :(
[16:53:49] <nmatsakis> pnkfelix: fixed
[16:53:54] <pnkfelix> strcat: yeah the disparate bugs are a problem, I admit
[16:53:56] <strcat> anyway currently what I think we should do...
[16:54:01] <eddyb> cmr: what's it with me and NP-hard problems?
[16:54:14] <strcat> the current Ord and Eq require a partial ordering (as stated in their docstrings)
[16:54:18] <cmr> eddyb: it's not NP-hard, it's not computable whatsoever.
[16:54:24] <strcat> Ord should inherit from Eq
[16:54:40] <strcat> TotalOrd/TotalEq already exist and TotalOrd already inherits from TotalEq
[16:54:43] <eddyb> cmr: not in the general case, no
[16:54:57] <strcat> TotalEq can just act as an assertion that you implemented Eq with a total ordering
[16:55:05] <strcat> it should just inherit from Eq and not have any methods
[16:55:09] <strcat> instead of having 'equals'
[16:55:12] <eddyb> just docs
[16:55:18] <eddyb> (good ones, I hope)
[16:55:25] <strcat> TotalOrd can do the same and inherit from Ord
[16:55:27] <pnkfelix> nmatsakis: I don't think either bullet on that palette accurately covers the approach outlined by glaebhoerl
[16:55:32] <strcat> that way you can use the operator overloads in generic code
[16:55:50] <strcat> anyway, then Ord/Eq get renamed to PartialOrd/PartialEq - they are rarely what you want in generic code
[16:55:56] <nmatsakis> pnkfelix: I disagree
[16:55:58] <strcat> TotalOrd/TotalEq get renamed to Ord/Eq
[16:56:07] <strcat> and deriving(Ord) derives both PartialOrd/Ord
[16:56:17] <nmatsakis> pnkfelix: I think bullet #2 IS basically what @glaebhorel proposed
[16:56:42] <pnkfelix> nmatsakis: no, because glaebhorel's proposal does not add new methods
[16:56:48] <nmatsakis> pnkfelix: I did not add new methods.
[16:56:49] <pnkfelix> nmatsakis: it just imposes new laws on the existing ones
[16:56:57] <pnkfelix> nmatsakis: so generic code *does* get to use operators
[16:57:38] <pnkfelix> nmatsakis: which contradicts "Generic code generally doesn't get to use operators, unless it is willing to accept partial ordering"
[16:57:45] <nmatsakis> pnkfelix: ah I see, so in other words in a non-genreic context, we use builtin definitions, but in a generic context, we use generic definitions, and the generic definitions are different
[16:57:50] <strcat> I opened a PR for his suggestion already
[16:57:57] <strcat> I think it's an obvious improvement to what we have now
[16:58:01] <strcat> regardless of what we decide later
[16:58:28] <eddyb> ahh, erickt is not here :(
[16:58:40] <nmatsakis> pnkfelix: yes I considered that but considered it so horrific no one would want it
[16:58:44] <nmatsakis> pnkfelix: perhaps I was mistaken :)
[16:58:48] <nmatsakis> pnkfelix: I can see its appeal to be honest,
[16:58:52] <pnkfelix> nmatsakis: ... I don't think that last bit is quite right either
[16:58:56] <eddyb> acrichto: I'm not sure what to do about #[deriving(Hash)] after fixing https://github.com/mozilla/rust/issues/12423
[16:59:10] <pnkfelix> nmatsakis: its not that you use different dispatching rules
[16:59:20] <pnkfelix> nmatsakis: and get magic builtin vs generic implemenatrions
[16:59:47] <pnkfelix> nmatsakis: The dispatching rules remain the same as they are now
[16:59:59] <pnkfelix> nmatsakis: The main difference is that f32/f64 no longer implement Ord
[17:00:06] <nmatsakis> pnkfelix: I'm re-reading the other bug. I confess that my "menu" was a paring down of what I see as the full range into two options,
[17:00:07] <pnkfelix> nmatsakis: and so you have to use newtyped wrappers
[17:00:14] <strcat> pnkfelix: well they will implement the current Ord
[17:00:17] <strcat> but it won't be called Ord
[17:00:19] <pnkfelix> strcat: right
[17:00:34] <strcat> it will be called PartialOrd, Cmp, CmpOps or something like that
[17:00:40] <nmatsakis> I think part of the confusion is the matter of naming
[17:00:43] <nmatsakis> that is, whether we're using current names,
[17:00:43] <pnkfelix> strcat: Right.  The importaning thing from my POV
[17:00:45] <nmatsakis> or new propsed names
[17:00:53] <pnkfelix> strcat: is that existing uses of deriving(Ord)
[17:00:56] <nmatsakis> pnkfelix: I explicitly rejected idea that f32/f64 do not implement ord
[17:00:58] <pnkfelix> strcat: should stay as deriving(Ord)
[17:01:06] <nmatsakis> pnkfelix: (that is, I said "I am assuming we do not want that")
[17:01:08] <strcat> pnkfelix: they can unless they use floats
[17:01:19] <pnkfelix> strcat: Right
[17:01:27] <pnkfelix> strcat: the cases that use floats
[17:01:30] <strcat> it is going to be hell to change the names
[17:01:30] <pnkfelix> strcat: will have to be investigated
[17:01:44] <pnkfelix> strcat: to see if they should use the newtype wrappers
[17:01:54] <strcat> pnkfelix: I don't think there are any
[17:01:55] <pnkfelix> strcat: or if they should stop deriving(Ord).  Right?
[17:02:00] <strcat> pnkfelix: TreeMap uses TotalOrd, sort uses TotalOrd
[17:02:08] <strcat> min, max, clamp use Ord but they are incorrect for floats
[17:02:33] <strcat> HashMap uses Eq (should be TotalEq) but I doubt there are any users with float keys
[17:02:47] <pnkfelix> nmatsakis: If, as proposed, the infix-operators are no longer coupled to Ord
[17:03:00] <pnkfelix> nmatsakis: are you still then rejecting the idea that f32/f64 not implement Ord ?
[17:03:06] <strcat> nmatsakis: Ord/Eq would mean total ordering, and would inherit from operator overloading traits
[17:03:10] <nmatsakis> pnkfelix: so basically @glaebhorl's proposal is my #2,
[17:03:13] <strcat> nmatsakis: Ord would only have cmp, Eq would have no methods
[17:03:19] <nmatsakis> pnkfelix: but with the (explicit ruled out) rule that floats do not impl Ord
[17:03:27] <nmatsakis> pnkfelix: I thought about having 2a and 2b, 
[17:03:36] <nmatsakis> pnkfelix: where one would be what he suggested.
[17:03:40] <strcat> the operator overloading traits would require a partial ordering so floats can implement them without them being meaningless
[17:04:08] <strcat> (and implementing Eq or Ord means the operator overloads for that type are a total ordering)
[17:04:09] <nmatsakis> the bottom line is,
[17:04:24] <nmatsakis> you get two choices: total ordering for everybody, or permit partial ordering and total ordering
[17:04:29] <nmatsakis> there are a million variations on #2
[17:04:35] <nmatsakis> I don't honestly care that much which one we choose
[17:04:46] <strcat> nmatsakis: I don't think the former is going to appeal to people even though I was pushed for it at first
[17:04:48] <nmatsakis> I like strcat's naming, in that I think Ord/Eq should be total ordering
[17:04:56] <nmatsakis> otherwise I favor both partial/total
[17:04:57] <strcat> was pushing for it*
[17:05:01] <pnkfelix> nmatsakis: Yes I agree, Ord/Eq should denote total
[17:05:12] <nmatsakis> I personally thikn f32/f64 should implement Ord/Eq,
[17:05:18] <nmatsakis> actually
[17:05:27] <nmatsakis> I guess there is a third option
[17:05:34] <strcat> nmatsakis: I don't want a separate equality method for partial and total though
[17:05:35] <nmatsakis> I was considering the idea that we remove Eq entirely
[17:05:53] <nmatsakis> and just have Ord, PartialEq and PartilaORd
[17:06:05] <nmatsakis> but that's probably a bad idea
[17:06:09] <nmatsakis> ok I lied there are more options
[17:07:01] <nmatsakis> strcat: ok, so I guess there are really 3 options:
[17:07:20] <strcat> for example I think it's important that generic code using Eq should get to assume it has sane semantics, and use the overloads
[17:07:26] <nmatsakis> total, partial/total where one type could implement both differently, and partial/total where you either impl partial or partial+total but not both
[17:07:50] <nmatsakis> I agree we should do one of the latter two, and clearly the 3rd is more pure and has less potential for surprise
[17:08:01] <strcat> nmatsakis: well I want partial/total where you have to implement partial or partial+total and if you do both, they're the same
[17:08:12] <nmatsakis> that's what I meant by #3
[17:08:14] <strcat> ah
[17:08:21] <nmatsakis> i.e., you can't implement them both in distinct ways
[17:08:37] <pnkfelix> strcat: How strongly would you object to introducing a separate trait and lang item for each of {<,>,>=,<=}  ?  Just curious.
[17:08:41] <nmatsakis> (ok, I have to run out again)
[17:08:45] <strcat> pnkfelix: very ;)
[17:08:58] <strcat> I want way fewer traits than we have now
[17:09:03] <strcat> with each one having laws
[17:09:20] * pnkfelix was trying to figure out some way to wedge in a LeftArrow operator as an inverted closure
[17:09:25] <strcat> so that's why having only total ordering with the traits is nice
[17:09:28] <strcat> but I don't think people want it
[17:09:45] <pnkfelix> strcat: Yeah.  Although its not like we've done a scientific survey
[17:10:35] <acrichto> eddyb: I think for now it should start deriving with SipState instead of <W: Writer>, it shouldn't break any code today, but this may accelerate the deicision for default type parameters
[17:11:09] <pnkfelix> acrichto: ah good morning
[17:11:18] <acrichto> pnkfelix: good morning! 
[17:11:24] <acrichto> I'll respond to pings on all channels!
[17:12:04] <pnkfelix> acrichto: quick Q: is there a way with libgreen::start (or some other method) to both start up M:N task threading, but also get one task that is going to always be scheduled on the main thread?
[17:12:29] <pnkfelix> acrichto: In particular when I was messing with rust-sdl it seemed like I really needed the event handling loop to remain on the main thread.
[17:13:04] <pnkfelix> (maybe this should be called (1:1 + M:(N-1)) threading)
[17:13:14] *** Parts: aepsil0n (ebopp@moz-EF530DCB.ita.uni-heidelberg.de) ()
[17:13:23] <acrichto> pnkfelix: not currently, but it's possible to add that
[17:13:36] <pnkfelix> acrichto: It might be nice, if there's a clean API for it.
[17:13:40] <acrichto> in general the idea has been to use a native task for the sdl thread and you can use green threading elsewhere
[17:13:53] <acrichto> the api I would think of is to create a SchedPool and then have
[17:13:58] <acrichto> fn consume(self, f: proc())
[17:14:09] <acrichto> which runs the procedure on the current thread and then shuts down the thread
[17:14:19] <acrichto> also converting the calling thread into a scheduler
[17:16:39] <eddyb> acrichto: well, I would rather deriving(Hash) check whether the current crate has feature(default_type_params)
[17:17:01] <acrichto> I'd be down with that so long as it wasn't too painful
[17:17:08] <eddyb> acrichto: but I'll just switch it back to SipHash and let the experts fix it later
[17:18:01] <eddyb> s/back to SipHash/remove the type param
[17:18:02] *** Joins: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net)
[17:21:02] <strcat> nmatsakis: pnkfelix: https://github.com/mozilla/rust/pull/12520 I think that's a small step in the right direction (whatever we decide to do)
[17:21:13] <strcat> but renaming them is going to be really hard
[17:21:23] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:21:26] <strcat> I'm not sure how to approach it yet... due to stage0 deriving
[17:22:39] <acrichto> r? https://github.com/mozilla/rust/pull/12523
[17:22:53] *** Quits: glaebhoerl_ (glaebhoerl@moz-3590251D.kabelnet.hu) (Ping timeout)
[17:26:31] <pnkfelix> acrichto: would an inner attribute #[ignore(cfg(windows))]; work there, instead of that odd trailing suffix attribute?
[17:26:43] <pnkfelix> acrichto: (and if it would work, would it be more readable...?)
[17:26:53] <acrichto> pnkfelix: nah it has to do with the way that the iotest! macro works
[17:27:01] <acrichto> I could never figure out how to put attributes up front
[17:27:09] <pnkfelix> acrichto: ah well
[17:27:10] <acrichto> and the block becomes a separate function from the #[test] functions
[17:27:28] <acrichto> https://github.com/mozilla/rust/blob/master/src/libstd/io/test.rs#L21-L54
[17:27:41] <acrichto> if I put the attrs first it complains a lot about nt parsing and whatnot
[17:27:49] <acrichto> I think I am probably not enough of a macro wizard
[17:28:20] *** Quits: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro) (Ping timeout)
[17:29:14] <pnkfelix> acrichto: still think the suffix is weird.  Maybe add a variant to the macro that had a leading `ignored` literal and inserts the #[ignored] itself then?
[17:29:41] <acrichto> possible yeah, in theory we wouldn't need any of these ignore attributes :(
[17:29:44] <pnkfelix> acrichto: but then again, if it really bothers me, I'll hack up a solution myself after this lands.  :)
[17:31:54] <edwardw> r? https://github.com/mozilla/rust/pull/12508
[17:32:34] *** Joins: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro)
[17:32:38] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:33:48] <acrichto> edwardw: I'd defer that one to nmatsakis 
[17:33:59] <edwardw> hehe
[17:34:29] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[17:35:12] <edwardw> acrichto: a second? this then https://github.com/mozilla/rust/issues/12512#issuecomment-35890118
[17:35:15] <strcat> acrichto: does having hashmap in libcollections mean we can't use it in libstd?
[17:35:21] <strcat> it doesn't really seem like this can work
[17:35:24] <acrichto> strcat: indeed
[17:35:26] *** Joins: eibwen (kvirc@moz-E066B98A.dip0.t-ipconnect.de)
[17:35:28] <strcat> I thought we were going to switch TLS from O(n)
[17:35:48] <acrichto> TLS getting a hash map will not make it much faster
[17:35:51] <strcat> also, Vec should be in collections::
[17:36:00] <strcat> acrichto: depends on how much stuff you put in it
[17:36:03] <acrichto> vectors are arguably more core than collections
[17:36:07] <strcat> acrichto: why?
[17:36:21] <strcat> the intent of making Vec<T> was to have it act as a normal container
[17:36:22] <acrichto> a much higher percentage of programs use vectors than those that use other containers
[17:36:26] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[17:36:39] <acrichto> edwardw: sorry I'm not too familiar with expansion/hygiene and whatnot :(
[17:36:40] <strcat> so libstd vs. libfoo is based on % of code using stuff? why?
[17:36:45] <cmr> I don't think that's a reason to not have them in collections.
[17:36:48] <strcat> I would expect all collections to be in collections::
[17:36:58] <acrichto> I suppose if we could had vec in collections it'd be fine
[17:37:03] <acrichto> but that seems incredibly painful
[17:37:09] <SiegeLord> So now we won't be able to write vectors without linking extra libraries?
[17:37:14] <strcat> if it's in a separate libcollections, yes
[17:37:18] <acrichto> brson had a good suggestion of #[experimental] in libstd and #[stable] in collections though
[17:37:30] <acrichto> reexporting that is
[17:37:41] <strcat> the collections definitely aren't stable though, maybe I misunderstand
[17:37:55] <acrichto> oh just as a long term vision
[17:38:02] <acrichto> moving vectors will be super hard b/c they're used so much in libstd
[17:38:10] <acrichto> so they should probably stay in libstd for the implementation of libstd
[17:38:15] <acrichto> but we could block all usage through libstd
[17:38:20] <acrichto> and instead reexport them through libcollections
[17:38:27] <acrichto> and force all stable usage to go through libcollections instead
[17:38:43] <strcat> acrichto: or have a collections module in libstd, it's not like there's any non-generic code actually in the .so
[17:39:03] <acrichto> compile times are a little hurt though
[17:39:14] <acrichto> and I kinda like the surface area of libstd to be minimized
[17:39:59] <strcat> but what's the distinction?
[17:40:07] <strcat> if we aren't going to put all collections in libcollections
[17:40:18] <strcat> like, whatever the gc uses won't be in there
[17:40:35] <strcat> seems like a backwards compatibility hazard
[17:40:45] <acrichto> I'm fine with vectors moving into libcollections
[17:40:57] <strcat> well I'll send a PR doing that then
[17:40:58] <acrichto> we may just need more infrastructure to make it feasible
[17:41:07] <strcat> it's feasible today
[17:41:09] <strcat> nothing uses it
[17:41:10] <strcat> ;p
[17:41:18] <acrichto> I'd be wary then
[17:41:26] <acrichto> pcwalton is changing everything from ~[T] to Vec<T>
[17:41:38] <acrichto> the stdlib is definitely going to need vector builders in one form or another
[17:41:42] <strcat> if we can't export all collections in the same place then I think there's a problem though
[17:41:46] <acrichto> you may just want to coordinate with pcwalton if you're moving it
[17:41:47] <strcat> acrichto: it's also going to use maps in one form or another
[17:41:51] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:42:39] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:43:20] *** Quits: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro) (Ping timeout)
[17:43:26] <strcat> if we had a concurrent hash table, where would it go?
[17:43:31] <strcat> libcollections?
[17:43:33] <strcat> or libsync?
[17:43:55] <acrichto> I would guess libsync
[17:44:01] <acrichto> just a guess though
[17:44:29] *** Joins: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro)
[17:44:36] <strcat> splitting/unsplitting is backwards incompatible so I'm worried about it
[17:45:21] <strcat> seems problematic that using incremental compilation is a public API change
[17:45:33] <acrichto> every change we make to the stdlib is backwards incompatible
[17:45:37] <acrichto> (almost)
[17:45:56] <strcat> but other changes are scrutinized
[17:46:25] <cmr> r? https://github.com/mozilla/rust/pull/12524
[17:46:26] <acrichto> some changes are indeed scrutinized, not all of them though
[17:46:58] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[17:46:58] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14b156ff3 to 146720977: 02http://git.io/N3iJvQ
[17:46:58] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[17:48:06] *** Quits: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net) (Quit: dherman)
[17:48:11] <strcat> I just don't really get the current plan
[17:48:32] <eddyb> strcat: you're assuming there is a plan :P?
[17:48:58] <strcat> when we need containers in libstd we're going to have to move them out of libcollections
[17:49:29] <pnkfelix> strcat: Is there a PR that you are discussing with acrichto, or are you just talking abstractly about the trajectory?
[17:49:36] <strcat> abstractly
[17:52:01] <strcat> a Show impl for Gc needs a map to track cycles for examples
[17:52:04] *** Joins: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net)
[17:52:04] *** ChanServ sets mode: +ao dherman dherman
[17:52:05] <strcat> example*
[17:53:18] <acrichto> I would not believe that Gc should go in libstd
[17:53:53] <eddyb> libgarbage
[17:54:12] *** Quits: Guest (textual@16F167B.4C57D258.D8E8354F.IP) (Quit: My MacBook has gone to sleep. ZZZzzzâ€¦)
[17:54:45] <strcat> well, I don't really understand what the logic is behind what should and shouldn't be split
[17:54:48] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[17:54:48] *** ChanServ sets mode: +ao pcwalton pcwalton
[17:57:19] <eddyb> acrichto: I guess I should've asked you directly: any way to disable travis for a PR, before I can make sure I don't bother anyone with failures?
[17:57:42] <eddyb> though maybe what it does is good and I should embrace it
[17:57:50] <cmr> eddyb: why make a PR, if you know it fails?
[17:57:56] <acrichto> eddyb: not through travis I don't think, but we could add automation to check .travis.yml and skip the build for a particular string in a commit message
[17:58:06] <acrichto> but cmr does make a good point...
[17:58:26] <cmr> also I don't think anyone gets bothered by travis runs.
[17:58:52] <acrichto> I wish they did :(
[17:59:10] <eddyb> well, I feel bad ever since acrichto outed my couple of travis failures
[17:59:35] <acrichto> sorry :(
[18:00:18] <eddyb> ah don't worry
[18:00:50] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[18:01:11] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[18:01:54] <strcat> the tests don't run for me locally anymore
[18:01:57] <strcat> so...
[18:02:52] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[18:04:05] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:05:56] <eddyb> and erickt is gone again :/
[18:07:00] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[18:07:00] *** ChanServ sets mode: +o tjc
[18:08:25] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:08:25] *** ChanServ sets mode: +qo brson brson
[18:08:47] <eddyb> acrichto: this took me way longer than I'd like to admit. r? https://github.com/mozilla/rust/pull/12525
[18:17:45] <cmr> wow the makefiles are actually usable now.
[18:17:47] <cmr> acrichto: thanks!
[18:21:42] <eddyb> acrichto: the reason I dislike putting issue numbers in commits is that github will display all the versions of the commits on the issue in question
[18:21:56] <eddyb> it would be nice if it would hide those commits that are "unreachable"
[18:22:32] <acrichto> eddyb: it's true, but for historical purposes I think it's much more valuable
[18:23:36] <pnkfelix> acrichto: life got better for me after I started using huon's script for mapping to PR
[18:24:14] <cmr> I think we need better commit summaries.
[18:24:22] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[18:24:23] <cmr> something like the kernel does with dir: dir: dir
[18:24:30] <pnkfelix> acrichto: (maybe I will try to hack emacs into presenting that as part of the M-x vc-print-log output)
[18:24:40] <cmr> at the very least, cratename: foo
[18:25:20] <eddyb> cmr: I do arbitrary-area-name: sometimes
[18:26:07] <eddyb> acrichto: since I force-pushed to change the commit name, https://travis-ci.org/mozilla/rust/builds/19517496 if you want to keep an eye on the travis build
[18:26:30] <eddyb> though it's going to start a new one anyway *sigh*
[18:27:17] <acrichto> eddyb: can you cancel the previous one?
[18:27:22] <acrichto> or the subsequentone I guess
[18:27:41] <eddyb> if I can, I have no idea how to
[18:27:52] <eddyb> well, I'm not signed in, for one
[18:27:54] <acrichto> https://travis-ci.org/mozilla/rust/builds/19518470
[18:27:59] <acrichto> look in the top right
[18:28:00] <acrichto> oh
[18:28:03] <acrichto> that may help
[18:29:19] <eddyb> there's no controls
[18:29:28] <eddyb> I don't think it can tell it's my PR
[18:29:53] <cmr> it doesn't care.
[18:30:03] <cmr> cancelled.
[18:30:15] <cmr> travis is open source by the way.
[18:30:21] <cmr> you could totally add that feature
[18:30:29] <cmr> I think I have some code in their irc hook
[18:30:34] <cmr> don't remember if that pr got merged or not...
[18:30:41] <eddyb> cmr: which one did you cancel?
[18:30:49] <eddyb> https://travis-ci.org/mozilla/rust/pull_requests
[18:30:51] <cmr> the second one
[18:30:56] <cmr> https://travis-ci.org/mozilla/rust/builds/19518470
[18:31:02] <eddyb> that's not mine, heh
[18:31:05] <cmr> oop
[18:31:06] <cmr> s
[18:31:11] <eddyb> blame acrichto
[18:31:14] <cmr> acrichto: sorry :P
[18:31:19] <eddyb> https://travis-ci.org/mozilla/rust/builds/19518563 this is
[18:31:22] * cmr restarts
[18:31:38] <cmr> *now* it's killed.
[18:32:12] <acrichto> cmr: you monster!
[18:32:36] <eddyb> cmr: thanks :)
[18:32:41] <cmr> libc-out-of-std PR on its way.
[18:34:31] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[18:36:21] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[18:37:03] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[18:37:03] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1497420d6 to 146720977: 02http://git.io/N3iJvQ
[18:37:03] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[18:37:05] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[18:37:05] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/0g211Q
[18:37:05] <ghrust> 13rust/06auto 141dda504 15Alex Crichton: Correctly ignore some tests on windows...
[18:37:05] <ghrust> 13rust/06auto 14ca08cf8 15bors: auto merge of #12523 : alexcrichton/rust/ignore-some-windows-tests, r=pnkfelix...
[18:37:05] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[18:37:13] <eddyb> https://github.com/mozilla/rust/pull/12525 I wonder if it will remain forever "in progress"
[18:37:44] <pnkfelix> eddyb: patia
[18:37:51] <pnkfelix> eddyb: doh.  Ignore that.
[18:38:14] * eddyb wonders if it means anything at all
[18:39:02] <pnkfelix> eddyb: (it was *almost* "patina".  But it was an accident either way.)
[18:39:15] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[18:40:00] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:43:09] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:43:52] <eddyb> nmatsakis: I was going to make #12491 just about explicit deref, but changed my mind (I only posted the PR to get some discussion about operator overloads, which I've fixed in the other PR)
[18:44:42] <eddyb> nmatsakis: so only https://github.com/mozilla/rust/pull/12493 is ready, not the Deref* #12491
[18:46:25] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: rcirc on GNU Emacs 24.3.1)
[18:50:30] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[18:50:58] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:50:58] *** ChanServ sets mode: +qo brson brson
[18:53:10] *** Joins: glaebhoerl_ (glaebhoerl@3391DE98.E9231B2.A0179ACD.IP)
[18:56:09] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:00:19] <eddyb> acrichto: what's the story with https://github.com/mozilla/rust/pull/12525? should I change anything?
[19:00:19] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:00:47] <acrichto> eddyb: can you make it such that a struct is generated from feature gating and passed through to createing the tcx?
[19:01:05] <eddyb> acrichto: holding only default_type_params?
[19:01:06] <acrichto> it doesn't have to exhaustively list all features, but this seems like a generally useful structure to have on hand
[19:01:14] <acrichto> for now it will only have default type params
[19:01:20] <acrichto> it will possibly be expanded in the future
[19:01:32] <acrichto> macro expansion wants this for a few things
[19:01:49] *** Quits: sunfish (chatzilla@moz-42DA0C69.dsl.dynamic.sonic.net) (Ping timeout)
[19:03:10] <eddyb> mkay *reluctantly switches to the gate branch*
[19:06:03] *** Quits: rocode (rocode@moz-398826F7.clsp.qwest.net) (Quit: Leaving)
[19:08:13] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[19:17:06] *** Joins: japaric (japaric@78791742.A23A5F6C.E5B504CC.IP)
[19:25:04] *** Joins: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu)
[19:32:26] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Quit: Connection closed for inactivity)
[19:33:28] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[19:37:06] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[19:37:06] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14ca08cf8 to 146720977: 02http://git.io/N3iJvQ
[19:37:06] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[19:37:06] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[19:37:07] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/tr3tsw
[19:37:07] <ghrust> 13rust/06auto 141dda504 15Alex Crichton: Correctly ignore some tests on windows...
[19:37:07] <ghrust> 13rust/06auto 149c9d4c0 15bors: auto merge of #12523 : alexcrichton/rust/ignore-some-windows-tests, r=pnkfelix...
[19:37:07] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[19:37:57] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Quit: esummers)
[19:38:02] *** Joins: esummers (textual@moz-3B015C90.wi.res.rr.com)
[19:41:42] <brson> strcat: I did an experiment replacing various intrinsic wrappers with intrinsics, and it seems to provide significant wins, but has some outstanding semantic problems
[19:41:57] <strcat> brson: need to change how rustdoc shows them
[19:42:06] <brson> no, there's more. primarily i think that `extern "rust-intrinsic" is different than a rust function
[19:42:13] <strcat> brson: the ABI is the same
[19:42:21] <strcat> they're both extern "Rust" fn afaik
[19:42:22] <brson> strcat: but not their type
[19:42:31] <strcat> I think they're the same, maybe I'm wrong
[19:42:37] <strcat> they could be the same if they're not
[19:42:38] <brson> they are not
[19:42:44] <strcat> can fix that
[19:42:48] <brson> i'm also not sure what happens if you take the value of an intrinsic
[19:42:50] <strcat> the underlying ABI is Rust
[19:42:55] <brson> so far i can't figure out how to do it
[19:43:16] <acrichto> rusti: std::unstable::intrinsics::init
[19:43:23] -rusti- pastebinned 8 lines of output: http://ix.io/aaw
[19:43:28] <acrichto> brson: what kind of wins did you see?
[19:43:31] <acrichto> rusti: std::unstable::intrinsics::init::<int>
[19:43:33] -rusti- fn() -> int
[19:43:40] <strcat> repr is really dumb
[19:43:45] <acrichto> rusti: let a = std::unstable::intrinsics::init::<int>; a()
[19:43:46] -rusti- <anon>:10:57: 10:60 error: call to unsafe function requires unsafe function or block
[19:43:46] -rusti- <anon>:10         let a = std::unstable::intrinsics::init::<int>; a()
[19:43:46] -rusti-                                                                   ^~~
[19:43:46] -rusti- error: aborting due to previous error
[19:43:48] -rusti- application terminated with error code 101
[19:43:51] <strcat> I wrote that printing code
[19:43:53] <strcat> ;p
[19:44:03] <strcat> it doesn't know about lifetimes or anything because there was no way to get them
[19:44:13] * strcat knows how to fix it but... repr sucks
[19:44:20] <brson> acrichto: here are the numbers if you can interpret them https://gist.github.com/brson/9195532
[19:44:51] <eddyb> rusti: let f: || = proc() {}; f()
[19:44:54] -rusti- pastebinned 12 lines of output: http://ix.io/aHU
[19:45:06] <eddyb> hehe
[19:45:13] <strcat> brson: imo we could get a lot of wins from fiddling with these low-level things
[19:45:15] <eddyb> rusti: let f: || = proc() {}; f(); 42
[19:45:16] <strcat> could be wrong
[19:45:18] -rusti- pastebinned 12 lines of output: http://ix.io/aHV
[19:45:30] <acrichto> brson: looks like some good wins!
[19:45:33] <strcat> but I think the main issue causing slow compiles is bloat from expanding generics
[19:45:40] <eddyb> rusti: let f = proc() {}; let g: || = f; g()
[19:45:40] -rusti- <anon>:10:40: 10:41 error: mismatched types: expected `||` but found `proc:Send()` (expected many fn but found once fn)
[19:45:41] -rusti- <anon>:10         let f = proc() {}; let g: || = f; g()
[19:45:41] -rusti-                                                  ^
[19:45:41] -rusti- error: aborting due to previous error
[19:45:41] -rusti- application terminated with error code 101
[19:45:51] <eddyb> oh, odd
[19:46:05] <cmr> eddyb: procs are only once-callable.
[19:46:23] <eddyb> rusti: let f = proc() {}; fn foo(x: ||) {x()} foo(f)
[19:46:23] -rusti- <anon>:10:52: 10:53 error: mismatched types: expected `||` but found `proc:Send()` (expected many fn but found once fn)
[19:46:23] -rusti- <anon>:10         let f = proc() {}; fn foo(x: ||) {x()} foo(f)
[19:46:23] -rusti-                                                              ^
[19:46:23] -rusti- error: aborting due to previous error
[19:46:24] -rusti- application terminated with error code 101
[19:46:28] <eddyb> that's odd...
[19:46:37] <eddyb> cmr: there is code to perform that coercion, btw
[19:46:43] <strcat> brson: so I guess the 2 things to do are changing the type and changing rustdoc
[19:46:50] <cmr> eddyb: it's not safe.
[19:46:52] <eddyb> cmr: at least it looks like something else is preventing it
[19:46:56] <strcat> oh and I wanted to try doing lazy init of LLVM intrinsics...
[19:47:01] <doener> strcat: we're probably also triggering a few cases that llvm can't optimize as good as we maybe expect, e.g. the memcpys we do everywhere
[19:47:09] <eddyb> cmr: because it would totally borrow a proc as a closure :P
[19:47:13] <brson> strcat: i'd like to do this with reexports so we can leave the intrinsics where they are
[19:47:14] <strcat> doener: yeah rustc isn't great at codegen
[19:47:30] <brson> though rustdoc does need to display intrinsics differently
[19:47:31] <strcat> but I think the bigger problems are lib ones
[19:47:37] <brson> extern fns in generally rustdoc doesn't handle well
[19:47:55] <strcat> brson: well, I'd like rustdoc to not show them as different from regular fns
[19:48:00] <strcat> imo that's an implementation detail
[19:48:09] <strcat> once the type is the same at least
[19:48:19] <brson> i don't think i'm going to follow up with this right now because of the fiddly bits
[19:48:27] <strcat> for example
[19:48:34] <strcat> extern "C" { fn foo(); }
[19:48:41] <strcat> extern "C" fn foo() {}
[19:48:42] <eddyb> brson: those bits are the best!
[19:48:48] <strcat> I think those should show up the same way in the docs
[19:48:53] <strcat> (pretend they're pub, forgot!)
[19:48:58] <brson> eddyb: i know, i just have other things that i *should* be doing
[19:49:15] * eddyb could put out more than one PR per week if it weren't for all those bits :(
[19:49:25] <strcat> brson: I'm fine with doing it as re-exports
[19:49:31] <strcat> just want to get rid of layers of wrappers
[19:49:35] <strcat> like cast::transmute
[19:49:50] <eddyb> ohh I remember how silly transmute is for ~str
[19:50:05] <eddyb> with all the zeroing and the landing pad and the dtor check
[19:50:05] <strcat> hm?
[19:50:13] <eddyb> it's like 20 lines of IR
[19:50:32] <eddyb> I used it as an example somewhere, I think
[19:51:16] <eddyb> strcat: this https://github.com/mozilla/rust/issues/11445
[19:52:12] *** Quits: esummers (textual@moz-3B015C90.wi.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[19:52:27] <eddyb> it probably gets even sillier if you have more wrappers
[19:52:53] <eddyb> strcat: wait, is it a recent LLVM change?
[19:53:01] <strcat> hm?
[19:53:07] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[19:53:07] <eddyb> debug info on registers
[19:53:13] <strcat> dunno but it seems possible
[19:53:35] <eddyb> not that I care much for when debug info is turned on, you're paying the cost of generating all that data anyways
[19:53:54] <strcat> you just use llvm.dbg.value afaik
[19:54:04] <strcat> maybe it doesn't produce proper code
[19:54:10] <strcat> if you don't have the alloca with declare
[19:54:21] <strcat> can poke at clang
[19:54:37] *** Joins: mawuli (mawuli@moz-36C70B7D.com.gh)
[19:54:38] <eddyb> also relevant for https://github.com/mozilla/rust/pull/12424
[19:55:32] <strcat> LLVM does generate more efficient code with `const`
[19:55:56] <strcat> weird
[19:56:18] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[19:56:40] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:56:41] <eddyb> strcat: I want to have full adt support for constructing things like (0u8, 0u8) or Some(0u8) as one SSA value
[19:57:00] <eddyb> instead of an alloca, two GEPi's, two stores and a load
[19:57:04] <strcat> eddyb: try using llvm.dbg.value to deal with debug info instead of declare
[19:57:06] *** Joins: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com)
[19:57:30] <eddyb> well, I just gate my alloca elision code on !debuginfo
[19:58:24] <eddyb> and I don't know enough about debuginfo to make sure I'm not making it much worse, even if llvm.dbg.value works
[19:58:41] <cmr> eddyb: are there any measurements for that PR, as requested?
[19:58:44] <cmr> there are tons of debuginfo tests.
[19:59:57] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[20:00:02] *** Joins: esummers_ (textual@moz-3B015C90.wi.res.rr.com)
[20:00:04] <eddyb> cmr: there's like a 10s and 30MB difference, IIRC
[20:00:16] <eddyb> you sounded surprised it takes us to under 1GB
[20:00:20] <cmr> eddyb: go comment on that :P
[20:00:48] *** Quits: esummers_ (textual@moz-3B015C90.wi.res.rr.com) (Quit: Textual IRC Client: www.textualapp.com)
[20:02:21] <strcat> eddyb: http://nondot.org/sabre/LLVMNotes/DebugInfoVariableInfo.txt design doc for it
[20:02:32] <strcat> seems that llvm.dbg.value is indeed the way to put debug info on registers.
[20:05:47] *** Joins: esummers_ (esummers@moz-3B015C90.wi.res.rr.com)
[20:06:42] *** Quits: aurynj (Eon@583ABBE5.60FA2E28.B9E25744.IP) (Ping timeout)
[20:07:23] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Quit: esummers)
[20:07:47] <eddyb> cmr: done
[20:08:02] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:09:05] <cmr> huon: ping
[20:11:06] <eddyb> so I smell warm Xeon cores running benches?
[20:11:08] <eddyb> *do I
[20:11:21] <cmr> I hope you don't smell them
[20:11:23] <cmr> that'd be worrying.
[20:11:49] <cmr> no was going to ask about #12495 but I just made a comment on github instead
[20:13:40] <strcat> acrichto: btw make check is broken with --disable-rpath ;s
[20:13:48] <strcat> that's why I can't run tests anymore! oh well
[20:13:48] *** Quits: edwardw (edwardw@96E7298D.3E260003.B9C6B12A.IP) (Quit: Leaving...)
[20:14:15] <cmr> can we have one of the bots using disable-rpath to make sure it doesn't break?
[20:14:16] * strcat abuses travis more
[20:14:32] <acrichto> what's broken about it?
[20:15:05] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[20:15:05] *** ChanServ sets mode: +ao pcwalton pcwalton
[20:15:34] <strcat> acrichto: the xcrate tests fail
[20:15:43] <acrichto> ugh
[20:15:49] <strcat> needs LD_LIBRARY_PATH
[20:16:14] <strcat> acrichto: i guess windows doesn't run these tests...
[20:17:02] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:17:09] <eddyb> acrichto: argh I have to change the signature of phase_2_configure_and_expand... well, at least there's no more rustpkg to use this stuff :P
[20:19:22] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[20:20:42] <acrichto> eddyb: stuff like this may belong in the session
[20:20:55] <acrichto> all of then as Cell<bool>
[20:21:12] <eddyb> time to rip out this thing *sigh*
[20:21:33] <eddyb> (should've thought earlier)
[20:21:58] <acrichto> sorry :(
[20:23:42] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[20:23:42] <ghrust> [13rust] 15alexcrichton 04force-pushed 06try from 149e8d5aa to 148752fcf: 02http://git.io/k471pw
[20:23:42] <ghrust> 13rust/06try 14007cc94 15Alex Crichton: windows: Fix the test_exists unit test...
[20:23:42] <ghrust> 13rust/06try 148752fcf 15Alex Crichton: windows: Improve some error reporting in tests...
[20:23:43] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[20:24:55] <eddyb> acrichto: don't be sorry for my mistakes >_>
[20:25:01] <eddyb> (and my editor has undo :P)
[20:25:58] *** Quits: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[20:26:40] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[20:33:27] <acrichto> zomg windows
[20:34:02] <strcat> windows loves you too
[20:34:20] <eddyb> what did it do now?
[20:34:45] * eddyb looks at the suspect-looking pile of glass shards on the floor
[20:34:53] <acrichto> keeps failing on fs tests
[20:34:55] * nrc spent the weekend installing Windows 8 and getting used to it - not fun
[20:35:11] <eddyb> I had one of those in a VM
[20:35:27] <eddyb> shutting it down gracefully was just not work the dance
[20:35:35] <eddyb> *worth
[20:35:52] <nrc> nmatsakis: do you have a code example that uses lifetime variance? I couldn't work out how to actually get sub-lifetimes (if that is the right word)
[20:37:01] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[20:37:01] <ghrust> [13rust] 15bors 04force-pushed 06auto from 149c9d4c0 to 146720977: 02http://git.io/N3iJvQ
[20:37:01] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[20:37:04] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[20:37:04] <ghrust> [13rust] 15bors pushed 6 new commits to 06auto: 02http://git.io/1C5CVQ
[20:37:04] <ghrust> 13rust/06auto 14768b96e 15Huon Wilson: green: remove ancient register-saving code....
[20:37:04] <ghrust> 13rust/06auto 1406e3e63 15Huon Wilson: flate: return CVec<u8> rather than copying into a new vector....
[20:37:05] <ghrust> 13rust/06auto 148b246fd 15Huon Wilson: green,native,rustuv: Replace many pointer `transmute`'s with `as` or referencing....
[20:37:07] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[20:37:12] *** Joins: gimpf (gimpf@moz-74F352A8.adsl.highway.telekom.at)
[20:39:42] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[20:41:00] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:42:04] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[20:42:04] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14bac9e7d to 146720977: 02http://git.io/N3iJvQ
[20:42:04] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[20:42:05] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[20:42:05] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/SRfU2w
[20:42:05] <ghrust> 13rust/06auto 14c0e767b 15Alex Crichton: Correctly ignore some tests on windows...
[20:42:05] <ghrust> 13rust/06auto 1413a8fcd 15Alex Crichton: windows: Fix the test_exists unit test...
[20:42:05] <ghrust> 13rust/06auto 1468a4f7d 15bors: auto merge of #12523 : alexcrichton/rust/ignore-some-windows-tests, r=pnkfelix...
[20:42:07] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[20:43:42] *** Quits: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com) (Client exited)
[20:43:45] <nmatsakis> nrc: there are examples in the tests
[20:45:32] <nrc> nmatsakis: do you remember the test names?
[20:46:18] <eddyb> acrichto: well, this took forever. r? https://github.com/mozilla/rust/pull/12525
[20:46:27] <eddyb> at least it compiles :P
[20:47:22] <cmr> r? https://github.com/mozilla/rust/pull/12526
[20:47:32] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:47:34] <nmatsakis> nrc: the easiest way to get a sublifetime is 'static and so on
[20:47:47] <acrichto> eddyb: thanks!
[20:47:53] <nmatsakis> nrc: let me find the tests for you though
[20:48:00] <acrichto> liblibc
[20:48:19] <nmatsakis> nrc: e.g. regions-infer-covariance-due-to-decl.rs
[20:48:23] <nmatsakis> nrc: there are many such tests,
[20:48:33] <strcat> moving libc out would be nice
[20:48:42] <strcat> then libclang would be a drop-in replacement
[20:48:56] <nmatsakis> nrc: they rely on a little-known typing rule, described here: http://smallcultfollowing.com/babysteps/blog/2013/04/04/nested-lifetimes/
[20:49:01] <brson> strcat: why is libclang a replacement for libc?
[20:49:13] <nmatsakis> nrc: (actually I've been wanting to tighten up some of the code related to that, which is a bit sketchy)
[20:49:23] <nrc> nmatsakis: awesome, thanks!
[20:49:29] <eddyb> brson: that doesn't sound right
[20:49:39] <strcat> brson: if we implemented bindgen in resolve
[20:49:46] <eddyb> ahh
[20:49:50] <strcat> so rust would work with alternate libc ABIs
[20:50:05] <cmr> acrichto: I originally called it libc but the makefile wanted liblibc
[20:50:18] <strcat> can you call it 'c' ? ;p
[20:50:24] <cmr> I don't want to :(
[20:50:28] <strcat> c::int
[20:50:41] <strcat> oh well, I like it
[20:50:43] <strcat> ;p
[20:50:47] <eddyb> strcat: any idea how much information libclang provides?
[20:50:56] <strcat> eddyb: everything you could ever want
[20:51:07] <eddyb> I wanted something that can be called from trans to output IR for calls to C++
[20:51:12] <strcat> you have the AST
[20:51:16] <eddyb> but it doesn't have to be that powerful
[20:51:38] <eddyb> strcat: does it help with mangling, low-level type representation, and other things?
[20:51:45] <cmr> brson: it can parse the headers and give us sizes and members etc.
[20:51:53] <eddyb> I don't want to replicate much of the backend :/
[20:51:55] *** Joins: arrrrrrrrr (arrrrrrrrr@moz-DD295EAA.dynamic.qsc.de)
[20:52:03] <strcat> eddyb: I guess
[20:52:25] <strcat> eddyb: why not just ask it to generate IR?
[20:52:37] <strcat> brson: also we could use inline functions from headers
[20:52:45] <strcat> that'd be neat
[20:52:53] <eddyb> strcat: but how I can make it generate IR?
[20:53:02] <strcat> and it'd be able to get the __attribute__((nothrow)) etc. stuff
[20:53:13] <eddyb> (it's essential for calls to templates and stuff, I guess)
[20:53:16] <strcat> eddyb: I forget, the API is really big
[20:53:24] <eddyb> strcat: there's nothing in the C API that looks like it does IR
[20:53:35] <cmr> clang even has a C API?
[20:53:50] <eddyb> cmr: libclang *is* the C API :P
[20:54:09] <eddyb> everything else is just clang, I guess
[20:55:55] <strcat> cmr: unlike LLVM I think libclang actually has a nice C API
[20:56:05] <cmr> well that's nice
[20:56:20] <strcat> because it was designed later and intended to be used by editors, etc.
[20:56:22] <eddyb> it has to have a nice C API, people are using it from LISP to make magic tools :P
[20:57:36] <strcat> cmr: I'd say the reason is that LLVM's API can be C++ without C/C++ losing out, but libclang needs a good C API or C/C++ would work poorly in some editors :P
[20:57:48] <cmr> heh
[20:57:50] <eddyb> well, I hope this is over with by tomorrow https://github.com/mozilla/rust/pull/12493
[20:57:59] <eddyb> and then I go back to deref
[21:00:33] <erickt> eddyb: how hard would it be to get `#[deriving(Hash)]` to use `impl<W: Writer> Hash<W> for $T { ... }` when `#[feature(default_type_params)]` is on?
[21:01:55] <erickt> eddyb: because without it it'll be a pain to have to write custom `Hash` impls to use xxHash
[21:02:12] <eddyb> erickt: not very hard... just need to expose that information to libsyntax
[21:02:36] <erickt> or whatever pcwalton wanted to do to make servo HashMaps faster
[21:02:39] <eddyb> librustc's Session already has the new Features struct
[21:02:57] <brson> maybe it's time to just turn on default_type_params
[21:02:58] <eddyb> just need to find a place to stick it in libsyntax
[21:03:08] <brson> would be nice to prototype allocators first though
[21:03:21] <strcat> brson: well I did implement them before
[21:03:21] <eddyb> brson: after all the dances we've made with feature gating?
[21:03:28] <pcwalton> brson: I'd be fine with turning on default type params
[21:03:31] <eddyb> strcat: now they can work!
[21:03:42] <strcat> brson: generic dtors didn't work then though
[21:04:11] <eddyb> for the record, generic dtors were much easier to fix than the popular opinion
[21:04:20] <pcwalton> you still can't call trait methods in them though right?
[21:04:25] <strcat> pcwalton: you can now
[21:04:30] <pcwalton> oh, you can?
[21:04:31] <pcwalton> I thought you couldn't
[21:04:34] <strcat> eddyb fixed it
[21:04:37] <eddyb> pcwalton: that was the bug
[21:04:43] <pcwalton> oh, ok
[21:04:50] <pnkfelix> eddyb: well there's still the concern nmatsakis raised about extra trait bounds that aren't respected by all impls, right?
[21:05:04] <strcat> pnkfelix: well you have to be careful about it ;)
[21:05:12] <eddyb> that just leads to types that don't have the dtors
[21:05:19] <pnkfelix> eddyb: "just"
[21:05:20] <eddyb> (which may be what you want)
[21:05:21] <pcwalton> hmm, let's at least discuss that at the meeting
[21:05:24] <pcwalton> it's tomorrow
[21:05:26] <pcwalton> so should be fine
[21:05:50] <pcwalton> the std lib is so much nicer this week than it was last week :)
[21:06:06] * eddyb pets DerefImm
[21:06:13] *** Joins: tjc (tjc@moz-791C24B0.phlapa.east.verizon.net)
[21:06:13] *** ChanServ sets mode: +o tjc
[21:06:17] <eddyb> pcwalton: and hopefully even nicer by next week :D
[21:07:07] <brson> nmatsakis: can you verify that this optimization is valid https://github.com/mozilla/rust/pull/12494
[21:07:38] <pcwalton> I have a plan discussed with acrichto to make hello world with the stdlib much smaller
[21:07:38] <nmatsakis> brson: ok, but on phone, can you ping me again (or add comment to PR)
[21:07:53] <brson> nmatsakis: yeah, i'll ping you on the pr
[21:08:13] <huon> cmr: pong (briefly)
[21:08:41] <cmr> huon: does https://github.com/mozilla/rust/pull/12495 work on windows?
[21:08:45] <eddyb> pcwalton: does it involve interesting TLS trickery? cc me
[21:09:06] <eddyb> but not until after a short nocturnal break -> bed
[21:09:39] <acrichto> eddyb: the idea is https://github.com/mozilla/rust/issues/12455 plus https://github.com/mozilla/rust/issues/11560
[21:09:49] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[21:09:49] <ghrust> [13rust] 15huonw 04force-pushed 06try from 148752fcf to 14729bdd3: 02http://git.io/k471pw
[21:09:49] <ghrust> 13rust/06try 14729bdd3 15Huon Wilson: use libnative for rustc and rustdoc binaries....
[21:09:49] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[21:10:00] <huon> cmr: no idea, we'll find out
[21:10:05] <eddyb> acrichto: ah, cool :)
[21:10:22] <acrichto> huon: I had a try build running previous
[21:10:25] <acrichto> previously
[21:10:28] <acrichto> (just plz don't cancel)
[21:10:56] <huon> acrichto: multiple try builds are ok, aren't they?
[21:11:03] <acrichto> oh yeah
[21:11:04] *** Quits: blank_name (blank_name@463DB555.53526368.6D228269.IP) (Quit: leaving)
[21:11:10] <acrichto> I just always cancel everything after I push to try
[21:11:12] <acrichto> just a heads up
[21:11:54] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[21:12:28] *** Joins: blank_name (blank_name@463DB555.53526368.6D228269.IP)
[21:12:45] <pnkfelix> hmm.  libuv has bugs that are being exposed by rustc, and our solution is to stop using libuv with rustc... I have mixed feelings...  But I guess it is the appropriate engineering call for such a critical part of infrastructure.
[21:13:17] <huon> pnkfelix: the "main" motivation is to have an up-to-date rusti
[21:13:27] <huon> so that we don't have to apologise for
[21:13:29] <huon> rusti: 
[21:13:31] -rusti- pastebinned 7 lines of output: http://ix.io/a6T
[21:13:33] <huon> crashing
[21:13:43] <pnkfelix> huon: but the problem here is that now if we inject libuv bugs
[21:13:50] <pnkfelix> huon: then they'll mostly likely only be exposed by servo ?
[21:14:19] <pnkfelix> huon: this is what worries me: that the rustc build itself will cease to have as thorough a test bed...
[21:14:22] <huon> pnkfelix: we still run all the io and channel tests under both libgreen and libnative
[21:14:43] <huon> Not as comprehensive as having the full compiler build
[21:15:01] <huon> (but then the same reasoning applies to libnative in the current situation.)
[21:15:42] <pnkfelix> huon: does #12495 provide an easy way to swap libgreen back in as the host runtime for rustc + rustdoc, e.g. a confgure switch ?
[21:16:01] <huon> pnkfelix: it doesn't, but I guess it could
[21:16:17] <huon> Hm... wait. The no_uv attribute can't be toggled.
[21:16:22] <pnkfelix> huon: I'm mostly wondering if it might make sense to be able have a low-priority task that still does the build that way, as an extra way to catch fault injections.
[21:16:42] <pnkfelix> "low-priority bot", I mean
[21:16:49] <huon> acrichto: what happens with #[no_uv]; and an explicit `extern mod green;`? does rustuv still get linked in?
[21:17:19] <acrichto> no
[21:17:35] <huon> acrichto: (or, what happens without #[no_uv] and use of only `extern crate native`?)
[21:17:39] <acrichto> all I/O will fail with Err(unimplemented())
[21:17:51] <acrichto> #[no_uv] == don't link in green/rustuv by default
[21:17:52] <acrichto> and that's it
[21:17:53] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:18:01] <acrichto> native doesn't interact with green/rustuv
[21:18:33] <huon> so using only native would link in green/rustuv but then they'd be unused and so not in an optimised binary?
[21:19:04] <acrichto> they're linked in unless #[no_uv]; is specified
[21:19:09] <acrichto> we don't currently optimize away linked libraries
[21:19:17] <acrichto> unless the system linker does that already
[21:19:48] <cmr> pnkfelix: rustc isn't catching extra bugs.
[21:19:56] <cmr> pnkfelix: all it does is file and stdio.
[21:20:04] <huon> acrichto: ok
[21:20:24] <cmr> pnkfelix: this itself was only exposed through a series of pipes...
[21:21:01] <acrichto> pnkfelix: oh the stdtest suite is a much better testing ground for libgreen than rustc
[21:21:13] <pnkfelix> acrichto: fair enough
[21:21:17] <acrichto> pnkfelix: I've never found a bug in libgreen through using rustc that wouldn't have been exposed by stdtest
[21:22:03] <pnkfelix> acrichto: cmr: there is clearly *some* bug here that is being exposed by the current setup, even if only exposed in some broader context.
[21:22:16] <pnkfelix> acrichto: cmr: (with the series of pipes feeding rusti, etc)
[21:22:20] *** Quits: arrrrrrrrr (arrrrrrrrr@moz-DD295EAA.dynamic.qsc.de) (Quit: arrrrrrrrr)
[21:22:37] <pnkfelix> acrichto: cmr: But I admit that is different than the rustc build itself.
[21:22:43] <acrichto> I am unaware of such bugs, is there an issue open for this?
[21:23:02] <strcat> acrichto: well that's the main incentive for switching rustc to native
[21:23:05] <pnkfelix> acrichto: ... why would you approve #12495 without being aware of such?
[21:23:09] <strcat> I think there's an issue
[21:23:21] <strcat> (and it's why rusti is out-of-date, it can't use my nightly package)
[21:23:24] <acrichto> pnkfelix: the switch to libnative for the compiler is fine by me, switcing *everything* is not find by me right now
[21:23:30] <strcat> it's not caused by the sandboxing
[21:23:31] <acrichto> I don't understand why rusti can't use librustc
[21:23:36] <strcat> acrichto: deadlocks
[21:23:47] <strcat> caused by libuv
[21:23:49] <acrichto> all I've heard is that rusti doesn't work, but rusti does lots of stuff with containers and whitelists
[21:23:52] <strcat> it does something weird to the pipes
[21:24:01] <acrichto> isn't the current one using libuv?
[21:24:03] <strcat> acrichto: I turned off the containers and seccomp
[21:24:05] <acrichto> is there an issue open on this?
[21:24:12] <strcat> acrichto: no it's using rustc with libnative
[21:24:17] <strcat> I am pretty sure there's an issue
[21:24:27] <pnkfelix> strcat: acrichto: I'd like to learn more about the deadlocking cases, since I'm wrestling with what look like deadlocks on my BDW integrated runtime builds...
[21:24:44] <acrichto> what is this deadlocking issue?
[21:24:46] <strcat> pnkfelix: are you on linux?
[21:24:46] <pnkfelix> (though in my case it seems like my deadlocks are with libnative, not libgreen...)
[21:24:53] <pnkfelix> strcat: no, Mac OS X.
[21:24:55] <pnkfelix> strcat: oh wait
[21:25:04] * strcat confused
[21:25:09] <pnkfelix> strcat: the most recent deadlocks i've been looking at are on Linux, in a VM
[21:25:17] <strcat> with libnative though?
[21:25:29] <pnkfelix> strcat: yeah.  I have been assuming it is some artifact of BDW
[21:25:40] <strcat> ah well I've only run into this problem with libgreen
[21:25:43] <pnkfelix> strcat: but I haven't been able to figure out how that's possibly the case.
[21:25:52] <strcat> before it happens libuv does a bunch of invalid stuff
[21:25:53] <strcat> so I blame libuv
[21:25:59] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[21:26:08] <strcat> watching the syscalls shows them returning EINVAL, etc.
[21:26:15] <pnkfelix> strcat: is there an issue with any info?  I would like to compare the scenarios
[21:26:34] <strcat> well I can replicate it
[21:26:57] <pnkfelix> strcat: I'll have to gather similar traces.  It was only today that I managed to get the behavior down to a small replicatable case (though it can take up to 50 iterations before I see it.)
[21:27:13] <strcat> rusti: 2
[21:27:14] -rusti- playpen: bind mount: No such file or directory
[21:27:14] -rusti- application terminated with error code 1
[21:27:20] *** Quits: eddyb (eddy@moz-41DB10DA.residential.rdsnet.ro) (Ping timeout)
[21:27:54] <strcat> rusti: 2
[21:27:55] -rusti- <anon>:3:1: 3:11 error: `extern mod` is obsolete, use `extern crate` instead to refer to external crates.
[21:27:58] -rusti- <anon>:3 extern mod extra;
[21:28:00] * strcat sighs
[21:28:00] -rusti-          ^~~~~~~~~~
[21:28:02] -rusti- error: aborting due to previous error
[21:28:04] -rusti- application terminated with error code 101
[21:28:44] * strcat sighs
[21:28:46] <strcat> rusti: 2
[21:28:51] -rusti- timeout triggered!
[21:28:59] <strcat> rusti: 2
[21:29:04] -rusti- timeout triggered!
[21:30:31] <strcat> acrichto: it can't even display the help
[21:30:40] <strcat> wait sec
[21:31:16] <strcat> yeah it breaks something about the pipe
[21:31:32] <strcat> printing the help doesn't deadlock
[21:31:43] <strcat> instead it causes the pipe to become invalid
[21:31:47] <strcat> it closes it or something
[21:31:55] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:32:43] <pnkfelix> acrichto: on a totally different subject
[21:33:02] <acrichto> strcat: it's tough for me to debug anything with just that information
[21:33:08] <pnkfelix> acrichto: that Q I had this morning, about firing up M:N-1 on a thread other than the main thread
[21:33:12] <strcat> acrichto: I know, I don't know why it deadlocks in futex
[21:33:18] <strcat> or why the pipe becomes invalid
[21:33:26] <strcat> I doubt it's something libgreen does wrong, it's libuv's fault
[21:33:33] *** Joins: sunfish (chatzilla@moz-BBE3ABD.mv.mozilla.com)
[21:33:38] <strcat> although node.js doesn't have problems
[21:33:56] <cmr> I wasn't able to successfuly debug it either, but I spent an evening on it.
[21:34:06] <pnkfelix> acrichto: is either of libgreen::start or libnative::start going to work for that scenario?  Or do I need to make a different `start` fn that is hacked together by me peering at both?
[21:35:06] <acrichto> pnkfelix: you'd want libnative::start and then start a thread pool manually
[21:35:41] <pnkfelix> acrichto: k thx
[21:38:45] <acrichto> http://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20140224/205968.html wheeeeee
[21:40:05] <nrc> So, in our dead code analysis, if we ahve `trait t : t2` where does t2 get marked as live? (assuming t is live)
[21:40:11] <nrc> *have
[21:41:00] <huon> nrc: I think all traits are considered live for now
[21:41:32] <huon> (at least, every trait is considered exported, and iirc, dead_code starts considering the set of exported items as live.)
[21:42:12] <nrc> Oh I see, that would explain why I couldn't find that code then :-p
[21:42:18] <nrc> thanks huon!
[21:42:55] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[21:44:35] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[21:50:01] *** Quits: Tari (tari@moz-36ED7575.lug.mtu.edu) (Quit: Moving host.)
[21:52:10] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[21:52:11] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/SRfU2w
[21:52:11] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[21:54:34] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:55:08] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:57:06] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[21:57:07] <ghrust> [13rust] 15bors pushed 6 new commits to 06auto: 02http://git.io/qNvCPA
[21:57:07] <ghrust> 13rust/06auto 14768b96e 15Huon Wilson: green: remove ancient register-saving code....
[21:57:07] <ghrust> 13rust/06auto 1406e3e63 15Huon Wilson: flate: return CVec<u8> rather than copying into a new vector....
[21:57:07] <ghrust> 13rust/06auto 148b246fd 15Huon Wilson: green,native,rustuv: Replace many pointer `transmute`'s with `as` or referencing....
[21:57:09] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[22:04:10] *** Quits: Diamond (dick@moz-80556682.ks.ks.cox.net) (Ping timeout)
[22:04:46] *** Joins: Diamond (dick@moz-80556682.ks.ks.cox.net)
[22:05:20] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[22:07:46] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:10:15] *** Quits: glaebhoerl_ (glaebhoerl@3391DE98.E9231B2.A0179ACD.IP) (Ping timeout)
[22:10:51] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:13:56] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:15:36] <huon> cmr: the libnative patch passed on try-bsd
[22:18:48] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:20:47] *** nrc is now known as nrc|afk
[22:22:03] <cmr> cool
[22:22:31] <nmatsakis> brson: I think that change is safe
[22:29:28] *** Quits: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net) (Quit: dherman)
[22:34:26] <huon> acrichto: the failure of https://github.com/mozilla/rust/pull/12445 doesn't seem like something that will be fixed with a retry?
[22:34:41] <acrichto> huon: this log,r ight? http://buildbot.rust-lang.org/builders/auto-linux-32-opt/builds/4471/steps/test/logs/stdio
[22:34:49] <huon> yeah?
[22:34:56] <huon> oh, the failure is in compiletest
[22:35:07] <acrichto> yeah that's just an intermittent error
[22:35:07] <huon> so maybe it will...
[22:35:17] <acrichto> we have some really weird error where spawned children have stdout/stderr closed too soon
[22:35:22] <acrichto> and everyone starts seeing a BrokenPipe
[22:35:26] <huon> bleh :(
[22:35:27] *** Quits: mawuli (mawuli@moz-36C70B7D.com.gh) (Broken pipe)
[22:35:41] <acrichto> I have no idea why, but this has been plaguing us for months
[22:36:07] <huon> have you been able to reproduce it reliably? (or, reproduce it at all?)
[22:36:18] <acrichto> I've never been able to even reproduce it
[22:36:24] <acrichto> which is the worst part :\
[22:36:32] <acrichto> I tried to enable core dumps awhile back
[22:36:36] <acrichto> but it didn't help much
[22:36:40] <huon> :(
[22:36:43] <acrichto> this also only happens on linux
[22:36:46] <acrichto> I've never seen it on osx
[22:37:05] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[22:37:05] <ghrust> [13rust] 15bors 04force-pushed 06auto from 145d3a381 to 1468a4f7d: 02http://git.io/N3iJvQ
[22:37:05] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[22:37:56] *** Quits: gimpf (gimpf@moz-74F352A8.adsl.highway.telekom.at) (Quit: Leaving.)
[22:38:44] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[22:38:44] *** ChanServ sets mode: +ao dherman dherman
[22:40:04] <acrichto> huon: that windows failure sounds like directory listing/walking is broken on windows
[22:40:12] <acrichto> for libnative
[22:41:42] <larsberg> is -z extra-debug-info gone with no replacement now? I saw https://github.com/mozilla/rust/issues/12280  and assume we should just be passing -g in all cases now?
[22:41:44] <huon> acrichto: that sounds like a reasonable explanation
[22:42:03] <sfackler> larsberg: -g is equivalent to -Z extra-debug-info
[22:42:05] <huon> larsberg: -g is the exact replacement for -Z extra-debug-info
[22:42:10] <larsberg> fantastic :-)
[22:42:28] *** Joins: mawuli (mawuli@moz-36C70B7D.com.gh)
[22:43:55] <huon> acrichto: have fun diagnosing that :P
[22:43:56] <larsberg> I apologize that I will probably sound like a blast from 2013 for the rest of this week with "hey, what happened to modes?" as I port servo...
[22:44:11] * huon leaves
[22:44:25] * larsberg begs huon to stay
[22:44:50] * huon should've left home 30 minutes ago :P
[22:47:10] *** Quits: jensnock_ (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[22:47:13] *** Quits: canhtak (canhtak@moz-8C86DA1D.wl.t.ulaval.ca) (Quit: canhtak)
[22:47:50] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[22:48:16] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[22:48:43] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Quit: huon)
[22:49:06] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[22:49:18] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[22:49:51] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:59:22] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[22:59:22] *** ChanServ sets mode: +ao pcwalton pcwalton
[23:03:26] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[23:04:27] *** jld is now known as jld|commute
[23:23:21] *** Quits: lkuper (lkuper@moz-AD4C50F5.dhcp-bl.indiana.edu) (Quit: lkuper)
[23:40:03] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[23:40:35] <brson> nmatsakis: thanks
[23:43:51] <strcat> brson: do you get notifications from the bors repo? https://github.com/graydon/bors/pull/21
[23:43:54] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[23:44:01] <strcat> acrichto: ^
[23:44:27] *** jld|commute is now known as jld
[23:44:29] <brson> strcat: yes
[23:44:57] <brson> that pr is exciting
[23:45:03] <strcat> basho makes riak
[23:45:04] <brson> I'm glad somebody is improving bors
[23:45:09] <strcat> I wonder which project they're using it for
[23:45:21] <strcat> guess I could look at their bot's account ;p
[23:45:28] <brson> lol @ https://github.com/borshop
[23:45:40] <brson> their bot is named after Bishop from Aliens
[23:45:41] <brson> <3
[23:45:55] <brson> and he's located on the Sulaco!
[23:52:06] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[23:52:06] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/oKTwHQ
[23:52:06] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[23:57:17] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[23:57:17] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/Z7qulQ
[23:57:17] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[23:57:42] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
