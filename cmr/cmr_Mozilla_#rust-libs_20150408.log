[00:19:31] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Quit: Leaving.)
[00:27:27] *** Joins: Rym (y@moz-m9s4ac.in-addr.btopenworld.com)
[00:31:41] *** Quits: Rym (y@moz-m9s4ac.in-addr.btopenworld.com) (Ping timeout: 121 seconds)
[00:44:31] *** Joins: Rym (y@moz-m9s4ac.in-addr.btopenworld.com)
[01:20:18] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[01:27:18] *** Joins: brson (brson@moz-rjb.pdv.48.37.IP)
[01:27:18] *** ChanServ sets mode: +qo brson brson
[01:59:10] *** Quits: Rym (y@moz-m9s4ac.in-addr.btopenworld.com) (Ping timeout: 121 seconds)
[02:28:07] *** Quits: brson (brson@moz-rjb.pdv.48.37.IP) (Quit: leaving)
[02:45:56] *** Quits: kimundi (kimundi@moz-94ap69.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[02:47:25] *** Joins: kimundi (kimundi@moz-rc14cs.dip0.t-ipconnect.de)
[02:51:24] *** kimundi is now known as zz_kimundi
[02:58:00] *** zz_kimundi is now known as kimundi
[09:24:29] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[09:35:38] *** kimundi is now known as zz_kimundi
[10:01:47] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: Bye)
[10:18:14] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[10:21:18] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[10:35:00] *** Quits: nrc (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[10:46:20] *** Joins: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP)
[10:46:20] *** ChanServ sets mode: +o pnkfelix
[12:14:37] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[12:14:44] *** zz_kimundi is now known as kimundi
[12:24:51] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Quit: Bye)
[15:57:30] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[16:25:58] *** kimundi is now known as zz_kimundi
[16:25:58] *** Joins: simukis (nagisa@moz-8t068g.static.zebra.lt)
[16:45:31] *** Quits: pnkfelix (pnkfelix@moz-6v5.3nd.202.89.IP) (Quit: rcirc on GNU Emacs 24.3.92.1)
[17:30:56] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[17:30:56] *** ChanServ sets mode: +qo brson brson
[17:51:44] *** zz_kimundi is now known as kimundi
[18:56:47] *** Joins: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de)
[18:56:53] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[18:57:45] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[18:57:45] *** ChanServ sets mode: +qo brson brson
[20:54:48] *** Joins: nrc (nrc@moz-4bhi2i.xtra.co.nz)
[20:54:48] *** ChanServ sets mode: +qo nrc nrc
[20:55:23] *** Joins: simukis1 (nagisa@moz-8t068g.static.zebra.lt)
[20:57:23] *** Quits: simukis (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[21:43:22] <SimonSapin> acrichto: do you expect to stabilize libarena? Also, in the TypedArena code, why does the `first` field have to be a refcell when `start` and `end` can be Cell s?
[21:43:47] <SimonSapin> or, what makes this unsafe code safe?
[21:44:16] <huon> I would assume we'd publish arena on crates.io rather than stabilise
[21:46:05] <SimonSapin> well TypedArena itself uses allocate() and needs_drop() which are not stable, but it’s maybe plausible to work around with Vec
[21:46:36] <SimonSapin> the reflection-based Arena I wouldn’t even try
[21:47:27] <SimonSapin> but the latter question remains: I don’t know how to convince myself that this unsafe code is sound
[21:58:05] <SimonSapin> https://github.com/rust-lang/rust/issues/24153#issuecomment-91048262
[22:03:16] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[22:07:05] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[22:07:05] *** ChanServ sets mode: +qo brson brson
[22:08:20] <acrichto> SimonSapin: yeah we don't currently plan on stabilizing libarena, but providing the tools for it to build on stable sounds like a good idea!
[22:08:28] *** Quits: killercup (killercup@moz-edmf2j.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[22:08:53] <SimonSapin> acrichto: allocate() and deallocate() would be a good start
[22:09:01] <acrichto> yeah definitely
[22:09:16] <SimonSapin> though the work around is not too bad
[22:10:41] <nmatsakis> ha
[22:10:43] <nmatsakis> that's like the poster child
[22:10:50] <nmatsakis> for code that will break when we start doing tracing support :)
[22:11:16] <SimonSapin> how so?
[22:11:51] <nmatsakis> you put roots into an arena; we have to ensure they get traced -- it's generic over all T, so it could certainly contain roots
[22:12:35] <SimonSapin> so every collection-like things like arena would have to support tracing explicitly?
[22:12:53] <nmatsakis> unclear
[22:13:00] <nmatsakis> but possibly, yes
[22:13:10] <nmatsakis> depends on what strategy we eventually adopt
[22:13:16] <nmatsakis> (we've worked through designs that don't require that)
[22:13:40] <nmatsakis> (but they have their share of problems)
[22:13:51] <nmatsakis> it occurs to me that types like Unique might actually help a lot here
[22:14:04] <nmatsakis> since they ought to be an indicator that a *mut is safe to deref etc
[22:14:17] <nmatsakis> ("tracing support" might mean as little as annotating or using Unique etc instead of raw *mut)
[22:15:13] <SimonSapin> I’d like to use arena, but I don’t feel confident it maintaining it myself to make sure it’s sound :]
[22:16:03] <SimonSapin> like, why does the `first` field have to be a refcell when `start` and `end` can be Cell s?
[22:17:59] <nmatsakis> SimonSapin: I suspect it does not have to be RefCell, based on a quick read
[22:18:08] <nmatsakis> looks like it's being used only in Cell-like ways
[22:57:08] *** kimundi is now known as zz_kimundi
[23:01:46] *** Quits: simukis1 (nagisa@moz-8t068g.static.zebra.lt) (Quit: Leaving.)
[23:41:44] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
