[00:00:08] *** Quits: mdup (mdup@moz-2989B319.rev.numericable.fr) (Quit: mdup)
[00:00:09] *** Joins: kelvin (kelvin@A4314F81.63B79338.DDE5D3F6.IP)
[00:01:34] *** Quits: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu) (Quit: lkuper)
[00:02:07] *** Joins: jstevans (Instantbir@4B844119.A9DA0237.DDE5D3F6.IP)
[00:02:40] *** Parts: kelvin (kelvin@A4314F81.63B79338.DDE5D3F6.IP) ()
[00:02:41] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Ping timeout)
[00:03:37] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: Textual IRC Client: www.textualapp.com)
[00:04:49] <sfackler> it seems like something that should be added along with modular exponentiation
[00:04:56] *** Joins: SteveMcQwark (steven099@moz-7CFCF343.cpe.net.cable.rogers.com)
[00:05:42] <strcat> sfackler: or we should drop it and use a robust third party lib
[00:06:01] <strcat> it's very slow
[00:06:02] <kmc> that makes sense; GHC uses libgmp for its Integers
[00:06:11] <kmc> note that this causes some problems when linking to C libraries that also use libgmp
[00:06:17] <strcat> not just constant factor slow - it has a much higher time complexity
[00:06:30] <kmc> I think because they modify gmp to use a custom allocator or something, but I don't recall all the details
[00:07:24] <kmc> and yeah, in Python the pow() function has an optional third argument for a modulus
[00:07:33] <kmc> in which case it uses an efficient modexp algorithm
[00:07:34] *** Quits: SteveMcQwark (steven099@moz-7CFCF343.cpe.net.cable.rogers.com) (Connection reset by peer)
[00:07:56] <strcat> kmc: I'm mostly talking about stuff like *
[00:08:02] <strcat> the time complexity is higher than gmp
[00:08:12] <strcat> it's ~100x slower with fairly large numbers and gets worse
[00:09:56] *** Joins: SteveMcQwark (steven099@moz-7CFCF343.cpe.net.cable.rogers.com)
[00:10:43] <erickt> xandy: sadly I don't know much more about BigInt math to help
[00:10:53] <strcat> kmc: http://gmplib.org/manual/Multiplication-Algorithms.html#Multiplication-Algorithms
[00:11:27] <kmc> *nod*
[00:11:27] *** Quits: SteveMcQwark (steven099@moz-7CFCF343.cpe.net.cable.rogers.com) (Connection reset by peer)
[00:11:53] <kmc> (actually GHC also has a standalone pure Haskell implementation of Integer; you can choose either when building the compiler)
[00:12:07] <strcat> gmp is LGPL so that's a bit of a problem, I guess
[00:12:16] <kmc> yeah that's one reason why people use the pure Haskell one :/
[00:12:27] <xandy> np just wanted to make sure i didn't just overlook it before i implement a poor mans version erick
[00:12:32] * pnkfelix tries to remember how competitive Larceny's bignums were ...
[00:12:38] *** Joins: fyolnish (fyolnish@moz-914C7DB7.uqwimax.jp)
[00:12:50] <strcat> pnkfelix: vs gmp? nothing is :)
[00:12:53] *** Quits: yonran (yonran@moz-962F33EB.acuitus.com) (Ping timeout)
[00:13:01] <strcat> nothing FOSS is*
[00:13:08] <pnkfelix> strcat: no, not vs gmp, I wouldn't expect to beat that
[00:13:20] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[00:13:28] <pnkfelix> strcat: but there's plenty of interesting middle ground between "terrible" and gmp.
[00:13:47] <strcat> pnkfelix: if the time complexity is worse (which it usually is), it's pretty terrible ;p
[00:14:21] *** Quits: fyolnish (fyolnish@moz-914C7DB7.uqwimax.jp) (Ping timeout)
[00:14:58] *** Joins: SteveMcQwark (steven099@moz-7CFCF343.cpe.net.cable.rogers.com)
[00:15:06] * strcat shrugs
[00:15:28] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[00:17:09] *** Quits: maik (maik@moz-6A162886.dip0.t-ipconnect.de) (Ping timeout)
[00:19:17] <pnkfelix> strcat: well, we (Larceny) didn't go all the way to Schönhage-Strassen, but during my time it at least migrated to Karatsuba (from the grade-school O(N^2) algorithms).  The main thing is that I remember the code being pretty readable in the end...
[00:19:50] *** Joins: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP)
[00:24:18] *** Joins: jordyd (jordyd@moz-2A2F592B.seg45.ucf.edu)
[00:27:03] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[00:28:33] *** Joins: darius_ (darius@48F4515E.3B38BA72.1E7C11E5.IP)
[00:28:39] *** Quits: robn (robn@moz-76B0302C.static.internode.on.net) (Quit: Coyote finally caught me)
[00:28:50] *** Quits: darius_ (darius@48F4515E.3B38BA72.1E7C11E5.IP) (Quit: Leaving)
[00:29:01] *** Joins: robn (robn@moz-76B0302C.static.internode.on.net)
[00:29:04] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[00:29:10] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[00:29:10] *** ChanServ sets mode: +o pnkfelix
[00:29:40] *** Joins: Astana11 (Astana1111@48F4515E.3B38BA72.1E7C11E5.IP)
[00:30:40] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[00:32:36] *** Joins: mdup (mdup@moz-2989B319.rev.numericable.fr)
[00:33:48] <pnkfelix> (hmm, skimming through the bigint code and comparing against Larceny's bignums, I notice that Rust's bigints cut off the Karatsuba recursion pretty far down, e.g. I think when there's only one digit left on some side.
[00:35:04] <pnkfelix> Larceny's cutoff is a bit higher up, at e.g. 10 digits: https://github.com/larcenists/larceny/blob/master/src/Lib/Common/bignums.sch#L1265
[00:35:12] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[00:42:08] <jdm> rust-pkg tutorial \o/
[00:42:16] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[00:46:20] *** Quits: tikue_ (tkuehn@B46F4FD2.21C37D63.689607DE.IP) (Quit: tikue_)
[00:46:46] *** Quits: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP) (Ping timeout)
[00:48:06] <CurlyBrace> Phew!  Thank you guys so much for the OS help!
[00:48:44] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[00:49:35] <dbaupp> CurlyBrace: you should tell more of the class to come on here/#cs4414 :)
[00:49:42] <CurlyBrace> NO
[00:49:53] <CurlyBrace> I need to hog you guys for myself
[00:49:59] <CurlyBrace> :P
[00:50:05] *** jorendorff is now known as jorendorff_away
[00:50:35] <dbaupp> haha, nooo, we need to suck more possible contributors away from their class work. :P
[00:51:14] <CurlyBrace> Let's be honest, how much are you guys paying our prof to have the class in rust?
[00:51:26] *** Parts: judder (maradukewa@1BB87CE.111872A8.950D3BB5.IP) ()
[00:52:28] *** Joins: tikue_ (tkuehn@B46F4FD2.21C37D63.689607DE.IP)
[00:52:32] <tjc> CurlyBrace: I'm not allowed to tell you that, but I might be allowed to tell you about the island he's buying ;-)
[00:52:55] <CurlyBrace> ooh
[00:53:35] *** Quits: threecreepio (jdp@moz-9C11F46E.cust.bredbandsbolaget.se) (Quit: threecreepio)
[00:54:47] *** Joins: Yeri (jasonjasmi@41C91A8A.CE609BA5.E39FBF79.IP)
[00:55:21] <Astana11> Does anyone know the reasoning behind switching the 'loop' keyword to 'continue', instead of something more descriptive? Besides ubiquity that is... I've always disliked 'continue' and it makes me sad :(
[00:55:35] *** Joins: Jesin (Jessin_@moz-A11FEBC.cc.lehigh.edu)
[00:55:45] <Eridius> Astana11: I imagine the primary reason is the fact that most languages use 'continue' as the keyword here
[00:55:47] <tjc> Astana11: Because people disliked 'loop' and complained
[00:56:00] *** Quits: CurlyBrace (Mibbit@794413A4.B8CF995A.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:56:22] *** Quits: jordyd (jordyd@moz-2A2F592B.seg45.ucf.edu) (Ping timeout)
[00:56:22] <Eridius> silly people
[00:56:50] <dbaupp> (e.g. at least one person was under the impression that Rust didn't have a way to `continue` at all.)
[00:57:09] <engla> I think it's because everyone expected continue, most assumed it was unimplemented rather than under another name
[00:57:15] <engla> yeah exactly
[00:57:20] <bogen> continue onto the next loop pass...
[00:58:47] <Astana11> I've always found that 'continue' implies that something was stopped/not continuing anyway. Why not just 'skip' or something 
[00:59:06] *** Quits: mdup (mdup@moz-2989B319.rev.numericable.fr) (Quit: mdup)
[00:59:24] <tikue_> Astana11: i think the general consensus is that it's not worth a bikeshed, but it is worth the congruency
[00:59:28] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[01:00:27] <bogen> Astana11: continue looping with the next item. I know what you mean though, but many of us have gotten use it (continue) and don't have an issue with it
[01:01:47] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:01:50] <Astana11> bogen: I know, its just one of those things I always OCD'd about when I had to write
[01:05:32] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:05:36] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[01:07:07] <jason_> where can i find the definition of the iterator! macro?
[01:07:13] <amatus> i've got use std::rt::io::Writer and std::rt::io::file::FileWriter but I'm still getting: error: type `std::rt::io::file::FileWriter` does not implement any method in scope named `write`
[01:07:18] <amatus> i thought i had this figured out
[01:07:29] <tikue_> jason_: whoa, what's the iterator! macro do?
[01:07:32] <tikue_> o_o
[01:07:51] <dbaupp> jason_: I don't think there is one?
[01:08:28] *** Quits: nkoep (nik@moz-23D35B28.vpn.rwth-aachen.de) (Client exited)
[01:08:33] <dbaupp> jason_: oh, unless you mean the iterator! in vec, smallintmap and ringbuf? that's defined locally to each file
[01:08:45] <jason_> dbaupp: yes that
[01:08:59] <dbaupp> jason_: lines 2278, 183 and 210 & 232 respectively
[01:09:12] * dbaupp wonders why ringbuf has 2
[01:09:12] <jason_> somehow i missed that
[01:09:20] <amatus> not even use std::rt::io::* and std::rt::io::file::* work
[01:09:23] <dbaupp> oh, the second is iterator_rev
[01:09:40] <dbaupp> amatus: code?
[01:10:16] *** Joins: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net)
[01:10:57] <amatus> Path("/dev/null").open_writer(Open).unwrap().write(~[]); or something
[01:11:39] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[01:12:58] *** Joins: fyolnish (fyolnish@moz-8DD2C967.uqwimax.jp)
[01:13:30] <dbaupp> amatus: do you have any sub-`mod`s?
[01:14:10] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:14:39] <strcat> pnkfelix: the gmp code is so unreadable that they put the 1 function per file rule in place :)
[01:14:40] *** Quits: fyolnish (fyolnish@moz-8DD2C967.uqwimax.jp) (Ping timeout)
[01:15:23] <amatus> dbaupp: i think so, i just tried to make a simple example and it didn't fail
[01:16:14] <amatus> ok i got it
[01:16:25] <strcat> pnkfelix: and it probably has a lot of bugs... due the complexity
[01:16:26] <dbaupp> amatus: the `use` is only for the mod in whch you write it, *not* the file or any children
[01:16:33] *** Joins: Ralith (ralith@moz-36466B9F.customer.broadstripe.net)
[01:16:34] <strcat> due to the*
[01:16:36] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[01:17:17] <amatus> i don't know what that means but i've fixed it, thanks
[01:18:48] <pnkfelix> strcat: yeah, I'm not that surprised.
[01:19:47] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[01:20:09] *** Joins: sammykim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[01:20:13] <pnkfelix> strcat: You've sounded pretty focused on the asymptotic issues in the current bigint implementation, but do you think we need to jump to https://en.wikipedia.org/wiki/Sch%C3%B6nhage%E2%80%93Strassen_algorithm ?
[01:20:23] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[01:20:28] <dbaupp> amatus: as in `mod foo { use bar; mod baz { /* bar isn't in scope */ }`
[01:20:36] <dbaupp> }
[01:20:54] <pnkfelix> strcat: I've been assuming we could get a lot of mileage out of just fixing up the current implementation to be smarter about when it resorts to karatsuba
[01:21:01] <amatus> i think i shadowed write
[01:21:07] <amatus> with a later "use"
[01:21:29] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[01:21:42] <strcat> pnkfelix: yeah, I'm sure we could make it an order of magnitude faster just by micro-optimizing
[01:21:45] <strcat> and our vectors are very slow atm
[01:21:47] <strcat> so that's a problem too
[01:22:32] <sammykim> When I get crash, how can I see backtrace log for that? I guess I just putted "RUST_LOG=::rt::backtrace" front of command before.
[01:22:52] <sammykim> But It seem to be changed. : ( Anyone can help me ?
[01:22:53] <Luqman> sammykim: use gdb
[01:23:00] <strcat> pnkfelix: https://github.com/mozilla/rust/issues/8981 I put numbers there since you last looked at it, btw
[01:23:08] <Luqman> sammykim: break on rust_begin_unwind
[01:23:09] <sammykim> Thanks!
[01:23:12] <strcat> although I can't say how much is from the alternate representation and how much is from saner code
[01:23:30] <pnkfelix> strcat: yeah I saw the numbers, but I was surprised by them and wanted to investigate them myself before I commented
[01:23:39] <sammykim> Luqman : was the backtrace module removed?
[01:23:54] <Luqman> yea, the new runtime doesn't have that capability
[01:24:07] <Luqman> and i think it only worked on linux anywasy
[01:24:07] <pnkfelix> strcat: hopefully soon...
[01:24:08] <sammykim> Thanks a lot :) 
[01:24:15] *** Joins: yeri_ (yeri@41C91A8A.CE609BA5.E39FBF79.IP)
[01:25:14] *** Quits: skade (skade@moz-62C07CE7.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[01:25:35] <kmc> anyone have thoughts on whether inlining C++ functions into Rust code via LLVM link-time optimization is something that could possibly be made to work?
[01:25:50] <strcat> kmc: I've done it
[01:25:55] <kmc> nice
[01:25:59] <strcat> kmc: (with runtimeless rust)
[01:26:09] <strcat> clang can compile rust's IR output
[01:26:44] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[01:26:49] <kmc> there's this problem (which we are hitting in Servo) where C++ classes may have a lot of accessor functions which they expect to get inlined, but if you wrap those in extern "C" and import them usually then they don't of course
[01:27:07] *** Quits: yeri_ (yeri@41C91A8A.CE609BA5.E39FBF79.IP) (Quit: Colloquy for iPhone - http://colloquy.mobi)
[01:27:12] <Ralith> kmc: LTO on the wrappers?
[01:27:22] <Ralith> oh
[01:27:24] <Ralith> that was the topic
[01:27:32] <strcat> kmc: are the C++ classes from spidermonkey? or something else
[01:27:51] <Ralith> kmc: you can make clang output LLVM bitcode files which rust can load, or vis versa, and it should Just Work.
[01:28:32] <dbaupp> strcat: https://github.com/mozilla/servo/wiki/Meeting-2013-09-30#js-memory-management-issues (yes)
[01:29:32] <strcat> kmc: or we could just use libclang to support directly using C libraries via headers ;p
[01:30:00] *** Joins: maik (maik@moz-6A162886.dip0.t-ipconnect.de)
[01:30:11] <kmc> strcat: spidermonkey and also netsurfcss (which we're going to replace anyway, but a short term fix could be nice)
[01:30:19] <kmc> and I expect we'll run into this again with another library
[01:30:40] <dbaupp> kmc: replace spidermonkey?? or just netsurfcss
[01:30:50] <dbaupp> ?
[01:30:52] <strcat> kmc: so they have C++ types with methods defined in headers?
[01:30:57] *** Quits: simao (simao@moz-1B4B74CC.pools.arcor-ip.net) (Ping timeout)
[01:31:17] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[01:31:37] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[01:32:44] <kmc> replace netsurfcss I meant
[01:32:48] <kmc> strcat: yeah
[01:33:22] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Ping timeout)
[01:33:46] <kmc> I guess if they are in headers then it's not so simple as "compile with clang -> LTO" because what do you compile?
[01:34:23] <strcat> kmc: it's easy to link them together with LTO but actually having rust call C++ wouldn't be easy
[01:34:52] *** Joins: sw17ch (sw17ch@moz-675AFBCF.hsd1.mi.comcast.net)
[01:34:55] <kmc> so really the LTO inlining would happen between the extern "C" wrappers and the Rust code
[01:35:00] <strcat> yeah
[01:35:02] <kmc> strcat: yeah
[01:35:15] *** Quits: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net) (Ping timeout)
[01:35:27] <kmc> (by which i mean C++ functions with extern "C")
[01:35:29] *** Joins: simao (simao@moz-1B4B74CC.pools.arcor-ip.net)
[01:35:35] <Luqman> there's some talk about how a possible c++ ffi would be here https://github.com/mozilla/rust/issues/5853
[01:36:11] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[01:36:20] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[01:36:32] <amatus> >.<
[01:36:37] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[01:36:37] <amatus> i can't open /dev/null
[01:36:44] <amatus> BECAUSE IT'S NOT A FILE
[01:37:22] <amatus> this is the 2nd time i've coded everything up the "rustic" way and had to back down to raw libc calls!
[01:37:48] <mcpherrin> amatus: welcome to bugland, home of the bugs.  Would you like a bug with your bug?
[01:37:50] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[01:37:52] <dbaupp> strcat: rusti is gone?
[01:38:11] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:39:30] <kmc> rusti: ~"hi"
[01:39:31] -rusti- error: internal compiler error: unexpected failure
[01:39:31] -rusti- note: the compiler hit an unexpected failure path. this is a bug
[01:39:31] -rusti- note: try running with RUST_LOG=rustc=1 to get further details and report the results to github.com/mozilla/rust/issues
[01:39:31] -rusti- ~"hi"
[01:39:45] <strcat> rustc -v still has problems
[01:39:55] <kmc> so i see :/
[01:40:04] *** Joins: jordyd (jordyd@moz-EE95E34E.seg159.ucf.edu)
[01:41:11] * kmc -> afk
[01:41:23] *** Joins: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net)
[01:43:08] *** Quits: maik (maik@moz-6A162886.dip0.t-ipconnect.de) (Ping timeout)
[01:46:44] *** Quits: jordyd (jordyd@moz-EE95E34E.seg159.ucf.edu) (Ping timeout)
[01:47:43] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:48:23] *** Joins: eatkinson (eatkinson@moz-261EDE03.hsd1.ca.comcast.net)
[01:50:27] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My lid went down)
[01:50:53] *** Quits: valenting (Thunderbir@55FBCC0.8C025854.E16F0CF5.IP) (Ping timeout)
[01:56:17] *** Joins: MauricioC (mauricioc@moz-2CFCD404.impa.br)
[01:57:53] *** Quits: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net) (Ping timeout)
[01:59:42] *** Joins: jordyd (jordyd@moz-EE95E34E.seg159.ucf.edu)
[01:59:44] *** Quits: cdidd (cdidd@moz-86EE38A5.broadband.corbina.ru) (Input/output error)
[02:01:17] *** Joins: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net)
[02:04:02] *** Quits: jstevans (Instantbir@4B844119.A9DA0237.DDE5D3F6.IP) (Ping timeout)
[02:04:08] *** Quits: joone_ (joone@moz-C50DC051.jf.intel.com) (Ping timeout)
[02:04:16] *** Joins: adu (ajr@moz-BF2B1AE4.washdc.fios.verizon.net)
[02:04:24] *** Joins: joone_ (joone@moz-C50DC051.jf.intel.com)
[02:08:10] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Quit: Leaving.)
[02:09:56] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:10:05] *** Joins: pheleas_frog (Mibbit@F83974A6.8AC0943A.1CA757F6.IP)
[02:10:23] *** Quits: pheleas_frog (Mibbit@F83974A6.8AC0943A.1CA757F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:10:48] *** Joins: Larry (larryfox@26EE99DC.88C61CC9.ECED8BE3.IP)
[02:13:18] *** Joins: fyolnish (fyolnish@moz-A0EDC817.uqwimax.jp)
[02:15:02] *** Quits: fyolnish (fyolnish@moz-A0EDC817.uqwimax.jp) (Ping timeout)
[02:17:25] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[02:20:41] <fread2281> rusti: do 10.times().iterate |x| {print(fmt!(x));}
[02:20:41] -rusti- <anon>:7:47: 7:48 error: first argument to fmt! must be a string literal.
[02:20:41] -rusti- <anon>:7          do 10.times().iterate |x| {print(fmt!(x));}
[02:20:42] -rusti-                                                         ^
[02:20:42] -rusti- application terminated with error code 101
[02:20:56] <fread2281> rusti: do 10.times().iterate |x| {print(fmt!("%?", x));}
[02:20:57] -rusti- pastebinned 11 lines of output: http://sprunge.us/DMKU
[02:21:28] *** Quits: canhtak (jeremy@moz-82E9E6D2.wl.t.ulaval.ca) (Quit: canhtak)
[02:21:47] *** Joins: jstevans (Instantbir@moz-22A27CD4.bootp.virginia.edu)
[02:22:20] *** Joins: cdidd (cdidd@moz-9474A946.broadband.corbina.ru)
[02:22:58] *** Joins: nrc (nrc@8F761026.B5EF4AF6.E96CA9D8.IP)
[02:23:02] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[02:25:48] <engla> fread2281: I don't recognize that iterate method
[02:26:07] <engla> rusti: do 2.times() { println("A") }
[02:26:07] -rusti- A
[02:26:07] -rusti- A
[02:26:08] -rusti- ()
[02:26:31] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[02:27:27] *** jorendorff_away is now known as jorendorff
[02:27:52] *** Quits: riley (riley@8BA43816.9AA11D69.65DDFA89.IP) (Client exited)
[02:28:03] *** Joins: z0w0 (zack@64F0E14B.3C29B4A9.2CE63F58.IP)
[02:29:21] *** Quits: cdidd (cdidd@moz-9474A946.broadband.corbina.ru) (Input/output error)
[02:30:48] *** Quits: tikue_ (tkuehn@B46F4FD2.21C37D63.689607DE.IP) (Quit: tikue_)
[02:31:24] *** nrc is now known as nrc|afk
[02:32:12] *** Quits: kimundi (kimundi@moz-FECF1514.dip0.t-ipconnect.de) (Ping timeout)
[02:32:13] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[02:33:04] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[02:33:44] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[02:35:18] *** Joins: cdidd (cdidd@moz-CBCBB94E.broadband.corbina.ru)
[02:35:28] *** Joins: zz_kimundi (kimundi@moz-F02A6FA4.dip0.t-ipconnect.de)
[02:35:42] *** Joins: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP)
[02:35:49] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[02:35:50] *** zz_kimundi is now known as kimundi
[02:36:11] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse)
[02:36:16] *** Quits: Larry (larryfox@26EE99DC.88C61CC9.ECED8BE3.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[02:36:44] *** Quits: jordyd (jordyd@moz-EE95E34E.seg159.ucf.edu) (Ping timeout)
[02:36:57] *** Quits: tautologico (lymph@7A53DAF8.92451A23.6EB699AE.IP) (Quit: tautologico)
[02:40:09] *** Quits: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP) (Client exited)
[02:40:20] *** Quits: cdidd (cdidd@moz-CBCBB94E.broadband.corbina.ru) (Input/output error)
[02:41:44] <mcpherrin> why was printf! removed? What's the alternative? print(fmt!( again?
[02:42:26] <strcat> mcpherrin: fmt! is deprecated
[02:42:29] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[02:42:30] <strcat> being removed soon
[02:42:48] <mcpherrin> print(format!( then? I haven't bothered to look at the new format!
[02:42:54] <strcat> mcpherrin: http://static.rust-lang.org/doc/master/std/fmt/index.html
[02:42:57] *** Joins: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP)
[02:43:01] <strcat> there are print! and println!
[02:43:19] *** Quits: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP) (Client exited)
[02:43:20] <mcpherrin> awesometimes.
[02:43:20] <dbaupp> rusti: println!("{} {} {}", 1, "foo", 1.234)
[02:43:21] -rusti- 1 foo 1.234
[02:43:21] -rusti- ()
[02:43:22] *** Joins: cdidd (cdidd@moz-B3E0E0AD.broadband.corbina.ru)
[02:44:37] <sam113101> rusti print("tost");
[02:44:42] <sam113101> rusti: print("tost");
[02:44:42] -rusti- tost()
[02:45:00] *** Joins: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP)
[02:45:07] <mcpherrin> rusti: println!("{1} {} {0}", 1, 2, 3) // the fmt docs on positional params are unclear for this case
[02:45:07] -rusti- <anon>:7:38: 7:39 error: argument never used
[02:45:07] -rusti- <anon>:7          println!("{1} {} {0}", 1, 2, 3) // the fmt docs on positional params are unclear for this case
[02:45:08] -rusti-                                                ^
[02:45:08] -rusti- error: aborting due to previous error
[02:45:08] -rusti- application terminated with error code 101
[02:45:23] *** Quits: cdidd (cdidd@moz-B3E0E0AD.broadband.corbina.ru) (Ping timeout)
[02:45:24] <sam113101> rusti: print("to\nst");
[02:45:25] -rusti- to
[02:45:25] -rusti- st()
[02:45:26] <mcpherrin> rusti: println!("{1} {} {0}", 1, 2)
[02:45:26] -rusti- 2 1 1
[02:45:26] -rusti- ()
[02:47:09] <dbaupp> acrichto: ^
[02:47:19] *** Joins: ChrisMorgan (chris@moz-736C88F0.its.monash.edu.au)
[02:47:20] <sam113101> is it verified at compile time or runtime?
[02:47:42] <mcpherrin> sam113101: format strings? compile time
[02:47:50] <sam113101> sweet
[02:48:02] <acrichto> dbaupp: that's intentional
[02:48:16] <acrichto> {} is like an iterator over the arguments
[02:48:24] <acrichto> each use bumps the count of what to look at next
[02:48:33] *** Joins: tendernooblet (Mibbit@moz-10B0023F.ny325.east.verizon.net)
[02:48:34] <acrichto> and so long as you use all the arguments it doesn't complain
[02:48:40] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[02:48:45] <fread2281> rusti: use std::str; range(1,10).map(|x|str::from_byte(x as u8)).fold(0, |x, y|x + y)
[02:48:45] -rusti- <anon>:7:85: 7:86 error: mismatched types: expected `<VI2>` but found `~str` (expected integral variable but found ~str)
[02:48:46] -rusti- <anon>:7          use std::str; range(1,10).map(|x|str::from_byte(x as u8)).fold(0, |x, y|x + y)
[02:48:46] -rusti-                                                                                               ^
[02:48:46] -rusti- error: aborting due to previous error
[02:48:47] -rusti- application terminated with error code 101
[02:48:52] <fread2281> how can I get that to work?
[02:49:04] <mcpherrin> acrichto: I think the docs are unclear on that -- The behaviour is sensible, but the docs, to me, seem to indicate it means "After the previously used argument"
[02:49:20] <mcpherrin> So I'd expect {} following {1} to be equivalent to {2}
[02:49:44] <acrichto> mcpherrin: oh hm where in the docs?
[02:50:03] <mcpherrin> and if omitted it is assumed to be "the next argument".
[02:50:08] <mcpherrin> that phrase in particular
[02:50:32] <acrichto> mcpherrin: ah I see, I'll clarify that with some more explicit wording
[02:51:10] <luisbg> good night
[02:53:26] *** Joins: DanC (connolly@moz-CAC8C247.dyn.everestkc.net)
[02:54:00] <DanC> have you guys seen this "Replacing Python" series? http://roscidus.com/blog/blog/2013/06/20/replacing-python-round-2/
[02:54:16] <DanC> I'm starting to think my shop is outgrowing python too
[02:55:01] <tendernooblet> Hrm, I'm sort of lost here.. if anyone has a moment can someone tell me what I'm not quite getting.. I have code: http://pastebin.com/PPKsusDY Basically I'm trying to return a value created with a closure and Rust is fighting me, although I'm trying to do something very sensible.
[02:55:27] <DanC> "Rust has excellent safety and a familiar imperative syntax. It also has excellent support for shared libraries, ... Rust’s main weakness is its immaturity. "
[02:56:10] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[02:56:22] *** Parts: TMaster (quassel@moz-D7771805.upc-h.chello.nl) (http://quassel-irc.org - Chat comfortably. Anywhere.)
[02:56:57] <mcpherrin> DanC: sounds about right
[02:57:14] <jdm> what happened to println!?
[02:57:22] <DanC> interestingly, that 0install went with ocaml ;-)
[02:57:43] <DanC> tendernooblet, I wonder if you'll need to return a managed pointer
[02:57:48] <dbaupp> jdm: nothing, in fact, printfln got removed in favour of it
[02:57:48] <DanC> where do you expect the result to be stored?
[02:58:02] * jdm is super confused
[02:58:20] <jdm> I'm on a master rust build and printfln! isn't recognized
[02:58:33] <dbaupp> jdm: yes, printfln! was removed
[02:58:46] <jdm> oh
[02:58:48] <dbaupp> println! (without the f) is the new one
[02:59:03] <sam113101> and that's why I'm waiting for 1.0 in order to start learning rust
[02:59:37] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[02:59:58] <jdm> what's the replacement for %?
[03:00:05] <strcat> you'll be waiting an awfully long time for the stdlib to be stable
[03:00:12] <jdm> example.rs:28:19: 28:20 error: failed to find an implementation of trait std::fmt::Default for ~[~Blah]
[03:00:13] <dbaupp> jdm: {:?}
[03:00:15] <jdm> example.rs:28   println!("{}\n", a);
[03:00:17] <jdm> thanks
[03:00:18] <strcat> format is essentially a library feature
[03:00:24] <dbaupp> sam113101: that's no fun :P
[03:00:26] <sam113101> will it be stable when 1.0 comes out?
[03:00:42] <dbaupp> jdm: you don't need the \n with println, unless you want an empty line
[03:00:52] <strcat> sam113101: the stdlib? considering that language's like ruby/python don't have a stable stdlib API, I wouldn't think so
[03:00:55] <tendernooblet> @DanC: I want to use the iterator in say a for loop or convert it to a vector.
[03:00:58] <strcat> there will be varying degrees of stability promises
[03:01:07] <strcat> languages like*
[03:01:21] <tendernooblet> @DanC I don't want the result to be stored anywhere though I'm just setting up a chain of iterator transformations to make a lazy list.
[03:01:36] <DanC> maybe your function should take a function argument, then
[03:01:44] <DanC> if you return a value, it has to be stored somewhere
[03:01:54] *** Joins: zheitny (nick@moz-B41B4B6D.neo.res.rr.com)
[03:02:12] <strcat> tendernooblet: you can't return a Filter iterator with a local closure
[03:02:18] <strcat> it's a limitation of rust's closures
[03:02:33] <strcat> stack closures do not exist in the type system - they're borrowed to &fn immediately, and can't outlive the stack frame
[03:02:50] <tendernooblet> So.. how does one use them usefully?
[03:03:07] <DanC> (a) return a manged closure (b) take a function parameter
[03:03:24] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[03:03:27] <DanC> I think (b) is more idiomatic (but I'm new to these parts)
[03:03:37] <tendernooblet> When I tried a managed closure I got 'managed closures are not supported' on 0.8.
[03:03:42] <strcat> filter takes &fn
[03:03:53] <dbaupp> also, @fn has been removed
[03:04:02] <DanC> shows you what I know
[03:04:11] <tendernooblet> Taking a function parameter doesn't exactly make sense to me, you mean take a function parameter and then call it with the iterator?
[03:04:19] <DanC> really? managed closures have just gone poof?
[03:04:19] *** Quits: doomlord_ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Quit: Leaving)
[03:04:23] *** Quits: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Quit: Leaving)
[03:04:34] *** Joins: cdidd (cdidd@moz-7D391056.broadband.corbina.ru)
[03:04:40] <strcat> DanC: yes
[03:04:51] <strcat> closures are the weakest point of the language, they need to be redone
[03:04:52] <mcpherrin> DanC: Welcome to immaturity :)
[03:05:13] * DanC scratches head; can't imagine a replacement for managed closures
[03:05:20] <strcat> most of the core language is really solid in regards to semantics.... just not closures
[03:05:33] <strcat> DanC: trait objects
[03:05:51] <strcat> closures are technically redundant, they're just sugar, but they're vastly more crippled than traits atm
[03:05:58] <tendernooblet> That would lead to a use case like do factors(20) |my_iter| my_iter.each(blahblah).filter(blahblah) could get messy if I need to use another function I made.
[03:06:01] <strcat> they are useful sugar, but need to be implemented sanely
[03:06:12] <tendernooblet> I'm super impressed with everything else.
[03:06:23] *** jorendorff is now known as jorendorff_away
[03:06:28] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[03:06:35] <strcat> tendernooblet: not sure why you'd have an 'each' call there
[03:06:39] <DanC> hmm... will there be a standard idiom for Function1 etc as in scala? having everybody make up their own seems pretty horrible.
[03:06:52] <DanC> maybe I'm over-thinking this.
[03:06:52] <tendernooblet> strcat: assuming I did for whatever I ended up doing.
[03:06:56] <strcat> DanC: I'm telling you that closures need to be redone
[03:07:00] <strcat> the current limitations are known
[03:07:27] <tendernooblet> When you say they're redundant you mean that Traits could be used as an alternative?
[03:07:37] <DanC> ah. so not really "poof" in the sense I had in mind. More like: replaced with a TODO item.
[03:07:40] <strcat> by 'technically redundant' I mean they are sugar
[03:07:55] <strcat> like for loops
[03:07:57] <tendernooblet> What can a closure be sugar for?
[03:08:17] <dbaupp> tendernooblet: a struct + a trait
[03:08:22] <strcat> defining a trait and passing a trait object, is what &fn/~fn/@fn are essentially sugar for
[03:08:28] <DanC> Function1 { def apply<T>(x: T): U } or thereabouts.
[03:08:36] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[03:08:38] <tendernooblet> That sounds like java talk.
[03:08:42] <DanC> tell me abou tit.
[03:08:51] <strcat> well, if you're not going to listen to what I'm saying
[03:09:15] <tendernooblet> I'm listening but it sounds kind of boilerplate heavy.
[03:09:27] <strcat> I never said rust will have no closures...
[03:09:30] * DanC apologizes for obscuring the issue
[03:09:43] <strcat> 23:06:01        strcat | they are useful sugar, but need to be implemented sanely
[03:09:44] <tendernooblet> So it's not cultural?
[03:09:46] <strcat> 23:07:39        strcat | by 'technically redundant' I mean they are sugar
[03:09:47] <tendernooblet> Ah, okay.
[03:09:49] <strcat> 23:07:55        strcat | like for loops
[03:09:58] <strcat> closures are not implemented in a great way atm
[03:10:50] <tendernooblet> Alright, that's.. I guess what I was trying to find out, whether or not they were just sort of broken.
[03:11:04] <strcat> they work, but they are inflexible
[03:11:55] <strcat> essentially the only language feature needing to be totally overhauled
[03:11:58] <DanC> meanwhile, the servo guys are doing all kinds of nifty stuff, from some of the talks I've seen. How do they deal with the chaos in rust?
[03:12:04] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[03:12:08] <DanC> I know they keep their own branch/copy...
[03:12:14] <strcat> there's not much chaos
[03:12:15] *** Quits: cdidd (cdidd@moz-7D391056.broadband.corbina.ru) (Input/output error)
[03:12:51] <tendernooblet> Well, if you have a value that a closure was involved in the creation of.. you can only pass it downwards right now?
[03:13:01] <strcat> tendernooblet: stack closures can't be returned
[03:13:39] <strcat> Filter stores a borrowed closure inside of it
[03:13:49] *** Quits: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[03:13:52] <tendernooblet> Yeah, but filter isn't alone in doing that.
[03:13:56] <strcat> so the closure has to provably outlive it, but isn't stored in the struct itself
[03:13:57] <engla> the closure type &'static fn() can be returned
[03:14:07] <engla> but it closes over nothing
[03:14:10] <strcat> engla: which is just a bloated 'extern fn' ;p
[03:14:27] <dbaupp> DanC: "their own branch " is just the master branch, but only updating every week or so. no custom patches/backporting.
[03:14:29] <DanC> not much chaos? hmm... people seemed to agree with "immaturity". Rate-of-change is what I meant. the rate-of-change in rust is clearly higher than in C++ or even go.
[03:15:01] <DanC> I get the impression whole swaths of the standard library get deleted now and then.
[03:15:18] <DanC> or renamed or moved
[03:16:13] <engla> well there is some mutal iteration between the language and the libstd, hopefully it's a refining process
[03:16:36] <strcat> I wouldn't expect the language to change much now
[03:16:50] <strcat> closures and managed pointers have long been planned to be overhauled
[03:17:04] <strcat> beyond that, not much is going to change afaik
[03:17:17] <dbaupp> fixed-length vectors are a wart
[03:17:26] <strcat> dbaupp: not really
[03:17:29] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[03:17:35] <strcat> they are begging for more features, but not backwards incompatible changes
[03:18:10] <dbaupp> true (being backward compatible doesn't make them less ugly though)
[03:18:15] <strcat> I don't think dynamically sized types are going to change much - I only expect it to apply to trait objects and closures
[03:18:40] *** Quits: Jesin (Jessin_@moz-A11FEBC.cc.lehigh.edu) (Quit: Leaving)
[03:18:55] * strcat doesn't think it makes any sense for vectors - maybe runtime-sized arrays, but only ~[T] will ever have push
[03:19:03] <acrichto> mcpherrin: format!("{1} {} {0} {}", 1, 2)
[03:19:07] <acrichto> mcpherrin: https://github.com/mozilla/rust/pull/9644
[03:19:10] * DanC just realized 0.8 was released a couple days ago
[03:19:14] <DanC> contrats!
[03:19:20] <DanC> er... congrats, even!
[03:19:55] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:20:28] <mcpherrin> acrichto: Thumbs up
[03:20:35] <DanC> "Strings no longer contain trailing nulls." <- bold. I'll have to look into why that was done.
[03:20:52] <erickt1> DanC: I made that change :)
[03:21:12] <DanC> got a handy pointer to the relevant issue?
[03:21:20] <erickt1> sure, one sec
[03:21:29] <strcat> DanC: they had a trailing \0 for C compatibility but it proved to not be very useful
[03:21:47] <strcat> considering that \0 is valid in UTF-8, and &str can be a view into any string (so it won't have \0)
[03:21:50] <DanC> didn't save copies on FFI?
[03:21:58] <erickt1> DanC: https://github.com/mozilla/rust/pull/8296
[03:22:00] <strcat> DanC: it saved copies on likely incorrect FFI
[03:22:11] <strcat> in general \0-terminated strings are only valid for paths
[03:22:13] <DanC> really? \0 is valid UTF-8?!!
[03:22:15] <strcat> since they can't hold all UTF-8
[03:22:17] <strcat> DanC: yep
[03:22:26] <strcat> 0 is a valid code point, \0 is the UTF-8 encoding of it
[03:22:38] <dbaupp> (it's valid ascii too.)
[03:22:51] <strcat> DanC: https://en.wikipedia.org/wiki/Null-terminated_string#Character_encodings
[03:23:02] <strcat> DanC: and at least on linux, paths don't have to be unicode
[03:23:10] <erickt1> although not valid C, which was recently confirmed to me
[03:23:13] <strcat> so there isn't much overlap between str and paths
[03:23:19] <DanC> wow. I have had bad information in my mental cache for a looong time. I thought utf-8 was designed for compatibility with C strings as part of plan9
[03:23:37] <strcat> DanC: plan9/Go have proper strings
[03:23:53] <strcat> (Go doesn't \0-terminate the strings either)
[03:23:54] *** Quits: MauricioC (mauricioc@moz-2CFCD404.impa.br) (Ping timeout)
[03:24:07] <strcat> although they don't guarantee their strings hold UTF-8...
[03:24:38] <dbaupp> DanC: it was designed to be compatible with ASCII, which "sounds" synonmous with C-strings, but isn't.
[03:25:08] *** Joins: aeqwa (aeqwa@moz-2E1D38A3.dsl.tropolys.de)
[03:26:00] <DanC> wild. I ran umpteen HTML meetings and read zillions of XML and HTTP drafts and stuff and never realized this.
[03:26:29] *** Quits: zlin (Mibbit@1BF6F491.1D53A164.B7830B68.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[03:26:41] <strcat> DanC: it might be forbidden in xml
[03:26:52] <strcat> just not UTF-8 itself
[03:27:14] <DanC> yeah, well, I thought I knew how to keep the layers separate
[03:27:38] <strcat> well it's a very common misconception that \0 isn't allowed in UTF-8 so it's repeated everywhere
[03:27:45] <strcat> you probably read it on stackoverflow or somewhere like that ;p
[03:28:17] <DanC> er... no, I don't think stackoverflow existed when I started doing relevant work; e.g. http://www.ietf.org/rfc/rfc2070.txt
[03:28:48] <strcat> DanC: to be fair, unicode wasn't ironed out yet then
[03:28:58] <DanC> exactly.
[03:29:03] <strcat> they've changed stuff like whether surrogates are allowed over and over
[03:29:22] <DanC> surrogates... don't scare the children, OK?
[03:29:26] *** Joins: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net)
[03:29:27] <strcat> ;]
[03:29:33] *** Joins: Ferreus_ (ferreus@moz-19B48F1C.dyn.telefonica.de)
[03:29:49] <strcat> DanC: oh and ofc UTF-8 is defined as having a max of 4-byte sequences now
[03:29:53] <strcat> and glibc still thinks it goes up to 6.
[03:29:53] <glyc> where is the line!() macro defined?  my grepping is fruitless
[03:30:01] *** Quits: Ferreus (ferreus@moz-8A4B42D4.dyn.telefonica.de) (Ping timeout)
[03:30:09] <acrichto> glyc: it's a built-in compiler extension
[03:30:12] <ChrisMorgan> In libsyntax.
[03:30:13] * DanC finally gets around to https://github.com/mozilla/rust/pull/8296
[03:30:30] <strcat> DanC: the man-pages project's unicode page is basically wrong :)
[03:30:30] <acrichto> glyc: look on line 276 of syntax/ext/base.rs
[03:30:47] <glyc> ChrisMorgna, acrichto: thanks!
[03:31:08] <DanC> I wonder if the are good unicode test suites.
[03:31:27] <strcat> DanC: unicode.org has nice big tables you can use to auto-generate the code + tables to auto-generate tests
[03:31:40] <strcat> but mostly they aren't UTF encoding tests
[03:31:55] <DanC> My conclusion from 15+ years of standards work is: screw specs; hardly anybody reads them. demos and test suites get you 95% of the benefit for less work. (not a lot less; test suites are hard work)
[03:32:18] <strcat> ah it looks like they half-fixed 'man 7 utf-8'
[03:32:21] <strcat>        * UTF-8 encoded UCS characters may be up to six bytes long, however the Unicode standard specifies  no  charac‐
[03:32:23] <strcat>          ters above 0x10ffff, so Unicode characters can be only up to four bytes long in UTF-8.
[03:32:24] <DanC> well, I still like specs. But test suites are SO MUCH EASIER for developers to work with.
[03:32:42] <strcat> it's not entirely true... because UTF-8's current RFC says it stops at 0x10ffff (separate from the Unicode standard)
[03:32:50] <strcat> at least it doesn't lie anymore
[03:32:55] <strcat> ;p
[03:33:48] <glyc> ChrisMorgan, acritchto: I'm taking a swing at adding function!() to get the current function name, https://github.com/mozilla/rust/issues/9586. 
[03:33:57] *** Quits: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[03:34:03] <glyc> anything to watch out for?
[03:34:13] <strcat> also the code space is 21-bit... and they say it's 16-bit
[03:34:15] * strcat sighs
[03:34:50] <acrichto> glyc: I'm not entirely sure how it'll be done, but it's probably just maintaining some state in the parser or something like that
[03:35:08] <acrichto> glyc: also it should probably be a compiler error to be called outside of a function context (possibly in a global I guess?)
[03:35:11] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:35:20] <jld> Does debug! no longer append "\n"?  I'm pretty sure it used to?
[03:35:27] <glyc> acrichto: makes sense
[03:35:29] <DanC> rust/pull/8296 is connected to an interesting collection of issues...
[03:35:38] <acrichto> jld: my bad :( I fixed it between then and now though
[03:36:03] <ChrisMorgan> glyc: what will it do when you call it outside a function?
[03:36:10] <glyc> acrichto: but I can see it being useful to return an empty string
[03:36:41] <acrichto> glyc: that was kinda the thing that we ran into with the env! macro, we ended up making it a compiler error if the envrionment variable wasn't defined
[03:36:57] <acrichto> glyc: it used to return an empty string
[03:37:27] <glyc> acrichto: did that not work?
[03:37:35] <ChrisMorgan> Whoops, I didn't notice you asking the same question :-/
[03:37:50] <glyc> also was t:-)
[03:37:58] * strcat wonders what he's doing wrong
[03:37:59] <acrichto> glyc: it worked fine, but we changed it to requiring the env variable to be defined to be a little more explicit
[03:38:32] <glyc> acrichto, ChrisMorgan: it might be useful to print the full path to the function
[03:38:53] <acrichto> rusti: module!()
[03:38:53] -rusti- <anon>:7:9: 7:15 error: macro undefined: 'module'
[03:38:53] -rusti- <anon>:7          module!()
[03:38:53] -rusti-                   ^~~~~~
[03:38:54] -rusti- application terminated with error code 101
[03:38:55] <glyc> and that path could be shorted if not inside a function
[03:39:01] <acrichto> aww I thought that was defined
[03:39:07] <glyc> smiles
[03:39:19] <glyc> rusti: module_path!()
[03:39:20] -rusti- ""
[03:39:23] <acrichto> ah
[03:39:38] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[03:39:48] <glyc> interesting, so does module_path already get the function name too.... looking...
[03:39:50] <acrichto> I suppose you could get the "full name" of a function from module_path() + function()
[03:40:25] <glyc> that would seem reasonable
[03:40:44] <strcat> aha
[03:40:51] <strcat> it dies in split_trait_methods... which returns a tuple
[03:41:01] <strcat> a 2 word tuple though :s
[03:41:28] * strcat thinks taking the size there is just often broken for some strange reason
[03:43:33] *** Joins: ryeguy (ryeguy@9C569A0.5D1143CD.E8644521.IP)
[03:43:40] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[03:43:49] <DanC> hmm... * Crates may be imported by URL with `extern mod foo = "url";`. I wonder how that works
[03:43:58] <ChrisMorgan> rustpkg.
[03:44:00] * DanC is reading through https://github.com/mozilla/rust/blob/0.8/RELEASES.txt
[03:44:02] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[03:44:27] *** Joins: cdidd (cdidd@moz-6CAFBEDB.broadband.corbina.ru)
[03:44:40] <ryeguy> if i have an Option and I want to perform a side-effect only when it is a Some, is there a nice way to do that without a match? Something like Option#or_else but with a void return value
[03:45:10] <ChrisMorgan> DanC: http://static.rust-lang.org/doc/master/tutorial-rustpkg.html
[03:45:13] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Ping timeout)
[03:45:14] <strcat> ryeguy: well, map works but has a ret value
[03:45:25] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[03:45:32] <strcat> rusti: let x = Some(5); for i in x.iter() { println!("{}", i) }
[03:45:33] -rusti- pastebinned 10 lines of output: http://sprunge.us/CfEa
[03:45:39] <strcat> rusti: let x = Some(5i); for i in x.iter() { println!("{}", i) }
[03:45:40] -rusti- pastebinned 10 lines of output: http://sprunge.us/fCGi
[03:45:46] <strcat> rusti: let x = Some(5i); for i in x.iter() { println!("{}", *i) }
[03:45:46] -rusti- 5
[03:45:47] -rusti- ()
[03:46:04] <strcat> if you really want ;p
[03:46:54] <engla> I think using map is fine
[03:48:37] <DanC> "First, let's try to use an external package somehow." yay! too much of computing education starts with writing rather than reading software.
[03:48:40] <ryeguy> oh yeah..map works. or_else wasn't working for a different reason :p thanks
[03:49:50] <DanC> "rustpkg install pkg_id" is slightly confusing; pkg_id should be PKG_ID or <var>pkg_id</var> or something. I guess github makes submitting PRs easy enough...
[03:50:34] *** Quits: Yeri (jasonjasmi@41C91A8A.CE609BA5.E39FBF79.IP) (Quit: Yeri)
[03:50:57] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[03:51:00] <tikue_> DanC, yeah I thought the same thing first time I read that tutorial
[03:51:38] <jld> ...and I got substs wrong.
[03:52:57] <DanC> hmm... I don't see how to do <var> in this context.
[03:52:59] * strcat should put jld to work debugging immediates
[03:53:08] <strcat> ;D
[03:53:20] <DanC> The tutorial does a great job of starting concrete, but then pkg_id is abstract in a jarring way for no apparent reason
[03:53:39] *** Parts: amatus (amatus@moz-12C8D317.g-cipher.net) ()
[03:53:49] *** Quits: cdidd (cdidd@moz-6CAFBEDB.broadband.corbina.ru) (Input/output error)
[03:54:07] *** Joins: cdidd (cdidd@moz-6CAFBEDB.broadband.corbina.ru)
[03:55:45] *** Quits: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP) (Client exited)
[03:55:59] <strcat> rusti: std::sys::size_of::<(u8, u8)>()
[03:56:00] -rusti- 2u
[03:56:59] <jld> strcat: Maybe after I get the enum-discrim-size branch to not break libstd with ctypes lint errors on Option<>.
[03:57:35] <jld> strcat: Which it used to not, but after I fixed a stupid off-by-one error that dbaupp pointed out, it does.
[03:57:36] <strcat> um
[03:57:45] *** Joins: dandy (dandy@moz-84CC8377.hsd1.co.comcast.net)
[03:57:57] <strcat> how can llsize_of, llsize_of_store and llsize_of_alloc *possibly* be different
[03:58:02] <glyc> man.... I have ccache enabled, but linking libextra seems to take forever... is there any way to speed it up?
[03:58:22] <strcat> ccache doesn't do anything for those parts
[03:58:29] <glyc> strcat: arg
[03:58:37] <strcat> the rust stdlib/runtime/compiler are written in rust
[03:58:37] <DanC> github's support for editing rocks.
[03:58:51] <ChrisMorgan> glyc: (a) Buy or build a faster computer; (b) Buy or build a time machine and go forward a few months.
[03:58:53] <glyc> strcat: rcache ?
[03:58:56] <jld> strcat: It's been a while since I looked at that, but I think they actually aren't.
[03:58:57] *** Joins: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP)
[03:59:04] <DanC> i.e. that for tiny edits, I don't have to check out a whole copy and figure out all the git details
[03:59:38] <glyc> ChrisMorgan: (b) please. I think amazon has in stock...
[03:59:46] <jld> strcat: But you'll probably have to source-dive LLVM to verify that belief.
[04:00:20] *** Quits: cdidd (cdidd@moz-6CAFBEDB.broadband.corbina.ru) (Input/output error)
[04:00:32] *** Joins: cdidd (cdidd@moz-6CAFBEDB.broadband.corbina.ru)
[04:00:34] <strcat> DanC: the editor is ace, and it even has a rust mode
[04:00:37] <glyc> I guess since I'm change core macro stuff, there's no getting around a full rebuild
[04:00:42] <strcat> don't know if theirs is up-to-date enough
[04:00:45] <ChrisMorgan> glyc: most of their time machine-related things seem to be from Wells.
[04:00:59] <glyc> ChrisMorgan: lol
[04:01:03] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[04:01:04] <strcat> (the rust mode is out-of-date though, it dates to maybe 0.3...)
[04:01:27] <DanC> (c) wait a few months ;-)
[04:01:32] <dcrewi> glyc: (c) patch rustc to do some work in parallel (assuming you have a multicore processor)
[04:01:50] <strcat> jld: I'm busy running into *wonderful* errors from trying to making tuples/structs less than 1 word generic ;p
[04:02:00] <strcat> I have reason to believe llsize_of is returning a non-deterministic result...
[04:02:04] <jld> !
[04:02:16] <glyc> dcrewi: oh. it's not. you're right. I have 12 cores, 11 sitting unused. sad face
[04:02:18] * DanC finishes rustpkg tutorial
[04:02:22] <strcat> if I keep recompiling, sometimes the type is immediate
[04:02:24] <strcat> sometimes it's not
[04:02:26] <strcat> wat?
[04:02:32] <DanC> a few examples of popular packages would be nice.
[04:05:17] <DanC> "std: Many methods in `str`, `vec`, `option, `result` were renamed for     consistency." <- that sort of thing would seem to be a pain for servo. Is it?
[04:05:17] <dbaupp> strcat: reading uninit memory?
[04:06:44] <strcat> lol, so I was looking at all the estr/evec code
[04:06:55] *** Quits: cdidd (cdidd@moz-6CAFBEDB.broadband.corbina.ru) (Ping timeout)
[04:06:59] <strcat> and say ty_enum... and wondered 'what's an e-num? oh wait...'
[04:07:02] <strcat> and saw*
[04:08:04] <dbaupp> hahahaha
[04:08:09] <ChrisMorgan> glyc: and so we get the situation where a $200 processor with two cores and a higher clock speed outperforms a $500 processor with six cores and a lower clock speed.
[04:08:34] *** Joins: cdidd (cdidd@moz-82277DF2.broadband.corbina.ru)
[04:09:01] * ChrisMorgan is not, in buying a laptop, spending $150 more on a quad-core i7 CPU which is 10% slower than a dual-core i5 CPU for the things he does
[04:09:54] <DanC> I'm curious... are the release notes derived from issues lists or changelogs at all? or completely hand-edited?
[04:10:07] <klutzy> sometimes I add new entry to enum but forget to save/build it. then other crate using it fails at match { ... NoneSuch => ..., _ => { fails here } }.
[04:10:09] <glyc> in libsyntax/ext/base.rs:318, if I have an ExtCtxt or a CodeMap, I don't think I have function info yet... or do I?
[04:10:16] <strcat> DanC: RELEASES.txt is hand-edited
[04:10:23] <DanC> hm
[04:10:33] <klutzy> this is because NoneSuch is just a named variable capturing all remaining cases, but it is sometimes confusing
[04:10:35] <strcat> DanC: cmr makes a weekly report on the state of rust, looking at the PRs from that week, and brson used that to make the extended release notes
[04:10:43] <dbaupp> glyc: you might need to modify the ExtCtxt to record the current function (optoinal) function name
[04:10:44] <klutzy> is it better to add some note on compile error?
[04:11:01] <strcat> DanC: https://github.com/mozilla/rust/wiki/Doc-detailed-release-notes
[04:11:02] <glyc> dbaupp: okay, who updates to current name
[04:11:03] <dbaupp> glyc: similar to how it records the module path as it folds the AST
[04:11:10] <glyc> ah
[04:11:13] <DanC> "this week in rust" is awesome.
[04:11:15] <dbaupp> glyc: in expand.rs, there's expand_item or something
[04:11:18] <strcat> DanC: (and to find what to put in RELEASES.txt)
[04:11:29] <glyc> dbaupp: thx, I'll look at module path
[04:11:37] <strcat> ideally, RELEASES.txt would be edited as interesting things were done
[04:12:08] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:13:04] *** Quits: dandy (dandy@moz-84CC8377.hsd1.co.comcast.net) (Connection reset by peer)
[04:13:17] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[04:13:22] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[04:13:25] *** Joins: mib_wvj5hn (Mibbit@FB27E432.2D68412A.8020EA7B.IP)
[04:13:47] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:14:13] <DanC> yeah
[04:15:34] *** jorendorff_away is now known as jorendorff
[04:15:47] *** Quits: mib_wvj5hn (Mibbit@FB27E432.2D68412A.8020EA7B.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:17:48] <DanC> where's the documentation for conditions? I can't find it in doc/0.8/manual.html
[04:18:05] <strcat> there's a conditions tutorial
[04:18:14] <strcat> linked from the tutorial
[04:18:17] * DanC finds http://static.rust-lang.org/doc/master/tutorial-conditions.html
[04:18:31] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[04:20:26] <jld> Is there a thing that takes a tcx and an ast::Ty and gives me a ty::t?
[04:20:33] *** Quits: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP) (Ping timeout)
[04:21:56] *** Quits: sglez (sglez@E19C1D7A.4B605195.A208C5.IP) (Quit: Leaving)
[04:22:32] *** jorendorff is now known as jorendorff_away
[04:22:34] *** Joins: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP)
[04:23:03] <jld> Sigh.  I could just allow all non-C-like enums in FFI and file an issue to tighten up the lint.
[04:24:35] * DanC discovers task::try ... interesting!
[04:26:44] <Astana11> are the changes intended for 0.9 documented anywhere?
[04:27:27] <dbaupp> Astana11: not really: it's mostly just what people implement. (the backward-incompatible changes of @ and closures will hopefully be in by 0.9)
[04:27:41] * strcat doubts closures will be done by then
[04:27:45] <SiegeLord> Oh yeah? Closures in by 0.9?
[04:27:55] <SiegeLord> ...doh >_<
[04:28:16] <DanC> Astana11, you could look at the tickets tagged with 0.9
[04:28:20] *** Quits: adu (ajr@moz-BF2B1AE4.washdc.fios.verizon.net) (Quit: adu)
[04:28:33] <DanC> I don't know how well that reflects plans, though
[04:29:50] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[04:29:55] <Astana11> alright, thanks!
[04:30:08] <dbaupp> (I don't think any are tagged with 0.9?)
[04:30:40] *** Quits: cdidd (cdidd@moz-82277DF2.broadband.corbina.ru) (Ping timeout)
[04:38:22] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[04:41:26] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[04:41:54] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[04:43:21] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[04:44:10] <glyc> dbaupp: I'm not sure if I need the with_exts_frame stuff in expand.rs for func!()... what does it do?  http://mibpaste.com/a6esyG 
[04:44:43] <glyc> sorry, that pastebin looses all indentation
[04:44:47] <glyc> need a better place
[04:45:00] <DanC> so... I gather IO was a major motivation for conditions. The conditions design looks solid. Has it been applied to the IO library?
[04:45:06] <glyc>  libsyntax/ext/expand.rs:321 or so
[04:45:43] <strcat> DanC: yes, but it didn't turn out to be very nice for lots of it
[04:45:56] <DanC> any examples come to mind?
[04:46:12] <strcat> DanC: it's just a pain, because the functions still have to return Option unless they ask for a replacement value
[04:46:29] <strcat> so you essentially might as well be returning Result<Type, ErrorEnum>
[04:46:50] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[04:46:53] <DanC> I'm pretty fond of Result<> in any case. I was nervous about conditions.
[04:47:18] <dbaupp> glyc: you'll need to add an arm for ast::item_fn, and I don't know what the with_exts_frame macros does
[04:47:21] * dbaupp looks
[04:47:43] <strcat> conditions are a nice way of making it so that you can't ignore the error, and still keeping it recoverable
[04:47:52] <glyc> yes, I added an arm for ast::item_fn and ast::item_impl
[04:47:56] <strcat> but.... they are much more painful than enums imo
[04:47:56] *** Quits: Astana11 (Astana1111@48F4515E.3B38BA72.1E7C11E5.IP) (Client exited)
[04:48:18] <strcat> if we called rvalue destructors immediately, we could use an RAII idiom
[04:48:27] <strcat> write(file, buffer);
[04:48:35] <glyc> dbaup:: something to do with the return value of expand_item
[04:48:45] <DanC> 1st function I looked at in io, read() is marked "FIXME (#2982): This should probably return an error."
[04:49:01] <strcat> so for example, write could return Error<SomeEnum>
[04:49:02] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[04:49:06] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[04:49:10] <glyc> dbaupp: I suppose I can just continue to return noop_fold_item(it, fld) ?
[04:49:11] <strcat> where Error has a flag + throws a failure in the destructor
[04:49:11] <dbaupp> glyc: well, I don't think so, you just need to swap in Some(func_name) to the place you're storing the function name and then swap in the old value afterwards
[04:49:12] <DanC> that suggests io API is still TBD
[04:49:20] <strcat> if we freed rvalues right away, you couldn't ignore it
[04:49:29] <strcat> since we don't, you can *temporarily* ignore it
[04:49:33] <strcat> making that idiom not really work.
[04:49:56] <dbaupp> glyc: (after calling noop_fold_item, that is) I think that's what with_exts_frame does, anyway.
[04:49:59] <glyc> dbaupp: I'm keeping a stack like mod_path, just called func_path
[04:50:03] <strcat> hm
[04:50:06] <strcat> actually...
[04:50:13] <strcat> in some cases it works
[04:50:51] <glyc> dbaupp: stack seems necessary since functions can be nested
[04:50:51] <dbaupp> glyc: ok, that works.
[04:50:58] *** Quits: Earnestly (earnest@moz-BE290A2B.dyn.plus.net) (Ping timeout)
[04:51:18] <dbaupp> glyc: (well, doing the swap would work too, "the stack" becaomes the actual function call stack.)
[04:51:28] <glyc> dbaupp: can other items, besides impl and fn contain fn definitions?
[04:51:38] <glyc> (and mod, already got mod)
[04:51:43] <dbaupp> glyc: traits can have default methods
[04:51:51] <engla> strcat: that's an interesting idea for error handling.
[04:52:00] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[04:52:04] <glyc> dbaupp: traits can have method definitions in them?
[04:52:08] <glyc> ok
[04:52:13] <dbaupp> glyc: yes
[04:52:15] <glyc> I'll add an arm for traits
[04:52:17] <strcat> engla: it's not my idea, it's stolen from andrei alexandrescu
[04:52:18] <dbaupp> glyc: (see std::cmp::ord)
[04:52:19] <DanC> "Design and implement I/O error handling strategy" is still open too (#6163). So it looks like design is still ongoing w.r.t. conditions and io
[04:52:48] <dbaupp> glyc: I think you can use fold_*_method for the methods
[04:53:00] <dbaupp> glyc: (I think you *should* use them, in fact)
[04:53:01] <glyc> dbaupp: yep
[04:53:28] <glyc> dbaupp: fold_*_ methods.... not clear. what do you mean?
[04:53:28] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[04:53:39] <dbaupp> glyc: i..e override those methods in the impl of ast_fold for MacroExpander
[04:53:43] <dbaupp> glyc: see ast::fold
[04:53:44] <strcat> engla: http://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Andrei-Alexandrescu-Systematic-Error-Handling-in-C
[04:53:47] * strcat really likes it
[04:53:52] <dbaupp> glyc: and also line 1174
[04:54:05] <glyc> dbaupp: looking...
[04:54:15] <glyc> 1174 of which file?
[04:54:33] <engla> thanks
[04:54:44] <dbaupp> glyc: expand.rs
[04:55:21] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[04:55:26] <glyc> dbaupp: ok, I'm looking at ast_fold for Injector in expand.rs
[04:56:00] <glyc> dbaupp: what does fold mean in this context?
[04:56:08] <dbaupp> glyc: you want ast_fld for MacroExpander
[04:56:36] <glyc> does that already exist, or I should Make it
[04:56:53] <glyc> I see it a little farther down
[04:56:56] <dbaupp> yep
[04:57:07] * dbaupp forgot that you would've added code and changed line numbers
[04:57:11] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[04:57:22] <glyc> dbaupp: smile.
[04:57:46] <dbaupp> glyc: fold is the word for transforming one ast into another (e.g. expanding macros)
[04:58:08] <glyc> dbaupp: cool, was going to guess something like that
[04:58:51] <dbaupp> glyc: so, effectively, fold_item is "replace the old item with the output of this", etc.
[04:59:24] <glyc> dbaupp: got it. I see ast_fold::fold_item exists already
[04:59:34] <glyc> what were you saying to override?
[05:00:00] <dbaupp> glyc: fold_method and fold_ty_method (iirc)
[05:00:12] <glyc> ok
[05:00:17] <dbaupp> glyc: you should look at the trait defintiion in syntax/fold.rs too
[05:00:27] *** Joins: Heather (Heather@19663F6.F53BAACC.9C17E900.IP)
[05:00:33] <dbaupp> (it also demonstrates default methods, fwiw)
[05:00:48] <Heather> good morning
[05:01:49] <glyc> dbaupp: ok. I'm still fuzzy on when ast_fold for MacroExpander ::fold_method is going to get called (and thus what it should do)
[05:03:44] <glyc> Heather: gm
[05:05:00] <dbaupp> glyc: the ast_fold trait + the noop_fold_* functions run a traversal of the ast, visiting each item in turn, so when you call noop_fold_item in expand_item, if it's a trait or impl, the noop function will automatically call fold_method (etc) on each method
[05:05:26] <dbaupp> glyc: you can look at the implementation of all these in fold.rs (e.g. grepping for callers of fold_method)
[05:05:40] <glyc> dbaupp: ok
[05:05:44] *** Quits: aeqwa (aeqwa@moz-2E1D38A3.dsl.tropolys.de) (Quit: Lost terminal)
[05:06:08] *** Joins: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de)
[05:10:30] *** Quits: sw17ch (sw17ch@moz-675AFBCF.hsd1.mi.comcast.net) (Quit: sw17ch)
[05:12:53] *** Quits: ryeguy (ryeguy@9C569A0.5D1143CD.E8644521.IP) (Quit: )
[05:13:01] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[05:19:09] <Heather> error: type `&mut ~[Repository]` does not implement any method in scope named ` next` -> I can't use for in arrays?
[05:19:21] *** Quits: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[05:19:32] <dbaupp> Heather: for x in array.iter()
[05:19:42] <Heather> dbaupp thanks
[05:20:02] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[05:23:18] <Heather> dbaupp how to add value to array?
[05:25:04] <glyc> dbaupp: for methods, will both fold_item and fold_method get called (twice?)
[05:26:12] <dbaupp> glyc: don't think so
[05:26:23] <dbaupp> Heather: array.push(x)
[05:26:36] <glyc> dbaupp: ok
[05:26:37] <dbaupp> glyc: there's no item_method in the ast, so I dont think it's even possible
[05:26:53] <Heather> dbaupp thanks
[05:27:52] <glyc> dbaupp: item_fn 
[05:28:25] <dbaupp> glyc: that's just fn foo()  at the top level
[05:28:59] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[05:29:18] <glyc> dbaupp: not recursively inside item_fn, item_impl, item_trait ?
[05:31:33] <glyc> dbaupp: I'll just try it
[05:31:45] <dbaupp> glyc: mod foo { fn bar() { fn baz() { ... } } are both item_fn's
[05:31:58] *** Joins: cdidd (cdidd@moz-71A53418.broadband.corbina.ru)
[05:32:11] <glyc> dbaupp:  cool. btw I heard a rumor that %? is going away? What is replacing it?
[05:32:14] <dbaupp> impl Foo { fn foo() { .. } }  trait Bar { fn bar() { ... } } etc aren't item_fn
[05:32:24] <glyc> they aren't item_fn?
[05:32:25] <dbaupp> '{:?}'
[05:32:37] <dbaupp> yes, they aren't item_fn, they're one of the method types
[05:32:40] <glyc> '{:?} ok
[05:33:12] <dbaupp> rusti: println!("{:?}", ~[Some(1u8), None])
[05:33:12] -rusti- ~[Some(1u8), None]
[05:33:13] -rusti- ()
[05:33:20] <glyc> I'm looking at pub enum item in ast.rs:1125
[05:33:29] <strcat> just keep in mind that it's not a stable format (and won't ever be)
[05:33:45] <strcat> it reads private data
[05:34:02] <glyc> strcat: are you talking about {:?}
[05:34:06] <strcat> yes
[05:34:28] <glyc> not sure what stable implies
[05:34:39] <strcat> it can change from week to week, for eternity
[05:34:46] <glyc> why
[05:34:55] <strcat> because it's a debugging tool, it reads private data
[05:34:57] <dbaupp> purely for debugging/quick scripts
[05:35:26] <glyc> seemed like a replacement for << in c++
[05:35:29] <strcat> imo it should be marked unsafe due to reading private fields, but overall consensus was that it should be safe
[05:35:32] <strcat> glyc: no
[05:35:34] <strcat> that's {}
[05:35:37] <strcat> types can implement {}
[05:35:43] <strcat> {:?} is *purely* for debugging
[05:35:55] <glyc> strcat: what is {}
[05:36:04] <strcat> rusti: println!("{}", 5)
[05:36:05] -rusti- 5
[05:36:05] -rusti- ()
[05:36:11] <strcat> glyc: types implement it via a trait
[05:36:14] <SiegeLord> Oh drat, rust-bindgen isn't compiling for me...
[05:36:30] <strcat> {:?} on the other hand is entirely via auto-generated glue code that visits private fields
[05:36:43] <glyc> strcat: I think I see. :? can't be overriddent to change presentation?
[05:36:57] <strcat> glyc: can't override it
[05:37:05] <strcat> it recursively walks the primitive types forming a type
[05:37:17] <glyc> strcat: cool. so does {} default to {:?} if no other implementation?
[05:37:19] <dbaupp> strcat: I don't understand why it should be unsafe, e.g. if you're storing a null pointer in a ~ you're a bad person and should be using *. I would hope that priv was to allow code to enforce invariants that the type system can't.
[05:37:20] <strcat> it visits private fields, so there's no way to conceal private data from it
[05:37:26] <strcat> glyc: no, {} doesn't default to {:?}
[05:37:46] <glyc> strcat: ?
[05:37:46] <strcat> dbaupp: because the unsafety rules are arbitrary
[05:37:56] *** Quits: jstevans (Instantbir@moz-22A27CD4.bootp.virginia.edu) (Ping timeout)
[05:38:00] <strcat> glyc: {} uses a trait, {:?} uses auto-generated reflection
[05:38:02] <strcat> they do not overlap
[05:38:24] <glyc> so by default {} does nothing?
[05:38:24] <strcat> dbaupp: the unsafety rules enforce that the invariants of the type system hold
[05:38:24] <dbaupp> glyc: {} doesn't have a default at all; it has to be explicitly implemented for each type
[05:38:34] <glyc> ok
[05:38:39] <strcat> glyc: it won't compile if there's not an impl for that type
[05:38:46] <glyc> gotcha
[05:38:53] <strcat> the trait is like operator<< in C++
[05:38:58] <glyc> right
[05:39:01] <dbaupp> rusti: println!("no default impl {}", ~[1])
[05:39:02] -rusti- pastebinned 10 lines of output: http://sprunge.us/AYYM
[05:39:18] <strcat> dbaupp: like, we prevent data races
[05:39:30] <strcat> because if we had data races, you could have inconsistent views of objects
[05:39:34] <strcat> breaking the type system invariants
[05:39:36] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[05:39:43] <glyc> strcat: do structs have a {} implementation
[05:39:43] <strcat> I feel that visiting a private field is breaking one of those...
[05:39:54] <strcat> glyc: types don't automatically implement it
[05:40:02] <strcat> you can implement the trait for a type
[05:40:11] <glyc> k
[05:40:39] <strcat> dbaupp: it really sucks that everyone is going to use {:?} so we essentially have no read-privacy
[05:40:43] <strcat> just write-privacy
[05:40:45] <dbaupp> glyc: std::fmt::Default
[05:40:57] <glyc> seems like auto-generated reflection is quite useful for debugging. I hope it doesn't go away.
[05:41:06] <strcat> dbaupp: it's odd to forbid reading foo.x if you allow {:?}
[05:41:12] <strcat> glyc: not going to go away
[05:41:18] <glyc> cool
[05:41:21] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:41:23] <strcat> I just think it should require an unsafe block
[05:41:28] *** Joins: Puddles (Mibbit@moz-10B0023F.ny325.east.verizon.net)
[05:41:45] <Puddles> Why were managed closures removed?
[05:41:57] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[05:41:58] <glyc> dbaupp, strcat: looking at ast.rs:1125 or so, at pub enum item_
[05:42:09] <strcat> Puddles: managed ptrs are going to be moved out to the stdlib
[05:42:20] <strcat> and closures are going to be overhauled
[05:42:28] <glyc> dbaupp, strcat: nested functions or methods are not item_fn, is that right? what are they then?
[05:42:52] <strcat> glyc: nested functions are item_fn - do you mean the lambda syntax?
[05:42:55] <Puddles> Oh cool. So that's the plan? That'll allow more functional-style.
[05:43:13] *** fmt is now known as fmtq
[05:43:28] <dbaupp> glyc: methods and nested functions are different
[05:43:34] <glyc> strcat: just trying to keep track of the name of any function, nested, or in an impl for the func!() macro 
[05:43:44] <glyc> (like c99 __func__ )
[05:43:48] <strcat> Puddles: Rc<T>/Gc<T> will be equal citizens in terms of syntax (there will be some trait for overloading dereferencing)
[05:43:57] <strcat> not sure exactly what will happen with closures
[05:44:01] <dbaupp> glyc: methods are declared somewhere else in ast (grep for method), nested functions are just item_fn
[05:44:15] <glyc> dbaupp: ok
[05:44:49] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[05:46:40] <glyc> dbaupp: I think I see: trait_method is used by  item_trait, and method is used by item_impl
[05:46:41] <Heather> dbaupp is there something alike #if Win32 #endif ?
[05:46:53] <glyc> cfg
[05:47:02] *** Quits: obk (Mibbit@moz-E977B938.red.bezeqint.net) (Quit: http://www.mibbit.com ajax IRC Client)
[05:47:06] <Heather> glyc is it to me?
[05:47:23] <glyc> y
[05:47:34] <Heather> glyc cfg?
[05:48:32] <glyc> Heather: sorry, was looking for an example. grep throught the rust source tree for cfg. One example here: https://github.com/mozilla/rust/issues/3795
[05:48:45] <dbaupp> Heather: http://static.rust-lang.org/doc/master/src/std/home/rustbuild/src/rust-buildbot/slave/doc/build/src/libstd/libc.rs.html#222 http://static.rust-lang.org/doc/master/src/std/home/rustbuild/src/rust-buildbot/slave/doc/build/src/libstd/libc.rs.html#583
[05:49:12] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[05:49:12] *** ChanServ sets mode: +o tjc
[05:49:17] <Heather> glyc dbaupp cool, thanks !
[05:49:20] <glyc> Heather: #[cfg(target_os = "linux")]
[05:49:23] <glyc> etc
[05:49:26] <dbaupp> Heather: there's also `cfg!(target_os = "win32")` which evaluates to true/false as an expression.
[05:49:45] <dbaupp> (there's also cfg(windows), cfg(linux), etc.)
[05:50:04] <Heather> dbaupp where is endif ? :S
[05:50:30] <strcat> attributes apply to items
[05:50:33] <dbaupp> Heather: for #[cfg] it just keeps/removes the whole thing that it is attached to
[05:50:39] <glyc> heather: at the end of the item that it preceedes
[05:51:10] <Heather> so I can use do there for blocks?
[05:51:18] <glyc> Heather, so just look for the first { ... and then match it to the }
[05:51:50] <Heather> I see
[05:52:30] <dbaupp> glyc: that's not a very good way to treat #[cfg] :P
[05:52:33] <strcat> they don't work on any kind of block
[05:52:52] <Heather> :S
[05:52:55] <glyc> Heather: expressions aren't items
[05:53:40] <glyc> Heather: http://static.rust-lang.org/doc/master/rust.html#items
[05:53:58] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[05:54:54] <glyc> dbaupp: sorry! :/
[05:55:55] <dbaupp> glyc: I just mean that treating it purely in terms of items is better, rather than constructing rules about { and } (e.g. struct Foo; is a perfectly good item)
[05:56:24] <glyc> so lambdas ... they don't show up as items, do they get their own gensym-ed name/
[05:56:25] <glyc> ?
[05:56:44] <dbaupp> yes, but function!() shouldn't consider lambdas
[05:56:56] <glyc> dbaupp: right
[05:57:08] <glyc> dbaupp: a bad heuristic
[05:57:10] <dbaupp> (and the get the gensymed names very late in the compilation process, I believe: i.e. when they are emitted)
[05:57:20] <dbaupp> *they
[05:57:25] <glyc> k
[05:57:50] *** Quits: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP) (Input/output error)
[05:57:52] <glyc> dbaupp: func!() shouldn't consider lambda?
[05:57:52] *** Joins: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP)
[05:57:52] *** ChanServ sets mode: +o jdm
[05:57:56] <glyc> why not?
[05:58:37] <dbaupp> because you're not in a lexically different function?
[05:58:44] <glyc> dbaupp: I'd be happy with lambda + file + line no
[05:58:55] <glyc> in place of a function name
[05:58:59] <dbaupp> (at the very least, you're not in a function with a different name)
[05:59:09] <glyc> right
[05:59:39] <glyc> but upon entering a lambda block, hmm... is there a way to know when that happens
[05:59:43] <glyc> during fold
[05:59:53] <dbaupp> I could imagine foo::lambda or something for fn foo() -> ~str { (|| { func!() })() }, but that's getting into the realm of weirdness
[05:59:54] <dbaupp> why?
[06:00:10] <dbaupp> (it's part of expand_expr, expr_lambda or somethign like that)
[06:00:14] <glyc> ok
[06:00:16] <glyc> cool
[06:00:58] <dbaupp> but, yeah, your suggestion of lambda + file + line no would be ok, although we have file!() and line!() for the latter two
[06:03:00] <glyc> it would just be nice to have some ability to track lambdas too
[06:04:58] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[06:09:06] *** Quits: eatkinson (eatkinson@moz-261EDE03.hsd1.ca.comcast.net) (Quit: eatkinson)
[06:14:00] <Heather> what means : Illegal anonymous lifetime: anonymous lifetimes are not permitted here
[06:14:07] <Heather> struct Repository { loc: ~str, t: VCS, branches: &[~str] }
[06:14:56] <Puddles> https://github.com/mozilla/rust/wiki/Meeting-weekly-2013-07-23 this log implies closures are being deprecated.
[06:16:40] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[06:17:06] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[06:17:39] <sfackler> Heather: you want struct Repository<'self> { loc: ~str, t: VCS, branches: &'self [~str] }
[06:17:48] <Heather> wow :S
[06:18:00] <Heather> sfuerst may you explain what is it?
[06:19:04] <sfackler> branches is a borrowed reference to an array of strings. the 'self says that the reference stored there has to survive at least as long as the struct it's being stored in
[06:19:06] <Heather> and sedly I can't json it : <quote expansion>:12:40: 12:77 error: failed to find an implementation of extra::serialize::De codable<__D> for &[~str]
[06:19:12] <klutzy> since & pointers are borrowed, you must know its lifetime
[06:19:30] <klutzy> so 'self lifetime label is added
[06:19:45] *** Joins: vLK (vLK@moz-2D4B6366.bredband.comhem.se)
[06:20:21] <klutzy> Heather: it seems that you are trying to use serialization
[06:20:27] <Heather> I used ot have it with #[deriving(Encodable, Decodable, Clone)]
[06:20:29] <klutzy> but it doesn't make sense for borrowed ones
[06:20:35] <vLK> Im trying to build from source but can't link to libkvm.so.5 (only .so.6 is present in /lib). What can I do? How can I change linker flags
[06:20:44] <Heather> klutzy why so?
[06:20:48] *** Joins: xkyllx (Mibbit@moz-B5BC087D.hsd1.ca.comcast.net)
[06:21:05] <strcat> vLK: what OS are you on?
[06:21:14] <Heather> klutzy I just want to set many branches for one repository node
[06:21:17] <vLK> FreeBSD (HEAD)
[06:21:23] *** Joins: timot (timot@moz-1A989AA3.mobile.tre.se)
[06:21:37] <Heather> klutzy it works fine when I don't use array there, so is there way to use array there?
[06:21:37] <klutzy> Heather: borrowed ones are not yours. serialization means you are putting your own data to somewhere, and getting later
[06:21:43] <strcat> vLK: problem is that the snapshot links against that, I guess
[06:21:53] <klutzy> Heather: I think you just want to use ~[~str], rather than &
[06:22:06] <strcat> vLK: and by links against I mean the snapshot is a binary rustc compiler for bootstrapping
[06:22:12] <Heather> klutzy ah... such simply )
[06:22:12] <vLK> Right, with -lkvm, this should be fine ... - oh
[06:22:19] <vLK> I see strcat 
[06:22:30] <strcat> there's no dep like that elsewhere, not sure why it has that on freebsd
[06:22:48] <strcat> maybe just an oversight like how it linked against libtinfo (not portable) on linux
[06:22:52] <strcat> which is fixed now
[06:23:00] <Heather> klutzy thank you, this way works
[06:23:48] *** Quits: z0w0 (zack@64F0E14B.3C29B4A9.2CE63F58.IP) (Connection reset by peer)
[06:23:58] <vLK> libstd pulls it
[06:23:59] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:24:31] <Heather> klutzy I can't use if / for without brackets if there are only one action in body?
[06:24:42] <Heather> klutzy like in C if (a) b;
[06:25:45] <strcat> vLK: we're definitely not explicitly linking against, I'm not sure why that would happen
[06:26:00] <dbaupp> Heather: no, `if a{b}` is the minimal if statement in Rust
[06:26:15] <Heather> dbaupp why?
[06:26:26] <Heather> dbaupp is it planned for future?
[06:26:28] <strcat> Heather: C allows you to omit braces because it requires parens on all if statements
[06:26:31] <strcat> no, it won't happen
[06:26:37] <dbaupp> Heather: no
[06:26:50] <dbaupp> Rust trades parens for braces
[06:27:01] * dbaupp likes the trade
[06:27:14] <Heather> strcat I get it, it's really better to not use ( brackets on single boolean
[06:27:31] <Heather> dbaupp me too
[06:27:53] *** Joins: Ms2ger (Ms2ger@moz-2F2A356D.adsl-dyn.isp.belgacom.be)
[06:28:08] <Heather> dbaupp there is other way to write for myRepo in repoList.iter()  ? with each keyword ?
[06:28:18] <vLK> Ill try with /usr/ports/lang/rust then. Although it's still 0.7 :P
[06:28:20] <dbaupp> there isn't an each keyword
[06:28:37] <dbaupp> Heather: an no, that's correct (why would you think otherwise?)
[06:28:40] <dbaupp> *and
[06:28:41] <Heather> dbaupp but is there other syntax for it?
[06:28:57] <strcat> for loops are sugar for using the Iterator next method
[06:29:34] <dbaupp> Heather: no, other than writing the long hand (see the output of `rustc --pretty expand foo.rs` for that)
[06:29:45] <Heather> I just saw this article - http://brson.github.io/rust/2012/04/05/new-for-loops/ that's why I asked
[06:30:04] *** Joins: nixprime (nixprime@moz-B5BC087D.hsd1.ca.comcast.net)
[06:30:35] *** Quits: xkyllx (Mibbit@moz-B5BC087D.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:30:57] <Heather> ah I see it even was on rust main page and now it's changed
[06:34:16] <strcat> Heather: that's really ancient, in terms of rust time
[06:34:52] <strcat> Heather: the old iteration protocol was phased out in 0.6, mostly gone in 0.7 and 0.8 replaced the for loop
[06:34:55] <strcat> https://github.com/mozilla/rust/wiki/Doc-detailed-release-notes
[06:35:17] <Heather> I see
[06:36:44] <Heather> strcat fmt is deprecated in flavor of format! ?
[06:36:54] <strcat> yes
[06:37:01] <strcat> it's being removed as we speak
[06:37:03] <Heather> longer to write )
[06:37:23] <strcat> fmt! couldn't be removed until everything was using format!
[06:37:30] <strcat> it wasn't about changing the name
[06:37:55] <Heather> strcat I understand but {:s} is 2 symbols longer than %s
[06:37:57] <dbaupp> fwiw, fmt isn't being removed yet; just replaced with format throughout the stdlib
[06:38:01] <strcat> Heather: you can use {}
[06:38:07] <strcat> Heather: no need for {:s}
[06:38:31] <strcat> rusti: println!("{} {} {}", 3, "foo", 5.5)
[06:38:32] -rusti- 3 foo 5.5
[06:38:32] -rusti- ()
[06:39:03] <Heather> can I write 01println!("{1} {3} {2}", 3, "foo", 5.5)01 ?
[06:39:22] <strcat> Heather: yes but it starts indexing at 0
[06:39:33] <Heather> oh, it's C# !
[06:39:38] <strcat> you can also reuse the same number more than one, and there are named parameters to it
[06:39:50] <strcat> Heather: python has the same format language style too
[06:39:53] <Heather> I like it )
[06:39:54] <dbaupp> rusti: println!("{a} {1} {0}", 3, "foo", a=5.5)
[06:39:55] -rusti- 5.5 foo 3
[06:39:56] -rusti- ()
[06:40:12] <dbaupp> rusti: println!("{a:10.10} {1} {0}", 3, "foo", a=5.5)
[06:40:13] -rusti- 5.5000000000 foo 3
[06:40:13] -rusti- ()
[06:40:21] <strcat> and it's type-checked at compile-time
[06:40:23] <strcat> which is neat
[06:40:23] <dbaupp> etc.
[06:41:33] <dbaupp> rusti: println!("{ `it doesn't handle invalid strings very well though` }")
[06:41:34] -rusti- <anon>:7:18: 7:76 error: unterminated format string
[06:41:34] -rusti- <anon>:7          println!("{ `it doesn't handle invalid strings very well though` }")
[06:41:35] -rusti-                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[06:41:35] -rusti- error: aborting due to previous error
[06:41:35] -rusti- application terminated with error code 101
[06:41:51] *** Quits: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP) (Quit: Lost terminal)
[06:42:14] <Heather> failed to find an implementation of trait std::str::Str for &~str
[06:42:23] <Heather> println(format!(" *   branch: {:s}", b));
[06:42:36] <dbaupp> *b
[06:42:40] <Heather> should I get ~str from &~str
[06:42:44] <Heather> aha, got it
[06:42:53] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[06:43:01] <dbaupp> also, you should use println!(..); it will be faster
[06:43:19] <dbaupp> acrichto: (println! still allocates atm, right?)
[06:43:21] <Heather> dbaupp right...
[06:43:25] *** flaper87|afk is now known as flaper87
[06:43:25] <jeaye> From an i32, how can I get to a C-style enum?
[06:43:55] <dbaupp> jeaye: waiting until https://github.com/mozilla/rust/pull/9250 lands
[06:44:21] <dbaupp> (or writing a big match, or transmute, although you'll probably need to cast it to a different size for that)
[06:44:55] <jeaye> Yeah, transmute failed.
[06:45:03] <jeaye> Matching. :(
[06:45:05] <strcat> jeaye: it's not safe to store a value that's not listed in it, btw
[06:45:11] <jeaye> aye
[06:45:17] <strcat> transmute wants it to be the same size
[06:45:27] <jeaye> I'll just change my enum to a collection of statics.
[06:45:32] * jeaye shrugs.
[06:46:02] <dbaupp> I think `x as u64` should be enough for transmute to work
[06:46:25] <Heather> dbaupp but I can't use foo(*s)
[06:46:43] <Heather> dbaupp cannot move out of dereference of & pointer
[06:46:43] <strcat> dbaupp: until the enum PR lands
[06:47:31] <dbaupp> strcat: yes, but then you can chose a size explicitly, so it's even easier ;P
[06:47:41] <dbaupp> *choose
[06:47:54] <dbaupp> Heather: foo takes a ~str, right?
[06:48:03] <Heather> dbaupp yes
[06:48:15] <dbaupp> Heather: can it take a &str?
[06:48:17] <Heather> dbaupp I can't use &~str in foo I think
[06:48:28] <Heather> dbaupp I can change it to take &str :S
[06:48:32] <Heather> I gues
[06:49:01] <Heather> basics with ~ still confuse me a bit
[06:49:04] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[06:49:05] <dbaupp> but, ~str has a destructor, so it moves when every you pass it to functions
[06:49:16] <dbaupp> i.e. ownership gets transfered
[06:49:23] <Heather> I see...
[06:49:29] <dbaupp> so the original place is no longer valid to read from
[06:49:35] <Heather> so better always use & in functions
[06:50:04] <dbaupp> but & is a borrowed pointer, i.e. the value is borrowed, and you can't steal something that's borrowed (that would make you a bad person)
[06:50:08] <dbaupp> not always
[06:50:19] <Heather> with &  expected `&str` but found `&~str`
[06:50:31] <dbaupp> use & if you don't need ownership, use ~ if you do
[06:50:43] <dbaupp> you still need to deference the &
[06:50:54] <dbaupp> *dereference
[06:51:21] <Eridius> PR submitted for the path rewrite: https://github.com/mozilla/rust/pull/9655
[06:51:25] <Eridius> \o/
[06:51:35] <dbaupp> \o/
[06:51:37] <ChrisMorgan> Eridius: yay!
[06:51:45] <Heather> dbaupp with branch: &~str works )
[06:51:51] *** Quits: timot (timot@moz-1A989AA3.mobile.tre.se) (Connection reset by peer)
[06:51:54] *** Joins: timot_ (timot@moz-1A989AA3.mobile.tre.se)
[06:52:06] <Eridius> Rebased on top of latest master and passes `make check` locally. I'm assuming none of the few changes that I needed to fix are platform-specific
[06:52:56] <jeaye> It'd be nifty if arms patterns could contain casts (I mean, they already can contain guards!) `match foo { ERR => None, other as i64 => Some(bar(other)) }`
[06:53:02] <glyc> there has got to be a faster way to build after a macro change, no?  waiting 30 minutes after each small bit of code...ugh
[06:53:36] <dbaupp> Heather: "Rusty" code would use fn foo(branch: &str) and call foo(*s) if s was &~str
[06:53:43] <Heather> really sad about my package user with bug #9610 so he can't update to 0.8 rust
[06:54:04] <ChrisMorgan> glyc: time for your office chair sword fights.
[06:54:09] <Heather> dbaupp I see
[06:54:11] <jeaye> dbaupp: Rustic!
[06:54:14] <Eridius> btw, I'm expecting acrichto's fmt! PR #9599 to conflict, so whichever one goes in first will probably block the other
[06:54:15] <acrichto> dbaupp: yes, println allocates
[06:54:16] <glyc> hehe
[06:54:29] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[06:54:32] <acrichto> dbaupp: println! = println(format!(...))
[06:54:40] <glyc> ChrisMorgan: xkcd ruules
[06:54:47] <Heather> dbaupp it works too )
[06:55:09] <dbaupp> glyc: not really, although you can do make stage1-rustc (or rustc-stage1) to get yourself a compiler in <platform>/stage1/bin, which saves half the bootstrap
[06:55:20] <dbaupp> (if you're just wanting to test something)
[06:55:33] <dbaupp> acrichto: I assume that will change when new-rt gets stdio?
[06:55:50] *** Quits: ChrisMorgan (chris@moz-736C88F0.its.monash.edu.au) (Ping timeout)
[06:55:54] <acrichto> dbaupp: indeed
[06:56:02] <SiegeLord> Can matches be optimized to array accesses?
[06:56:30] <SiegeLord> Oh, actually I guess I can just transmute
[06:56:31] <glyc> dbaupp: make stag1-rustc !! sweet
[06:56:37] <glyc> dbaupp: I'll try that
[06:56:56] <dbaupp> SiegeLord: look at the asm/IR (-S/--emit-llvm -S respecitively) to be sure
[06:57:10] <SiegeLord> I'd have to learn that...
[06:57:22] <dbaupp> SiegeLord: (but actually think this was an optimsation that the servo people were wanting/needing to implement themselves, so I guess it currently doesn't work.)
[06:57:24] <SiegeLord> I guess I can't keep delaying it forever
[06:57:25] <flaper87> me waves
[06:57:30] * flaper87 waves
[06:57:48] <Eridius> crud, #9636 is going to have a minor conflict as well
[06:57:58] * Eridius shakes his fist at acrichto 
[06:58:00] *** Joins: skade (skade@moz-676A5402.dip0.t-ipconnect.de)
[06:59:34] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Places to go, people to annoy)
[07:01:25] *** Quits: Puddles (Mibbit@moz-10B0023F.ny325.east.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:02:26] *** Quits: skade (skade@moz-676A5402.dip0.t-ipconnect.de) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:04:58] *** Joins: charmander (Mibbit@moz-B5BC087D.hsd1.ca.comcast.net)
[07:05:27] *** Quits: charmander (Mibbit@moz-B5BC087D.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:10:51] <Heather> dbaupp how can I provide &str as ~str?
[07:11:03] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[07:11:15] <Ms2ger> .to_owned()?
[07:11:18] *** Quits: Ms2ger (Ms2ger@moz-2F2A356D.adsl-dyn.isp.belgacom.be) (Quit: bbl)
[07:12:04] <Heather> it works
[07:13:29] *** Joins: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP)
[07:17:45] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[07:18:16] *** Joins: skade (skade@moz-676A5402.dip0.t-ipconnect.de)
[07:19:34] *** Quits: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[07:20:58] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[07:21:18] <Heather> can I convert &[&str] to &[~str] ?
[07:23:46] <Eridius> Heather: .map(|x|x.to_owned())
[07:23:57] <Eridius> well no, that will give you a ~[~str], but you can then convert that to a &[~str]
[07:24:00] <Eridius> naturally, this will allocate
[07:25:04] <Heather> I see
[07:25:10] <Heather> Eridius will try
[07:26:02] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[07:26:18] *** Quits: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[07:26:24] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[07:28:03] <Heather> Eridius is it possible to pass &str as &'static str?
[07:28:12] <Eridius> only if it's a static string
[07:28:13] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[07:28:17] <Eridius> Why?
[07:28:33] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Quit: )
[07:28:40] <strcat> 'static is a special lifetime meaning it is a global constant and won't ever go away
[07:28:49] <Heather> Eridius to write string arry with static strings without adding ~ or & to them :S
[07:29:05] <strcat> &'static str is an &str
[07:29:12] <strcat> not all &str are &'static str
[07:29:35] <Heather> but "this" is not &str
[07:29:36] <Heather> :(
[07:29:47] <strcat> it is
[07:29:52] <strcat> it's an &'static str, which is a &str
[07:29:54] <Heather> hm
[07:30:14] <Heather> maybe I get my error wrong, let me recheck it )
[07:31:40] <Heather> strcat when I write [ "hello", world ] must world be forced to be static str even when it's &str ?
[07:32:09] <strcat> not necessarily, but it will infer the type from the first element
[07:32:39] <Heather> strcat I've got  mismatched types: expected `&'static str` but found `&str` there :(
[07:33:02] *** Joins: timot (timot@moz-1A989AA3.mobile.tre.se)
[07:33:05] <strcat> because it infers &'static str from the first element
[07:33:15] <strcat> so every type in the vector must satisfy that
[07:33:36] <Heather> strcat and that will force me to add prefix to every string there
[07:33:54] <strcat> it will let you write an array &'a str where 'a is the lifetime of world
[07:34:07] *** Quits: timot_ (timot@moz-1A989AA3.mobile.tre.se) (Ping timeout)
[07:34:14] <strcat> because 'static satisfies every lifetime constraint
[07:34:29] <strcat> the array being [&'static str, ..2] means *both strings* must live forever
[07:34:39] <glyc> I think I have func!() working, but I can't seem to get my unit test to compile.... http://pastebin.com/6M7QuDG0   why can't I call s1.defme() ??
[07:34:47] <Heather> ah right
[07:34:50] *** Quits: timot (timot@moz-1A989AA3.mobile.tre.se) (Ping timeout)
[07:34:55] <Heather> I can use prefix only on first argument
[07:37:20] *** Joins: timot (timot@moz-DF4A6D9D.anonymous.at.anonine.com)
[07:37:46] <Heather> Eridius and mapping to owner works just fine, thanks
[07:38:42] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[07:42:25] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[07:47:57] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[07:51:25] *** Joins: mib_uir0oi (Mibbit@moz-82A80C3F.tp-fne.tampereenpuhelin.net)
[07:51:38] *** Quits: mib_uir0oi (Mibbit@moz-82A80C3F.tp-fne.tampereenpuhelin.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:51:57] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[07:53:26] *** Quits: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[07:55:27] *** Joins: victorporof (victorporo@35F65A40.E0F96B01.D111398B.IP)
[07:57:03] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[07:58:20] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Connection reset by peer)
[07:58:38] <glyc> If I am implementing a method m on a trait Wooble, where Wooble provides a default m implementation, can I call into the default from my custom implementation?
[07:58:57] <glyc> i.e. forward some part of the work
[07:59:08] <glyc> to the default m
[08:02:54] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[08:06:31] <dbaupp> glyc: no
[08:06:37] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:07:09] <dbaupp> glyc: you can use the same pattern as syntax::fold does though, define normal functions outside the trait and have the default methods just call them
[08:07:17] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[08:07:23] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[08:08:18] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[08:15:31] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[08:16:17] *** Quits: Ralith (ralith@moz-36466B9F.customer.broadstripe.net) (Ping timeout)
[08:16:37] <fmtq> I just understood traits. I like them a lot.
[08:16:45] <fmtq> type safe monkey patching OO magic?
[08:16:47] <fmtq> yes plz.
[08:18:44] *** Joins: oleavr (oleavr@5CE161CF.14417725.ACE9CB65.IP)
[08:19:47] *** Joins: Ralith (ralith@moz-36466B9F.customer.broadstripe.net)
[08:24:37] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[08:25:42] *** Joins: z0w0 (zack@64F0E14B.3C29B4A9.2CE63F58.IP)
[08:27:01] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[08:28:54] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[08:30:23] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:31:45] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:32:33] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[08:33:03] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Ping timeout)
[08:33:22] *** Quits: oleavr (oleavr@5CE161CF.14417725.ACE9CB65.IP) (Ping timeout)
[08:35:49] *** Quits: timot (timot@moz-DF4A6D9D.anonymous.at.anonine.com) (Ping timeout)
[08:35:54] *** Joins: timot (timot@moz-D037EF70.cust.tele2.se)
[08:37:01] *** Joins: oleavr (oleavr@5CE161CF.14417725.ACE9CB65.IP)
[08:38:05] *** Joins: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com)
[08:39:21] *** Joins: squiddy (squiddy@moz-738B3C60.adsl.alicedsl.de)
[08:42:23] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[08:43:06] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[08:43:57] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[08:50:20] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[08:55:37] *** Joins: maik (maik@moz-6A162886.dip0.t-ipconnect.de)
[08:56:27] *** Quits: sammykim (Mibbit@B4104EBB.3CC170B1.1E14B209.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:58:01] *** Quits: timot (timot@moz-D037EF70.cust.tele2.se) (Ping timeout)
[08:58:44] <skade> Am I missing something or does Option really not have a way of saying: "something or this value"?
[08:59:13] <skade> The only way I see is: some_int_option.or(Some(42)).expect("this is a bit clumsy, but never printed")
[09:04:02] *** Quits: maik (maik@moz-6A162886.dip0.t-ipconnect.de) (Ping timeout)
[09:05:36] <Heather> can I ignore wrong warning? :S
[09:07:46] <hansjorg> skade: can't you use unwrap_or?
[09:08:19] <skade> hansjorg: I knew i was missing something ;)
[09:09:13] *** Quits: Heather (Heather@19663F6.F53BAACC.9C17E900.IP) (Ping timeout)
[09:10:21] *** Joins: Heather (Heather@19663F6.F53BAACC.9C17E900.IP)
[09:10:37] *** Joins: sproing (Mibbit@6EB9D10.20CC70E6.92EB3D3E.IP)
[09:12:02] *** Joins: sergi (textual@moz-DB55470C.upc-a.chello.nl)
[09:13:16] <dbaupp> rusti: Some(1i).unwrap_or(2i)
[09:13:16] -rusti- 1
[09:13:28] <dbaupp> rusti: Some(1i).unwrap_zero()
[09:13:28] -rusti- <anon>:7:9: 8:5 error: type `std::option::Option<int>` does not implement any method in scope named `unwrap_zero`
[09:13:29] -rusti- <anon>:7          Some(1i).unwrap_zero()
[09:13:29] -rusti- <anon>:8     };
[09:13:29] -rusti- error: aborting due to previous error
[09:13:29] -rusti- application terminated with error code 101
[09:13:55] <dbaupp> rusti: (Some(1i).unwrap_or_zero(), None::<~str>.unwrap_or_default())
[09:13:56] -rusti- (1, ~"")
[09:14:57] <sproing> hi. wanted to ask, is there a function that would allow to return a filtered list, something like ~[1, 2, 3, 4, 5, 6].iter().filter(|&x| x > 2) /* returns ~[3, 4, 5, 6] */ ? there seems to be such a function but the docs seem to point at a dead link there (http://static.rust-lang.org/doc/0.8/std/iter/Iterator/trait.Iterator.html)
[09:15:53] * Heather solved warnings problem, was my fault
[09:16:43] <sproing> nvm, found it. :)
[09:17:01] *** Quits: sproing (Mibbit@6EB9D10.20CC70E6.92EB3D3E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:21:15] *** Joins: maik (maik@moz-6A162886.dip0.t-ipconnect.de)
[09:21:48] *** Quits: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca) (Ping timeout)
[09:22:02] *** Quits: voxpopuli (fanservice@4A886597.7254D4BA.689607DE.IP) (Ping timeout)
[09:22:11] *** Quits: tikue_ (tikue_star@B46F4FD2.21C37D63.689607DE.IP) (Ping timeout)
[09:23:18] *** Quits: maik (maik@moz-6A162886.dip0.t-ipconnect.de) (Client exited)
[09:23:46] <Heather> Is there something alike os.geteuid() == 0  e.g. check if user have root privilegies
[09:24:43] <Heather> what is the "Rustic" way to parse command line arguments?
[09:25:21] *** Joins: lucian (lucian@moz-D82F7974.zone16.bethere.co.uk)
[09:27:36] *** Joins: nkoep (nik@moz-36112F64.pool.mediaways.net)
[09:27:55] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[09:27:58] *** Joins: timot (timot@moz-D037EF70.cust.tele2.se)
[09:28:13] *** Joins: lucian_ (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[09:28:46] <CarpNet> Heather: I think the extra::getopts module is what you're looking for http://static.rust-lang.org/doc/master/extra/getopts/index.html
[09:28:54] *** Quits: lucian (lucian@moz-D82F7974.zone16.bethere.co.uk) (Ping timeout)
[09:29:58] <Heather> CarpNet yes, seems like
[09:30:32] *** Joins: pepijndevos (pepijndevo@9EACEF43.E50A3180.BCE47D84.IP)
[09:31:31] <pepijndevos> How do i compile Rust for a non-android ARM target, using some codesurcery toolchain?
[09:31:39] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[09:31:47] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[09:32:36] *** Quits: nkoep (nik@moz-36112F64.pool.mediaways.net) (Ping timeout)
[09:32:37] *** Joins: nkoep (nik@moz-C9E79309.pool.mediaways.net)
[09:41:35] *** Quits: nkoep (nik@moz-C9E79309.pool.mediaways.net) (Ping timeout)
[09:42:13] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Client exited)
[09:44:17] <Heather> yet another time : how to get &str from ~str?
[09:44:20] *** Quits: oleavr (oleavr@5CE161CF.14417725.ACE9CB65.IP) (Quit: oleavr)
[09:44:30] <myname> what for
[09:45:04] <Heather> myname I need to pass string to [&str] from format! output
[09:45:07] *** Joins: oleavr (oleavr@5CE161CF.14417725.ACE9CB65.IP)
[09:45:11] <Heather> myname but format output is ~str
[09:45:49] <dbaupp> .as_slice()
[09:46:26] <Heather> dbaupp error: borrowed value does not live long enough :S
[09:52:18] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[09:54:23] *** Parts: vLK (vLK@moz-2D4B6366.bredband.comhem.se) ()
[09:54:25] *** Joins: Shaladdle (Shaladdle@moz-424BC304.hsd1.pa.comcast.net)
[09:55:05] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[09:57:21] *** Quits: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net) (Quit: dbaupp)
[09:58:03] *** Joins: nkoep (nik@moz-DD600810.vpn.rwth-aachen.de)
[09:58:16] *** Quits: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[09:58:50] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[09:59:02] <Heather> ah I get how to work with it, first define, then call as_slice when needed
[10:00:09] *** Joins: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net)
[10:00:23] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[10:02:13] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[10:02:15] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[10:02:28] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[10:02:47] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[10:03:16] *** Quits: sergi (textual@moz-DB55470C.upc-a.chello.nl) (Quit: Computer has gone to sleep.)
[10:06:39] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[10:12:55] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[10:14:06] *** jorendorff_away is now known as jorendorff
[10:14:20] <Heather> error: unresolved import: there is no `getuid` in `std::libc::funcs::posix88::un istd`
[10:14:37] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[10:17:51] *** flaper87 is now known as flaper87|afk
[10:19:30] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[10:21:56] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[10:24:44] *** Joins: maik (maik@C08593A3.C3960D65.B166373C.IP)
[10:26:45] *** Quits: maik (maik@C08593A3.C3960D65.B166373C.IP) (Ping timeout)
[10:29:34] *** flaper87|afk is now known as flaper87
[10:31:00] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[10:32:43] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[10:34:32] *** Joins: threecreepio (jdp@moz-9C11F46E.cust.bredbandsbolaget.se)
[10:36:08] <fmtq> is (rng.gen::<float>() * max).to_int() a safe way to get an integer in the range of 0 to max?
[10:36:31] *** Quits: Shaladdle (Shaladdle@moz-424BC304.hsd1.pa.comcast.net) (Quit: Leaving)
[10:36:49] <Heather> json config is ugly :(
[10:39:09] *** Quits: threecreepio (jdp@moz-9C11F46E.cust.bredbandsbolaget.se) (Quit: threecreepio)
[10:39:15] *** Quits: jj2baile (jon@moz-AB7945E9.csclub.uwaterloo.ca) (Ping timeout)
[10:40:34] *** Joins: Shaladdle (Shaladdle@moz-424BC304.hsd1.pa.comcast.net)
[10:42:09] <Heather> well PrettyEncoder is not so ugly, OK )
[10:43:23] *** Quits: nkoep (nik@moz-DD600810.vpn.rwth-aachen.de) (Quit: Leaving)
[10:46:36] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[10:50:24] <Heather> how can I check if string starts with some pattern?
[10:50:25] <Heather> regex?
[10:53:18] *** Joins: jensnockert (jensnocker@9CEA43E3.5B393F0A.A94117DA.IP)
[10:54:23] *** Quits: jensnockert (jensnocker@9CEA43E3.5B393F0A.A94117DA.IP) (Connection reset by peer)
[10:58:00] <fmtq> and then I found gen_integer_range
[11:04:10] *** Quits: dew (Instantbir@moz-EEE6B2F8.dhcp.stls.mo.charter.com) (Ping timeout)
[11:04:37] *** Joins: dew (Instantbir@moz-EEE6B2F8.dhcp.stls.mo.charter.com)
[11:05:35] *** Joins: Earnestly (earnest@moz-BE290A2B.dyn.plus.net)
[11:05:44] <Heather> iface deprecated?
[11:13:09] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[11:13:27] *** Joins: mib_vs0no9 (Mibbit@E114A24D.A869CBAF.BC5A979F.IP)
[11:13:44] *** Quits: mib_vs0no9 (Mibbit@E114A24D.A869CBAF.BC5A979F.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:15:03] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Connection reset by peer)
[11:15:28] *** flaper87 is now known as flaper87|afk
[11:15:35] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[11:16:35] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[11:18:03] *** Joins: threecreepio (jdp@moz-1A9F0A3C.cust.bredband2.com)
[11:19:15] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[11:21:32] <pepijndevos> $ export PATH="/home/pepijndevos/CodeSourcery/Sourcery_G++_Lite/bin:$PATH"
[11:21:42] <pepijndevos> ./configure --target-triples=arm-none-linux-gnueabi
[11:21:46] *** flaper87|afk is now known as flaper87
[11:21:54] <pepijndevos> configure: error: unsupported target triples "arm-none-linux-gnueabi" found
[11:23:06] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[11:24:53] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[11:25:11] <pepijndevos> arm-unknown-linux-gnueabi seems to work, but I'm not sure it'll find codesourcery that way
[11:27:15] <fmtq> no default params, blast.
[11:28:06] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[11:29:34] *** Joins: sergi (textual@moz-DB55470C.upc-a.chello.nl)
[11:31:35] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[11:35:16] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[11:44:27] <fmtq> made do with Option<T> :) 
[11:44:33] *** Joins: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP)
[11:49:02] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[11:51:16] *** Joins: Ms2ger (Ms2ger@moz-C4AD1860.ugent.be)
[11:52:33] <skade> for those testing their software on travis: https://github.com/skade/widmann/blob/master/.travis.yml
[11:52:38] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[11:53:03] <dbaupp> fmtq: btw, (rng.gen::<float>() * max).to_int() is not always safe: if max > 2^53 then your random number always have its low bits 0 (i.e. always divisible by 2, or 4, or 8.) but that's quite a large 'max'
[11:53:26] <dbaupp> skade: ooooh, travis works with rust now? awesome
[11:53:31] <fmtq> dbaupp: ah yes 
[11:53:34] <dbaupp> skade: oh! because of the PPA
[11:53:47] *** Quits: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net) (Ping timeout)
[11:54:01] <dbaupp> fmtq: gen_integer_range goes to some lengths to be perfectly uniform on [low, high)
[11:54:01] <skade> yep, if the ppa would have versions for 10.04, you could even run on heroku
[11:54:39] <dbaupp> (I think some people tried using it ages ago, but building rust from scratch was far too slow.)
[11:54:47] *** Quits: nrc|afk (nrc@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[11:54:55] <fmtq> dbaupp: I know i saw
[11:55:01] <fmtq> been looking at the source to work out how things work 
[11:55:09] <fmtq> I usually hate reading the code for language implementation.
[11:55:13] <fmtq> not this code.
[11:55:31] <dbaupp> cool :)
[11:55:36] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[11:56:56] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[11:57:06] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[12:00:39] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[12:03:28] *** Quits: sergi (textual@moz-DB55470C.upc-a.chello.nl) (Quit: Computer has gone to sleep.)
[12:04:52] *** Joins: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca)
[12:05:16] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[12:06:05] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[12:11:06] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[12:11:57] *** Quits: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[12:12:57] *** Joins: doomlord_ (servitor@moz-728E30A7.range109-151.btcentralplus.com)
[12:13:25] <Heather> dbaupp how can I check if string starts with some pattern? :)
[12:14:40] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[12:15:03] *** Joins: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net)
[12:15:08] <dbaupp> rusti: ("foobar".starts_with("foo"), "foobar".starts_with("bar"))
[12:15:08] -rusti- (true, false)
[12:15:15] <dbaupp> skade: https://github.com/chris-morgan/rust-http/pull/20 is very cool :D
[12:15:25] <Heather> dbaupp thanks )
[12:17:19] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[12:17:40] <skade> dbaupp: thanks ;)
[12:18:31] *** jorendorff is now known as jorendorff_away
[12:18:38] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[12:20:40] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[12:21:42] *** Joins: lessless (lessless@moz-F3755E99.emplot.net)
[12:22:00] *** flaper87 is now known as flaper87|afk
[12:22:03] *** Quits: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net) (Ping timeout)
[12:22:29] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[12:23:21] <Heather> dbaupp is there split for strings?
[12:23:57] <lessless> hi folks! Will Rust spread threads across all cores  in quad core and quad cpu setup ?  I mean will it utilize resource effectively? 
[12:24:04] *** jorendorff_away is now known as jorendorff
[12:24:11] <Heather> dbaupp I see there is .split_terminator_iter('.').collect(); O_o
[12:24:38] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[12:25:25] <dbaupp> lessless: yes, if you use spawn some tasks it will
[12:25:33] *** Quits: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca) (Quit: canhtak)
[12:25:39] <lessless> cool, thank you
[12:25:40] <dbaupp> Heather: there's .split_iter() .split_terminator_iter() .splitn_iter()
[12:25:55] *** Quits: Ms2ger (Ms2ger@moz-C4AD1860.ugent.be) (Ping timeout)
[12:25:57] <dbaupp> Heather: rsplitn_iter() too, I think
[12:26:11] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[12:27:06] <Heather> dbaupp I see
[12:27:23] *** Joins: Ms2ger (Ms2ger@moz-FFBA2AB4.ugent.be)
[12:30:37] *** Quits: timot (timot@moz-D037EF70.cust.tele2.se) (Ping timeout)
[12:31:35] <fmtq> the enum of structs with an impl that disambiguates using a match seems odd to me 
[12:31:41] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[12:33:08] *** Joins: timot (timot@moz-B3E7DB2F.anonymous.at.anonine.com)
[12:33:43] *** flaper87|afk is now known as flaper87
[12:36:20] <Heather> how to get array len ? )
[12:37:43] <doomlord_> .len() i think
[12:38:28] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[12:38:51] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[12:42:36] <Heather> doomlord_ thanks
[12:42:41] <Heather> how to if not ? :)
[12:42:43] <Heather> or unless
[12:43:56] <dbaupp> rusti: if ![1].is_empty() { print("foo") }
[12:43:56] -rusti- foo()
[12:44:16] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[12:44:22] <Heather> aha sure )
[12:44:26] <Heather> dbaupp thanks
[12:48:56] *** Quits: ksev (DrunkenPan@moz-71F7E457.cable.teksavvy.com) (Ping timeout)
[12:51:18] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[12:51:37] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[12:52:37] *** Joins: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com)
[12:55:38] *** Joins: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca)
[12:57:14] *** Quits: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca) (Quit: canhtak)
[12:57:55] *** Quits: Heather (Heather@19663F6.F53BAACC.9C17E900.IP) (Quit: ~ Trillian - www.trillian.im ~)
[13:03:01] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[13:04:38] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[13:04:45] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Quit: WeeChat 0.4.1)
[13:07:08] *** Joins: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com)
[13:07:17] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[13:07:18] *** Quits: doomlord__ (servitor@moz-728E30A7.range109-151.btcentralplus.com) (Connection reset by peer)
[13:08:28] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[13:11:18] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[13:11:30] *** Joins: sw17ch (sw17ch@moz-39D8564F.wndsny.tds.net)
[13:11:36] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[13:13:11] *** Joins: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca)
[13:14:01] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[13:14:22] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[13:20:11] <dbaupp> hansjorg: did you see this use for your nightly repo? http://www.reddit.com/r/rust/comments/1ni84a/running_rust_tests_on_travis_ci/ :)
[13:20:50] *** Quits: Houm (Houm@moz-25669AA8.fbx.proxad.net) (Ping timeout)
[13:21:12] <dbaupp> *nightly builds
[13:22:36] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[13:23:52] <hansjorg> dbaupp: didn't see that... nice :)
[13:24:12] *** Quits: xandy (xandy@moz-12478316.unity-media.net) (Ping timeout)
[13:24:34] <hansjorg> not familiar with travis-ci, got to try it out
[13:26:42] *** Joins: nrc (nrc@13F2CEC5.7672369.D8E68FF6.IP)
[13:30:17] <skade> hansjorg btw., could you activate ubuntu 10.04 for you nightly builds?
[13:31:04] <skade> I am playing around with heroku and others that still run 10.04. I copied your package over and rebuild it, it works: https://launchpad.net/~florian-gilcher/+archive/rust-nightly/
[13:34:24] <hansjorg> skade: Sure. I've started a build now
[13:34:41] <hansjorg> A bit surprised anyone is still on 10.04 though :)
[13:34:46] <skade> hansjorg: perfect :)
[13:35:00] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[13:35:26] <skade> LTS version. lot's of hosting services still use it
[13:37:43] <hansjorg> Oh, server version is supported until April 2015. I thought their LTS was only three years.
[13:38:33] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[13:39:11] <hansjorg> skade: https://launchpad.net/~hansjorg/+archive/rust/+build/5066542
[13:42:03] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[13:43:15] <skade> hansjorg thats going to take a while ;)
[13:43:30] <myname> any way to make ~[~[T]] into *T for c functions?
[13:44:41] *** Parts: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com) ()
[13:44:49] <dbaupp> myname: are all the elements meant to be contiguous for the *T?
[13:45:09] *** Joins: ahal (ahal@FCCEA34F.7672369.D8E68FF6.IP)
[13:45:21] <myname> yeah, with a given height and length
[13:45:27] *** Quits: penguin_dan (dan_johnsi@6902762D.11B071D.FB9A45AF.IP) (Client exited)
[13:45:34] <dbaupp> well, ~[~[T]] is essentially a **T
[13:45:45] <dbaupp> so you'll want to flatten the vectors
[13:45:54] <dbaupp> .concat_vec() and then .as_imm_buf or to_ptr
[13:46:52] <skade> return Some(Fail_) // someone said systems languages are not expressive...
[13:47:12] <myname> :D
[13:47:17] *** Joins: penguin_dan (dan_johnsi@6902762D.11B071D.FB9A45AF.IP)
[13:47:28] <myname> is overloading of functions supported?
[13:48:06] <dbaupp> only via traits
[13:48:15] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[13:48:31] *** Joins: clusterfoo (computer@moz-A81F9872.cable.teksavvy.com)
[13:49:25] <myname> oh
[13:49:31] *** Joins: Kruppe (user@47D9A12A.80DA567B.66C78069.IP)
[13:50:03] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[13:52:00] <hansjorg> skade: yep, you'll be able to catch a coffee. It's usually 1 hour 10 minutes for the amd64 build
[13:52:45] *** Joins: tgummerer (tgummerer@moz-5DC8FA44.tbcn.telia.com)
[13:52:59] <dbaupp> hansjorg: it has to do a full LLVM build?
[13:53:48] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[13:54:56] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[13:57:36] <myname> oh, concat_vec needs copy trait
[13:58:45] <dbaupp> if you can consume the vectors, then you can write your own one: `let mut v = ~[]; for w in nested_vectors.move_iter() { v.push_all_move(w) }`
[13:58:46] <hansjorg> dbaupp: yes, launchpad only accepts source packages and will do a clean build each time
[13:59:05] <dbaupp> myname: that^ doesn't require Clone
[13:59:11] <dbaupp> hansjorg: makes sense
[13:59:17] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[13:59:22] *** Quits: timot (timot@moz-B3E7DB2F.anonymous.at.anonine.com) (Ping timeout)
[14:01:24] *** Joins: timot (timot@moz-D037EF70.cust.tele2.se)
[14:02:02] *** Quits: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr) (Ping timeout)
[14:04:16] *** Joins: isenmann (isenmann@moz-B656BA79.science-computing.de)
[14:04:45] *** Quits: LimeBurst (me@247D1419.D73964AC.27A8748.IP) (Quit: leaving)
[14:05:35] *** Quits: Kruppe (user@47D9A12A.80DA567B.66C78069.IP) (Ping timeout)
[14:06:09] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[14:06:57] *** Joins: sergi (textual@moz-DB55470C.upc-a.chello.nl)
[14:07:27] *** flaper87 is now known as flaper87|afk
[14:08:58] *** Joins: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP)
[14:08:58] *** ChanServ sets mode: +o jdm
[14:11:01] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[14:11:32] <skade> wasn't there an issue open to build against a system LLVM sometime?
[14:12:09] <dbaupp> skade: probably
[14:12:50] *** Joins: mihneadb (mihneadb@C4EA9901.688AC74E.FCAAE698.IP)
[14:13:15] <dbaupp> skade: I can't find one directly, but https://github.com/mozilla/rust/issues/4259 kinda covers that
[14:14:57] *** Quits: kseo (uid14607@moz-E77DEB21.irccloud.com) (Ping timeout)
[14:14:57] *** Quits: wilfred (uid159@moz-5F4AA75A.irccloud.com) (Ping timeout)
[14:14:57] *** Quits: gazoombo (uid6629@moz-E77DEB21.irccloud.com) (Ping timeout)
[14:14:57] *** Quits: sawrubh (uid6719@moz-5F4AA75A.irccloud.com) (Ping timeout)
[14:14:57] *** Quits: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com) (Ping timeout)
[14:14:57] *** Quits: geomyidae__ (uid214@moz-E77DEB21.irccloud.com) (Ping timeout)
[14:17:06] *** Quits: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) (Ping timeout)
[14:17:50] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[14:18:05] *** flaper87|afk is now known as flaper87
[14:21:16] *** Joins: Kruppe (user@47D9A12A.80DA567B.66C78069.IP)
[14:23:09] *** Joins: maik (maik@moz-26FE5D50.dip0.t-ipconnect.de)
[14:26:17] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[14:26:50] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[14:28:24] *** Quits: tendernooblet (Mibbit@moz-10B0023F.ny325.east.verizon.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:28:56] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[14:30:16] <fmtq> can someone point me to the part of the manual that explains "'"
[14:30:19] <SimonSapin> Is this Tim sort stable? http://static.rust-lang.org/doc/master/extra/sort/fn.tim_sort.html
[14:30:22] <fmtq> such as in &'static ?
[14:30:41] <pepijndevos> note: the compiler hit an unexpected failure path. this is a bug :(
[14:30:57] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:31:08] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[14:31:22] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[14:31:40] *** Quits: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[14:31:54] <dbaupp> fmtq: http://static.rust-lang.org/doc/master/tutorial-borrowed-ptr.html
[14:32:00] <dbaupp> fmtq: specifically, http://static.rust-lang.org/doc/master/tutorial-borrowed-ptr.html#named-lifetimes
[14:38:00] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[14:39:27] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:39:43] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[14:40:05] *** Quits: maik (maik@moz-26FE5D50.dip0.t-ipconnect.de) (Ping timeout)
[14:40:29] *** Joins: kseo_ (uid14607@moz-E77DEB21.irccloud.com)
[14:43:58] *** Joins: ggherdov_ (uid11402@moz-E77DEB21.irccloud.com)
[14:44:10] *** Quits: mihneadb (mihneadb@C4EA9901.688AC74E.FCAAE698.IP) (Input/output error)
[14:44:52] <dbaupp> https://github.com/mozilla/rust/pull/9658 <3 mw
[14:45:09] *** Joins: maik (maik@moz-26FE5D50.dip0.t-ipconnect.de)
[14:45:24] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[14:51:48] *** Quits: anri (solancile@moz-E49E7C4B.hsd1.wa.comcast.net) (Quit: anri)
[14:52:12] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[14:52:41] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[14:53:19] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[14:54:03] *** Quits: maik (maik@moz-26FE5D50.dip0.t-ipconnect.de) (Ping timeout)
[14:54:11] <pepijndevos> doh… failure in fork: Cannot allocate memory
[14:54:20] <pepijndevos> how much memory do I need to compile rust?
[14:54:52] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[14:55:29] *** Quits: lessless (lessless@moz-F3755E99.emplot.net) (Client exited)
[14:56:01] <cyndis> somewhere between 2 and 3 gigabytes afaik
[14:56:16] <pepijndevos> I have +1GB free, but I'm compiling in a VM, so I can;t give it all 4GB I have
[14:56:49] <pepijndevos> too bad. Then I won't compile rust on the LEGO EV3
[14:57:14] <cyndis> :)
[14:57:42] <dbaupp> pepijndevos: the peak as of 3 days ago was 2141 MiB
[14:57:47] <dbaupp> (on x64 linux)
[14:58:06] <pepijndevos> I'm suing a 32 bit VM
[14:58:50] *** Quits: threecreepio (jdp@moz-1A9F0A3C.cust.bredband2.com) (Quit: threecreepio)
[14:58:58] <dbaupp> I guess that might reduce the memory usage very slightly, but a reduction of a 1GB from ust using smaller pointers might be a little too much to hope for, haha
[15:01:28] *** Quits: tgummerer (tgummerer@moz-5DC8FA44.tbcn.telia.com) (Ping timeout)
[15:02:11] *** Quits: bogen (dwight@moz-3AB88140.tx.res.rr.com) (Quit: Leaving.)
[15:08:37] *** Joins: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net)
[15:14:41] *** Quits: heftig (heftig@moz-67C1D84E.dip0.t-ipconnect.de) (Quit: Quitting)
[15:15:22] *** Quits: Ms2ger (Ms2ger@moz-FFBA2AB4.ugent.be) (Ping timeout)
[15:16:36] *** Joins: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[15:21:08] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[15:22:57] *** Joins: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP)
[15:26:45] *** Quits: z0w0 (zack@64F0E14B.3C29B4A9.2CE63F58.IP) (Ping timeout)
[15:28:52] *** Quits: Kruppe (user@47D9A12A.80DA567B.66C78069.IP) (Ping timeout)
[15:29:50] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[15:34:55] *** Quits: StarLight (StarLight@moz-21100A01.dynamic.avangarddsl.ru) (Ping timeout)
[15:36:43] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[15:38:04] *** Joins: lteo (lteo@moz-6787793C.lteo.net)
[15:38:30] *** Quits: oleavr (oleavr@5CE161CF.14417725.ACE9CB65.IP) (Quit: oleavr)
[15:38:32] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[15:39:13] *** Quits: sergi (textual@moz-DB55470C.upc-a.chello.nl) (Quit: Computer has gone to sleep.)
[15:39:29] *** Joins: StarLight (StarLight@moz-3A24043E.pppoe.avangarddsl.ru)
[15:39:56] *** Joins: mikezaby (mikezaby@moz-908EA8DE.home.otenet.gr)
[15:40:28] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[15:41:58] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[15:42:23] *** Joins: sergi (textual@moz-DB55470C.upc-a.chello.nl)
[15:44:28] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[15:46:03] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[15:47:47] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[15:47:53] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[15:48:03] *** Quits: Ralith (ralith@moz-36466B9F.customer.broadstripe.net) (Ping timeout)
[15:48:11] *** Joins: jj2baile (jon@moz-AB7945E9.csclub.uwaterloo.ca)
[15:48:22] <SimonSapin> is std::at_vec::build the preferred way to make a @[T]?
[15:49:59] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[15:50:15] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[15:50:17] *** Joins: maik (maik@moz-26FE5D50.dip0.t-ipconnect.de)
[15:53:02] *** Joins: fredy (fredy@moz-E7647C0E.vm.okeanos.grnet.gr)
[15:53:45] *** Quits: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[15:53:46] <dbaupp> SimonSapin: probably; but every few people use @[] so I don't think there's a convention for it (and std::at_vec is extremely neglected)
[15:54:05] <bstrie> I'm dying for lack of DST
[15:54:20] <bstrie> which, in context, sounds like a vitamin deficiency
[15:54:23] <nejucomo> DST?
[15:54:29] <bstrie> dynamically-sized types
[15:54:39] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[15:54:44] <bstrie> the thing which would make vectors and strings no longer magical
[15:55:00] *** Joins: jordyd (jordyd@moz-48EDA681.seg40.ucf.edu)
[15:55:01] <nejucomo> How would they be represented as locals?
[15:55:45] <nejucomo> Are [] and str the only DST at the moment?
[15:55:56] <Amaranth> I thought str was a typedef for a [u8]
[15:55:57] <bstrie> traits are as well
[15:56:47] <bstrie> *trait objects are DST as well
[15:56:53] *** Quits: maik (maik@moz-26FE5D50.dip0.t-ipconnect.de) (Ping timeout)
[15:56:53] <SimonSapin> Amaranth: str has a the same memory layout as [u8], but is special in the compiler
[15:57:03] <Amaranth> Ah
[15:57:10] <bstrie> nejucomo: niko has a series of blog posts about DST: http://smallcultfollowing.com/babysteps/blog/2013/04/30/dynamically-sized-types/
[15:57:18] <nejucomo> Really?  Does a trait pointer point to a table of methods?
[15:57:26] <nejucomo> -oh, and an instance?
[15:57:47] <dbaupp> nejucomo: trait object = (vtable ptr, ptr to data)
[15:57:58] <dbaupp> (an instance of one, yes)
[15:58:10] <nejucomo> bstrie: Thanks.  I forgot about Baby Steps!  I really enjoyed several posts there back in the 0.4 era.
[15:58:21] <bstrie> hasn't been updated as frequently as of late
[16:00:30] *** Joins: Ralith (ralith@moz-36466B9F.customer.broadstripe.net)
[16:00:48] <dbaupp> it may/hopefully will get some updates soon: https://botbot.me/mozilla/rust-internals/msg/6515482/
[16:01:27] *** Quits: bent (chatzilla@moz-932324BF.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[16:01:48] *** Joins: threecreepio (jdp@moz-9C11F46E.cust.bredbandsbolaget.se)
[16:05:40] <engla> it looks like strcat already made a dent in the graph with changes to immediates
[16:05:40] *** Joins: jdsanders (Adium@moz-F45527D6.hlrn.qwest.net)
[16:05:57] <engla> might be a fluke
[16:06:25] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[16:06:36] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Quit: Leaving)
[16:07:18] *** Joins: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP)
[16:09:00] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[16:09:03] <dbaupp> engla: looks like linux 32 when dramatically up though?
[16:09:06] <dbaupp> *went
[16:09:42] *** Quits: sergi (textual@moz-DB55470C.upc-a.chello.nl) (Quit: Computer has gone to sleep.)
[16:10:55] *** Quits: KindOne (KindOne@moz-590C0860.dynamic.ip.windstream.net) (Ping timeout)
[16:12:32] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[16:12:35] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[16:13:38] *** flaper87 is now known as flaper87|afk
[16:13:55] <jdsanders> is there more detailed documentation of the networking facilities in std::rt::io::net anywhere outside the std docs?
[16:14:52] *** Joins: yonran (yonran@moz-962F33EB.acuitus.com)
[16:14:59] *** Joins: KindOne (KindOne@moz-590C0860.dynamic.ip.windstream.net)
[16:15:49] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[16:15:58] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[16:17:05] *** Joins: wilfred (uid159@moz-5F4AA75A.irccloud.com)
[16:17:49] *** Joins: josh (josh@78FC94F1.F9C282AE.284344F5.IP)
[16:18:53] *** ahal is now known as ahal|lunch
[16:19:03] *** Quits: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca) (Quit: canhtak)
[16:19:24] *** Joins: sawrubh (uid6719@moz-5F4AA75A.irccloud.com)
[16:22:19] *** Joins: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[16:22:23] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[16:22:47] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[16:25:13] *** Joins: heftig (heftig@moz-E8E2034C.inf.fh-bonn-rhein-sieg.de)
[16:25:46] *** Quits: KindOne (KindOne@moz-590C0860.dynamic.ip.windstream.net) (Ping timeout)
[16:26:09] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[16:26:36] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[16:26:40] *** Joins: geomyidae__ (uid214@moz-E77DEB21.irccloud.com)
[16:28:04] *** Quits: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[16:28:10] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[16:29:23] *** Joins: KindOne (KindOne@moz-590C0860.dynamic.ip.windstream.net)
[16:29:34] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[16:31:42] *** Joins: gazoombo (uid6629@moz-E77DEB21.irccloud.com)
[16:32:00] *** Quits: heftig (heftig@moz-E8E2034C.inf.fh-bonn-rhein-sieg.de) (Quit: Quitting)
[16:32:11] *** Joins: heftig (heftig@moz-E8E2034C.inf.fh-bonn-rhein-sieg.de)
[16:32:17] *** Quits: heftig (heftig@moz-E8E2034C.inf.fh-bonn-rhein-sieg.de) (Input/output error)
[16:32:41] *** Quits: josh (josh@78FC94F1.F9C282AE.284344F5.IP) (Quit: josh)
[16:34:11] *** Joins: Ms2ger (Ms2ger@moz-2F2A356D.adsl-dyn.isp.belgacom.be)
[16:35:21] *** Quits: clusterfoo (computer@moz-A81F9872.cable.teksavvy.com) (Ping timeout)
[16:36:25] *** Joins: clusterfoo (computer@moz-A81F9872.cable.teksavvy.com)
[16:36:39] *** Joins: io2 (io2@moz-A6202C16.home.otenet.gr)
[16:38:28] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[16:40:05] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[16:42:42] *** Joins: heftig (heftig@moz-E8E2034C.inf.fh-bonn-rhein-sieg.de)
[16:42:59] *** Quits: Ralith (ralith@moz-36466B9F.customer.broadstripe.net) (Ping timeout)
[16:46:45] *** Joins: Florob (Florob@moz-39532932.de)
[16:47:14] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:47:14] *** ChanServ sets mode: +ao dherman dherman
[16:48:23] *** Joins: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca)
[16:53:40] <skade> has the debug! macro changed?
[16:53:41] <skade> test.rs:3:2: 4:1 error: too many arguments to fmt!. found 2, expected 1
[16:53:41] <skade> test.rs:3   debug!("foo")
[16:54:14] *** Joins: Kruppe (user@47D9A12A.80DA567B.66C78069.IP)
[16:54:17] <dbaupp> skade: output of `rustc -v`?
[16:54:37] <skade> rustc 0.9-pre (12404aa 2013-10-01 06:26:31 -0700)
[16:55:31] <nejucomo> This blog post about DSTs: http://smallcultfollowing.com/babysteps/blog/2013/04/30/dynamically-sized-types/
[16:55:48] <nejucomo> -doesn't it propose two things: runtime layout changes, and a trait to distinguish DSTs ?
[16:55:58] <nejucomo> -and couldn't a trait be added without runtime layout changes?
[16:56:42] <dbaupp> skade: oh, hm
[16:57:05] <dbaupp> acrichto: looks like I didn't fix debug! properly (skade's example^)
[16:57:11] <nejucomo> Can anyone describe why runtime-sized types cannot be added to the stack, or why stack frame sizes must be fixed?
[16:57:47] *** Joins: aeqwa (aeqwa@moz-6809B4D2.dsl.tropolys.de)
[16:58:37] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:00:14] <acrichto> dbaupp skade: looking, although I'm a little confused as to why this is a problem...
[17:00:42] <acrichto> oh whoops yeah {:?} is not %?
[17:01:03] *** Joins: tikue_ (tikue_star@moz-FEADCD38.hsd1.pa.comcast.net)
[17:01:04] <dbaupp> what a kerfuffle! :(
[17:01:33] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[17:01:33] *** ChanServ sets mode: +ao brson brson
[17:01:43] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[17:01:46] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[17:01:54] *** Joins: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com)
[17:02:13] <acrichto> dbaupp: https://github.com/mozilla/rust/pull/9659
[17:02:14] <acrichto> :(
[17:05:14] *** Joins: tjc (tjc@moz-7B0110AD.mv.mozilla.com)
[17:05:14] *** ChanServ sets mode: +o tjc
[17:06:17] <dbaupp> skade: will be fixed when ^ lands
[17:07:04] <skade> "old debug! macros"? what are the new ones?
[17:07:14] *** Joins: kelvin (kelvin@moz-282FBF4A.bootp.virginia.edu)
[17:07:17] <dbaupp> debug2, info2, etc
[17:07:27] <dbaupp> they use the new format! syntax.
[17:08:15] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[17:09:40] <kelvin> So I just updated to 0.8 and I was using line.split_iter('|').filter(|&x| x != "").transform(|x| x.to_owned()).collect(); in one of my programs, but now the compiler complains about the transform function that I am using. Is there a new function to replace it in 0.8?
[17:10:51] *** kmc sets mode: -b *!jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net
[17:12:01] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[17:12:12] *** Quits: mikezaby (mikezaby@moz-908EA8DE.home.otenet.gr) (Input/output error)
[17:12:22] *** Quits: skade (skade@moz-676A5402.dip0.t-ipconnect.de) (Ping timeout)
[17:12:32] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[17:13:11] <acrichto> kelvin: map
[17:13:49] <kelvin> acrichto: *facepalm* I probably should have realized that
[17:16:09] *** Joins: skade (skade@moz-EC93E8A9.dip0.t-ipconnect.de)
[17:19:06] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[17:19:54] <kelvin> so in std::os::Pipe, I noticed that the fields are now input and out, changed from in and out. Wouldn't input and output make more sense?
[17:21:06] *** Joins: hjr3 (hradtke@4020FFAC.1A57346B.C943C01E.IP)
[17:21:42] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[17:21:58] <jdsanders> is str::from_bytes gone now?
[17:22:07] *** Quits: victorporof (victorporo@35F65A40.E0F96B01.D111398B.IP) (Quit: victorporof)
[17:22:11] <Ms2ger> Yep, from_utf8 now
[17:22:22] <jdsanders> hmmm
[17:22:24] <jdsanders> ok
[17:22:30] <jdsanders> i guess that makes sense
[17:22:56] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Ping timeout)
[17:23:15] <nejucomo> Should new code use std::rt::io instead of std::io ?
[17:23:28] <jdsanders> should StrSlice.as_bytes be changed?
[17:23:36] <jdsanders> (to as_utf8)
[17:24:09] <cmr> no
[17:24:13] *** Joins: jxv (jxv@moz-8FB92450.lightspeed.irvnca.sbcglobal.net)
[17:24:23] <jdsanders> why the difference?
[17:24:27] <cmr> strings are always utf8, there's no need to add the redundancy everywhere
[17:24:55] <cmr> because when you're not crafting a string from random bytes, you're creating one from utf8-encoded bytes
[17:26:52] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:27:14] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[17:27:32] <jdsanders> but then, by the same argument, when you are converting a string into bytes, aren't they utf8-encoded bytes?
[17:27:48] <Ms2ger> Yes
[17:28:03] <Ms2ger> But not much value in changing that, I guess
[17:28:25] *** Quits: tikue_ (tikue_star@moz-FEADCD38.hsd1.pa.comcast.net) (Ping timeout)
[17:28:54] <jdsanders> well, I agree that it isn't high value, but the lack of symmetry is definitely a bit confusing
[17:28:59] <cmr> jdsanders: it was changed because from_bytes confusedpeople when it failed, iirc
[17:29:05] <jdsanders> yeah
[17:29:22] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[17:29:51] <cmr> I agree that it's not symmetric
[17:30:04] <jdsanders> I think from_utf8 makes sense, and changing to as_utf8 might make sense but also might not be worth the headache
[17:30:17] <stevekla1nik> woo offtopic, i quit my job today. unsure what's next. so expect lots of doc PRs from me ;)
[17:30:17] <jdsanders> thanks for the low-down
[17:30:29] *** Joins: Luqman (laden@moz-AB7945E9.csclub.uwaterloo.ca)
[17:30:34] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (NickServ (GHOST command used by stevekla1nik))
[17:30:37] *** stevekla1nik is now known as steveklabnik
[17:30:42] <jdsanders> stevekla1nik: any particular reason?
[17:30:49] <jdsanders> not doing enough rust over there perhaps :)
[17:30:49] *** Joins: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[17:31:01] <steveklabnik> heheh. it's been over two years, just time to move on a bit.
[17:31:09] <tjc> steveklabnik: congratulations!
[17:31:25] *** Joins: alk (alk@moz-32A9FF6A.fbxo.proxad.net)
[17:31:26] <steveklabnik> thanks :)
[17:32:08] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[17:36:08] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[17:36:53] *** ahal|lunch is now known as ahal
[17:37:26] *** Joins: riley (riley@8BA43816.9AA11D69.65DDFA89.IP)
[17:38:07] *** Joins: robarnold (rob@moz-59F6B5.hfc.comcastbusiness.net)
[17:38:42] *** Joins: sergi (textual@moz-DB55470C.upc-a.chello.nl)
[17:38:47] *** Joins: victorporof (victorporo@16E89FDD.B0D0881A.79933D60.IP)
[17:40:38] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:40:45] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:40:57] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[17:42:59] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[17:44:05] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[17:48:14] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[17:49:42] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[17:49:45] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[17:49:45] *** ChanServ sets mode: +ao pcwalton pcwalton
[17:51:19] <cmr> steveklabnik: re: nm -C, I added the -C, I didn't realize OS X doesn't have it
[17:51:45] <jdsanders> it doesn't/
[17:51:47] <jdsanders> ?
[17:51:48] <jdsanders> that's silly
[17:52:05] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[17:53:30] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[17:53:34] <steveklabnik> cmr: ahhhh
[17:53:50] <steveklabnik> that makes things make more snese
[17:53:52] <jdsanders> lots of people probably have binutils installed from homebrew
[17:53:56] <steveklabnik> do you think the suggested edit is the right thing?
[17:53:58] <jdsanders> in which case they'll have gnm
[17:54:06] *** Joins: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de)
[17:54:20] *** Quits: lucian_ (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[17:54:58] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[17:55:52] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[17:56:58] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[17:57:05] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[17:57:40] *** Joins: riddochc (riddochc@moz-18C892B3.hfc.comcastbusiness.net)
[17:57:48] <cmr> github is giving me unicorns, I'll check when it's back up
[17:57:57] <doomlord_> same
[17:57:59] <cmr> oh there we are
[17:58:28] <cmr> steveklabnik: lgtm
[17:58:37] <steveklabnik> cool
[17:58:43] <steveklabnik> yeah, github is kinda messed up
[17:58:52] <steveklabnik> seen some good tweets about wondering if it's part of the government ;)
[17:59:00] <riddochc> Hey, I'm having problems with building the llvm referenced from the rust-llvm-2013-09-15 branch.  ‘TGError’ was not declared in this scope in NeonEmitter.cpp:249:73.
[17:59:32] <riddochc> This is also an issue in the version of rust referenced by 0.8.
[17:59:37] <riddochc> Er, sorry, version of llvm.
[18:00:15] <riddochc> Anyone seen that?  How recent a version of llvm do I really need?  It takes *ages* for me to build it.
[18:00:53] <cmr> riddochc: we have a patched llvm
[18:01:28] <riddochc> cmr: Yeah, I'm pretty sure that's the one I'm trying to build.  In src/llvm, right?
[18:01:52] <cmr> yes, but that's to answer your "how recent" question
[18:02:17] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:02:40] <bstrie> steveklabnik: github is where the bill of rights is hosted, that's why the NSA is always DDOSing it!!!!
[18:02:44] *** Quits: sergi (textual@moz-DB55470C.upc-a.chello.nl) (Quit: Textual IRC Client: www.textualapp.com)
[18:02:54] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[18:02:56] <bstrie> I'm blowing this story wide open
[18:02:56] <brson> riddochc: that error will go away if you run make again
[18:03:20] <steveklabnik> bstrie: ahahaha
[18:03:29] <riddochc> brson: Yeah, I tried that, it didn't. :(
[18:04:03] <riddochc> It's checked out on c9ffab392
[18:05:16] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:05:19] *** Joins: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP)
[18:05:35] * tjc submits a pull request to the Bill of Rights
[18:06:19] <bstrie> tjc: the project owners have really onerous contribution guidelines :( you'll probably just have to maintain your own fork
[18:08:17] *** Joins: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net)
[18:08:34] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Quit: pcwalton)
[18:09:14] *** Joins: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu)
[18:09:37] *** Quits: stevekla1nik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[18:09:58] *** Quits: Thiez (thiez@moz-BF669398.student.utwente.nl) (Ping timeout)
[18:10:16] <myname> a [T, ..x] similar to a normal C array?
[18:10:17] *** Joins: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com)
[18:10:17] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:10:21] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[18:10:27] <glyc> trying to come to terms with libsyntax/fold.rs.  Q: I there is no noop_fold_fn  and  no noop_fold_method and no noop_fold_trait_method....   does noop_fold_block handle all these?
[18:10:39] <bstrie> myname: yep, it's fixed-size
[18:10:41] *** Joins: Thiez (thiez@moz-BF669398.student.utwente.nl)
[18:10:51] <myname> very good
[18:10:56] <riddochc> Well, for a workaround, anyone got a 32-bit linux build of rust 0.8 that's likely to work on opensuse 12.3 (current stable)?
[18:11:15] <strcat> brson: is there consensus on removing `float`? I can't really tell from the notes
[18:11:32] <bstrie> myname: of course, it's unlike C arrays in that we do dynamic bounds checking
[18:11:52] <glyc> bstrie: is there a way to turn off dynamic bounds checking?
[18:12:00] <brson> strcat: yes, remove it
[18:12:02] *** Quits: kelvin (kelvin@moz-282FBF4A.bootp.virginia.edu) (Ping timeout)
[18:12:09] <bstrie> glyc: there is, I believe by dropping into "unsafe" blocks bounds checking just goes away
[18:12:11] <glyc> brson: remote it?
[18:12:30] <glyc> bstrie: oh -- no bounds checking inside unsafe?
[18:12:36] <bstrie> as far as I know, yes
[18:12:40] <glyc> got it
[18:12:49] <bstrie> unsafe blocks are unsafe
[18:12:51] <bstrie> there be dragons
[18:13:00] *** Quits: heftig (heftig@moz-E8E2034C.inf.fh-bonn-rhein-sieg.de) (Quit: Quitting)
[18:13:14] <glyc> :-) still puzzled: why is there no noop_fold_method in libsyntax/fold.rs
[18:13:17] <glyc> ?
[18:13:27] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[18:13:27] <myname> okay, so i have this ~[~[T]] and want to make it into [fn(T), ..x], any fancy iteratory way to do so?
[18:13:44] <bstrie> an array of functions? how wacky
[18:13:52] <myname> no
[18:13:54] <strcat> pcwalton: btw I fixed that newtype struct immediate issue, although no luck making all small structs/enums immediate yet
[18:13:55] <kimundi> myname: what do you mean with [fn(T), ..x] ?
[18:13:57] <myname> just the result
[18:14:08] <strcat> pcwalton: there's some really weird problem where it can no longer catch failures ;p
[18:14:14] <pcwalton> strcat: was that the one that bounced my cross crate newtype constructors thing?
[18:14:16] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[18:14:25] <strcat> pcwalton: I think so, you reported a bug
[18:14:28] *** Joins: kvark (Mibbit@9A8A5739.49975FB2.AE2D72A6.IP)
[18:14:28] <strcat> it closed 5 issues
[18:14:32] <bstrie> myname: so... you have a ~[~[T]], but you don't actually care what's in it?
[18:14:33] <myname> i want to make a one-dimensional array out of a two-dimensional with the result of a function of each element of the source as result elements
[18:14:34] <kimundi> myname: do you want to apply a function to each vector, or to each elemnt of each vector?
[18:14:37] <strcat> at least you ran into it at some point
[18:14:46] <strcat> pcwalton: the ICE from 'non-box type'
[18:14:48] <myname> bstrie: i do, but i want to map()
[18:14:51] <pcwalton> oh hmm
[18:14:51] *** Joins: kelvin (kelvin@8C88C4D3.65B70227.DDE5D3F6.IP)
[18:14:52] <bstrie> ah ok
[18:14:54] <bstrie> we have maps!
[18:14:55] <myname> kimundi: each element
[18:14:58] <pcwalton> looks like it was a test that wasn't updated or something
[18:15:14] <bstrie> myname: but I don't know how to map *into* a fixed-size vec
[18:15:18] <myname> bstrie: yeah, but i need to make the 2-dimensional vector to a one-dimensional one
[18:15:35] <myname> bstrie: hasn't to be fixed-size, it should be C compatible
[18:15:37] <bstrie> I guess you'd just need to set up the vector beforehand
[18:15:54] <strcat> pcwalton: https://github.com/mozilla/rust/issues/8017 that one
[18:16:13] <strcat> anyway immediate tuples are working, 
[18:16:30] <kimundi> rusti: let v = ~[~[1u, 2u], ~[3u]]; v.iter().flat_map(|v| v.iter()).map(|*e| e).to_owned_vec()
[18:16:30] -rusti- <anon>:7:75: 7:76 error: unexpected token: `*`
[18:16:30] -rusti- <anon>:7          let v = ~[~[1u, 2u], ~[3u]]; v.iter().flat_map(|v| v.iter()).map(|*e| e).to_owned_vec()
[18:16:30] -rusti-                                                                                     ^
[18:16:31] -rusti- application terminated with error code 101
[18:16:33] <strcat> need to update datum/expr to make <= 1 word enums work as immediate
[18:16:38] <kimundi> rusti: let v = ~[~[1u, 2u], ~[3u]]; v.iter().flat_map(|v| v.iter()).map(|&e| e).to_owned_vec()
[18:16:38] -rusti- ~[1u, 2u, 3u]
[18:16:40] <strcat> it makes a lot of assumptions...
[18:16:48] <kimundi> myname: ^ ?
[18:16:50] <myname> oh, there is a flat_map
[18:17:21] <myname> oh
[18:17:24] <myname> what the hell
[18:17:44] <kimundi> rusti: let v = ~[~[1u, 2u], ~[3u]]; v.iter().flat_map(|v| v.iter()).map(|&e| e + 100).to_owned_vec()
[18:17:44] -rusti- ~[101u, 102u, 103u]
[18:18:05] <myname> i am very confused about that flat_map
[18:18:15] <kimundi> myname: what is confusing?
[18:18:20] *** Quits: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu) (Quit: lkuper)
[18:18:36] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Ping timeout)
[18:18:49] <kimundi> myname: it consumes an element of the basic iterator, and maps it to an iterator which the FlatMap Iterator iterates over
[18:19:11] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[18:19:11] *** Joins: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu)
[18:19:15] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[18:19:22] <kimundi> myname: So, we basically create an iterator for each vector in the outer vector, and concatenate them all together
[18:19:27] *** Quits: squiddy (squiddy@moz-738B3C60.adsl.alicedsl.de) (Ping timeout)
[18:19:53] <myname> what exacly does flat_map different than map?
[18:20:04] <kimundi> myname: map does A -> B
[18:20:06] <myname> it concatenates iterators?
[18:20:10] *** Joins: dandy (Dandy@moz-84CC8377.hsd1.co.comcast.net)
[18:20:24] <kimundi> myname: flat_map does A -> B, B, B, ...
[18:20:56] *** Quits: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu) (Ping timeout)
[18:21:05] <kvark> was slice matching only introduced in 0.8?
[18:21:12] <strcat> no
[18:21:39] <kvark> strcat: i'm doing it wrong then... will look for an example again
[18:21:44] <kimundi> myname: it maps each _element_ of an iterator to an _new_ iterator, and exposes them as a Iterator that iterates over all these
[18:22:39] <riddochc> I don't know why I thought the rust-llvm-2013-09-15 branch of src/llvm was useful to me, it looks like the main .gitmodules just checks out master, which hasn't changed since april 16?  does that sound right?
[18:22:41] <doomlord_> just seen the comment, so no std::clone function, await other solutions? 
[18:23:02] *** Joins: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu)
[18:24:23] <glyc> I'm in libsyntax/ext/expand.rs, and I want to call  fold::fold_method().  Why do I get unresolved name `fold::fold_method`  if I have use fold::*; and use fold; at the top of expand.rs ????
[18:25:44] <bstrie> how do I debug-print an array with the new format strings? (acrichto?)
[18:25:54] <strcat> bstrie: repr is {:?}
[18:25:56] <strcat> if you mean that
[18:25:56] <acrichto> bstrie: println!("{:?}", my_array)
[18:25:56] <kimundi> bstrie: {:?}7
[18:26:04] <bstrie> ah I see
[18:26:11] <kmc> glyc: you need to import the trait, use fold::ast_fold
[18:26:12] <bstrie> I thought that {:?} was equivalent to {}
[18:26:17] <cmr> no
[18:26:22] <strcat> bstrie: {} is trait-based
[18:26:28] <strcat> {:?} is the evil reflection bloat ;p
[18:26:51] <myname> so i am reading this ffi tutorial mentioning vec::raw::to_ptr
[18:26:57] <acrichto> {} == whatever fmt::Default::fmt says to do, {:?} == whatever fmt::Poly::fmt says to do
[18:26:59] <glyc> kmc: why... doesn't use fold::*; take care of that?
[18:27:02] *** Joins: timot_ (timot@moz-4DC1FDA.bredband.tre.se)
[18:27:03] <bstrie> strcat: I thought our current reflection support was designed to get rid of the bloat of the old reflection support :P
[18:27:07] <acrichto> Poly is defined for all types, Default is only defined for a few
[18:27:15] <kmc> glyc: I don't know; I might be off-base, did you try it?
[18:27:23] <glyc> kmc: just sec...
[18:27:23] <strcat> bstrie: it's bloated and it's evil because it visits priv fields, it's just an awesome debugging feature
[18:27:28] <myname> and i get errors ebout unresolved names about vec::raw::to_ptr
[18:27:28] *** Quits: timot (timot@moz-D037EF70.cust.tele2.se) (Ping timeout)
[18:27:28] <strcat> you don't want it in your releases
[18:27:31] <myname> how comes?
[18:27:41] <brson> bstrie: bounds checks still happen in unsafe blocks
[18:27:54] <glyc> kmc: use fold::ast_fold; // no better
[18:27:56] <kmc> myname: can you pastebin your code?
[18:27:58] <strcat> unsafe blocks only do 2 things
[18:27:59] <bstrie> brson: how *do* you turn off bounds checks, then?
[18:28:06] <strcat> 1) you can call unsafe functions, 2) you can deref raw ptrs
[18:28:08] <strcat> nothing else
[18:28:12] <strcat> bstrie: use the unchecked functions
[18:28:16] <bstrie> ok
[18:28:18] <strcat> they are marked unsafe ofc
[18:28:26] <strcat> or use iterators, they don't have any bounds check overhead
[18:28:32] <glyc> strcat: which are unchecked?
[18:28:38] <strcat> unsafe_get?
[18:28:42] <strcat> something like that
[18:28:59] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[18:29:07] <strcat> if you only need to iterate in a forwards or reverse direction over N things, just avoid indexing
[18:29:14] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[18:29:34] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Client exited)
[18:29:34] <strcat> pcwalton: oh and FWIW, clang can't vectorize a sum either :)
[18:29:44] <pcwalton> hmm, weird
[18:29:49] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[18:29:50] <strcat> I tested a bunch of examples and there's no case where C/C++ iterators vectorize and ours don't now
[18:29:56] <pcwalton> awesome
[18:30:06] <strcat> might be their cost models are screwed up, so it doesn't output certain instructions
[18:30:53] <bstrie> strcat: do you make automatic test cases for all these asm comparisons that you do?
[18:31:07] <strcat> bstrie: I compare the IR to clang's
[18:31:25] <strcat> we need IR test cases like clang/LLVM do
[18:31:29] <strcat> then I'll submit a bunch ;p
[18:31:33] <bstrie> strcat: I thought we had those
[18:31:36] <strcat> nope
[18:31:44] <strcat> we have tests of the IR *size*
[18:31:45] <bstrie> then what are these codegen tests actually testing
[18:31:46] <bstrie> ah
[18:32:10] <strcat> a vectorized + unrolled loop is often 5x larger, so it doesn't mean much
[18:32:14] <glyc> kmc: oh, fold_method is not public
[18:32:43] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[18:32:43] <strcat> (I guess it's pre-optimization IR size)
[18:32:45] <kmc> ah
[18:32:57] *** Quits: timot_ (timot@moz-4DC1FDA.bredband.tre.se) (Ping timeout)
[18:33:29] <glyc> would be nice if rustc would tell me its private instead of just saying 'unresolved name'
[18:33:39] <strcat> bstrie: there are IR test cases in my commit msgs ;p
[18:33:50] <strcat> bstrie: for example b2eb1c01a45cbb7bfc40f24073b60de61e3fad47
[18:34:26] <cmr> glyc: it will in some cases, but not all atm
[18:34:33] <cmr> privacy is being reworked
[18:35:04] <bstrie> just need to rewrite resolve again
[18:35:08] <bstrie> 4th time's the charm
[18:35:22] <bstrie> or is this the fifth time
[18:35:36] <cmr> bstrie: no, privacy is moving to its own pass
[18:35:39] *** Joins: timot_ (timot@moz-D037EF70.cust.tele2.se)
[18:36:00] <bstrie> weird
[18:36:15] <strcat> brson: https://github.com/mozilla/rust/pull/9519 r?
[18:36:26] <strcat> hm wat
[18:36:31] <strcat> I fixed it but it already broke
[18:36:33] * strcat sighs
[18:36:53] <strcat> odd
[18:37:20] <strcat> github isn't picking up that it moved
[18:37:48] <tjc> strcat: I'm having problems with github too, i pushed something to a branch and git reported locally that it succeeded, but it doesn't show up on github
[18:37:53] *** Joins: mihneadb (mihneadb@moz-913E7D88.residential.rdsnet.ro)
[18:38:00] <bstrie> strcat: are we reserving the float keyword, or is there a consensus that the notion of "fastest floating point type on this hardware" is something nobody will ever need?
[18:38:07] <strcat> bstrie: well, it's not the fastest
[18:38:10] <strcat> the fastest is f32
[18:38:12] <bstrie> right
[18:38:27] <bstrie> I'm not saying that it currently works that way :P
[18:38:29] <strcat> native on i686 is 80-bit, without SSE forced on
[18:38:38] <bstrie> just wondering if we're reserving the keyword
[18:38:44] <strcat> bstrie: it's not a keyword atm
[18:38:51] <cmr> I don't think float is useful.
[18:38:56] <bstrie> oh right
[18:39:00] *** Quits: Kruppe (user@47D9A12A.80DA567B.66C78069.IP) (Ping timeout)
[18:39:00] <strcat> and we can just rename c_float to float now
[18:39:09] <bstrie> the fact that true and false are keywords always fakes me out
[18:39:18] <strcat> I don't think they are
[18:39:22] <strcat> rusti: let true = 5;
[18:39:24] -rusti- <anon>:7:13: 7:19 error: mismatched types: expected `<VI0>` but found `bool` (expected integral variable but found bool)
[18:39:24] -rusti- <anon>:7          let true = 5;
[18:39:24] -rusti-                       ^~~~~~
[18:39:24] -rusti- error: aborting due to previous error
[18:39:24] -rusti- application terminated with error code 101
[18:39:31] <bstrie> or is it just bool that's a keyword
[18:39:32] <strcat> weird
[18:39:44] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[18:39:47] <strcat> that is a pretty weird errmsg
[18:39:52] <bstrie> no wait, the weird thing is that bool isn't a keyword, but true and false both are
[18:40:02] *** Joins: timot (timot@moz-4DC1FDA.bredband.tre.se)
[18:40:05] <bstrie> or... something
[18:40:10] <bstrie> it's bananas
[18:40:13] <strcat> ok it fixed itself
[18:40:16] <strcat> tjc: https://github.com/mozilla/rust/pull/9519 r?
[18:40:32] *** Quits: timot_ (timot@moz-D037EF70.cust.tele2.se) (Ping timeout)
[18:40:36] <cmr> bool shouldbn't be a keyword, it's justa builtin type
[18:40:42] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Ping timeout)
[18:40:43] <tjc> strcat: looking
[18:40:50] *** Quits: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de) (Quit: Verlassend)
[18:40:52] <strcat> just the thing from the meeting
[18:41:50] <bstrie> rusti: type bool = int; true
[18:41:51] -rusti- true
[18:42:16] <bstrie> rusti: type bool = int; let foo: bool = 1; foo
[18:42:17] -rusti- <anon>:7:42: 7:43 error: mismatched types: expected `bool` but found `<VI0>` (expected bool but found integral variable)
[18:42:17] -rusti- <anon>:7          type bool = int; let foo: bool = 1; foo
[18:42:17] -rusti-                                                    ^
[18:42:17] -rusti- error: aborting due to previous error
[18:42:17] -rusti- application terminated with error code 101
[18:42:31] <strcat> rusti: let bool = true;
[18:42:32] -rusti- <anon>:7:13: 7:17 warning: unused variable: `bool` [-W unused-variable (default)]
[18:42:32] -rusti- <anon>:7          let bool = true;
[18:42:32] -rusti-                       ^~~~
[18:42:32] -rusti- ()
[18:42:38] <strcat> that is *so* weird
[18:42:41] <strcat> rusti: let bool = true; bool
[18:42:42] -rusti- true
[18:42:44] <strcat> rusti: let bool = 5; bool
[18:42:45] -rusti- 5
[18:42:49] *** Quits: timot (timot@moz-4DC1FDA.bredband.tre.se) (Ping timeout)
[18:42:49] <strcat> oh, wat
[18:42:51] <bstrie> you can always do that though
[18:42:56] <strcat> rusti: let true = true; bool
[18:42:56] -rusti- <anon>:7:26: 7:30 error: unresolved name `bool`.
[18:42:56] -rusti- <anon>:7          let true = true; bool
[18:42:56] -rusti-                                    ^~~~
[18:42:57] -rusti- error: aborting due to previous error
[18:42:57] -rusti- application terminated with error code 101
[18:42:58] <bstrie> rusti: let int: int = 1; int
[18:42:58] -rusti- 1
[18:42:59] <strcat> rusti: let true = true; true
[18:42:59] -rusti- <anon>:7:13: 7:17 error: refutable pattern in local binding
[18:43:00] -rusti- <anon>:7          let true = true; true
[18:43:01] -rusti-                       ^~~~
[18:43:03] -rusti- error: aborting due to previous error
[18:43:05] -rusti- application terminated with error code 101
[18:43:08] <strcat> ah that makes sense
[18:43:17] * strcat understands why it wanted the integer to be a bool now
[18:43:51] <kimundi> strcat: You added support for getting the name of a type as a string, right? Where is that located?
[18:44:02] <strcat> in the tydesc
[18:44:02] *** Joins: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de)
[18:44:06] <strcat> repr uses it
[18:44:12] <bstrie> rusti: type int = uint; let i: int = 4u; i
[18:44:12] -rusti- <anon>:7:39: 7:41 error: mismatched types: expected `int` but found `uint` (expected int but found uint)
[18:44:13] -rusti- <anon>:7          type int = uint; let i: int = 4u; i
[18:44:13] -rusti-                                                 ^~
[18:44:13] -rusti- error: aborting due to previous error
[18:44:13] -rusti- application terminated with error code 101
[18:44:17] *** Joins: eholk (eholk@moz-BA312F07.crest.iu.edu)
[18:44:19] <strcat> and it seemed like a reasonable way to not output it 2000 times ;p
[18:44:27] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[18:44:40] <strcat> rusti: use std::unstable::intrinsics::get_tydesc; unsafe { get_tydesc::<int>() }
[18:44:41] -rusti- (0x60d030 as *())
[18:44:44] *** Quits: hjr3 (hradtke@4020FFAC.1A57346B.C943C01E.IP) (Ping timeout)
[18:44:48] <strcat> rusti: use std::unstable::intrinsics::get_tydesc; unsafe { (*get_tydesc::<int>()).name }
[18:44:49] -rusti- "int"
[18:45:12] *** Quits: jordyd (jordyd@moz-48EDA681.seg40.ucf.edu) (Quit: Leaving)
[18:45:14] <bstrie> rusti: let x = *(); x
[18:45:14] -rusti- <anon>:7:17: 7:20 error: type () cannot be dereferenced
[18:45:14] -rusti- <anon>:7          let x = *(); x
[18:45:14] -rusti-                           ^~~
[18:45:15] -rusti- error: aborting due to previous error
[18:45:15] -rusti- application terminated with error code 101
[18:45:19] <tjc> brson: r? https://github.com/mozilla/rust/pull/9654
[18:45:20] *** Parts: kvark (Mibbit@9A8A5739.49975FB2.AE2D72A6.IP) ()
[18:45:21] *** Joins: timot (timot@moz-4DC1FDA.bredband.tre.se)
[18:45:33] <strcat> rusti: use std::unstable::intrinsics::get_tydesc; fn name<T>(_: &T) -> &'static str { unsafe { (*get_tydesc::<T>()).name } } name(&5)
[18:45:34] -rusti- "int"
[18:45:49] <strcat> rusti: use std::unstable::intrinsics::get_tydesc; fn name<T>(_: &T) -> &'static str { unsafe { (*get_tydesc::<T>()).name } } name(&name)
[18:45:49] -rusti- <anon>:7:132: 7:137 error: cannot determine a type for this expression: unconstrained type
[18:45:49] -rusti- <anon>:7          use std::unstable::intrinsics::get_tydesc; fn name<T>(_: &T) -> &'static str { unsafe { (*get_tydesc::<T>()).name } } name(&name)
[18:45:49] -rusti-                                                                                                                                              ^~~~~
[18:45:49] -rusti- error: aborting due to previous error
[18:45:51] <cmr> whoaaaaaaaaaaa I hadn'tseen that before.
[18:45:51] -rusti- application terminated with error code 101
[18:45:54] <cmr> That's really simple
[18:45:59] <strcat> hm?
[18:46:03] <cmr> get_tydesc
[18:46:07] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Ping timeout)
[18:47:38] <jason_> is there a collection of algorithms like c++ std::lower_bound in rust libstd?
[18:48:26] *** Joins: hjr3 (hradtke@4020FFAC.1A57346B.C943C01E.IP)
[18:48:43] <kimundi> strcat: Do you know how to get to the type descriptor of the type in a trait object?
[18:48:56] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[18:49:00] <strcat> I could probably figure it out
[18:49:25] <strcat> I'd guess that the trait ptr points to an opaque_box thing
[18:49:33] <strcat> rusti: ~5 as ~ToStr
[18:49:34] -rusti- ~std::to_str::ToStr:Send
[18:50:15] <pcwalton> it's stuffed in the vtable I think
[18:50:34] <strcat> rusti: use std::unstable::raw::Box; unsafe { let (_, b): (*Box, *int) = std::cast::transmute(~5 as ~ToStr); *b }
[18:50:35] -rusti- <anon>:7:61: 7:64 error: wrong number of type arguments: expected 1 but found 0
[18:50:35] -rusti- <anon>:7          use std::unstable::raw::Box; unsafe { let (_, b): (*Box, *int) = std::cast::transmute(~5 as ~ToStr); *b }
[18:50:35] -rusti-                                                                       ^~~
[18:50:35] -rusti- application terminated with error code 101
[18:50:40] <cmr> jason_: we have some things on various iterators, but not everything, and not lower_bound
[18:50:42] <strcat> rusti: use std::unstable::raw::Box; unsafe { let (_, b): (*Box<()>, *int) = std::cast::transmute(~5 as ~ToStr); *b }
[18:50:43] -rusti- 5
[18:50:44] *** Quits: riddochc (riddochc@moz-18C892B3.hfc.comcastbusiness.net) (Quit: *poof*)
[18:51:02] <strcat> rusti: use std::unstable::raw::Box; unsafe { let (a, _): (*Box<()>, *int) = std::cast::transmute(~5 as ~ToStr); (*a).type_desc }
[18:51:03] -rusti- (0x403bb0 as *())
[18:51:09] <strcat> rusti: use std::unstable::raw::Box; unsafe { let (a, _): (*Box<()>, *int) = std::cast::transmute(~5 as ~ToStr); (*(*a).type_desc).name }
[18:51:10] -rusti- application terminated abnormally with signal 11 (Segmentation fault)
[18:51:12] <strcat> nope
[18:51:14] <strcat> ;p
[18:51:35] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Ping timeout)
[18:51:42] <strcat> anyway if you figure out what the representation of that thing is you could get it
[18:51:52] *** Quits: mihneadb (mihneadb@moz-913E7D88.residential.rdsnet.ro) (Input/output error)
[18:52:04] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[18:52:20] *** Joins: mihneadb (mihneadb@moz-913E7D88.residential.rdsnet.ro)
[18:52:41] <kmc> strcat et al: if I want to try out LTO between Rust and C++ code, do I need a version of clang whose LLVM version is close to rustc's, or will that not especially matter?
[18:52:51] <strcat> kmc: it will matter
[18:52:59] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[18:53:01] <strcat> 3.3 won't work without stripping readnone/readonly attrs from function signatures
[18:53:17] <strcat> they change the IR often :)
[18:54:02] *** Quits: mihneadb (mihneadb@moz-913E7D88.residential.rdsnet.ro) (Ping timeout)
[18:54:28] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[18:54:32] <kmc> so I should use the SVN version of clang?
[18:54:47] <strcat> kmc: yeah
[18:54:49] <kmc> ok
[18:54:50] <kmc> thanks
[18:54:54] <strcat> trunk will work
[18:54:57] <strcat> we are close to it
[18:55:31] <strcat> kmc: although you can still use 3.3 if you manually strip them ;p
[18:55:54] *** Parts: kelvin (kelvin@8C88C4D3.65B70227.DDE5D3F6.IP) ()
[18:55:57] *** ozten is now known as ozten|afk
[18:56:15] <benh> float is going away so that people make their own choice of how many bits their floats are supposed to be?
[18:56:16] <kimundi> pcwalton: Hm, any idea where I can find out of the memory layout of a vtable?
[18:56:27] *** Quits: lahwran (lahwran@lahwran.net) (Ping timeout)
[18:56:29] <kimundi> benh: yeah, pretty much
[18:56:31] <strcat> benh: float is always f64, so it doesn't really change anything
[18:56:32] <pcwalton> there's something in trans ... make_vtable() or something?
[18:56:55] <strcat> just a nice way of removing 1600 lines of code ;p
[18:56:58] <benh> strcat: ah, so it's not like int where it's i32 sometimes?
[18:57:07] <strcat> it's currently *always* f64
[18:57:09] <benh> ok
[18:57:14] <benh> thanks :)
[18:57:23] <strcat> I think it was intended to be the largest float type supported in hardware
[18:57:29] *** Joins: tikue_ (tikue_star@ABF748F2.CD72397.689607DE.IP)
[18:57:30] <SimonSapin> rusti: " \t foo bar".split_iter([' ', '\t']).to_owned_vec()
[18:57:30] -rusti- <anon>:7:9: 7:47 error: failed to find an implementation of trait std::str::CharEq for [char, .. 2]
[18:57:30] -rusti- <anon>:7          " \t foo bar".split_iter([' ', '\t']).to_owned_vec()
[18:57:31] -rusti-                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[18:57:31] -rusti- application terminated with error code 101
[18:57:32] <strcat> but I don't really see why you'd ever want that, and no one brought up a use case
[18:57:35] <strcat> so bye float :)
[18:57:43] <SimonSapin> rusti: " \t foo bar".split_iter(&[' ', '\t']).to_owned_vec()
[18:57:44] -rusti- ~["", "", "", "foo", "bar"]
[18:57:56] <benh> is int also intended to be the largest integral type supported in hardware?
[18:57:56] <SimonSapin> :(
[18:58:00] <strcat> benh: no
[18:58:05] <strcat> benh: it's the pointer-size integer
[18:58:07] <benh> I wasn't really clear how int64_ts worked on 32bit archs
[18:58:08] <benh> ah
[18:58:16] <strcat> if f64 is good enough on one platform, it should be good enough everywhere ;p
[18:58:20] <benh> and pointer-size floats are clearly useless ;)
[18:58:25] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[18:58:26] <kmc> NaN boxing!!
[18:58:54] <benh> kmc: Option<float> with None represented as NaN? :V
[18:58:54] <strcat> for example if you can get away with f32 instead of f64, the operations themselves are the same speed, but your arrays/structs will be 1/2 the size
[18:58:59] *** Joins: lahwran (lahwran@lahwran.net)
[18:58:59] <strcat> and you can shove 2x as many in SSE registers
[18:59:03] *** Joins: mihneadb (mihneadb@moz-913E7D88.residential.rdsnet.ro)
[18:59:05] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[18:59:12] <strcat> so you get (theoretically, I guess) double throughput
[18:59:51] <tiffany> there are quite a lot of nans wow
[19:00:00] <kmc> NaN boxing is a gross / awesome trick of JavaScript implementations where numbers are passed directly and pointers are encoded as different NaNs
[19:00:15] <benh> ah
[19:00:16] <SiegeLord> It still seems like precision errors may be more common than throughput issues...
[19:00:30] <pcwalton> integers are encoded as NaNs too
[19:00:31] <SiegeLord> I guess you can manually use f64 everywhere...
[19:00:38] <benh> sorry, my javascript experience is pretty much getting thrown out of a javascript discussion for not understanding the deal with semicolon insertion ;)
[19:00:43] <tiffany> it actually sounds lik a pretty good idea to encode Option<float> as a NaN
[19:00:43] <pcwalton> Either<i32,f64> could be 1 word ;)
[19:00:48] *** Joins: oleavr (oleavr@moz-1FB04F14.getinternet.no)
[19:00:58] <strcat> tiffany: ambiguous
[19:01:01] <benh> tiffany: maybe not if there's many different NaNs
[19:01:08] <strcat> unless there's some unused bit?
[19:01:17] <strcat> benh: there are all kinds of them ;p
[19:01:17] <pcwalton> strcat: NaNs have like 47 bits unused
[19:01:25] <strcat> ah
[19:01:28] <pcwalton> it's pretty absurd
[19:01:42] <strcat> so we could extend the bool/char optimization that we'll end up doing to floats too
[19:01:43] <tiffany> as wikipedia says, 32 bit float has s111 1111 1axx xxxx xxxx xxxx xxxx xxxx for NaN, where s is sign and a is quiet
[19:01:57] <tiffany> which is a whole 22 bits
[19:02:00] <benh> quiet?
[19:02:07] <strcat> there are signalling nans
[19:02:09] <tiffany> benh: some NaNs can raise exceptions
[19:02:12] <benh> ah
[19:02:22] <strcat> it doesn't make any bit of sense to me :)
[19:02:24] <jdm> who can explain why I'm getting this error? https://pastebin.mozilla.org/3177969
[19:03:05] *** Quits: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:03:22] <strcat> pcwalton: and LLVM loves our unique vectors now :)
[19:03:28] <strcat> since they're tagged noalias
[19:03:49] <strcat> although, if they were { len, capacity, data * } like I wish they were we would need metadata nodes
[19:04:14] <strcat> atm you often have to write functions as doing ~[T] -> ~[T] instead of using &mut [T] to get vectorization to work
[19:04:26] <strcat> but it's not worse than C without restrict
[19:04:48] *** Quits: oleavr (oleavr@moz-1FB04F14.getinternet.no) (Quit: oleavr)
[19:05:11] <tiffany> I never use __restrict__ in my C
[19:05:24] <jdsanders> are ReaderUtil and WriterUtil functions not available on things (like net::tcp::TcpStream) under std::rt::io due to implementing std::rt::io::Reader/Writer instead of std::io::Reader/Writer?
[19:05:31] *** Quits: mihneadb (mihneadb@moz-913E7D88.residential.rdsnet.ro) (Input/output error)
[19:05:57] <tiffany> rt::io is unfinished and line buffering and other *Util functions haven't been implemented
[19:06:04] <kmc> jdm: well your polymorphism bound gives you CacheableWrapper for T, not for @mut T
[19:06:06] <tiffany> as for Util traits themselevs, they'll probably die off because of default methods
[19:06:28] <jdsanders> tiffany: ok cool, I sorta figured, but thought I might be missing something, thanks!
[19:07:22] <pcwalton> tiffany: almost nobody uses restrict since it's hard to use right. this is one of the advantages of Rust :)
[19:07:35] <pcwalton> that restrict is in many ways the default and the compiler won't let you use it wrong
[19:07:40] <pcwalton> unless you go wild with unsafe
[19:07:50] * strcat wants to make some llvm passes
[19:08:09] <pcwalton> there should be some *really* interesting optimizations that linearity opens up
[19:08:20] <nejucomo> Also, I keep thinking the way std::io::{ReaderUtil,WriterUtil} are written requires an ambiguity in the type system…  but I haven't fully understood if that's true or not.
[19:08:22] <strcat> rather than trying to do TBAA nodes we can just tag arbitrary metadata and handle it in our own passes
[19:08:37] <strcat> pcwalton: even being able to mark pointer params/returns as non-null is interesting
[19:08:42] <jdm> kmc: I'm trying to allow a function to take both a @mut Foo and a Bar object that both implement the trait; any idea if that's possible?
[19:08:42] *** nejucomo is now known as nej-afk
[19:08:47] <benh> acrichto: Are format strings keeping the \{ \} escaping now that raw strings are confirmed?
[19:08:55] <pcwalton> strcat: what kind of optimizations does that enable?
[19:08:58] *** Joins: Jesin (Jessin_@moz-6EF909D6.cc.lehigh.edu)
[19:09:05] <pcwalton> I thought dereferencing a null pointer is already undefined behavior so...
[19:09:23] <kmc> jdm: you'd need to dereference the @mut T in order to call methods that are defined on T itself
[19:09:24] <strcat> pcwalton: it ends up thinking you are checking for null
[19:09:33] <kmc> perhaps autoderef is failing you
[19:09:44] <kmc> it can produce really counterintuitive errors
[19:09:46] <pcwalton> thinking you're checking for null when?
[19:10:01] <strcat> pcwalton: well for example Option<&T> is represented as null, so we do have null checks
[19:10:14] <strcat> and it doesn't always figure out that it couldn't have already been null
[19:10:22] *** Quits: hjr3 (hradtke@4020FFAC.1A57346B.C943C01E.IP) (Ping timeout)
[19:10:23] <pcwalton> oh hmm
[19:10:33] <myname> "error: Unit-like struct construction is written with no trailing '{}'"
[19:10:39] <myname> what does that mean?
[19:10:40] <jdm> kmc: yes, making it &mut *thisObj made it work
[19:10:44] <jdm> thanks
[19:10:47] <kmc> cool
[19:10:57] <benh> struct Foo; let f: Foo = Foo;
[19:10:59] <jdm> shame I have to pollute the code generator now
[19:11:04] <benh> not struct Foo {}; let f: Foo = Foo {};
[19:11:19] <bstrie> myname: normally when you make a struct you do so via `StructName {foo: bar}`. for unit structs it's just `StructName;`
[19:11:24] <SiegeLord> Is the discriminant for C-like enums always u64?
[19:11:42] <strcat> SiegeLord: this week, at least
[19:11:46] <strcat> it'll change soon
[19:11:52] <myname> so i cannot make a struct with values but not provide any at initialisation?
[19:11:56] <strcat> (also I think it's always treated as signed)
[19:12:31] <bstrie> myname: you can implement the Default trait, and then do a functional struct update with an instance of the default for that struct
[19:12:37] <SiegeLord> I hope when it changes a mechanism to figure it out will be introduced :P
[19:12:40] <bstrie> pretty clunky tho
[19:12:53] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[19:13:10] <myname> bstrie: sounds like i'm better with something like fn make_default_struct()
[19:13:22] *** Joins: Kruppe (user@47D9A12A.80DA567B.66C78069.IP)
[19:13:59] <kimundi> myname: Might as well implement Default for that though
[19:14:03] <SiegeLord> Or is it illegal to transmute between integers and C-like enums?
[19:14:07] <bstrie> myname: well the usual means of making a new instance of a struct is to make an associated function, so it would look like `MyStruct::new()`, and new could take as many or as few arguments as you want
[19:14:16] *** Joins: hjr3 (hradtke@4020FFAC.1A57346B.C943C01E.IP)
[19:14:37] <kimundi> SiegeLord: There are recent PRs that make the discriminant variable depending on enum
[19:14:48] <myname> how do i look that up?
[19:14:57] <bstrie> myname: look up what?
[19:14:59] <SiegeLord> kimundi: Is it variable depending on the system too?
[19:15:11] <myname> the stuff i need to make for the default trait
[19:15:32] <bstrie> myname: just stick the line `#[deriving(Default)]` on top of your struct definition and see if it compiles
[19:15:39] <myname> hahaha
[19:15:41] <bstrie> I'm not even sure if it's named Default, honestly
[19:15:43] <kimundi> SiegeLord: The PR I know of makes them as small as possible per default, with option to force a specific layout with an attribute
[19:15:44] <bstrie> maybe it's named Zero
[19:15:48] <bstrie> or maybe it got removed entirely
[19:15:53] * bstrie spins around in his chair gleefully
[19:16:07] <kimundi> bstrie: default is correct
[19:16:09] <SiegeLord> Ah... a specific layout sounds good enough for my purposes
[19:16:30] *** Joins: heftig (heftig@moz-67C1D84E.dip0.t-ipconnect.de)
[19:16:40] <kimundi> rusti: let x: uint = Default::default(); x
[19:16:43] -rusti- 0u
[19:16:44] <bstrie> myname: also not sure if that laughter was because you thought I was making a joke. that's seriously how you're supposed to implement the default trait
[19:16:45] <myname> not it complains about the struct not being a module
[19:17:11] <myname> *now
[19:17:12] <kimundi> myname: wut? Where did you stick the attribute?
[19:17:25] <myname> ah
[19:17:25] <bstrie> don't put a semicolon after the attribute
[19:17:33] <bstrie> that would be disastrous
[19:17:39] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[19:17:42] <kimundi> That why we need to change ti to #! :P
[19:17:46] <bstrie> exactly
[19:17:51] <bstrie> death to semicolons in attributes
[19:17:55] *** Quits: Kruppe (user@47D9A12A.80DA567B.66C78069.IP) (Ping timeout)
[19:18:01] <myname> huh
[19:18:09] <myname> well, i put it on top of it
[19:18:26] *** Joins: timot_ (timot@moz-7088860C.bredband.tre.se)
[19:18:28] <kimundi> bstrie: Though there is the good argument that semicolons should still be required. Just, you know, additionaly to the #!
[19:18:31] *** Quits: ski (md9slj@moz-862B1C66.studat.chalmers.se) (Ping timeout)
[19:18:38] *** Quits: gibbon (mathias@moz-1376FFC5.csbnet.se) (Ping timeout)
[19:18:41] <myname> ah
[19:18:41] <bstrie> kimundi: I still haven't heard a good argument for it :P
[19:18:45] *** Quits: Ke (jkarlson@moz-785A3407.org.aalto.fi) (Ping timeout)
[19:18:45] *** Quits: timot (timot@moz-4DC1FDA.bredband.tre.se) (Ping timeout)
[19:18:47] *** Joins: Ke (jkarlson@moz-785A3407.org.aalto.fi)
[19:19:07] <kimundi> bstrie: Well, it's an item, and all items are either terminated by } or ;
[19:19:12] *** Quits: dew (Instantbir@moz-EEE6B2F8.dhcp.stls.mo.charter.com) (Ping timeout)
[19:19:21] <bstrie> nobody ever thinks about that
[19:19:33] <kimundi> Might be
[19:19:49] <bstrie> attributes are just glorified comments
[19:19:55] <bstrie> metadata
[19:20:19] <bstrie> at least theoretically :P
[19:20:23] <kimundi> bstrie: Well, comments don't change the semantic of your code if you strip them ;)
[19:20:39] <bstrie> some attributes may be less insignificant than others
[19:20:50] <bstrie> but those are the exceptions
[19:20:50] <kimundi> haha
[19:21:04] <bstrie> so wait, hold on a sec
[19:21:08] <bstrie> about this mozilla meetup thing
[19:21:09] *** Joins: gibbon (mathias@moz-1376FFC5.csbnet.se)
[19:21:12] <bstrie> is anyone else here going?
[19:21:27] <bstrie> by meetup I mean the big damn tripartite conference this weekend
[19:21:31] <tikue_> what does "remove do for &fn" mean?
[19:21:42] <bstrie> tikue_: in what context
[19:21:54] <tikue_> bstrie, https://gist.github.com/brson/6781740
[19:22:06] <tikue_> oh god capture clauses :((((
[19:22:06] *** Joins: ski (md9slj@moz-862B1C66.studat.chalmers.se)
[19:22:12] <tikue_> brson pls
[19:22:20] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[19:23:07] <pcwalton> why did computing moves take 46 seconds
[19:23:23] *** Joins: Florob (Florob@moz-39532932.de)
[19:23:31] <bstrie> ...is this the setup to a joke?
[19:24:18] <tikue_> lol
[19:24:24] <bstrie> tikue_: don't sweat it, if they're terrible then maybe we'll find a solution
[19:24:32] <bstrie> but what we have right now apparently isn't cutting it
[19:24:54] <bstrie> if we loved capture clauses, we wouldn't have removed them in the first place
[19:24:56] *** Quits: ski (md9slj@moz-862B1C66.studat.chalmers.se) (Ping timeout)
[19:25:10] *** Quits: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de) (Quit: Verlassend)
[19:25:37] <benh> remove 'do' for stack closures?
[19:26:09] <benh> is this strcat's crusade againt the optimization-prohibiting code-size overhead of using stack closures everywhere? :D
[19:26:24] <tikue_> bstrie, i'm scared :3
[19:26:27] <strcat> stack closures are fine
[19:26:27] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[19:26:27] *** ChanServ sets mode: +o tjc
[19:26:31] <strcat> if they are implemented like C++ ;p
[19:26:42] <pcwalton> how do we not implement them like C++?
[19:27:12] *** Joins: ski (md9slj@moz-862B1C66.studat.chalmers.se)
[19:27:24] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[19:28:00] <bstrie> so yeah, that's the third thing I'm waiting for before attempting anything serious with rust. DST, @->Gc, and fn reform
[19:28:11] <pcwalton> IMHO unique types and capturing are very hard for beginners, it leads to first experiences like coda hale's in which he failed at making a simple ping pong setup
[19:28:30] <pcwalton> and then a large stream of angry messages on twitter and then switching to Go
[19:28:40] <bstrie> haha
[19:28:44] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[19:28:45] <bstrie> pcwalton's greatest fear
[19:28:53] <pcwalton> I'm serious
[19:29:02] <pcwalton> it is worth a little extra verbosity to make linearity understandable IMO
[19:29:07] <Earnestly> Do grown adults actually behave like that?  “I don’t understand something it must suck!”
[19:29:20] <benh> i do
[19:29:39] <bstrie> pcwalton: my concern is that I still haven't seen a concrete proposal of what to do, just pitches at what might eventually be done maybe
[19:29:46] <pcwalton> bstrie: we have one
[19:29:52] <bstrie> I would like to read it!
[19:29:53] <Earnestly> And /then/ feel the need to tell everyone else about their ignorance?
[19:30:06] <tikue_> pcwalton, you're in favor of capture clauses?
[19:30:09] <pcwalton> yes
[19:30:11] *** Joins: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net)
[19:30:12] <tjc> Earnestly: It sounds like you don't read reddit or hacker news much :P
[19:30:18] <tjc> Earnestly: which means you make good life decisions
[19:30:20] <Earnestly> tjc: How did you guess?
[19:30:32] <Earnestly> Haha, good for me then
[19:30:38] <bstrie> Earnestly: “I don’t understand something it must suck!” is approximately the truest representation of humanity that has ever been uttered
[19:30:40] <pcwalton> you have to understand a lot of stuff to make a ping-pong: the fact that "do" moves or references based on the type of a closure; the difference between &fn and ~fn; the difference between a SharedChan and a Chan; clone()
[19:31:05] <bstrie> pcwalton: I don't see what `do` has to do with this at all... it's just sugar
[19:31:09] <benh> Earnestly: I've tried to... not do it, but I catch myself going "gee, I can't understand this programmingy thing when I think about it in terms of <my favorite language>, it's probably an ill-conceived half-solution to a problem <my favorite language> doesn't even have" all the time
[19:31:14] <tjc> bstrie: I don't think it's universal… however, debating this owuld be far afield :-)
[19:31:19] *** Joins: maik (maik@moz-26FE5D50.dip0.t-ipconnect.de)
[19:31:23] <tjc> (the "I don't understand it" => "it sucks" thing, I mean)
[19:31:23] <tikue_> pcwalton, will closures without captures still work with current syntax? if so i'm fine with it
[19:31:30] <pcwalton> yes
[19:31:30] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[19:31:41] <pcwalton> not talking about capture clauses for referenced upvars :)
[19:31:52] <bstrie> a closure without captures is just a lambda though, eh? :)
[19:31:54] <pcwalton> bstrie: it's because it infers to &fn or ~fn based on the signature of the function you call
[19:32:12] <pcwalton> and whether you get &fn or ~fn changes how upvars work -- specifically whether they're moved
[19:32:12] <strcat> pcwalton: C++ implements lambdas essentially as structs, there's no boxing by default
[19:32:15] <tikue_> pcwalton, is there any tentative syntax for the captures?
[19:32:22] <strcat> each lambda has a unique type, and it makes the call via that
[19:32:25] <pcwalton> tikue_: not really, we have to figure it out
[19:32:30] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[19:32:30] <pcwalton> strcat: oh, yeah
[19:32:35] <Earnestly> benh: To be fair, there is also this → http://www.cs.utexas.edu/users/EWD/transcriptions/EWD06xx/EWD611.html
[19:32:36] <pcwalton> that also makes them more awkward to use
[19:32:42] <pcwalton> but it makes them efficient yeah
[19:32:42] <bstrie> pcwalton: but again that's attributable to the behavior of `|x| { ... }` inferring & or ~ based on use, rather than `do` having anything to do with it, right?
[19:32:55] *** Joins: tdc (santegoeds@moz-ADD1F5DF.range86-135.btcentralplus.com)
[19:32:59] <pcwalton> bstrie: sure, but "do spawn ~|x| { ... }" doesn't look very nice IMHO
[19:33:04] <jason_> c++ lambdas can't capture by move :(
[19:33:04] *** Quits: tdc (santegoeds@moz-ADD1F5DF.range86-135.btcentralplus.com) (Quit: Leaving)
[19:33:04] <tikue_> can we use \
[19:33:07] <strcat> pcwalton: well, you can coerce them to std::function<void(int, int)> which is like ~fn(int, int)
[19:33:13] <pcwalton> furthermore, "do with_whatever &|x| { ... }" is kind of an antipattern
[19:33:16] <pcwalton> just use RAII
[19:33:24] <strcat> they don't have an equivalent to &fn
[19:33:32] *** Joins: calatalee (Mibbit@moz-4D6BA918.superkabel.de)
[19:33:40] <benh> do with_whatever_multiple_times &|x| { ... } though
[19:33:41] <strcat> just like C++ doesn't have string/vector slices
[19:33:43] *** Quits: calatalee (Mibbit@moz-4D6BA918.superkabel.de) (Quit: http://www.mibbit.com ajax IRC Client)
[19:33:44] <pcwalton> strcat: that doesn't really fit in rust
[19:33:48] <pcwalton> benh: use an iterator :)
[19:34:01] <strcat> pcwalton: if we had a way to generically use callables it could
[19:34:10] <pcwalton> that would be a big redesign
[19:34:21] <strcat> pcwalton: I really wish stuff like map/filter on iterators could take a generic callable
[19:34:27] <strcat> so they could outlive a stack frame
[19:34:35] <pcwalton> we don't have time to redesign this
[19:34:42] <pcwalton> unfortunately we're stuck with what we have I think
[19:34:43] <strcat> true, but it'd be backwards compatible afaik
[19:34:50] <pcwalton> yeah, it would
[19:34:52] <kimundi> Yeah, I stumbled over that limitation recently
[19:34:53] <pcwalton> we discussed that actually
[19:34:53] <strcat> they'd just continue to coerce to &fn
[19:35:03] <pcwalton> back in a bit, lunch
[19:35:05] <pcwalton> we can fix this in the future
[19:35:09] <tikue_> kimundi, me too. can't return a filter object 
[19:35:33] <strcat> pcwalton: or hide a sketch of a redesign behind a -Z flag or #[experimental(Foo)] thing
[19:35:39] <strcat> like once fns
[19:36:00] <kimundi> tikue_: yeah, filter was the problem in my case too
[19:36:05] <strcat> I'm going to try making lambdas without captures be 'extern fn' soon
[19:36:12] <strcat> I think it'd help compile-time a lot
[19:36:25] <benh> I feel kinda weird about higher-order functions being an antipattern
[19:36:36] <tikue_> benh, no one said that
[19:36:38] <strcat> they aren't an anti-pattern
[19:36:42] <strcat> the implementation just sucks ;p
[19:36:45] <benh> I'm extrapolating!
[19:36:57] <strcat> trait objects work so well compared to ~fn/@fn
[19:36:59] <doomlord_> is this r.e. optimization of closures
[19:37:08] <strcat> and you can use static dispatch via generics with traits
[19:37:10] <tikue_> benh, `do_with` doesn't nearly encompass all higher-order functions
[19:37:13] <strcat> there's no equivalent option with closures
[19:37:25] *** Joins: oleavr (oleavr@moz-1FB04F14.getinternet.no)
[19:37:32] <benh> tikue_: we already killed all the @-higher-order-functions! now we're coming for the rest! i'm scared!
[19:37:37] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[19:37:43] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[19:37:51] <strcat> the reason trait objects aren't just a drop-in replacement is that you can't really have a Call trait with a variadic set of parameters on a call method ;p
[19:38:08] <strcat> but I have some ideas...
[19:38:17] <benh> task spawning seems kind of embarassed that it involves higher order functions and is trying to get out of that, isn't it
[19:38:27] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[19:38:27] *** ChanServ sets mode: +o pnkfelix
[19:38:35] <strcat> benh: closures aren't going away
[19:38:46] <tikue_> benh, lol
[19:38:50] <strcat> they are a very weak point of the language, compared to how awesome the rest of it is
[19:38:55] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[19:38:55] <strcat> that's why they're being talked about
[19:39:14] <tikue_> I'm just scared of the syntax that'll be decided upon for capture clause
[19:39:21] <benh> but they're also a really convenient/concise/expressive tool in languages where they're the most awesome part
[19:39:26] <doomlord_> when you say weak, you mean in implementation or current design
[19:39:37] <strcat> semantics
[19:39:38] <benh> and i'm not 100% convinced that we aren't holding them back somehow ;)
[19:39:54] <strcat> the implementation is not great, but the semantics are the problem
[19:39:55] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[19:40:08] <strcat> a stack closure doesn't exist in the type system
[19:40:20] <benh> (beyond stuff like not throwing our hands up and requiring a global gc for them)
[19:40:20] *** Quits: nej-afk (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[19:40:25] *** Quits: gibbon (mathias@moz-1376FFC5.csbnet.se) (Ping timeout)
[19:40:25] *** Quits: ski (md9slj@moz-862B1C66.studat.chalmers.se) (Ping timeout)
[19:40:26] <strcat> so they become an &fn with a lifetime limited to the stack frame
[19:40:32] <strcat> immediately
[19:40:37] *** Joins: sglez (sglez@E19C1D7A.4B605195.A208C5.IP)
[19:40:44] <strcat> so you can't have a function taking an iterator and returning a filtered iterator
[19:41:02] *** Quits: Ke (jkarlson@moz-785A3407.org.aalto.fi) (Ping timeout)
[19:41:03] <strcat> technically you could via ~fn, if we had some generic callable trait
[19:41:08] *** Quits: Flibo (Flibo@moz-40397852.org.aalto.fi) (Ping timeout)
[19:41:15] *** ozten|afk is now known as ozten
[19:41:15] <strcat> but as-is you need to define 3 versions of filter - one for &fn, one for ~fn, one for extern fn
[19:41:29] <strcat> and you're still missing the unboxed closure thing C++ can do
[19:41:49] *** Joins: spott_ (spott@moz-5158CBDE.colorado.edu)
[19:41:55] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Connection reset by peer)
[19:42:40] *** Quits: maik (maik@moz-26FE5D50.dip0.t-ipconnect.de) (Ping timeout)
[19:42:50] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[19:43:07] <tikue_> strcat, so will these changes enable the filter example to work?
[19:43:17] <tikue_> if so i'm in favor :3
[19:43:52] <strcat> well there isn't a fully fleshed out plan allowing what I want yet
[19:43:56] <strcat> for example
[19:43:58] <strcat> lets say...
[19:44:10] <strcat> fn(int, int) is sort of like a trait
[19:44:23] <strcat> fn foo<T: fn(int, int) -> bool>(f: T) { f() }
[19:44:38] <strcat> and you can pass &fn, ~fn, or extern fn, or a stack closure
[19:44:55] <strcat> but there are other ways you could do it
[19:45:01] <kmc> neat
[19:45:06] <strcat> could just say fn<T>(int) is a stack closure, where T is a tuple of the env types
[19:45:16] <strcat> but you wouldn't get the generic niceties
[19:45:42] *** Quits: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu) (Ping timeout)
[19:45:54] <tikue_> strcat, what expressiveness is gained from capture clauses?
[19:45:59] <nmatsakis> so, at least in our most recent meeting,
[19:46:27] <nmatsakis> I think we decided against capture clauses -- or at least we want to retain the option to not have them
[19:46:33] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[19:46:40] <nmatsakis> basically my having `fn` (stack closure) and something like `proc` (one-time thunk)
[19:46:45] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[19:46:50] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[19:46:54] <strcat> tikue_: the fn<T> thing wouldn't be about capture clauses, but just a way to express stack closures having varying env types
[19:47:09] <nmatsakis> (though I'd love to unify object types and closures -- but I think plan is to defer that for later)
[19:47:46] <nmatsakis> strcat: (unifying closures/traits/objects being my preferred way to achieve the stuff you're talking about)
[19:48:06] <strcat> mutability is tricky, had a discussion on it on the bug I opened
[19:48:07] *** Joins: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu)
[19:48:08] *** Joins: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de)
[19:48:28] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[19:48:29] <strcat> because if you can coerce &mut fn to &fn, the mutability of the env needs to be represented in the type of the fn
[19:48:45] <strcat> not as simple as I first imagined...
[19:48:57] <tikue_> i'm having difficulty thinking about this correctly. how would a function like filter change so that it could be returned to an outer scope? what would the argument be instead of &fn?
[19:48:57] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[19:49:11] <strcat> so lets say filter was defined like
[19:49:13] <benh> What would the type of filter's return value be?
[19:49:14] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Ping timeout)
[19:49:26] <tikue_> benh, that's what I'm wondering
[19:50:01] <strcat> fn filter<T: (fn(&A) -> bool)>(self, predicate: T) -> Filter<T> { Filter{iter: self, predicate: predicate} }
[19:50:16] <strcat> atm it's
[19:50:46] <strcat> fn foo<'a>(self, predicate: &'a fn(&A) -> bool) -> Filter<'a> { Filter{iter: self, predicate: predicate} }
[19:51:06] <strcat> (I'm leaving out the iterator type parameter for simplicity)
[19:51:22] <benh> Wouldn't you need a lifetime annotation in the first example too, somehow?
[19:51:26] <strcat> no
[19:51:28] <strcat> it's part of the type
[19:51:40] <strcat> so, as it's defined right now, you have to pass stack/heap closures as &fn
[19:51:43] <tikue_> strcat, so basically, stack closures will be no more? they'll be closure objects?
[19:51:50] <strcat> so not matter what, it can't outlive the stack frame
[19:52:01] <strcat> tikue_: stack closures don't exist in the type system atm
[19:52:12] <strcat> &fn is a borrowed closure, you can borrow ~fn as &fn
[19:52:15] <strcat> or extern fn as &fn
[19:52:16] <tikue_> strcat, ah right. I keep forgetting about that. what I meant was &fn will be no more?
[19:52:22] <strcat> tikue_: it will still exist
[19:52:26] <strcat> you could pass an &fn to that function
[19:52:33] <doomlord_> is there a wiki or something describing all the jargon and issues here.. whats the 'unboxed closure' case that rust doesn't currently do
[19:52:36] <strcat> it would allow everything it allows right now, but also allow moving an ~fn into it
[19:52:45] <strcat> or moving a stack closure into it
[19:52:53] <strcat> the latter being the awesome thing C++11 lambdas allow
[19:53:18] <strcat> stack closure == unique type + your environment
[19:53:22] <tikue_> strcat, sounds hard to implement :x
[19:53:36] <jdm> is there a way to match static strings against a ~str?
[19:54:35] <strcat> rusti: let s = ~"foo"; match s.as_slice() { "foo" => true, _ => false }
[19:54:35] -rusti- true
[19:54:48] <strcat> or do you mean the other way?
[19:55:07] <jdm> aha, as_slice is the magic sauce
[19:55:15] <strcat> jdm: yeah, it forces the coercion
[19:55:24] <strcat> I think it should work without as_slice but it's not clever enough
[19:55:58] <tikue_> nmatsakis, I'm personally happy to hear that capture clauses aren't decided upon yet :P I'm still curious what the reason is behind them? what is gained?
[19:56:15] <strcat> C++11 lambdas let you choose whether you capture by-value or by-ref
[19:56:21] <benh> strcat: does moving a stack closure into it imply that the environment is moved too?
[19:56:46] <doomlord_>  is capture by value or ref irrelevant for immutable, non-escaping closures
[19:56:50] <tikue_> strcat, oh wow...didn't even consider that.
[19:56:58] <strcat> benh: depends on whether the types you capture can be copied
[19:56:58] <doomlord_> ^^ can an optimizer theoretically always get the same result
[19:57:07] <benh> or copied, w/e
[19:57:11] <strcat> benh: yeah
[19:57:15] <strcat> you'd shallow copy the env
[19:57:20] <strcat> maybe a move, maybe not
[19:57:24] <tikue_> strcat, couldn't there still be a default that doesn't require the capture clause? specifying if you want to do something other than the default?
[19:57:25] <benh> I tend to think of moving as a general term that also covers copying, just by moving a copy or whatever :)
[19:57:46] <benh> strcat: so basically your proposal is adding C++-style lambdas next to our current lambda types?
[19:57:54] *** Joins: Ferio (Mibbit@moz-23CDE542.fullrate.dk)
[19:57:57] <strcat> benh: no, replacing them under the hood
[19:58:04] <strcat> we don't have stack closures in the type system at all atm
[19:58:24] * tikue_ will be a happy camper once this is all fixed
[19:58:38] <strcat> anyway I find this the only painful thing I run into over and over now
[19:58:43] <strcat> with stuff like map/filter
[19:58:47] <tikue_> agreed
[19:59:15] <strcat> rusti: range(0, 5).map(|x| x * 2)
[19:59:16] -rusti- error: internal compiler error: unexpected failure
[19:59:16] -rusti- note: the compiler hit an unexpected failure path. this is a bug
[19:59:17] -rusti- note: try running with RUST_LOG=rustc=1 to get further details and report the results to github.com/mozilla/rust/issues
[19:59:17] -rusti- std::iter::Map<,int,int,std::iter::Range<int>>{iter: std::iter::Range<int>{state: 0, stop: 5, one: 1}, f: fn(int) -> int}
[19:59:20] <strcat> rusti: range(0, 5).map(|x| x * 2)
[19:59:21] -rusti- error: internal compiler error: unexpected failure
[19:59:21] -rusti- note: the compiler hit an unexpected failure path. this is a bug
[19:59:21] -rusti- note: try running with RUST_LOG=rustc=1 to get further details and report the results to github.com/mozilla/rust/issues
[19:59:23] -rusti- std::iter::Map<,int,int,std::iter::Range<int>>{iter: std::iter::Range<int>{state: 0, stop: 5, one: 1}, f: fn(int) -> int}
[19:59:23] <strcat> uh
[19:59:26] <strcat> whatever
[19:59:33] <tikue_> lol
[19:59:47] <strcat> atm, that map iterator can't outlive the env of the lambda
[19:59:59] <strcat> and stack closures put their env on the stack and then immediately borrow it
[20:00:17] <strcat> if map was changed to take a generic param, you could *still* pass &fn
[20:00:30] <strcat> but there, it wouldn't have to do a coercion. it'd move the stack closure env inside it
[20:00:31] <tikue_> it'd be cool to have recursive lambdas without requiring the current workarounds
[20:00:55] <strcat> rusti: 2
[20:00:56] -rusti- 2
[20:01:03] <strcat> rusti: range(0, 5).map(|x| x * 2)
[20:01:03] -rusti- std::iter::Map<,int,int,std::iter::Range<int>>{iter: std::iter::Range<int>{state: 0, stop: 5, one: 1}, f: fn(int) -> int}
[20:01:44] <cmr> strcat: what version of rust are you using that you still get ICEs with rustc -v?
[20:01:50] <strcat> trunk
[20:01:59] <cmr> I haven't gotten them for a while using your package
[20:02:04] <cmr> rusti: version
[20:02:05] -rusti- "rustc 0.9-pre (9883a62 2013-09-28 16:21:04 -0700)"
[20:02:15] <nmatsakis> tikue_: capture clauses are kind of a side-issue
[20:03:02] <nmatsakis> tikue_: they arose in two contexts in this discussion
[20:03:29] <strcat> C++ lambdas are like
[20:03:31] <strcat> [] {}
[20:03:33] <strcat> minimal one
[20:03:41] <nmatsakis> tikue_: my "radical simplification" proposal, in which we used macros to replace what is today `~fn` -- in this case, macros can't do the fancy analysis for figuring out which variables are references
[20:03:46] <strcat> [](int x, int y) { return x + y; }
[20:03:57] <strcat> [z](int x, int y) { return x + y + z; } // by-value capture of z
[20:04:05] <strcat> [&z](int x, int y) { return x + y + z; } // by-ref capture of z
[20:04:17] <strcat> (they have no by-move capture atm)
[20:04:21] <nmatsakis> tikue_: they also arose under some proposals to generalize closures by having you specify the "terms" in which you capture variables -- so you could capture the value, or capture by ref, or by mut ref, and that owuld be explicitly specified and intermingled (vs now, where its implicit, and you either capture all-by-value or all-by-ref)
[20:04:54] <cmr> skade: knob is very cool!
[20:05:08] <doomlord_> in the case where everything is inlined can it recover the efficiency of c++ lambdas, or is it a problem that prevents inlining in the first place
[20:05:10] *** Joins: CarpNet (Alasdair@moz-EF831A5E.cable.virginmedia.com)
[20:05:11] <strcat> [=] and [&] are also the shortcuts for all-by-value/all-by-ref
[20:05:13] <tikue_> nmatsakis, I really hadn't considered that before but it seems like a good feature
[20:05:19] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[20:05:20] <strcat> doomlord_: C++ lambdas don't involve function ptrs
[20:05:25] <cmr> skade: exciting to see more application/library work done, to have something to write about in TWiR besides compiler/stdlib stuff :D
[20:05:27] <strcat> they are static dispatch
[20:05:40] <strcat> a C++ lambda like
[20:05:44] <skade> cmr thanks!
[20:05:53] <strcat> int x; int y; [x, y](int z) { return x + y + z; }
[20:05:55] <strcat> is essentially
[20:05:57] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Input/output error)
[20:06:10] <tikue_> strcat, so we could have like, [foo] |x, y| bar(foo,  x, y)
[20:06:14] *** Joins: ski (md9slj@moz-862B1C66.studat.chalmers.se)
[20:06:22] <tikue_> it's not *terrible*
[20:06:25] <tikue_> :P
[20:06:26] <skade> cmr: yep, I'm not really a compiler person, but very interested in whats possible in "userspace", so I just had to push this as far as possible (for a day)
[20:06:29] *** Joins: gibbon (mathias@moz-1376FFC5.csbnet.se)
[20:06:39] <strcat> struct GloballyUniqueType { int x, y; void operator()(int z) { return x + y + z; }; GloballyUniqueType{x, y}
[20:06:43] <strcat> it's just sugar for that
[20:06:53] <skade> I also had to try out rustdoc :)
[20:07:00] <doomlord_> ok
[20:07:29] <doomlord_> and rust always makes something with a function pointer ?
[20:07:34] <strcat> doomlord_: yes
[20:07:34] *** Joins: Ke (jkarlson@moz-785A3407.org.aalto.fi)
[20:07:35] <nmatsakis> strcat: at some point, not sadly right now, I need to chat with you about iterators and changes in borrowck to fix #8624
[20:07:40] *** Joins: Flibo (Flibo@moz-40397852.org.aalto.fi)
[20:08:08] <strcat> ah that evil &mut thing
[20:08:10] <doomlord_> and its hard for the optimzier to figure out when its just one function that can be inlined?
[20:08:38] <strcat> doomlord_: yes
[20:08:45] <strcat> a rust closure is (ptr, env)
[20:08:45] <kimundi> rusti: Some(5u).and_then(|v| v + 100)
[20:08:46] -rusti- pastebinned 13 lines of output: http://sprunge.us/eUQK
[20:08:55] <strcat> where env is a box with a 4-word header, including a tydesc describing the captures
[20:09:16] <strcat> if you make a stack closure, it immediately becomes a boxed &fn
[20:09:28] <myname> what the hell
[20:09:34] <doomlord_> and this is why the newer for loops beats the old do sugar iterators
[20:09:34] <strcat> LLVM spends a lot of time just getting to the point where it can be inlined
[20:09:56] <strcat> doomlord_: well, if you mean performance-wise, it's one of several reasons
[20:10:03] <myname> char can't hold any unicode stuff, can it?
[20:10:11] <strcat> myname: char == unicode code point
[20:10:12] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[20:10:14] <strcat> as in rust's char
[20:10:22] <Ferio> Hej, is there any rule of thumb when to use which kind of pointer? When should I use a HashMap<~str, ~str>, HashMap<&str, &str> or even HashMap<&~str, &~str>?
[20:10:25] <strcat> rusti: std::sys::size_of::<char>()
[20:10:26] -rusti- 4u
[20:10:38] <myname> strcat: in this case i'm pretty confused i can't convert u32 to char
[20:10:47] <strcat> myname: not all u32 are valid code points
[20:10:50] <strcat> you need char::from_u32
[20:10:55] <myname> ah
[20:11:06] <glyc> Ferio: use ~ by default, it means malloced and only one owner
[20:11:09] <strcat> you can cast u8 as char, but not u16/u32 since not all are valid
[20:11:22] <doomlord_> are you going to need new syntax to fix this.. or is it restruturing of the intermediate representations the copiler uses
[20:11:23] <strcat> Ferio: well, ~str isn't actually a unique pointer (~T)
[20:11:28] <cmr> Ferio: Don't use pointers if you can avoid it. But, for a HashMap, you want HashMap<~str, ~str>
[20:11:37] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[20:11:49] <strcat> doomlord_: a syntax for allowing function "trait" bounds on generic types
[20:11:57] <strcat> no change to the lambda syntax
[20:12:06] <strcat> and it would likely be backwards compatible
[20:13:31] * strcat is more and more convinced that ~str/~[T] is closer to sulphur than sugar
[20:13:40] *** Quits: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP) (Ping timeout)
[20:13:51] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[20:14:20] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[20:14:20] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[20:14:25] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:14:27] <Ferio> cmr: But wouldn't HaspMap<~str, ~str> clone the values I put into it?
[20:14:32] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:14:38] *** Joins: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:14:38] *** Quits: rusti_ (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[20:14:44] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[20:14:51] <kimundi> Ferio: It wouldn't do anything
[20:14:53] <strcat> Ferio: no, there are no implicit clones
[20:15:09] <kimundi> Ferio: What's important is whether _you_ clone te values first or not :)
[20:15:14] <strcat> and HashMap doesn't require a Clone bound or use managed pointers internally
[20:15:44] *** Joins: dsirenko (mitra@8E712A0.54C21BA0.9F317420.IP)
[20:16:36] <tikue_> on a note completely unrelated to the closure reform -- has anyone thought more about separating TcpStream into two structs, one for Reader and one for Writer?
[20:17:10] *** Joins: tdc (santegoeds@moz-ADD1F5DF.range86-135.btcentralplus.com)
[20:21:33] <sfackler> tikue_: it might make more sense to have a adapters that can create separate readers and writers holding references to the stream, though that means you couldn't send the reader and writer into different tasks
[20:21:48] <Ferio> kimundi, strcat: thanks maybe I should have tried it myself first. I tried to understand how the ownership works, but the compiler actually complains when I use a ~str after I inserted it, that makes totally sense…
[20:22:27] *** Quits: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk) (Ping timeout)
[20:22:43] <strcat> Ferio: assignment/passing/returning -> shallow copy (a ptr copy, for ~str), and if it has a destructor/&fn/&mut it steals ownership (makes source unusable)
[20:22:51] <strcat> that's the full set of rules, there's no other magic
[20:23:49] *** Quits: Ms2ger (Ms2ger@moz-2F2A356D.adsl-dyn.isp.belgacom.be) (Quit: nn)
[20:24:33] *** Joins: tjc (tjc@moz-7B0110AD.mv.mozilla.com)
[20:24:33] *** ChanServ sets mode: +o tjc
[20:24:52] <tikue_> sfackler, that'd still be better than nothing :)
[20:24:52] *** Quits: tdc (santegoeds@moz-ADD1F5DF.range86-135.btcentralplus.com) (Quit: Leaving)
[20:25:05] <sfackler> tikue_: something like struct ReferenceReader<'self, R: Reader> { reader: &'self R } impl<'self, R: Reader> Reader for ReferenceReader<'self, R> { ... }
[20:25:22] <sfackler> oh wait,
[20:25:49] <sfackler> you it'd actually need to be reader: &'self mut R and then you couldn't borrow it twice :(
[20:26:42] <sfackler> I guess it could use Mut internally, but then it starts getting into more sketchy territory
[20:27:39] <Ferio> strcat: hmm...this brings me back to my first question, what kind of pointer to use ^^ a HashMap<~str, ~str> might force you to .clone() while a HashMap<&~str, &~str> just works like in python or so…
[20:27:50] *** Joins: kvark (Mibbit@9A8A5739.49975FB2.AE2D72A6.IP)
[20:28:05] <strcat> Ferio: &~str is not very useful
[20:28:13] <strcat> all it gives you over &str is the ability to read the capacity
[20:28:51] <strcat> but really a map of references or slices is not going to be very useful because you're going to have to do it in a way that the compiler can see the hashmap is a temporary, outlived by all the strings
[20:28:51] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[20:28:54] <tikue_> what about HashMap<&'static str, &'static str>
[20:28:57] <strcat> and they'll need to be allocated *somewhere*
[20:29:40] <jason_> say i have `let a = ~[(int, int)]`, how do i borrow a mutable pointer from a that lives long enough to return from a function. i tried: let &(_, ref mut v) = &a[0]; v
[20:29:48] <kimundi> If you want a HashMap that has either ~str or &'static keys, then you can use SendStr
[20:29:50] <cmr> tjc: ping
[20:29:55] *** Quits: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de) (Quit: Verlassend)
[20:29:56] *** Joins: fabiand_ (fabiand@moz-B2CC7109.adsl.alicedsl.de)
[20:30:25] <cmr> jason_: `a` is internal to your function, and you want to return a reference to it?
[20:31:28] <kvark> An owner of "compileonline.com" fails to update Rust to 0.8, reported the following log: https://gist.github.com/kvark/6784611   Could someone take a look?
[20:31:52] <kvark> *The* owner
[20:32:01] <jason_> cmr: no sorry, its a member of my struct. i think i might have figured out my problem
[20:32:24] *** flaper87|afk is now known as flaper87
[20:32:56] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[20:34:29] <glyc>  kvark: looks like a python and not-using-sudo problem: File "/usr/local/lib/python2.7/tarfile.py", line 1665, in open raise ReadError("file could not be opened successfully")
[20:34:32] <Ferio> ok, maybe I still don't get something, how do I convert a ~str to a &str (mismatched types: expected `&str` but found `~str` )?
[20:34:48] <cmr> Ferio: s.as_slice()
[20:35:14] <kvark> glyc: so would our advice be to just using sudo?
[20:35:33] <tjc> cmr: pong
[20:36:18] <cmr> tjc: do you have some time to talk about rustpkg?
[20:36:24] <tjc> cmr: sure!
[20:36:46] <cmr> tjc: So what is https://github.com/mozilla/rust/wiki/Meeting-weekly-2013-10-01#submodules-in-rustpkg about?
[20:37:27] <tjc> cmr: it's about the case where you refer to something using `extern mod foo = "github.com/mozilla/whatever"`, but you want to have a local copy of whatever with uncommitted changes, and not have rustpkg prefer the version that it's able to fetch from github
[20:37:45] <glyc> kvark: install python using sudo. then try again.
[20:38:22] *** Quits: pksu (pksu@moz-2051CC54.fi) (Ping timeout)
[20:38:26] *** Joins: pksu (pksu@moz-2051CC54.fi)
[20:38:34] *** Quits: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:38:37] <cmr> tjc: And so putting the source into build/ rather than src/ is to prevent accidentally editing something rustpkg cloned for you?
[20:38:41] <jason_> cmr: nope, i didn't figure it out. basically i have a struct holding an array ~[(K,V]) and i need to return a mutable ref to V that has 'self lifetime. i think things like VecMutIterator do this, but they're doing some cast::transmute stuff
[20:39:00] <tjc> cmr: Yes. The discussion, then, was about how to let a cached version under build/ coexist with a locally-modified version under src/
[20:39:25] <kvark> glyc: thanks!
[20:39:44] <Ferio> cmr: why is it not implicitly converted in this case?
[20:40:28] *** Quits: aeqwa (aeqwa@moz-6809B4D2.dsl.tropolys.de) (Quit: Lost terminal)
[20:40:56] *** Joins: nielsle (nielsle@moz-5CE8ECCD.boa.fiberby.dk)
[20:41:07] <kimundi> Ferio: Because it sometimes can't tell if it should be converted, either due to inference bugs or ambiguity
[20:41:27] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[20:42:07] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[20:42:09] <jason_> cmr: adding unsafe { cast::transmute(v) } like VecMutIterator made the errors go away and my tests pass :\
[20:42:31] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[20:42:54] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:45:36] <cmr> tjc: Makes me a bit uncomfortable, though I can't quite pinpoint why.
[20:45:37] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[20:45:45] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[20:45:54] <cmr> tjc: Seems to introduce a ton of complexity.
[20:46:10] <tjc> cmr: Keep in mind that you can totally opt out of this behavior by only referring to local packages, and manually `git clone`ing them into your workspace
[20:46:24] *** Quits: SteveMcQwark (steven099@moz-7CFCF343.cpe.net.cable.rogers.com) (Connection reset by peer)
[20:46:31] <cmr> tjc: Is there anything wrong with marking cloned repos as readonly, and cloning repos yourself if you want them yourself?
[20:46:40] <tjc> Also, the motivation for the change is that Servo uses submodules and with the move to rustpkg, we want to get rid of submodules and make rustpkg track them
[20:46:53] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[20:46:56] <tjc> cmr: Not if you only have one submodule, but Servo has quite a few, and manually cloning them would be a bit of a pain
[20:46:59] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[20:47:06] <cmr> Yeah, that's true.
[20:47:08] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:47:15] <kimundi> jason_: Should be possible without transmute I think
[20:47:48] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[20:49:09] <cmr> tjc: Anyway, what I actually wanted to talk about is this emerging pattern where one makes their repo into a workspace. I feel like it's an antipattern, and afaict it's only used so you can use rustpkg to build your thing while you're developing it.
[20:49:31] <tjc> cmr: Yeah, I think that's my fault. In a very early version of the documentation, I think I suggested doing that
[20:49:44] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Ping timeout)
[20:49:45] <tjc> before I understood the requirements as well
[20:49:55] <tjc> do you have any suggestions for what to do to discourage it? better documentation?
[20:51:13] *** Parts: kvark (Mibbit@9A8A5739.49975FB2.AE2D72A6.IP) ()
[20:51:50] <myname> seems like i didn't get loop
[20:51:56] *** Joins: SteveMcQwark (steven099@moz-7CFCF343.cpe.net.cable.rogers.com)
[20:52:01] <myname> erm, while
[20:52:24] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:52:57] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[20:53:00] *** Quits: ahal (ahal@FCCEA34F.7672369.D8E68FF6.IP) (Ping timeout)
[20:53:12] <myname> i can't do stuff like: let mut x = 0i; let mut y = 0i; (x,y) = somefunc();?
[20:54:08] <bstrie> myname: nope :) there was a recent discussion on the mailing list about this
[20:54:28] <myname> i really hope this will get changed
[20:54:35] <bstrie> myname: destructuring assignment is a pattern, and patterns can only appear in certain places
[20:54:38] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[20:54:46] <bstrie> one of those places is right after `let`
[20:54:58] <myname> bstrie: i thought of using that
[20:54:59] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[20:55:17] <bstrie> myname: what are you trying to do that you can't do `let (x, y) = somefunc();` ?
[20:55:58] <myname> actually i was going to do stuff like: while program_runs { (x,y) = calcnewcords(x,y); }
[20:56:09] <sfackler> tjc: what's the correct way to structure a package? at one point recently, the rustdoc tutorial talked about an example project that had that structure (src/mycrate/lib.rs) but I can't seem to find that anymore
[20:56:23] <bstrie> myname: you can still do `let (x, y) = calcnewcoords(x, y);`
[20:56:28] <bstrie> myname: you're free to rebind names as you please
[20:56:42] <myname> bstrie: i can, but they die at the end of while
[20:56:44] <kimundi> bstrie: Can'T muatte existing ones with that though
[20:56:46] *** Quits: oleavr (oleavr@moz-1FB04F14.getinternet.no) (Quit: oleavr)
[20:56:52] <kimundi> mutate*
[20:57:04] <myname> i.e. the next iteration doesn't use the calculated x and y of the last one
[20:57:08] <bstrie> then just assign them to variables declared outside of the while :P
[20:57:09] <acrichto> tjc: is there a reason that 'rustpkg test' requires a test.rs and doesn't necessarily run the unit tests of the lib.rs file itself? It looks like it won't work if you're trying to test private functions across crates?
[20:57:11] <sfackler> tjc: here: http://static.rust-lang.org/doc/master/tutorial-rustpkg.html
[20:57:15] *** Joins: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com)
[20:57:23] <kimundi> bstrie: That's what he is trying to do :P
[20:57:42] <myname> indeed
[20:57:43] <bstrie> let mut x = 0; while true { let y = foo(); x = y; break; }
[20:57:46] <tjc> sfackler: I think the current version of that tutorial is right
[20:57:49] <tjc> about how to structure a workspace
[20:57:53] <tjc> Er
[20:57:56] <tjc> how to structure a package
[20:58:02] <myname> bstrie: yeah, it's quite dirty imo
[20:58:05] <sfackler> ok, cool
[20:58:07] <tjc> that is, that the package directory should be under $WORKSPACE/src and shouldn't be a workspace itself
[20:58:09] <cmr> tjc: Part of the problem is that you can't say `rustpkg build` and have it build whatever is in the current directory.
[20:58:09] <tjc> acrichto: hmm
[20:58:23] <tjc> cmr: you can't? that should work (and has a test)
[20:58:24] <tikue_> rusti, let s = ~"oops"; let s2: &'static str = s;
[20:58:27] <bstrie> myname: I think it's dirtier to allow patterns in arbitrary positions. you're opening a huge can of worms there.
[20:58:28] * cmr checks
[20:58:47] <kimundi> bstrie: much uglier than the hypothetical let (mut a, mut b) = (0, 0); loop { (a, b) = mutate_state(a, b); }
[20:58:48] <myname> i think of passing x and y by ref
[20:58:52] <tikue_> rusti: let s = ~"oops"; let s2: &'static str = s;
[20:58:53] -rusti- pastebinned 10 lines of output: http://sprunge.us/ALPd
[20:59:03] <bstrie> kimundi: that's pretty ugly :)
[20:59:16] <bstrie> just use temporaries and stop worrying about it, I say
[20:59:17] <tjc> acrichto: fwiw, that's in flux - see https://github.com/mozilla/rust/issues/9003
[20:59:18] <SiegeLord> Sounds like a job for a macro... I think it's tricky to write it though
[20:59:24] <bstrie> life is too short to obsess over edge cases
[20:59:24] <tjc> acrichto: I'm planning to bring that issue up at a future meeting
[20:59:24] <cmr> tjc: Yeah, it doesn't work.
[20:59:37] <acrichto> tjc: ah excellent I will read and comment appropriately
[20:59:50] <tjc> cmr: what directory are you in when you execute it?
[20:59:53] *** Parts: pnathan1 (Adium@B9840254.2CD8A5F8.477B877D.IP) ()
[20:59:54] <cmr> tjc: https://gist.github.com/anonymous/b3d53df155c2b011f5ea
[21:00:17] <tikue_> bstrie, i'm a strong -1 on that
[21:00:24] <tikue_> bstrie, on your suggestion to not worry about it
[21:00:27] <cmr> I also tried it with just `mkdir /tmp/foo; cd /tmp; touch main.rs; rustpkg build` (because it should work when you're not inside a workspace, IMO)
[21:00:28] <acrichto> tjc: ah it appears my concerns have already been rasied, carry on!
[21:00:31] <tikue_> nice syntax is very important
[21:00:32] * bstrie stops worrying about it
[21:00:39] <bstrie> tikue_: not if it muddies up the entire rest of the language
[21:00:46] <tikue_> bstrie, but that's a large assumption
[21:00:49] <bstrie> you have to choose your battles
[21:00:51] <tjc> cmr: the second case is #8520, but the first case should work. I'll try it locally
[21:01:00] <tikue_> bstrie, in the mailing list thread nmatsakis seemed to leave the door open to doing it at some point in the future
[21:01:05] <bstrie> language design is 99% choosing which users to piss off
[21:01:08] <cmr> rustpkg 0.9-pre (7ddcd2a 2013-09-30 15:06:23 -0700)
[21:01:14] <pcwalton> bstrie++
[21:01:21] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[21:01:24] <tikue_> bstrie, _no one_ would dislike having (a, b) = (b, a);
[21:01:30] <bstrie> and 1% name resolution
[21:01:41] <tikue_> it's a "nicety"
[21:01:57] <bstrie> tikue_: I'm not saying I wouldn't like it, I'm just proposing that demand for it is overblown
[21:02:00] <pcwalton> tikue_: well, it makes the grammar slightly more difficult to parse, but I think nmatsakis had a really good point
[21:02:09] <pcwalton> the cover grammar needed to parse it is pretty innocuous
[21:02:11] <kimundi> tikue_: Err, while I agree with wanting that syntax, I'd contest "no one" myself :P
[21:03:06] <SimonSapin> Is 'return' special in 'do' blocks? ie. does it return from the outer function or just the block?
[21:03:13] <bstrie> the only time you actually need it is when you're attempting to return values from a function that returns a tuple from within a while loop
[21:03:18] <pcwalton> SimonSapin: it doesn't work at all
[21:03:27] <tikue_> kimundi, i'm not sure i would. i definitely don't think it should be a priority at this point. but i doubt anyone would argue against it from a hypothetical theoretical stance
[21:03:37] <pcwalton> tikue_: no, people have
[21:03:38] <bstrie> and even then it only saves you two lines
[21:03:40] <pcwalton> because of the cover grammar issue
[21:03:44] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[21:03:50] <pcwalton> the necessity of a cover grammar is a wart
[21:03:53] <pcwalton> it's not a bad wart
[21:03:57] <pcwalton> IMHO
[21:04:00] <SimonSapin> pcwalton: sigh. I hate the with_foo pattern where you pass a closure.
[21:04:05] <pcwalton> SimonSapin: me too!
[21:04:13] <pcwalton> I am on a mission to nuke all with_whatevers
[21:04:15] <bstrie> but hey, if nmatsakis is right and it can be done without causing even *more* pain for casual users of the language, then go ahead
[21:04:19] <pcwalton> and replace with RAII
[21:04:19] <tikue_> pcwalton, what does "cover grammar" mean
[21:04:26] <bstrie> but I maintain that demand for this feature is exaggerated
[21:04:33] <SimonSapin> pcwalton: how do we do RAII in Rust?
[21:04:40] <pcwalton> implement the Drop trait on a struct of your choice
[21:04:43] <tikue_> bstrie, that's not what you were maintaining earlier :P because now we're not in disagreement
[21:04:47] <pcwalton> that function gets called whenever the thingy goes out of scope
[21:04:50] <engla> pcwalton: hi, I joined the channel in the middle of this, but I was wondering if you had any feedback on the Mut<T> RFC
[21:04:57] <pcwalton> engla: link?
[21:05:00] <engla> https://github.com/mozilla/rust/issues/9351
[21:05:09] <tikue_> pcwalton, how do you do RWArc without "with_barf"
[21:05:17] <engla> pcwalton: the PR is https://github.com/mozilla/rust/pull/9429
[21:05:22] <engla> sorry the PR link is the right one
[21:05:30] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[21:05:44] <pcwalton> tikue_: return a struct that wraps the borrowed pointer and unlocks the rwarc in the drop function
[21:06:03] <bstrie> tikue_: I maintain many positions! I spin these plates like a boss
[21:06:07] <tikue_> pcwalton, ...oh, awesome! yeah that's much nicer
[21:06:31] <bstrie> the biggest and most important position that I maintain is that strcat is always right, unless he's talking about the Times trait
[21:06:56] *** Quits: jensnockert (jensnocker@moz-C5F27039.cust.bredband2.com) (Input/output error)
[21:07:00] *** Quits: fabiand_ (fabiand@moz-B2CC7109.adsl.alicedsl.de) (Quit: Verlassend)
[21:07:06] *** Joins: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de)
[21:07:20] <tikue_> bstrie, re: "the only time you actually need it..." i would argue you _never_ need it. but it's elegant in many situations
[21:08:33] <bstrie> I agree that it would look nice in a tutorial
[21:08:49] <bstrie> just like python's nifty `(a, b) = (b, a)` swap implementation
[21:09:03] <bstrie> however, I've literally never had occasion to actually swap variables that way in python
[21:09:07] <bstrie> it's just a neat language trick
[21:09:26] <doomlord_> swapping variables = mutability ..
[21:09:26] *** Joins: vodik (simon@moz-29D35BB8.net.uwaterloo.ca)
[21:09:27] <tikue_> i wish &'static str weren't called that
[21:09:39] <tikue_> i feel like i never want ~str but it's better than writing &'static str all the time
[21:09:44] *** Joins: kvark (Mibbit@9A8A5739.49975FB2.AE2D72A6.IP)
[21:09:56] <kvark> rusti: let a = (~"",~""); let &(_x,_) = &a;
[21:09:57] -rusti- <anon>:7:33: 7:39 error: cannot move out of dereference of & pointer
[21:09:57] -rusti- <anon>:7          let a = (~"",~""); let &(_x,_) = &a;
[21:09:57] -rusti-                                           ^~~~~~
[21:09:58] -rusti- error: aborting due to previous error
[21:09:58] -rusti- application terminated with error code 101
[21:10:06] <kvark> what is wrong wit this? ^
[21:10:35] <tikue_> kvark, exactly what it says
[21:10:44] <kvark> I'm not trying to move anything
[21:10:46] *** Quits: pcwalton (pcwalton@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[21:10:48] <tikue_> kvark, you are
[21:10:49] <benh> &a is a borrowed pointer to a, the two ~str in the tuple would be moved
[21:10:49] <SimonSapin> rusti: let a = (~"",~""); let (_x,_) = a;
[21:10:50] -rusti- ()
[21:11:11] *** Joins: pcwalton (pcwalton@moz-BBE3ABD.mv.mozilla.com)
[21:11:11] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:11:14] <kvark> how do I just reference members of a tuple now, without moving?
[21:11:25] <tikue_> rusti: let a = ("", ""); let &(_x, _) = &a;
[21:11:27] -rusti- ()
[21:11:37] <tikue_> rusti: let a = ("", ""); let &(_x, _) = &a; x
[21:11:38] -rusti- <anon>:7:46: 7:47 error: unresolved name `x`. Did you mean `_x`?
[21:11:38] -rusti- <anon>:7          let a = ("", ""); let &(_x, _) = &a; x
[21:11:38] -rusti-                                                        ^
[21:11:38] -rusti- error: aborting due to previous error
[21:11:39] -rusti- application terminated with error code 101
[21:11:42] <tikue_> rusti: let a = ("", ""); let &(_x, _) = &a; _x
[21:11:43] -rusti- ""
[21:11:58] <kvark> let a = (~"", ""); let &(_x, _) = &a; _x
[21:12:01] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[21:12:02] <kvark> rusti: let a = (~"", ""); let &(_x, _) = &a; _x
[21:12:03] -rusti- <anon>:7:33: 7:40 error: cannot move out of dereference of & pointer
[21:12:03] -rusti- <anon>:7          let a = (~"", ""); let &(_x, _) = &a; _x
[21:12:03] -rusti-                                           ^~~~~~~
[21:12:03] -rusti- error: aborting due to previous error
[21:12:03] -rusti- application terminated with error code 101
[21:12:06] <benh> rusti: let a = (~"", ~""); let (ref a, ref b) = a; (a, b)
[21:12:07] -rusti- pastebinned 30 lines of output: http://sprunge.us/RijW
[21:12:10] <benh> oh no
[21:12:16] <tikue_> kvark, ~str has a destructor and thus moves
[21:12:27] <benh> rusti: let a = (~"", ~""); let &(ref a, ref b) = &a; (a, b)
[21:12:28] -rusti- pastebinned 28 lines of output: http://sprunge.us/GSSi
[21:12:30] <benh> i give up!
[21:12:51] *** Joins: fabiand_ (fabiand@moz-B2CC7109.adsl.alicedsl.de)
[21:12:57] <kimundi> let &(ref x, _) = &a; x // ?
[21:13:08] <kvark> rusti: let a = (~"", ""); let &(ref _x, _) = &a; _x
[21:13:09] -rusti- pastebinned 15 lines of output: http://sprunge.us/dOXT
[21:13:26] <tikue_> rusti, let a = (~"", ~""); let &(ref b, _) = &a; println!("{:?}", b);
[21:13:28] <kvark> doesn't quite work
[21:13:37] <tikue_> rusti: let a = (~"", ~""); let &(ref b, _) = &a; println!("{:?}", b);
[21:13:38] -rusti- pastebinned 12 lines of output: http://sprunge.us/TcEa
[21:14:38] *** Quits: rossm (rossm@moz-EE3BB1DC.br.br.cox.net) (Quit: )
[21:14:50] <kvark> so? nothing works then?
[21:14:50] <tikue_> rusti: let a = (~"", ~""); match &a { &(ref b, _) => println!("{:?}", b) }
[21:14:51] -rusti- &~""
[21:14:51] -rusti- ()
[21:15:08] <kvark> oh, you've got the match working
[21:15:16] <cmr> rusti: let a = (~"", ~""); let (ref b, ref c) = a;
[21:15:18] -rusti- pastebinned 7 lines of output: http://sprunge.us/jJRH
[21:15:25] <cmr> ^^^^^
[21:15:47] <tikue_> rusti should turn off warnings
[21:15:48] <kvark> cmr: interesting
[21:15:58] <kvark> cmr,tikue_: thanks guys
[21:16:04] <tikue_> kvark, yeah if you don't have a borrowed pointer to a tuple you don't need to do &t
[21:16:09] *** Joins: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net)
[21:17:34] <benh> Do we have labeled break etc yet?
[21:17:52] *** Quits: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net) (Ping timeout)
[21:18:08] <kvark> thought, it's still not obvious to me why "let &(x,y) = a" implies any kind of moving. To me it looks like getting a borrowed pointer to a tuple with pattern matching it to components
[21:18:09] *** Quits: fabiand_ (fabiand@moz-B2CC7109.adsl.alicedsl.de) (Quit: Verlassend)
[21:18:09] <cmr> benh: yes
[21:18:13] *** Joins: fabiand_ (fabiand@moz-B2CC7109.adsl.alicedsl.de)
[21:18:17] <tjc> benh: we've had it since.. maybe 0.4? Certainly since last year
[21:18:26] <cmr> kvark: & in patterns doesn't take a borrowed pointer, it *dereferences*
[21:18:31] <sfackler> something like "loop 'a { loop 'b { break 'a; }}
[21:18:33] <cmr> ie, you're destructuring the reference.
[21:18:38] <benh> oooh, i totally missed that
[21:18:42] *** Joins: rossm (rossm@moz-EE3BB1DC.br.br.cox.net)
[21:18:44] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[21:18:44] <cmr> kvark: `ref` in patterns takes a reference.
[21:19:19] <kvark> cmr: wait, isn't  '*' - a dereference operator?
[21:19:25] *** Quits: Jesin (Jessin_@moz-6EF909D6.cc.lehigh.edu) (Ping timeout)
[21:19:33] *** Quits: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de) (Quit: Verlassend)
[21:19:37] <SiegeLord> It's: 'label: loop { break 'label; }
[21:19:42] <cmr> kvark: it's not an operator in patterns, it's describing the structure it's destructuring.
[21:20:06] *** Joins: mark_edward (quassel@7C4F88E6.78B47078.37339E3A.IP)
[21:20:27] *** Joins: nejucomo (Adium@moz-B62B9944.public.monkeybrains.net)
[21:20:46] <kvark> cmr: in this case "let &a= <whatever>" doesn't make sence, right?
[21:20:50] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[21:20:53] <kvark> *sense
[21:21:10] <cmr> kvark: well it makes sense, it just implies a move.
[21:21:15] <tiffany> let &a = ...; means "move the value of ..., which is behind a borrowed pointer, into the item slot a"
[21:21:56] <kvark> tiffany: could you give me a working snippet?
[21:22:19] <tiffany> rusti: let foo = &(4,5); let &(a,b) = foo; a
[21:22:19] -rusti- <anon>:7:35: 7:36 warning: unused variable: `b` [-W unused-variable (default)]
[21:22:20] -rusti- <anon>:7          let foo = &(4,5); let &(a,b) = foo; a
[21:22:20] -rusti-                                             ^
[21:22:20] -rusti- 4
[21:22:41] <kvark> ohm interesting, thanks tiffany,cmr
[21:24:38] <benh> kimundi: ping?
[21:25:22] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:25:58] *** Quits: io2 (io2@moz-A6202C16.home.otenet.gr) (Input/output error)
[21:26:18] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:26:37] *** Quits: nejucomo (Adium@moz-B62B9944.public.monkeybrains.net) (Quit: Leaving.)
[21:27:10] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[21:27:30] <kimundi> benh: pong :P
[21:27:34] *** Joins: riley_ (riley@8BA43816.9AA11D69.65DDFA89.IP)
[21:28:15] <benh> hi! how far did you get with raw string literals?
[21:28:53] *** Quits: riley (riley@8BA43816.9AA11D69.65DDFA89.IP) (Ping timeout)
[21:29:40] <kimundi> benh: Well, if my brain didn't insist on wanting to sleep, I'd be probably be done by now. But as is, I'm hardly beyond the "detect opening delimiter" phase, so If you're further than that... :P
[21:29:57] * Eridius shakes his fist at benh and kimundi 
[21:30:06] <kimundi> haha
[21:30:06] <Eridius> stoopid path rewrite, keeping me from implementing raw string literals
[21:30:06] <benh> I think I'm about done, but I don't have tests or syntax highlighting fixes
[21:30:35] <bstrie> jack: I see you're signed up for the firefox costume on friday :P
[21:30:44] <kimundi> benh: He, just by remembering that those two need to be done your much further than I am in that regard xD
[21:31:05] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[21:31:39] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[21:32:26] <engla> since you can't move from a &T, I think   let &a = .. would always be an implicit copy (if possible)
[21:32:31] <engla> otherwise an error
[21:32:54] <benh> kimundi: I'm as far as http://ix.io/8iL and currently trying to figure out where the best place to put tests and how to invoke them is ;)
[21:33:04] <jdsanders> is it possible to do variable length argument lists without a macro?
[21:33:31] *** flaper87 is now known as flaper87|afk
[21:33:32] <pauls> jdsanders: Not at the moment. I don't know whether that feature is planned.
[21:33:32] <bstrie> jdsanders: only if you're willing to stick all the arguments in an array or something
[21:33:59] * tikue_ wants to learn how to use conditions
[21:34:23] *** Quits: vodik (simon@moz-29D35BB8.net.uwaterloo.ca) (Quit: WeeChat 0.4.2-rc2)
[21:34:35] <jdsanders> pauls, bstrie: thanks, i have no problem with arrays :)
[21:34:44] *** Parts: kvark (Mibbit@9A8A5739.49975FB2.AE2D72A6.IP) ()
[21:34:56] <acrichto> tikue_: http://static.rust-lang.org/doc/master/tutorial-conditions.html may help :)
[21:35:42] *** Joins: dew (Instantbir@moz-EEE6B2F8.dhcp.stls.mo.charter.com)
[21:35:55] <tikue_> acrichto, yeah I've read through it before, but now I'm going to try to actually use them :O)
[21:36:08] <tikue_> the thing that is a bit strange to me is the scoping of them
[21:36:17] <kimundi> benh: I'd just add a few run-pass tests that show that they work
[21:36:35] <tikue_> like, I want a condition associated with a connect() function, but the condition isn't scoped to the impl in which connect resides
[21:36:46] <kimundi> benh: Real, just one that tests all commom scenarios should be enough
[21:37:27] <benh> I wasn't sure whether to use run-pass tests or a #[test] in libsyntax/parse/lexer.rs
[21:37:36] <benh> or multiple #[test]s I suppose
[21:38:18] <kimundi> benh: I guess raw string literals as language feature belong more into an run pass test than into a test in libsyntax
[21:38:54] <Eridius> kimundi: yeah
[21:39:20] <Eridius> kimundi: should have a compile-fail test for unbalanced delimiters too
[21:39:25] <Eridius> both too few and too many of the end delim
[21:39:31] <kimundi> right, and unterminated
[21:39:41] *** Quits: heftig (heftig@moz-67C1D84E.dip0.t-ipconnect.de) (Ping timeout)
[21:39:42] <kimundi> etc
[21:39:52] *** Quits: jaen (jaen@moz-E0979827.copit.pl) (Ping timeout)
[21:40:24] <tikue_> acrichto, do conditions _have_ to be functions? what if i want the equivalent of "throw / catch" where it just propogates in one direction
[21:40:57] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[21:41:11] <acrichto> tikue_: a condition handler always returns execution back to the point of where it was rasied, so it's not at all like throw/catch in that sense, execution must still percolate back up to the "catch" block from the "throw" block normally
[21:41:21] *** Quits: sw17ch (sw17ch@moz-39D8564F.wndsny.tds.net) (Quit: sw17ch)
[21:41:56] <Eridius> tikue_: you can't have throw / catch because that can break the safety of code that it passes through.
[21:42:10] <Eridius> just look at how hard it is to write C++ code that has the strong exception safety guarantee
[21:42:14] <jason_> kimundi: (just got back from lunch) i'll link you my code once i push it, maybe you can show me the non-transmute way
[21:42:41] <kimundi> jason_: Sure, if I'm still awake then :)
[21:45:15] *** Joins: sw17ch (sw17ch@moz-39D8564F.wndsny.tds.net)
[21:45:39] <kimundi> benh: I think keeping both the short #[test] in lexer.rs for smoke testing the tokenizer itself, and a more complete suite of run-pass and compile-fail tests for the actual syntax would be the best move
[21:45:48] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[21:46:10] <tikue_> acrichto, i know, i'm simply going to `return;` afterward
[21:46:16] <tikue_> Eridius, ^
[21:46:17] <benh> kimundi: I agree, yeah
[21:46:21] <kimundi> Anyway, wiping my attempt at raw string literals now ;)
[21:46:38] <benh> hey if you want you can take over
[21:46:43] <tikue_> I suppose that can't be guaranteed though, so it makes sense
[21:46:50] <benh> you called it first in the issue discussion, I'll yield~
[21:47:04] <tikue_> acrichto, do you know if TcpStream::connect() has conditions associated with it? There isn't anything in the docs so I assume no?
[21:47:12] *** Quits: fabiand_ (fabiand@moz-B2CC7109.adsl.alicedsl.de) (Quit: Verlassend)
[21:47:23] *** Joins: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de)
[21:47:30] <acrichto> tikue_: I think it may raise on the generic io_error condition in the rt::io module, but I could be wrong
[21:47:42] *** Quits: Ferio (Mibbit@moz-23CDE542.fullrate.dk) (Quit: http://www.mibbit.com ajax IRC Client)
[21:48:14] <kimundi> benh: Nah, no point if I'm tired and your almost done :P
[21:48:16] <jdsanders> what is the safest way to cast from int to uint? `some_int as uint` doesn't seem very safe...
[21:48:39] <benh> ok. I'm thinking I might need to make it more complicated for the pretty printer
[21:48:56] <tikue_> acrichto, ah ok. and that can be used by me as well right? say i want to have a connect(addr: &'static str) function. If the addr is malformed I can also do io_error::cond.raise() ?
[21:48:56] <cmr> jdsanders: what seems unsafe about it?
[21:49:18] <kimundi> benh: Hm, right. This way, it would just pretty print it formated
[21:49:24] <cmr> int and uint will always be the same width, afaik.
[21:49:24] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[21:49:31] *** Joins: heftig (heftig@moz-17396EBB.dip0.t-ipconnect.de)
[21:49:36] <jdsanders> well, maybe a better way to ask my question is: what happens if i do `some_int as uint` and `some_int` is negative
[21:49:42] <acrichto> tikue_: you certainly can
[21:49:48] <cmr> rusti: -5i as uint
[21:49:49] -rusti- 18446744073709551611u
[21:49:53] <jdsanders> it will take the bit representation of the int and make it whatever that representation means as a uint right?
[21:49:55] *** Joins: Jesin (Jessin_@moz-828D006F.cc.lehigh.edu)
[21:49:58] <kimundi> benh: Maybe just add a field to the string token indicating that it is a raw string literal with N hashes?
[21:50:03] <cmr> jdsanders: yes. int is two's complement
[21:50:12] <benh> there's ast::int_ty for 42i, 42i32, 42i8 etc
[21:50:15] <jdsanders> right, is there a method that gives me an Option<uint>?
[21:50:18] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[21:50:29] *** Quits: fabiand (fabiand@moz-B2CC7109.adsl.alicedsl.de) (Quit: Verlassend)
[21:50:32] <benh> so I suppose I can add enum str_ty { normal, raw(int) } 
[21:50:32] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[21:51:03] <benh> Or make a different token type, since there's also different int literals for suffixed/unsuffixed
[21:51:10] <kimundi> something like that, I guess
[21:51:34] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[21:51:40] *** Joins: nejucomo (Adium@moz-B62B9944.public.monkeybrains.net)
[21:52:02] <skade> (europapark) Rust, btw, is a popular funfair in germany. googling "rust conditions" gives me a nice weather report with links to buy tickets. :(
[21:53:12] <benh> yeah, I kept pushing to have the first official rust meetup in Rust, but those darn americans wouldn't budge
[21:53:51] <doomlord_> we'd need a european meetup aswell surely
[21:53:52] <strcat> bstrie: so are you saying you want me to make a blog? ;p
[21:54:14] <Yoric> doomlord_: You're welcome in Paris.
[21:54:36] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[21:54:38] <skade> mozilla soon has a beautiful new office in berlin….
[21:55:19] <kimundi> benh: I think odifying the existing string token/ast node is better, because this way you catch all locations where it is being used
[21:55:28] <kimundi> modifying*
[21:55:46] <benh> I think a separate token but the same ast node is okay
[21:55:59] <kimundi> If you add a new one for raw strings, you'l have to pray that there is no _ => catch all somewhere ignoring it...
[21:56:03] <benh> though maybe I misunderstand the distinction, hm
[21:56:07] <benh> hmm
[21:56:56] <kimundi> for reference: There is already token::BINOPS(binops) :P
[21:57:04] <tikue_> rusti: "foo".to_owned()
[21:57:05] -rusti- ~"foo"
[21:57:46] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[21:58:48] <benh> But there's also like five different numeric tokens
[21:59:06] <cmr> Eugh
[21:59:15] <cmr> Raw strings are going to wreak havoc with printing strings.
[21:59:48] *** Joins: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net)
[21:59:48] *** ChanServ sets mode: +ao dherman dherman
[21:59:49] <kimundi> benh: I guess we need to ask someone from the devs whether there is a system behind that or not :P Might just be random cruft from before enums or so
[22:00:39] <cmr> dbaupp: So I figured out why the builds were failing, and it wasn't because I ran out of disk space.
[22:00:43] <kimundi> cmr: How so?
[22:00:56] <cmr> dbaupp: I ran out of disk space *because* they failed, and it wasn't cleaning up failed builds (for good reason!)
[22:01:09] <cmr> dbaupp: there was an unused variable that clang is dying on in rustrt :\
[22:02:11] <cmr> kimundi: they're going to print out ugly when using {:?}
[22:02:11] <erickt_> jdsanders: I've got a PR to add `.to_int() -> Option<int>` methods: https://github.com/mozilla/rust/pull/9250
[22:02:32] <erickt_> jdsanders: currently fighting some 32bit build errors at the moment
[22:02:35] *** Quits: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca) (Quit: canhtak)
[22:03:06] <jdsanders> erickt_: oh? neat! I actually added one just in my file, but it conflicted with .to_uint from num::NumCast, so I was just going to rename it
[22:03:23] <jdsanders> I'll have to see what you're doing
[22:03:27] <kimundi> cmr: You mean it would escape them as regular strings literals? Don'T think that's anything we can change
[22:03:36] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[22:03:58] <kimundi> cmr: We can make the pretty printer print them right thogh
[22:04:01] <cmr> kimundi: right
[22:05:18] <erickt_> jdsanders: I'm hoping to finish and land my PR tonight
[22:06:24] <erickt_> jdsanders: it's doing simple range checking. At some point it may also grow the ability to do clamping or truncation
[22:06:41] <sw17ch> erickt_: what happens when the Option<int> is None?
[22:07:35] *** Quits: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP) (Ping timeout)
[22:07:53] <erickt_> sw17ch: it'll be none if you do (-5).to_uint(), or (1234).to_i8()
[22:08:05] <erickt_> and etc
[22:08:17] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[22:08:19] *** Quits: CarpNet (Alasdair@moz-EF831A5E.cable.virginmedia.com) (Quit: Leaving)
[22:08:28] <sw17ch> erickt_: oops, i've read it backward.
[22:08:37] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[22:08:38] <jdsanders> erickt_: looks good! Am I reading it correctly that it will first convert to a u64 and then back to a uint?
[22:09:07] <benh> rusti: match Some(42) { Some(1|2|3|42) => 0, _ => 1 }
[22:09:07] -rusti- <anon>:7:32: 7:33 error: expected `,` but found `|`
[22:09:07] -rusti- <anon>:7          match Some(42) { Some(1|2|3|42) => 0, _ => 1 }
[22:09:07] -rusti-                                          ^
[22:09:07] -rusti- application terminated with error code 101
[22:09:14] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[22:09:19] <sw17ch> Thanks for clearing that up, erickt_.
[22:09:41] <erickt_> np
[22:10:18] <tikue_> acrichto, i'm trying to trap a condition and propogate it as a Result type. this doesn't seem to be what the conditions are intended for...no?
[22:10:27] <erickt_> benh: can you file a feature request for that? I've been meaning to do that, but I keep forgetting about it
[22:10:46] <benh> will do
[22:11:06] <erickt_> thanks!
[22:12:02] <acrichto> tikue_: in my mind conditions are mostly used for things where you may want to take some sort of action at the site of the error, but passing through what exactly that action is would be a real pain
[22:12:31] <acrichto> tikue_: so if you raise a condition, you'll almost always return Option or Result still because you still have to return, but sometimes you may be able to take some action based on the event that just happened
[22:13:21] <acrichto> erickt had a good example of CString where if you gave it a buffer with a NULL in it it would ask you "what should I do with this?" and you could request that it gets reset to a particular character or that the string gets completely terminated
[22:13:32] <tikue_> acrichto, i basically want to have a structure that stores a ~[TcpStream]. When it connects to a new one, it should return the new TcpStream as Result(TcpStream)
[22:13:45] <tikue_> acrichto, but to do this I need to handle the connect condition so that it doesn't fail my program
[22:13:59] <acrichto> tikue_: it could also return Option<TcpStream> because the "error condition" was already notified via the condition
[22:14:01] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[22:14:23] <tikue_> acrichto, but then the caller of this method will need to handle the condition
[22:14:40] <acrichto> condition::raise will fail if there are no handlers registered
[22:15:00] <tikue_> right, so i need to register a handler right?
[22:15:08] <acrichto> basically
[22:15:17] <acrichto> it's kinda one thing which never sat quite well with me about conditions
[22:15:37] <strcat> if you're going to return an Option, why bother with a condition?
[22:15:42] *** Joins: canhtak (jeremy@moz-414CC428.wl.t.ulaval.ca)
[22:15:45] <tikue_> strcat, because it's built into connect
[22:15:49] <tikue_> strcat, so it needs to be handled
[22:15:56] <tikue_> (TcpStream::connect)
[22:16:15] <strcat> I think we should use andrei's RAII-style error reporting in general
[22:16:15] <acrichto> in theory conditions provide you a method to instruct what to do in an error-prone situation, but in reality I don't think that they're used that way that much
[22:16:37] <strcat> http://channel9.msdn.com/Shows/Going+Deep/C-and-Beyond-2012-Andrei-Alexandrescu-Systematic-Error-Handling-in-C worth watching
[22:16:48] * acrichto bookmarks
[22:16:50] <strcat> basically, Result<Type, ErrorEnum> with a destructor failing if you don't handle it
[22:17:02] <strcat> and rvalues need to be destroyed right away if ignored (don't know if we do)
[22:17:21] <strcat> or just ErrorEnum with a destructor, for something like write()
[22:17:34] <tikue_> basically there's no good way to handle connect()'s condition i guess
[22:17:35] <tikue_> lol
[22:17:36] <strcat> write(foo, buf); // if an error happens, it fails due to the destructor
[22:17:51] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[22:18:17] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[22:18:45] <erickt_> strcat: have you read up on how lisp uses conditions? I vaguely remember there are some really neat things you can do with it from http://www.gigamonkeys.com/book/
[22:18:47] <engla> There is raise_default for conditions acrichto, doesn't that allow conditions to be used without failing?
[22:19:01] <strcat> erickt_: yeah, they are neat when you want to recover from an error inside the function
[22:19:08] <strcat> but I really hate them when they're not used that way
[22:19:09] <erickt_> strcat: ooh neat, the chapter is online http://www.gigamonkeys.com/book/beyond-exception-handling-conditions-and-restarts.html
[22:19:23] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[22:19:32] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[22:19:35] <strcat> but then again, you could always just add a parameter taking an error handling method and have a convenience version without it
[22:19:46] <strcat> conditions are just that via TLS
[22:19:50] <erickt_> strcat: oh agreed. I think our best use of them at the moment is in .to_c_str where we can handle substituting interior \0s
[22:20:02] <nsf> I find it somewhat amusing that 40 years after C appearance we're still arguing about best ways of handling errors
[22:20:13] <nsf> not that I know the answer to this organizational problem
[22:20:30] <erickt_> handling errors and naming things are probably the hardest things in software engineering :)
[22:20:37] <aatch> nsf, eh, failure handling is hard everywhere
[22:20:44] <nsf> erickt_: yes indeed
[22:20:46] <aatch> Not just software.
[22:20:56] <SimonSapin> naming as well
[22:21:25] <SimonSapin> naming as well
[22:21:32] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[22:21:38] <SimonSapin> (oops, sorry for the double)
[22:22:07] *** Joins: pepper_chico (pepper_chi@moz-9A2FC724.dsl.telesp.net.br)
[22:23:22] <SimonSapin> @T::clone is basically incref, right?
[22:23:31] <cmr> SimonSapin: yes
[22:23:55] <acrichto> engla: there is raise_default, but I don't think that anyone uses it
[22:24:16] <SimonSapin> Hi cmr. Did you want to look at fixing extra::url?
[22:24:30] <SimonSapin> one thing that’s missing is resolving relative URLs
[22:24:46] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[22:24:48] *** Quits: pepper_chico (pepper_chi@moz-9A2FC724.dsl.telesp.net.br) (Quit: Ex-Chat)
[22:24:56] <cmr> SimonSapin: I have my progress at github.com/cmr/url but gave up because it was easier for me to just do my own url handling.
[22:25:01] *** Joins: pepper_chico (pepper_chi@moz-9A2FC724.dsl.telesp.net.br)
[22:25:39] <SimonSapin> I see
[22:25:55] *** Quits: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP) (Quit: lmandel)
[22:27:55] *** flaper87|afk is now known as flaper87
[22:28:18] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[22:29:24] <doomlord_> heh . errors suck. fundemental problem with the universe :)
[22:30:29] <tikue_> this is basically the best i could come up with:
[22:30:38] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[22:30:52] <tikue_> https://gist.github.com/tikue/23962cbc1f0cab5a56e5
[22:30:54] <jason_> cmr: i don't think url spec requires percent encode to be utf-8, they're just byte values
[22:31:09] <tikue_> i couldn't find anyway to actually extract useful information to send in Err
[22:31:48] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[22:32:40] <myname> how to note if a function expects a fixed-size vector? just [T]? or [T, ..len]?
[22:32:49] <tikue_> myname, the latter
[22:33:06] <nejucomo> I saw bits of the closure discussion go by a couple of hours ago, but didn't have bandwidth to understand it.  Can someone point me to "gotcha" code that demonstrates how enclosing-clauses help?
[22:33:09] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[22:33:18] <erickt_> myname: or you could write `&[T]` which lets you work with any vector
[22:33:31] <tikue_> nejucomo, it'd allow you to specify if you want to capture by value or by ref
[22:33:36] <cmr> jason_: it does.
[22:33:53] <erickt_> myname: if you are not storing the fixed size vector in a structure
[22:34:28] <jason_> cmr: really? my memory must be warped by years of dealing with real world urls which use what ever encoding they feel like.
[22:34:48] <nejucomo> tikue_: I understand its purpose, I just don't understand why current rust has a wart.  I was hoping for like a blog post or something that says: "see this code which seems obvious, it doesn't compile."
[22:34:54] <cmr> jason_: http://url.spec.whatwg.org/#percent-encoded-byte
[22:35:02] <cmr> "Sequences of percent-encoded bytes, after conversion to bytes, should not cause utf-8 decode to run into any errors. "
[22:35:30] *** Quits: tjc (tjc@moz-7B0110AD.mv.mozilla.com) (Ping timeout)
[22:35:31] <nejucomo> Someone mentioned a "simple ping-pong blog post".
[22:35:34] * nejucomo searches...
[22:39:15] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[22:39:15] *** ChanServ sets mode: +o tjc
[22:39:20] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[22:39:24] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[22:40:12] *** Quits: alk (alk@moz-32A9FF6A.fbxo.proxad.net) (Ping timeout)
[22:40:20] <benh> "check-stage2-T-x86_64-unknown-linux-gnu-H-x86_64-unknown-linux-gnu-rpass"
[22:40:26] <pcwalton> nejucomo: it was a series of tweets
[22:40:28] <benh> really wish I could remember the more compact invocations :(
[22:40:31] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[22:41:21] <nejucomo> pcwalton: Ugh…
[22:41:36] <nejucomo> So much for a coherent linkable technical conversation...
[22:41:43] <pcwalton> strcat: was reading backscroll
[22:41:47] <Luqman> benh: check-stage2-rpass ?
[22:41:55] <pcwalton> so yes, in the meeting I brought up your proposal for merging traits and fns
[22:42:05] <pcwalton> and the general consensus as I recall was that it was desirable but we probably won't have time for rust 1.0
[22:42:08] <pcwalton> however it's backwards compatible
[22:42:14] <pcwalton> so that can be a major focus of version 2
[22:42:58] <pcwalton> closures for v1 will basically be good enough to allow HoFs like map() and spawn to work
[22:43:45] <pcwalton> there was also consensus on changing extern "Rust" fn(A)->B to just fn(A)->B and today's &fn(A)->B becomes |A|->B
[22:44:05] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[22:44:35] <erickt_> pcwalton: what about ~fn(A)->B?
[22:44:52] <pcwalton> that becomes proc(A)->B unless someone can think of a better name
[22:45:04] <pcwalton> actually proc(A)->B is the equivalent of ~once fn(A)->B
[22:45:09] <pcwalton> so you will finally be able to move out of upvars
[22:45:14] <sfackler> woo!
[22:45:30] <pcwalton> because (a) 'extern "Rust" fn' is ugly and the 'extern' there makes no sense; (b) |A|->B is shorter; (c) |A|->B matches the declaration form; (d) it encourages you to use 'extern "Rust" fn' where it makes sense to do so
[22:45:35] <pcwalton> which I think strcat will like :)
[22:45:41] <erickt_> heh. Back in felix we also had fns and procs, although our procs weren't allowed to have return values
[22:45:44] <jdsanders> is 
[22:45:59] *** Quits: KindOne (KindOne@moz-590C0860.dynamic.ip.windstream.net) (Ping timeout)
[22:46:03] <pcwalton> I don't love the name "proc" but I can't think of anything better
[22:46:07] <pcwalton> I seriously considered "goroutine"
[22:46:20] <pcwalton> but that would mean something different from Go
[22:46:34] <pcwalton> it means a task-about-to-be-spawned basically
[22:46:42] *** Joins: rbarker (rbarker@moz-BBE3ABD.mv.mozilla.com)
[22:46:46] <pcwalton> an entry point
[22:46:49] <erickt_> pcwalton: hah. Will |A|->B still be able to coerce to a proc(A)->B?
[22:46:50] <cmr> I really don't like the name proc, but I also can't think of anything better
[22:47:17] <tikue_> what _is_ a proc? 
[22:47:18] <pcwalton> erickt_: you mean the lambda syntax? no, there will be a separate syntax for procs, something lightweight
[22:47:24] <pcwalton> tikue_: ~once fn()
[22:47:28] <pcwalton> just a renaming
[22:47:50] <pcwalton> let x = proc(foo) { println!("Hi, %s", foo); }
[22:47:52] <erickt_> isn't ~fn(A)->B pretty much exclusive to the task system? If so, what about spawn(A)->B? or task(A)->B?
[22:47:54] <pcwalton> perhaps
[22:48:08] <pcwalton> yeah, I considered "task" too but it's not a task, it's a task-to-be
[22:48:11] <pcwalton> a proto-task
[22:48:22] <tikue_> pcwalton, proc(foo) looks like it doesn't capture
[22:48:28] <erickt_> coroutine(A)->B?
[22:48:30] <pcwalton> tikue_: we haven't decided on capture clauses yet
[22:48:39] <pcwalton> erickt_: yeah, considered that too, it's a long keyword though
[22:48:42] <erickt_> quite wordy though
[22:48:49] <erickt_> co(A)->B?
[22:48:55] <pcwalton> coro
[22:49:05] <tikue_> tin?
[22:49:06] <pcwalton> dunno
[22:49:16] <tikue_> how about `timmy`
[22:49:22] <tikue_> do spawn timmy(foo) { ... }
[22:49:24] <tikue_> i like it
[22:49:25] <erickt_> I can't help but giggle at coro. I feel like I need a scooby snack after saying it
[22:49:32] <pcwalton> they call them goros in Go land
[22:49:42] <acrichto> gurus vs rurus
[22:49:43] *** Quits: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP) (Ping timeout)
[22:49:53] *** Quits: mark_edward (quassel@7C4F88E6.78B47078.37339E3A.IP) (Ping timeout)
[22:49:54] <pcwalton> roroutine
[22:49:55] <tikue_> what about rt
[22:49:57] <tikue_> for routine
[22:49:57] *** Joins: KindOne (KindOne@moz-590C0860.dynamic.ip.windstream.net)
[22:50:00] <cmr> Where the heck does tin/timmy come from?
[22:50:01] <aatch> ruh roh!
[22:50:11] <aatch> cmr, corouTINe
[22:50:12] <tikue_> cmr, routine --> tine --> tin
[22:50:14] <cmr> oh
[22:50:22] <aatch> tin -> timmy (I guess)
[22:50:24] <acrichto> rustine
[22:50:29] <tikue_> acrichto++
[22:50:35] <tikue_> rustlet
[22:50:51] <cmr> Is this assuming the only time they'll be useful is spawning a task?
[22:50:52] <tikue_> i think tn would be good
[22:50:57] <engla> using a name connected to tasks sounds like a good idea
[22:51:00] <aatch> there are other cases.
[22:51:09] <doomlord_> feroutine
[22:51:26] <tikue_> i like rt or rtn
[22:51:29] <tikue_> for routine
[22:51:31] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[22:51:44] *** Joins: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net)
[22:51:47] *** Joins: lerc (quassel@B2E8CAD3.A8D14E52.788638A4.IP)
[22:51:51] <aatch> Especially when wanting to pass a closure back up the stack.
[22:51:54] <doomlord_> rtn was return at one point wasn't it 
[22:51:59] <cmr> doomlord_: ret
[22:52:02] <aatch> doomlord_, nah, that was ret
[22:52:06] <doomlord_> ok
[22:52:17] <aatch> rtn is a little cryptic lol.
[22:52:23] <dbaupp> cmr: ah, ok; how'd an unused variable slip through?
[22:52:25] <tikue_> aatch, people know what fn is
[22:52:28] <tikue_> "rt" isn't so bad
[22:52:35] <cmr> dbaupp: no idea. gcc probably just didn't care.
[22:52:43] <jason_> github down?
[22:52:48] <dbaupp> cmr: probably
[22:53:01] <aatch> tikue_, I meant that using rtn -> return would be cryptic.
[22:53:09] *** Quits: clusterfoo (computer@moz-A81F9872.cable.teksavvy.com) (Client exited)
[22:53:12] <cmr> dbaupp: also a problem with gyp assuming python is python2 :|
[22:53:19] <tikue_> ooh yea
[22:53:27] <dbaupp> cmr: I thought acrichto fixed that one by using CFG_PYTHON?
[22:53:37] <cmr> dbaupp: these are older commits
[22:53:44] <dbaupp> cmr: aaah
[22:53:50] * dbaupp forgets these things
[22:54:27] <erickt_> hrm. would a proc(A)->B be a proper coroutine? Or could we just implement a couroutine with them?
[22:54:27] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[22:54:51] <doomlord_> having procs and fns would make me nostalgic. bbc basic :)
[22:54:52] <erickt_> tfn(A)->B? for task function?
[22:55:04] <nejucomo> I am still unclear on the difference between these closure types...
[22:55:10] <doomlord_> even if the meanings are completely different
[22:55:18] <aatch> nejucomo, well fortunately there are only two now
[22:55:24] <aatch> ~fn and &fn
[22:55:27] <cmr> erickt_: to me coroutine has communication and scheduling implications, which proc definitely doesn't carry.
[22:55:32] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[22:55:41] <cmr> But to me procedure and function are entirely synonymous
[22:55:45] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[22:55:53] <cmr> And routine is entirely meaningless
[22:56:00] <cmr> But I can't come up with anything better than proc
[22:56:11] <aatch> &fn is a stack closure and by it's nature can safely capture upvars by reference.
[22:56:20] *** Quits: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net) (Client exited)
[22:56:25] <nejucomo> aatch: I don't understand the difference between those.  It seems to me the sigils represent more than just the pointer type to the closure rt representation: they also represent something about the enclosed scope semantics...
[22:56:33] * nejucomo rereads the closures section of the tutorial.
[22:56:53] <kimundi> Oh!
[22:56:56] <aatch> ~fn is a heap closure. As the `~` suggests, it is owned, but that means that all captured variables have to be moved into it.
[22:57:05] *** ozten is now known as ozten|errand
[22:57:06] <kimundi> Hpw about send_fn(...) :P
[22:57:20] <cmr> kimundi: not as short, but I'd be OK with it.
[22:57:20] <nejucomo> Could a borrowed pointer to a closure enclose bindings of any kind, so long as they outlive the borrowed pointer?
[22:57:49] <nejucomo> aatch: Now that I understand.
[22:58:02] <aatch> nejucomo, well a stack closure has a lifetime that lasts for the scope it was created in.
[22:58:14] *** Quits: jdm (jdm@7F255D02.1B9223B5.AE2B2F80.IP) (Quit: Lost terminal)
[22:58:25] <kimundi> let f = sndfn(a, b) { ... };
[22:58:30] <aatch> since it can't be passed up the stack, there is no way it can outlive anything it captures.
[22:58:46] <kimundi> let f = sendfn(a, b) { ... };
[22:59:11] <erickt_> I'm sad that it sounds like we won't be able to write a `&once fn(A)->B`. That'd be useful for Option/Result methods
[22:59:45] <erickt_> although it's really not that hard to manually destructure things
[23:00:21] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[23:00:34] <erickt_> pcwalton: another thing I've been meaning to bring up is that we'll probably need a way to annotate a generator function
[23:00:52] <erickt_> if/when we grow support for them
[23:00:53] <nejucomo> aatch: Actually, let's back up on ~fn, I don't understand it anymore.  To me it seems like only captured-and-unique freevars need to be moved, not freevars in Clone:  let x = 4; do spawn { print(x) }
[23:01:23] *** Quits: reyre (reyre@moz-89E9865B.com) (Ping timeout)
[23:01:29] <aatch> nejucomo, well implicitly copyable types can be captured, but only if they are immutable
[23:01:40] <aatch> since they are actually copied into the closure.
[23:01:40] <nejucomo> Oh wait…  does "move" mean: "copy, then if there is a destructor, mark the source as unusable statically" ?
[23:01:57] <cmr> dbaupp: whoa, multibuilder is spawning like 30 threads :|
[23:01:57] <kimundi> nejucomo: yes
[23:02:12] <cmr> 32 of them
[23:02:34] <nejucomo> Ok.  I was thinking of "move" as a special case of "copy", but it sound like here it is the general case.
[23:02:45] <aatch> nejucomo, it is, copy is the special case.
[23:03:16] <nejucomo> aatch: hehe…  That may be the convention, but the choice seems arbitrary to me
[23:03:32] <aatch> nejucomo, Rust defaults to move semantics though.
[23:03:37] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[23:03:44] <aatch> So in generic code everything is assumed to move.
[23:04:07] <tikue_> what does impl<T, A: Acceptor<T>> Acceptor<T> for Option<A> {} mean? does it mean that if you have Some(TcpAcceptor) you can just call accept on it? what happens if it's none?
[23:04:12] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[23:04:24] *** Quits: eholk (eholk@moz-BA312F07.crest.iu.edu) (Quit: eholk)
[23:04:34] *** Quits: dew (Instantbir@moz-EEE6B2F8.dhcp.stls.mo.charter.com) (Ping timeout)
[23:04:37] <cmr> tikue_: it either fails or throws a condition iirc
[23:04:42] *** Joins: reyre (reyre@moz-89E9865B.com)
[23:04:42] *** Joins: dew (Instantbir@moz-EEE6B2F8.dhcp.stls.mo.charter.com)
[23:04:42] <aatch> tikue_, I don't what happens on None, but otherwise, yes.
[23:04:56] <tikue_> ooo, that's nice. is that a recent addition or am I only just noticing it?
[23:04:56] <cmr> tikue_: it's so you can ignore errors in your code and still have it do sane things.
[23:05:06] <cmr> only you just now, afaik
[23:05:06] <tikue_> cmr, yeah it's a great convenience
[23:05:07] <dbaupp> cmr: what do you have 'num_local_builders' set to?
[23:05:11] <cmr> dbaupp: 6
[23:05:20] <cmr> Ah so that makes a bit more sense
[23:06:18] <dbaupp> cmr: are all 32 threads using the CPU, or only 6?
[23:06:31] <cmr> dbaupp: none are
[23:06:40] <myname> how the hell does rustc decide what match blocks are non-exhaustive and what not?
[23:07:12] <myname> i have match (x%2,y%2) with (1,1), (0,0), (0,1) and (1,0)
[23:07:23] <myname> but obviously, it's non-exhaustive
[23:07:30] <cmr> myname: yeah, it's not that smart
[23:07:45] <dbaupp> cmr: oh right, the "worker" threads are just sitting around lazily waiting for external processes
[23:07:56] <tjc> myname: it assumes that all literal patterns (or sets of them) are non-exhaustive; it only knows about enums being exhaustive
[23:08:04] <tjc> since with an enum you know you have a finite number of cases
[23:08:10] <aatch> myname, based on type
[23:08:15] <tjc> (same for product types (tuples and structs) -- since there's only 1 alternative)
[23:08:40] <aatch> we'd need dependent types to handle your case.
[23:09:01] *** Quits: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net) (Ping timeout)
[23:09:14] <tjc> anybody who is interested should feel free to implement a Rust-like language with dependent types added on top
[23:09:19] <tjc> and then they can get a Ph.D for it :-)
[23:09:28] *** Joins: ryeguy (ryeguy@9C569A0.5D1143CD.E8644521.IP)
[23:10:19] <aatch> tjc, I am actually interested. Though I'm also considering dropping some other rust features, so it probably stops it being PhD-worthy.
[23:10:51] *** Joins: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net)
[23:10:53] <tjc> aatch: I think you could drop some stuff. A language like Rust that was still useful for practical systems programming, and had some form of dependent types (even a limited form), would be an accomplishment
[23:10:58] *** Joins: mark_edward (quassel@51C589B3.EF2694B5.DFAC6AA7.IP)
[23:12:10] <aatch> tjc, I have no idea how feasible it is. I just think a cool implication is that you can have a type defined as a subset of an enum.
[23:12:27] <strcat> pcwalton: http://lists.cs.uiuc.edu/pipermail/llvm-commits/Week-of-Mon-20130923/188747.html real escape analysis
[23:12:33] <strcat> not sure if it's going anywhere
[23:12:41] <pcwalton> anl.gov
[23:12:43] <pcwalton> interesting
[23:12:56] <pcwalton> argonne national lab!
[23:12:59] <tjc> aatch: That would be a fairly simple form of refinement types, and much easier to implement than the kind of type system you would need for myname's example :-)
[23:13:27] <aatch> tjc, oh yeah, I know that. I think the hardest bit is probably the inference for dependent types.
[23:13:36] <aatch> especially with static checking.
[23:13:58] <tjc> aatch: Yeah, I think once you're in dependent-type-land, you really don't want a lot of inference
[23:14:09] <tjc> because inference amounts to asking the computer, "Computer! What theorem do I want to prove with this proof?"
[23:14:14] <tjc> and why would the computer know? :-)
[23:14:28] <myname> does rust still throw something if you have a match on any enum that is exhaustive AND have _ in it?
[23:14:37] <aatch> myname, yes
[23:14:42] <myname> :(
[23:14:50] <aatch> It complains that a pattern is unreachable.
[23:15:10] <myname> IMHO it shouldn't if that pattern is _
[23:15:18] <aatch> myname, why not?
[23:15:39] <nejucomo> Yeah, that doesn't seem "safe" to me.
[23:15:44] *** kimundi is now known as zz_kimundi
[23:15:45] <myname> i like to add _ anywhere in enum matches because maybe they get expanded some time and i'll have sane defaults by then
[23:15:56] <tjc> myname: that's a bad idea -- it leads to bugs
[23:16:07] <tjc> when you (or someone else) adds a new variant, but you actually want to be handling it differently
[23:16:08] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:16:09] <tjc> and not in the _ case
[23:16:27] <pcwalton> strcat: if we could vectorize sums that might help servo layout
[23:16:30] <pcwalton> layout is mostly sums
[23:16:35] <pcwalton> of lots of disparate things
[23:16:51] *** Quits: sw17ch (sw17ch@moz-39D8564F.wndsny.tds.net) (Quit: sw17ch)
[23:17:12] <tikue_> what was fprintf! replaced with?
[23:17:16] *** Joins: eatkinson (eatkinson@moz-392601D4.lightspeed.sntcca.sbcglobal.net)
[23:17:35] <strcat> pcwalton: ah I looked into it
[23:17:50] <aatch> From the compilers point of view you're essentially saying "Hey, in this impossible case, do this" You might as well write `if 1 == 2 { MAGIC() }`
[23:17:58] <strcat> it can vectorize a floating point sum, but only if you mark the operations saying you don't care about floating point compliance
[23:18:23] <pcwalton> bah
[23:18:27] <pcwalton> are integer sums vectorizable?
[23:18:38] <pcwalton> I mean with standard SIMD instruction sets
[23:18:43] <strcat> not sure
[23:18:52] <pcwalton> guess_width() is 1/3 of layout time
[23:18:55] <nejucomo> Here's an example usage of "copy vs move" that seems backwards from this irc channel just a moment ago: "Owned closures, written ~fn […], hold on to things that can safely be sent between processes. They copy the values they close over…"
[23:18:57] <pcwalton> and guess_width() is         width + margin_left + margin_right + padding_left + padding_right + 
[23:18:57] <pcwalton>             self.model.border.left + self.model.border.right
[23:19:10] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[23:19:18] <nejucomo> -but using the convention discussed above, this should say the "move" the values they close over, right?
[23:19:23] <strcat> pcwalton: in a loop? or just like that
[23:19:28] <pcwalton> like that
[23:19:31] <strcat> pcwalton: I think SLP vectorize could maybe do it
[23:19:34] <pcwalton> ultimately it's in a loop
[23:19:37] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[23:19:39] <aatch> nejucomo, probably.
[23:19:40] <pcwalton> but a recursive complex one
[23:19:47] <strcat> we enable SLP vectorize at --opt-level=3 now
[23:19:51] <strcat> let me play with it a sec
[23:20:09] <aatch> nejucomo, the docs aren't always up-to-date.
[23:20:22] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[23:20:22] *** Joins: ofeldt- (ofeldt@moz-AF6C4EDF.dip0.t-ipconnect.de)
[23:20:58] <nejucomo> I kind of want a new word that is neither "move" nor "copy" to prevent the semantic back-and-forth confusion.
[23:21:04] <nejucomo> "mopy" ?  ;-)
[23:21:25] <aatch> nejucomo, it's mostly confusing because it has changed over time.
[23:21:29] *** Quits: ofeldt (ofeldt@moz-C2965E0E.dip0.t-ipconnect.de) (Ping timeout)
[23:22:00] <aatch> at one point rust had a specific operator to force a move.
[23:22:03] <aatch> otherwise it was a copy.
[23:22:15] <aatch> (<-)
[23:22:29] <strcat> pcwalton: yeah, it vectorizes integer sums
[23:22:37] <doomlord_> interesting
[23:22:42] <nejucomo> If || {} syntax appears in an argument position, does the compiler infer whether or not it is a stack or owned closure?  Does this inference ever cause surprises?
[23:22:57] <aatch> nejucomo, it infers.
[23:22:58] <cmr> nejucomo: it can only be one type, and that's the type the function specifies.
[23:23:00] <pcwalton> nejucomo: yes, and there is consensus to remove that inference
[23:23:06] <aatch> Otherwise it defaults to &fn
[23:23:06] <strcat> pcwalton: it just doesn't like the code fold generates
[23:23:07] <pcwalton> more or less anyway
[23:23:21] <nejucomo> aatch: Yeah, last time I looked at rust there were move operators and argument passing modes, and I was horribly confused.
[23:23:28] <tikue_> anyone know what the fprintf! macro is? 
[23:23:30] <strcat> pcwalton: http://ix.io/8iT vectorizes this
[23:23:37] <aatch> nejucomo, well it's mostly gone now.
[23:23:47] <aatch> tikue_, isn't is writef!?
[23:23:49] *** Joins: victorporof_ (victorporo@16E89FDD.B0D0881A.79933D60.IP)
[23:24:00] <strcat> pcwalton: http://ix.io/8iV with AVX on :)
[23:24:06] <tikue_> aatch, ah ok ill try that
[23:24:06] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[23:24:07] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[23:24:23] <tikue_> aatch, ah no i don't think it is
[23:24:23] <strcat> with sse it does the <4 * i32>
[23:24:38] <strcat> going to look into why it doesn't like fold
[23:24:42] <tikue_> aatch, i think it's write! and writeln!
[23:24:58] <aatch> tikue_, that seems reasonable.
[23:25:02] *** Quits: victorporof (victorporo@16E89FDD.B0D0881A.79933D60.IP) (Ping timeout)
[23:25:17] <strcat> evil null checks :(
[23:25:21] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:26:23] <myname> are there some kind of "constructors" for strucs?
[23:26:40] <myname> i.e. the moment i create one, a method will be called?
[23:26:43] <cmr> myname: no
[23:26:45] <nejucomo> pcwalton: On removing closure inference: Is that what the "proc" naming discussion was about?  Adding a keyword to explicitly avoid inference?
[23:26:46] <aatch> myname, no
[23:26:49] <pcwalton> yes
[23:27:19] <strcat> pcwalton: it's soooo picky, http://ix.io/8iW
[23:27:23] <strcat> vectorizes sum but not sum2
[23:27:24] <strcat> :\
[23:27:40] <pcwalton> weird
[23:27:42] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[23:28:36] <strcat> sum2 has a null check in a place it doesn't like afaict
[23:28:54] <strcat> it throws off the pattern of the loop so it doesn't identify it as an iterator
[23:29:01] *** Quits: Ferreus_ (ferreus@moz-19B48F1C.dyn.telefonica.de) (Ping timeout)
[23:29:03] <strcat> it has to look exactly like what C++ iterators do
[23:29:14] *** Joins: Ferreus_ (ferreus@moz-19B48F1C.dyn.telefonica.de)
[23:29:21] <strcat> stupid pointer induction thing ;p
[23:29:28] <aatch> strcat, I'm thinking that LLVM could do with some improvement there.
[23:29:39] <aatch> Sounds like it's a little too specific.
[23:29:41] *** Quits: luisbg (luisbg@moz-E7587DBE.collabora.co.uk) (Ping timeout)
[23:29:42] * pcwalton sighs at optimizations overtailored to clang
[23:31:52] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:31:53] *** Quits: sglez (sglez@E19C1D7A.4B605195.A208C5.IP) (Ping timeout)
[23:31:55] *** flaper87 is now known as flaper87|afk
[23:33:11] <strcat> aatch: well I think rustc could be doing something better
[23:33:15] *** jorendorff is now known as jorendorff_away
[23:33:33] <aatch> strcat, probably.
[23:34:35] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[23:35:43] *** Quits: eatkinson (eatkinson@moz-392601D4.lightspeed.sntcca.sbcglobal.net) (Quit: eatkinson)
[23:36:00] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:36:05] *** Joins: luisbg (luisbg@moz-E7587DBE.collabora.co.uk)
[23:36:22] *** Quits: noam (noam@F6B530A7.720527A7.416762B.IP) (Connection reset by peer)
[23:37:25] <jeaye> Can I get a &mut [char] to a str that isn't a copy?
[23:37:25] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[23:37:34] <strcat> jeaye: no
[23:37:38] <strcat> it doesn't store char
[23:38:42] <jeaye> I'm wrapping a function that takes (char *str, size_t n) and emplaces n chars into the string. What'd be a good way to wrap this in Rust?
[23:38:55] <jeaye> I'm trying to keep the same param ordering, etc.
[23:39:05] <strcat> rust's char isn't C's char
[23:39:11] <jeaye> I know this.
[23:39:30] <strcat> jeaye: does the function always output valid UTF-8?
[23:40:14] *** Joins: eatkinson (eatkinson@moz-392601D4.lightspeed.sntcca.sbcglobal.net)
[23:40:15] <jeaye> No idea (the docs don't guarantee that!)
[23:40:28] <strcat> use ~[u8] then
[23:40:41] <strcat> vec::with_capacity(n), then use vec::raw::to_ptr
[23:40:48] <strcat> and pass it that pointer with the length
[23:40:56] <strcat> and then vec::raw::set_len to the proper length
[23:41:06] *** Quits: eatkinson (eatkinson@moz-392601D4.lightspeed.sntcca.sbcglobal.net) (Quit: eatkinson)
[23:42:11] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:42:29] <jeaye> hmm
[23:42:55] *** Quits: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net) (Ping timeout)
[23:43:09] *** Joins: ChrisMorgan (chris@moz-2BBDB47F.its.monash.edu.au)
[23:45:04] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[23:45:11] *** ozten|errand is now known as ozten
[23:45:25] *** Quits: spott_ (spott@moz-5158CBDE.colorado.edu) (Client exited)
[23:45:58] *** Joins: sglez (sglez@4014B9B9.FB17712F.B7838CA6.IP)
[23:46:26] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[23:46:31] *** Quits: Jesin (Jessin_@moz-828D006F.cc.lehigh.edu) (Quit: Leaving)
[23:46:38] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Quit: Ex-Chat)
[23:47:02] *** Quits: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net) (Quit: dherman)
[23:48:50] *** Joins: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net)
[23:48:50] *** ChanServ sets mode: +ao dherman dherman
[23:49:42] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[23:49:45] <pcwalton> strcat: can you try summing up 6 values like that?
[23:49:58] <pcwalton> and see if the SLP vectorization kicks in
[23:50:37] <strcat> pcwalton: doesn't :(
[23:50:55] <pcwalton> what if you loop from 0..6?
[23:51:06] <pcwalton> try it in c++ if you have to
[23:51:51] <erickt_> jeaye: you could use c_str for that
[23:51:55] <strcat> pcwalton: no, it just unrolls it
[23:52:04] <strcat> I think it assumes the cost isn't worth it
[23:52:13] <strcat> because it makes the code so much bigger
[23:52:13] <jeaye> erickt_: Assuming the str is large enough, aye?
[23:52:14] *** Quits: threecreepio (jdp@moz-9C11F46E.cust.bredbandsbolaget.se) (Quit: threecreepio)
[23:52:21] <jeaye> erickt_: str using i8 internally?
[23:52:28] <jeaye> uses*
[23:52:30] <tikue_> is there a way to get a SocketAddr from a url?
[23:52:34] <strcat> pcwalton: it will even unroll a loop over 32 though, no vectorization :s
[23:52:43] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[23:53:46] *** Quits: lkuper (lkuper@moz-C4C820C6.dhcp-bl.indiana.edu) (Quit: lkuper)
[23:53:48] <dbaupp> jeaye: u8
[23:53:54] <erickt_> jeaye: actually c_str may not be great for that as it's currently written. Using vec.as_imm_buf may be better
[23:54:01] <strcat> pcwalton: switches from full unroll to vectorize at 38 u32
[23:54:07] <dbaupp> jeaye: actually, that might be a lie; I'm not sure
[23:54:10] <strcat> and then unrolls more inside the vectorized loop as it gets longer
[23:54:14] <strcat> maybe can adjust the costs somehow
[23:54:19] <strcat> for a function
[23:54:25] <jeaye> Right, but I'd ideally just take in a string and not bother with vec at all.
[23:54:36] <strcat> pcwalton: if it could see it was in a loop, it would probably do it
[23:54:37] <erickt_> jeaye: c_str uses whatever libc::c_char is on your platform
[23:54:39] <pcwalton> strcat: ah, ok.
[23:54:47] <pcwalton> yeah, I was suspect that 6 values would profitably benefit from vectorization anyway.
[23:54:53] <jeaye> erickt_: And it's not a copy?
[23:55:02] <jeaye> It's like std::string::c_str
[23:56:20] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:56:32] <erickt_> jeaye: right now c_str is designed to go from a str or vec to a char* safely. It doesn't really have a way to directly malloc a c string at the moment
[23:57:04] <erickt_> jeaye: do you care if the char* is null terminated?
[23:57:42] <erickt_> jeaye: if not, you could use str.as_imm_buf
[23:57:49] <jeaye> It needn't be.
[23:58:15] <erickt_> err, str.as_mut_buf
[23:58:20] <strcat> pcwalton: I think SLP will only kick in when there are a ridiculous number of scalar ops
[23:58:30] <strcat> maybe SipHash, for example
[23:58:38] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[23:58:47] <pcwalton> yeah, I figured 6 was too low of a number
[23:58:49] <erickt_> jeaye: that fn doesn't validate that the string is still UTF8 though
[23:58:58] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[23:59:28] *** Quits: a__ (a__@moz-4CC03B10.nycmny.fios.verizon.net) (Client exited)
