[00:00:03] <acrichto> ChrisMorgan: thanks!
[00:00:08] <ChrisMorgan> Windows kernel timers can be quite nasty to work with.
[00:01:48] <ChrisMorgan> There's that matter of how many ticks per second the kernel gets; it could easily influence this. You could try increasing that number and see what results you get. Can't remember how it's done and can't immediately find a particular article I have in mind on the topic.
[00:02:51] <ChrisMorgan> But I have found https://code.google.com/p/chromium/issues/detail?id=153139 which was related to that issue, and it links to http://msdn.microsoft.com/en-us/windows/hardware/gg463266.aspx which has a lot more information about timers and such.
[00:03:09] <ChrisMorgan> acrichto: that MSDN article could well be useful to you.
[00:03:33] <acrichto> oh wow that looks intense
[00:03:47] <acrichto> I may go for the "at least something works" quality for now...
[00:06:27] <ChrisMorgan> acrichto: a dozen pages seems surprisingly compact to me for what it covers.
[00:08:18] * ChrisMorgan wishes they'd do things like that in HTML rather than in DOCX format
[00:16:47] *** Quits: johnrkd (johnrkd@3A09C2F6.815752B7.B05A4819.IP) (Quit: )
[00:27:42] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[00:33:28] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[00:33:28] *** ChanServ sets mode: +qo brson brson
[00:34:02] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: Leaving.)
[01:02:20] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[01:02:20] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/A4KW1A
[01:02:20] <ghrust> 13rust/06auto 140607c13 15Steven Fackler: Stop using @ExtCtxt
[01:02:20] <ghrust> 13rust/06auto 14711d510 15Steven Fackler: Remove unecessary extern "Rust" specifiers
[01:02:20] <ghrust> 13rust/06auto 14933def4 15Steven Fackler: Stop passing duplicate parameters in expand
[01:02:22] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[01:02:23] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[01:02:23] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1410782df to 14aa5d779: 02http://git.io/N3iJvQ
[01:02:23] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[01:10:54] *** Quits: canhtak (canhtak@moz-59105D0.wl.t.ulaval.ca) (Quit: canhtak)
[01:13:24] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[01:14:15] <Luqman> :( somethings timing out on the tests for the linux-32-nopt-t bot
[01:14:39] *** Quits: Kroisse (Kroisse@7CF4064D.E3B51CAE.ECA1BB11.IP) (Ping timeout)
[01:14:55] *** Joins: Kroisse (Kroisse@7CF4064D.E3B51CAE.ECA1BB11.IP)
[01:15:03] *** Quits: klutzy (th@BA61F396.8E859986.ECA1BB11.IP) (Ping timeout)
[01:15:07] *** Joins: klutzy (th@BA61F396.8E859986.ECA1BB11.IP)
[01:17:00] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[01:17:00] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14eaec4a5 to 14aa5d779: 02http://git.io/N3iJvQ
[01:17:00] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[01:17:02] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[01:17:02] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/bxusMw
[01:17:02] <ghrust> 13rust/06auto 145580b4c 15Alex Crichton: Register new snapshots.
[01:17:02] <ghrust> 13rust/06auto 14d48713a 15bors: auto merge of #11169 : alexcrichton/rust/snapshots, r=sanxiyn...
[01:17:03] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[01:18:55] <sfackler> acrichto: the windows buildbot is borked on LLVM again: http://buildbot.rust-lang.org/builders/auto-win-32-nopt-c/builds/2348/steps/compile/logs/stdio
[01:21:05] <ChrisMorgan> Luqman: great! more evidence for https://github.com/mozilla/rust/issues/11200 :-)
[01:23:01] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[01:23:01] *** ChanServ sets mode: +qo brson brson
[01:24:15] <sfackler> retry anyone? windows bot broke at llvm https://github.com/mozilla/rust/pull/11168
[01:24:48] <cmr> did the llvm upgrade land?
[01:25:07] <klutzy> not yet
[01:25:51] <klutzy> maybe the buildbot tried to upgrade llvm and failed, then now tried to downgrade llvm and failed :p
[01:26:10] *** Quits: benh (ben@moz-4A0366D2.org) (Ping timeout)
[01:26:27] <sfackler> apparently the windows bot fails once every time it tries to build llvm
[01:27:27] <acrichto> last time I tried to track it down it looked like there was still a process that had its current directory inside one of the child dirs that hadn't exited
[01:27:37] <acrichto> b/c it was dying on removing a directory saying that the permission was denied
[01:27:52] <acrichto> never figured out what process was sitting in the directory or if that was even true at all
[01:28:03] <cmr> so... how long does a reboot of the builders take? :p
[01:28:16] <klutzy> llvm failure is annoying; I guess we can just ignore it but I'm not totally sure
[01:28:29] <acrichto> we go through this every time we update llvm
[01:28:36] <acrichto> it affects the upgrade and all tests afterwards
[01:28:39] <acrichto> it's a real pain :\
[01:29:31] *** Joins: benh (ben@moz-4A0366D2.org)
[01:35:35] <acrichto> ChrisMorgan: Luqman: https://github.com/mozilla/rust/pull/11204
[01:36:02] <ChrisMorgan> acrichto: great! :-)
[01:49:38] *** Quits: gwty (gwtypc@90BFEAA9.8A45D967.F44414AF.IP) (Ping timeout)
[01:58:46] *** kimundi is now known as zz_kimundi
[02:37:10] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[02:37:21] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[02:37:23] *** vfetwnuncszu is now known as dcrewi
[02:37:56] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Max SendQ exceeded)
[02:38:06] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[02:39:30] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[02:46:59] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[02:46:59] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/E8fjFA
[02:46:59] <ghrust> 13rust/06auto 14b27c53b 15Alex Crichton: Fix a deadlock in a libgreen test...
[02:46:59] <ghrust> 13rust/06auto 14b5b570b 15bors: auto merge of #11204 : alexcrichton/rust/issue-11200, r=cmr...
[02:46:59] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[02:47:03] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[02:47:03] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14d48713a to 14aa5d779: 02http://git.io/N3iJvQ
[02:47:03] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[02:47:50] <cmr> I think ghrust might have himself a case of the race conditions.
[02:48:06] <brson> acrichto: i can't log into the buildbot interface. did the auth change?
[02:48:34] <brson> oh wait. i'm logged in
[02:48:38] <brson> not sure what i was seeing
[02:49:10] <acrichto> brson: yeah I've seen that recently too
[02:49:20] <acrichto> I think it just goes haywire a little bit
[03:09:46] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[03:09:49] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[03:10:04] *** vfetwnuncszu is now known as dcrewi
[03:25:03] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[03:39:26] *** Joins: dbaupp (Thunderbir@moz-EB2EFE6F.lns20.syd6.internode.on.net)
[03:42:30] *** Quits: zz_kimundi (kimundi@moz-DB1AF90B.dip0.t-ipconnect.de) (Ping timeout)
[03:45:53] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[03:46:23] *** Joins: zz_kimundi (kimundi@moz-6166D3C8.dip0.t-ipconnect.de)
[03:46:25] *** zz_kimundi is now known as kimundi
[04:02:13] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[04:02:13] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/E8fjFA
[04:02:13] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[04:06:59] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[04:06:59] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/0Vh8ng
[04:06:59] <ghrust> 13rust/06auto 144bbf57a 15Luqman Aden: Update llvm.
[04:06:59] <ghrust> 13rust/06auto 142eaf1df 15bors: auto merge of #11181 : luqmana/rust/up-llvm, r=alexcrichton...
[04:06:59] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[04:10:58] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[04:10:58] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 146354a2e to 14739dbab: 02http://git.io/k471pw
[04:10:58] <ghrust> 13rust/06try 14739dbab 15Alex Crichton: Convert some C functions to rust functions...
[04:10:58] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[04:13:24] <brson> acrichto: that sounds neat. which C fns are you killing now?
[04:13:35] <acrichto> brson: precise_time_ns and get_time
[04:13:51] <acrichto> trying to get an LTO executable on linux to as few dependencies as possible
[04:14:31] <acrichto> success!
[04:14:36] <acrichto> librt eliminated
[04:15:02] <cmr> wait
[04:15:08] <cmr> what are you using if not librt?
[04:15:25] <acrichto> librt just provides timing stuff for what we use it for
[04:15:27] <cmr> Ohhh
[04:15:32] <cmr> It gets eliminated with LTO
[04:15:33] <acrichto> clock_gettime
[04:15:34] <cmr> right
[04:15:34] <acrichto> yeah
[04:15:49] <cmr> yeah Iknow what it's for, I was wondering how you got rid of it :p
[04:15:53] <acrichto> I think we may even be able to remove it from libstd/rtdeps.rs
[04:15:58] <acrichto> not gonna try that just yet though
[04:16:06] <acrichto> I *think* it's only used by libextra
[04:18:14] <cmr> looks like it also provides timers.
[04:21:05] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[04:21:06] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14739dbab to 147b16480: 02http://git.io/k471pw
[04:21:06] <ghrust> 13rust/06try 147b16480 15Alex Crichton: Convert some C functions to rust functions...
[04:21:06] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[04:21:11] <acrichto> ah it needs to stay as a libstd dep
[04:21:18] <acrichto> b/c std::libc is providing the functions
[04:21:56] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:21:56] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 142eaf1df to 14b5b570b: 02http://git.io/N3iJvQ
[04:21:57] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:22:51] <acrichto> so we also depend on libm for all executables
[04:22:52] <brson> acrichto: should std::libc be?
[04:22:55] <acrichto> which is going to be tough to remove
[04:23:05] <acrichto> brson: ?
[04:23:16] <brson> do these functions need to be defined in std::libc?
[04:23:40] <brson> std::libc is going to be a problem generally for bare metal use cases so we need to find ways to minimize our exposure to it
[04:23:42] <acrichto> not really, I just figured I'd throw everything together b/c I was defining things like 'struct timespec' and 'struct timeval'
[04:23:46] <brson> and it's also got a bunch of random windows stuff
[04:23:55] <acrichto> std::libc is a huge dumping ground
[04:24:10] <acrichto> I can move the functions around
[04:24:16] <acrichto> I'll leave the struct definitions in there though
[04:24:38] <brson> are they part of the c spec?
[04:24:39] <acrichto> and *then* we can remove the librt dep from libstd
[04:24:44] <acrichto> dunno
[04:24:49] <acrichto> I just kinda throw things in there :(
[04:24:59] <brson> if they are not then imo we can definitely remove them
[04:25:14] <acrichto> I was using them in my native::io::timer bindings
[04:25:18] <acrichto> timespec/timeval
[04:25:35] <acrichto> I don't think type definitions are harming us much in std::libc
[04:25:41] <acrichto> it's the function definitions I'd think need to get moved out
[04:26:14] <acrichto> brson: oh I had a question for you, so we're going to need these worker threads for timers/signals, but I'm not sure if we can cleanly shut them down
[04:26:33] <acrichto> it's a libnative implementation detail, but if the runtime was booted from libgreen, then how do you know to shut down the libnative threads?
[04:27:14] <acrichto> just kinda food for thought, I haven't figured anything out yet other than "just leak them"
[04:27:21] <brson> acrichto: global at_exit handlers called by rt::cleanup?
[04:27:28] <acrichto> seems icky
[04:27:34] <acrichto> that was my second solution
[04:28:13] <brson> acrichto: how much work is this timer and signal code going to be? is it worth it to not use libuv in the worker thread?
[04:28:43] <acrichto> brson: https://github.com/alexcrichton/rust/commit/673d103b2080bb37622b6c9c20bb0947f2e61d78
[04:28:53] <acrichto> that's an implementation for all of our platforms
[04:29:01] <brson> lol ok
[04:29:10] <acrichto> (well, as a size guage)
[04:29:25] <brson> damn you are productive
[04:29:26] <acrichto> using libuv for signal handling would make everything so much easier
[04:29:39] <acrichto> seems weird for libnative to depend on libuv though
[04:29:43] <acrichto> it'd be a static dep, but still..
[04:30:12] <acrichto> timers ended up not being too bad
[04:30:17] <acrichto> select() + a timeout is terrible
[04:30:25] <acrichto> and windows is apparently pretty sloppy about wakeups
[04:30:29] <acrichto> but the same model worked well for all of them
[04:36:57] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[04:36:57] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14a77f80f to 14b5b570b: 02http://git.io/N3iJvQ
[04:36:57] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[04:36:57] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[04:36:57] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/Me0-fw
[04:36:57] <ghrust> 13rust/06auto 140607c13 15Steven Fackler: Stop using @ExtCtxt
[04:36:57] <ghrust> 13rust/06auto 14711d510 15Steven Fackler: Remove unecessary extern "Rust" specifiers
[04:36:58] <ghrust> 13rust/06auto 14933def4 15Steven Fackler: Stop passing duplicate parameters in expand
[04:37:00] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[04:39:30] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[04:39:30] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 147b16480 to 14420a652: 02http://git.io/k471pw
[04:39:30] <ghrust> 13rust/06try 14420a652 15Alex Crichton: Convert some C functions to rust functions...
[04:39:30] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[04:42:12] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:42:30] <sfackler> acrichto: do you know much about librustc::metadata/know who does?
[04:43:02] <acrichto> sfackler: I know *of* it and I've added/removed a number of things, dunno who'd be the most familiar with it
[04:43:14] <acrichto> what're you wondering?
[04:43:51] <sfackler> I'm trying to figure out how to typecheck the macro registration function for the external macros PR
[04:44:23] <sfackler> but I can't figure out how the compiler takes "extern mod foo; let x = foo::bar()" and figures out the signature of foo::bar
[04:45:01] <acrichto> the interface is all in metadata::csearch
[04:45:12] <acrichto> perhaps csearch::get_type?
[04:45:27] <acrichto> a crate would have to know its own metadata though I think
[04:50:20] <sfackler> it looks like I might be able to use each_top_level_item_of_crate to find the DefId and then use get_type, but the infrastructure looks pretty wrapped up in the current workflow of running straight through a compile vs loading a random crate's metadata and poking around
[04:52:21] <acrichto> yeah loading an arbitrary point in the metadata starting from nothing is not the easiest
[04:52:37] <acrichto> but you're right in that I would start at the top and then iterate down to find your own DefId
[04:52:44] <acrichto> and make sure that the function links to your DefId
[04:53:05] <acrichto> but this also requires making metadata available at runtime
[04:53:29] <acrichto> which is very possible for dylibs
[04:53:33] <acrichto> not so possible for rlibs
[04:53:45] <acrichto> rustc is almost always dynamic except for snapshots
[04:54:09] <sfackler> that's fine, since this is dynamically loading (i.e. dlopen) the crate anyways
[04:54:48] <acrichto> but you don'tneed just the target crate's metadata
[04:54:54] <acrichto> you need libsyntax's current metadata
[04:55:07] <acrichto> as in the metadata for the current library that you're running under
[04:55:32] <sfackler> oh, yeah
[04:55:38] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[04:55:38] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 14420a652 to 1461d0dda: 02http://git.io/k471pw
[04:55:38] <ghrust> 13rust/06try 1461d0dda 15Alex Crichton: Convert some C functions to rust functions...
[04:55:38] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[04:56:11] <acrichto> the metadata is just a symbol
[04:56:21] <acrichto> or rather the compressed metadata is just a symbol in a dylib
[04:58:20] <Luqman> acrichto: #[cfg(stage0, lolwut)]  ? :P
[04:58:58] <acrichto> :D
[04:59:02] <acrichto> I just needed it to go away :(
[05:01:22] <sfackler> ideally you'd be able to define an API like DynamicLibrary's "fn symbol<T>(&self, name: &str) -> Result<T, Err>" and use something like TyDesc to be able to get the type info for T when symbol is monomorphized
[05:01:59] <acrichto> makes sense
[05:02:07] <acrichto> hmm... I wonder if you could actually do that
[05:02:23] <acrichto> b/c monomorphization would generate the tydesc of T
[05:10:55] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[05:12:18] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[05:12:28] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[05:12:31] *** vfetwnuncszu is now known as dcrewi
[05:24:14] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[05:24:14] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 1461d0dda to 146054df6: 02http://git.io/k471pw
[05:24:14] <ghrust> 13rust/06try 146054df6 15Alex Crichton: Convert some C functions to rust functions...
[05:24:14] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[05:29:01] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Quit: leaving)
[05:40:51] <dbaupp> acrichto: ping
[05:43:26] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: Leaving.)
[05:51:58] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[05:51:58] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146ca75d0 to 14b5b570b: 02http://git.io/N3iJvQ
[05:51:58] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[05:51:59] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[05:51:59] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ro9_0g
[05:51:59] <ghrust> 13rust/06auto 14d9eaeda 15Luqman Aden: Update llvm.
[05:51:59] <ghrust> 13rust/06auto 140cbb44a 15bors: auto merge of #11181 : luqmana/rust/up-llvm, r=alexcrichton...
[05:51:59] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[06:00:49] *** Joins: jdm (jdm@moz-3FFA85CA.dsl.teksavvy.com)
[06:08:23] <dbaupp> r? https://github.com/mozilla/rust/pull/11185
[06:10:16] <dbaupp> cmr: thanks
[06:10:19] <cmr> np
[06:13:32] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[06:40:07] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[06:50:31] <vadimcn> acrichto: What do you think about #11207?   Would including .obj file as a binary blob be ok?
[06:59:06] <klutzy> vadimcn: what about adding manifest only if some flag e.g. `-Z fix-stupid-windows` is given?
[06:59:26] <klutzy> then we can add manifest only for tests
[07:00:02] <acrichto> vadimcn: is there any reason that a user would want to configure the manifest injected and they wouldn't have another way of altering the manifest?
[07:00:23] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[07:00:39] <vadimcn> klutzy: for tests it would be easier to just not use words "setup" and "update" in their names
[07:00:49] <cmr> klutzy: why wouldn'twe want manifests?
[07:01:59] <vadimcn> acrichto: visual studio for example, has a bunch of flags to change the default requested launch provileges, in case you are actually writing an installer
[07:02:23] <acrichto> vadimcn: btw when I said use LLVM I mean write C++ bindings to LLVM's coff support to write a file directly
[07:03:25] <vadimcn> acrichto: lots of wrapping...  and I am not sure it supports creating this particular relocation entry types.
[07:03:40] <vadimcn> normally it is not needed for executable code
[07:03:55] <cmr> I know lld got a lot of work recently on pe/coff
[07:04:00] <acrichto> yeah I dunno how it would work with llvm
[07:05:13] <vadimcn> acrichto: windres tool allows to alter resources in already existing executable, so default manifest could be altered if required
[07:05:39] <acrichto> vadimcn: this all sounds kinda complicated and almost like it's not rustc's job to do this?
[07:06:16] <klutzy> cmr: I think that if fixing manifest is hard, fixing gdb crash seems more important than fixing uac (but I don't know how hard manifest is)
[07:06:23] <vadimcn> acrichto: true, this should have been ld's job
[07:06:53] <acrichto> vadimcn: what would you think about just renaming tests?
[07:07:55] <vadimcn> acrichto: on the other hand, manifests win windows executables had been required for ever since Vista...
[07:08:23] <acrichto> as in all executables on windows require manifests inside them?
[07:08:46] <vadimcn> acrichto: people are gonna trip on this every once in a while.  the error messages you get are not very helpful.
[07:09:03] <acrichto> does mingw's gcc insert manifests?
[07:09:09] <acrichto> or does it have some weird option to do that?
[07:10:07] <vadimcn> no, gcc doesn't either
[07:10:30] <vadimcn> you have to create .o file via windres and link it to your executable
[07:10:41] <acrichto> how about msvc?
[07:10:54] <acrichto> roughly the same idea in that you have to manually add it?
[07:11:52] <vadimcn> msvc's linker takes care of it
[07:12:29] <vadimcn> you have to give it an option to NOT embed the manifest
[07:13:02] <acrichto> hm, sounds like that's the preferred behavior
[07:14:04] <vadimcn> what are your reservations about packaging manifest .o file as binary blob into librustc?
[07:14:20] <acrichto> eh it's not that bad
[07:14:28] <acrichto> only concern is that you can't change it
[07:14:36] <acrichto> but it's way better than a segfaulting gdb right now
[07:15:35] <klutzy> hmm, what about custom manifests from user?
[07:16:09] <vadimcn> klutzy: replace it after linking via windres
[07:17:47] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[07:19:15] <acrichto> -Z no-default-manifest
[07:19:18] <acrichto> or that too
[07:25:16] <klutzy> acrichto: on #11206, it seems that user should add /.../rustc/<target>/bin to PATH if they want to build executables with prefer-dynamic. is it documented somewhere?
[07:25:55] <acrichto> klutzy: sadly not that I know of, this all "just works" for everything but windows which is probably why there's no dox as is 
[07:28:19] <acrichto> argh bors is still stuck
[07:28:22] <acrichto> I thought I solved that
[07:28:38] <acrichto> oh wait yay!
[07:28:39] <acrichto> it just finished
[07:28:41] <acrichto> how convenient
[07:28:48] <klutzy> acrichto: hmm, I wasn't aware that my (old) library doesn't contain #[crate_type = "rlib"];, which caused dynamic link sliently. it was the real issue for me
[07:29:01] <klutzy> acrichto: but it's my fault so it's ok as is :p
[07:29:11] <acrichto> klutzy: how so? the outpu should have been lib.dll?
[07:30:05] <klutzy> acrichto: the code only contained #[crate_type = "lib"], so only dll was generated
[07:30:12] <acrichto> ah yeah
[07:30:17] <acrichto> I wonder if we should change that now
[07:30:25] <acrichto> reading the metadata of an rlib is so much faster now
[07:30:38] <acrichto> static lib generation is a little more feasible now
[07:30:46] <klutzy> yeah
[07:31:20] <klutzy> last week I learned what lib/rlib/dylib is, but my memory is volatile :(
[07:31:33] <Luqman> \o/
[07:31:41] <Luqman> 10th time's the charm
[07:31:54] <acrichto> bors just needed to think real hard
[07:36:59] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[07:36:59] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ro9_0g
[07:36:59] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[07:41:44] <sfackler> acrichto: re-r? missed some ast-fold use in tests: https://github.com/mozilla/rust/pull/11168
[07:41:58] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[07:41:58] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/qhlIJA
[07:41:58] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[07:41:58] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[07:41:59] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/r6cndQ
[07:41:59] <ghrust> 13rust/06auto 1401209f1 15Kevin Ballard: Add method .as_mut_slice() to MutableVector...
[07:41:59] <ghrust> 13rust/06auto 14e85c0af 15bors: auto merge of #10885 : kballard/rust/as_mut_slice, r=cmr...
[07:41:59] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[07:42:41] <sfackler> thanks
[07:42:44] <acrichto> np
[07:56:56] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[07:56:56] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/FdjRHg
[07:56:56] <ghrust> 13rust/06auto 1401209f1 15Kevin Ballard: Add method .as_mut_slice() to MutableVector...
[07:56:56] <ghrust> 13rust/06auto 1436e8bbf 15bors: auto merge of #10885 : kballard/rust/as_mut_slice, r=cmr...
[07:56:57] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[07:56:58] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[07:56:59] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14e85c0af to 140cbb44a: 02http://git.io/N3iJvQ
[07:56:59] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[08:00:25] <dbaupp> oh, whoops
[08:00:29] <dbaupp> missed last weeks triage
[08:07:44] *** flaper87|afk is now known as flaper87
[08:10:06] *** Joins: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP)
[08:11:56] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[08:11:56] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 1436e8bbf to 140cbb44a: 02http://git.io/N3iJvQ
[08:11:56] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[08:11:58] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[08:11:58] <ghrust> 01[13rust01] 15bors pushed 7 new commits to 06auto: 02http://git.io/GOYvoQ
[08:11:58] <ghrust> 13rust/06auto 140607c13 15Steven Fackler: Stop using @ExtCtxt
[08:11:58] <ghrust> 13rust/06auto 14711d510 15Steven Fackler: Remove unecessary extern "Rust" specifiers
[08:11:58] <ghrust> 13rust/06auto 14933def4 15Steven Fackler: Stop passing duplicate parameters in expand
[08:12:01] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[08:12:45] <acrichto> bors gotta do his rounds of failing on the first rebuild of all llvm workspaces :(
[08:12:50] <acrichto> we really need to fix that problem
[08:15:34] *** flaper87 is now known as flaper87|afk
[08:16:03] <vadimcn> Is MinGW required in order to build rust targeting Windows?
[08:17:56] <acrichto> right now it probably is, but that doesn't mean that it should be in the future
[08:23:38] <vadimcn> acrichto: hmm, that might throw wrench in my idea to include pre-compiled resources
[08:23:54] <acrichto> vadimcn: isn't it just a normal object file?
[08:24:11] <vadimcn> yes, but you need windres tool to build it
[08:24:34] <acrichto> oh I thought you were gonna include a binary file
[08:24:58] <vadimcn> I  was gonna build it along with compiler
[08:25:13] <acrichto> oh hm
[08:25:42] <klutzy> windres is from binutils, but not sure if it'll be a problem
[08:25:47] <vadimcn> if I were to check in a straight .o file, I suspect we might need two versions: for 32 and for 64 bit windows
[08:29:25] <vadimcn> klutzy: I wouldn't expect to find windres outside of mingw distribution 
[08:29:38] <eddyb> acrichto: sorry for filling up the queue :P
[08:30:25] <acrichto> eddyb: no worries! it's just exceptionally full right now :(
[08:30:34] <acrichto> we need to drain it
[08:30:45] <acrichto> eddyb: but don't let me discourage you!
[08:30:50] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[08:31:11] <eddyb> acrichto: I've rebased my de-@-Visitor PR on top of pcwalton's demuting-libsyntax PR - but sfackler's smaller one got in first >_>
[08:31:26] <acrichto> hehe
[08:31:31] <eddyb> which means I can't even rebase against master
[08:32:08] <eddyb> dbaupp: <T: Trait = Default> or <T=Default: Trait>?
[08:32:58] <eddyb> dbaupp: similar syntax issue with default values for function arguments
[08:34:40] <eddyb> acrichto: it's not like I don't have anything to work on, but I'm bad at switching tasks (rustc compilation times and memory usage doesn't help)
[08:34:54] *** Joins: nrc (ncameron@moz-A76F1825.cable.virginm.net)
[08:39:09] <acrichto> that's why I have 6 workspaces :\
[08:39:16] <acrichto> and sometimes they're all full :(
[08:41:07] <eddyb> erm, why doesn't the PR auto-update anymore?
[08:41:48] <eddyb> no, github, I don't want to open a new one
[08:42:22] <eddyb> I should've pushed yesterday, dammit
[08:45:28] <Luqman> eddyb: i think a big part of the build up was my fault :P
[08:45:45] <Luqman> trying to update llvm, only takes like 2 days xD
[08:46:14] <acrichto> blame the problem with mingw having to build twice
[08:46:22] <eddyb> "feel free to reopen with an update!" - yeah, well, no, can't do that
[08:46:49] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[08:47:51] <eddyb> at least the latest kdevelop4 has working sets again
[08:48:14] <dbaupp> eddyb: T: Trait = Default, to mirror let t: Type = value;
[08:48:32] <eddyb> thanks, I literally just opened parser.rs :D
[09:23:03] <eddyb> does even require @? type_param_defs: @~[TypeParameterDef],
[09:23:26] <eddyb> I wish I had an IDE that could tell me such things. pcwalton could've missed it
[09:26:40] *** Joins: bjz (bjz@moz-77BEEF1E.static.tpgi.com.au)
[09:27:48] <dbaupp> pcwalton is only de @mut-ing, right? not de @-ing
[09:28:20] <eddyb> dbaupp: @~ smells of "was @mut before"
[09:29:03] <eddyb> I mean, I would've investigated such double indirection - but it's a lot of work even without doing that
[09:31:21] *** flaper87|afk is now known as flaper87
[09:32:28] <dbaupp> git blame?
[09:36:38] *** Quits: Kxepal (Miranda@moz-2C828513.pppoe.mtu-net.ru) (Quit: Kxepal)
[09:36:53] *** Joins: Kxepal (Miranda@moz-2C828513.pppoe.mtu-net.ru)
[09:37:03] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[09:37:03] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/GOYvoQ
[09:37:03] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[09:41:57] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[09:41:57] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/J2fLOA
[09:41:57] <ghrust> 13rust/06auto 1401209f1 15Kevin Ballard: Add method .as_mut_slice() to MutableVector...
[09:41:57] <ghrust> 13rust/06auto 1428a091f 15bors: auto merge of #10885 : kballard/rust/as_mut_slice, r=cmr...
[09:41:58] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[09:46:23] *** Joins: lpy (lpy@7360AA58.F09091A8.1348A864.IP)
[09:58:08] <nrc> given an Item ast node (or an ident or something), is there an easy way to get the fully qualified name for the node? E.g., for a fn in a module - mod::fn_name
[09:59:55] <nrc> I see ident_to_str to get the unqualified name, do I have to walk the ast to get the rest?
[10:01:07] <eddyb> nrc: the path of the node is the fully qualified name AFAIK
[10:01:36] <eddyb> nrc: that is, the @ast_map::path inside an ast_map::ast_node
[10:02:45] <nrc> perfect, thank you!
[10:09:36] *** Quits: nrc (ncameron@moz-A76F1825.cable.virginm.net) (Ping timeout)
[10:35:56] *** Quits: bjz (bjz@moz-77BEEF1E.static.tpgi.com.au) (Ping timeout)
[10:37:38] *** flaper87 is now known as flaper87|afk
[10:41:44] *** Joins: johnrkd (johnrkd@3A09C2F6.815752B7.B05A4819.IP)
[10:47:45] *** Joins: bjz (bjz@moz-77BEEF1E.static.tpgi.com.au)
[10:54:23] *** Quits: jdm (jdm@moz-3FFA85CA.dsl.teksavvy.com) (Quit: Lost terminal)
[10:59:03] *** Joins: nielsle (nielsle@moz-C46DA772.boa.fiberby.dk)
[11:06:59] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[11:06:59] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/J2fLOA
[11:06:59] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:07:16] *** Quits: bjz (bjz@moz-77BEEF1E.static.tpgi.com.au) (Ping timeout)
[11:09:17] *** Joins: bjz (bjz@moz-77BEEF1E.static.tpgi.com.au)
[11:12:00] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[11:12:00] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/ybOc5Q
[11:12:00] <ghrust> 13rust/06auto 145580b4c 15Alex Crichton: Register new snapshots.
[11:12:00] <ghrust> 13rust/06auto 14ac0c376 15bors: auto merge of #11169 : alexcrichton/rust/snapshots, r=sanxiyn...
[11:12:01] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[11:12:03] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[11:12:03] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/Ty_dLA
[11:12:03] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[11:13:02] *** kimundi is now known as zz_kimundi
[11:17:00] *** Quits: bjz (bjz@moz-77BEEF1E.static.tpgi.com.au) (Ping timeout)
[11:21:18] *** Joins: bjz (bjz@moz-77BEEF1E.static.tpgi.com.au)
[11:24:32] *** Quits: bjz (bjz@moz-77BEEF1E.static.tpgi.com.au) (Ping timeout)
[11:35:43] *** zz_kimundi is now known as kimundi
[11:48:46] *** Joins: gwty (gwtypc@F42DD637.5A446153.E7DAB6F9.IP)
[11:52:08] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Ping timeout)
[12:08:54] *** Joins: nrc (ncameron@moz-AD2938E.hari.cable.virginm.net)
[12:11:28] *** Quits: nrc (ncameron@moz-AD2938E.hari.cable.virginm.net) (Ping timeout)
[12:16:13] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[12:18:51] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[12:25:10] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[12:26:53] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[12:26:53] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/ybOc5Q
[12:26:53] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:32:12] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[12:32:13] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/i3aZLA
[12:32:13] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[12:32:14] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[12:32:14] <ghrust> 01[13rust01] 15bors pushed 5 new commits to 06auto: 02http://git.io/UzEcdw
[12:32:14] <ghrust> 13rust/06auto 144bc0971 15Luis de Bethencourt: Rename pkgid variables
[12:32:14] <ghrust> 13rust/06auto 14f872c47 15Luis de Bethencourt: Rename PkgId to CrateId
[12:32:15] <ghrust> 13rust/06auto 14016d52e 15Luis de Bethencourt: Rename uses of PkgId to CrateId in librustpkg
[12:32:17] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[12:56:54] *** flaper87|afk is now known as flaper87
[13:43:44] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[13:44:11] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[13:44:26] *** vfetwnuncszu is now known as dcrewi
[13:45:55] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[13:46:56] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[13:46:56] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/UzEcdw
[13:46:56] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[13:51:54] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[13:51:55] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/PUA63g
[13:51:55] <ghrust> 13rust/06auto 14582ad8f 15Huon Wilson: rustdoc: only filter lines starting with '# ' from the shown code....
[13:51:55] <ghrust> 13rust/06auto 14dedc29f 15Huon Wilson: rustdoc: Unify the handling of the hidden example lines.
[13:51:55] <ghrust> 13rust/06auto 14a4f30bf 15bors: auto merge of #11185 : huonw/rust/doc-ignore, r=cmr...
[13:51:57] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[14:01:18] <eddyb> dbaupp: almost there :). had to help someone with mongodb in the meanwhile
[14:07:34] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[14:11:28] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: Leaving.)
[14:25:38] <cmr> eddyb: I like <T: Trait = Default>.
[14:26:05] <eddyb> that's what I went for
[14:26:22] <cmr> ah ok
[14:26:28] * cmr just finished reading the backlog
[14:36:25] <eddyb> not sure what to do about non-instantiable generics. which I think show up only in impl
[14:36:44] <eddyb> impl<T, U=T> would do precisely nothing special right now
[14:38:14] <cmr> Hm
[14:38:29] <eddyb> though how is Foo::<T>::new() resolved?
[14:38:40] <eddyb> (if it works at all)
[14:38:56] <eddyb> rusti: std::rc::Rc::new(5)
[14:38:57] -rusti- std::rc::Rc<int>{ptr: (0x7f66e0000f50 as *mut ())}
[14:39:04] <cmr> Foo<T>::new()
[14:39:07] <eddyb> rusti: std::rc::Rc::<int>::new(5)
[14:39:07] -rusti- std::rc::Rc<int>{ptr: (0x7f3ff0000f50 as *mut ())}
[14:39:32] <eddyb> I'll have to see what my current implementation does in that case
[14:42:40] <eddyb> rusti: struct Foo<T>; impl Foo<bool> {fn new()->Foo<bool>{Foo}}
[14:42:41] -rusti- ()
[14:42:46] <eddyb> rusti: struct Foo<T>; impl Foo<bool> {fn new()->Foo<bool>{Foo}} Foo::new()
[14:42:47] -rusti- main::Foo<bool>
[14:42:54] <eddyb> rusti: struct Foo<T>; impl Foo<bool> {fn new()->Foo<bool>{Foo}} Foo::<bool>::new()
[14:42:56] -rusti- pastebinned 10 lines of output: http://ix.io/9A4
[14:43:30] <eddyb> cmr: it goes through the impl which means it's not useless :D
[14:44:24] <eddyb> this is going way too smooth. but I shouldn't jinx it
[15:02:03] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[15:02:04] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/PUA63g
[15:02:04] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[15:02:30] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:06:53] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[15:06:53] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/3-d_hg
[15:06:53] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[15:06:55] *** Joins: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP)
[15:06:55] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/QTVFLg
[15:06:55] <ghrust> 13rust/06auto 145b88f92 15Brian Anderson: Don't allow single-variant enums to be dereferenced. #6246...
[15:06:55] <ghrust> 13rust/06auto 14875cfe0 15Brian Anderson: Don't allow newtype structs to be dereferenced. #6246
[15:06:55] <ghrust> 13rust/06auto 14933c540 15bors: auto merge of #11188 : brson/rust/noderef, r=alexcrichton...
[15:06:57] *** Parts: ghrust (ghrust@9C8B94D4.6A2AE50.F3114085.IP) ()
[15:08:28] <eddyb> oh, that's interesting
[15:09:22] <eddyb> if only you could do fn foo(&Foo(self): &Self
[15:09:31] *** Quits: lpy (lpy@7360AA58.F09091A8.1348A864.IP) (Ping timeout)
[15:16:51] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[15:16:51] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/fDiyEQ
[15:16:51] <ghrust> 13rust/06auto 144660659 15eliovir: rust.md : update crate attributes....
[15:16:51] <ghrust> 13rust/06auto 146db7e35 15bors: auto merge of #11190 : eliovir/rust/patch-3, r=alexcrichton...
[15:16:51] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[15:16:54] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[15:16:54] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 14933c540 to 14a4f30bf: 02http://git.io/N3iJvQ
[15:16:54] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[15:24:38] <eddyb> <anon>:1:137: 1:152 error: the impl referenced by this path has 2 type parameters, but 1 type parameter were supplied
[15:25:13] <eddyb> cmr, dbaupp: this works: struct Heap; struct Vec<T, A=Heap>; impl<T, A=Heap> Vec<T, A>{fn new()->Vec<T, A>{Vec}} fn main(){let _v: Vec<int> = Vec::new();}
[15:26:53] <cmr> \o/
[15:31:27] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[15:38:48] <eddyb> cmr: the verb "has" in the error about an impl/trait doesn't work with "at least". what should I use instead? "needs" or "requires"?
[16:06:41] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[16:10:08] *** Joins: lpy (lpy@12172131.F09091A8.1348A864.IP)
[16:12:46] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[16:13:01] *** vfetwnuncszu is now known as dcrewi
[16:26:51] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[16:26:51] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/fDiyEQ
[16:26:51] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[16:29:49] *** Quits: Axord (xord@moz-C0D5F15A.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[16:32:12] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[16:32:12] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/HwzsKw
[16:32:12] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[16:32:13] *** Joins: Kxepal832 (Miranda@moz-1E4F2404.pppoe.mtu-net.ru)
[16:32:36] *** Quits: Kxepal (Miranda@moz-2C828513.pppoe.mtu-net.ru) (Ping timeout)
[16:36:50] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[16:36:50] <ghrust> 01[13rust01] 15bors pushed 3 new commits to 06auto: 02http://git.io/srysSQ
[16:36:50] <ghrust> 13rust/06auto 14b3ae7b1 15Kevin Ballard: Add /doc/{green,native} to .gitignore
[16:36:50] <ghrust> 13rust/06auto 141db7464 15Kevin Ballard: Add /doc/{rustc,syntax} to .gitignore
[16:36:50] <ghrust> 13rust/06auto 14f7fd618 15bors: auto merge of #11194 : kballard/rust/gitignore-doc-green-native, r=alexcrichton
[16:36:52] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[16:36:54] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[16:36:54] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/HwzsKw
[16:36:54] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[16:37:10] *** Quits: lpy (lpy@12172131.F09091A8.1348A864.IP) (Client exited)
[16:40:17] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[16:40:18] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[16:40:28] *** vfetwnuncszu is now known as dcrewi
[16:53:24] <eddyb> I should've focused on something like trans instead of wasting time on config
[16:53:58] <eddyb> strcat: do you have known examples of bloated IR generated by trans?
[16:54:07] <strcat> anything
[16:54:11] <eddyb> hehe
[16:54:55] <eddyb> strcat: I don't want to rewrite all of trans and find out it didn't help at all. so I want to restrict that "anything"
[16:56:25] <eddyb> I do have a couple of branches around where I experimented with adding indirection in some places, caused me a lot of trouble - and it didn't help
[16:57:55] <eddyb> strcat: I guess I could compile an arbitrary run-pass test with no optimization and --emit-llvm -S and look at it
[17:01:00] <eddyb> strcat: I got this to fully compile (the last part was nastiest) struct Heap; struct Vec<T, A=Heap>; impl<T, A=Heap> Vec<T, A>{fn new()->Vec<T, A>{Vec}} fn main(){let _v: Vec<int> = Vec::new();let _v = Vec::<int>::new();}
[17:02:12] <eddyb> and new error messages: <anon>:1:155: 1:182 error: too many type parameters provided: expected at most 2, found 3
[17:02:18] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[17:02:33] <eddyb> (without "at most" it would imply it can only take 2, no more, no less)
[17:10:56] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[17:10:57] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[17:11:13] *** vfetwnuncszu is now known as dcrewi
[17:11:30] *** Joins: ChristopherBurg (Christophe@moz-2C03E71B.hfc.comcastbusiness.net)
[17:15:32] <eddyb> strcat: I feel like stealing your Vec<T, A> for the run-pass test
[17:23:57] *** Joins: nrc (ncameron@moz-AD2938E.hari.cable.virginm.net)
[17:39:26] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[17:39:26] <ghrust> 01[13rust01] 15alexcrichton 04force-pushed 06try from 146054df6 to 14687309e: 02http://git.io/k471pw
[17:39:26] <ghrust> 13rust/06try 14f337029 15Alex Crichton: Implement a Once primitive for initialization...
[17:39:26] <ghrust> 13rust/06try 145b7b3d0 15Alex Crichton: Convert relevant static mutexes to Once
[17:39:26] <ghrust> 13rust/06try 14e97b6e5 15Alex Crichton: Move task count bookeeping out of libstd...
[17:39:28] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[17:46:57] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[17:46:57] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/srysSQ
[17:46:57] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[17:48:43] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[17:51:49] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[17:51:49] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/pc5Qig
[17:51:49] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[17:51:50] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[17:51:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/EiA-rQ
[17:51:50] <ghrust> 13rust/06auto 140da86ba 15Alex Crichton: Actually block in a windows cvar...
[17:51:50] <ghrust> 13rust/06auto 141502b11 15bors: auto merge of #11199 : alexcrichton/rust/windows-isnt-waiting, r=pcwalton...
[17:51:50] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[17:52:04] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[17:52:17] *** vfetwnuncszu is now known as dcrewi
[17:53:56] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[17:53:56] *** ChanServ sets mode: +ao pcwalton pcwalton
[17:55:59] <eddyb> pcwalton: hey :)
[17:56:05] <pcwalton> eddyb: hey, what's up?
[17:56:27] <eddyb> I just realized that I could have to write 2013-2014 in the copyright headers :P
[17:56:57] <eddyb> pcwalton: from earlier today: [10:31] <eddyb> acrichto: I've rebased my de-@-Visitor PR on top of pcwalton's demuting-libsyntax PR - but sfackler's smaller one got in first >_>
[17:57:09] <pcwalton> heh, I'm rebasing my PR right now
[17:57:26] <pcwalton> and then will be completing it
[17:57:35] <eddyb> can I even rebase again and have it work?
[17:58:46] <pcwalton> I can tell you the answer to that after I finish this :)
[17:58:53] <pcwalton> we'll see whether mine even makes sense
[17:59:02] <eddyb> or somehow take my commit and move it on top of master after your PR
[18:18:20] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[18:18:29] *** Joins: jdm (jdm@moz-3FFA85CA.dsl.teksavvy.com)
[18:21:07] <eddyb> did a LLVM update get through in the last hour?
[18:21:58] <eddyb> ah nvm just the snapshot
[18:28:33] <eddyb> cmr, dbaupp: https://github.com/mozilla/rust/pull/11217 - I think it's only missing a run-pass test, which I might add later (should I make a simple Vec<T, A=Heap> contraption?)
[18:28:54] <eddyb> bbl now
[18:35:50] <pcwalton> eddyb: updated demuting
[18:35:53] <pcwalton> it's not so bad
[18:39:44] <kimundi> hu, default generics paramters... Will that conflict with the hypotetical variadic generic parameter stuff?
[18:40:51] *** Quits: jdm (jdm@moz-3FFA85CA.dsl.teksavvy.com) (Ping timeout)
[18:48:25] *** Joins: jdm (jdm@moz-3FFA85CA.dsl.teksavvy.com)
[18:50:33] <pcwalton> eddyb: whoa, default type parameters in generics! sweet!
[19:16:50] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[19:16:50] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/EiA-rQ
[19:16:50] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[19:21:50] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[19:21:50] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/4xaNNQ
[19:21:50] <ghrust> 13rust/06auto 14832ee6f 15Alex Crichton: Convert some C functions to rust functions...
[19:21:50] <ghrust> 13rust/06auto 145a7c111 15bors: auto merge of #11208 : alexcrichton/rust/less-c, r=cmr...
[19:21:50] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[19:21:52] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[19:21:52] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/oiSIwg
[19:21:52] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[19:47:17] *** flaper87 is now known as flaper87|afk
[19:50:03] *** Quits: gwty (gwtypc@F42DD637.5A446153.E7DAB6F9.IP) (Ping timeout)
[19:52:31] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[20:02:07] *** Joins: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP)
[20:02:07] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 145a7c111 to 141502b11: 02http://git.io/N3iJvQ
[20:02:07] *** Parts: ghrust (ghrust@C8693FCB.6A2AE50.F3114085.IP) ()
[20:02:11] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[20:02:11] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/xk_IEg
[20:02:11] <ghrust> 13rust/06auto 14426c17b 15Alex Crichton: Convert some C functions to rust functions...
[20:02:11] <ghrust> 13rust/06auto 146b32dd5 15bors: auto merge of #11208 : alexcrichton/rust/less-c, r=cmr...
[20:02:12] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[20:07:25] <eddyb> kimundi: you won't be able to have both
[20:07:33] <eddyb> to disambiguate
[20:12:23] *** Quits: johnrkd (johnrkd@3A09C2F6.815752B7.B05A4819.IP) (Quit: )
[20:14:41] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:17:32] *** Joins: geoffhill (geoffhill@moz-738DC0DB.org)
[20:20:04] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[20:21:44] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[20:23:33] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[20:25:31] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[20:27:11] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[20:45:02] <eddyb> strcat: support pls https://github.com/mozilla/rust/pull/11217
[20:47:08] *** kimundi is now known as zz_kimundi
[20:47:13] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[20:49:00] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[20:50:18] *** Joins: whitequark (whitequark@moz-BC42D267.whitequark.org)
[20:50:55] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[20:52:59] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[20:57:02] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[20:58:51] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[21:08:56] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[21:10:36] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[21:14:06] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[21:14:18] <eddyb> strcat: "soon" https://github.com/mozilla/rust/issues/10586
[21:15:44] *** Quits: blank_name (blank_name@78B04CD2.66204B68.6D228269.IP) (Ping timeout)
[21:15:53] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[21:19:39] <eddyb> pcwalton: do you mean this is updated? https://github.com/mozilla/rust/pull/11167 (it's not immediately obvious)
[21:21:22] <cmr> I wonder if we should have a label on github for each feature gate.
[21:21:32] <cmr> F-unicode for all bugs involving multibyte chars etc
[21:22:07] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[21:23:48] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[21:28:42] <eddyb> @general::__STATIC_FMTSTR::h0aa2aeab71b212f48477819d6fab8d433f3127dd324231ab20d32d240cd7c3a5a8::v0.0 = internal unnamed_addr constant { { i8, { { i8, [15 x i8] }, { i32, i8, i64, { i8, [15 x i8] }, { i8, [15 x i8] } }, { i8* } }, [0 x i8] } } { { i8, { { i8, [15 x i8] }, { i32, i8, i64, { i8, [15 x i8] }, { i8, [15 x i8] } }, { i8* } }, [0 x i8] } { i8 2, { { i8, [15 x i8] }, { i32, i8, i64, { i8, [15 x i8] }, { i8, [15 x i8] } }, { i8* } 
[21:28:43] <eddyb> } { { i8, [15 x i8] } { i8 0, [15 x i8] undef }, { i32, i8, i64, { i8, [15 x i8] }, { i8, [15 x i8] } } { i32 32, i8 2, i64 0, { i8, [15 x i8] } { i8 3, [15 x i8] undef }, { i8, [15 x i8] } { i8 3, [15 x i8] undef } }, { i8* } zeroinitializer }, [0 x i8] undef } }
[21:28:54] <eddyb> what on earth is that?
[21:29:21] <dbaupp> eddyb: format!() et al generate thngs like that
[21:29:24] <eddyb> of course. it makes sense after I paste into the IRC. nevermind me
[21:29:37] <eddyb> dbaupp: I figured once I realized it can't be a string
[21:29:53] <dbaupp> I guess the STR in the name is confusing
[21:30:30] <eddyb> tests aren't good for looking at IR because they have asserts
[21:30:40] <dbaupp> yes
[21:32:28] <eddyb> strcat: okay, I'm starting to see a pattern. alloca, loads and stores for locals not taken by reference
[21:32:49] <eddyb> I feel that might require some analysis to cleanup
[21:36:27] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[21:38:58] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[21:41:53] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:41:53] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/-Z4Uaw
[21:41:53] <ghrust> 13rust/06auto 14e0a6910 15Volker Mische: Implement Ratio:from_float()...
[21:41:53] <ghrust> 13rust/06auto 146e2ed58 15bors: auto merge of #11125 : vmx/rust/rational, r=huonw...
[21:41:53] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:41:56] *** Joins: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP)
[21:41:56] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146b32dd5 to 141502b11: 02http://git.io/N3iJvQ
[21:41:56] *** Parts: ghrust (ghrust@24260B07.6A2AE50.F3114085.IP) ()
[21:43:05] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[21:46:20] *** Joins: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP)
[21:48:27] *** Quits: gwty (gwtypc@6ECBB0C9.8165D294.25B273F5.IP) (Ping timeout)
[22:01:08] *** Quits: eddyb (eddy@EE946B63.921A1753.FCAAE698.IP) (Ping timeout)
[22:25:18] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: Leaving.)
[22:31:58] *** Joins: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP)
[22:31:58] <ghrust> 01[13rust01] 15bors 04force-pushed 06auto from 146e2ed58 to 141502b11: 02http://git.io/N3iJvQ
[22:31:58] *** Parts: ghrust (ghrust@1E8607E8.6A2AE50.F3114085.IP) ()
[22:32:00] *** Joins: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP)
[22:32:00] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/-nHBzA
[22:32:00] <ghrust> 13rust/06auto 14e0a6910 15Volker Mische: Implement Ratio:from_float()...
[22:32:00] <ghrust> 13rust/06auto 14df25bb6 15bors: auto merge of #11125 : vmx/rust/rational, r=huonw...
[22:32:00] *** Parts: ghrust (ghrust@DE823A67.6A2AE50.F3114085.IP) ()
[22:33:21] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[22:33:27] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: erickt1)
[22:39:11] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Ping timeout)
[22:49:02] *** Quits: ChristopherBurg (Christophe@moz-2C03E71B.hfc.comcastbusiness.net) (Ping timeout)
[22:52:52] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[22:57:58] *** Quits: jdm (jdm@moz-3FFA85CA.dsl.teksavvy.com) (Quit: Lost terminal)
[23:02:30] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[23:02:30] *** ChanServ sets mode: +qo brson brson
[23:05:14] <brson> rust has had an incredible amount of publicity this week
[23:05:35] <cmr> it has.
[23:05:45] <cmr> probably going to have even more for 0.9
[23:06:27] <brson> it's good that public opinion continues to be in our favor
[23:06:29] <SiegeLord> What was the publicity?
[23:06:39] <brson> but we need to get 1.0 out
[23:06:42] <cmr> SiegeLord: various things hit HN and were received well.
[23:07:01] <SiegeLord> Need to check it out...
[23:08:11] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: Leaving.)
[23:09:19] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[23:11:37] <cmr> I blame steveklabnik
[23:11:41] <cmr> for being popular on HN
[23:12:29] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: Leaving.)
[23:12:36] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[23:16:15] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Connection reset by peer)
[23:16:22] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[23:16:43] *** Joins: steveklabnik (uid17044@moz-A42E5B7B.irccloud.com)
[23:16:51] <steveklabnik> Hey
[23:19:36] <cmr> steveklabnik: https://botbot.me/mozilla/rust-internals/msg/9257126/ :P
[23:19:45] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: Leaving.)
[23:19:46] <steveklabnik> Hehe
[23:19:49] <steveklabnik> Reading
[23:20:20] <steveklabnik> Oh yeah
[23:20:25] <steveklabnik> I've been working it hard
[23:20:43] <steveklabnik> wycats had promised me a technical post on the traits thing, but he's been busy
[23:21:04] <steveklabnik> I just have a good eye for promotion ;)
[23:23:22] *** Joins: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net)
[23:23:26] <steveklabnik> I do think a 1.0 sooner rather than later would be great, but I'm also not contributing any patches lately, soooo
[23:24:48] * ChrisMorgan also agrees that 1.0 needs to come in the not-too-distant future
[23:29:13] <steveklabnik> ChrisMorgan: how's your web framework on top of rust-http doing?
[23:30:19] <ChrisMorgan> steveklabnik: I'm not starting on the web framework until rust-http is sufficiently stable; I'm planning for a rewrite of quite a bit of rust-http (especially its transfer techniques) at present.
[23:30:28] <steveklabnik> cool
[23:30:47] <cmr> ChrisMorgan: did you see that wycats wrote/is writing a URL router and seems to be working on a framework?
[23:32:26] <ChrisMorgan> acrichto: I'm becoming steadily more and more concerned that the model employed for TCP and UDP is not going to work. I can't see any model whereby HTTP/2.0 can be satisfactorily implemented with std::io::net::tcp::TcpStream, nor things like IRC servers which need to be able to read and write simultaneously.
[23:33:56] <steveklabnik> cmr: where'd you see that?
[23:34:08] <steveklabnik> screw http/2.0 ;)
[23:34:11] <cmr> steveklabnik: he pasted snippets in #rust, one sec...
[23:34:16] <steveklabnik> cmr, ahh it's cool
[23:34:53] <cmr> https://github.com/wycats/route-recognizer.rs/blob/master/src/lib.rs#L50
[23:34:57] <sfackler> pcwalton: I'm trying to rewrite SyntaxEnv and I'd like to make it a borrowed pointer linked list but I can't seem to get it to play nice with the lifetimes. Can something like this be made to work? https://gist.github.com/sfackler/393aa2bf63539b61eaa7
[23:35:24] <pcwalton> I think that'll be too hard
[23:35:26] <pcwalton> to make work
[23:35:36] <pcwalton> try to factor it some other way
[23:35:56] <sfackler> yeah, the other option is just a ~[(BlockInfo, HashMap)]
[23:36:12] <sfackler> but the linked list thing would be so cool if I could get it to work :P
[23:36:16] <pcwalton> heh
[23:39:05] *** Quits: erickt1 (Adium@moz-4B000CB7.dyn.optonline.net) (Quit: Leaving.)
[23:40:38] <sfackler> man I wish generic destructors worked :(
[23:40:55] <brson> ChrisMorgan: once tcp supports select you can read and write simultaneously by waking up a blocking reader then writing
[23:41:18] <brson> i believe that's how it would be done with native streams
[23:42:00] <ChrisMorgan> brson: the way we handle select with it will be crucial to making a vast array of things currently infeasible feasible.
[23:42:48] <pcwalton> let's see if removing all the @muts inside the parser improved its speed
[23:43:09] <pcwalton> sfackler: do you, off the top of your head, know why syntax expansion is so slow?
[23:43:13] <pcwalton> it's much slower than parsing
[23:43:32] <dbaupp> it's having to create whole new ASTs
[23:43:35] <sfackler> it allocates an @mut box for every block it traverses
[23:43:38] <pcwalton> well, so does parsing :P
[23:43:41] <dbaupp> several times
[23:43:47] <dbaupp> aiui
[23:43:49] <sfackler> not sure other than that
[23:43:49] <pcwalton> I mean, parsing creates the entire AST
[23:43:53] <sfackler> yeah
[23:44:15] <sfackler> is it slow even when there's nothing to expand?
[23:44:19] <pcwalton> not sure
[23:44:25] <cmr> pcwalton: it puzzles me, too.
[23:44:30] <strcat> don't necessarily need select at all
[23:44:31] <cmr> eddyb has been looking into it.
[23:44:31] <pcwalton> it seems to be consistently 2x-3x slower than parsing
[23:45:45] <sfackler> it also makes a new hashmap for every block, maybe it's spending a bunch of time grabbing entropy?
[23:46:45] <pcwalton> one of the few opportunities for major speedups I can think of is doing the vector representation change
[23:46:47] <strcat> afaik those use a task-local RNG
[23:46:49] <pcwalton> so that zero-length vectors don't allocate
[23:46:49] *** Joins: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP)
[23:46:49] <ghrust> 01[13rust01] 15bors merged 06auto into 06master: 02http://git.io/-nHBzA
[23:46:49] *** Parts: ghrust (ghrust@2EE61FCC.6A2AE50.F3114085.IP) ()
[23:47:13] <dbaupp> hashmaps do use the task rng
[23:47:19] <pcwalton> I think we have a lot of zero-length vectors.
[23:47:22] <cmr> pcwalton: did you claim at one point that eliminating landing pads would be a 20-30% speedup in rustc?
[23:47:29] <pcwalton> it was a long time ago
[23:47:38] <pcwalton> I wouldn't be surprised if that's bogus now
[23:47:56] <cmr> ah, maybe I saw it pouring over ancient meeting notes.
[23:48:05] <pcwalton> but it might still be true
[23:48:09] <pcwalton> I still want to
[23:48:29] <pcwalton> well there were good arguments that librustc may want to be used by tools that want real failure
[23:48:38] <pcwalton> IDEs etc
[23:49:12] <cmr> we can still strip them from the rustc binary
[23:49:13] <dbaupp> it's not well set up for such tools (no facility for partial input, etc.)
[23:49:18] <cmr> acrichto did the work for that recently.
[23:49:25] <pcwalton> cmr: yeah but if we do there's no compile time gain
[23:49:48] <strcat> cmr: it just marks stuff nounwind afaik
[23:49:51] <strcat> doesn't stop emitting the stuff
[23:50:27] <cmr> oh, was it *emitting*/llvm'ing landing pads that the 20-30%  would come from?
[23:50:30] <pcwalton> yeah
[23:50:36] <cmr> that makes a ton more sense now
[23:50:36] <pcwalton> not runtime overhead
[23:51:00] <pcwalton> if our unwinding resulted in a 20%-30% overhead then we would have pursued a different failure strategy long ago
[23:51:48] *** Joins: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP)
[23:51:49] <ghrust> 01[13rust01] 15bors pushed 2 new commits to 06auto: 02http://git.io/Z6CeRw
[23:51:49] <ghrust> 13rust/06auto 14726091f 15Alex Crichton: Convert some C functions to rust functions...
[23:51:49] <ghrust> 13rust/06auto 14ac485fd 15bors: auto merge of #11208 : alexcrichton/rust/less-c, r=cmr...
[23:51:49] *** Parts: ghrust (ghrust@F6EE6DE3.6A2AE50.F3114085.IP) ()
[23:51:50] <strcat> cmr: it has minimal overhead at runtime
[23:51:53] *** Joins: ghrust (ghrust@79968228.6A2AE50.F3114085.IP)
[23:51:53] <ghrust> 01[13rust01] 15bors pushed 0 new commits to 06auto: 02http://git.io/inUyEg
[23:51:53] *** Parts: ghrust (ghrust@79968228.6A2AE50.F3114085.IP) ()
[23:52:00] <strcat> it just sometimes hurts complicated optimization passes
[23:52:23] <pcwalton> removing all the @mut from the parser had no effect on parsing speed
[23:52:24] <pcwalton> oh well
[23:52:30] <pcwalton> sometimes you win, sometimes you lose
[23:52:44] <strcat> what were they replaced with?
[23:52:48] <pcwalton> flattened
[23:52:51] <pcwalton> into the Parser struct
[23:53:05] <pcwalton> eliminating levels of indirection + dynamic borrow checks everywhere
[23:53:10] <pcwalton> no effect on runtime though
[23:53:30] <dbaupp> presumably most of the time is spent allocating the ast, or something
[23:53:32] <pcwalton> yup
[23:54:52] <cmr> 18.59% in malloc and free according to perf, on parsing librustc
[23:54:57] <cmr> (--parse-only)
[23:55:24] <pcwalton> well, all compilers are probably going to look like that
[23:55:29] <pcwalton> well, maybe not
[23:55:37] <pcwalton> but ours has to to some extent because of macro expansion
[23:55:46] <cmr> --parse-only doesn't expand macros
[23:55:47] <dbaupp> arena allocation would help?
[23:56:10] <pcwalton> dbaupp: you want to throw away nodes that are macro expanded away though
[23:56:10] <cmr> it stops after phase 1
[23:56:15] <pcwalton> maybe we could allocate all AST nodes that are not expanded in an arena
[23:56:31] <pcwalton> keep in mind that's like a 200ms second improvement in librustc though :P
[23:56:35] <dbaupp> well, I was thinking each expansion goes into a new arena
[23:56:38] <pcwalton> except for perhaps locality
[23:56:45] <pcwalton> dbaupp: we reuse nodes from earlier expansions though
[23:56:55] <dbaupp> not many
[23:56:56] <pcwalton> we do know when something is "finalized" though I think
[23:57:00] <cmr> -fsyntax-only
[23:57:03] <cmr>     Run the preprocessor, parser and type checking stages.
[23:57:04] <cmr> Good ole C++
[23:57:40] <dbaupp> many nodes can have macros in nodes they reference, so the folder has to reconstruct them completely.
[23:57:40] <pcwalton> I have been wondering whether our GC should just be a library that links to Boehm in its hybrid mode
[23:57:48] <pcwalton> it'd be something bad but working
[23:58:03] <pcwalton> I suspect nobody would use it except librustc which is kind of OK in my book
[23:58:19] <dbaupp> does the implementation details of the GC have backward compat concerns?
[23:58:25] <pcwalton> not really, no
[23:58:29] <pcwalton> how we design the language around GC does
[23:58:33] <pcwalton> but the implementation doesn't really
[23:58:43] <pcwalton> and Boehm is actually fairly tuned for our use case in its hybrid mode
[23:58:48] <pcwalton> hybrid mode == precise on heap, conservative on stack
[23:58:53] <cmr> what's hybrid?
[23:58:57] <cmr> ok, that's what I expected.
[23:58:57] <pcwalton> cmr: ^
[23:59:28] <pcwalton> it'd let us throw out tons of @ glue without much effort
[23:59:34] <pcwalton> and honestly it'd be a step up from @
[23:59:37] <pcwalton> in performance
[23:59:46] <pcwalton> and correctness (handles cycles, yay!)
