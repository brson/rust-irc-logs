[01:27:15] *** Joins: Elaine (Elaine@moz-35s2fm.members.linode.com)
[02:48:50] *** Quits: barosl (barosl@moz-tmp.qma.67.220.IP) (Quit: Leaving)
[02:51:57] *** Quits: kimundi (kimundi@moz-bsafd4.bs4k.bqfc.57bc.2002.IP) (Ping timeout: 121 seconds)
[02:55:54] *** Joins: kimundi (kimundi@moz-k57ctm.dip0.t-ipconnect.de)
[03:42:33] *** Joins: barosl (barosl@moz-tmp.qma.67.220.IP)
[05:47:21] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[07:02:53] *** Quits: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[07:22:15] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[09:38:22] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[10:43:35] *** Joins: sigma (sigma@moz-92585k.range217-44.btcentralplus.com)
[10:46:48] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (A TLS packet with unexpected length was received.)
[10:47:27] *** Joins: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua)
[11:27:09] *** Quits: stl (stl@moz-al5.8pf.15.176.IP) (Ping timeout: 121 seconds)
[13:32:41] *** Quits: sigma (sigma@moz-92585k.range217-44.btcentralplus.com) (Ping timeout: 121 seconds)
[13:34:23] <ChrisMorgan> str and [u8] hash differently. This is annoying to me as I believe it means I shouldn’t go implementing Borrow<str> for StrTendril, because it uses the [u8] hash. So if I want a HashMap with a StrTendril as the key, I’m going to be stuck with using &[u8] or StrTendril for indexing, not &str. ☹
[13:35:08] <ChrisMorgan> Is my analysis right? And is there any good reason why str and [u8] should hash differently? Could we fix this so that they used the same hashing technique? Would it be *reasonable* to?
[13:35:50] <ChrisMorgan>  /cc SimonSapin Gankro 
[13:36:50] <ChrisMorgan> It seems to me it ruins the “str is just [u8] plus UTF-8 guarantees” story.
[13:37:25] *** Joins: stl (stl@moz-al5.8pf.15.176.IP)
[13:37:54] <SimonSapin> Are there plans to stabilize unreachable, NoneZero, alloc::oom, or std::rt::heap? They are used by dependencies of html5ever
[13:38:37] <SimonSapin> ChrisMorgan: Implementing Borrow with incompatible hashing is a problem, yes
[13:38:58] * ChrisMorgan is experimenting with reviving teepee somewhat and trying tendril out for its header names/raw values
[13:39:41] <ChrisMorgan> I’m highly concerned that we don’t have GLARING BIG WARNINGS all over Borrow when it’s such a hazardous thing to implement, carrying such semantics for HashMap.
[13:39:56] <SimonSapin> agreed
[13:40:17] <ChrisMorgan> I feel sure I’ve found it documented *somewhere* that it has those requirements, but I can’t find it now. Which is concerning.
[13:40:25] <SimonSapin> it should at least be documented in both Borrow and HashMap
[13:40:32] <ChrisMorgan> Frankly, Borrow should probably be an unsafe trait.
[13:40:55] <SimonSapin> well, doing this wrong doesn’t cause memory safety issues
[13:41:02] <ChrisMorgan> … except that unsafe doesn’t mean blah blah mumble mumble…
[13:41:03] <SimonSapin> it "just" makes hashmap silently wrong
[13:42:15] <ChrisMorgan> Would changing the Hash impl for str or [u8] be reckoned backwards compatible? I think it should be?
[13:53:19] <SimonSapin> ChrisMorgan: some git archeology shows that the different hashing was introduced in https://github.com/rust-lang/rust/commit/6066118b2988fee1b758d542cee18ffe7a84acab
[13:54:48] <ChrisMorgan> Whereas [T] writes the length first.
[13:55:45] <SimonSapin> https://github.com/rust-lang/rust/issues/5257#issuecomment-14558330 "When you implement the trait for a type T, you must emit enough information to discover where your byte stream ends without any outside help except knowledge of your static type."
[13:55:56] <SimonSapin> sounds like a concern for IterBytes that doesn’t apply to Hash
[13:56:41] <SimonSapin> serialization is also discussed in that issue
[13:56:57] <ChrisMorgan> Do you see any problem with changing str’s Hash implementation to writing the length first, like [u8] does, so that they can have the same hash?
[13:59:43] <SimonSapin> I wonder if the length is still necessary at all
[14:00:00] <SimonSapin> looks like it was also added to help serialization based on IterBytes
[14:00:04] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[14:00:48] <SimonSapin> though I suppose it also helps with hash collisions
[14:01:15] <SimonSapin> like (b"12", b"3") vs (b"1", b"23")
[14:02:06] <SimonSapin> 0xFF is used instead because it’s fewer bytes to hash than a length
[14:07:54] <ChrisMorgan> SimonSapin: filed gh27108 for it
[14:08:55] <ChrisMorgan> Huh, [o__o] doesn’t say “str and [u8] should hash the same: https://github.com/rust-lang/rust/issues/27108” in here. ☹
[14:16:10] *** Quits: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[14:17:31] *** Joins: acrichto (acrichto@moz-u3dg2t.sfo1.mozilla.com)
[14:17:31] *** ChanServ sets mode: +qo acrichto acrichto
[14:30:50] *** Quits: smkz (a@moz-gdd4un.fs1g.619c.a880.2604.IP) (Connection closed)
[14:30:53] *** Joins: smkz (a@moz-gdd4un.fs1g.619c.a880.2604.IP)
[14:33:35] *** Quits: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com) (*.net *.split)
[14:33:35] *** Quits: carllerche (sid50851@moz-8i75uq.brockwell.irccloud.com) (*.net *.split)
[14:33:35] *** Quits: nmatsakis (sid381@moz-32a8b5.0j4i.jtu0.0101.2620.IP) (*.net *.split)
[14:33:35] *** Quits: aturon (sid379@moz-hhfc8n.0j4i.jtu0.0101.2620.IP) (*.net *.split)
[14:33:35] *** Quits: huon (huon@moz-hj272o.8rnv.rggd.6180.2400.IP) (*.net *.split)
[14:33:35] *** Quits: scott (uid25790@moz-e5ok1n.brockwell.irccloud.com) (*.net *.split)
[14:33:35] *** Quits: erikj (erikj@moz-1bq7nj.com) (*.net *.split)
[14:33:35] *** Quits: spastorino (sid27384@moz-i6sgse.brockwell.irccloud.com) (*.net *.split)
[14:33:35] *** Quits: reem (sid78397@moz-octfcu.brockwell.irccloud.com) (*.net *.split)
[14:33:35] *** Quits: smkz (a@moz-gdd4un.fs1g.619c.a880.2604.IP) (*.net *.split)
[14:33:35] *** Quits: frewsxcv (sid86219@moz-dneii9.brockwell.irccloud.com) (*.net *.split)
[14:33:35] *** Quits: Gankro (sid71432@moz-sc2bd6.charlton.irccloud.com) (*.net *.split)
[14:33:35] *** Quits: seanmonstar (seanmonstar@moz-jd3i0j.fkdv.ulf6.3c01.2600.IP) (*.net *.split)
[14:34:09] *** Joins: erikj (erikj@moz-1bq7nj.com)
[14:34:09] *** Joins: huon (huon@moz-hj272o.8rnv.rggd.6180.2400.IP)
[14:34:09] *** Joins: spastorino (sid27384@moz-i6sgse.brockwell.irccloud.com)
[14:34:09] *** Joins: frewsxcv (sid86219@moz-dneii9.brockwell.irccloud.com)
[14:34:09] *** Joins: carllerche (sid50851@moz-8i75uq.brockwell.irccloud.com)
[14:34:09] *** Joins: Gankro (sid71432@moz-sc2bd6.charlton.irccloud.com)
[14:34:09] *** Joins: nmatsakis (sid381@moz-32a8b5.0j4i.jtu0.0101.2620.IP)
[14:34:09] *** Joins: seanmonstar (seanmonstar@moz-jd3i0j.fkdv.ulf6.3c01.2600.IP)
[14:34:09] *** Joins: reem (sid78397@moz-octfcu.brockwell.irccloud.com)
[14:34:09] *** Joins: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com)
[14:34:09] *** Joins: aturon (sid379@moz-hhfc8n.0j4i.jtu0.0101.2620.IP)
[14:34:09] *** Joins: scott (uid25790@moz-e5ok1n.brockwell.irccloud.com)
[14:34:09] *** Joins: smkz (a@moz-gdd4un.fs1g.619c.a880.2604.IP)
[14:34:09] *** bruford.mozilla.org sets mode: +qooo huon huon nmatsakis aturon
[14:35:00] *** Quits: seanmonstar (seanmonstar@moz-jd3i0j.fkdv.ulf6.3c01.2600.IP) (Ping timeout: 121 seconds)
[14:35:05] *** Quits: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com) (Ping timeout: 121 seconds)
[14:35:06] *** Quits: huon (huon@moz-hj272o.8rnv.rggd.6180.2400.IP) (Ping timeout: 121 seconds)
[14:35:50] *** Quits: smkz (a@moz-gdd4un.fs1g.619c.a880.2604.IP) (Connection closed)
[14:35:54] *** Joins: smkz (a@moz-gdd4un.fs1g.619c.a880.2604.IP)
[14:37:02] *** Joins: rdgawdzi (sid91768@moz-36ps68.ealing.irccloud.com)
[14:37:04] *** Joins: huon (huon@moz-hj272o.8rnv.rggd.6180.2400.IP)
[14:37:04] *** ChanServ sets mode: +qo huon huon
[14:37:06] *** Joins: seanmonstar (seanmonstar@moz-jd3i0j.fkdv.ulf6.3c01.2600.IP)
[15:34:09] *** Joins: Elaine (Elaine@moz-35s2fm.members.linode.com)
[15:42:46] *** Joins: sigma (sigma@moz-92585k.range217-44.btcentralplus.com)
[16:41:33] *** Quits: sigma (sigma@moz-92585k.range217-44.btcentralplus.com) (Ping timeout: 121 seconds)
[18:09:54] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[18:26:00] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[18:29:22] *** Quits: barosl (barosl@moz-tmp.qma.67.220.IP) (Quit: Leaving)
[18:31:35] *** Joins: barosl (barosl@moz-tmp.qma.67.220.IP)
[18:50:39] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[19:38:15] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[20:12:19] <nagisa> Yurume, Yurumechan: ping
[20:12:26] <nagisa> oh he’s not here
[20:57:28] *** Quits: gleb (gleb@moz-3u1drv.rusanovka-net.kiev.ua) (Ping timeout: 121 seconds)
[22:25:23] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Connection closed)
[23:21:27] *** Joins: brson (brson@moz-f0v.335.39.84.IP)
[23:21:27] *** ChanServ sets mode: +qo brson brson
