[00:00:29] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[00:02:09] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[00:04:21] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[00:05:16] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Ping timeout)
[00:06:09] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Ping timeout)
[00:06:16] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[00:08:58] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:10:46] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[00:14:53] *** Quits: brson (brson@moz-62518563.mtv2.mozilla.com) (Quit: leaving)
[00:15:49] <huon> comments? https://github.com/rust-lang/rfcs/pull/16
[00:20:46] <sfackler> I think brson was a bit concerned about the potential for AST bloat if we had to attach Vec<Attribute> to everything when I asked about this at one of the meetups
[00:21:04] <sfackler> but I don't think it was a deal breaker or anything
[00:21:14] <sfackler> especially since empty vec_ng's don't allocate
[00:21:27] <cmr> well they still bloat the AST
[00:21:31] <cmr> 3 more words on all the things
[00:21:33] <cmr> (*all* the things)
[00:21:51] <sfackler> not *all*, just most :P
[00:21:54] <cmr> That has technical solutions we can work out later though
[00:22:03] <cmr> Whereas not having attributes on things is a hard language limit
[00:24:10] *** Quits: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[00:30:29] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[00:32:24] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[00:37:47] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:39:53] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:40:08] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:42:25] *** kimundi is now known as zz_kimundi
[00:43:17] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:46:03] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[00:46:24] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[00:47:52] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:47:52] *** Quits: japaric2 (japaric@5264F756.A8CC9503.F29ED47E.IP) (Connection reset by peer)
[00:49:31] *** Joins: japaric (japaric@5264F756.A8CC9503.F29ED47E.IP)
[00:49:48] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[00:50:39] <huon> r? https://github.com/mozilla/rust/pull/12998
[00:51:06] <huon> (it was previously r+ except for this deletion: https://github.com/mozilla/rust/pull/12998/files#diff-3 )
[00:51:28] <huon> acrichto: ^
[00:52:49] <acrichto> huon: oh interesting, I think the new dummy thing counts as a literal
[00:56:44] <huon> acrichto: yeah, it expands to a () literal now
[00:56:54] <huon> rather than a... empty ExprTuple
[00:57:01] <huon> (is that even valid?)
[00:57:54] <acrichto> dunno
[00:58:00] <acrichto> it's just in errors though
[00:58:01] <acrichto> so not that bad
[01:00:46] <huon> it probably appears if you write --pretty expanded with an erroring macro
[01:00:58] <huon> not taht that's something we should be concerned about...
[01:01:34] <huon> oh, of course not
[01:02:06] <huon> --pretty doesn't print anything when it hit an error
[01:11:41] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[01:11:41] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14e8c66b9 to 146eae7df: 02http://git.io/N3iJvQ
[01:11:41] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[01:14:46] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[01:15:58] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[01:18:01] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[01:19:13] *** Quits: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com) (Ping timeout)
[01:29:30] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:31:52] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:36:24] *** Joins: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com)
[01:37:52] *** Quits: gimpf (gimpf@moz-11D9DBFB.adsl.highway.telekom.at) (Quit: Leaving.)
[01:41:43] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[01:41:43] <ghrust> [13rust] 15bors 04force-pushed 06auto from 140d073a9 to 146eae7df: 02http://git.io/N3iJvQ
[01:41:43] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[01:41:44] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[01:41:44] <ghrust> [13rust] 15bors pushed 10 new commits to 06auto: 02http://git.io/TPgsew
[01:41:44] <ghrust> 13rust/06auto 144c4a1b9 15Corey Richardson: Remove libc from std...
[01:41:44] <ghrust> 13rust/06auto 14f3225ed 15Corey Richardson: fix fallout from std::libc separation
[01:41:44] <ghrust> 13rust/06auto 141916265 15Corey Richardson: Add unrecognized_lint
[01:41:46] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[01:43:56] *** Joins: eibwen (kvirc@moz-D733931B.dip0.t-ipconnect.de)
[01:45:08] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:45:35] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (Quit: huon)
[01:47:28] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:50:49] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[01:50:49] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Client exited)
[01:51:11] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:53:30] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:53:37] <cmr> please land
[01:53:40] <cmr> please?
[01:54:03] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[01:58:31] <nrc> So,
[01:58:57] <nrc> I have a recursive function, each run of which generates a vector of @BigThing
[01:59:23] <nrc> and the ultimate result I want is a single vector with all these things in it
[01:59:53] <nrc> given the performance characteristics of Rust Vecs (of which I am mostly ignorant) and any other useful data structures.
[01:59:58] <nrc> what is the best way to do this?
[02:00:31] <cmr> do you have a rough estimate (a greatest upper bound is fine) of the size of each vector?
[02:00:37] <nrc> appending vecs at each iteration seems like a bad idea
[02:00:59] <nrc> cmr: max is probably ~100, common case is smaller
[02:01:17] <nrc> recursion depth max is probably 20, common is 1
[02:01:23] <nrc> but it will be called often
[02:01:42] <nrc> (almost often enough to make it worthwhile caching the result, but lets ignore that for now)
[02:01:47] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[02:01:48] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[02:01:48] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14f45e14c to 146eae7df: 02http://git.io/N3iJvQ
[02:01:48] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[02:01:51] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[02:01:51] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/NfaZiQ
[02:01:51] <ghrust> 13rust/06auto 144e00cf6 15Daniel Fagnan: Added new attribute syntax with backward compatibility....
[02:01:51] <ghrust> 13rust/06auto 1484a91b8 15Alex Crichton: syntax: Tidy up parsing the new attribute syntax
[02:01:51] <ghrust> 13rust/06auto 14c6d03e3 15bors: auto merge of #13037 : alexcrichton/rust/attr-syntax, r=brson...
[02:01:53] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[02:01:56] * cmr sighs
[02:02:25] <nrc> creating a vec of vecs and concatenating at the end seems reasonable, but is there a better way?
[02:02:47] <nrc> or is lots of appends actually OK?
[02:02:50] <cmr> yeah it's not bad.
[02:02:53] <cmr> lots of appends is fine
[02:02:56] <cmr> BUT
[02:02:59] <cmr> you should be using Vec::with_capacity
[02:03:07] <cmr> with a reasonable size based on the data...
[02:03:53] <nrc> mmmm, I kind of thought about that, its kind of annoying coming up with a reasonable capacity though :-(
[02:04:02] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[02:04:27] <cmr> Vec is a standard growable dynamically-allocated container. it has a length and a capacity. when the length would exceed the capacity, it realloc's the whole thing, doubling* the capacity. (* actual growth function variable, I think it might even be 1.5*old_cap)
[02:04:56] <cmr> yeah
[02:05:01] <nrc> OK, so using a single vec and appending to it is not too bad, I guess
[02:05:21] <nrc> cmr: do you know what the default initial capacity is?
[02:05:23] *** Quits: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca) (Quit: canhtak)
[02:05:26] <cmr> 4
[02:05:56] <cmr> well, it's 0 until you push to it once, at which point it's 0, iirc.
[02:06:25] <nrc> pah, tiny, insignificant initial capacity, I laugh at your puny attempts to be useful to me
[02:06:39] <cmr> well it's designed to not waste memory
[02:06:52] <cmr> you can always with_capacity a larger amount and then shrink_to_fit ...
[02:07:04] <cmr> but depending on the underlying malloc that might be good or it might be just as bad.
[02:08:01] *** Joins: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca)
[02:11:02] <nrc> fun times
[02:11:09] <nrc> thanks for the help cmr :-)
[02:11:14] <cmr> np
[02:11:36] <cmr> you might also use DList for constant-time appends and merges.
[02:11:48] <cmr> although I don't know if it supports appending one DList to another yet.
[02:13:20] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:15:20] <nrc> cmr: is `vec_ng::append` the best way to append a Vec to another Vec?
[02:15:22] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:15:37] <cmr> nooo
[02:15:43] <nrc> good
[02:15:45] <sfackler> nrc: extend
[02:15:59] <cmr> extend is alright.
[02:16:17] <cmr> since you have a vector of vectors you could use flat_map on iterators and then .collect them, I belive.
[02:16:20] <cmr> *believe
[02:16:25] <cmr> that should be the fastest.
[02:17:09] <nrc> oh, I was planning on not having the vector of vectors and just extending as I go along
[02:17:24] * sfackler should kill off append
[02:17:24] <nrc> is it significantly faster to .collect ?
[02:17:48] <cmr> it will do less allocation overall, I think.
[02:19:03] *** Joins: lpy (lpy@1834E2CB.F09091A8.1348A864.IP)
[02:19:08] <cmr> .extend will be reallocating a bunch until the capacity is huge
[02:19:19] <cmr> .collect will allocate exactly once the capacity needed
[02:24:23] *** Quits: lpy (lpy@1834E2CB.F09091A8.1348A864.IP) (Client exited)
[02:30:06] <nrc>         let mut result: Vec<@Vec<@field_ty>> = vec!();
[02:30:08] <nrc>         ...
[02:30:09] <nrc>         result.iter().flat_map(|&x| x.iter()).collect()
[02:30:13] <nrc> this ^ does not work
[02:30:28] <nrc> error: expected std::iter::FromIterator<&@middle::ty::field_ty>, but found std::iter::FromIterator<@middle::ty::field_ty> (expected &-ptr but found @-ptr)
[02:30:36] <nrc> this ^ makes me want to cry
[02:31:13] <cmr> result.move_iter().flat_map(|&x| x.move_iter()).collect() perhaps?
[02:31:15] <nrc> how do I get an iterator which yields references?
[02:31:27] <cmr> they yield references by default.
[02:31:31] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[02:31:46] <nrc> I thought that!
[02:32:20] <nrc> (the second bit, trying the first suggestion...)
[02:33:27] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[02:35:14] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:36:58] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:38:37] *** Joins: lpy (lpy@1834E2CB.F09091A8.1348A864.IP)
[02:44:07] <nrc> error: cannot move out of dereference of `@`-pointer
[02:44:08] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:44:26] <cmr> it's a Vec<@BigThing> right?
[02:44:42] <nrc> yeah
[02:44:54] <cmr> hm
[02:45:00] <cmr> I need to sleep unfortunately :(
[02:46:31] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:48:30] <nrc> :-(
[02:49:23] <nrc> it seems I want a Vec<Vec<@field_ty>>, but I have @Vec<@field_ty> to push into it
[02:49:29] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[02:49:43] <nrc> and I can't dereference a @ptr
[02:50:10] <nrc> which makes me sad
[02:52:04] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[02:53:59] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[02:56:20] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:58:40] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:01:57] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[03:01:57] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14c6d03e3 to 146eae7df: 02http://git.io/N3iJvQ
[03:01:57] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[03:02:55] *** Quits: lpy (lpy@1834E2CB.F09091A8.1348A864.IP) (Client exited)
[03:18:27] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:20:28] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:20:28] *** Quits: cgaebel (clark@moz-F9D89110.nyc.res.rr.com) (Ping timeout)
[03:37:51] <aatch> Come on librustc, build faster!
[03:40:06] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:43:16] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:45:03] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[03:45:26] *** Quits: japaric (japaric@5264F756.A8CC9503.F29ED47E.IP) (Quit: WeeChat 0.4.3)
[03:49:54] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[03:51:14] *** Joins: zimbabao (rajaram@5B5995E.F4ABEA.BE4CF869.IP)
[03:54:43] *** Quits: zz_kimundi (kimundi@moz-B62309E6.dip0.t-ipconnect.de) (Ping timeout)
[03:58:29] *** Joins: zz_kimundi (kimundi@moz-D07AE760.dip0.t-ipconnect.de)
[03:58:31] *** zz_kimundi is now known as kimundi
[04:01:30] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:03:52] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:11:48] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[04:11:48] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14ca46579 to 146eae7df: 02http://git.io/N3iJvQ
[04:11:48] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[04:11:49] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[04:11:49] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/y9_x0A
[04:11:49] <ghrust> 13rust/06auto 144e00cf6 15Daniel Fagnan: Added new attribute syntax with backward compatibility....
[04:11:49] <ghrust> 13rust/06auto 1484a91b8 15Alex Crichton: syntax: Tidy up parsing the new attribute syntax
[04:11:49] <ghrust> 13rust/06auto 14739f22f 15bors: auto merge of #13037 : alexcrichton/rust/attr-syntax, r=brson...
[04:11:51] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[04:14:21] *** Joins: japaric (japaric@5264F756.A8CC9503.F29ED47E.IP)
[04:20:03] <erickt> woo first rfc submitted: https://github.com/rust-lang/rfcs/pull/17
[04:23:52] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:24:20] *** Quits: japaric (japaric@5264F756.A8CC9503.F29ED47E.IP) (Quit: WeeChat 0.4.3)
[04:25:34] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:26:46] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[04:32:29] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[04:32:37] *** Quits: zimbabao (rajaram@5B5995E.F4ABEA.BE4CF869.IP) (Ping timeout)
[04:32:58] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[04:34:19] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[04:37:58] *** Joins: lpy (lpy@E44EE2C4.F09091A8.1348A864.IP)
[04:44:27] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:46:46] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:53:15] *** Quits: lpy (lpy@E44EE2C4.F09091A8.1348A864.IP) (Ping timeout)
[04:57:49] *** Joins: lpy (lpy@E44EE2C4.F09091A8.1348A864.IP)
[04:57:49] <aatch> Is it bad that I'm implementing my RFC before it's been approved?
[04:58:17] <mcpherrin> aatch: no, probably not
[05:01:47] <nrc> which RFC?
[05:02:05] <aatch> the SIMD one
[05:02:50] <nrc> oh  right, yeah, I doubt anything other than the syntax is too controversial, and that should be easy enough to change once consesus is reached
[05:06:43] *** Quits: jld (jld@moz-B94C75AD.xlerb.net) (Ping timeout)
[05:07:13] *** Quits: aatch (James@moz-B437F499.pocketrent.com) (Client exited)
[05:08:06] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 31.0a1/20140319030201])
[05:10:34] *** Quits: canhtak (canhtak@moz-2C382DC9.wl.t.ulaval.ca) (Quit: canhtak)
[05:12:39] *** Joins: jld (jld@moz-B94C75AD.xlerb.net)
[05:18:59] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[05:19:14] *** Joins: japaric (japaric@5264F756.A8CC9503.F29ED47E.IP)
[05:19:20] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[05:21:03] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[05:21:51] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[05:21:51] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/y9_x0A
[05:21:51] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[05:26:47] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[05:26:47] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/-BZopQ
[05:26:47] <ghrust> 13rust/06auto 14fd935f8 15Huon Wilson: syntax: allow `trace_macros!` and `log_syntax!` in item position....
[05:26:47] <ghrust> 13rust/06auto 14aeb6b75 15bors: auto merge of #12998 : huonw/rust/log_syntax, r=alexcrichton...
[05:26:47] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[05:26:48] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[05:26:48] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/2xMitA
[05:26:48] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[05:28:19] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:30:40] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:33:42] *** Quits: gwty (gwtypc@123D3329.2908BEAF.25B273F5.IP) (Ping timeout)
[05:35:14] *** Joins: gwty (gwtypc@4B5CCF07.AA3AB44C.F44414AF.IP)
[05:35:17] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[05:44:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:46:26] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:50:01] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:52:20] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:56:04] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[05:58:02] *** Joins: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP)
[05:58:39] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[05:58:40] *** ChanServ sets mode: +ao pcwalton pcwalton
[05:59:27] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[06:06:03] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[06:06:47] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[06:06:47] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14aeb6b75 to 14739f22f: 02http://git.io/N3iJvQ
[06:06:47] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[06:12:11] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:14:10] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:15:43] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[06:18:37] *** Joins: aatch (aatch@moz-2BB0AC01.cable.telstraclear.net)
[06:28:10] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[06:29:14] *** Joins: edwardw (edwardw@FF419987.E8120A68.7E4FEB66.IP)
[06:33:25] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[06:35:15] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[06:39:39] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Quit: TheHydroImpulse)
[06:41:15] <eddyb> https://github.com/mozilla/rust/pull/11410 61 commits, wow
[06:41:52] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[06:41:52] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/eXjVKg
[06:41:52] <ghrust> 13rust/06auto 14e27c954 15Alex Crichton: rustdoc: Fix file locking on windows...
[06:41:52] <ghrust> 13rust/06auto 147379516 15bors: auto merge of #13043 : alexcrichton/rust/fix-rustdoc-windows, r=brson...
[06:41:52] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[06:44:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:46:26] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:49:24] <aatch> heh, I've got a ~10 line LLVM IR function that compiles down to a single x86 instruction.
[06:50:05] <eddyb> aatch: do share
[06:51:09] <aatch> eddyb, https://gist.github.com/Aatch/909a7d9a7a09a7532215
[06:51:30] <aatch> just testing out the SIMD support I've done so far.
[06:52:12] <eddyb> that morestack is sad
[06:52:31] <aatch> movups is "Move unaligned packed single-precision floating-point values"
[06:52:37] <eddyb> there is no stack used, shouldn't it just be removed?
[06:53:24] <aatch> eddyb, probably, but that's LLVM's problem.
[06:53:31] <eddyb> aatch: I guess it makes more sense in the DAG
[06:53:51] <aatch> I guess they expect that such a function would be inlined.
[06:54:13] <aatch> Since all it does is take a [i32,..4] and return an simd![i32,..4]
[06:54:17] <eddyb> because there you have [v[0], v[1], v[2], v[3]] and that should be simple enough to select a move instruction for
[06:54:33] <eddyb> aatch: have you implemented simd![...] :D:D?
[06:54:43] <aatch> eddyb, I have.
[06:54:49] <eddyb> but not for types, right?
[06:54:57] <aatch> eddyb, for types too.
[06:54:58] <eddyb> (since we can't put macros in types yet)
[06:55:04] <eddyb> aatch: wait, what, how?
[06:55:10] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:55:15] <aatch> I just made it parse simd![T,..n] specifically
[06:55:23] <aatch> It's a big 'ol hack
[06:55:25] <eddyb> aww that won't get merged :/
[06:55:33] <eddyb> aatch: but we do want type macros
[06:55:43] <aatch> eddyb, yeah, but it allows me to keep implementing in the meantime.
[06:56:00] <eddyb> it's worth having an ast::Ty variant and expand it like any other macro
[06:56:01] <aatch> altering syntax is easy
[06:56:15] <eddyb> aatch: I'd like the macro handling nonsense to be done differently
[06:56:31] <eddyb> it should be exclusively on-demand
[06:56:49] <aatch> eddyb, I look into it, *technically* possible but way more work than I'm willing to put in.
[06:57:34] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:57:36] <eddyb> there is a MacroResult variant holding a trait object, for on-demand, that's what we should use exclusively, IMO
[06:58:14] <eddyb> or rather, use a trait object to request the appropriate type of result, in the first place
[07:05:07] <eddyb> why do we get 3 resolve errors for each unresolved path?
[07:06:48] <aatch> eddyb, because we don't track the errors properly and get knock-on errors.
[07:11:49] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[07:11:49] <ghrust> [13rust] 15bors 04force-pushed 06auto from 147379516 to 14739f22f: 02http://git.io/N3iJvQ
[07:11:49] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[07:12:22] <eddyb> acrichto: did your fix just bounce :(?
[07:12:33] *** Quits: lpy (lpy@E44EE2C4.F09091A8.1348A864.IP) (Client exited)
[07:12:37] <acrichto> everything is bouncing :\
[07:12:55] <eddyb> bors: stop bouncing, guy!
[07:15:41] <eddyb> acrichto: thanks for removing .get() :D (I see that PR fails in travis in an Rc test, hmm)
[07:15:54] <acrichto> it's some other bug in deref
[07:15:59] <eddyb> :(
[07:16:17] <acrichto> https://github.com/alexcrichton/rust/blob/removing-ref-cell-get/src/libstd/rc.rs#L96
[07:16:23] <acrichto> I changed that line to &*self
[07:16:29] <acrichto> and the tests failed horribly
[07:17:14] <eddyb> acrichto: isn't that line supposed to be self.ptr?
[07:17:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:17:23] <eddyb> wait, no, nvm
[07:17:39] <acrichto> oh wait
[07:17:41] <acrichto> I got it wrong
[07:17:45] <acrichto> &*self == Rc<T>
[07:17:45] <acrichto> not T
[07:17:48] <acrichto> oops
[07:17:49] <eddyb> haha
[07:17:56] <acrichto> I wnated &**self
[07:17:57] <acrichto> carry on!
[07:18:22] <eddyb> acrichto: that still doesn't absolve me of my other sins :P
[07:18:36] <aatch> ok, lets see if indexing simd vectors will work.
[07:18:38] <acrichto> autoderef is so beautiful though!
[07:18:50] <eddyb> I'll fix up this Datum business and start fiddling with ast::P, I guess. there's 3 designs that I want to support in parallel
[07:18:57] <eddyb> and whichever performs best, wins
[07:19:21] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:24:43] <aatch> nice, the llvm optimizer can turn simd![v[0], v[2], v[1], v[4]] (where v is another vector) into a single shuffle instruction
[07:25:18] <eddyb> I wouldn't expect any less :P
[07:25:38] <aatch> At least I'm not putting out completely terrible IR then :D
[07:25:52] <eddyb> then v.xzy can be sugar for simd![v[0], v[2], v[1]]
[07:26:04] <aatch> eddyb, that's the idea
[07:26:31] <aatch> well, I can probably just output the shuffle directly..
[07:26:33] <eddyb> aatch: you have ExprSimd and ty_simd, right?
[07:26:40] <aatch> eddyb, yep
[07:26:59] <aatch> and ExprSimdRepeat for simd![expr,..n]
[07:27:11] *** Joins: huon_ (huon_@moz-A701AF29.pa.nsw.optusnet.com.au)
[07:28:01] <huon_> aatch: btw, have you seen that gabor has a pr for macro![] syntax?
[07:28:20] <eddyb> oh, right, not merged yet
[07:28:22] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[07:28:28] <eddyb> aatch should at least rebase on top of that :P
[07:28:31] <aatch> huon_, I have not.
[07:28:43] <aatch> I assume it's almost exactly the same changes that I made.
[07:28:48] <aatch> bbl, dinner
[07:28:54] <huon_> i would link you, but im on my phone
[07:28:56] *** aatch is now known as aatch|food
[07:28:58] <huon_> yeah i guess so
[07:30:40] *** Quits: huon_ (huon_@moz-A701AF29.pa.nsw.optusnet.com.au) (Client exited)
[07:37:59] *** Joins: lpy (lpy@2B87A1BA.DFA2C7B3.8C13C571.IP)
[07:38:31] *** aatch|food is now known as aatch
[07:38:56] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:41:04] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:44:07] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:46:26] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:53:50] *** Joins: sigma (sigma@moz-55097A0B.range86-163.btcentralplus.com)
[07:58:59] *** Quits: edwardw (edwardw@FF419987.E8120A68.7E4FEB66.IP) (Quit: Leaving...)
[08:00:14] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:01:50] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[08:01:52] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[08:01:52] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14d7a2108 to 14739f22f: 02http://git.io/N3iJvQ
[08:01:52] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[08:02:35] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:07:53] *** flaper87|afk is now known as flaper87
[08:12:57] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[08:13:17] *** Joins: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP)
[08:16:18] *** Joins: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net)
[08:16:18] *** ChanServ sets mode: +o huon
[08:21:05] <aatch> man, using llvm vectors instead of ordinary arrays allows LLVM to produce waay better code.
[08:22:14] <eddyb> aatch: that sounds problematic
[08:22:25] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:22:27] <eddyb> as in, we might be handling our generic arrays/vectors wrong
[08:23:12] <aatch> eddyb, I don't think so. I'm taking a couple shortcuts here and there because I know that simd vectors only contain primitive types.
[08:23:38] <aatch> But otherwise, it's almost identical code to fixed vectors
[08:24:22] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:26:06] <huon> aatch: https://github.com/mozilla/rust/pull/12947 btw
[08:26:17] <huon> is the link, now that I have a proper web browser
[08:26:59] * eddyb has the vague feeling he's coordinating some of other people's actions
[08:27:29] <aatch> huon, ah, ok, so done better than what I did.
[08:27:53] <aatch> I was lazy and just added LBRACKET in various places.
[08:28:27] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[08:28:46] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[08:29:27] <huon> eddyb: why?
[08:29:44] <eddyb> huon: did I say anything :)?
[08:29:55] <aatch> but anyway, cross product on a vector of doubles: SIMD - 7 instructions, fixed-size vector - 19 instructions
[08:29:57] <eddyb> huon: now go back to work :P
[08:30:21] <eddyb> aatch: hmpf, that may be just LLVM representing those differently
[08:30:27] <eddyb> aatch: can we see IR for both?
[08:30:55] <aatch> eddyb, sure, I'm 99% sure that it's because LLVM can optimize to a shuffle for one and not the other.
[08:31:46] <aatch> https://gist.github.com/Aatch/10847d4481d93087ab7d
[08:32:21] <huon> shuffles++
[08:32:40] <huon> aatch: is that with --opt-level=3
[08:32:41] <huon> ?
[08:32:59] <eddyb> GEPi is probably causing issues here
[08:33:02] <aatch> huon, no, just tried with that, it's a little better, but not much
[08:33:21] <aatch> eddyb, I'm emitting GEPi for the simd vectors too though
[08:33:25] <huon> aatch: what about in a loop, where LLVM's vectorisors kick in?
[08:33:26] <eddyb> aatch: update gist pls (and you can run c++filter on it to make the symbols readable)
[08:33:29] <aatch> they're just getting optimized out.
[08:33:36] <huon> *autovectorizers
[08:33:57] <huon> eddyb: you can't read the "simd_cross" and "serial_cross" in the name?
[08:34:01] <aatch> huon, it does a little vectorizing, but only with <2 x double>
[08:34:14] <eddyb> huon: all I see is _ZNOIZE
[08:34:24] <huon> aatch: ah, cool
[08:34:36] <huon> aatch: ... wait... what's the codegen look like?
[08:34:39] <huon> (i.e. asm)
[08:35:28] <eddyb> aatch: how are you doing GEPi on an immediate?
[08:35:32] *** Joins: mrmonday_ (mrmonday@moz-1E82AE75.members.linode.com)
[08:35:40] <eddyb> those aren't pointers to vectors, they're vectors
[08:36:01] <aatch> eddyb, because GEPi isn't limited to vectors.
[08:36:05] <aatch> I mean pointers
[08:36:20] <eddyb> it kinda is
[08:36:43] <aatch> eddyb, not really... look at the LLVM IR reference
[08:36:43] <eddyb> if you have an aggregate and do GEPi on it, you're likely putting it in an alloca and doing GEPi on that
[08:36:45] <huon> aatch: I'm thinking that the 3 x double vector will turn into asm that's essentially equivalent to the 2x double vector code?
[08:36:56] <huon> unless you compile with the thing that makes it use the wider simd registeres
[08:36:58] <eddyb> it's extractvalue for aggregates
[08:37:23] <aatch> eddyb, it works though.
[08:37:31] <eddyb> aatch: see what I wrote above
[08:37:38] <huon> aatch: eddyb wants to look at the pre optimisation IR...
[08:37:44] <huon> even if he's not saying as much :P
[08:37:57] <eddyb> aatch: rustc -C save-temps and disassemble the resulting no-opt.bc file
[08:38:05] <eddyb> huon: I was looking for the right flag :P
[08:38:10] <huon> eddyb: why not --emit=ir?
[08:38:19] <eddyb> huon: because that's optimized
[08:38:21] <aatch> can't I just not pass -O ?
[08:38:21] <huon> without an -O
[08:38:29] <eddyb> unless... we have a flag for no-opt
[08:38:34] <eddyb> huon: that's optimized
[08:38:44] <huon> eddyb: *without* -O
[08:38:45] <eddyb> -O0 runs a few optimization passes
[08:38:54] <eddyb> or --opt-level=0 I should say
[08:38:56] <huon> such as?
[08:39:09] *** Quits: mrmonday_ (mrmonday@moz-1E82AE75.members.linode.com) (Input/output error)
[08:39:09] <eddyb> do I have to dump its structure?
[08:39:27] <huon> yup
[08:39:40] <aatch> it does a few optimizations, nothing really relevant though.
[08:39:54] <eddyb> aatch: I don't trust it :S
[08:40:18] <huon> ah, -Z print-llvm-passes shows them
[08:40:39] * flaper87 reads and learns
[08:40:47] * flaper87 says hi too :)
[08:41:14] <eddyb> why does it do inline cost analysis if it only inlines always_inline functions?
[08:41:16] <aatch> eddyb, I do have pointers here for the GEPi
[08:41:31] <eddyb> told you
[08:41:32] <aatch> You appear to be correct that you need a pointer for GEP
[08:41:47] <eddyb> we do unholy things when we need pointers
[08:41:51] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[08:41:51] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/q3rh2g
[08:41:51] <ghrust> 13rust/06auto 149b77517 15Brian Anderson: mk: Simplify how prepare.mk, install.mk, and dist.mk deal with stages...
[08:41:51] <ghrust> 13rust/06auto 14a55dd4a 15bors: auto merge of #13024 : brson/rust/issue-12799, r=thestinger...
[08:41:51] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[08:41:52] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[08:41:52] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14ec32537 to 14739f22f: 02http://git.io/N3iJvQ
[08:41:52] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[08:41:56] <eddyb> and never actually construct agreggates as values
[08:42:05] *** Joins: mrmonday_ (mrmonday@moz-1E82AE75.members.linode.com)
[08:42:06] <eddyb> it's one of the things I want to work on
[08:42:28] <aatch> I wanted to use extractelement, and insertelement, but the current infrastructure makes that really hard.
[08:42:37] <eddyb> don't bother, I'd say
[08:42:57] <strcat> aatch: make all simd types immediate if they're not already
[08:43:05] <eddyb> if you're using similar primitives, it will get fixed along with everything else
[08:43:08] <aatch> strcat, they already are.
[08:43:32] <eddyb> aatch: what happens is that your GEPi's are easily convertable to extractvalue
[08:43:52] <eddyb> if you make [3 x double] immediate (as a test), you might get a similar bonus there
[08:44:20] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:46:25] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:50:30] <eddyb> aatch: so what does the unoptimize code look like?
[08:50:41] <aatch> eddyb, huge.
[08:50:46] <aatch> Full of bounds checks
[08:50:49] <eddyb> haha
[08:51:01] <eddyb> we should elide the simple ones ourselves
[08:51:08] <aatch> I was thinking that.
[08:52:18] <eddyb> instead of having llvm replace icmp 3, 3 with false and then remove an unreachable branch
[08:52:32] <eddyb> (icmp gt?)
[08:52:41] <aatch> gte
[08:54:57] <strcat> rust needs computed gotos ;p
[08:55:23] <eddyb> why? they don't feel safe?
[08:55:28] <eddyb> s/?$//
[08:55:45] <strcat> well ofc they'd be unsafe
[08:55:56] <eddyb> can't you use inline assembly then?
[08:56:03] <eddyb> I guess LLVM IR would be preferred
[08:56:04] <strcat> eddyb: not platform independent
[08:56:11] <strcat> and doesn't integrate with rust code well
[08:56:11] <eddyb> we need that llvm! macro
[08:56:17] <strcat> LLVM IR wouldn't be platform independent either
[08:56:40] <eddyb> unsafe {continue *ptr;}?
[08:56:59] <strcat> eddyb: also need to be able to take the address of a block/label
[08:57:31] <eddyb> as long as you make the "goto" unsafe, I don't have that big of a problem
[08:58:20] <eddyb> I guess you'd need an unsized/uninhabited lang item so you can have a *Code pointer
[08:58:26] <eddyb> though "Code" is too vague
[08:58:48] *** Quits: mrmonday_ (mrmonday@moz-1E82AE75.members.linode.com) (Quit: Lost terminal)
[09:18:52] *** Joins: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[09:21:52] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[09:21:52] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14a55dd4a to 14739f22f: 02http://git.io/N3iJvQ
[09:21:52] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[09:21:56] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[09:21:56] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/iFtt-g
[09:21:56] <ghrust> 13rust/06auto 143c4edff 15Flavio Percoco: Let travis check docs for stage1
[09:21:56] <ghrust> 13rust/06auto 14caf17fe 15bors: auto merge of #13029 : FlaPer87/rust/master, r=alexcrichton...
[09:21:57] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[09:23:33] <aatch> eddyb, goddamit, you made me shave a yak...
[09:23:42] <eddyb> what did you do?
[09:24:35] <aatch> I made with_cond check for a constant condition
[09:25:01] <eddyb> lovely :D
[09:25:14] <eddyb> aatch: does it make an impact on rustc-stage2?
[09:25:22] <aatch> eddyb, no idea, compiling now.
[09:25:39] <aatch> and I don't really have the ability to test properly.
[09:26:49] <aatch> apparently I can't logic this evening.
[09:27:04] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:27:55] <aatch> if IsConstant returns 0, that's false, so doing let is_constant = LLVMIsConstant == 0; is not the answer I want...
[09:28:00] * aatch headdesks
[09:28:23] <eddyb> aatch: is the comparison constant though?
[09:28:34] <eddyb> the result thereof, I mean
[09:28:51] <aatch> eddyb, LLVM constant folds as it goes along
[09:29:01] <eddyb> *does it*? that's what I'm asking
[09:29:11] <eddyb> maybe I'm remembering wrong
[09:29:14] <aatch> eddyb, it does.
[09:29:30] <eddyb> that will make a few things easy
[09:29:30] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:29:41] <eddyb> aatch: match x {x => x} does a needless branch btw
[09:29:49] <eddyb> but that's probably _match being old and rusty
[09:30:03] <eddyb> (needs a minor rewrite anyways)
[09:31:52] <aatch> eddyb, well I managed to every branch from the --opt-level 0 IR of simd_cross
[09:32:09] <eddyb> what does that look like, now
[09:32:22] <eddyb> aatch: you managed to accidentally?
[09:32:32] <aatch> eddyb, well I expected to.
[09:32:43] <aatch> It's just not really relevant to SIMD support...
[09:32:50] <eddyb> aatch: read that line again :P
[09:33:01] <aatch> ahh...
[09:33:10] <aatch> I managed to *eliminate* every branch
[09:33:17] <aatch> It's been a long day, apparently.
[09:34:04] <huon> aatch: branches are just overhead
[09:34:23] <huon> and branch prediction failures are *killers*
[09:34:27] <huon> might as well remove them
[09:34:38] <eddyb> I think LLVM might need jump threading to eliminate those. not having them at -O0 is nice
[09:35:13] <aatch> They do get eliminated with optimizations.
[09:35:44] <strcat> aatch: --opt-level=0/--opt-level=1 perf does matter
[09:35:49] <strcat> as does compile-time ;p
[09:36:01] <aatch> strcat, I was about to say that >.>
[09:36:04] <huon> Yurume: by "copy attributes" you mean "copy attributes onto impls", right? ( in https://github.com/mozilla/rust/issues/13054 )
[09:40:44] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:44:04] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:45:26] <aatch> man, my DNS is being weird.
[09:45:46] <aatch> It seems to fail for the first lookup almost every time.
[09:45:56] <aatch> After that though, it's fine.
[09:46:22] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:48:50] <eddyb> "match arms have incompatible types:" this is such a bad error
[09:49:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:49:19] <eddyb> I'm still staring at the code and I can't find the mismatch
[09:49:40] <huon> replace arms with fail!() until they stop mismatching
[09:49:54] *** Quits: lpy (lpy@2B87A1BA.DFA2C7B3.8C13C571.IP) (Client exited)
[09:50:20] <huon> (it'd be really nice if the compiler pointed to the arms in those cases...)
[09:51:20] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:56:06] <kimundi> Urg - trying to prototype `Iterable` makes me believe we need a DSL just for implementing everything for the final result
[09:57:01] <eddyb> kimundi: you heard my rambling about a generator-compatible Iterator?
[09:57:19] <kimundi> I heard no recent rambling of any kind
[09:57:20] <eddyb> there's still a few issues I don't know how to deal with, at least in the context of a for loop
[09:57:46] <eddyb> kimundi: next taking a value and returning Result<T, ThatValue>
[09:57:46] <kimundi> Like what?
[09:58:04] <kimundi> Why?
[09:58:18] <Yurume> huon: yes. (sorry for late response)
[09:58:40] <kimundi> eddyb: what does switching to Result give us?
[09:59:00] <eddyb> kimundi: that's just to not drop the value when it would usually return None
[09:59:24] <eddyb> I'd like to fold with a for loop
[10:01:21] <eddyb> something like let r = iter.fold(init, |prev, x|, prev + x); => let r = for (prev, x) in iter.fold(init) {prev + x};
[10:02:28] <eddyb> you can probably see one of the issues already, .next() gets called before the for loop's block, but I get a value only afterwards
[10:05:31] <eddyb> kimundi: it's weird, because then folding doesn't need to keep a state
[10:07:03] <eddyb> fn next(&mut self, prev: State) -> Result<(State, T), State> {match self.inner.next() {Ok(v) => Ok((prev, v)), Err(()) => Err(prev)}}
[10:08:09] <eddyb> kimundi: anyways, the main idea is to allow feeding values *into* the iterator, to support generators (even manual ones)
[10:08:51] <eddyb> wait, can't generators do something similar to the IO monad?
[10:09:05] <eddyb> I guess it wouldn't be polymorphic
[10:11:02] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:11:38] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[10:13:01] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:17:24] *** Joins: gimpf (gimpf@moz-CAA3F4E7.adsl.highway.telekom.at)
[10:31:22] <cmr> using rustc is such a pleasure these days.
[10:31:32] <cmr> useful type errors, lifetime errors that make sense
[10:31:38] <cmr> no ICEs when you look the wrong way
[10:31:51] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[10:31:51] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/iFtt-g
[10:31:51] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[10:31:54] <eddyb> cmr: I sense more
[10:32:01] <cmr> hm?
[10:32:47] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:34:03] <eddyb> huon: aww real failure http://buildbot.rust-lang.org/builders/auto-linux-64-nopt-t/builds/3985/steps/test/logs/stdio
[10:34:41] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:36:49] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[10:36:50] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/asrijw
[10:36:50] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[10:36:51] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[10:36:51] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/r7EbTA
[10:36:51] <ghrust> 13rust/06auto 1496ae60c 15Liigo Zhuang: rename `test::BenchHarness` to `test::Bencher`...
[10:36:51] <ghrust> 13rust/06auto 1470a83af 15bors: auto merge of #13030 : liigo/rust/rename-benchharness, r=alexcrichton...
[10:36:52] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[10:44:08] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:45:09] <eddyb> "4096 loose objects"
[10:45:18] <eddyb> thank you, 2048
[10:46:29] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:49:45] <huon> eddyb: fix it now
[10:49:47] <huon> erm
[10:49:51] <huon> *fixing it now
[10:49:53] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[10:50:01] * huon commands eddyb to do his bidding!
[10:50:13] * eddyb reflects
[10:53:55] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:55:59] *** Quits: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP) (Ping timeout)
[10:56:18] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:14:40] <eddyb> https://travis-ci.org/mozilla/rust/jobs/21243592
[11:14:46] <eddyb> huon: ^^ any ideas?
[11:15:01] <eddyb> looks... unrelated
[11:16:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:16:41] <huon> weird
[11:16:44] <huon> "failed to print diagnostics: resource temporarily unavailable (Resource temporarily unavailable)"
[11:16:51] <huon> probably just a travis limit
[11:17:29] <eddyb> now I have to implement all the traits *sigh*
[11:17:51] <eddyb> I wish we had a deriving-via-Deref thing
[11:18:03] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:27:02] *** Joins: canhtak (canhtak@moz-805AE185.wl.t.ulaval.ca)
[11:31:50] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[11:31:50] <ghrust> [13rust] 15bors 04force-pushed 06auto from 1470a83af to 14caf17fe: 02http://git.io/N3iJvQ
[11:31:50] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[11:31:51] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[11:31:51] <ghrust> [13rust] 15bors pushed 6 new commits to 06auto: 02http://git.io/5bDTZw
[11:31:51] <ghrust> 13rust/06auto 14f3fef9a 15Brian Anderson: std: Make atomics immutable. #11583...
[11:31:51] <ghrust> 13rust/06auto 14eb25c42 15Brian Anderson: std: Make the generic atomics take unsafe pointers...
[11:31:52] <ghrust> 13rust/06auto 148748322 15Brian Anderson: std: Make the generic atomics in `sync::atomics` private...
[11:31:54] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[11:35:27] <eddyb> strcat: so many &* everywhere :/
[11:36:01] <eddyb> strcat: should Rc<T> -> &T work, when passing as an argument? (just like ~T -> &T works)
[11:36:21] <strcat> no
[11:36:25] <strcat> unless T -> &T works
[11:36:30] <strcat> requires RFC, if you want it
[11:36:33] <eddyb> right
[11:37:01] <eddyb> strcat: well, I have an effective solution :P
[11:37:07] <eddyb> make loads of code ugly with &*
[11:37:39] <eddyb> then I won't have to convince anyone how bad it is
[11:38:44] <eddyb> strcat: &** even
[11:38:56] <eddyb> yeah this will do just fine >:))
[11:41:21] <eddyb> strcat: a Foo(box ref foo) pattern would be nice
[11:41:39] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[11:41:42] <eddyb> since I have to ref this stuff anyways
[11:44:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:44:09] <huon> box mut ref mut foo
[11:44:18] <huon> all the keywords \o/
[11:46:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:54:21] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[11:54:21] <ghrust> [13rust] 15huonw 04force-pushed 06try from 14048726c to 148d39c58: 02http://git.io/k471pw
[11:54:21] <ghrust> 13rust/06try 1422a88e3 15Patrick Walton: libstd: Add some methods to `Vec<T>`.
[11:54:21] <ghrust> 13rust/06try 14cd5c6f8 15Patrick Walton: test: Automatically remove all `~[T]` from tests.
[11:54:22] <ghrust> 13rust/06try 14acb26e5 15Patrick Walton: test: Make manual changes to deal with the fallout from removal of...
[11:54:24] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[11:59:03] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:59:26] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[11:59:45] <eddyb> huon: I'm seriously considering putting ast::P in libsyntax/lib.rs
[11:59:58] <eddyb> huon: if only so I can read the errors easier
[12:00:06] <huon> eddyb: put it in the prelude
[12:00:27] <eddyb> even util::ptr::Ptr would be waay too long
[12:01:13] <huon> "even"?
[12:01:22] <huon> that's longer than syntax::ast::P
[12:01:23] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:01:26] <huon> well mayb
[12:01:28] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[12:01:29] <huon> e
[12:01:34] * huon hasn't counted
[12:01:37] <eddyb> huon: I mean, I thought it would live in its own module
[12:01:40] <huon> oh
[12:01:45] <huon> syntax::ptr::P ?
[12:02:04] <huon> but... with an arena, everything will be borrowed anyway
[12:02:08] <eddyb> just as short and slightly more readable
[12:02:19] <eddyb> huon: I have doubts that's exactly what we'll have
[12:02:57] <eddyb> but it's easy to mass replace it and/or revert huge chunks of my experiment
[12:10:06] <huon> \o/ devecing passes
[12:11:48] <eddyb> can I disable the expansion site output cruft?
[12:16:56] <huon> nope
[12:17:11] <huon> well, you can edit syntax::diagnostics to ignore it
[12:17:36] <eddyb> env LD_PRELOAD=/usr/lib64/libjemalloc.so.1 make rustc-stage1 RUSTFLAGS="-Z time-passes" -j2 2>| sed 's@^/home/eddy/Projects/rust/src/libsyntax/@@' | sed '/^    .*/d' | sed '/note/d' | sed 's/(expected.*)$//' | sed 's/:[0-9]*: [0-9]*:[0-9]* error://' | less
[12:17:41] <eddyb> I can read errors \o/
[12:18:00] <eddyb> (yes, I know awk can do this, no, I don't want to learn it)
[12:18:58] <huon> eddyb: just compile with M-x compile in emacs, it highlights the errors (and even makes them "clickable") :P
[12:19:47] <eddyb> my kdevelop doesn't look like it knows how to compile/run things anymore
[12:19:55] <eddyb> hmm, I guess a script might work there
[12:21:15] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:21:26] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[12:23:18] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:24:25] <eddyb> huon: external scripts seems to work *sigh*
[12:24:40] <eddyb> huon: I'm an idiot :P
[12:24:52] <eddyb> I could have clicked on errors all this time
[12:34:07] *** Quits: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Ping timeout)
[12:35:46] *** Joins: edwardw (edwardw@2BFF2300.F4429B.7E4FEB66.IP)
[12:35:50] <huon> gah, needs a rebase already? :/
[12:36:14] <eddyb> and I bound the script to F8. this is much better than what I had
[12:37:06] *** Joins: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[12:38:31] <huon> hm, are there any other reviewers around now?
[12:38:42] <huon> cmr, aatch: ping
[12:39:02] <huon> well, r? last 3 commits https://github.com/mozilla/rust/pull/13056
[12:42:09] <edwardw> r? https://github.com/mozilla/rust/pull/12654
[12:44:30] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:46:32] <huon> edwardw: ping me when you've updated that struct construction
[12:46:48] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:47:08] <edwardw> huon: struct construction?
[12:47:17] <huon> edwardw: my comment
[12:47:43] <edwardw> ah ok
[12:50:03] <edwardw> huon: done
[12:51:51] *** Quits: japaric (japaric@5264F756.A8CC9503.F29ED47E.IP) (Ping timeout)
[12:52:37] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[12:53:22] <huon> pnkfelix: r? last 3 commits https://github.com/mozilla/rust/pull/13056
[12:53:26] *** Joins: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP)
[12:54:09] *** Quits: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP) (Quit: WeeChat 0.4.3)
[12:55:04] <eddyb> hmm, I wonder whether we should make the folding more... generic
[12:55:13] <eddyb> but coherence might ruin the party
[12:55:30] <huon> eddyb: sounds like codebloat ;P
[12:55:54] <huon> speaking of which... does anyone remember how graydon measured the sizes of various symbols in librustc?
[12:56:09] <eddyb> rabin2 can give you sizes
[12:56:45] <eddyb> huon: rabin2 -S ./x*/stage1/bin/rustc
[12:56:55] <eddyb> wait, no, those are sections
[12:56:56] <huon> looks like nm can too
[12:57:03] <huon> or maybe that's sections too
[12:57:19] <huon> eddyb: librustc, not the 12 KB rustc binary ;P
[12:57:46] <eddyb> addr=0x00381510 off=0x00381510 ord=4682 fwd=NONE sz=1661 bind=LOCAL type=FUNC name=_ZN17syntax..ast..Lit_10glue_visit17h79de778e05ef08c4E
[12:58:02] <eddyb> sz is the size in bytes
[12:58:53] <eddyb> rabin2 -s ./x*/stage1/lib/librustc-6ccece0c-0.10-pre.so | grep -v except | grep type=FUNC | rustfilt
[12:59:19] <eddyb> huon: save me from all the glue X_X
[13:00:14] <eddyb> addr=0x0094ed80 off=0x0094ed80 ord=9185 fwd=NONE sz=1120 bind=LOCAL type=FUNC name=ebml::reader::Decoder<'doc>.serialize::Decoder::read_enum_variant
[13:00:18] <huon> middle::typeck::check::check_expr_with_unifier and middle::trans::_match::compile_submatch_continue are pparently huge
[13:00:35] <eddyb> grep -Ev 'except|glue|closure' # much better
[13:00:58] <eddyb> huon: I expect the former. the latter sounds like bloat
[13:01:29] <pnkfelix> huon: for PR 13056, probably needs a `, p=1`, right?
[13:01:36] <eddyb> (check_expr_with_unifier is the heart of type checking, almost everything happens there)
[13:02:20] <eddyb> huon: maybe I should have a NoopFold trait
[13:03:15] <eddyb> so you still have the same overloadable metods on Folder, but the noop implementation isn't redundant
[13:03:16] <huon> pnkfelix: that would be nice, yes :)
[13:03:59] *** Joins: zimbabao (rajaram@4D42D14A.690944A8.BE4CF869.IP)
[13:04:29] <eddyb> (if I have two methods, I can add in-place folding even easier)
[13:04:36] <huon> pnkfelix: thanks
[13:04:44] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:04:59] <eddyb> Encodable, Decodable... hmm
[13:05:30] <eddyb> how can I use those to get automatic folding?
[13:05:56] <eddyb> I guess it wouldn't work because then I couldn't specialize it :(
[13:06:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:08:56] *** Joins: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP)
[13:09:13] *** Quits: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP) (Quit: WeeChat 0.4.3)
[13:10:38] *** Joins: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP)
[13:16:04] <huon> http://ix.io/bcA modules in order of contained symbol sizes (unfortunately our symbols don't include the crate names, but the crate is pretty easy to work out in each case)
[13:16:43] <huon> though, I can't guarantee how accurate that is in anyway...
[13:19:26] <eddyb> typeck is huuuge
[13:20:46] *** Quits: canhtak (canhtak@moz-805AE185.wl.t.ulaval.ca) (Quit: canhtak)
[13:26:10] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:28:25] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:34:39] *** Quits: gwty (gwtypc@4B5CCF07.AA3AB44C.F44414AF.IP) (Ping timeout)
[13:36:03] <eddyb> huon: so I spend ten minutes adding &** to fold just to remove it later
[13:36:19] <eddyb> but I do like all methods/functions taking T and returning T
[13:36:49] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[13:36:49] <ghrust> [13rust] 15bors 04force-pushed 06auto from 144dba814 to 14caf17fe: 02http://git.io/N3iJvQ
[13:36:49] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[13:36:50] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[13:36:50] <ghrust> [13rust] 15bors pushed 8 new commits to 06auto: 02http://git.io/tvH2jw
[13:36:50] <ghrust> 13rust/06auto 140b714b4 15Patrick Walton: libstd: Add some methods to `Vec<T>`.
[13:36:50] <ghrust> 13rust/06auto 14579eb24 15Patrick Walton: test: Automatically remove all `~[T]` from tests.
[13:36:50] <ghrust> 13rust/06auto 14af79a5a 15Patrick Walton: test: Make manual changes to deal with the fallout from removal of...
[13:36:52] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[13:39:47] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[13:40:05] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[13:40:57] * huon crosses fingers
[13:41:48] *** Joins: canhtak (canhtak@moz-805AE185.wl.t.ulaval.ca)
[13:42:47] *** Quits: glaebhoer1 (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[13:42:49] *** Joins: ninechars (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[13:42:59] <eddyb> fn fold_opt_bounds<T: Folder>(b: Option<OptVec<TyParamBound>>, folder: &mut T) -> Option<OptVec<TyParamBound>> {
[13:43:02] <eddyb> super-optional
[13:47:38] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:49:58] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:51:59] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[13:52:21] *** Quits: zimbabao (rajaram@4D42D14A.690944A8.BE4CF869.IP) (Ping timeout)
[13:59:36] *** Quits: ninechars (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Connection reset by peer)
[13:59:42] *** Joins: ninechars (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[14:00:59] *** Joins: gwty (gwtypc@8B0C96F5.439CEDBD.F44414AF.IP)
[14:03:03] <eddyb> huon: and OptVec doesn't implement move_iter :S
[14:03:59] <huon> eddyb: opt_vec won't exist soon
[14:04:13] <huon> gah
[14:04:16] <huon> tests failed
[14:04:24] <eddyb> does OwnedSlice implement move_iter?
[14:04:43] <huon> no, but it will be easy to add
[14:04:50] <huon> self.into_vec().move_iter()
[14:04:54] <huon> ... or just use that instead
[14:05:14] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[14:05:47] <eddyb> https://github.com/mozilla/rust/pull/13016/files#diff-84f86a6f88fff08aaad09a0307347577R1 there we go
[14:05:52] <eddyb> huon: should I rebase on top of your PR?
[14:06:51] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[14:06:51] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/NnplmA
[14:06:52] <ghrust> 13rust/06auto 14db5206c 15Edward Wang: Rewrite rc::Rc using cell::Cell...
[14:06:52] <ghrust> 13rust/06auto 14a0f943c 15bors: auto merge of #12654 : edwardw/rust/rc-arc, r=huonw...
[14:06:52] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[14:09:38] <huon> eddyb: maybe?
[14:09:48] <huon> I can't guarantee that it'll land first time thoguh
[14:10:03] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:10:08] *** Joins: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[14:11:46] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:15:07] *** Quits: erickt_ (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Quit: leaving)
[14:25:15] *** Quits: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com) (Quit: I'm sure it's perfectly safe)
[14:29:28] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[14:31:05] *** Joins: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com)
[14:31:20] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:33:33] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:38:31] <pnkfelix> huon: hmm, did I put my r+ on the wrong thing?
[14:38:52] <pnkfelix> huon: or did you force-push a rebase/amend?
[14:39:11] <huon> pnkfelix: amends
[14:44:05] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:46:29] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:49:21] *** Joins: zimbabao (rajaram@4D42D14A.690944A8.BE4CF869.IP)
[14:51:12] <eddyb> "make amends" makes me think of git every freaking time now :/
[14:51:44] <huon> make: *** No rule to make target `amends'.  Stop.
[14:52:03] <eddyb> huon: sometimes I do that IRL. because easy mode
[14:52:07] <eddyb> (and now I'm hungry)
[14:52:48] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:53:45] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[14:54:27] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[14:54:48] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[14:55:13] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:55:16] *** Quits: Zr40 (zr40@EE4BB9F5.926C319A.BE2F4011.IP) (Quit: leaving)
[14:56:31] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[14:59:08] *** Joins: brson (brson@moz-62518563.mtv2.mozilla.com)
[14:59:08] *** ChanServ sets mode: +qo brson brson
[15:04:33] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[15:14:06] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[15:15:00] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:16:57] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:16:59] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[15:16:59] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/NnplmA
[15:16:59] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[15:17:19] <eddyb> huon: too bad that wasn't one of your PRs
[15:17:25] * huon is feeling good about this run
[15:17:43] <huon> it just passed make check here, and that landing doesn't touch anything vector-y
[15:18:34] *** Quits: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP) (Ping timeout)
[15:18:54] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[15:21:51] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[15:21:51] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/id-61g
[15:21:51] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[15:21:54] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[15:21:54] <ghrust> [13rust] 15bors pushed 8 new commits to 06auto: 02http://git.io/GmtulA
[15:21:54] <ghrust> 13rust/06auto 140b714b4 15Patrick Walton: libstd: Add some methods to `Vec<T>`.
[15:21:54] <ghrust> 13rust/06auto 14579eb24 15Patrick Walton: test: Automatically remove all `~[T]` from tests.
[15:21:54] <ghrust> 13rust/06auto 14af79a5a 15Patrick Walton: test: Make manual changes to deal with the fallout from removal of...
[15:21:56] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[15:26:38] <pnkfelix> whoa...
[15:27:09] <pnkfelix> would people be surprised if the "consider using an explicit lifetime parameter ..." message came up non-deterministically?
[15:27:19] <pnkfelix> (on the same input)
[15:27:51] <huon> sounds like a hashmap issue
[15:27:56] * huon would be surprised though
[15:28:45] <eddyb> pnkfelix: the note is before the error, that's what bugs me the most
[15:29:06] <pnkfelix> https://gist.github.com/pnkfelix/9688799
[15:30:32] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[15:30:55] <huon> pnkfelix: weird
[15:30:56] * huon tries
[15:31:21] <eddyb> pnkfelix: wait, non-deterministically how?
[15:31:35] <huon> heh, that's so utterly peculiar
[15:31:39] <eddyb> as in, it only shows up some times?
[15:31:46] <huon> eddyb: there's two rustc invocations in the bottom section
[15:31:59] <huon> giving different output
[15:32:00] <eddyb> of course there is
[15:32:09] <eddyb> huon: I can't read non-highlighted text, obviously
[15:32:14] <kimundi> pnkfelix: Heh, also playing around with Iterables?
[15:32:28] <pnkfelix> kimundi: no, actually, just going through a backlog of bugs related to lifetime s
[15:32:36] <pnkfelix> and one of them had hacked in its own iterable trait
[15:32:43] <huon> eddyb: it took me a while to work out what was going on, don't worry
[15:32:45] <pnkfelix> the actually bug that I want to file here
[15:32:45] <kimundi> ah, okay
[15:32:56] <pnkfelix> is that the suggested signature
[15:33:04] <pnkfelix> has dropped the `'r` formal lifetime
[15:33:08] <huon> is there a good/sane way to mock /dev/urandom on linux?
[15:33:14] <pnkfelix> even though it is still referenced by the suggested signature
[15:33:27] <pnkfelix> but I'm not thrilled that you cannot deterministically reproduce
[15:33:27] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[15:33:46] <eddyb> huon: containers?
[15:34:00] <eddyb> huon: you don't really want to touch it while you're browsing :P
[15:36:36] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:38:15] *** Joins: lpy (lpy@1834E2CB.F09091A8.1348A864.IP)
[15:38:32] *** Quits: ninechars (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[15:38:40] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:44:08] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:46:30] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:55:08] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[15:57:59] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:00:24] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:07:40] <olsonjeffery> anyone know where the formatting/style checks in `make check` are defined? i take it somewhere in /mk .. but not having any luck finding it
[16:07:46] *** Quits: gimpf (gimpf@moz-CAA3F4E7.adsl.highway.telekom.at) (Ping timeout)
[16:08:39] <huon> olsonjeffery: i.e. `make tidy`?
[16:09:02] <brson> tests.mk
[16:09:19] <brson> the script is etc/tidy.py
[16:09:31] <brson> er src/etc/tidy.py
[16:13:04] <brson> DNS should be working again for all bots
[16:19:03] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[16:19:30] <flaper87> brson: was your patch about making atomics imm closed?
[16:19:48] <flaper87> brson: the Share patch landed, it should be possible to complete that work now
[16:20:10] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:20:33] <huon> flaper87: acrichto revived it
[16:20:41] <huon> it just recently ran on the bots (and failed)
[16:21:24] <flaper87> huon: ah damn, I missed that! Thanks 
[16:22:10] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:29:10] <acrichto> huon: \o/ owned vectors
[16:29:28] <huon> \o/
[16:29:32] *** Quits: gwty (gwtypc@8B0C96F5.439CEDBD.F44414AF.IP) (Ping timeout)
[16:29:38] *** Joins: gwty (gwtypc@8B0C96F5.439CEDBD.F44414AF.IP)
[16:30:51] *** Quits: zimbabao (rajaram@4D42D14A.690944A8.BE4CF869.IP) (Ping timeout)
[16:31:46] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Quit: Computer has gone to sleep.)
[16:31:50] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[16:31:50] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/GmtulA
[16:31:50] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[16:32:08] <huon> now that that's landed (and it's 3.30am)...
[16:32:10] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[16:32:11] * huon -> bed
[16:32:19] <eddyb> huon: I don't have time to wait for new-opt-vec to land :(
[16:32:42] * eddyb kicks ADHD. y u waste time, lazy eddyb?
[16:33:51] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[16:33:55] <dmsky> Hi. I'm trying to figure out/fix https://github.com/mozilla/rust/issues/5723 and it looks like i need some help. I've managed to make https://gist.github.com/dmski/9690131 stop compiling (by constraining trait substs in regionck), but https://gist.github.com/dmski/9690105 still compiles with my changes.
[16:34:16] <dmsky> The only difference is that in the former trait X as lifetime param.
[16:35:11] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[16:36:06] <dmsky> So there isn't any region information in trait type in the latter case.
[16:36:31] <dmsky> So, my question is, does anybody have a suggestion on the best way to proceed?
[16:36:51] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[16:36:51] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/mq6xVw
[16:36:51] <ghrust> 13rust/06auto 147785fe1 15Huon Wilson: syntax: make OptVec immutable....
[16:36:51] <ghrust> 13rust/06auto 140384952 15Huon Wilson: syntax: add the OwnedSlice vector wrapper....
[16:36:51] <ghrust> 13rust/06auto 14380232f 15Huon Wilson: Migrate all users of opt_vec to owned_slice, delete opt_vec....
[16:36:53] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[16:38:22] <dmsky> I've tried making UniqTraitStore carry optional region information - does this look like a correct way?
[16:41:17] *** Quits: canhtak (canhtak@moz-805AE185.wl.t.ulaval.ca) (Quit: canhtak)
[16:41:48] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:43:50] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:43:59] <dmsky> This caused llvm assertion failures compiling librustuv though.
[16:45:31] *** Joins: canhtak (canhtak@moz-805AE185.wl.t.ulaval.ca)
[16:45:42] <brson> acrichto: going to start another snap to finish the attribute syntax change
[16:45:59] <acrichto> brson: ok, I was hoping to get atomics in, but no need to wait
[16:46:06] <brson> acrichto: oh, how close is that?
[16:46:13] <acrichto> not very :(
[16:46:18] <acrichto> 3rd in the queue
[16:46:19] <brson> aw, what's wrong now?
[16:46:24] <brson> oh, i see
[16:46:27] <acrichto> oh just bors flakiness
[16:46:28] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[16:46:32] <acrichto> lots of flakiness recently :\
[16:46:39] <brson> new flakiness? why?
[16:46:50] <acrichto> some of it is on windows
[16:46:52] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[16:46:53] <ghrust> [13rust] 15brson merged 06master into 06snap-stage3: 02http://git.io/SuAQhg
[16:46:53] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[16:47:04] <acrichto> the windows rustdoc thing is cropping up b/c of -j2 (but it's a legit bug)
[16:47:14] <acrichto> I've seen lots of other random things as well 
[16:47:19] <acrichto> osx is deadlocking in rustdoc tests
[16:47:28] <acrichto> linux sometimes fails for conflicts on networking
[16:47:29] <brson> should i turn off -j2?
[16:47:39] <acrichto> nah I like having it on
[16:47:45] <brson> is it faster?
[16:47:49] <brson> i haven't checked
[16:47:49] <acrichto> oh I should check that
[16:47:58] <brson> it may be too late to check now
[16:48:41] <brson> i can't see any builds from before -j2
[16:49:01] <acrichto> http://buildbot.rust-lang.org/builders/auto-linux-32-nopt-c/builds/3896
[16:49:03] <acrichto> http://buildbot.rust-lang.org/builders/auto-linux-32-nopt-c/builds/3988
[16:49:07] <acrichto> before/after
[16:49:15] <acrichto> sped up by 4 minutes
[16:49:29] <brson> ok. well that's something
[16:49:32] <acrichto> lol
[16:50:28] <brson> the networking thing sucks, do you know what the deal is? are the port number hacks we've got just bitrotted?
[16:50:28] * pnkfelix read `-j2` as `-j32` at firt
[16:50:48] * pnkfelix thought to himself "holy cow is that actually profitable on cloud machines?"
[16:50:51] <acrichto> brson: oh I keep meaning to go check that
[16:50:53] <acrichto> let me find that build
[16:51:41] <acrichto> brson: also the same child stderr fd being closed
[16:51:44] <acrichto> (as more flakiness)
[16:51:55] <acrichto> I'm reached out to bnoordhuis with more details
[16:52:00] <brson> that's the same old problem we've had  forever?
[16:52:06] <acrichto> I found code in libuv where if I commented it out I fixed the problme
[16:52:10] <brson> wow
[16:52:11] <acrichto> yeah same problem
[16:52:15] <acrichto> I have no idea why it fixes it though
[16:52:22] <acrichto> and I definitely can't upstream it until I figure out why
[16:52:36] <acrichto> brson: http://buildbot.rust-lang.org/builders/auto-win-32-nopt-t/builds/3994/steps/compile/logs/stdio
[16:52:39] <acrichto> (windows deadlock)
[16:52:42] <acrichto> I have no idea what went on there
[16:52:48] <brson> acrichto: oh, i was thinking i'm not entirely comfortable switching to native by default but leaving testing on green for everybody
[16:52:52] <acrichto> I suspect it's b/c of -j2, but it looks like it didn't even hit rust
[16:53:10] <acrichto> that's not what happens though?
[16:53:12] <brson> ugh
[16:53:16] <acrichto> crates have to opt-in to being tested on green
[16:53:24] <brson> acrichto: oh? how does that work?
[16:53:31] <acrichto> the hack in libstd
[16:53:36] <acrichto> where you pass __test::main as the start fn
[16:53:48] <acrichto> http://buildbot.rust-lang.org/builders/auto-win-32-opt/builds/4885/steps/test/logs/stdio
[16:53:51] <acrichto> never seen that error before
[16:54:00] <acrichto> no idea what's going on there
[16:54:01] <brson> so it's just std that's testing with libgreen?
[16:54:17] <acrichto> yeah
[16:54:23] <pnkfelix> acrichto: i was not aware of that.  Is the assumption that for most non-std crates, the libgreen/libnative distinction is entirely irrelevant/
[16:54:23] <acrichto> and I think compiletest runs with libgreen still
[16:54:25] <pnkfelix> acrichto: ?
[16:54:27] <brson> carry on then
[16:54:43] <acrichto> pnkfelix: it is, but it seems odd to have weird preferences
[16:54:49] <acrichto> it's easier if we just say that we always default to libnative
[16:54:57] <acrichto> also means I can remove the crate map entirely!
[16:55:10] <pnkfelix> acrichto: can you give me examples of non-std crates that are opting into being tested in both contexts?  So that I can see how it is done?
[16:55:27] <acrichto> oh this is different I think
[16:55:39] <acrichto> brson thought that I forced all --test builds to run on libgreen instead of libnative
[16:55:43] <acrichto> not running on both
[16:55:58] <acrichto> brson: aha! http://buildbot.rust-lang.org/builders/auto-linux-64-nopt-t/builds/3974
[16:56:23] *** Quits: Kxepal (Miranda@moz-B1712077.pppoe.mtu-net.ru) (Ping timeout)
[16:56:36] * pnkfelix is now more confused.
[16:57:24] <pnkfelix> acrichto: I'm just trying to interpret the significance of the statement "crates have to opt-in to being tested on green"
[16:57:43] <acrichto> pnkfelix: just as a backend
[16:57:56] <acrichto> same way as opting in with normal crates
[16:58:05] <pnkfelix> acrichto: and trying to learn what crates that might care about the distinction (say, a crate providing hypothetical cross-task shared hashtable) 
[16:58:26] <brson> acrichto: i think we probably don't have an easy way to opt into green for --test (since you are using a hack). so crates that *do* prefer green threading have to jump through hoops to make --test work
[16:58:29] <acrichto> oh no one will ever care about the distinction
[16:58:40] <acrichto> brson: indeed
[16:59:05] <acrichto> pnkfelix: it's just a slight preference if you have one, libstd has no green/native specific code, I'm just testing the I/O code paths in both crates
[16:59:13] <acrichto> as in, libstd has the unit tests for libnative and librustuv and libgreen
[17:00:10] <pnkfelix> acrichto: Maybe I need to phrase this a different way
[17:00:42] *** Joins: Kxepal (Miranda@moz-DC6FDBB9.pppoe.mtu-net.ru)
[17:00:45] <pnkfelix> acrichto: Crates that possibly *do* care about the task representation, e.g. because they interact with the underlying memory and care about the memory model
[17:00:54] <pnkfelix> acrichto: Are you saying that it is the reponsibility of such crates
[17:01:07] *** Joins: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net)
[17:01:07] *** ChanServ sets mode: +ao dherman dherman
[17:01:13] <pnkfelix> acrichto: to start up libnative in some tests and libgreen in others?
[17:01:23] <pnkfelix> acrichto: to ensure they get the coverage that they want?
[17:01:55] <acrichto> yes
[17:02:06] <acrichto> if you want fine grained control you have to opt-in to it manually
[17:02:27] <pnkfelix> acrichto: okay.  And I assume such tests cannot be written as instances of #[test] fns.
[17:02:36] <acrichto> you can
[17:02:37] <brson> cmr: how intrusive will it be to experiment with phabricator?
[17:02:44] <acrichto> you just start up the pool in the #[test]
[17:02:50] <acrichto> or spawn the native task in the #[test]
[17:03:10] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:03:22] <pnkfelix> acrichto: hmm.  Okay.  I would have thought that would lead to potential interactions with whatever task-model that the test backend selected
[17:03:42] <pnkfelix> acrichto: and thus could lead to the test infrastructure missing certain test scenarios
[17:03:46] <acrichto> pnkfelix: perhaps? many things can result when switching between green/native
[17:03:56] <acrichto> I'm not really understanding what's going on :(
[17:03:58] <pnkfelix> acrichto: yeah.  I don't have a concrete example.
[17:04:06] <pnkfelix> acrichto: just a vague worry.
[17:04:08] <pnkfelix> acrichto: Okay.
[17:05:33] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:08:25] *** Quits: gwty (gwtypc@8B0C96F5.439CEDBD.F44414AF.IP) (Ping timeout)
[17:10:38] <acrichto> brson: just fyi, I'm having trouble with the libnative switch because rustdoc dies horribly on windows when rendering markdown, and I have no idea why
[17:10:56] <brson> k
[17:10:59] <acrichto> it has to do with CryptAcquireContext and the OsRng, but that's about all I know
[17:11:12] <acrichto> it fails with an error, and then getting the error fails with another error
[17:15:47] *** Joins: gwty (gwtypc@8B0C96F5.439CEDBD.F44414AF.IP)
[17:16:54] <edwardw> wow, devecing PR landed
[17:18:05] *** Quits: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net) (Ping timeout)
[17:18:56] *** Joins: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net)
[17:18:56] *** ChanServ sets mode: +ao dherman dherman
[17:21:46] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[17:21:46] <ghrust> [13rust] 15bors 04force-pushed 06auto from 148df30bc to 147b957a8: 02http://git.io/N3iJvQ
[17:21:46] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[17:21:47] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[17:21:47] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/FKpFqw
[17:21:47] <ghrust> 13rust/06auto 149b77517 15Brian Anderson: mk: Simplify how prepare.mk, install.mk, and dist.mk deal with stages...
[17:21:47] <ghrust> 13rust/06auto 1415e2cb7 15bors: auto merge of #13024 : brson/rust/issue-12799, r=thestinger...
[17:21:47] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[17:25:21] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:26:01] *** Quits: lpy (lpy@1834E2CB.F09091A8.1348A864.IP) (Client exited)
[17:26:19] <erickt> kimundi: I updated the Iterable RFC: https://github.com/rust-lang/rfcs/pull/17
[17:27:17] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:28:00] <brson> reconfiguring buildbot to try a dist snap
[17:28:30] <acrichto> brson: you're brave
[17:28:50] <brson> it's definitely not going to work the first time
[17:29:10] <brson> i'm hoping to get the release process down to just pushing to dist-snap, then signing some things
[17:30:46] <acrichto> that's what it's been in the past?
[17:30:53] <acrichto> modulo fixing bugs in the dist building process
[17:30:53] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[17:30:53] <ghrust> [13rust] 15brson merged 06master into 06dist-snap: 02http://git.io/OaKGjg
[17:30:53] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[17:31:17] <brson> no. in particular the release process for docs is very bad
[17:31:30] <acrichto> oh
[17:33:12] <kimundi> erickt: Wrote a comment, but still need to read the actual RFC
[17:36:37] <erickt> kimundi: thanks, that's what I hoped
[17:37:06] <kimundi> erickt: Oh, I should actually test that now that you meantioned it
[17:37:14] <erickt> :)
[17:39:03] <kimundi> erickt: Yeah, works. Added it to the slice impl tests in the gist
[17:39:43] <erickt> great! now we just need to convince everyone to accept the RFC :)
[17:39:43] <kimundi> (If you meant into_iter on slices)
[17:40:34] <kimundi> erickt: I wonder, if we rename the methods to todays iter(), move_iter and mut_iter, how easy it would be to upgrade the existing codebase to it
[17:41:13] <kimundi> (I'd want to rename them to back later of course)
[17:41:15] <erickt> kimundi: thats a good point. We can then rename things over time
[17:42:28] <kimundi> erickt: One bif problem is that the type parameters become incomprehensible :( - I wish we had associated types already.
[17:42:42] <erickt> yep.
[17:43:00] <kimundi> trait Iterable<A> { type I }
[17:43:15] <kimundi> hm, I wonder if it would be legal to put bounds on associated types
[17:44:30] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:44:31] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[17:44:49] <erickt> that's a good point. We should probably just grab nmatsakis's associated item blog post and put it in an RFC so we can comment about such things
[17:45:30] <kimundi> erickt: Btw, you can enable rust syntax highlining for code blocks in rfcs
[17:46:02] <kimundi> Doesn't change that much, but would make it a bit more readable.
[17:46:12] <kimundi> ```.rust I think
[17:46:18] <erickt> neat, I'll add it
[17:46:31] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[17:47:24] <acrichto> brson: whoa http://buildbot.rust-lang.org/builders/auto-win-32-nopt-t/builds/4009/steps/clean/logs/stdio
[17:47:42] <erickt> kimundi: added. It's ```rust
[17:48:03] <kimundi> yay, grey comments and red error lifetimes ;D
[17:48:53] <sfackler> acrichto: what are you doing to those poor bots?!
[17:49:01] <acrichto> :(
[17:49:06] <kimundi> erickt: Maybe add a sentence/example what the code blob about PodIterable is actually good for (enabling foo.values() instead of foo.refs().map(|x| *x))
[17:50:59] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[17:51:24] <kimundi> erickt: And the Extendable code still uses move_iter() in the main function, you might change that for consistency? :)
[17:51:56] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[17:51:56] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/L1yT4A
[17:51:56] <ghrust> 13rust/06auto 149b77517 15Brian Anderson: mk: Simplify how prepare.mk, install.mk, and dist.mk deal with stages...
[17:51:56] <ghrust> 13rust/06auto 14b975b7c 15bors: auto merge of #13024 : brson/rust/issue-12799, r=thestinger...
[17:51:56] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[17:54:23] <erickt> kimundi: oops, I forgot to finish my PodIterable sentence. I'll flesh it out
[17:56:17] <erickt> kimundi: done. thanks for all the comments
[17:59:11] <cmr> brson: entirely unintrusive, or should be.
[17:59:20] <cmr> brson: there shouldn't be any external indication of it?
[17:59:41] <cmr> for now I'm just going to set it up so that pull requests get shown in its code review tool
[17:59:54] <cmr> I also have set up some audits so that changes to submodules and unsafe code get flagged for extra review
[17:59:59] <cmr> but that's all internal to the tool
[18:02:54] <kimundi> erickt: hm, with DST, and a Deref<[T]> impl on Vec<T>, and a for-loop changed to use Iterable, `for elem in vec` would move the vector, while `for elem in *vec` would give one references because the &[T] impl gets picked.
[18:03:33] <kimundi> erickt: (Did you notice that I made the Iterable and RefIterable impl for &[T] identical?)
[18:04:37] <kimundi> This might make a interesting "how it looks like with future planned changes" section
[18:04:52] *** Quits: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net) (Quit: Sharp)
[18:05:11] <erickt> kimundi: no, I missed that
[18:05:43] <erickt> clever
[18:05:53] <kimundi> erickt: Iterable for &[T] with my gist returns references, which think makes sense, and allows method chaining
[18:06:37] <kimundi> Actually, I think nmatsakis was talking about making by-value passing for [T] work
[18:07:54] <kimundi> If we implement the iterable traits for [T] directly... they would all work, but I have no idea what `for x in vec*` would do
[18:08:20] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:08:24] <kimundi> `for x in *vec` even
[18:09:59] *** Joins: ninechars (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[18:10:20] <kimundi> you get &[T], which would not implement Iterable if its implemented on [T]... unless we add an explicit impl for it as well.
[18:10:41] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:10:48] *** Joins: doener (doener@moz-C68F600D.unity-media.net)
[18:13:24] <erickt> kimundi: I got to run an errand, so could you add this and any other comments you have to the PR? thanks so much
[18:14:10] <kimundi> Okay, I'm gonna be lazy and paste it there though. ;)
[18:17:27] *** Quits: gwty (gwtypc@8B0C96F5.439CEDBD.F44414AF.IP) (Ping timeout)
[18:18:23] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[18:19:29] *** Joins: gwty (gwtypc@498D0BCE.ACBB8BD3.8A00C703.IP)
[18:22:24] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[18:22:24] *** ChanServ sets mode: +ao pcwalton pcwalton
[18:24:38] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[18:25:06] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Quit: Leaving)
[18:25:34] *** Joins: Sharp (Sharp@19388942.6B775EBE.DC877F3B.IP)
[18:29:40] *** Quits: gwty (gwtypc@498D0BCE.ACBB8BD3.8A00C703.IP) (Ping timeout)
[18:29:45] *** Quits: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP) (Quit: WeeChat 0.4.3)
[18:30:41] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:32:28] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:35:19] <acrichto> brson: ok, fun fact, our storage of the stack limit in the TCB on windows is causing CryptAcquireContext to fail
[18:44:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:46:26] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:51:47] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[18:51:49] *** Joins: gwty (gwtypc@BCF94A7A.D0D7F4BE.4654B817.IP)
[18:54:06] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[18:55:14] <brson> acrichto: great
[18:55:24] <brson> possibly because we're misusing fibers?
[18:55:36] <brson> oh wait this is not for green threads
[18:56:34] <acrichto> brson: v
[18:56:35] <acrichto> https://github.com/alexcrichton/rust/commit/58fdb9e6a402e4518343f493b47ef3a703935390
[18:56:36] <brson> the place we store the TCB is supposed to be for application use, but maybe CryptAcquireContext clobbers it?
[18:56:37] <acrichto> that fixed the bug
[18:56:43] <acrichto> http://en.wikipedia.org/wiki/Win32_Thread_Information_Block
[18:56:46] <acrichto> "Arbitrary data slot"
[18:56:55] <acrichto> I think that it must be doing something like verifying it
[18:57:00] <acrichto> taking some sort of hash or something
[18:57:11] <acrichto> once you've acquired one context, all future contexts can be acquired
[18:57:12] <brson> wtf
[18:57:20] <acrichto> which explains why it always worked with libgreen
[18:57:23] *** Quits: gwty (gwtypc@BCF94A7A.D0D7F4BE.4654B817.IP) (Ping timeout)
[18:57:27] <acrichto> the first context is acquired on a scheduler thread (with no stack limit)
[18:57:39] <acrichto> this is so weird
[18:57:50] *** Joins: tjc (tjc@1FC322A8.2D024FDB.284344F5.IP)
[18:57:50] *** ChanServ sets mode: +o tjc
[18:57:54] <acrichto> what do you think of that fix? (more heavily commented of course)
[18:57:55] <brson> oh, maybe it's some security thing where CryptAcquireContext is trying to avoid some TCB-based attack?
[18:58:04] <acrichto> maybe?
[18:58:06] <acrichto> seems dubious
[18:58:39] <brson> the fix is fine, with big comments
[18:58:51] <acrichto> ok
[18:59:00] <acrichto> this is so weird
[18:59:00] *** Joins: gwty (gwtypc@816DE8AF.76932361.645B845A.IP)
[19:01:16] *** Joins: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP)
[19:02:04] *** Quits: gwty (gwtypc@816DE8AF.76932361.645B845A.IP) (Ping timeout)
[19:02:17] <acrichto> brson: r? https://github.com/alexcrichton/rust/commit/f76ecfa5eb6b2a026f3f99940e89033f71f2848e
[19:06:43] <brson> linux-snap ran out of disk space!
[19:06:56] <acrichto> that was fast
[19:07:18] * brson lunch
[19:13:58] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:14:01] *** Quits: ninechars (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[19:15:54] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:16:11] *** Joins: gwty (gwtypc@B3118ADB.4C058DC4.553D87E5.IP)
[19:24:58] *** Joins: ninechars (glaebhoerl@moz-B5B88D72.catv.broadband.hu)
[19:25:10] *** Quits: ninechars (glaebhoerl@moz-B5B88D72.catv.broadband.hu) (Quit: )
[19:30:29] *** Quits: tjc (tjc@1FC322A8.2D024FDB.284344F5.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz)
[19:30:35] *** Joins: tjc (tjc@1FC322A8.2D024FDB.284344F5.IP)
[19:30:35] *** ChanServ sets mode: +o tjc
[19:41:56] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[19:48:22] *** Quits: tjc (tjc@1FC322A8.2D024FDB.284344F5.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz)
[19:48:30] *** Quits: gwty (gwtypc@B3118ADB.4C058DC4.553D87E5.IP) (Ping timeout)
[19:50:22] *** Joins: gwty (gwtypc@980E6763.65D8992A.137C914F.IP)
[19:56:51] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[19:56:51] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14b975b7c to 147b957a8: 02http://git.io/N3iJvQ
[19:56:51] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[19:56:52] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[19:56:52] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/kVYCww
[19:56:52] <ghrust> 13rust/06auto 14ab1dd09 15Alex Crichton: rustc: Switch defaults from libgreen to libnative...
[19:56:52] <ghrust> 13rust/06auto 14d2e99a0 15Alex Crichton: rand: Rewrite OsRng in Rust for windows...
[19:56:52] <ghrust> 13rust/06auto 14e7c4fb6 15Alex Crichton: rand: Fix a bug acquiring a context on windows...
[19:56:54] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[19:56:56] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[19:57:41] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[19:58:12] *** Quits: Leo` (Leo@moz-83832FE2.placeholder.fr) (Ping timeout)
[19:58:22] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Input/output error)
[19:58:38] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[19:59:15] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[19:59:54] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Input/output error)
[20:00:14] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[20:01:24] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Connection reset by peer)
[20:02:02] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[20:03:11] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Input/output error)
[20:03:53] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[20:04:54] *** Quits: mcpherrin (mcpherrin@BB4DB59D.2876C283.70845BE5.IP) (Quit: leaving)
[20:05:09] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Input/output error)
[20:05:17] <edwardw> nmatsakis: ping
[20:09:45] *** Joins: Leo` (Leo@moz-83832FE2.placeholder.fr)
[20:10:53] *** Joins: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP)
[20:14:53] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[20:15:14] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[20:15:44] *** Joins: mcpherrin (mcpherrin@moz-464166A4.hsd1.ca.comcast.net)
[20:17:50] <sfackler> cmr: pong from yesterday
[20:17:53] *** Quits: canhtak (canhtak@moz-805AE185.wl.t.ulaval.ca) (Quit: canhtak)
[20:17:58] *** Quits: dherman (dherman@moz-B31C6965.dsl.pltn13.sbcglobal.net) (Quit: dherman)
[20:19:00] <cmr> sfackler: can you add members to the Rust project at http://phabricator.octayn.net/project/view/1/ ?
[20:21:21] <brson> restarting buildbot
[20:22:28] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[20:22:29] <ghrust> [13rust] 15brson pushed 6 new commits to 06dist-snap: 02http://git.io/JAr2XQ
[20:22:29] <ghrust> 13rust/06dist-snap 14a73a881 15Brian Anderson: mk: Stop building OS X .pkg as part of 'make dist'...
[20:22:29] <ghrust> 13rust/06dist-snap 14c3c2bf5 15Brian Anderson: mk: Reorder definitions in dist.mk...
[20:22:29] <ghrust> 13rust/06dist-snap 1482a20bc 15Brian Anderson: mk: Cleanup
[20:22:31] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[20:24:31] *** Quits: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP) (Input/output error)
[20:26:13] <sfackler> cmr: yep
[20:26:20] <cmr> damn
[20:26:23] <cmr> ok
[20:26:50] *** Quits: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP) (Quit: WeeChat 0.4.3)
[20:30:52] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[20:32:33] *** Joins: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP)
[20:33:12] <eddyb> cmr: sup with the bencher?
[20:34:03] *** Quits: edwardw (edwardw@2BFF2300.F4429B.7E4FEB66.IP) (Ping timeout)
[20:36:04] *** Joins: edwardw (edwardw@CDC87030.9642909.B3B412E5.IP)
[20:37:41] <cmr> eddyb: not sure, it's having some strange issues
[20:37:49] <eddyb> huon: you did it wrong :( http://buildbot.rust-lang.org/builders/auto-linux-64-nopt-t/builds/3994/steps/test/logs/stdio
[20:37:50] *** Joins: victorporof_ (victorporo@13F2CEC5.7672369.D8E68FF6.IP)
[20:38:42] <cmr> there are a *ton* of incomplete build dirs
[20:38:51] <cmr> and it's saying it's having problems moving builds into their final home
[20:38:57] <cmr> saying they aren't empty.
[20:39:05] <cmr> but ... I really have no idea what it's doing
[20:39:22] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[20:39:50] <edwardw> is nmatsakis around?
[20:40:43] <eddyb> cmr: you have a hungry inode
[20:44:42] *** Joins: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP)
[20:50:57] *** Quits: edwardw (edwardw@CDC87030.9642909.B3B412E5.IP) (Quit: Leaving...)
[20:51:49] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[20:51:49] <ghrust> [13rust] 15bors 04force-pushed 06auto from 143ccc1fe to 147b957a8: 02http://git.io/N3iJvQ
[20:51:49] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[20:51:52] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[20:51:52] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/s4uuog
[20:51:52] <ghrust> 13rust/06auto 149b77517 15Brian Anderson: mk: Simplify how prepare.mk, install.mk, and dist.mk deal with stages...
[20:51:52] <ghrust> 13rust/06auto 14cff012d 15bors: auto merge of #13024 : brson/rust/issue-12799, r=thestinger...
[20:51:53] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[20:52:14] <eddyb> acrichto: bouncy?
[20:52:50] <eddyb> what? http://buildbot.rust-lang.org/builders/auto-linux-64-nopt-c/builds/3993/steps/configure/logs/stdio
[20:53:07] <eddyb> configure timed out fetching LLVM?
[20:55:43] <cmr> yeah that's been happening
[20:58:24] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[21:02:10] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:04:30] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:15:07] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[21:15:08] *** ChanServ sets mode: +ao dherman dherman
[21:24:27] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:25:38] *** victorporof_ is now known as victorporof
[21:26:15] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:33:02] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[21:37:46] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[21:44:22] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:47:40] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:55:47] *** Joins: ktt3ja (ktt3ja@moz-54586A12.washdc.fios.verizon.net)
[22:00:56] *** Joins: NiccosSystem` (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[22:01:27] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[22:03:28] *** Quits: NiccosSystem` (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[22:03:42] <eddyb> acrichto: let method_call = MethodCall::expr(id);
[22:03:50] <eddyb> acrichto: yupp. now I have to redeem myself
[22:04:25] *** Joins: mediocrity (Thunderbir@moz-8A2E9A09.bredband.comhem.se)
[22:05:02] *** Joins: jdm (jdm@CC0122E6.8F96AEA7.2D179A7D.IP)
[22:10:04] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[22:12:51] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[22:12:51] *** ChanServ sets mode: +ao pcwalton pcwalton
[22:13:54] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[22:19:03] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[22:23:05] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[22:23:05] <ghrust> [13rust] 15brson 04force-pushed 06dist-snap from 14299c082 to 14f78bd2b: 02http://git.io/0Tp-4A
[22:23:05] <ghrust> 13rust/06dist-snap 14fbfa379 15Brian Anderson: mk: Cleanup version handling and add support for nightly dists
[22:23:05] <ghrust> 13rust/06dist-snap 142159956 15Brian Anderson: mk: Put win installer in correct dir
[22:23:06] <ghrust> 13rust/06dist-snap 1482fbe50 15Brian Anderson: mk: Add docs to dist prep...
[22:23:08] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[22:24:09] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Connection reset by peer)
[22:29:06] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:31:32] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:32:19] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Quit: Computer has gone to sleep.)
[22:32:42] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[22:34:23] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[22:40:50] *** Joins: bytbox (s@moz-E1E7FAC3.washdc.fios.verizon.net)
[22:44:08] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:46:35] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:47:01] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Input/output error)
[22:47:29] *** Quits: erickt (etryzelaar@49C4075F.3AC15C18.2321E71E.IP) (Input/output error)
[22:47:45] *** Joins: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP)
[22:50:49] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:51:54] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[22:51:54] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/s4uuog
[22:51:54] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[22:53:06] <eddyb> watch it bounce again
[22:53:15] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:53:29] <eddyb> acrichto: I think bors likes its greens too much
[22:56:30] <aatch> Oh yeah! this: `a.s012012` turns to this: `shufflevector <3 x double> %0, <3 x double> undef, <6 x i32> <i32 0, i32 1, i32 2, i32 0, i32 1, i32 2>`
[22:56:42] <sfackler> aww yiss
[22:56:48] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[22:56:48] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02https://github.com/mozilla/rust/compare/cff012dc9017...cff012dc9017
[22:56:48] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[22:56:49] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[22:56:49] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/Pr3r7A
[22:56:49] <ghrust> 13rust/06auto 14ab1dd09 15Alex Crichton: rustc: Switch defaults from libgreen to libnative...
[22:56:49] <ghrust> 13rust/06auto 14d2e99a0 15Alex Crichton: rand: Rewrite OsRng in Rust for windows...
[22:56:49] <ghrust> 13rust/06auto 14e7c4fb6 15Alex Crichton: rand: Fix a bug acquiring a context on windows...
[22:56:51] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[22:57:24] <aatch> I'm not sure why people thought that implementing that would be difficult...
[22:59:35] <huon> acrichto: oh, <3 OsRng being pure rust
[22:59:43] <huon> aatch: do we want that syntax yet?
[22:59:46] <brson> i forgot why i'm making a snapshot
[22:59:56] <huon> why not?
[23:00:19] <huon> snapshots feel like progress, and progress is always good
[23:00:31] <aatch> huon, no idea, but implementing it is pretty fun in its own right
[23:00:32] <brson> i know i'm not doing it for charity
[23:00:42] <brson> i'm supposed to be doing something
[23:00:43] <huon> heh
[23:01:04] <kimundi> brson: To make sure it still works a day after the last one? ;)
[23:01:11] <acrichto> brson: attribute syntax
[23:01:21] <eddyb> huon: see the failure?
[23:01:26] <huon> eddyb: of course
[23:01:29] <brson> acrichto: thanks, yes
[23:02:49] <eddyb> aatch: because consteval misconceptions?
[23:03:01] <eddyb> aatch: they probably expected a method call
[23:03:15] *** Quits: japaric (japaric@C87928B9.6A7849D9.95AE23EB.IP) (Ping timeout)
[23:04:31] *** Joins: japaric (japaric@29430DD7.551A521E.212E9B57.IP)
[23:06:26] <aatch> eddyb, I dunno. Implementing a shuffle intrinsic is going to be the harder one, since I don't really want to implement all the variations that we'd need to cover the various instances
[23:06:30] <huon> eddyb: ilon
[23:06:56] <huon> whoops
[23:07:00] <huon> sorry eddyb
[23:07:27] <aatch> hmm, I think I've covered everything except the intrinsics now.
[23:07:39] <aatch> And I'm not sure how to deal with those...
[23:09:54] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:10:14] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[23:12:47] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[23:14:36] *** Quits: jdm (jdm@CC0122E6.8F96AEA7.2D179A7D.IP) (Ping timeout)
[23:18:31] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[23:19:30] *** Quits: Sharp (Sharp@19388942.6B775EBE.DC877F3B.IP) (Quit: Sharp)
[23:27:32] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:30:03] *** Quits: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net) (Ping timeout)
[23:30:25] *** Joins: tedh (tedh@moz-F3B34318.hsd1.il.comcast.net)
[23:30:25] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[23:31:02] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[23:34:21] *** Joins: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:35:05] <eddyb> https://github.com/alexcrichton/rust/blob/d2e99a0b33c25dee2c1b3c113b5c67bfed1bff1d/src/rt/rust_builtin.c is getting smaller
[23:35:29] <eddyb> we should move the time stuff into libtime
[23:36:01] <huon> you think it's about time to do that?
[23:36:23] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[23:36:47] *** Quits: erickt_ (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:37:04] <eddyb> why are these two different #if blocks? https://github.com/mozilla/rust/blob/master/src/rt/rust_builtin.c#L67-L75
[23:37:07] <eddyb> huon: hehe
[23:37:58] <huon> eddyb: because the apple one has nested if's?
[23:38:05] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[23:38:13] <huon> well, I guess one can use && in #if's
[23:38:26] <eddyb> yupp
[23:41:06] <eddyb> https://github.com/mozilla/rust/blob/master/src/rt/rust_builtin.c#L246-L252 :(((
[23:41:48] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[23:41:48] <ghrust> [13rust] 15bors 04force-pushed 06auto from 140e01867 to 14cff012d: 02http://git.io/N3iJvQ
[23:41:48] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[23:41:49] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[23:41:49] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/9vGq3A
[23:41:49] <ghrust> 13rust/06auto 14988664a 15Alex Crichton: rustdoc: Fix file locking on windows...
[23:41:49] <ghrust> 13rust/06auto 143e3a3cf 15bors: auto merge of #13043 : alexcrichton/rust/fix-rustdoc-windows, r=brson...
[23:41:50] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[23:43:44] <huon> aatch: have you solved the "simd" intrinsic problem?
[23:44:22] <aatch> huon, what do you mean?
[23:44:39] <huon> "hmm, I think I've covered everything except the intrinsics now. And I'm not sure how to deal with those..."
[23:44:43] *** Joins: victorporof_ (victorporo@13F2CEC5.7672369.D8E68FF6.IP)
[23:45:08] *** Quits: victorporof (victorporo@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[23:45:21] <aatch> huon, oh, no, I haven't. Basically SIMD vectors will have the same problem as tuples and fixed-length vectors
[23:45:34] <aatch> especially fixed-length vectors
[23:45:36] <huon> what about not hard-coding them as pure intrinsics and instead making them always go via the `simdex![...]` extension that can have a special, non-repetitive AST node?
[23:45:59] <huon> :( fixed-length vectors
[23:46:22] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[23:46:25] <eddyb> is this because of varying layout in uv struct definitions? https://github.com/mozilla/rust/blob/master/src/rt/rust_uv.c
[23:46:25] <aatch> huon, I don't really want to bloat the AST
[23:46:41] <huon> aatch: is there another possible solution?
[23:46:43] <eddyb> aatch: intrinsic for what?
[23:46:49] <huon> eddyb: simd shuffles
[23:46:59] <eddyb> dynamic ones?
[23:47:39] *** Joins: victorporof (victorporo@13F2CEC5.7672369.D8E68FF6.IP)
[23:47:39] <aatch> Hmm, let me check something regarding dynamic shuffles...
[23:48:03] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[23:48:15] *** Quits: victorporof_ (victorporo@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[23:49:34] <eddyb> shuffle2(simd![T, ..2], [u8, ..2]), shuffle3(simd![T, ..3], [u8, ..3]), shuffle4(simd![T, ..4], [u8, ..4]) etc?
[23:50:11] *** Joins: cgaebel (clark@moz-F9D89110.nyc.res.rr.com)
[23:50:28] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[23:50:49] <aatch> eddyb, except it'd be `shuffle<m>x<n>(simd![T,..m], simd![u8..n]) -> simd![T,..n]`
[23:52:06] <huon> brson: was this PR prompted by anything in particular? https://github.com/mozilla/rust/pull/13035 (also, r? I guess)
[23:52:11] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[23:52:47] <eddyb> aatch: any reason for simd in the second one?
[23:52:48] *** Quits: cgaebel (clark@moz-F9D89110.nyc.res.rr.com) (Client exited)
[23:52:49] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[23:52:56] <huon> eddyb, aatch: that's not at all future-proof, e.g. we've gone from 128-bit SSE registers to 512-bit AVX(2?) ones in a few years
[23:53:16] *** Quits: erickt (erickt@49C4075F.3AC15C18.2321E71E.IP) (Ping timeout)
[23:53:17] <huon> hardcoding intrinsics for every lengths someone might wish to use is a non-starter
[23:53:28] <huon> eddyb: because that's how dynamic shuffles work?
[23:53:36] <aatch> huon, I know, hence why the current SIMD situation isn't very good.
[23:54:13] <huon> aatch: yup yup, just pointing it out do eddyb 
[23:54:24] * huon retracts his `, aatch` from that line
[23:54:33] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
[23:54:55] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[23:55:07] <aatch> Also, doesn't look like LLVM can optimize the written-out form of the shuffle very well either.
[23:55:13] <aatch> The bounds checks are part of it.
[23:55:47] <brson> huon: that is our doc contract
[23:56:03] <huon> brson: awesome (that's what I guessed)
[23:56:10] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:56:18] <huon> (will there be an announcement?)
[23:56:43] *** Joins: erickt_ (erickt@49C4075F.3AC15C18.2321E71E.IP)
[23:56:44] <brson> huon: i'm hoping that once he gets up to speed with the process that the community can participate in it and help him
[23:56:46] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Connection reset by peer)
[23:56:50] *** Joins: esummers (esummers@moz-3B015C90.wi.res.rr.com)
[23:56:54] <brson> huon: i made one in the meeting minutes a few weeks ago
[23:57:12] <brson> trying to avoid mailing list announcements to avoid huge flamewars
[23:57:18] <huon> brson: oh, I must've missed it
[23:57:20] <huon> heh, sounds good
[23:58:07] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:59:27] *** Quits: esummers (esummers@moz-3B015C90.wi.res.rr.com) (Ping timeout)
