[00:03:11] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[00:06:27] *** Quits: eibwen (kvirc@moz-A1C6347E.dip0.t-ipconnect.de) (Ping timeout)
[00:06:27] *** Quits: glaebhoer1 (glaebhoerl@3391DE98.E9231B2.A0179ACD.IP) (Ping timeout)
[00:10:33] *** Joins: turon (Mibbit@moz-3231AF5C.pool.mediaways.net)
[00:11:47] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:11:55] *** Quits: Yurume (Yurume@A826BD81.8A0DEF81.38747683.IP) (Ping timeout)
[00:11:58] *** Joins: Yurume (Yurume@A826BD81.8A0DEF81.38747683.IP)
[00:14:30] *** Joins: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net)
[00:16:06] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[00:16:29] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[00:16:51] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[00:16:51] <ghrust> [13rust] 15bors 04force-pushed 06auto from 145b1ac1e to 14bcaaffb: 02http://git.io/N3iJvQ
[00:16:51] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[00:16:55] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[00:16:55] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/4aayWg
[00:16:55] <ghrust> 13rust/06auto 14a76c188 15Alex Crichton: comm: Implement synchronous channels...
[00:16:55] <ghrust> 13rust/06auto 14aa65920 15bors: auto merge of #12991 : alexcrichton/rust/sync-chan, r=brson...
[00:16:56] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[00:17:31] *** Quits: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net) (Client exited)
[00:17:57] *** Parts: turon (Mibbit@moz-3231AF5C.pool.mediaways.net) ()
[00:18:03] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:19:07] *** Joins: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net)
[00:20:49] *** Quits: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net) (Ping timeout)
[00:21:34] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:26:38] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:26:40] *** flaper87 is now known as flaper87|afk
[00:28:06] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[00:30:04] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[00:32:24] *** Quits: Jesse (jruderman@moz-62518563.mtv2.mozilla.com) (Quit: Jesse)
[00:33:08] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[00:36:05] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:41:56] <cmr> aatch: I've hopefully worked around the issue meyer hit. if you see him before I do mind giving him a ping?
[00:43:56] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[00:43:56] <ghrust> [13rust] 15cmr 04force-pushed 06try from 14156b4ea to 14ce54655: 02http://git.io/k471pw
[00:43:56] <ghrust> 13rust/06try 1435ba2f3 15Corey Richardson: Remove libc from std...
[00:43:56] <ghrust> 13rust/06try 1411746fb 15Corey Richardson: fix fallout from std::libc separation
[00:43:57] <ghrust> 13rust/06try 1498452b8 15Corey Richardson: Add unrecognized_lint
[00:43:59] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[00:44:22] *** kimundi is now known as zz_kimundi
[00:44:55] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[00:47:46] <aatch> cmr, I would if he was around
[00:47:59] <cmr> yes, this is why I asked if you saw him before I did :P
[00:48:06] <aatch> cmr, oh "if you see him before I do" <- missed that bit
[00:48:07] <cmr> if he was around I'd just leave a msg
[00:48:26] <SiegeLord> This server has memoserv :P
[00:49:27] <aatch> SiegeLord, so it does
[00:49:42] * ChrisMorgan wonders what percentage of regular IRC users even know about MemoServ
[00:49:46] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Ping timeout)
[00:50:06] *** Joins: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net)
[00:50:08] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[00:50:08] *** ChanServ sets mode: +o tjc
[00:50:18] <aatch> ChrisMorgan, I know about the *idea* I didn't realise it was a specific IRC service until now
[00:50:25] <aatch> I just figured people had bots
[00:50:43] <ChrisMorgan> *Serv is typically reserved, I believe.
[00:50:51] *** ChrisMorgan is now known as ChrisServ
[00:50:56] <ChrisServ> OK, apparently not.
[00:51:06] *** ChrisServ is now known as ChrisMorgan
[00:51:50] *** Quits: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net) (Ping timeout)
[00:52:09] *** ChrisMorgan is now known as IRCMonkey38618
[00:52:26] <aatch> huh?
[00:52:49] <IRCMonkey38618> OKâ€¦ apparently in the rename it forgot that I had already told NickServ who I was :-/
[00:53:50] *** Joins: Jesse (jruderman@moz-62518563.mtv2.mozilla.com)
[00:54:08] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[00:55:49] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[00:56:34] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[00:57:53] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[00:58:13] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[00:58:27] * seanmonstar throws a tantrum at all the custom encoder/decoder code in rustc/middle/astencode.rs
[00:58:49] <sfackler> it's pretty gross
[01:02:32] <nrc> acrichto: what was the conclusion from the work week re logging? Just moving to liblog or are there more changes on the way?
[01:02:52] <acrichto> nrc: what's done is what we decided as far as I know
[01:02:58] <acrichto> we could do more though
[01:04:28] <nrc> I would murder for tags in debug! so I could filter for , say debug messages for resolve and privacy, but not lexing or pretty printing
[01:04:45] <nrc> if that doesn't sound awful I can put an RFC together
[01:04:49] <acrichto> RUST_LOG=rustc::privacy
[01:04:50] <acrichto> ?
[01:04:54] <acrichto> rustc::middle::privacy*
[01:05:05] <acrichto> you can control log levels on a per-module basis
[01:05:13] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:05:16] <seanmonstar> nrc: i'd like heirarchal loggers like python
[01:05:54] <aatch> acrichto, that system could do with some adjustment
[01:06:12] <nrc> acrichto: cool! How does that work for debug vs warning etc?
[01:06:42] <acrichto> nrc: RUST_LOG=rustc::middle::privacy=warn,rustc::middle::resolve=info
[01:06:44] <acrichto> etc
[01:06:51] <nrc> ah, sweet
[01:06:52] <acrichto> http://static.rust-lang.org/doc/master/log/index.html
[01:06:58] <acrichto> http://static.rust-lang.org/doc/master/log/index.html#enabling-logging
[01:07:18] <acrichto> aatch, seanmonstar: that's why I put it in a library, now it's a lot easier to improve on!
[01:07:33] <seanmonstar> acrichto: indeed, i've been thinking how
[01:07:35] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:07:41] <nrc> I would prefer explicit tags, but that is close enough to make me not want to put the effort in to tag stuff
[01:08:46] <acrichto> nrc: yeah filtering within a module is a pain right now
[01:09:16] <aatch> acrichto, the main change i have is making it not just a prefix match
[01:10:17] <aatch> right now, for the compiler, that means that doing RUST_LOG=rustc::middle::ty pulls in typeck as well.
[01:10:26] *** Joins: sunfish (chatzilla@8F761026.B5EF4AF6.E96CA9D8.IP)
[01:10:30] <aatch> Which is a pretty significant amount of logging.
[01:10:48] <aatch> I think doing the match of whole modules makes more sense.
[01:10:54] <aatch> match on*
[01:11:52] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[01:11:52] <ghrust> [13rust] 15bors pushed 12 new commits to 06auto: 02http://git.io/ba7IxA
[01:11:53] <ghrust> 13rust/06auto 14da118e8 15Alex Crichton: Snapshot cleanup
[01:11:53] <ghrust> 13rust/06auto 14dd64bd8 15Alex Crichton: std: Move NativeMutex from &mut self to &self...
[01:11:53] <ghrust> 13rust/06auto 14d6b3f1f 15Alex Crichton: sync: Move the concurrent queue to using &self...
[01:11:55] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[01:11:59] *** Joins: aurynj (Eon@B3D9F3A9.6EA7AEE4.364694FC.IP)
[01:12:31] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:12:38] *** Joins: rustilite (rustilite@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:15:39] *** Joins: lpy (lpy@8B40CDAC.F09091A8.1348A864.IP)
[01:17:08] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:19:31] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:21:02] *** Quits: canhtak (canhtak@moz-1300C4D7.wl.t.ulaval.ca) (Quit: canhtak)
[01:38:57] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[01:39:08] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[01:41:18] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[01:44:16] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[01:45:34] *** Joins: zimbabao (rajaram@817E69AE.26907A.D2D1FAF0.IP)
[01:45:49] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[01:52:18] *** Joins: canhtak (canhtak@moz-1300C4D7.wl.t.ulaval.ca)
[01:53:47] *** Quits: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com) (Ping timeout)
[01:54:20] *** Joins: doomlord_ (servitor@moz-99BE89EC.range86-184.btcentralplus.com)
[02:00:22] <cmr> nrc: it'd be nice if it worked per-function too
[02:00:34] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[02:00:48] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:01:28] *** Quits: blank_name (blank_name@5EC13E3.964BADD.93A5C78C.IP) (Ping timeout)
[02:02:52] <cmr> what the heck is http://buildbot.rust-lang.org/builders/try-win/builds/937/steps/compile/logs/stdio :\
[02:02:55] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:03:09] *** Quits: zimbabao (rajaram@817E69AE.26907A.D2D1FAF0.IP) (Ping timeout)
[02:03:14] *** Joins: blank_name (blank_name@5EC13E3.964BADD.93A5C78C.IP)
[02:04:53] *** Joins: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net)
[02:06:40] *** Quits: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net) (Quit: Leaving...)
[02:09:56] *** Quits: Sharp (Sharp@moz-3301C7AB.static-ip.telepacific.net) (Quit: Sharp)
[02:10:59] <nrc> if I hav `Trait<X: B> {}`
[02:11:03] <nrc> *have
[02:11:21] <nrc> * `Trat T1<X:B>...`
[02:11:32] <nrc> *trait
[02:11:36] <nrc> (sigh)
[02:11:59] <nrc> and `trait T2<X> { fn m(x: &T2<X>); }
[02:12:01] <nrc> `
[02:12:33] <nrc> I would expect that to fail type checking since the X in T2 does not have the bound required by X in T1
[02:12:41] <nrc> but it type checks
[02:12:44] <nrc> why is that?
[02:17:50] <Eridius> Is DerefMut used exclusively for `*a = b`?
[02:18:02] *** Joins: zimbabao (rajaram@4D33B643.246489EE.BE4CF869.IP)
[02:20:12] <sfackler> Eridius: it's to return a &mut Foo in general for e.g. methods that take &mut self
[02:20:15] <Eridius> ah hah, I can also say &mut *a
[02:20:39] <Eridius> yeah, auto-deref... righgt
[02:20:52] <Eridius> would be nice to have the docs explicitly spell out where DerefMut is used
[02:21:05] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[02:22:11] *** Quits: aurynj (Eon@B3D9F3A9.6EA7AEE4.364694FC.IP) (Ping timeout)
[02:22:27] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:24:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:26:53] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[02:26:53] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/ba7IxA
[02:26:53] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[02:29:01] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[02:30:54] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[02:31:54] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[02:31:54] <ghrust> [13rust] 15bors pushed 1 new commit to 06auto: 02http://git.io/34grrA
[02:31:54] <ghrust> 13rust/06auto 14876f715 15bors: auto merge of #12526 : cmr/rust/separate-libc, r=cmr...
[02:31:54] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[02:37:13] <IRCMonkey38618> nrc: did you mean `trait T2<X> { fn m(x: &T1<X>); }`?
[02:38:17] *** IRCMonkey38618 is now known as ChrisMorgan
[02:38:36] *** Quits: Jesse (jruderman@moz-62518563.mtv2.mozilla.com) (Quit: Jesse)
[02:39:18] <nrc> ChrisMorgan: yes, that's what I meant
[02:39:22] <nrc> any ideas?
[02:40:13] <ChrisMorgan> rusti: trait B{}trait T1<X: B>{}trait T2<X>{fn m(_x: &T1<X>){}}
[02:40:14] -rusti- ()
[02:40:17] <ChrisMorgan> Eek!
[02:42:01] <ChrisMorgan> That does sound rather unsound.
[02:44:10] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[02:44:14] <sfackler> can you implemente T2 for X that isn't B?
[02:46:13] <sfackler> rusti: trait B{}trait T1<X: B>{}trait T2<X>{fn m(_x: &T1<X>){}} impl T2<int> for int {}
[02:46:14] -rusti- ()
[02:46:17] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[02:46:33] <sfackler> rusti: trait B{}trait T1<X: B>{}trait T2<X>{fn m(_x: &T1<X>){}} impl T2<int> for int {} 10i.m(10i)
[02:46:34] -rusti- pastebinned 11 lines of output: http://sprunge.us/NWgS
[02:46:56] *** Joins: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP)
[02:46:56] <ghrust> [13rust] 15bors pushed 1 new commit to 06auto: 02http://git.io/QulTYg
[02:46:56] <ghrust> 13rust/06auto 14b63fe58 15bors: auto merge of #13063 : brson/rust/dist, r=alexcrichton...
[02:46:56] *** Parts: ghrust (ghrust@38D6F008.6A2AE50.F3114085.IP) ()
[02:46:58] *** Joins: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP)
[02:46:59] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14876f715 to 146bf3fca: 02http://git.io/N3iJvQ
[02:46:59] *** Parts: ghrust (ghrust@88C0CBA2.6A2AE50.F3114085.IP) ()
[02:49:04] <nrc> Yeah, I don't think it can be unsound because of the way impls are checked, but it is kind of odd
[02:56:46] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[03:01:38] <ChrisMorgan> At worst, you end up with a dead, partial implementation of a trait, which can definitely be confusing.
[03:05:16] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[03:05:16] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:05:49] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:08:00] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:16:42] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[03:18:13] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[03:18:53] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[03:27:31] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:29:35] *** Joins: aurynj (Eon@53E88241.65896F99.364694FC.IP)
[03:29:48] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:30:26] *** Quits: zimbabao (rajaram@4D33B643.246489EE.BE4CF869.IP) (Ping timeout)
[03:36:57] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[03:38:14] *** Quits: sunfish (chatzilla@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[03:40:12] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[03:42:09] *** Joins: sunfish (chatzilla@8F761026.B5EF4AF6.E96CA9D8.IP)
[03:43:14] <nrc> what is this?
[03:43:24] <nrc>  /home/nick/rust2/src/compiletest/compiletest.rs:1:1: 1:1 error: can't find crate for `native`
[03:44:13] <nrc> hmm, maybe make check-stage1-* is broken for a while
[03:45:24] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[03:45:44] *** Joins: zimbabao (rajaram@3D086B82.26907A.D2D1FAF0.IP)
[03:46:29] <strcat> nrc: afaik that should still work for you
[03:46:45] <strcat> maybe it's broken in a fresh tree
[03:46:51] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[03:46:51] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14b63fe58 to 146bf3fca: 02http://git.io/N3iJvQ
[03:46:51] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[03:46:52] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[03:46:52] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/DkxXTA
[03:46:52] <ghrust> 13rust/06auto 1456cae9b 15Alex Crichton: comm: Implement synchronous channels...
[03:46:52] <ghrust> 13rust/06auto 141b08b5e 15bors: auto merge of #12991 : alexcrichton/rust/sync-chan, r=brson...
[03:46:53] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[03:47:51] <nrc> strcat: seems to br broken even after deleting as much as possible, configure and make check-stage1-rpass
[03:48:08] <nrc> building stage 1 is fine though
[03:49:10] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[03:50:12] *** Quits: zz_kimundi (kimundi@moz-B2FDAD53.dip0.t-ipconnect.de) (Ping timeout)
[03:50:55] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[03:51:06] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:51:27] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[03:53:28] *** Joins: zz_kimundi (kimundi@moz-116E00E4.dip0.t-ipconnect.de)
[03:53:29] *** zz_kimundi is now known as kimundi
[04:02:08] *** Quits: canhtak (canhtak@moz-1300C4D7.wl.t.ulaval.ca) (Quit: canhtak)
[04:08:05] *** Joins: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net)
[04:08:06] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:10:32] *** Quits: zimbabao (rajaram@3D086B82.26907A.D2D1FAF0.IP) (Ping timeout)
[04:10:52] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:13:02] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:15:20] <sfackler> is there any way to force a type to be Share?
[04:16:17] <acrichto> sfackler: https://github.com/mozilla/rust/blob/master/src/libsync/raw.rs#L87-L94
[04:16:19] <acrichto> (no)
[04:16:37] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[04:16:58] <sfackler> It seems like Mutex<T> should be Share regardless of what T is, right?
[04:17:25] <acrichto> I don't think the compiler currently does that, but it should :(
[04:17:35] <sfackler> :(
[04:18:01] <sfackler> it also feels a bit janky to have MutexGuard have both a public field and implement Deref
[04:18:15] *** Quits: sunfish (chatzilla@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[04:18:20] <acrichto> the public field isn't related to the deref?
[04:18:36] <sfackler> right, but what happens if my wrapped type has a field called cond?
[04:18:55] <acrichto> it's more of just a fact that autoderef can lead to problems like this
[04:19:01] <acrichto> the alternative is to remove autoderef really
[04:19:08] <acrichto> you can always circumvent
[04:19:20] <sfackler> C++'s use of . and -> wrt smart pointers is nice in this context
[04:19:36] <sfackler> but adding -> at this point is probably a bit silly
[04:20:01] *** Joins: sunfish (chatzilla@8F761026.B5EF4AF6.E96CA9D8.IP)
[04:21:11] <strcat> acrichto: could we have something like runtime_dynamic/runtime_native/runtime_green crates where you can only link against one? and only runtime_dynamic would use trait objects - although a lot of that is public atm
[04:21:20] * strcat shrugs
[04:21:32] <acrichto> sounds difficult
[04:25:48] *** Joins: zimbabao (rajaram@E3C95631.85976AEC.BE4CF869.IP)
[04:29:04] <strcat> hm
[04:29:56] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[04:31:50] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[04:32:31] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:34:42] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:36:18] *** Quits: pcwalton (pcwalton@moz-DA87EE4.hsd1.ca.comcast.net) (Quit: pcwalton)
[04:37:29] <sfackler> acrichto: is Share semantically different from Freeze?
[04:37:53] <acrichto> sfackler: yes, atomics are share, but not freeze
[04:37:54] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[04:38:13] <sfackler> are they magic or is there an opt-in screw-you-i'm-freeze?
[04:38:20] <sfackler> er, -send
[04:38:22] <sfackler> gah
[04:38:24] <sfackler> -share
[04:38:25] *** Quits: aurynj (Eon@53E88241.65896F99.364694FC.IP) (Ping timeout)
[04:38:26] <sfackler> asdfasdfasdf
[04:38:41] <acrichto> same as send/pod
[04:40:28] <sfackler> are there cases I'm not thinking of where a non-Share object wouldn't be safe to use in a Mutex?
[04:41:38] <acrichto> Rc<T>
[04:42:04] <acrichto> the bounds on the mutex should be (Send || Share)
[04:43:10] <sfackler> Rc wouldn't be Send though, and Mutex currently just requires Send
[04:43:23] <acrichto> Rc<T> can't be in amutex
[04:43:30] <acrichto> it's neither send nor share
[04:43:32] <sfackler> right
[04:43:53] <sfackler> what I mean is, if I have a T: Send, is there a case where it's a bad idea to have Mutex<T>: Send+Share
[04:43:55] <sfackler> ?
[04:44:12] <acrichto> that's what it's supposed to be
[04:44:20] <sfackler> oh, cool
[04:44:24] <sfackler> is there a bug filed for that?
[04:44:29] <acrichto> not yet
[04:44:34] <acrichto> I should file that...
[04:44:47] <sfackler> I have one half-filled out already
[04:45:00] <acrichto> be my guest :P
[04:45:16] <sfackler> seems like the straightforward solution would be a #[force_share] attribute
[04:46:08] <acrichto> struct UnsafeForceShare { priv foo: () } unsafe fn new() -> UnsafeForceShare;
[04:47:06] <sfackler> as a marker type?
[04:47:10] <acrichto> yeah
[04:47:15] <acrichto> that's what I was thinking at least
[04:47:31] <sfackler> I think it might be a bit weird to have this be a marker type since the kind resolve logic is currently the intersection of all fields
[04:48:03] *** Joins: aurynj (Eon@53E88241.65896F99.364694FC.IP)
[04:48:12] <acrichto> yeah this is a special case, and we should think about this more
[04:48:18] <sfackler> all of the current markers add restrictions, but this removes one
[04:48:36] <acrichto> think of it as an opt-in system though
[04:48:43] <acrichto> all markers go away in that world
[04:48:51] <acrichto> all current markers that is
[04:49:49] *** Quits: zimbabao (rajaram@E3C95631.85976AEC.BE4CF869.IP) (Ping timeout)
[04:50:55] <sfackler> I think the variance ones would stay
[04:51:00] <sfackler> but yeah, NoPod etc would be gone
[04:51:40] <sfackler> I guess then the only option would be an equivalent of #[unsafe_destructor] to put on the impl Share for Foo {}
[04:52:04] <acrichto> oh that's a good point
[04:54:06] <Eridius> woohoo, ICE
[04:54:14] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[04:56:23] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[04:56:50] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[04:56:50] <ghrust> [13rust] 15bors 04force-pushed 06auto from 141b08b5e to 146bf3fca: 02http://git.io/N3iJvQ
[04:56:50] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[04:56:51] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[04:56:51] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/aVPUgw
[04:56:52] <ghrust> 13rust/06auto 1456cae9b 15Alex Crichton: comm: Implement synchronous channels...
[04:56:52] <ghrust> 13rust/06auto 141e6e98c 15bors: auto merge of #12991 : alexcrichton/rust/sync-chan, r=brson...
[04:56:52] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[04:58:39] <sfackler> c.c  R/W lock protected lock
[05:01:56] *** Joins: lkuper (lkuper@moz-61339218.dyn.optonline.net)
[05:13:51] <nrc> Why can't type parameters in structs have bounds?
[05:14:11] <strcat> nrc: used to be possible, now it's not
[05:14:12] <nrc> e.g., why is `struct S<X: T>;` illegal?
[05:14:19] <nrc> strcat: why so?
[05:14:22] <strcat> nrc: because you can just put it on the impl instead
[05:14:24] <strcat> and use a private field
[05:14:29] <Eridius> you can put the bounds on the implementation, although I've always wondered why you can't put it on the struct
[05:14:36] <strcat> nrc: it discourages making needlessly strict implementations, as we did before
[05:14:43] <strcat> because you can have some methods on one impl with fewer bounds
[05:14:50] <strcat> and it can still be useful
[05:15:03] <strcat> we could have it again afaik, but we can't just copy-paste all the bounds everywhere as we did before
[05:15:18] <nrc> OK, thanks strcat and Eridius
[05:15:53] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:16:22] <strcat> nrc: I think it mostly has to do with not having more than one way to do the same thing
[05:18:00] <nrc> fair enough
[05:18:02] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:18:17] <nrc> although that is my least favourite language design principle since it is so subjective
[05:18:27] <nrc> I agree with the concept, but still...
[05:20:32] <strcat> nrc: on an impl, we could even show a warning if a type bound is unused
[05:20:46] <strcat> since we know from the code which are needed (excluding some like Share)
[05:21:17] <strcat> putting them on the struct is kind of weird, since you need them on the impl anyway
[05:21:21] <nrc> that's nice
[05:21:51] <Eridius> strcat: That would be nice, except it's unfortunate that some bounds would not be able to be checked
[05:22:05] * nrc did not mean that sarcastically, honest!
[05:33:03] *** Joins: edwardw (Mibbit@9EF774F0.49850AF2.29DE6883.IP)
[05:34:08] <bjz> nrc: it mixes data with implementation requirements
[05:37:32] <nrc> So, if there is a field in a struct with type ~T<X> and in the def of T, the formal for X has a bound. That is only checked if there is an impl for that struct?
[05:37:34] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[05:37:56] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[05:37:56] *** ChanServ sets mode: +o tjc
[05:39:48] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[05:41:24] <sfackler> X only has a bound for some methods defined on T
[05:41:58] <sfackler> or is T a trait?
[05:43:13] <strcat> you're allowed to put bounds on trait type parameters afaik
[05:43:22] <strcat> just not on structs/enums
[05:43:32] <sfackler> in any case, you can't construct the struct for an X that doesn't have the right bound because you can't construc the ~T<X>
[05:43:58] <nrc> T is a trait with bounds on X - `trait T<X: B> {...}`
[05:45:05] <nrc> and S is `struct S<X> { f: ~T<X> }`
[05:46:11] <nrc> I expect `impl<X: B> for S<X>` to be ok, but not `impl<X> for S<X>`
[05:46:15] <nrc> is that how we check?
[05:46:54] <nrc> rusti: trait T<X: B> {} struct S<X> { f: ~T<X> }
[05:46:55] -rusti- <anon>:10:20: 10:21 error: attempt to bound type parameter with a nonexistent trait `B`
[05:46:55] -rusti- <anon>:10         trait T<X: B> {} struct S<X> { f: ~T<X> }
[05:46:55] -rusti-                              ^
[05:46:55] -rusti- error: aborting due to previous error
[05:46:55] -rusti- application terminated with error code 101
[05:47:09] <nrc> rusti: trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> }
[05:47:10] -rusti- <anon>:10:37: 10:61 warning: code is never used: `S`, #[warn(dead_code)] on by default
[05:47:10] -rusti- <anon>:10         trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> }
[05:47:10] -rusti-                                               ^~~~~~~~~~~~~~~~~~~~~~~~
[05:47:10] -rusti- ()
[05:47:21] <nrc> rusti: trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> } impl<X: B> for S<X>
[05:47:22] -rusti- pastebinned 7 lines of output: http://sprunge.us/DNbV
[05:47:41] <nrc> rusti: trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> } impl<X: B> S<X>
[05:47:41] -rusti- <anon>:11:5: 11:6 error: expected `{` but found `}`
[05:47:42] -rusti- <anon>:11     };
[05:47:42] -rusti-               ^
[05:47:42] -rusti- application terminated with error code 101
[05:47:47] <nrc> rusti: trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> } impl<X: B> S<X>;
[05:47:48] -rusti- <anon>:10:77: 10:78 error: expected `{` but found `;`
[05:47:48] -rusti- <anon>:10         trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> } impl<X: B> S<X>;
[05:47:48] -rusti-                                                                                       ^
[05:47:48] -rusti- application terminated with error code 101
[05:47:54] <nrc> rusti: trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> } impl<X: B> S<X> {}
[05:47:55] -rusti- <anon>:10:37: 10:61 warning: code is never used: `S`, #[warn(dead_code)] on by default
[05:47:55] -rusti- <anon>:10         trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> } impl<X: B> S<X> {}
[05:47:55] -rusti-                                               ^~~~~~~~~~~~~~~~~~~~~~~~
[05:47:57] -rusti- ()
[05:48:02] <nrc> rusti: trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> } impl<X> S<X> {}
[05:48:03] -rusti- <anon>:10:37: 10:61 warning: code is never used: `S`, #[warn(dead_code)] on by default
[05:48:03] -rusti- <anon>:10         trait B {} trait T<X: B> {} struct S<X> { f: ~T<X> } impl<X> S<X> {}
[05:48:04] -rusti-                                               ^~~~~~~~~~~~~~~~~~~~~~~~
[05:48:07] -rusti- ()
[05:48:19] <nrc> hmm, so that last one is surprising to me
[05:49:02] <nrc> I guess we must check when we instantiate S?
[05:49:23] <sfackler> you can't instantiate S unless X: B because you can't make the f value in the first place
[05:50:38] <nrc> hmm, so only check bounds in fields when a struct is instantiated
[05:50:44] <nrc> *so we
[05:51:30] <nrc> that seems a bit too C++/structural for my liking, but ho-hum
[05:54:29] <strcat> nrc: sounds like a good argument for adding back bounds on structs
[05:54:32] <strcat> and enforcing that you include that
[05:59:14] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:01:31] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:02:50] *** Quits: japaric (japaric@E3A27319.2A33E3C8.A936879B.IP) (Ping timeout)
[06:04:13] *** Quits: edwardw (Mibbit@9EF774F0.49850AF2.29DE6883.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:06:10] <Eridius> sigh. Write a bunch of code, it compiles with just a few minor bugs. Write two tests, spend forever getting them to compile
[06:07:05] *** Joins: edwardw (edwardw@E761717E.1B2F6624.7F41E82D.IP)
[06:07:56] <Eridius> augh, Vec doesn't support indexing?
[06:08:29] <sfackler> Index trait reform needs to be done first
[06:08:33] <Eridius> :/
[06:08:43] * sfackler hopes that Vec is painful to work with that someone actually gets around to doing it
[06:09:19] <sfackler> *painful enough
[06:11:07] *** Quits: lkuper (lkuper@moz-61339218.dyn.optonline.net) (Quit: lkuper)
[06:15:59] *** Joins: japaric (japaric@A6AF1FF5.D1A0B378.5C7588CA.IP)
[06:16:39] <Eridius> grr, .head() doesn't exist on Vec, and there's apparently no .mut_head() in slice
[06:17:41] <sfackler> Eridius: init()?
[06:18:00] <Eridius> sfackler: that's different
[06:18:06] <Eridius> that returns a slice containing all but the last element
[06:18:34] <Eridius> oh well, at least I can do v.as_mut_slice()[0] after testing for v.is_empty() separately
[06:19:19] <Eridius> oh goddammit, borrowck thinks my borrow is still alive
[06:20:55] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:23:11] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:25:21] *** Joins: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP)
[06:28:53] *** Joins: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP)
[06:30:38] *** Quits: japaric (japaric@A6AF1FF5.D1A0B378.5C7588CA.IP) (Ping timeout)
[06:31:01] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[06:32:56] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[06:35:38] *** Joins: japaric (japaric@FCB3637C.59294C36.95AFB88D.IP)
[06:38:17] *** Quits: ChrisMorgan (chris@moz-8DCBEA52.vic.adsl.internode.on.net) (Ping timeout)
[06:42:37] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[06:44:47] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[06:46:12] *** Quits: edwardw (edwardw@E761717E.1B2F6624.7F41E82D.IP) (Quit: Leaving...)
[06:56:50] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[06:56:50] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/aVPUgw
[06:56:50] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[07:01:54] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[07:01:54] <ghrust> [13rust] 15bors pushed 1 new commit to 06auto: 02http://git.io/g5SopQ
[07:01:54] <ghrust> 13rust/06auto 14b1091c3 15bors: auto merge of #13063 : brson/rust/dist, r=alexcrichton...
[07:01:54] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[07:01:56] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[07:01:56] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/jhTwbg
[07:01:56] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[07:04:20] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:05:06] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:05:44] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[07:05:44] *** ChanServ sets mode: +o tjc
[07:06:26] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:08:33] *** Quits: aurynj (Eon@53E88241.65896F99.364694FC.IP) (Ping timeout)
[07:24:02] *** Joins: balpert_ (sid15886@moz-A42E5B7B.irccloud.com)
[07:26:00] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:28:12] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:32:13] *** Joins: edwardw (Mibbit@E761717E.1B2F6624.7F41E82D.IP)
[07:32:31] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Client exited)
[07:36:20] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[07:39:09] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[07:42:46] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[07:43:49] *** Quits: edwardw (Mibbit@E761717E.1B2F6624.7F41E82D.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:47:39] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[07:49:50] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[07:51:23] *** flaper87|afk is now known as flaper87
[07:53:44] <flaper87> o/
[07:58:12] *** Joins: mediocrity (Thunderbir@moz-8A2E9A09.bredband.comhem.se)
[07:59:29] <strcat> does anyone remember the link to that gist explaining the lifetime rules in general?
[07:59:36] <strcat> probably a bit out of date but that's okay
[07:59:42] <strcat> s/general/detail/
[08:04:24] <flaper87> strcat: I don't have it handy but I think it was aatch who created it
[08:04:34] <strcat> it's okay the in-source documentation is fine for this
[08:05:00] <flaper87> strcat: https://gist.github.com/Aatch/5734372
[08:07:31] * strcat spreading rust propaganda
[08:09:22] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:11:33] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:11:53] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[08:11:53] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/MG4WPA
[08:11:53] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[08:16:48] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[08:16:48] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/Q-25KA
[08:16:48] <ghrust> 13rust/06auto 147dfa4b2 15noam: docs: named lifetimes...
[08:16:48] <ghrust> 13rust/06auto 144b224af 15noam: Added suggested notes...
[08:16:48] <ghrust> 13rust/06auto 14085f08d 15bors: auto merge of #13106 : CLUSTERfoo/rust/docs/labelled_breaks, r=brson...
[08:16:49] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[08:16:50] *** Joins: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP)
[08:16:50] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/MqVmqg
[08:16:50] *** Parts: ghrust (ghrust@5AC7F92B.6A2AE50.F3114085.IP) ()
[08:18:45] *** Joins: eddyb (eddy@F8B50789.F33C1089.FB866788.IP)
[08:20:56] <strcat> haha, I think I just convinced a language developer (Leaf language) to add region typing
[08:21:24] * strcat fails to convert someone to rust ;)
[08:22:33] <eddyb> http://www.phoronix.com/scan.php?page=news_item&px=MTUxMDA hmm
[08:27:09] <pnkfelix> this page is colored crazily http://leaflang.org/features/index.html
[08:27:32] <pnkfelix> (presumably automatic syntax highlighting gone awry)
[08:27:40] *** Joins: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net)
[08:27:40] *** ChanServ sets mode: +o huon
[08:31:01] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:31:14] * flaper87 had never heard of leaf language before
[08:31:51] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[08:33:10] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:33:41] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[08:34:21] <flaper87> btw, good news ppl, I got approval to dedicate some of my working hours to Rust. w0000000000000000000000000000000000000000000000000t 
[08:34:29] * flaper87 hopes that everyone is as exited as he is
[08:34:37] <strcat> those are the hours you spend on reddit, right? ;p
[08:34:59] <flaper87> strcat: haha, kind of :P
[08:35:21] *** Joins: doener (bs@moz-AA189A5A.unitymedia.biz)
[08:39:39] *** Joins: bvssvni (Mibbit@moz-A47B6F8E.bb.online.no)
[08:44:46] *** Quits: bvssvni (Mibbit@moz-A47B6F8E.bb.online.no) (Quit: http://www.mibbit.com ajax IRC Client)
[08:52:48] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[08:54:54] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[08:58:23] *** Joins: eibwen (kvirc@moz-80084333.dip0.t-ipconnect.de)
[09:14:23] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:16:37] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:31:49] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[09:31:50] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/CYFf0g
[09:31:50] <ghrust> 13rust/06auto 144b41beb 15Steven Stewart-Gallus: Cleanup usage of StdRng::new and task_rng...
[09:31:50] <ghrust> 13rust/06auto 149fd8d17 15bors: auto merge of #13111 : sstewartgallus/rust/cleanup-stdrng-new, r=huonw...
[09:31:50] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[09:36:04] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:37:41] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[09:38:02] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:38:13] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[09:39:14] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 31.0a1/20140323030203])
[09:39:47] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[09:48:03] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Ping timeout)
[09:57:05] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[09:57:44] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[09:58:54] *** Joins: glaebhoer1 (glaebhoerl@moz-3590251D.kabelnet.hu)
[10:00:01] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:01:49] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[10:01:49] <ghrust> [13rust] 15bors 04force-pushed 06auto from 149fd8d17 to 14b1091c3: 02http://git.io/N3iJvQ
[10:01:49] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[10:01:49] *** Joins: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP)
[10:01:50] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/-NUibg
[10:01:50] <ghrust> 13rust/06auto 149021a3f 15Flavio Percoco: rustc: Completely forbid borrows of unsafe statics...
[10:01:50] <ghrust> 13rust/06auto 145d5634a 15bors: auto merge of #13083 : FlaPer87/rust/issue-13005-borrow-unsafe-static, r=nikomatsakis...
[10:01:50] *** Parts: ghrust (ghrust@4BC7FFDD.6A2AE50.F3114085.IP) ()
[10:06:01] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Connection reset by peer)
[10:06:01] *** Joins: ssira_ (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[10:19:16] *** Quits: ssira_ (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[10:19:24] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:19:37] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[10:21:18] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[10:21:36] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:25:35] *** Quits: sigma (sigma@moz-15A267A9.range109-152.btcentralplus.com) (Client exited)
[10:32:49] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[10:34:42] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[10:41:06] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[10:43:14] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[10:43:14] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[10:53:56] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[10:55:20] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[10:56:45] *** Quits: darnuria (darnuria@moz-AB6EB255.ip-91-121-133.eu) (Quit: WeeChat 0.4.3)
[10:57:27] *** Joins: darnuria (darnuria@moz-AB6EB255.ip-91-121-133.eu)
[10:57:27] *** Joins: bvssvni (Mibbit@moz-A47B6F8E.bb.online.no)
[10:59:30] *** Joins: aurynj (Eon@C498BDEC.C264657C.C6282BC4.IP)
[11:01:07] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[11:02:46] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:03:26] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[11:05:01] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:11:07] <bvssvni> should I open up a new pull request or is it possible to reopen an existing closed one?
[11:11:29] <cmr> bvssvni: you can reopen it, update by pushing to the branch
[11:11:31] <huon> bvssvni: if you can't open it, we can
[11:11:39] <cmr> you might need a github collaborator to reopen it
[11:11:39] <huon> (re-open)
[11:11:49] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[11:11:50] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/-NUibg
[11:11:50] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[11:11:56] <bvssvni> https://github.com/bvssvni/rust
[11:12:04] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[11:13:22] <bvssvni> here is the pull request https://github.com/mozilla/rust/pull/13109
[11:13:53] <bvssvni> I added a new test run-pass
[11:14:11] *** Quits: glaebhoer1 (glaebhoerl@moz-3590251D.kabelnet.hu) (Quit: )
[11:14:45] <eddyb> bvssvni: you should use different branch names ;)
[11:15:05] <eddyb> what's the difference between forbid and deny?
[11:15:29] <bvssvni> eddyb: what branch names?
[11:15:58] <bvssvni> eddyb: did you meant to create a branch for that particular fix?
[11:16:01] <eddyb> git fetch upstream master && git checkout upstream/master && git checkout -b feature-branch-name
[11:16:03] <eddyb> bvssvni: yeah
[11:16:33] <eddyb> something like those three commands is what I use to safely open a clean new branch on top of master
[11:16:53] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[11:16:53] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/vzIPhg
[11:16:53] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[11:16:54] *** Joins: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP)
[11:16:55] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/Eu5TLw
[11:16:55] <ghrust> 13rust/06auto 144b41beb 15Steven Stewart-Gallus: Cleanup usage of StdRng::new and task_rng...
[11:16:55] <ghrust> 13rust/06auto 14aab1775 15bors: auto merge of #13111 : sstewartgallus/rust/cleanup-stdrng-new, r=huonw...
[11:16:55] *** Parts: ghrust (ghrust@4089EBDC.6A2AE50.F3114085.IP) ()
[11:18:36] * bvssvni afk
[11:22:15] *** Joins: canhtak (canhtak@moz-1300C4D7.wl.t.ulaval.ca)
[11:24:26] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:26:39] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:31:02] *** Quits: gimpf (gimpf@moz-F3893FF0.adsl.highway.telekom.at) (Ping timeout)
[11:34:13] *** Quits: zimbabao (rajaram@47769425.AE842F9B.81C3DAA1.IP) (Ping timeout)
[11:34:32] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[11:37:03] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[11:37:14] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[11:38:28] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[11:45:22] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Connection reset by peer)
[11:45:43] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[11:46:08] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[11:47:56] *** Joins: gimpf (gimpf@moz-CFB7E1A1.adsl.highway.telekom.at)
[11:48:17] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[11:49:46] <eddyb> huon: okay
[11:49:49] * huon didn't understand eddyb's wording there
[11:50:04] <eddyb> maybe the helper doesn't need to change much
[11:50:29] <eddyb> huon: I was kinda afraid we just got a shiny new lifetime helper and the hard parts in it wouldn't be required if it runs before regionck
[11:50:36] <eddyb> but maybe not
[11:50:59] <eddyb> huon: (I would feel bad because there was quite some work put into it)
[11:51:09] <huon> don't the hard parts of the error messages require the info from regionck?
[11:51:27] <eddyb> regionck works within functions
[11:51:48] <huon> and the error messages use the info from inside the function, right?
[11:51:52] <eddyb> the error is technically on the function definition
[11:52:03] <huon> I.e. the actually examine the regions the return type should have
[11:52:07] <eddyb> it happens to cause errors within the function because we don't stop it early
[11:52:07] <huon> s/the/it/
[11:52:36] <huon> you mean the error of returning an &int without an lifetime?
[11:52:44] <eddyb> yeah
[11:53:04] <huon> but... that's the canonical case in which the "did you mean these lifetimes" is useful
[11:53:46] <eddyb> huon: but why wait until regionck figures out you're not returning something 'static?
[11:53:48] <huon> so much so I'd almost be against a patch that "simplified" how &int returns were handled and moved errors earlier
[11:53:51] <eddyb> because that's the only thing that works AFAIK
[11:53:59] <huon> or a transmute
[11:54:08] <huon> you should wait to give the nicer error messages
[11:54:24] <huon> good error messages == huge help
[11:54:25] <eddyb> huon: you can still do fn foo<'a, 'b>(&'a T) -> &'b T if you want a disconnected lifetime
[11:54:39] <huon> eddyb: yeah... ?
[11:54:41] <eddyb> or just 'a on the result I guess
[11:54:48] <huon> I'm talking about something slightly different
[11:54:58] <huon> I definitely agree that returning a &T is peculiar
[11:55:03] <eddyb> you don't lose functionality, which you were worried about earlier
[11:55:05] <huon> and should preferably be out-lawed
[11:55:11] <huon> that was a glib suggestion
[11:55:16] <huon> not a real use case :P
[11:55:29] <eddyb> huon: regionck gives worse errors than "missing explicit lifetime"
[11:55:54] <huon> but now it gives "did you mean these lifetimes ...", which are awesome-super-help
[11:55:54] <eddyb> the helper can still work early
[11:56:03] <huon> how? it needs to look at the function body?
[11:56:45] <eddyb> huon: does it actually figure the right one for fn foo(a: &A, b: &B) -> &C {...}?
[11:56:51] <huon> eddyb: sure
[11:56:55] <eddyb> well, crap
[11:56:56] <huon> rusti: version
[11:56:57] -rusti- rustc 0.10-pre (6bf3fca 2014-03-24 18:11:51 -0700)
[11:57:04] *** Quits: aurynj (Eon@C498BDEC.C264657C.C6282BC4.IP) (Ping timeout)
[11:57:19] <huon> rusti: struct Foo { x: int } fn foo(x: &Foo, y: &int) -> &int { y }
[11:57:20] -rusti- pastebinned 11 lines of output: http://sprunge.us/TXQY
[11:57:29] <huon> rusti: struct Foo { x: int } fn foo(x: &Foo, y: &int) -> &int { &x.x }
[11:57:30] -rusti- pastebinned 8 lines of output: http://sprunge.us/WVHG
[11:57:38] <huon> ktt3ja is magical
[11:57:48] <eddyb> huon: I'd still like to show the early error, even if we run regionck in zombie mode for the note
[11:57:54] <cmr> they really are.
[11:58:07] <huon> rusti: struct Foo<'a> { x: &'a int } fn foo(x: Foo, y: &int) -> &int { x.x }
[11:58:07] <eddyb> why is it still showing the note before the error?
[11:58:07] -rusti- pastebinned 8 lines of output: http://sprunge.us/LdWh
[11:58:17] <huon> look at that^
[11:58:20] <huon> it Just Works
[11:58:43] * huon was impressed when he saw how comprehensive it was
[11:58:53] <huon> eddyb: because no-one fixed it?
[11:59:19] <eddyb> I guess the real answer is "because regionck errors are buffered"
[11:59:39] <huon> no?
[11:59:49] <eddyb> there's something weird going on with inference reporting in general
[11:59:55] <eddyb> huon: well, I hope it's simple
[11:59:58] <huon> presumably it's because the error checking code runs before the real .span_err ?
[12:00:09] <eddyb> but as you've just shown me, when I think something is simple, it probably isn't
[12:00:12] * huon source-dives
[12:00:45] <eddyb> huon: I've seen code that stores enum values representing possible error types in vectors and shows them later
[12:00:49] <huon> now where is that error_reporting module... :S
[12:00:59] <eddyb> exactly that
[12:01:03] <eddyb> typeck/infer, maybe?
[12:01:08] <huon> yup, found it
[12:01:13] <huon> that's correct
[12:01:51] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[12:01:51] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14aab1775 to 145d5634a: 02http://git.io/N3iJvQ
[12:01:51] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[12:01:55] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[12:01:55] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/yGlkbA
[12:01:55] <ghrust> 13rust/06auto 14b19261a 15Alex Crichton: green: Remove the dependence on the crate map...
[12:01:55] <ghrust> 13rust/06auto 143ccad75 15Alex Crichton: rustc: Remove all crate map support...
[12:01:56] <ghrust> 13rust/06auto 14e2ae458 15Alex Crichton: doc: Update the runtime guide with green changes...
[12:01:58] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[12:03:05] <huon> eddyb: I'm pretty sure it's just because https://github.com/mozilla/rust/blob/master/src/librustc/middle/typeck/infer/error_reporting.rs#L637 is above those two loops
[12:03:31] <eddyb> huon: oh then that's easier
[12:04:29] <eddyb> rusti: struct Foo { x: int } impl Foo { fn foo(&self, y: &int) -> &int { y } }
[12:04:30] -rusti- pastebinned 26 lines of output: http://sprunge.us/bPgW
[12:04:58] <huon> :(
[12:05:12] <eddyb> I expected a failure
[12:05:43] <doener> hm, what's with those 400MB shaved off of compiling librustc that I saw in TWiR? Watching RSS in top shows 100MB more than a few weeks ago
[12:05:50] <eddyb> huon: where's the early return?
[12:05:56] *** Quits: canhtak (canhtak@moz-1300C4D7.wl.t.ulaval.ca) (Quit: canhtak)
[12:06:11] <eddyb> `if !same_regions.is_empty() {`
[12:06:16] <cmr> doener: the introduction of Vec made a lot of bloat.
[12:06:27] <cmr> doener: so, the gains probably haven't made up for that yet.
[12:06:30] * huon pokes cmr for IRFY
[12:06:45] <cmr> Running &Command{name: ~"sh", args: ~[~"-c", ~"cd /home/cmr/hacking/rust-benching/build; auto-bench.py"]}
[12:06:51] <cmr> Approximately ~9 hours ago :)
[12:06:55] * cmr kicks off rsync
[12:06:55] <huon> \o/
[12:07:21] <eddyb> cmr: what is that from?
[12:07:28] <cmr> multibuilder's debug output
[12:07:33] <cmr> which still uses {:?}
[12:07:35] <eddyb> ahh
[12:07:35] <huon> doener: theoretically it should be less than it was a week (or week and a half) ago
[12:07:47] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:07:49] <huon> ... theoretically
[12:08:21] <cmr> wow, why is there only data for 9 commits.
[12:08:48] <cmr> I think the builder is still unhealthy :(
[12:08:57] <cmr> I'll actually have to like debug it at this rate
[12:09:03] <cmr> instead of just poking it with a shotgun
[12:09:11] <doener> huon: I only watched my (always failing) bool-as-i1 builds during the last ~2 weeks :-/
[12:09:25] <doener> huon: and those were based on a rather old state of upstream
[12:09:26] <huon> doener: oh ok
[12:09:35] <huon> cmr: more shotgun should be fine
[12:09:58] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:09:59] <strcat> doener: bool as i1?! mmmmmm
[12:10:13] <eddyb> cmr: that could explain the weird patterns in the graph
[12:10:17] <strcat> it actually used to be i1 but we stored it wrong ;s (as i1)
[12:10:19] <cmr> eddyb: no it wouldn't :p
[12:10:31] <eddyb> cmr: missing PRs
[12:10:37] <cmr> ok, sure.
[12:10:41] <cmr> but that's just missing data
[12:10:48] <cmr> doesn't affect the validity of the data
[12:10:51] <huon> eddyb: like the last 2 weeks?
[12:10:53] <cmr> only the conclusions you draw from it.
[12:11:03] <huon> erm, 1 week
[12:11:08] <eddyb> causing doc-only PRs to show up as spikes
[12:11:34] <doener> strcat: why is storing as i1 (in IR) wrong though? Datalayout defines i1 to be stored as 8 bits
[12:12:01] <strcat> doener: dunno, but clang stores it as i8 and passes as i1 zeroext
[12:12:34] <strcat> maybe our data layout stuff was wrong before
[12:12:37] <doener> strcat: according to a comment in the clang sources, that's just because they sometimes already have i8 values, so always using i8 is easier
[12:12:43] <strcat> ah
[12:13:30] <eddyb> from #define BOOL unsigned char :P?
[12:13:54] <strcat> clang's bool is always _Bool or bool, so it's always like ours
[12:14:01] <strcat> they created range asserts for it
[12:14:16] <eddyb> as long as short-circuiting works, I'll be happy
[12:14:33] <eddyb> right now it only works for side effects, not actual optimizations
[12:14:59] <doener> http://clang.llvm.org/doxygen/classclang_1_1CodeGen_1_1CodeGenFunction.html#a8eff252055cf16c4eb408282653d0797
[12:15:32] <doener> http://clang.llvm.org/doxygen/CGExpr_8cpp_source.html#l01150
[12:15:34] <eddyb> so pure_a() && pure_b() is just as bad as pure_a() & pure_b() (which kinda requires a SAT sometimes to be useful)
[12:15:34] <doener> better
[12:15:42] <eddyb> though we might be doing it wrong
[12:15:59] <eddyb> (other than bool not being i1)
[12:17:34] <doener> https://github.com/dotdash/rust/commit/67059bed5655ac30b5166ae41fca6bde2249a36b -- that's what I have so far. Segfaults when compiling stage2 libstd
[12:17:38] <doener> no idea why
[12:17:47] <eddyb> doener: hang on, EmitFromMemory looks wrong
[12:17:59] <eddyb> doener: it doesn't output a range assert
[12:18:02] <huon> doener: I assume you've got backtraces etc. for the segfault?
[12:18:31] <doener> huon: https://gist.github.com/dotdash/76b61d664f355c3526b2
[12:19:25] <eddyb> doener: how did you get this diff? https://github.com/dotdash/rust/commit/67059bed5655ac30b5166ae41fca6bde2249a36b#diff-bbf3b98bbd9302b37d19a20e1cf4eb34L1407
[12:19:39] <eddyb> since this didn't change https://github.com/dotdash/rust/commit/67059bed5655ac30b5166ae41fca6bde2249a36b#diff-4a004ea3dd0e6de604632add23bde70aR92
[12:19:42] <doener> eddyb: previous commit on that branch
[12:20:28] <eddyb> rebase failure
[12:20:31] <doener> eddyb: or maybe you're asking something else than I suspect?
[12:20:44] <eddyb> wasn't obvious with just the last commit
[12:21:22] <eddyb> doener: you need to compile without optimizations and with debug info
[12:21:30] <doener> ah, yeah, failed to move that as a fixup into the previous commit
[12:21:32] <eddyb> to figure out the segfault
[12:21:39] <doener> eddyb: doesn't segfault without optz
[12:21:46] <eddyb> oh, right :))
[12:22:09] <eddyb> just debuginfo then, and the minimal amount of optimizations necessary to trigger it
[12:22:31] <eddyb> doener: this will be a nasty one to track down, I'm afraid
[12:22:42] <doener> eddyb: to say the least ;-)
[12:23:13] <eddyb> doener: I'd #[inline(never)] the entirety of syntax::fold
[12:23:18] <doener> eddyb: I know it's coming from simplify_ast, the match for IIItemRef, and "i" is messed up
[12:23:28] <eddyb> ohh?
[12:23:39] <eddyb> doener: then you can maybe take a look at the IR for that?
[12:23:44] <huon> eddyb: looks like doener knows how to debug things ;)
[12:23:50] <eddyb> better than me
[12:24:15] <eddyb> huon: probably spent a few days on it already :P
[12:24:16] <doener> or maybe I spent loads of time doing it the stupid way. Just as possible ;-)
[12:24:35] <doener> 2 days combined I guess... Way too little time to spent on rust lately
[12:24:43] *** Joins: canhtak (canhtak@moz-1300C4D7.wl.t.ulaval.ca)
[12:25:15] <huon> either way, I think eddyb could've asked questions about the info doener knows before instructing on how to debug :)
[12:25:49] <doener> nah, it's fine. Sometimes that makes me think about stuff I missed before
[12:26:44] <doener> e.g. I guess I'll try --opt-level=1 this evening, maybe that makes something obvious
[12:26:51] <doener> didn't think of that before
[12:26:52] <huon> is it the match in simplify_ast that's breaking things? it seems unlikely, given the enum has 3 variants (and I assume you're not touching enum discriminants at all anyway)
[12:26:59] <cmr> http://buildbot.rust-lang.org/builders/auto-win-32-opt/builds/4960/steps/compile/logs/stdio
[12:27:10] <cmr> I can't see how this isn't a -j2 bug
[12:27:22] <cmr> https://gist.github.com/cmr/dfd846e8b09ed158d812
[12:27:57] <cmr> unless the linker is just flat out removing liblibc because it contains nothing but metadata
[12:27:58] <eddyb> doener: if you know already where it fails, put #[inline(never)] around it (including functions it calls) to get maybe more information from back traces - though -g should give you line numbers, I would think
[12:27:58] <huon> cmr: that gist doesn't show that the build succeeded?
[12:28:00] <cmr> but I find that unlikely.
[12:28:32] <cmr> well, it didn't.
[12:28:49] <eddyb> "error: dylib output requested, but some depenencies could not be found in the dylib format" huh
[12:28:52] <cmr> oh wait a second I might be dumb
[12:29:06] <huon> do you need 2 crate_type attributes?
[12:29:13] <cmr> already there
[12:29:16] <cmr> the problem seems to be
[12:29:21] <cmr> `extern crate libc;`
[12:29:29] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:29:33] <cmr> really ought to be `#[cfg(not(stage0))] extern crate libc;` ?
[12:29:44] <cmr> no that shouldn't matter...
[12:29:44] <huon> should it?
[12:30:41] * cmr sometimes gets staging mixed up
[12:31:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:32:54] *** Joins: sigma (sigma@moz-15A267A9.range109-152.btcentralplus.com)
[12:35:02] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[12:35:23] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[12:37:10] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[12:50:13] *** Quits: sunfish (chatzilla@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[12:51:11] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[12:51:36] *** Joins: sunfish (chatzilla@8F761026.B5EF4AF6.E96CA9D8.IP)
[12:53:17] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[12:53:43] *** Joins: zimbabao (rajaram@52A9E86D.EA743218.BE4CF869.IP)
[12:56:54] <doener> heh, before the call to simplify_ast, there's a similar match, in which "i" is alright
[12:57:26] <doener> i.e. the debug!() call right before the call gives correct output
[13:10:08] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[13:12:48] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:14:58] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:17:29] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[13:21:08] <herrwolfe45> hi - does travis ever run the `run-make` tests?
[13:22:14] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[13:23:23] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[13:26:55] *** Joins: huon1 (Thunderbir@moz-7CC720CF.lns20.syd7.internode.on.net)
[13:27:23] <huon1> herrwolfe45: I don't think travis runs them, but the do run on the buildbots before any PR is merged (although not on every platform)
[13:27:50] *** Quits: huon (Thunderbir@moz-826BD85A.lns20.syd6.internode.on.net) (NickServ (GHOST command used by huon1))
[13:28:00] *** huon1 is now known as huon
[13:29:18] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[13:30:10] <herrwolfe45> ok - thanks
[13:34:31] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:34:56] *** Joins: edwardw (edwardw@23A73486.E441A06D.FAED9FFC.IP)
[13:35:56] <eddyb> nmatsakis: with GADTs, we can have two middle::ty::sty types, one with ty_infer, one without, but with 0 duplication :D
[13:36:23] <eddyb> nmatsakis: same goes for pre-expansion AST, it can contain ident-level macros
[13:36:37] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[13:36:56] *** Joins: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP)
[13:36:56] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/c4w9Lw
[13:36:56] <ghrust> 13rust/06auto 14451160f 15Steven Stewart-Gallus: Cleanup fixed issue #10734 workaround
[13:36:56] <ghrust> 13rust/06auto 14ff2f2e8 15Steven Stewart-Gallus: Correct issue workaround references
[13:36:56] <ghrust> 13rust/06auto 141f5571a 15bors: auto merge of #13122 : sstewartgallus/rust/cleanup-10734-workarounds, r=alexcrichton...
[13:36:58] *** Parts: ghrust (ghrust@23EC81EC.6A2AE50.F3114085.IP) ()
[13:37:28] <eddyb> but I need to open an RFC for it
[13:40:49] <nmatsakis> eddyb: we don't need GADTs for this.
[13:41:00] <eddyb> either HKT or GADTs
[13:41:03] <nmatsakis> neither
[13:41:05] <eddyb> and GADTs are so simple :D
[13:41:15] <nmatsakis> we don't need anything we don't have, well, I guess it hinges on your def'n of duplication
[13:41:31] <nmatsakis> I mean, I implemented this ... years ago.
[13:41:43] <nmatsakis> around the same time I implemented regions :)
[13:41:47] <nmatsakis> sadly I did them on two different branches...
[13:42:01] <nmatsakis> I have to confess though that without default methods it was painful
[13:42:05] <nmatsakis> so I never landed it
[13:42:16] <nmatsakis> I don't think it'd be particularly bad now though
[13:44:31] <eddyb> nmatsakis: GADTs are pretty simple though
[13:44:45] <eddyb> (from an implementation PoV)
[13:45:17] <nmatsakis> Perhaps, but we're still working on cleaning up, formalizing, and fully implementing the type system we have.
[13:45:25] <eddyb> hah
[13:46:08] <eddyb> nmatsakis: I like that it allows for variable layout without HKTs
[13:49:01] <pnkfelix> nmatsakis: we on to talk in 12 min?
[13:54:49] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[13:54:52] <nmatsakis> pnkfelix: yes
[13:55:13] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Input/output error)
[13:55:29] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[13:56:11] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[13:56:52] *** Quits: sigma (sigma@moz-15A267A9.range109-152.btcentralplus.com) (Client exited)
[13:56:58] *** Joins: sigma (sigma@moz-15A267A9.range109-152.btcentralplus.com)
[13:58:06] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[13:58:29] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:17:54] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:18:30] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[14:20:02] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:22:31] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Input/output error)
[14:28:01] *** Quits: sunfish (chatzilla@8F761026.B5EF4AF6.E96CA9D8.IP) (Ping timeout)
[14:39:33] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[14:41:40] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[14:43:46] *** Joins: sunfish (chatzilla@13F2CEC5.7672369.D8E68FF6.IP)
[14:49:32] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[14:53:38] *** Quits: luz (lu.cy@moz-CD18B14B.customer.cdi.no) (Ping timeout)
[14:53:55] <nmatsakis> edwardw: ping
[14:54:09] <edwardw> nmatsakis: yes sir
[14:54:20] *** Joins: aurynj (Eon@C498BDEC.C264657C.C6282BC4.IP)
[14:54:48] *** Joins: luz (lu.cy@moz-CD18B14B.customer.cdi.no)
[14:55:38] <nmatsakis> edwardw: I wanted to talk to you about your PR -- I'd like to cut it up :)
[14:55:51] <edwardw> sure
[14:55:54] <nmatsakis> in particular, can you make a PR that makes it an error if any inference yields bivariant
[14:56:04] <nmatsakis> and (presuambly) add the  required markers
[14:56:19] <nmatsakis> I'm not sure if that will fail to build already, hopefully not
[14:56:24] <edwardw> but how about marker types themselves?
[14:56:45] <nmatsakis> they shouldn't cause a problem -- they are hardcoded to invariante tc
[14:56:49] <nmatsakis> note that I did not say:
[14:56:51] <nmatsakis> error if something is unused
[14:56:56] <nmatsakis> I said "error if the inference yields bivarant"
[14:57:04] <nmatsakis> this is not what's in my RFC
[14:57:08] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Ping timeout)
[14:57:13] <nmatsakis> I still prefer that, but in the short term,
[14:57:19] <nmatsakis> I want to find and fix the "missing marker" problem
[14:57:24] <nmatsakis> I'd go with error, but we could also go with warn
[14:57:29] <edwardw> ok, I'll try that
[14:57:37] <nmatsakis> the other PR is one that fixes the bug in inference you found,
[14:57:44] <nmatsakis> but I'd do the missing marker thing first
[14:57:49] <nmatsakis> I promise quick r? :)
[14:57:51] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[14:58:05] <edwardw> cool, will do
[14:58:08] <nmatsakis> the latter one might require a bit of work on JSON, I know, we can talk about that too
[14:58:16] <nmatsakis> (but I'm happy to discuss it later)
[14:58:20] <nmatsakis> cool
[14:58:23] <nmatsakis> that'd be awesome!
[14:59:30] *** Joins: victorporof (victorporo@13F2CEC5.7672369.D8E68FF6.IP)
[15:00:08] *** Joins: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP)
[15:01:01] *** Quits: luz (lu.cy@moz-CD18B14B.customer.cdi.no) (Input/output error)
[15:01:05] *** Joins: luz (lu.cy@moz-CD18B14B.customer.cdi.no)
[15:01:13] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:03:05] <eddyb> acrichto: I hope I'm not stepping on your toes, but I'll submit PRs for the top two commits at https://github.com/rust-lang/libuv/commits/800b56fe6af21ffd8e56aee8cf12dd758f5bbdf1
[15:03:25] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:06:23] <edwardw> nmatsakis: what error message do you want for bivariant?
[15:08:24] <nmatsakis> edwardw: I imagine something like "Unused type/lifetime parameter: either make use of it, remove it, or add a marker"
[15:08:41] <edwardw> gotcha
[15:09:01] <acrichto> eddyb: I would recommend upstreaming any modifications to libuv first rather than going to just our repo
[15:09:18] <acrichto> we're almost at vanilla libuv, but there's an old bugfix or two that we haven't upstreamed yet
[15:09:26] <eddyb> acrichto: I mean, PRs to joyent/libuv
[15:09:47] <eddyb> acrichto: sadly, this doesn't seem resolved (and it sounds like the patch we use is a hack) https://github.com/joyent/libuv/issues/909
[15:09:49] <acrichto> be my guest!
[15:09:57] <acrichto> yep
[15:15:37] <doener> eddyb: wth... the generated code for the call to noop_fold_item in simplify_ast goes like this: es = ptr >> 40; ei = es << 40; m = ptr & 0x000000ffffffffff; p = ei | m; And then it derefs p
[15:15:53] <eddyb> woot
[15:15:56] <doener> eddyb: i.e. it splits the ptr into two values and then recreates it
[15:16:05] <eddyb> wai
[15:16:25] <doener> eddyb: an with i1 it uses 0x00000001ffffffff as the mask, creating an invalid pointer
[15:16:48] <eddyb> why does it do that to the pointer?
[15:16:54] * eddyb doesn't understand
[15:17:09] <doener> probably confused by the way we handle enums
[15:17:20] <eddyb> doener: what's the pointer in question?
[15:17:22] <doener> the bool isn't even in that variant
[15:18:09] <doener> eddyb: enum InlinedItemRef
[15:18:25] <doener> eddyb: dies on IIItemRef, the bool is in IIMethodRef
[15:18:34] <eddyb> doener: does one of the variants have i1 before the reference?
[15:18:47] <eddyb> can you reproduce with a smaller test case?
[15:18:51] <doener> no
[15:19:01] *** Quits: canhtak (canhtak@moz-1300C4D7.wl.t.ulaval.ca) (Quit: canhtak)
[15:19:05] <eddyb> I hope not to the latter :/
[15:19:11] <eddyb> doener: at least the funky pointer magic
[15:19:27] <doener> nope, no testcase yet
[15:19:46] <doener> even the match on the same _value_ right before the call to simplify_ast doesn't have that
[15:20:00] <doener> hm, that doesn't use any field but .id though...
[15:20:01] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Quit: Lost terminal)
[15:22:55] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:23:06] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[15:23:27] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[15:25:02] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:25:09] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[15:25:33] <edwardw> nmatsakis: how to mark a trait? They can't have fields, right? E.g. https://github.com/mozilla/rust/blob/master/src/libstd/slice.rs#L1725
[15:25:57] <nmatsakis> edwardw: just remove it.
[15:26:03] <edwardw> k
[15:27:45] <eddyb> acrichto: sadly, I think this is a hack as well https://github.com/joyent/libuv/pull/1214
[15:27:52] <eddyb> acrichto: only figured after I've submitted it though
[15:29:13] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[15:31:07] *** Quits: summerlight (summerligh@327FC32B.2C956A45.501EFF44.IP) (Ping timeout)
[15:31:50] *** Joins: canhtak (canhtak@moz-1300C4D7.wl.t.ulaval.ca)
[15:31:59] <edwardw> nmatsakis: it seems to be impossible: kinds.rs, iter.rs/FromIterator, Hash/Hasher all can't compile now
[15:32:17] <edwardw> and num.rs/Num trait
[15:34:07] <edwardw> it also intertwines with the ty_trait inference bug, since lifetime used in `&'a SomeTrait` is not part of the inference 
[15:34:36] *** Joins: vfetwnuncszu (david@moz-AB8667CE.gyrae.net)
[15:34:38] <edwardw> the example of that is repr.rs/ReprVisitor in libstd
[15:34:51] *** vfetwnuncszu is now known as dcrewi
[15:36:12] <nmatsakis> edwardw: interesting. ok, we might have to fix that bug first. can you paste me the errors you see?
[15:36:18] <nmatsakis> edwardw: "impossible" is a very strong word :)
[15:36:31] <edwardw> nmatsakis: ah my bad :P
[15:36:49] *** Joins: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP)
[15:36:49] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/c4w9Lw
[15:36:49] *** Parts: ghrust (ghrust@C82447D.6A2AE50.F3114085.IP) ()
[15:36:55] <pnkfelix> nmatsakis == don quixote
[15:38:09] <edwardw> removing the type parameter from trait doesn't work, the implementation says wrong number of type parameters :)
[15:41:51] *** Joins: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP)
[15:41:51] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/CvptaQ
[15:41:51] *** Parts: ghrust (ghrust@99CAE845.6A2AE50.F3114085.IP) ()
[15:44:30] <edwardw> nmatsakis: here it is, that patch is below the error messsages https://gist.github.com/edwardw/df23a7a959b925ec2ada
[15:44:35] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:44:59] <nmatsakis> edwardw: well, if you remove the type parameter from the trait, you'll have to update the impl too
[15:45:23] <nmatsakis> ah, I see what's happening with kinds.rs, that's interesting.
[15:45:49] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[15:45:59] <nmatsakis> (not sure why the CovariantType markers etc are giving that error, but THAT should be easy to fix)
[15:46:38] <edwardw> and the one without any type parameters? Send etc.
[15:46:46] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:47:11] <nmatsakis> They do have one: Self, that's why you're getting an error.
[15:47:18] <edwardw> ah
[15:47:19] <nmatsakis> I'm intrigued by this problem. I hadn't thought about this before.
[15:47:30] <nmatsakis> It's absolutely correct, of course, that `Self` is bivariant, considering the constraints that it considers
[15:47:52] <nmatsakis> (this seems to back up my RFC's assertion that covariant is really the right default)
[15:47:56] <nmatsakis> (for types)
[15:48:26] <pnkfelix> nmatsakis: you don't think Bivariant is right for Self on empty traits?
[15:48:59] <pnkfelix> nmatsakis: or do you mean that empty traits are just wrong?  (And that we'll handle lang_item ones as special cases)
[15:49:00] <nmatsakis> pnkfelix: well, that makes the trait kind of meaingless
[15:49:26] * pnkfelix was musing that this could be the "use case" for Bivariant we've been waiting for.  :)
[15:49:28] <nmatsakis> pnkfelix: I think if you have trait Foo { }, and it is bivariant with respect to Self, then if you have even one impl, you impl it for all types
[15:49:58] <nmatsakis> the term bivariant seems to be a bit of a misnomer,
[15:50:10] <nmatsakis> hmm,
[15:50:44] <nmatsakis> or maybe my interpretation is wrong. I've been thinking it means "doesn't matter what value you use here", but I guess you could interpret it as "both covariant and contravariant", which is maybe a subtle difference, at least if you lack a top or bottom type
[15:50:52] <nmatsakis> but anyway I think it's wrong here and elsewhere :)
[15:51:27] <edwardw> so the fix is to assign covariant (for types) as default?
[15:52:06] <nmatsakis> edwardw: well, I think that's the right fix long term, but I'm not sure it's the right short term patch in this particular case. Maybe it is. There is no way to use a marker here, as you point out, except for adding a dummy method with a default impl I guess
[15:52:19] *** Joins: gwty (gwtypc@D9B150D0.BF328863.137C914F.IP)
[15:54:34] <edwardw> (the ty_trait inference bug is also relevant here since `&'a SomeTrait` is never part of the inference)
[15:54:59] <edwardw> (the lifetime parameter of it I mean)
[15:55:11] <nmatsakis> right
[15:55:36] <nmatsakis> edwardw: ok, so :) maybe we can put that one PR on hold for a sec and start one with the inference fix?
[15:55:45] <nmatsakis> edwardw: I want to load your patch and poke at those errors myself
[15:55:55] <nmatsakis> most of them I understood, but not all
[15:56:24] <edwardw> ok, only the ty_trsit fix in it, right?
[15:56:30] <edwardw> ty_trait*
[15:56:50] <edwardw> a sec
[15:57:38] <nmatsakis> edwardw: right, I imagine some things won't build
[15:57:48] <edwardw> JSON
[15:57:50] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:00:34] *** Quits: mediocrity (Thunderbir@moz-8A2E9A09.bredband.comhem.se) (Quit: mediocrity)
[16:01:05] <nmatsakis> right, so I think the right short-term fix is just to patch up that method
[16:01:27] <nmatsakis> so that it uses something which owns the MemWriter, this requires a bit of code dup
[16:02:22] <edwardw> nmatsakis: here it is https://github.com/mozilla/rust/pull/13132
[16:03:28] <nmatsakis> edwardw: thanks
[16:03:54] <nmatsakis> edwardw: I'll play with those two things and poke you in a bit  :)
[16:04:04] <edwardw> sure
[16:06:01] *** Quits: gwty (gwtypc@D9B150D0.BF328863.137C914F.IP) (Ping timeout)
[16:09:08] *** Quits: zimbabao (rajaram@52A9E86D.EA743218.BE4CF869.IP) (Ping timeout)
[16:09:41] <pnkfelix> if I want to traverse a type to check some invariant (e.g. that it has no occurrences of ReEarlyBound), I can readily use ty_fold::TypeFolder for it, but is there a "better" option I should be looking at?  Something that visits without building up a new type?
[16:12:23] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:13:09] <larsberg> acrichto: do you know of anything tricky needed on android to get __sync_sub_and_fetch_4 to resolve? We're failing to load one of our zillion servo .sos (in this case, the rust wrapper code that calls into spidermonkey) because that symbol is missing.
[16:13:47] <larsberg> We explicitly scan the ELF header in our dlopen() wrapper to dlopen all shared libraries we depend on, so if there's an explicit dependency, we should be loading it...
[16:14:17] <blank_name> 11:15:37 < doener> eddyb: wth... the generated code for the call to noop_fold_item in simplify_ast goes like this: es = ptr >> 40; ei = es << 40; m = ptr & 
[16:14:20] <blank_name> 11:15:37 < doener> eddyb: wth... the generated code for the call to noop_fold_item in simplify_ast goes like this: es = ptr >> 40; ei = es << 40; m = ptr & 
[16:14:23] <blank_name> 11:15:37 < doener> eddyb: wth... the generated code for the call to noop_fold_item in simplify_ast goes like this: es = ptr >> 40; ei = es << 40; m = ptr & 
[16:14:26] <blank_name> 11:15:37 < doener> eddyb: wth... the generated code for the call to noop_fold_item in simplify_ast goes like this: es = ptr >> 40; ei = es << 40; m = ptr & 
[16:14:29] <blank_name> 11:15:37 < doener> eddyb: wth... the generated code for the call to noop_fold_item in simplify_ast goes like this: es = ptr >> 40; ei = es << 40; m = ptr & 
[16:14:32] <blank_name> 11:15:37 < doener> eddyb: wth... the generated code for the call to noop_fold_item in simplify_ast goes like this: es = ptr >> 40; ei = es << 40; m = ptr & 
[16:14:35] <blank_name> 11:15:37 < doener> eddyb: wth... the generated code for the call to noop_fold_item in simplify_ast goes like this: es = ptr >> 40; ei = es << 40; m = ptr & 
[16:14:36] * eddyb rolls eyes
[16:15:12] *** Joins: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP)
[16:16:07] <flaper87> T_T
[16:20:57] <blank_name> ahh
[16:20:58] <blank_name> so sory
[16:21:24] *** Parts: blank_name (blank_name@5EC13E3.964BADD.93A5C78C.IP) ()
[16:24:49] <acrichto> larsberg: sometimes you have to pass a feature flag to use the hardware rather than using an intrinsic
[16:27:06] <acrichto> larsberg: also those functions should be in complier-rt, so they shouldn't be unresolved...
[16:28:16] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:29:03] <larsberg> acrichto: Yeah, I'm also quite confused because they appear in librustuv and libazure, both of which we successfully dlopen'd just shortly before we fail on the current one.
[16:29:17] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[16:29:22] *** Quits: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net) (Connection reset by peer)
[16:29:23] <larsberg> I'll keep looking; symbol loading on android is madness. Thanks for the tip!
[16:29:44] <acrichto> larsberg: are you passing any special -C target-feature flags?
[16:29:58] <acrichto> by default it should be +v7 for arm which means that the intrinsics shouldn't be used but rather the atomic instructions
[16:30:11] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[16:30:59] *** Joins: TimAbraldes (quassel@moz-7FD19BDC.hsd1.or.comcast.net)
[16:31:20] <larsberg> The only interesting stuff is: --target=arm-linux-androideabi -C android-cross-path=/Users/larsberg/ndk-standalone/ -O -g - the rest is just -L flags.
[16:32:10] <acrichto> hm
[16:32:17] <acrichto> yeah that shouldn't be lowering to intrinsics...
[16:34:05] <larsberg> hrm, we do compile some other C++ code and link that in - maybe that's where it's coming from...
[16:35:26] <larsberg> nope, not in those object files. I'll keep lookin'
[16:37:31] *** Joins: lkuper (lkuper@87D98E32.4046EB22.428F94DD.IP)
[16:39:22] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[16:40:19] *** Quits: doener (bs@moz-AA189A5A.unitymedia.biz) (Quit: leaving)
[16:41:25] <erickt> nmatsakis: I thought of one case where encoding/decoding with user data would be difficult: decoding to a generic type like json::Json
[16:42:39] <nmatsakis> erickt: I think the major reason I was nervous about user data was that it's unclear how the #[deriving] mode ought to propagate it;
[16:42:45] <nmatsakis> erickt: presumably just by cloning, like the visitor does
[16:42:55] <erickt> there's that too.
[16:43:05] <nmatsakis> but this is not actually BETTER when using `self`
[16:43:08] <nmatsakis> just less visible
[16:43:16] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[16:43:21] <nmatsakis> i.e., the state is still being implicitly threaded and so on
[16:43:37] <nmatsakis> I guess the other option would be to have a userdata of type T,
[16:43:40] <nmatsakis> and just thread along an &mut T
[16:43:53] <nmatsakis> erickt: anyway, I don't quite understand your example
[16:44:05] <erickt> I'll whip one up
[16:44:16] <erickt> I was about to type it here, but that's just silly
[16:49:29] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[16:49:30] *** ChanServ sets mode: +ao pcwalton pcwalton
[16:52:33] <acrichto> nmatsakis: I'm curious, what are your thoughts on https://github.com/mozilla/rust/issues/13125 ?
[16:55:11] <nmatsakis> acrichto: we talked about this, right. I think we settled on saying that RwArc could be used instead
[16:55:19] <nmatsakis> during work ewek
[16:55:20] <nmatsakis> *week
[16:55:34] <nmatsakis> but basically yes Mutex<T> where T is Sent should be Share
[16:55:36] <nmatsakis> *Send
[16:55:44] <acrichto> there's no way to specify that though
[16:55:51] <nmatsakis> not necessarily
[16:55:55] <acrichto> assuming an opt-in world, you can't to "impl<T> Share for Mutex<T>"
[16:55:59] <nmatsakis> sure you can
[16:56:00] <acrichto> or impl<T: Send>
[16:56:06] <acrichto> doesn't the compiler reject it?
[16:56:12] <nmatsakis> yes yes sorry
[16:56:14] <acrichto> struct Mutex<T> { lock: RawMutex, data: T }
[16:56:31] <eddyb> acrichto: #[unsafe_share] on the impl
[16:56:58] <nmatsakis> well
[16:57:03] <nmatsakis> I think you'd want: Unsafe<T>
[16:57:04] <nmatsakis> to start
[16:57:13] <nmatsakis> and I could imagine having special rules around Unsafe<T>
[16:57:17] *** Quits: Kxepal (Miranda@moz-DE055BA8.pppoe.mtu-net.ru) (Ping timeout)
[16:57:22] <nmatsakis> in fact, I think we will definitely need those.
[16:57:32] <acrichto> https://github.com/mozilla/rust/blob/master/src/libsync/lock.rs#L168-L172
[16:57:45] <nmatsakis> right. so I imagine that Unsafe<T> is always ok
[16:57:47] <acrichto> but I could believe that
[16:57:57] <acrichto> so Unsafe<T> is always a kind even if T isn't that kind?
[16:58:03] <nmatsakis> acrichto: it's already using Unsafe<T>, so what do you mean by "but"?
[16:58:19] <nmatsakis> (that is, I take that to mean that your link is evidence against what I'm saying, but it seems to support it)
[16:58:29] <acrichto> oh probably the wrong word, I could believe that Unsafe<T> fixes it all
[16:58:33] <nmatsakis> ok
[16:58:34] <acrichto> oh no, sorry
[16:58:43] <nmatsakis> ok ok
[16:58:50] <nmatsakis> anyway, I have to amend the opt-in proposal 
[16:58:51] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[16:58:51] <nmatsakis> in this regard
[16:58:57] <acrichto> cool
[16:58:59] <nmatsakis> but I think that Unsafe<T> is the right answer here
[16:59:11] <eddyb> sfackler: why is PostgresConnection not Share?
[16:59:17] <acrichto> nmatsakis: I agree
[16:59:59] <eddyb> sfackler: is it unsafe to have non-locked immutable access to it?
[17:00:16] <acrichto> yes
[17:00:23] <acrichto> Cell<T> is not Share
[17:00:27] <acrichto> but Mutex<Cell<T>> is share
[17:01:11] <eddyb> RefCell, actually
[17:01:15] *** Joins: jensnockert (jensnocker@moz-EF95FD94.astro.lu.se)
[17:01:50] <eddyb> sfackler: why do you have Mutex<RefCell<InnerPostgresConnection>>? that seems needlessly complicated
[17:01:56] *** Joins: Kxepal (Miranda@moz-83F7AF52.pppoe.mtu-net.ru)
[17:03:03] <erickt> nmatsakis: here's an example of threading state through #[deriving]: https://gist.github.com/erickt/9766373
[17:03:10] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.3)
[17:03:17] <nmatsakis> eddyb: same holds for Cell
[17:03:46] <eddyb> nmatsakis: I mean, sfackler uses RefCell
[17:04:04] <erickt> nmatsakis: we'd probably have to figure out how deal with lifetimes in a #[deriving] block
[17:04:27] <eddyb> nmatsakis: I was suspecting bad design from the start, even though Mutex<T> being Share when T isn't will have some usecases
[17:05:53] <nmatsakis> erickt: this is presuming we add ability to specify the T?
[17:05:54] <nmatsakis> eddyb: ok 
[17:06:04] <nmatsakis> erickt: that is, as an extension to deriving()?
[17:06:07] <eddyb> sfackler: I wouldn't trust a database connection interface that doesn't require &mut self to perform actions. is there a specific technical reason for your choices?
[17:06:07] <erickt> nmatsakis: yeah
[17:06:15] <nmatsakis> erickt: I don't think this specific to lifetimes
[17:06:24] <nmatsakis> erickt: same would hold for T being MySerializer<U>
[17:08:45] *** Quits: edwardw (edwardw@23A73486.E441A06D.FAED9FFC.IP) (Ping timeout)
[17:08:50] <erickt> yeah. Maybe we need a proper subgrammar for deriving. Maybe use a macro instead of an annotation. `deriving!{<'a, T> Serializable<&'a T> for Foo<'a, T>}`
[17:09:23] *** Joins: edwardw (edwardw@23A73486.E441A06D.FAED9FFC.IP)
[17:09:33] <nmatsakis> or maybe just a specialized attribute for deriving serializers
[17:09:49] <nmatsakis> or deriving specialized ones, in any case
[17:10:07] <nmatsakis> it'd be good to survey related use caes
[17:10:11] <nmatsakis> clearly deriving hits one local minima
[17:11:02] *** Joins: blank_name (blank_name@5EC13E3.964BADD.93A5C78C.IP)
[17:11:48] <acrichto> pcwalton: ping
[17:11:53] <pcwalton> acrichto: pong
[17:12:00] <acrichto> pcwalton: want me to take over https://github.com/mozilla/rust/pull/12952 ?
[17:12:06] <pcwalton> sure
[17:12:09] <acrichto> ok
[17:12:21] <pcwalton> sorry about dropping it, I've been incredibly swamped in acid2
[17:12:29] <acrichto> oh no worries
[17:12:32] <acrichto> that's what I figured
[17:13:27] <SimonSapin> Hi. With #12772 landed, is ~[T] still around and growable? Or should we port existing code to Vec<T>?
[17:13:53] <SimonSapin> ( rename std::vec -> std::slice #12772 )
[17:13:57] <acrichto> ~[T] as a growable vector will be removed, Vec<T> will be the only growable vector
[17:14:07] <acrichto> ~[T] may be removed briefly to assist with implementing DST
[17:14:07] <SimonSapin> is it removed yet?
[17:14:10] <acrichto> not yet
[17:14:21] <acrichto> I'm not entirely certain about the implementation strategy of DST
[17:14:25] *** Joins: doener (doener@moz-C68F600D.unity-media.net)
[17:14:36] <acrichto> the largest ramification is that ~[T] will no longer be growable
[17:14:37] <eddyb> we should just remove methods for it though
[17:14:40] <acrichto> long-term
[17:14:47] <acrichto> that is a good idea
[17:14:48] <acrichto> lol
[17:14:57] <eddyb> the lint was... silly
[17:15:11] <acrichto> I'm uncomfortable removing *all* ~[T] usage
[17:15:16] <acrichto> b/c so much of it is appropriate
[17:15:30] <SimonSapin> acrichto: at what point do you think eg. Servo should move away from ~[T] for growable stuff?
[17:15:50] <acrichto> SimonSapin: if you really need the growable aspect of vectors, I'd suggest migrating ASAP
[17:16:53] <SimonSapin> it looks like our strategy so far has been to migrate everything as late as possible
[17:17:15] <SimonSapin> ie. when upgrading Rust-in-Servo, change is little as possible so that it builds/runs again
[17:17:16] <acrichto> ALAP
[17:17:24] <acrichto> I don't blame you lol
[17:22:53] <erickt> nmatsakis: here is my json::Json decoding problem: https://gist.github.com/erickt/9766649
[17:23:24] *** Quits: rook (rook@moz-DE88DB2D.hfc.comcastbusiness.net) (Ping timeout)
[17:23:58] <erickt> nmatsakis: I would need a dummy Decoder in this case
[17:25:09] <nmatsakis> erickt: so I was looking at json also with respect to the bug edwardw found, I'm a bit stymied, might be related, haven't quite grokked your gist yet
[17:28:09] <pnkfelix> nmatsakis: the fix you suggested looks like it does indeed solve many of the ICE's left over from #5121
[17:28:33] <pnkfelix> nmatsakis: (there may still be a couple loose ends, I'm still narrowing down a couple of the cases I had been accumulating)
[17:28:42] <nmatsakis> pnkfelix: cool
[17:29:02] <erickt> ooh is #5121 almost fixed?
[17:29:29] <pnkfelix> erickt: yeah there was an oversight that nmatsakis helped me track down
[17:30:35] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[17:32:54] *** Quits: victorporof (victorporo@13F2CEC5.7672369.D8E68FF6.IP) (Quit: victorporof)
[17:35:02] <erickt> nmatsakis: maybe it'd help to give some context. One of the downsides to our `Decodable` support is that we cannot decode an arbitrary json object directly into a generic enum like `json::Json`
[17:36:46] <erickt> nmatsakis: the reason why we can't is that there's no way for a `Decodable` to tell the `Decoder` that it can be composed of one of many possible types
[17:37:42] <erickt> nmatsakis: this is because the `Decoder` is relying on the `Decodable` to call a specific `decode_<type>` to parse the next value
[17:39:19] <erickt> but there's no `decode_f64_or_list_or_map_or...()` method for the Json decode method to call.
[17:40:11] <erickt> I think this means that our `Decodable` framework is essentially a LL(0) parser, where decoding something like `Json` requires an LL(1) parser
[17:41:40] *** Joins: rook (rook@moz-DE88DB2D.hfc.comcastbusiness.net)
[17:41:42] *** flaper87 is now known as flaper87|afk
[17:41:56] <erickt> about a month or two ago, I made a fork that actually mde a LL(1) `Decodable` framework, but unfortunately adding support for lookahead added 10-20% overhead to decoding
[17:42:46] <pnkfelix> erickt: I hate to suggest it, but maybe its the sort of thing that deserves two separate traits?
[17:43:14] <pnkfelix> erickt: Something that requires lookahead seems fundamentally different from something that does not.
[17:43:26] <erickt> what I realized a week or so ago is that our current `Decodable` framework can actually support both LL(0) in the common case and LL(1) in a specific case
[17:43:28] <eddyb> oh, look, we still support [mut x, ..n] in the AST
[17:44:28] <erickt> because we can expose a LL(1) api to specific impls that do `impl Decodable<AConcreteDecoder>`
[17:45:16] <erickt> pnkfelix: yeah we could, but that'd end up with a lot of duplication :(
[17:46:29] * eddyb now has two DRY tricks in his bag, HKT and GADT
[17:46:39] *** Quits: lkuper (lkuper@87D98E32.4046EB22.428F94DD.IP) (Quit: lkuper)
[17:46:51] <eddyb> erickt: what did the LL(1) API look like? and what was the main cause of the slowdown?
[17:46:54] *** Joins: lkuper (lkuper@87D98E32.4046EB22.428F94DD.IP)
[17:46:57] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[17:46:57] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14603b859 to 141f5571a: 02http://git.io/N3iJvQ
[17:46:57] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[17:47:01] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[17:47:01] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/4qfXxA
[17:47:01] <ghrust> 13rust/06auto 14e9475b5 15Huon Wilson: std: expand the `Share` docs to make them more precise....
[17:47:02] <ghrust> 13rust/06auto 14de44732 15bors: auto merge of #13070 : huonw/rust/share-doc, r=alexcrichton...
[17:47:02] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[17:47:10] *** Quits: lkuper (lkuper@87D98E32.4046EB22.428F94DD.IP) (Quit: lkuper)
[17:47:38] <erickt> eddyb: it was basically converting the decoders to emit a series of tagged values. so essentially an iterator with some extra bits
[17:48:26] <eddyb> so instead of Decodable requesting concrete types, it was getting an enum for each field?
[17:48:33] <erickt> eddyb: check out https://github.com/erickt/rust-serde
[17:48:40] <erickt> yep
[17:49:39] <erickt> part of me thinks that a 10% hit isn't that bad for a generic decodable framework
[17:49:59] <eddyb> ahh but the Decoder interface is much nicer
[17:50:17] <eddyb> (in serde)
[17:50:39] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[17:51:09] <eddyb> erickt: so the overhead is from the monadic nature?
[17:51:13] <erickt> eddyb: I think it could be. keep in mind I didn't fully implement everything the old decoder framework supported
[17:51:57] <erickt> eddyb: I think so. It just introduces a branch on every token, whereas the old framework is just calling easily inlinable functions
[17:52:45] <eddyb> https://github.com/erickt/rust-serde/blob/master/src/serde/serde/decode.rs#L237-L274 this might have something to do with it
[17:53:01] <eddyb> erickt: looks safer, though
[17:55:23] <erickt> eddyb: actually I think the older way is a tad safer. The old way didn't allow you to miss the end of a list, but this new way you have to explicitly handle the ListEnd token
[17:55:37] <eddyb> ohh?
[17:55:47] <erickt> eddyb: see https://github.com/erickt/rust-serde/blob/master/src/serde/serde/decode.rs#L175
[17:56:23] *** Joins: victorporof (victorporo@moz-2EC02EB5.wireless.telus.com)
[17:58:10] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Client exited)
[17:58:31] *** Joins: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp)
[17:58:44] <sfackler> eddyb: if it used &mut, you could only have one prepared statement at any time
[17:58:51] <sfackler> which seems like it'd be a bit of a bummer
[17:59:05] <sfackler> and you couldn't have *any* statements and a transaction
[17:59:45] <acrichto> does anyone feel uncomfortable about https://github.com/mozilla/rust/pull/13039 ?
[17:59:54] <sfackler> nope
[18:00:13] *** Quits: ssira (ssira@moz-F6206352.kanagawa.ocn.ne.jp) (Ping timeout)
[18:00:26] <sfackler> eddyb: the API fundamentally needs aliased pointers back to the connection
[18:00:41] <erickt> acrichto: I already said I like it :)
[18:00:46] *** Quits: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com) (Ping timeout)
[18:00:47] <eddyb> sfackler: that's a bit sad
[18:00:54] <sfackler> same goes for a statement and its result sets
[18:01:28] <eddyb> sfackler: so when is it part a Mutex and when isn't it?
[18:01:41] <eddyb> *part of a*
[18:01:49] <eddyb> s/*$//
[18:02:03] <eddyb> sfackler: Mutex<RefCell<T>> is a few kinds of sad :(
[18:03:17] <acrichto> eddyb: ping about https://github.com/mozilla/rust/pull/12809 (just going through the queue)
[18:03:45] <eddyb> acrichto: yeah I have to rewrite a few thousand lines
[18:03:57] <eddyb> can close for now
[18:04:24] *** Joins: gwty (gwtypc@CCC73E8.41C13BAD.49FF672.IP)
[18:04:36] <acrichto> ok, I hope isrustslimyet updates soon to see all the recent improvements!
[18:04:44] <acrichto> I'm curious where our big allocations are left over
[18:05:23] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Quit: leaving)
[18:05:30] <eddyb> acrichto: the has_infer types which make up 90% of all allocated types
[18:06:03] *** Joins: Axord (xord@moz-BC8E2FBC.static.rvsd.ca.charter.com)
[18:06:28] <eddyb> acrichto: huon's changes to middle::ty have double the effect I predicted, which means we could be looking at another 400MB if I ever get to making that change :P
[18:06:42] <acrichto> that's a lot of memory!
[18:06:55] <eddyb> and that's ignoring indirect storage (vectors and whatnot)
[18:07:23] *** Quits: victorporof (victorporo@moz-2EC02EB5.wireless.telus.com) (Connection reset by peer)
[18:07:27] <eddyb> acrichto: I should clean up the code generating these stats, add more info and make a PR https://gist.github.com/eddyb/20fb641bc5e3794049da
[18:07:53] <acrichto> sounds quite useful!
[18:09:48] <sfackler> eddyb: the only time a mutex is used is for the connection pool
[18:10:13] <sfackler> that's an Arc<Mutex<InnerPool>> where the InnerPool has a Vec<PostgresConnection> that it hands connections out from
[18:10:22] <sfackler> and PostgresConnection contains Cells
[18:11:16] *** Joins: mediocrity (Thunderbir@moz-8A2E9A09.bredband.comhem.se)
[18:11:48] <eddyb> sfackler: I only saw a RefCell
[18:12:34] <sfackler> er, yeah, a RefCell
[18:13:07] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[18:13:07] *** ChanServ sets mode: +o tjc
[18:14:02] *** Joins: vadimcn (chatzilla@moz-E841EA3A.hsd1.wa.comcast.net)
[18:14:13] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[18:15:14] <herrwolfe45> acrichto: sorry for the early push on my pull request, Check if out-dir exists before compiling / issue #12865 (#13110)
[18:15:30] <herrwolfe45> acrichto: i didn't realize it would pull in all of my changes, just pushing into my local repository
[18:15:59] <acrichto> herrwolfe45: oh no worries! that's fine, it's looking great to me
[18:16:06] <acrichto> just a few small comments here and there and I think it's ready to go
[18:16:14] <herrwolfe45> awesome - thank you
[18:19:47] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: rcirc on GNU Emacs 24.3.1)
[18:30:28] *** Joins: brson (brson@moz-62518563.mtv2.mozilla.com)
[18:30:29] *** ChanServ sets mode: +qo brson brson
[19:04:37] *** Quits: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[19:06:11] *** Quits: jensnockert (jensnocker@moz-EF95FD94.astro.lu.se) (Input/output error)
[19:35:03] <friggle> what time are the weekly meetings held at now?
[19:36:54] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[19:37:01] <eddyb> cmr: need to bug huon about http://huonw.github.io/isrustfastyet/mem/?
[19:39:09] <cmr> friggle: somewhat variable. today's is in ~1.5 hours
[19:39:14] <cmr> eddyb: no, multibuilder still being broke
[19:39:22] <eddyb> cmr: ah right
[19:39:33] <cmr> this is why I should never, ever update my software.
[19:39:35] <friggle> cmr: thanks
[19:41:37] <cmr> aatch: heads up: https://github.com/mozilla/rust/pull/12947
[19:41:54] <aatch> cmr, I know
[19:41:58] <cmr> ok
[19:44:12] *** Joins: victorporof (victorporo@moz-2EC02EB5.wireless.telus.com)
[19:46:08] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[19:46:09] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:46:18] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[19:47:03] *** Joins: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP)
[19:47:03] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/4qfXxA
[19:47:03] *** Parts: ghrust (ghrust@94BD74B8.6A2AE50.F3114085.IP) ()
[19:48:21] <eddyb> ext::base::expr_to_str tries to get a string literal by expanding early
[19:48:36] <eddyb> but expansion is folding which is owned
[19:48:37] <nrc> nmatsakis: ping for re-review for https://github.com/mozilla/rust/pull/12562 (in case you missed the GH notification)
[19:48:54] *** Quits: gwty (gwtypc@CCC73E8.41C13BAD.49FF672.IP) (Ping timeout)
[19:49:05] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[19:49:05] *** ChanServ sets mode: +ao pcwalton pcwalton
[19:49:53] <nrc> nmatsakis: also, when you have a little time, I still have a question about DST arguments
[19:50:24] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[19:52:00] *** Joins: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP)
[19:52:00] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/w761MQ
[19:52:00] *** Parts: ghrust (ghrust@2E45E35D.6A2AE50.F3114085.IP) ()
[19:52:02] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[19:52:02] <ghrust> [13rust] 15bors pushed 3 new commits to 06auto: 02http://git.io/v_5Zrw
[19:52:02] <ghrust> 13rust/06auto 147dfa4b2 15noam: docs: named lifetimes...
[19:52:02] <ghrust> 13rust/06auto 144b224af 15noam: Added suggested notes...
[19:52:02] <ghrust> 13rust/06auto 14d8197f5 15bors: auto merge of #13106 : CLUSTERfoo/rust/docs/labelled_breaks, r=brson...
[19:52:02] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[19:57:54] <nrc> acrichto: so I want to add a compiler flag and I know you re-organised them a little while back. My hack approach was just to add '--save-analysis' as a top level flag. Is there a better place for it?
[19:58:30] <cmr> should probably be a -C or -Z flag.
[20:01:49] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[20:06:26] <eddyb> > We also assume "extra" is the standard library, and "std" is the core library.
[20:06:52] <eddyb> because std doesn't mean "standard"
[20:07:08] <cmr> who where?
[20:07:31] <cmr> the word for everything is "standard distribution" I think
[20:07:44] <eddyb> cmr: old comments
[20:07:48] <kimundi> Urg, every time I try to think of a major refactoring of a Rust API, I end up at a point where its either going to be ugly or impossible without HKT and/or associated items. :(
[20:08:03] <eddyb> cmr: syntax::ext::deriving fwiw
[20:08:27] <cmr> also "extra" used to be called std and "std" used to be called core
[20:08:29] <cmr> fwiw
[20:09:11] <kimundi> AH, good old libcore and libstd...
[20:09:43] <eddyb> cmr: I know, but somehow that comment managed to get into a ridiculous state :/
[20:10:54] *** Quits: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP) (Ping timeout)
[20:13:39] <kimundi> I wonder which of HKT and associated items we could get faster, considering both implementation and discussion...
[20:14:29] <eddyb> kimundi: keep in mind that associated items gives you some form of HKT, AFAIK
[20:14:34] <eddyb> s/gives/give
[20:14:45] <eddyb> kimundi: basically the Scala type lambda hack
[20:15:11] <kimundi> eddyb: Yeah, I can see them being similar
[20:15:47] <kimundi> eddyb: I have a API problem that I can solve with either, so I'm pretty sure that there is a conceptual overlap ;)
[20:16:47] <kimundi> eddyb: Could you explain the scala comparison?
[20:17:24] <eddyb> kimundi: you haven't seen the dreaded type lambda hack?
[20:17:29] *** Joins: gwty (gwtypc@CCC73E8.41C13BAD.49FF672.IP)
[20:17:51] <eddyb> kimundi: write an anonymous class with a generic associated type inside and get that type
[20:17:58] <acrichto> nrc: I'd tend to not add a top-level flag but rather put it behind -Z or -C
[20:18:15] <acrichto> nrc: -C I'd reserve for any output generated by rustc::back and -Z for debugging things in rustc::middle
[20:19:13] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[20:19:13] *** ChanServ sets mode: +o tjc
[20:22:30] <nrc> acrichto: OK, under Z or C sounds good. Sounds like -Z is better, it fits with the JSON stuff etc.
[20:23:15] <kimundi> eddyb: Okay, reading up on it, scala can do "anonymous generic type with type member", and the Rust equivalent would be "trait implementation with associated type", right?
[20:23:27] <eddyb> I guess
[20:27:03] <eddyb>  // FIXME: Would be nice if our generated code didn't violate Rust coding conventions
[20:27:27] <eddyb> what exactly? this is a function which creates an @Item, there's... nothing interesting about it
[20:27:42] <acrichto> brson: oh you should cross of libextra dismantle on the 1.0 spreadsheet
[20:27:45] <kimundi> Hm, that implies that if we get associated types, we can write a macro for type lambdas :P
[20:28:09] <eddyb> kimundi: you can't use (my version of) HKT without proper type lambdas though
[20:28:15] *** Joins: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP)
[20:28:39] <kimundi> eddyb: Why? And what is your version again? ;)
[20:28:47] <eddyb> kimundi: the non-currying one
[20:28:48] *** Quits: edwardw (edwardw@23A73486.E441A06D.FAED9FFC.IP) (Ping timeout)
[20:28:50] <nrc> kimundi: I believe the Scala things are referred to in the literature as virtual types, and Rust associated types are only equivalent if we allow them to be inherited and overridden, etc. About which there hasn't been much discussion 
[20:29:27] <eddyb> nrc: I was strictly referring to the type lambda hack, of course there's more complicated thing in Scala
[20:29:50] <kimundi> nrc: Yeah, I bet with inheritance added to the mix stuff gets more complicated, thats not what I was looking at though :)
[20:29:52] <eddyb> kimundi: and I'd rather have a <T, U> Foo<A, B, T, U> kind of syntax than a hack
[20:30:01] <nrc> heh, I know nothing of the Scala type lambda hack
[20:30:07] <kimundi> eddyb: Sure, me too ;)
[20:30:33] <nrc> it sounds awful though, as does implementing it a a macro :-p
[20:30:38] <nrc> *as a
[20:31:03] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[20:31:03] <eddyb> nrc: class {type Foo<T> = ...;}::Foo basically
[20:31:21] <kimundi> eddyb: If it wouldn't be horrible confusing, then the bind syntax would be nice too. <T, U> Foo<A, B, T, U> shortens to Foo<A, B, _, _>
[20:31:31] <kimundi> (Confusing with partial type hints, that is)
[20:31:42] <eddyb> kimundi: but that will infer in function contexts
[20:31:58] <eddyb> I'd rather use * for "any type"
[20:32:13] <kimundi> exactly, which is why it would be confusing/ambiguous
[20:32:39] <cmr> acrichto: feel free to reorder the simd rfc anywhere
[20:32:39] <brson> acrichto: ok
[20:32:40] <kimundi> eddyb: <T, U> Foo<A, B, T, U> => Foo<A, B, *, *> ?
[20:32:58] *** Joins: jensnock_ (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[20:33:04] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[20:33:28] <eddyb> kimundi: but is it <T, U> or <T><U>?
[20:33:50] <eddyb> "my version of HKT" is all about giving you that choice
[20:34:33] <acrichto> has the TotalOrd/TotalEq story reached a settlement on Eq/Ord and PartialEq/PartialOrd?
[20:34:42] <eddyb> kimundi: I guess <T, U> is fine in the general case
[20:34:51] <kimundi> eddyb: Well I'd find <T, U> more consistent than the other one - we don't employ currying anywhere else, and you can emulate it manually if neccessary. With type lambdas, there would also be not pesky ownership/allocation considerations to ruin your day ;)
[20:35:04] <eddyb> kimundi: with <T><U> requiring writing a full lambda
[20:35:17] <cmr> acrichto: to my knowledge yes
[20:35:17] <kimundi> eddyb: Oh, also I meant the * syntax in addition to proper lambdas
[20:35:33] <eddyb> kimundi: yeah, it's all fine :)
[20:35:46] <kimundi> Foo<A, B, *, *> as shortform for writing <T, U> Foo<A, B, T, U>
[20:36:44] <kimundi> Heh, would `impl<T, U> Foo<A, B, T, U>` generalize to `impl (<T, U> Foo<A, B, T, U>)` under this scheme?
[20:37:11] <kimundi> (bad example, but I general I mean)
[20:37:40] <eddyb> kimundi: maybe
[20:37:47] <kimundi> "imply for this type", "impl for this type lambda"
[20:38:05] <eddyb> it then becomes crazier than Haskell, methinks
[20:38:24] <eddyb> kimundi: I definitely want a way to not specify type params and lifetimes
[20:38:38] <eddyb> impl Foo<A, B, *, *> would be nice
[20:38:52] *** Joins: edwardw (Mibbit@6EFA975B.A7655D4F.FAED9FFC.IP)
[20:39:13] <eddyb> or '* - maybe '_? they both look a bit weird
[20:39:42] <kimundi> I think we need to tread them differently? So '* I guess.
[20:40:24] <kimundi> lifetimes and types are two different kinds after all.
[20:40:35] <kimundi> wait a minute
[20:40:46] <cmr> eddyb: aha I think I finally squashed the last bug!
[20:40:53] <cmr> (in multibuilder)
[20:40:57] <eddyb> haha we have a Duplicator
[20:41:00] <cmr> I was using try_recv instead of recv_opt
[20:41:06] <eddyb> using folding to deep clone
[20:41:14] <eddyb> (that will be .clone() with P<T>)
[20:41:17] *** Quits: jensnock_ (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Input/output error)
[20:41:50] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[20:41:52] *** Quits: victorporof (victorporo@moz-2EC02EB5.wireless.telus.com) (Ping timeout)
[20:42:05] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[20:42:29] <doener> eddyb: looks like the error with i1 bools is a bug in llvm 3.5
[20:42:47] <aatch> My SIMD RFC is going to be discussed :D
[20:42:47] <eddyb> doener: >_>. but why is it producing pointer shifting code?
[20:43:36] *** Quits: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com) (Ping timeout)
[20:43:42] <kimundi> eddyb: Btw, the problem I'm trying to solve: Making this not have a lifetime parameter: trait MutIterable<'a, A, I: Iterator<A>> {fn mut_iterator(&'a mut self) -> I;}
[20:43:51] <nmatsakis> nrc: shall we sched a time to chat? that's probably most reliable way 
[20:44:14] <eddyb> kimundi: does it need a lifetime param?
[20:44:22] <eddyb> kimundi: oh, yeah, that issue
[20:44:52] <kimundi> With HKT, I could make the method generic over 'a, and apply that to a HKT I. With associated types, I could move the I itself into the trait definition body and refer to it with the method.
[20:45:02] <nrc> nmatsakis: sure, when is good?
[20:45:29] <eddyb> kimundi: I might need a 'a bound in the future
[20:45:45] <kimundi> Any of those two feature would lower my current Iterable experiments traits and impls form "insane" to "complex" ;)
[20:45:58] <doener> eddyb: sroa splitted the loads, and instcombine fails to recombine them
[20:46:00] <kimundi> eddyb: "I", or "it"?
[20:46:06] *** Joins: victorporof (victorporo@moz-B7312B0A.wireless.telus.com)
[20:46:12] <eddyb> doener: why did it split them? that doesn't sound right
[20:46:19] <eddyb> kimundi: the I type param
[20:46:31] <eddyb> doener: especially with GC requiring pointers to remain pointers
[20:46:39] <kimundi> Ah, yeah.  I<'*>: Iterator<A>
[20:46:49] <kimundi> (Or something like that)
[20:46:54] <eddyb> kimundi: uhh
[20:46:58] <kimundi> Or not?
[20:47:02] <eddyb> kimundi: I: 'a + Iterator<A>
[20:47:07] <eddyb> kimundi: something different
[20:47:29] <kimundi> Ah, bounds... No idea where I have to incoperate into my model of Rusts typesystem yet to be honest
[20:47:30] <doener> eddyb: in my testcase, because one match arm doesn't need the whole thing, but just a single byte from it
[20:47:56] <eddyb> doener: one byte from the pointer?
[20:48:22] <kimundi> eddyb: I'm not sure why the bound though?
[20:48:26] <doener> eddyb: no, the bool is in the same memory
[20:48:34] <kimundi> Would it become a requirement for this kind of usage?
[20:48:56] <eddyb> doener: so it splits the pointer from one variant because a bool in another variant overlaps it?
[20:49:04] <eddyb> kimundi: possibly, for soundness
[20:49:36] <eddyb> oh dear why am I touching quote.rs?
[20:49:41] <eddyb> is it still used in libsyntax?
[20:50:04] <doener> eddyb: yeah
[20:50:15] <eddyb> doener: still... wrong :/
[20:50:37] <kimundi> r? https://github.com/mozilla/rust/pull/13039
[20:50:47] <eddyb> doener: can I see IR?
[20:51:00] <eddyb> doener: if you see strcat, pass that oddity by him
[20:51:36] <doener> eddyb: cleaning up a bit, just a moment
[20:51:52] *** Joins: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP)
[20:51:52] <ghrust> [13rust] 15bors 04force-pushed 06auto from 14d8197f5 to 14de44732: 02http://git.io/N3iJvQ
[20:51:52] *** Parts: ghrust (ghrust@49477F7E.6A2AE50.F3114085.IP) ()
[20:51:54] *** Joins: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP)
[20:51:54] <ghrust> [13rust] 15bors pushed 4 new commits to 06auto: 02http://git.io/sz2PIQ
[20:51:54] <ghrust> 13rust/06auto 146f6b099 15Corey Richardson: rustdoc: html: use raw strings for great justice
[20:51:54] <ghrust> 13rust/06auto 14e88387a 15Corey Richardson: rustdoc: add some docs for item types
[20:51:54] <ghrust> 13rust/06auto 141f937fa 15Corey Richardson: rustdoc: render derived impls separately
[20:51:56] *** Parts: ghrust (ghrust@2DCF43EA.6A2AE50.F3114085.IP) ()
[20:52:38] <eddyb> this wasn't hard :/. most type errors related to P<T> are in deriving, which just needs to be updated
[20:52:46] <eddyb> doener: but I'll have to go soon
[20:53:00] * eddyb doesn't like this week. worse than the last one
[20:54:55] *** Quits: edwardw (Mibbit@6EFA975B.A7655D4F.FAED9FFC.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:55:01] *** Quits: eddyb (eddy@F8B50789.F33C1089.FB866788.IP) (Ping timeout)
[20:55:15] *** Joins: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net)
[20:55:39] *** Quits: victorporof (victorporo@moz-B7312B0A.wireless.telus.com) (Connection reset by peer)
[20:59:06] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[20:59:28] *** Joins: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com)
[20:59:28] *** ChanServ sets mode: +ao pcwalton pcwalton
[21:00:29] *** Joins: jensnockert (jensnocker@moz-9353D75F.e0f8471ae7fa.afb.bredband2.com)
[21:05:31] *** Joins: dherman (dherman@77CEA1B2.767934EB.9B6EB213.IP)
[21:05:31] *** ChanServ sets mode: +ao dherman dherman
[21:08:57] *** Quits: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net) (Ping timeout)
[21:10:29] *** Joins: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net)
[21:15:36] *** Quits: dherman (dherman@77CEA1B2.767934EB.9B6EB213.IP) (Quit: dherman)
[21:26:14] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:30:53] *** Quits: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net) (Ping timeout)
[21:31:24] *** Joins: Sharp (Sharp@moz-633F3606.hsd1.ca.comcast.net)
[21:32:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:34:43] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[21:38:27] *** Quits: mediocrity (Thunderbir@moz-8A2E9A09.bredband.comhem.se) (Quit: mediocrity)
[21:38:53] *** Joins: mediocrity (Thunderbir@moz-8A2E9A09.bredband.comhem.se)
[21:50:58] *** Joins: victorporof (victorporo@moz-B7312B0A.wireless.telus.com)
[21:54:29] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[21:59:45] *** Quits: NiccosSystem (NiccosSyst@AB1AFDE.FC7B0C35.A7597CB6.IP) (Ping timeout)
[22:01:43] *** Quits: pcwalton (pcwalton@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: pcwalton)
[22:06:29] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[22:06:53] <seanmonstar> i take it cfg(stage1) isn't true in stage2
[22:07:36] <acrichto> brson: dibs on rfc #3 for opt-in built in kinds
[22:07:44] <kimundi> seanmonstar: correct
[22:08:05] <kimundi> seanmonstar: usually cfg(stage0) and cfg(not(stage0)) gets used.
[22:08:21] <seanmonstar> kimundi: i thought of trying that
[22:08:32] <seanmonstar> kimundi: is there any case where both are somehow false?
[22:08:45] <seanmonstar> like in --test?
[22:08:53] <brson> acrichto: you can have it
[22:09:12] <kimundi> seanmonstar: Well if you ignore the makefile you have to set them manually.
[22:09:29] <seanmonstar> kimundi: no, i've been running `make check`
[22:09:39] <kimundi> then it should ste them correctly.
[22:10:00] <cmr> It's impossible for cfg(stage0) and cfg(not(stage0)) to both be false.
[22:10:04] <cmr> either it's set or it isn't
[22:10:42] <seanmonstar> kimundi: i have a file with #[cfg(stage0)] pub type Encoder = ...; and one for not(stage0), and i'm getting `unresolved name for Encoder` later in the file, but only in stage2
[22:11:00] *** Quits: doener (doener@moz-C68F600D.unity-media.net) (Quit: leaving)
[22:11:24] *** Quits: mediocrity (Thunderbir@moz-8A2E9A09.bredband.comhem.se) (Quit: mediocrity)
[22:11:29] <seanmonstar> unless its using an old binary. i'll try make clean and try again
[22:11:47] <kimundi> seanmonstar: If macros/deriving is involved then there might be some funky overlap
[22:15:10] <cmr> brson: do you need any windows testing for installers right now?
[22:17:00] <acrichto> r? https://github.com/mozilla/rust/pull/13079
[22:17:14] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:18:03] *** Joins: NiccosSystem (NiccosSyst@moz-ED196BB4.customer.lyse.net)
[22:20:15] <brson> cmr: the windows installer in particular could probably get some useful testing right now, yes; i don't expect the windows installer to change much before 0.10, but I'm not quite done tweaking how the dist snaps work
[22:20:26] <brson> will send an email to ml about installer testing sometime this week
[22:20:31] <cmr> ok
[22:20:45] <cmr> I ask because I'm doing other windows-related rust things right now.
[22:21:09] <brson> some smoke testing of the windows installer would be appreciated
[22:21:37] <cmr> now or later?
[22:21:44] <cmr> if now, where can I find it?
[22:22:06] <nrc> I would expect this not to type check:
[22:22:08] <nrc> trait U {}
[22:22:10] <nrc> trait T<X: U> {}
[22:22:11] <nrc> trait S<Y> { fn m(x: ~T<Y>) {} }
[22:22:37] <nrc> why don't we check the bounds of Y when instantiating T?
[22:23:13] <cmr> bug, probably.
[22:23:29] <cmr> trait objects and bounds haven't ever been solid to my knowledge
[22:25:20] <nrc> :-(
[22:25:54] <brson> cmr: now and later. http://static.rust-lang.org/dist/rust-0.10-pre-install.exe
[22:27:04] *** Quits: gwty (gwtypc@CCC73E8.41C13BAD.49FF672.IP) (Ping timeout)
[22:27:13] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Input/output error)
[22:28:46] <brson> r? https://github.com/mozilla/rust/pull/13141
[22:31:28] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[22:35:30] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:37:48] <kmc> I'm confused about ast::TokenTree... how do I represent [a,b] and how does it differ from (a,b) ?
[22:38:16] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:39:58] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:40:42] <cmr> I think it'd be a TTDelim(@Vec(TTTok(LPAREN), ..., TTTok(RPAREN)))
[22:40:54] <cmr> LBRACKET and RBRACKET for [a, b]
[22:41:06] <cmr> not entirely certain
[22:41:51] <kmc> okay
[22:41:59] <kmc> so the delimeters are inside the sequence
[22:42:00] <kmc> thanks
[22:42:48] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[22:43:24] <huon> what a peculiar invariant to uphold
[22:43:40] <sfackler> which one?
[22:43:51] *** Joins: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net)
[22:43:51] *** ChanServ sets mode: +o tjc
[22:43:57] <huon> that the delims for TTDelim are inside the vector, not stored directly
[22:44:04] <sfackler> oh, yeah, that's a bit bizzare
[22:44:06] <sfackler> sp
[22:44:52] *** Quits: victorporof (victorporo@moz-B7312B0A.wireless.telus.com) (Ping timeout)
[22:45:06] <cmr> "Oh joy, you do not have c:/MinGW/bin/make.exe. Keep it that way."
[22:45:13] <cmr> what a fun thing for the postinstallation script to say
[22:46:02] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:46:27] <cmr> brson: do we or could we sign the installer?
[22:47:33] <brson> cmr: where does that message come from?
[22:47:40] <brson> cmr: we sign the final installer right before release
[22:47:45] <cmr> brson: the msys post-installer script
[22:47:50] <cmr> ok, just making sure.
[22:48:28] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[22:48:59] <kmc> now how about this problem where I can't use cx: &mut ExtCtxt in more than one quote because it's moved and it's not clonable?
[22:49:00] <huon> brson: do i remember correctly that your recent changes added a linux binary installer? (does that need testing?)
[22:49:19] <huon> kmc: maybe reborrow it explicitly? (&mut *cx)
[22:49:41] <brson> huon: we do have them, but buildbot doesn't upload them yet (working on that now)
[22:49:58] <brson> huon: I think for 0.10 we won't push the unix binary installers yet, but will note that they are available
[22:50:02] <brson> also have os x .pkg files
[22:50:07] <brson> (also not uploaded yet)
[22:50:44] *** Joins: andrew-__ (andrew-d_w@86B47CBD.7A62F771.CC0301A2.IP)
[22:51:54] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Ping timeout)
[22:51:56] *** Joins: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP)
[22:51:56] <ghrust> [13rust] 15bors merged 06auto into 06master: 02http://git.io/sz2PIQ
[22:51:57] *** Parts: ghrust (ghrust@7BEB6F9D.6A2AE50.F3114085.IP) ()
[22:56:22] *** Quits: andrew-__ (andrew-d_w@86B47CBD.7A62F771.CC0301A2.IP) (Input/output error)
[22:56:38] <cmr> brson: hm, curious issue: a gcc.exe popup that says "There is no disk in the drive. Please insert a disk into drive I:."
[22:56:43] *** Joins: andrew-d_w (andrew-d_w@1B837FFB.F046727F.1351F780.IP)
[22:56:53] *** Joins: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP)
[22:56:53] <ghrust> [13rust] 15bors pushed 0 new commits to 06auto: 02http://git.io/d4DfnQ
[22:56:53] *** Parts: ghrust (ghrust@B750D19A.6A2AE50.F3114085.IP) ()
[22:56:54] *** Joins: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP)
[22:56:54] <ghrust> [13rust] 15bors pushed 2 new commits to 06auto: 02http://git.io/4dPFMA
[22:56:54] <ghrust> 13rust/06auto 141f35f83 15Brian Anderson: mk: Fix 'make install'. Closes #13128
[22:56:54] <ghrust> 13rust/06auto 1420a2d9a 15bors: auto merge of #13141 : brson/rust/fix-make-install, r=cmr
[22:56:54] *** Parts: ghrust (ghrust@C95C9FF.6A2AE50.F3114085.IP) ()
[22:56:54] <cmr> when trying to compile a hello world
[22:57:00] <cmr> which is true; there is no disk in drive I:
[22:57:01] <brson> cmr: i haven't seen *that* before
[22:57:03] <brson> lol
[22:57:12] *** Quits: sunfish (chatzilla@13F2CEC5.7672369.D8E68FF6.IP) (Ping timeout)
[22:57:12] <cmr> I am not sure why it cares!
[22:57:13] <huon> cmr: you need the Rust CD to be able to play the game
[22:57:27] <cmr> hahah
[22:57:35] <cmr> I think drive I: is the sdcard reader
[22:58:07] <kmc> huon: that helps, thanks
[22:58:09] <huon> sfackler: is the interesting part of https://github.com/mozilla/rust/issues/13126#issuecomment-38631179 the &mut self rather than &self?
[22:58:24] <sfackler> no
[22:59:13] <huon> oh... then ... how does that help?
[22:59:13] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[22:59:54] <sfackler> because then my_rc.downgrade() is not the same thign as my_rc.get().downgrade
[22:59:57] <huon> it makes library smart pointers second class citizens again, right?
[23:00:08] <huon> i.e. it's just going back to what we had before
[23:00:09] <cmr> lol
[23:00:17] *** Quits: NiccosSystem (NiccosSyst@moz-ED196BB4.customer.lyse.net) (Ping timeout)
[23:00:17] <cmr> just charging through the errors with "Continue" and it worked fine
[23:00:26] <cmr> gotta be something wonky with the search paths
[23:00:36] <cmr> I never though I'd see a GUI popup from gcc though!
[23:00:46] <sfackler> I just think that in 5 years we're going to end up with things like "/!\ Warning: If you're going to put a type in Rc, don't have a method called 'downgrade'"
[23:01:22] <sfackler> in Rust books or whatever
[23:01:23] <cmr> yeah seems a space snuck into the /etc/fstab
[23:01:32] <cmr> http://mingw.5.n7.nabble.com/mingw32-gcc-exe-No-Disk-td32484.html thanks to our good friend Thad
[23:01:39] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:01:41] <cmr> brson: installer works great
[23:01:44] *** Joins: andrew-__ (andrew-d_w@86B47CBD.7A62F771.CC0301A2.IP)
[23:02:11] <cmr> and I daresay, that experience wasn't entirely unpleasant
[23:02:18] <cmr> unlike the first time I tried to install rust on windows, circa 0.6
[23:02:42] <acrichto> rusti: struct Foo(#[foo] int);
[23:02:43] -rusti- pastebinned 7 lines of output: http://sprunge.us/VLcI
[23:02:51] *** Quits: andrew-d_w (andrew-d_w@1B837FFB.F046727F.1351F780.IP) (Ping timeout)
[23:02:52] *** Joins: lkuper (lkuper@87D98E32.4046EB22.428F94DD.IP)
[23:03:02] <huon> sfackler: it just requires an explicit deref to call the contained downgrade 
[23:03:07] <cmr> acrichto: TIL
[23:03:15] <huon> and it seems unlikely that we'd have a situation where the types matched
[23:03:21] <sfackler> one option could be to make rc's downgrade a free funciton
[23:03:27] <sfackler> so you'd have Rc::downgrade(my_rc)
[23:03:27] <huon> acrichto: *mind blown*
[23:03:34] <huon> sfackler: this is a problem with autoderef in general
[23:03:41] <huon> and UFCS gives us that
[23:03:41] <sfackler> and leave the deref impl
[23:03:42] <sfackler> yeah
[23:03:55] <sfackler> is it too late to add the -> operator? :P
[23:04:00] <huon> (&T).clone() could call either T or &T's clone
[23:04:06] <huon> makes deriving unhappy :(
[23:04:16] <huon> (at least, makes it's error messages unhappy)
[23:04:26] <huon> sfackler: I wouldn't be entirely against that
[23:05:02] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Input/output error)
[23:05:04] <sfackler> I also find it a bit weird from a readability perspective to have something that looks like a MyFoo, but is secretly a MutexGuard<MyFoo> and now has an extra cond field out of nowhere
[23:05:20] <brson> cmr: thanks
[23:07:16] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Connection reset by peer)
[23:07:18] <sfackler> I dunno. API design is hard :/
[23:07:20] <huon> sfackler: meh, static types catch most things :P
[23:07:43] <huon> unless is one is storing something with a condition variable inside a mutex
[23:07:53] <huon> but that seems rather peculiar?
[23:08:16] <sfackler> yeah
[23:08:23] *** Joins: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net)
[23:08:43] <acrichto> use std::rc::Rc; struct Foo { ptr: int } Rc::new(Foo { ptr: 3 }).ptr
[23:08:44] <huon> (of course it's not just MutexGuard with this potential problem)
[23:08:52] <acrichto> rusti: use std::rc::Rc; struct Foo { ptr: int } Rc::new(Foo { ptr: 3 }).ptr
[23:08:53] -rusti- <anon>:10:50: 10:77 error: field `ptr` is private
[23:08:53] -rusti- <anon>:10         use std::rc::Rc; struct Foo { ptr: int } Rc::new(Foo { ptr: 3 }).ptr
[23:08:53] -rusti-                                                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~
[23:08:53] -rusti- error: aborting due to previous error
[23:08:54] -rusti- application terminated with error code 101
[23:09:03] <huon> acrichto: iirc there's a bug about that
[23:09:05] <acrichto> yeah
[23:09:19] <sfackler> that's weird
[23:09:44] <huon> sfackler: it should theoretically just skip the private fields as purely implementation details
[23:10:00] <huon> rusti: use std::rc::Rc; struct Foo { ptr: int } Rc::new(Foo { ptr: 3 }).a
[23:10:01] -rusti- pastebinned 11 lines of output: http://sprunge.us/VMfI
[23:10:17] <sfackler> huon: but only if it's not visible in that scope, right? ptr is still visible in that context
[23:10:21] <huon> maybe that should mention that the internal type doesn't have an a
[23:10:31] <huon> sfackler: it's Rc's .ptr that's private
[23:10:36] <sfackler> oh
[23:10:40] <sfackler> got it
[23:10:54] <sfackler> I was scared that the visibility logic was totally busted
[23:11:28] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:12:38] *** Quits: TheHydroImpulse (TheHydroIm@moz-A9FB1B83.ed.shawcable.net) (Client exited)
[23:13:53] <cmr> that should actually be a simple fix I think...
[23:14:07] <cmr> if it finds a field but it's private, autoderef and check again.
[23:14:09] <huon> cmr: looks like you're fixing it :P
[23:14:23] <cmr> feh
[23:14:25] <cmr> guess I am
[23:14:53] <cmr> after I find my keys
[23:15:01] <huon> they're what you're typing on
[23:15:19] <huon> (have to be relatively careful to get nice-ish error messages, I guess)
[23:16:57] <cmr> well actually
[23:17:05] <cmr> I think that error might just need to be removed entirely
[23:17:11] <cmr> I think autoderef will handle that later
[23:17:13] <cmr> will have to test
[23:17:24] * cmr brought that error message into this world, will take it out
[23:21:21] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:21:43] *** Joins: mawuli (mawuli@F7A4F2ED.68EE7C48.E520B65A.IP)
[23:23:18] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:28:03] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:38:31] *** Joins: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru)
[23:40:48] <brson> restarting buildbot
[23:42:42] *** Quits: aurynj (Eon@C498BDEC.C264657C.C6282BC4.IP) (Ping timeout)
[23:42:51] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[23:43:07] *** Quits: jdm (jdm@13F2CEC5.7672369.D8E68FF6.IP) (Quit: Lost terminal)
[23:45:05] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[23:45:31] <larsberg> brson: fyi, we had to do the same thing today (with bhearsum's help). I've started documenting the "magic" so that hopefully as we get more people with internal vpn access others can HUP the servers :-) https://github.com/mozilla/servo/wiki/Buildbot-administration
[23:46:14] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[23:46:49] *** Quits: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net) (Quit: Leaving)
[23:46:53] *** Joins: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net)
[23:47:16] *** Quits: clusterfoo (clusterfoo@moz-F8B381B4.hm.shawcable.net) (Quit: Leaving)
[23:47:59] *** Quits: tjc (tjc@moz-7EE2AFFC.hfc.comcastbusiness.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[23:48:04] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:51:36] *** Joins: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP)
[23:51:36] <ghrust> [13rust] 15brson fast-forwarded 06dist-snap from 1439b48fb to 141f35f83: 02http://git.io/frxa8w
[23:51:36] *** Parts: ghrust (ghrust@511FAEBD.6A2AE50.F3114085.IP) ()
[23:52:33] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Quit: ChatZilla 0.9.90.1 [Firefox 31.0a1/20140324030203])
[23:52:58] *** Quits: dmsky (dmsky@moz-63A2E3E4.pppoe.spdop.ru) (Input/output error)
[23:54:31] <strcat> brson: is 0.10 being released today?
[23:54:50] <brson> strcat: no. late next week probably
[23:54:56] <brson> just getting the dist process working
[23:55:00] <strcat> ah
[23:59:23] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
