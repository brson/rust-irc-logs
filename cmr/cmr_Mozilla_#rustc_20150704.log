[00:13:02] <nrc> done!
[00:19:45] <arielb1> thanks
[00:28:43] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[00:45:27] *** Quits: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se) (Ping timeout: 121 seconds)
[00:49:15] *** Quits: arielb1 (Ariel@moz-fvk.j5m.66.109.IP) (Connection closed)
[01:03:33] <doener> *lol* switch i1 with three arms (true, false, default) and the default one leads to another switch i1 that only has a default arm
[01:13:41] <eddyb_> doener: yeah, I remember seeing that
[01:24:20] *** Quits: acharles (acharles@moz-ulbdcn.ca.comcast.net) (Ping timeout: 121 seconds)
[01:25:04] *** Joins: acharles (acharles@moz-ulbdcn.ca.comcast.net)
[02:35:13] *** eddyb_ is now known as eddyn
[02:35:17] *** eddyn is now known as eddyb
[02:53:12] *** Quits: kimundi (kimundi@moz-7qf02q.u2oo.e3ub.57bc.2002.IP) (Ping timeout: 121 seconds)
[02:58:13] *** Joins: kimundi (kimundi@moz-lav8m7.nhp5.i6et.57bc.2002.IP)
[03:56:17] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[05:20:27] *** Joins: bombless (_@moz-j3l.99o.23.14.IP)
[07:15:19] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[07:18:48] <eddyb> nmatsakis: any chance debrujin indices could be used to replace the current Type/Self/Fn "spaces"?
[07:27:05] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[08:03:02] *** Joins: bluss (bluss@moz-ec5o68.cust.bredbandsbolaget.se)
[08:53:06] <doener> eddyb: https://gist.github.com/dotdash/72f90ca9b91c25b84789
[08:53:30] <doener> eddyb: we really need to improve match codegen
[08:54:00] <eddyb> first we have to make the trans code doing it readable
[09:35:02] <bluss> doener: this is why they call our libstd code readable. Because we haven't profiled and tweaked everything, but we probably should have
[09:35:31] <bluss> doener: it would be awesome to improve match, but it's probably best to do your modification in libcore too?
[09:36:53] <doener> bluss: I actually have something better for the concrete case I was looking at (PartialEq for Vec, other rather slices in general)
[09:37:17] <doener> bluss: we're not making use of the fact that the slice length is known
[09:37:53] <doener> bluss: given that, we can completely drop the checks for the (None, Some(_)) and (Some(_), None) cases and just use zip
[09:38:09] <bluss> oh cool that's good. I thought we did this?
[09:38:40] <bluss> it might actually have been me that added this code long ago (our collections didn't impl PartialOrd properly)
[09:38:41] <doener> bluss: we check the length first to return early, but we still check that both iterators returned None at the end
[09:38:57] <doener> but that is guaranteed if the lengths match
[09:39:02] <bluss> good point
[09:39:26] <bluss> doener: the end goal though is to just have memcmp for POD
[09:39:45] <doener> bluss: yeah
[09:40:05] <doener> btw, is there a memcmp loop idiom thing in LLVM now? IIRC there was only one for memcpy last time I checked
[09:40:42] <bluss> probably not implemented
[09:41:34] <eddyb> memchr would be pretty good, too
[09:42:13] <bluss> doener: I'm wondering if we should have a helper function to zip slices, might be .zip() codegen is not good enough
[09:43:02] <doener> bluss: hm, not sure if I see what you're getting at
[09:43:17] <bluss> hm maybe it is, I have benchmarks for this
[09:43:49] <bluss> if .zip() codegen is bad you can use an unsafe block to have it skip bounds checks on one of the slices
[09:44:23] <eddyb> doener: LLVM doesn't optimize .zip on slices to use only 3 pointers
[09:44:32] <eddyb> or it didn't, last I heard
[09:45:25] <bluss> it does sometimes. actually right now itertools' benchmarks for this shows a simple .zip() to be equivalent. But the benchmark might not be good enough (maybe the compiler gleans too much information statically)
[09:45:42] <eddyb> black box the input slices
[09:45:43] <bluss> (to be equivalent to a simple counted loop)
[09:46:15] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[09:46:34] <bluss> eddyb: yes they don't do that properly, I will
[09:55:38] <doener> hm, the codegen for PartialEq for Vec had actually regressed, but I have no idea why...
[09:56:09] <doener> stable gets better asm than nightly
[10:11:37] <bluss> eddyb: ok that's great, then the different zip iteration methods are differentiated https://gist.github.com/anonymous/b6d8b8d4033cf208b949
[10:12:02] <bluss> (source https://github.com/bluss/rust-itertools/blob/55d44d296ed60a24340e8d3ba6752d389d398806/benches/bench1.rs )
[10:12:27] <bluss> eddyb: but I thought the unchecked counted loop would be optimal
[10:30:31] *** Joins: arielb1 (Ariel@moz-s1k.6iv.65.109.IP)
[10:42:47] *** Joins: acharles_ (acharles@moz-ulbdcn.ca.comcast.net)
[10:43:34] *** Quits: acharles (acharles@moz-ulbdcn.ca.comcast.net) (Ping timeout: 121 seconds)
[10:43:34] *** acharles_ is now known as acharles
[10:44:07] *** Quits: doener (doener@moz-fnh.n4j.147.5.IP) (Quit: leaving)
[10:48:02] *** Joins: acharles_ (acharles@moz-ulbdcn.ca.comcast.net)
[10:50:37] *** Quits: acharles (acharles@moz-ulbdcn.ca.comcast.net) (Ping timeout: 121 seconds)
[10:52:53] *** Quits: acharles_ (acharles@moz-ulbdcn.ca.comcast.net) (Ping timeout: 121 seconds)
[11:04:18] *** Quits: aatch (james@moz-is4j4r.cable.telstraclear.net) (Ping timeout: 121 seconds)
[11:14:54] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[11:32:53] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[11:39:10] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[14:04:27] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[15:00:05] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[15:16:05] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[15:53:41] *** Quits: eddyb (eddyb@moz-h7s.q07.26.188.IP) (Quit: Konversation terminated!)
[15:53:48] *** Joins: eddyb (eddyb@moz-h7s.q07.26.188.IP)
[16:08:15] *** Quits: barosl (barosl@moz-tmp.qma.67.220.IP) (Quit: Leaving)
[16:36:06] *** Quits: bombless (_@moz-j3l.99o.23.14.IP) (Ping timeout: 121 seconds)
[16:51:14] *** Joins: brson (brson@moz-dv7ilb.tmodns.net)
[16:51:14] *** ChanServ sets mode: +qo brson brson
[16:53:07] *** Joins: barosl (barosl@moz-tmp.qma.67.220.IP)
[16:54:13] *** Quits: brson (brson@moz-dv7ilb.tmodns.net) (Connection closed)
[20:01:55] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[20:42:17] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[20:59:14] *** Joins: doener (doener@moz-fnh.n4j.147.5.IP)
[20:59:23] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[21:59:37] *** Joins: Rym (uid91135@moz-n2i7qm.charlton.irccloud.com)
[22:22:39] *** Quits: arielb1 (Ariel@moz-s1k.6iv.65.109.IP) (Quit: Ex-Chat)
[22:23:42] *** Joins: aatch (james@moz-is4j4r.cable.telstraclear.net)
[22:56:37] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
[23:13:34] *** Joins: nagisa (nagisa@moz-8t068g.static.zebra.lt)
[23:36:55] *** Quits: Tobba (Tobba@moz-o13d22.bredband.telia.com) (Ping timeout: 121 seconds)
[23:38:44] *** Joins: Tobba (Tobba@moz-o13d22.bredband.telia.com)
[23:53:54] *** Quits: nagisa (nagisa@moz-8t068g.static.zebra.lt) (Ping timeout: 121 seconds)
