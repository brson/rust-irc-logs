[00:00:47] *** Quits: Skif_ (emschwar@moz-CA025D57.ip.mcleodusa.net) (Ping timeout)
[00:02:10] <wycats_> I see the .so in build/ in protobuf
[00:02:23] <wycats_> tjc: do I need to do rustpkg install it now?
[00:04:05] <wycats_> tried that... still doesn't find protobuf
[00:04:40] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[00:05:03] *** Joins: dherman (dherman@B84EF6E.51F5D9AD.1345D9C9.IP)
[00:05:03] *** ChanServ sets mode: +ao dherman dherman
[00:05:47] <cmr> wycats_: and I'm back!
[00:05:55] <cmr> wycats_: would you still like the example?
[00:06:04] <wycats_> cmr: yessir
[00:06:16] * cmr reads log
[00:07:17] *** Quits: alan (alan@moz-FE02DD30.sat6.rackspace.com) (Ping timeout)
[00:08:05] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[00:08:16] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[00:08:32] <wycats_> tjc: no dice
[00:08:37] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[00:10:21] <cmr> wycats_: so the basic idea is that you partially construct a finite number of nodes on the stack, and then wire them up to point to each other.
[00:10:22] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[00:10:53] <cmr> wycats_: which is why it's possible: finite number
[00:13:13] <wycats_> cmr: and you can statically tell the number of nodes?
[00:13:22] <cmr> wycats_: nope.
[00:13:23] <cmr> https://gist.github.com/cmr/7e4f28df11694c3d1dd8
[00:13:25] <wycats_> tjc: turns out the test.rs issue was a real issue
[00:13:39] <wycats_> cmr: interesting
[00:13:43] <cmr> wycats_: well, you can, compiler can't :p
[00:13:45] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[00:13:54] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[00:13:57] <twocoat> never trust a file named "test"
[00:14:16] <cmr> wycats_: If you use a non-~T reference (ie, something which isn't owning), you can create stack-only trees and soforth/
[00:14:34] <tjc> wycats_: What was the test.rs issue again? sorry, lost track :-)
[00:14:56] <wycats_> tjc: it yelled at me about not having globs turned on in test.rs
[00:15:03] <wycats_> I assumed it meant I put test.rs in the wrong place
[00:15:05] <wycats_> moved it
[00:15:10] <wycats_> but other files reference test.rs
[00:15:35] <tjc> wycats_: test.rs is a "special" file name with significance to rustpkg, but it sounds like this package uses it like any other module...
[00:15:55] <wycats_> it has #[cfg(test)] above the mod entry
[00:16:21] <wycats_> does rustpkg enable that config?
[00:16:31] <tjc> so I suggest renaming test.rs to something else, and, of course, changing the `use` directives accordingly
[00:16:57] <wycats_> what's going on with #[cfg(test)]?
[00:17:07] <wycats_> I'd expect that to hide the use directives
[00:17:18] <twocoat> what project are you working on?
[00:17:29] <wycats_> twocoat: rust-protobuf
[00:18:32] <tjc> wycats_: test code still gets typechecked even if it's under a #[cfg(test)]
[00:18:42] <wycats_> tjc: interesting
[00:18:45] <tjc> (I think; I know it gets parsed, at least, but code doesn't get generated if you don't pass --test)
[00:19:14] <wycats_> tjc: and rustpkg doesn't treat the test.rs as part of the same crate?
[00:19:21] <wycats_> so it doesn't inherit the glob feature optin?
[00:19:39] <tjc> wycats_: No, rustpkg assumes that if there is a test.rs, it's its own crate
[00:19:59] <wycats_> tjc: yeah makes sense
[00:20:06] <wycats_> so he really needs to change his testing structure
[00:20:12] <wycats_> so use rustpkg-idiomatic testing
[00:20:13] <Leo`> tjc: btw, what will Rustpkg do if it sees both a main.rs and a lib.rs ?
[00:20:38] <tjc> Leo`: it will compile both an executable binary, and a library, using main.rs as the entry point in the first case, and lib.rs as the top-level crate in the second case
[00:20:52] <Leo`> ok
[00:20:53] *** Joins: Tari (tari@moz-1713FB27.mtu.edu)
[00:20:54] <wycats_> tjc: I got it compiling by removing the testing stuff
[00:21:03] <wycats_> tjc: now how do I get it into my other project?
[00:21:53] <tjc> wycats_: in that case, you should be able to set your RUST_PATH to the directory containing the src/protobuf directory...
[00:21:56] <tjc> and then build the other project
[00:22:08] <wycats_> bingo
[00:22:22] <wycats_> successfully imported
[00:23:00] <wycats_> should rustpkg install github.com/wycats/rust-protobuf work now?
[00:23:29] <wycats_> sorry rustpkg install github.com/wycats/protobuf
[00:23:42] <wycats_> I pushed it up there, but trying to rustpkg install it doesn't work
[00:23:47] <wycats_> even though RUST_PATH works
[00:29:22] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[00:30:24] <wycats_> hm... I now have client_v1.rs next to common.rs - my main.rs file imports client_v1.rs and client_v1.rs imports common.rs
[00:30:34] <wycats_> I'm getting a compiler errors about common::* not being resolvable
[00:31:31] <wycats_> a compiler error*
[00:34:00] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: zzzzzzzzzz)
[00:34:24] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[00:34:53] <wycats_> noooooo
[00:35:16] *** Joins: alan (alan@32702EE8.939109B2.FB082A98.IP)
[00:37:22] *** Joins: jakedust (Jake@moz-9CC82466.dsl.telesp.net.br)
[00:39:08] *** Quits: bynaryshef (bynaryshef@moz-433ADB5E.mem.bellsouth.net) (Quit: Leaving)
[00:39:10] <wycats_> so what am I doing wrong?
[00:39:13] <wycats_> I have three files
[00:39:23] <wycats_> main.rs, client_v1.rs, and common.rs
[00:39:31] <wycats_> main.rs uses client_v1, which uses common
[00:39:37] <wycats_> I'm getting a compiler error about finding common
[00:40:45] <wycats_> this seems like a simple case?
[00:42:12] *** Joins: brson (brson@5AB4884B.FCC4549.14D5B978.IP)
[00:42:12] *** ChanServ sets mode: +ao brson brson
[00:42:21] *** Quits: brson (brson@5AB4884B.FCC4549.14D5B978.IP) (Quit: leaving)
[00:42:25] *** Joins: brson (brson@5AB4884B.FCC4549.14D5B978.IP)
[00:42:25] *** ChanServ sets mode: +ao brson brson
[00:43:55] *** Quits: kirneh (kirneh@moz-ACBB9422.k955.webspeed.dk) (Quit: leaving)
[00:45:13] *** Quits: sprocket (Mibbit@moz-B234C23B.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[00:48:11] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Quit: )
[00:48:32] <wycats_> ok how would I do this with rustc?
[00:49:47] *** Quits: jakedust (Jake@moz-9CC82466.dsl.telesp.net.br) (Quit: jakedust)
[00:53:38] <wycats_> anyone? how do I tell rustc that an extern mod is located in an .so file?
[00:54:13] <cmr> wycats_: you don't. just add the path the .so lives in with -L path/to/place
[00:54:23] <cmr> it will look lin libfoo-somehashere.so
[00:55:12] <wycats_> ok sweet
[00:55:16] <wycats_> now back to the original problem
[00:55:29] <wycats_> three files... rustc is complaining it can't find common::*
[00:55:39] <wycats_> it finds client_v1 fine
[00:56:16] <wycats_> hm... I was able to fix it by including mod common in main.rs
[00:56:20] <wycats_> am I supposed to have to do that
[00:56:46] <SiegeLord> Is there mod common elsewhere?
[00:57:11] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[00:57:23] <wycats_> the error I'm getting is client_v1.rs:5:4: 5:10 error: unresolved import. maybe a missing `extern mod common`?
[00:58:02] *** jorendorff is now known as jorendorff_away
[00:58:31] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Quit: Leaving)
[00:58:32] *** Quits: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse_)
[00:58:49] <SiegeLord> If you're using something, it needs to come from a mod or an extern mod
[00:58:59] *** Quits: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) (Ping timeout)
[00:59:01] <SiegeLord> Files don't mean anything to rustc, only those two matter
[00:59:13] <wycats_> so basically that generated code from protobuf is assuming that I'll mod all the linked modules in the main crate file
[01:00:30] <wycats_> I think it works!
[01:00:54] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[01:00:54] *** ChanServ sets mode: +o tjc
[01:03:42] *** Quits: dherman (dherman@B84EF6E.51F5D9AD.1345D9C9.IP) (Quit: dherman)
[01:05:27] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[01:06:01] *** Quits: Mowah (Mowah@moz-436C35C5.cust.bredbandsbolaget.se) (Ping timeout)
[01:06:05] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[01:06:28] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Max SendQ exceeded)
[01:07:45] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[01:09:00] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[01:09:00] *** ChanServ sets mode: +ao pcwalton pcwalton
[01:09:14] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[01:10:32] <acrichto> wycats_: just landed #10422, so now instead of having to do all that funk _rust_crate_map_toplevel business when calling rust from C you can just build the library with '-Z gen-crate-map'
[01:10:42] <acrichto> not that it's really any less obscure than it was before
[01:11:00] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[01:13:45] <acrichto> haha I just saw that bors/github flags a pull request as "All is well" when the tests pass
[01:13:56] *** Quits: jeffdb (jeff@moz-9D2E3B02.hsd1.wa.comcast.net) (Quit: jeffdb)
[01:16:16] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Ping timeout)
[01:17:09] *** Quits: bholley (anonymous@moz-BBE3ABD.mv.mozilla.com) (Quit: bholley)
[01:17:34] *** Quits: tikue_ (quassel@moz-FEADCD38.hsd1.pa.comcast.net) (Quit: No Ping reply in 180 seconds.)
[01:19:35] *** Joins: tikue_ (quassel@moz-FEADCD38.hsd1.pa.comcast.net)
[01:24:38] *** Quits: twocoat (twocoat@moz-F9806A3F.stny.res.rr.com) (Quit: Leaving...)
[01:25:06] *** Quits: Dessimat0r (Dessimat0r@E879B262.8D4FD984.4320F744.IP) (Ping timeout)
[01:25:11] *** Joins: Dessimat0r (Dessimat0r@E879B262.8D4FD984.4320F744.IP)
[01:25:46] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:25:48] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:25:55] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[01:25:57] <wycats_> acrichto: can haz gist?
[01:26:05] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:26:22] <wycats_> acrichto: I got the hello world version of the rest of the stuff working today, so I'll probably try opening via dlopen tomorrow
[01:26:24] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[01:26:51] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Broken pipe)
[01:26:52] <acrichto> my gist disappeared
[01:26:53] <acrichto> :(
[01:26:57] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[01:26:59] <wycats_> acrichto: https://gist.github.com/anonymous/7408714
[01:27:00] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[01:27:02] <wycats_> boom
[01:27:08] <acrichto> man you're good
[01:27:20] <acrichto> oh I can't edit it anyway
[01:27:23] <wycats_> acrichto: I saved that gist as if it was made of gold
[01:27:25] <wycats_> fork it
[01:27:37] * acrichto just learned you can fork gists
[01:28:02] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Connection reset by peer)
[01:28:11] <acrichto> wycats_: https://gist.github.com/alexcrichton/7423809 should work
[01:28:13] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[01:28:16] <aatch> acrichto, you can also look through the revision history
[01:28:21] <acrichto> I don't have a super-up-to-date compiler, but that was what I was striving for
[01:28:32] <kmc> do I need to pass --cfg debug to have debug!() statements compiled, or is there another way?
[01:28:47] <kmc> we have them in Servo but I don't think we're passing --cfg debug anymore, so I'm confused
[01:28:52] <wycats_> so what does the gen-crate-map option do?
[01:29:06] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[01:29:08] <cmr> kmc: you don't need to do anything to enable debug!()
[01:29:14] <cmr> but --cfg ndebug disables them
[01:29:32] <kmc> oh
[01:30:27] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[01:30:33] <acrichto> wycats_: the special "crate map" symbol I defined in C last night is basically the runtime's glue to the rest of the world
[01:30:43] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[01:30:49] <acrichto> it's used for both creating I/O handles as well as logging macros right now
[01:31:07] <wycats_> acrichto: so I still have to start the runtime, but not IO anymore?
[01:31:09] <acrichto> by specifying -Z gen-create-map on a dynamic library generation, it'll generate a proper crate map that the runtime will lookup and find
[01:31:30] <acrichto> wycats_: correct, you'll get I/O automatically, but you have to link to the rustuv crate
[01:31:30] <wycats_> <3
[01:31:39] <acrichto> executables by default link to rustuv, but not libraries
[01:31:43] <acrichto> that's why you have to explicitly state it
[01:31:56] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Ping timeout)
[01:32:07] <wycats_> and extern mod rustuv is enough to tell the compiler to link it in?
[01:32:22] <acrichto> yes
[01:32:38] <acrichto> you don't actually explicitly use it, but it pulls in some metadata and lang_item things which get all mixed in
[01:32:38] <wycats_> so in practice I run whatever code I need inside do rt::start(0, ptr::null()) ?
[01:32:43] <acrichto> yes
[01:32:51] <wycats_> in my case that will be some code listening on a socket for messages
[01:32:56] *** Joins: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net)
[01:32:59] <wycats_> which it then sends over HTTP
[01:33:08] <wycats_> so a loop inside of the rt::start block
[01:33:15] <acrichto> sounds about right
[01:33:19] *** Quits: abnrngr (user@C31B7093.A9FCDC29.B3C843D.IP) (Input/output error)
[01:33:22] *** Joins: Mowah (Mowah@moz-436C35C5.cust.bredbandsbolaget.se)
[01:33:25] *** Joins: abnrngr (user@C31B7093.A9FCDC29.B3C843D.IP)
[01:33:27] <acrichto> inside of rt::start you're a regular rust task with all regular privileges and whatnot
[01:33:27] <wycats_> acrichto: tomorrow will tell!
[01:33:54] <acrichto> wycats_: if you run into problems, feel free to ping me!
[01:34:10] <wycats_> acrichto: today was... interesting
[01:34:26] <wycats_> I have abandoned rustpkg
[01:34:31] <wycats_> not crying too much
[01:34:32] <acrichto> such a rousing endorsement!
[01:34:41] <kmc> cmr: I don't suppose it's different with rustpkg?
[01:34:50] <acrichto> from what I've seen rustpkg is still a little sharp around the edges
[01:34:50] <wycats_> acrichto: I run a project with a learning curve
[01:34:55] <kmc> I'm building one of Servo's deps with rustpkg and I don't see it in the RUST_LOG=? crate map
[01:34:58] <wycats_> acrichto: that's an understatement
[01:35:12] <wycats_> it doesn't actually do package manager stuff
[01:35:19] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[01:35:21] <wycats_> "just set RUST_PATH" WAT
[01:36:34] <wycats_> there was a bug I ran into where just having the built .so wasn't enough
[01:36:44] <wycats_> rustpkg didn't find it and instead went looking for the source
[01:36:57] <wycats_> but in general, the UX just felt very, very weak
[01:37:07] <wycats_> it seems like a mildly retooled rustc
[01:37:09] <cmr> kmc: no, unless someone is setting it
[01:37:12] <wycats_> with fewer users
[01:38:05] <tikue> wycats_: it's way better than writing your own makefiles imo
[01:38:07] <wycats_> acrichto: again, as a person who runs a project with a learning curve, I am not holding it against Rust and am just moving on
[01:38:19] <wycats_> tikue: I'm not sure if it's way better than writing Rakefiles
[01:38:28] <acrichto> wycats_: thanks for being understanding!
[01:38:45] <wycats_> acrichto: I hope I don't run out of time before I get this working
[01:38:47] *** Joins: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP)
[01:38:51] <cmr> wycats_: rustpkg also fetches from remotes and does recursive dependency resolution.
[01:39:03] <wycats_> cmr: except I couldn't get that to work at all in my case
[01:39:08] <cmr> right
[01:39:13] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[01:39:20] <wycats_> even when I reorganized the package
[01:39:33] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[01:39:36] <wycats_> (enough reorganization to get rustpkg build to work locally wasn't enough to get it to work remotely)
[01:40:27] <wycats_> I'm sure in principle it's a nice thing, but it's not working well enough right now for it to be on the happy path, which is unfortunate because the "bring in an external library to use in your project" is worse in Rust now than it is in JS, which is saying something
[01:40:53] <wycats_> (again, I'm not taking this as being a severe problem for my usage, I'm just saying)
[01:41:12] <SiegeLord> I'm not sure how that's the case... you just stick the crate in a place where rust looks
[01:41:15] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[01:41:19] <SiegeLord> *rustc looks
[01:41:31] <SiegeLord> It's currently simpler than C/C++ method
[01:41:40] <wycats_> SiegeLord: JS has roughly the same setup
[01:41:45] <wycats_> but you're eliding important details
[01:41:59] <SiegeLord> There are none, that's how I use rustc packages today
[01:42:03] <wycats_> "stick the crate in a place" is actually a somewhat manual setup that doesn't scale with N packages and N developers
[01:42:18] <SiegeLord> sudo cp crate.so /usr/local/lib
[01:42:23] <SiegeLord> Boom, installed
[01:42:27] <wycats_> how did you get the crate.so in the first place?
[01:42:30] <SiegeLord> (actually the path is somewhere else I think)
[01:42:38] <wycats_> how did you get the repo?
[01:42:54] <SiegeLord> Well, git clone and then try to follow the readme
[01:43:01] <wycats_> it's not at all fatal, but most other languages have answers to these questions that work better than "clone and repo and build stuff manually"
[01:43:06] <wycats_> SiegeLord: yeah... that suuuuuuucks
[01:43:06] *** Quits: jvshahid (jvshahid@moz-C1BC0CE4.nyc.res.rr.com) (Quit: leaving)
[01:43:15] <SiegeLord> It has worked well enough for C/C++
[01:43:25] <wycats_> SiegeLord: I have nothing further, your honor
[01:43:34] <tjc> wycats_: Sorry, I wasn't looking at IRC for a while, but I thought you had been able to get protobuf to build with rustpkg -- were you not able to in the end?
[01:43:35] <tikue> isn't the whole point of rustpkg that you don't have to git clone etc.
[01:43:47] <SiegeLord> I'm not sure what the point of it is :P
[01:44:03] <kmc> lol "good enough for C++" doesn't cut it here :)
[01:44:04] <SiegeLord> I'm hoping as more people try to use it, it's design will change
[01:44:13] <wycats_> tjc: I was, but I wasn't really willing to use a local RUST_PATH and I couldn't get it working from a github URL
[01:44:22] <wycats_> kmc: thanks :)
[01:44:27] <tjc> wycats_: from which github URL?
[01:44:51] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[01:45:06] <wycats_> https://github.com/wycats/protobuf
[01:45:22] <wycats_> I was able to make rustpkg install and rustpkg build work with that repo locally
[01:45:30] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[01:45:33] <wycats_> but rustpkg install github.com/wycats/protobuf did not
[01:46:11] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[01:46:22] <tjc> Oh… yeah, the workspace structure is just local
[01:46:28] <tjc> rustpkg fetches packages into workspaces
[01:47:02] <tjc> So, if your package on github had the contents of https://github.com/wycats/protobuf/tree/master/src/protobuf at the root, it would work
[01:47:05] *** Joins: m_kato (m_kato@moz-C286AD9A.bitcat.net)
[01:48:19] <wycats_> tjc: aha
[01:48:28] <wycats_> tjc: I will attempt it when I get home
[01:48:46] <tjc> wycats_: Sure. Also, http://static.rust-lang.org/doc/master/tutorial-rustpkg.html explains a little about the workspace structure and what it's for
[01:49:00] <tjc> as well as http://static.rust-lang.org/doc/master/rustpkg.html#package-structure
[01:49:16] <SiegeLord> Except that if you do that, then you can't build it locally in an easy way
[01:49:16] <tjc> the documentation as it exists may not be totally clear, but it is there, and patches (or suggestions) are welcome :-)
[01:49:26] <tjc> SiegeLord: ?
[01:49:55] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: Textual IRC Client: www.textualapp.com)
[01:50:01] <SiegeLord> You essentially will have to have the git repository root inside foo/src/protobuf and rustpkg build from foo
[01:50:36] <tjc> SiegeLord: Yes, that's by design. You create a workspace locally, and check out packages into the workspace (either with rustpkg, automatically; or manually, with `git clone`)
[01:50:42] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[01:50:51] <tjc> It's so that you can organize packages that depend on each other into a single workspace
[01:51:03] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[01:52:07] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[01:52:27] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[01:53:19] <wycats_> tjc: this is not how I would have designed it
[01:54:23] *** Quits: joelteon (bzzt@moz-317E8D0C.io) (Quit: I'm out)
[01:55:06] <o11c> it makes perfect sense to me (as someone who is just looking into rust)
[01:55:14] <tjc> wycats_: While it's quite late in the game, I imagine that a concrete proposal for changing any part of rustpkg's design will, in principle, be considered, especially if accompanied by an implementation.
[01:55:20] <o11c> unlike some of the other decisions rust made :(
[01:55:23] <tjc> So long as it preserves all the existing functionality, of course.
[01:55:32] <cmr> wycats_: What do you find insufficient?
[01:55:33] <tikue> o11c: what decisions?
[01:55:43] *** Quits: TeXitoi (texitoi@moz-EA958D66.texitoi.eu) (Ping timeout)
[01:55:45] *** Joins: TeXitoi (texitoi@moz-EA958D66.texitoi.eu)
[01:55:52] <o11c> 1. choosing unary operator ~ to mean something else
[01:56:00] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[01:56:09] <tikue> that is very possibly going to change back
[01:56:13] <o11c> 2. not letting editors finally be able to match template parameters by using *anything* other than <>
[01:56:31] <tikue> i don't think that's true
[01:56:37] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[01:56:58] <SiegeLord> I'm not sure what's so good about the unary ~ :P
[01:56:59] <o11c> editors taht try to solve it generally say "if there are spaces, it's a comparison; if there are no spaces, it's a template"
[01:57:06] <paupau> pretty sure rust hasn't repeated C++'s <> nightmare :)
[01:57:21] <cmr> o11c: rust solves that by requiring :: before typarams in expressions.
[01:57:26] <cmr> In types, it's unambiguous
[01:57:39] <o11c> so I can't press % in vim to switch between the pair
[01:57:56] <o11c> because it will be confused by any < > that are used as comparisons
[01:58:14] <strcat> o11c: there wouldn't be an ~ operator if unique ptrs didn't use it
[01:58:22] <o11c> SiegeLord: you can say all you want about how flag fields *should* be done, but we aren't getting rid of the way C does them
[01:58:30] <strcat> well, I guess it could be used for something weird
[01:58:42] *** Quits: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP) (Quit: tautologico)
[01:58:53] <o11c> strcat: how do you remove a bit flag? In C: flags &= ~OPT_WHATEVER;
[01:58:59] <cmr> o11c: unary !
[01:59:00] <strcat> rusti: !5
[01:59:01] <sfackler> o11c: !OPT_WHATEVER
[01:59:01] -rusti- -6
[01:59:12] <o11c> wait, what?
[01:59:21] <o11c> wtf
[01:59:25] <o11c> ugh
[01:59:37] <cmr> What else would "invert" do on numeric types?
[01:59:38] <strcat> o11c: rust has bitwise negation as !, there's no separated negation ops
[01:59:39] <o11c> PLEASE don't break existing conventiosn just because you're working on a new lagnuage
[01:59:42] <cmr> We don't have implicit conversion.
[01:59:42] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:59:53] <SiegeLord> I think the design flaw here is that the Rust spec isn't directly downloaded into one's brain ;)
[02:00:05] <o11c> I know you don't have implicit conversion, I don't care
[02:00:07] <wycats_> tjc: once I get further along I will probably do some concrete work
[02:00:13] <cmr> o11c: Yes, why fix weird inconsitencies
[02:00:16] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[02:00:17] <o11c> this is a place where it would be very easy to be just like every other language, with no cost
[02:00:19] <strcat> o11c: so why have two separate operators?
[02:00:25] <strcat> not 'every' language
[02:00:30] <tjc> wycats_: Great! I'm not going to be working on Rust full-time anymore after this week, so the more people who step up to help with rustpkg, the better :-)
[02:00:32] *** Joins: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP)
[02:00:39] <o11c> s/,/ in common use,/
[02:01:01] <strcat> o11c: the ~ operator can be overloaded in python and C++ and is used for plenty of other things
[02:01:02] <wycats_> tjc: cool
[02:01:09] <o11c> strcat: overloading is irrelevant
[02:01:25] *** Joins: dherman (dherman@BE970EA.DAF04A8D.8C90971.IP)
[02:01:26] *** ChanServ sets mode: +ao dherman dherman
[02:01:33] <strcat> o11c: rust exposes the operators in std::ops
[02:01:35] <strcat> as traits
[02:01:38] <paupau> ! is bit flip? nice
[02:01:40] <strcat> types implement them via overloading
[02:01:45] <o11c> I am aware of this
[02:01:54] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:01:57] <mimcpher> just remember that ! looks like an upside down i
[02:02:01] *** Joins: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net)
[02:02:04] <wycats_> acrichto: I assume it's possible to start a task inside that runtime block?
[02:02:04] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[02:02:05] <o11c> but nobody coming from another language is going to see !0 and thing it means ~0
[02:02:19] <o11c> why do I always s/k/g/ ...
[02:02:33] *** Quits: echristo (echristo@B3AA7BA8.D6CCE4AE.77834EAA.IP) (Quit: echristo)
[02:02:33] <cmr> o11c: nobody coming from another language is going to see ~0 and think malloc(sizeof(intptr_t))
[02:02:35] <acrichto> wycats_: you should be able to, yes, although I really should update my local compiler to make sure
[02:02:50] <SiegeLord> Meh, some languages use ~= for != and people deal
[02:03:11] <o11c> cmr: true, but you could have chosen something that doesn't already have well-defined meaning
[02:03:12] <strcat> bash uses tilde for all the things
[02:03:29] <tikue> it seems like a pretty small nit to make such a fuss about imo. this is unhelpful bikeshedding
[02:03:35] <o11c> SiegeLord: hm, I thought ~= was regex ...
[02:03:35] *** Quits: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP) (Quit: tautologico)
[02:03:42] <mimcpher> o11c: that's =~
[02:03:51] <mimcpher> (in perl, at least.)
[02:03:58] <strcat> http://www.gnu.org/software/bash/manual/html_node/Tilde-Expansion.html :D
[02:04:09] <o11c> tikue: I admit ~ is bikeshedding ... the <> thing is a real thing though
[02:04:20] *** Joins: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP)
[02:05:08] <strcat> o11c: so you want it to follow established languages for ~ but not for the generics syntax? 
[02:05:30] <o11c> for *every* other paired set, they are always paired
[02:05:59] <o11c> strcat: there are actual problems with the generics syntax
[02:06:30] *** Quits: nejucomo (Adium@moz-C07D5168.p2p.sfo1.mozilla.com) (Quit: Leaving.)
[02:06:35] <o11c> there are no problems with the syntax for bitwise not (I suppose I'll yield that even for Rust)
[02:06:51] <strcat> two negation operators where one is a redundant version for bool is unnecessary complexity
[02:06:56] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[02:06:56] <strcat> o11c: so what symbols should generics use?
[02:07:03] <paupau> so I'd like to allocate my own stack memory... it looks pretty hairy to do so though. I would have to hack up rt::task::Coroutine and rt::task::Task. Any way to accomplish this easily?
[02:07:05] <strcat> blocks use {}, vectors use []
[02:07:12] <o11c> I've seen a lot of languages use []
[02:07:18] <o11c> and I think D uses !()
[02:07:36] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[02:07:45] <o11c> [] is pleasing to me ... it's like a lookup in a map
[02:07:56] <wycats_> acrichto: In Rust, I should use a standard loop to read from a socket? (Not recursion due to lack of TCO right?)
[02:07:57] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[02:08:05] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[02:08:15] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[02:08:19] <acrichto> wycats_: yes, this is a tcp socket, right?
[02:08:20] <cmr> o11c: I think most of the core devs would rather use [] or ()
[02:08:25] <o11c> strcat: vectors never follow immediately after an identifier thoug, right?
[02:08:26] <wycats_> Yep
[02:08:37] <wycats_> It's a UDS
[02:08:57] <acrichto> wycats_: https://gist.github.com/alexcrichton/7424249 is an example
[02:09:05] <acrichto> a bad example, but it's an example!
[02:09:10] <mimcpher> paupau: horrible way 1: write a c function that calls "alloca" and then calls a rust function that uses the memory
[02:09:16] <acrichto> I think the unwrap() probably isn't necessary
[02:09:37] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[02:09:40] <wycats_> basically it listens for messages that are protobufs and then ships them over HTTP after aggregating them for some time
[02:09:54] <strcat> mimcpher: alloca allocates on the current stack
[02:10:27] <strcat> if it's a fixed-size allocation it's no different than a fixed-size vector
[02:10:33] <o11c> cmr: that's good to hear, but do you think it will change before it's too late?
[02:10:42] <cmr> o11c: no
[02:10:48] <cmr> considered unimportant
[02:11:04] <wycats_> acrichto: it's a line protocol so readline works
[02:11:07] <mimcpher> strcat: right, which is why I said it it calls another function (ie, keepig it on the stack) that can use the data
[02:11:12] <paupau> mimcpher: yo! er I mean like: I want to allocate my own 2MB block of stack memory, rather than relying on the runtime
[02:11:26] <o11c> syntax is not the *most* important thing, but it's still important ...
[02:11:29] <acrichto> wycats_: right now read_line() isn't defined on a generic Reader, you'll have to wrap it in a BufferedReader
[02:11:31] <strcat> paupau: [u8, 1024 * 1024 * 2]
[02:11:38] <strcat> er
[02:11:41] <o11c> and Rust has already solved most of the sematincs problems
[02:11:42] <strcat> [u8, ..1024 * 1024 * 2]
[02:11:49] <paupau> strcat: well I want to like mmap it and stuff, I can handle the allocation
[02:11:49] <mimcpher> paupau: you mean you want to put the stack somewhere you've allocated?
[02:12:05] <paupau> mimcpher: Yeah I want to do my own allocation, and pass that into spawn_new
[02:12:07] <strcat> paupau: well, what do you want to use the memory for exactly?
[02:12:09] <paupau> er spawn_raw
[02:12:09] <wycats_> acrichto: thanks for that tip. Probably would have burned some time on it
[02:12:33] <acrichto> wycats_: yeah please ask lots of questions about I/O, it's all very much in flux and sadly not much beyond a demo-ready state right now
[02:12:54] <acrichto> wycats_: although if you're doing anything with the filesystem, that should all be in an A-OK state, even with respect to docs, so problems are are bugs!
[02:13:23] <paupau> strcat: I want to write a task that only accesses memory within a certain mmap'd memory region
[02:13:36] * acrichto needs more rust workspaces
[02:13:49] <o11c> look at decorators in python ... they added absolutely nothing to the semantics, but they completely changed the way python is written
[02:14:56] <o11c> anyway, at the risk of turning thsi into a productive discussion ... how do you do parent pointers in rust?
[02:15:13] <cmr> o11c: you can't do it safely without @
[02:15:25] <strcat> you can do it safely with reference counted smart pointers
[02:15:29] <strcat> not the ones in the stdlib
[02:15:53] <strcat> @ will just leak until the end of the task so it's not really right
[02:15:59] <paupau> does rust have any weak pointers yet?
[02:16:07] <paupau> for ARC or something
[02:16:14] <strcat> it doesn't have a reference counted pointer with weak pointers
[02:16:26] <o11c> in C++: class Child { Parent *parent; }; class Parent { unique_ptr<Child> child; public: void set_child(unique_ptr<Child>) { this->child = child; child->parent = this; } unique_ptr<Child> detach_child() { child->parent = NULL; } };
[02:16:27] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[02:16:32] *** kimundi is now known as zz_kimundi
[02:16:34] <paupau> I tried a shot at adding weak pointers to ARC a few months ago and failed
[02:16:40] <strcat> o11c: in unsafe rust, the same code
[02:16:42] <o11c> I don't want reference counts, there should be a unique owner
[02:16:45] <paupau> do you think it's feasible with the current ARC impl?
[02:16:53] *** Quits: ofeldt (ofeldt@moz-3FA92485.dip0.t-ipconnect.de) (Ping timeout)
[02:16:59] <strcat> o11c: ok, so use a raw pointer for the parent as you're doing in C++
[02:17:07] <o11c> okay
[02:17:11] <strcat> will work fine, up to you to maintain memory safety
[02:17:43] <o11c> I'm not *that* surprised that I'll have to drop to unsafe code fairly often ...
[02:18:07] <mimcpher> But the unsafe portions should be small and auditable
[02:18:10] <mimcpher> which is the point
[02:18:12] <o11c> at least it will be only in libraryish code though .. yeah
[02:18:26] <strcat> you don't have to use unsafe code for that if it doesn't need to avoid 1 word overhead per allocation
[02:18:57] <strcat> that's the only overhead of Rc<T> over ~T with 1 owner
[02:19:00] <strcat> well
[02:19:02] <strcat> I guess it'd be 2 word overhead
[02:19:02] *** Quits: lkuper (lkuper@moz-D862222C.dhcp-bl.indiana.edu) (Ping timeout)
[02:19:07] <mimcpher> Most of the unsafe stuff I've written for is a) ffi, or b) zero-copy parsing (ie, transmuting things into structs)
[02:19:09] <strcat> since for weak ptr support you need another
[02:19:25] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[02:19:25] *** ChanServ sets mode: +ao pcwalton pcwalton
[02:19:32] <strcat> mimcpher: transmuting references? fwiw that's not usually valid in C
[02:19:37] <strcat> and may not remain valid in rust
[02:20:00] <strcat> depends on the exact details
[02:20:30] <o11c> I pushed 10 months of changes to prodution lately (C++ code that was originally C) ... I'll be happy to not allow dangling pointers most places
[02:20:40] <o11c> does Option<~T> take one word or two?
[02:20:52] <Yurume> one.
[02:20:59] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[02:21:09] <Yurume> enum has a special casing for one-variant enums.
[02:21:22] <Yurume> (or two-variant enums with one variant being a singleton)
[02:21:28] <cmr> (that is non-nullable)
[02:21:45] <o11c> (no, it's the *second* that's non-nullable)
[02:21:49] <strcat> o11c: Option<*T> on the other hand is 2 words, because *T isn't non-nullable
[02:22:02] <paupau> cd 
[02:22:03] <Yurume> cmr, ah, of course. anyway.
[02:22:05] <paupau> damn
[02:22:05] <wycats_> acrichto: sadly it's all TCP (HTTP) and UDS
[02:22:08] <mimcpher> strcat: yeah, I'm worried about that.  I was going to make a mailing list post at some point this week.  Not clear how it would work in Rust.
[02:22:15] <wycats_> acrichto: does rust support Solaris?
[02:22:34] <Yurume> I think there was a discussion about i63 or u31 for the use in enums...?
[02:22:38] <acrichto> wycats_: it would be lucky if it did, we don't have any bots running on solaris and I've never heard of someone working/trying on solaris
[02:22:52] <strcat> wycats_: rust the language does, rust's stdlib very likely does not
[02:23:13] <strcat> well, certainly does not*
[02:23:14] *** Quits: alan (alan@32702EE8.939109B2.FB082A98.IP) (Quit: alan)
[02:23:18] <o11c> rust the bootstrap process certainly does not, you'd have to cross build
[02:23:21] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[02:23:26] <wycats_> Sadly Joyent's stuff is all Solaris :/
[02:23:40] <tikue> I think SML does i63 and u31 for the purpose of datatypes lol
[02:23:43] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[02:23:53] <strcat> tikue: isn't it for efficient GC?
[02:24:03] <tikue> strcat: ah yes you're right
[02:24:06] <tikue> strcat: thanks :)
[02:24:09] <wycats_> http://smartos.org
[02:24:10] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[02:24:16] <wycats_> ^^ joyent
[02:24:24] <strcat> tikue: what do they do to floats? ;s
[02:24:42] <tautologico> ocaml also uses 1 bit for GC purposes
[02:24:44] <acrichto> libuv supports smartos! <- that's all I know about smartos
[02:24:44] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[02:24:50] <tautologico> floats are boxed
[02:24:52] *** Joins: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP)
[02:25:02] <mimcpher> wycats_: I don't see any particular reason rust shouldn't run on it, so I think it wouldn't be too much work to get going
[02:25:03] *** Joins: ofeldt (ofeldt@moz-382B6ED0.dip0.t-ipconnect.de)
[02:25:05] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[02:25:11] <tikue> strcat: good question...
[02:25:25] <tautologico> ocaml has a specific array type for using unboxed floats
[02:25:28] <Yurume> tikue, I always thought that the CPU architecture should support an integer NaN (its representation would be 0x80000000 for i32, for example) ;)
[02:25:45] <tautologico> for performance reasons. otherwise, floats are always boxed
[02:26:18] <strcat> Yurume: please no ;p
[02:26:34] <tikue> oh i see. thanks tautologico !
[02:26:34] <o11c> yurume: iteresting ... the C and C++ standards permit that ...
[02:26:41] *** Quits: pnathan1 (Adium@moz-5EBBDD83.tukw.qwest.net) (Ping timeout)
[02:26:45] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[02:27:17] <Yurume> strcat, hehe, I know it is impossible in practice (and I indeed know that NaN *is* a terrible idea)
[02:27:22] <strcat> the C standard pretty much permits anything, floats can be 128-bit decimal floats
[02:27:46] *** Quits: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP) (Quit: tautologico)
[02:27:48] <strcat> I think the only restriction on double is that it be at least as large
[02:27:57] <Yurume> but it would be an interesting move if the standard operation is *prohibited* from emitting such iNaN (without such a special treatment in "operands", only in results)
[02:28:00] *** Joins: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP)
[02:28:03] <strcat> FLT_RADIX is a thing ;p
[02:28:09] *** Joins: pnathan (Adium@moz-5EBBDD83.tukw.qwest.net)
[02:28:15] <o11c> hm, what is the weak pointer class in the rust library?
[02:28:39] <strcat> o11c: there isn't a reference counted pointer in the stdlib with weak ptr support
[02:28:52] <o11c> grumble
[02:28:54] <acrichto> wycats_: it appears that I have lied to you about the new '-Z gen-crate-map' flag, it'll still work if you define the crate map locally in C (like in the gist I showed last night), but I was bad and didn't test this case and it's sadly not working
[02:29:10] <teratorn> are tasks suited to one-per-connection for e.g. highly-concurrent async servers? or will it still be common to have event loops in a single task for that?
[02:29:14] <paupau> I'm actually interested in adding weak pointer support
[02:29:21] <paupau> what would be the best way to develop that?
[02:29:33] <wycats_> acrichto: say more
[02:29:37] <strcat> I have a reference counted ptr implementation with weak ptr support
[02:29:42] <paupau> easier to work inside a git clone of rust, or extract rc.rs and work on it independently?
[02:29:45] <strcat> it adds a word to the allocation size so...
[02:29:47] <o11c> paupau: it's not terrible *difficult* ... you just need to add an extra field to the shared object
[02:29:54] *** Quits: pnathan (Adium@moz-5EBBDD83.tukw.qwest.net) (Ping timeout)
[02:30:20] *** Joins: sankha93 (Instantbir@CAF6D3FF.9C875DCD.9105FBCF.IP)
[02:30:20] <acrichto> wycats_: a little technical, but the crate map generated has a slot for the "io factory" and that was always null if you're building a library and I forgot to update that code path, so when you specify -Z gen-crate-map a crate map is indeed generated, but the "io generator" is null so you still see the same problem of no local I/O
[02:30:21] <paupau> o11c: indeed, I meant the logistics of actually going and doing the work
[02:30:25] <paupau> strcat: oh nice!
[02:30:28] *** Joins: pnathan (Adium@moz-5EBBDD83.tukw.qwest.net)
[02:30:36] <acrichto> wycats_: what it does mean on the other hand, however, is that debugging macros are enabled! (not that it's too useful)
[02:30:51] <strcat> I don't really think it belongs in libstd
[02:30:53] <wycats_> acrichto: but you'll fix it right? ;)
[02:30:57] <o11c> I think just one additional word of overhead is fair to put in the implementation ...
[02:31:05] *** Quits: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP) (Quit: tautologico)
[02:31:08] <acrichto> wycats_: already have a fix, although I want to figure out a way to test this for real this time
[02:31:09] <erickt> good evening all. We don't have any way of inferring the return type, right?
[02:31:12] <o11c> strcat: why not? weak pointers are *useful*
[02:31:22] <acrichto> wycats_: also, we also intend on local I/O to be thread-blocking if libuv isn't found
[02:31:27] <tikue> erickt: not of functions
[02:31:33] <tikue> erickt: but it can of closures
[02:31:42] <acrichto> wycats_: so if we can't find libuv, you'll depend on libc and it'll fall back to normal thread-blocking things just using read/write syscalls and whatnot
[02:31:42] *** Joins: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP)
[02:31:45] *** Quits: sankha93 (Instantbir@CAF6D3FF.9C875DCD.9105FBCF.IP) (Quit: Gone to save the world!)
[02:31:55] <erickt> tikue: that's sad in light of complicated iterator types
[02:31:56] *** jorendorff_away is now known as jorendorff
[02:31:58] <wycats_> acrichto: but of course I want to use libuv right?
[02:32:01] <strcat> o11c: for what though?
[02:32:06] <acrichto> wycats_: in theory *all* I/O would work seamlessly as either blocking or non-blocking
[02:32:15] <strcat> Rc is immutable so it already can't have cycles without much of a restriction
[02:32:19] <acrichto> wycats_: well maybe, if you're not using green tasks then there's not really a reason for async I/O
[02:32:21] <SiegeLord> Do closures infer the return type from the inside of the closure, or from where it is used?
[02:32:22] *** Quits: dherman (dherman@BE970EA.DAF04A8D.8C90971.IP) (Quit: dherman)
[02:32:33] <acrichto> wycats_: the main reason we use libuv is to multiplex many rust tasks onto many OS threads
[02:32:51] <strcat> I guess if you added copy-on-write to Rc
[02:32:58] <o11c> strcat: I hit all sorts of use cases, but the one I'm thinking of right now is:
[02:33:12] <wycats_> I may want to use tasks
[02:33:32] <SiegeLord> Looks like it's where it is used, which is good
[02:33:34] <wycats_> Of course "getting it working" is my priority atm
[02:33:36] <acrichto> wycats_: ah, then you'll probably want libuv, but you also have the option of spawning tasks per OS-thread in which blocking I/O is fine
[02:33:51] <acrichto> wycats_: my example from last night still works just fine, I was just hoping to make it a little nicer for you
[02:33:59] <acrichto> and everyone else ofc :D
[02:34:21] <o11c> strcat: There exists a shared, mutable object called Foo. An event is registered to be delivered to Foo at some later date. But Foo dies before then, so the event needs to do something else.
[02:34:24] <wycats_> acrichto: I will wait for the word
[02:35:10] <o11c> where "event" means a function taking a weak pointer to Foo - it *does* need to do *something* for the "expired" case
[02:35:51] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[02:36:06] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[02:37:29] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[02:37:44] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[02:37:48] <teratorn> o11c: I usually really hate weak event binding :-(
[02:38:20] <paupau> weak pointers are super useful for UI code
[02:38:22] <paupau> gonna need 'em
[02:39:08] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[02:39:44] *** Quits: zatnosk (zatnosk@31AE4F7A.F285E7E8.9E52235C.IP) (Quit: Computer has gone to sleep)
[02:39:47] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:40:43] <strcat> C++ has a unified std::shared_ptr with atomic reference counting + weak pointers and it's unbearably slow for the common case ;s
[02:41:19] <o11c> teratorn: well, in the real case I'm thinking, Foo is a player that is vulnerable to the client closing the TCP connection ... so you have to think about it
[02:41:40] <o11c> part of Rust is having to deal with things you hate
[02:42:01] <strcat> http://gcc.gnu.org/onlinedocs/libstdc++/manual/shared_ptr.html
[02:42:18] <teratorn> o11c: i'm sure that's true, and im sure weak pointer are useful generally
[02:42:59] <o11c> unless, of course, your code is full of fail!
[02:43:50] *** Quits: nkoep (nik@moz-F367B720.pool.mediaways.net) (Client exited)
[02:43:57] <o11c> I have to say, I *really* like the set of choices Rust offers (and does not offer) for error conditions
[02:44:07] <o11c> afk food
[02:44:28] <teratorn> if you could implement a weak pointer as an  enum Maybe<T> ? 
[02:44:43] <teratorn> is that crack smoking?
[02:45:18] <teratorn> &T I mean, I guess
[02:46:23] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[02:47:07] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[02:47:46] <strcat> yeah.... shared_ptr in boost uses 3 allocations + locking/atomics
[02:48:03] <strcat> hrm
[02:48:09] <tjc> teratorn: It depends on how the Maybe (or Option as we call it in Rust) type is represented at runtime...
[02:48:13] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[02:48:24] <tjc> I know we do some optimizations where Option<T> is one word if T is pointer-size, but I'm not sure if we guarantee that as part of the semantics or not
[02:48:55] <strcat> tjc: we do guarantee it for extern fn, at least
[02:49:52] <pcwalton> strcat: 3 allocations?!
[02:49:54] <pcwalton> geez
[02:50:06] <teratorn> tjc: hmmm, interesting. so, whats the proposed interface/syntax for weak pointers? it just struck me that is basically a dynamic Option<&T>
[02:50:13] <pcwalton> no wonder Servo is faster than WebKit despite being hideously inefficient in my view :D
[02:50:20] <tjc> teratorn: I don't know if there is a proposed interface yet or not
[02:50:22] <strcat> pcwalton: the allocation you'd expect, the counter (for weak ptrs, to avoid holding onto the memory for the type - I guess) and the deleter
[02:50:31] <teratorn> tjc: ah, ok
[02:50:33] <strcat> apparently make_shared can elide allocating a deleter
[02:50:46] <pcwalton> I redid the box builder in WebKit and there are too many allocations
[02:50:48] <pcwalton> err
[02:50:49] <pcwalton> in Servo
[02:50:53] <pcwalton> but we're *still* faster than WebKit
[02:51:09] <pcwalton> C++ is just slow :)
[02:51:12] <pcwalton> if you use the STL
[02:51:27] <o11c> the STL tries to do everything
[02:51:28] *** Quits: tikue (tikue_star@275DC78D.2ACBBF24.689607DE.IP) (Ping timeout)
[02:51:44] <o11c> I ended up implementing my own string classes, just so I could optimize them for different purposes
[02:51:53] <pcwalton> yeah, WebKit does that too, the WTF
[02:51:58] <o11c> guess how many string classes I ended up with?
[02:52:01] <pcwalton> although Blink wants to removing it in favor of STL
[02:52:10] <pcwalton> which I think will hurt perf but oh well
[02:52:11] <teratorn> you are not c++ programmer, until you have implemented string class
[02:52:27] <strcat> strings should just be a wrapper around vectors enforcing some text encoding ;p
[02:52:35] *** Quits: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP) (Quit: tautologico)
[02:53:11] <teratorn> so am I right in assuming that task-per-connection will be the "normal" model for network IO in rust?
[02:53:13] <jeaye> strcat: hah
[02:53:38] <jeaye> teratorn: From what I've seen, that's one of the first things new C++ devs do.
[02:53:45] <strcat> type Str = String<Vec<u8>>; type SmallStr<N> = String<SmallVec<u8, N>>; and so on
[02:53:45] <jeaye> In uni, anyway.
[02:54:04] <teratorn> jeaye: but they probably did thread-per-connection so that isn't saying much... :/
[02:54:13] <o11c> teratorn: I would expect each connection to spawn many tasks that end
[02:54:26] *** Joins: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP)
[02:54:26] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[02:54:30] <teratorn> o11c: hmmm
[02:54:33] <jeaye> teratorn: "...until you have implemented string class"
[02:54:45] <teratorn> jeaye: ah, ha ha
[02:55:03] <o11c> jeaye: its's distressing ... only now, in my senior year, did we finally have to implement a data structure that's *not* in the standard library
[02:55:20] <o11c> we did Scapegoat Trees for algorithms
[02:55:31] <jeaye> o11c: I think that's useful.
[02:55:43] <jeaye> People should know how std::string, vector, map, list, etc work.
[02:55:49] <jeaye> So that they use them properly.
[02:55:57] <o11c> but they don't
[02:56:04] * jeaye knows people that use std::list for everything. Similarly with std::vector.
[02:56:22] <strcat> std::vector for everything works pretty well ;p
[02:56:22] <pcmattman> a) standard library doesn't always exist, b) knowing how things work 'under the hood' helps you make better decisions because you know the runtimes and such for each
[02:56:25] <o11c> everyone in my classes knows how to implement a hashtable and a tree (not templated, of course)
[02:56:26] *** Quits: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP) (Quit: tautologico)
[02:56:35] *** Joins: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP)
[02:56:36] <o11c> but no one knows when to use them
[02:56:42] <strcat> the only issue with std::vector is a fundamental C++ one
[02:56:52] <strcat> that C++ types can depend on their address
[02:56:58] <strcat> so it can't use realloc
[02:57:28] <strcat> (and even then, it can only avoid copying each element thanks to C++11 adding move ctors + noexcept)
[02:57:29] <pcmattman> strcat: ehh, vector for everything doesn't work well with large sets (for insertion/removal, especially)
[02:57:39] <strcat> pcmattman: it does if you have all the data in advance ;p
[02:57:48] <jeaye> Not if you're searching by key
[02:58:01] <strcat> searching by key in a vector is fast if you don't do removals/inserts on the go
[02:58:10] <strcat> build massive vector -> sort -> binary searches millions of times
[02:58:21] <strcat> far faster than a tree for a mostly read-only container
[02:58:27] <o11c> strcat: hm, I didn't think about that in the "parent pointer" discussion earlier ... I assume that ~Parent is guaranteed not to move though
[02:58:47] <jeaye> strcat: We use this for our json maps, instead of an rb tree.
[02:58:51] <jeaye> It works pretty well.
[02:59:16] <strcat> although, a b-tree is a big step above an rbtree
[02:59:30] <strcat> the only reason C++ stdlib implementations use an rbtree is for the iterator invalidation guarantees
[02:59:38] <strcat> insertion isn't allowed to invalidate any iterators
[02:59:41] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[02:59:41] <o11c> I really need to implment a C++-correct b-tree sometime ...
[02:59:53] <strcat> removal is only allowed to invalidate an iterator pointing at the removed element
[02:59:56] <strcat> so...
[03:00:06] <strcat> they're forced to do an rbtree basically...
[03:00:09] <mimcpher> eugh, iterator invalidation ruining everything
[03:00:19] <strcat> o11c: http://code.google.com/p/cpp-btree/
[03:00:41] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[03:00:41] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:00:58] <o11c> strcat: I know I complained about being required to implement stuff in class, but *I* do actually gain something from implementing data structures myself
[03:01:03] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[03:01:10] <strcat> o11c: your own bugs? :)
[03:01:15] <jeaye> heh
[03:01:19] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[03:01:19] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:01:22] * strcat likes being able to blame someone else for bugs
[03:01:41] <paupau> strcat: is your weak pointer impl freely available? I would love to try it out
[03:01:43] *** Joins: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP)
[03:02:02] <o11c> funny story ... on the codebase I've been maintaining, there is one particular developer whose code I've come to hate.
[03:02:08] <strcat> your own? :)
[03:02:16] <tjc> haha
[03:02:18] <o11c> no, someone from ages past
[03:02:25] <strcat> you from 6 months ago!
[03:02:32] <jeaye> hah
[03:02:52] *** Joins: jeffdb (jeff@moz-9D2E3B02.hsd1.wa.comcast.net)
[03:02:55] <SiegeLord> Heh, happens all the time to me
[03:02:59] <o11c> just the other day, someone came into the channel and said "hey, Fate is logged in to the game", so I thought I *had* to meet her
[03:03:30] <o11c> I said "I have to maintain your code" and she apologized and offered to write my a letter of recommendation for grad school or employment
[03:04:56] *** Joins: tikue (tikue_star@275DC78D.2ACBBF24.689607DE.IP)
[03:05:20] <tjc> haha
[03:06:14] *** Quits: jeffdb (jeff@moz-9D2E3B02.hsd1.wa.comcast.net) (Quit: jeffdb)
[03:09:28] *** Quits: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP) (Client exited)
[03:09:56] <strcat> nmatsakis: would parallel execution of &fn:Send+Freeze be safe? seems so. just thinking about a stop gap until there's something more precise
[03:10:13] <strcat> well
[03:10:18] <strcat> that's a silly question ;p
[03:10:23] <strcat> if it's Send it's already safe
[03:11:02] <strcat> maybe...
[03:11:31] * strcat has a hard time reasoning about closure captures
[03:12:47] *** Joins: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP)
[03:13:00] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[03:15:42] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[03:16:30] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[03:17:37] *** Quits: geoffhill (geoffhill@moz-738DC0DB.org) (Quit: )
[03:20:00] <abnrngr> hi all, just started with Rust and have a question
[03:20:23] *** Joins: dherman (dherman@BE970EA.DAF04A8D.8C90971.IP)
[03:20:23] *** ChanServ sets mode: +ao dherman dherman
[03:20:31] <tikue> hi abnrngr 
[03:20:33] <abnrngr> how do you read a string from the console, e.g. Python's raw_input?
[03:20:58] <tikue> abnrngr: best way is probably to wrap stdin reader in a buffered reader 
[03:21:06] <tikue> BufferedReader::new(stdin())
[03:21:07] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[03:21:30] <tikue> and then you can use stdin.read_line()
[03:21:45] <abnrngr> I'll give that a shot, much appreciated
[03:23:27] <tikue> abnrngr: you'll find stdin in std::rt::io::stdio::stdin
[03:23:46] *** Quits: dherman (dherman@BE970EA.DAF04A8D.8C90971.IP) (Quit: dherman)
[03:24:29] <abnrngr> it's reexported by io, so io::stdin() should work, right?
[03:24:37] <tikue> ah cool! yes
[03:24:49] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[03:26:08] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[03:26:18] *** Quits: brson (brson@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[03:26:32] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[03:26:59] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[03:28:57] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[03:29:39] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[03:32:31] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[03:36:22] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[03:37:00] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[03:37:06] *** Quits: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP) (Ping timeout)
[03:38:15] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[03:39:54] *** Joins: Jesin (Jessin_@moz-C1EBF9B4.dept.lehigh.edu)
[03:40:46] *** Joins: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP)
[03:42:23] *** Quits: zz_kimundi (kimundi@moz-7464178B.dip0.t-ipconnect.de) (Ping timeout)
[03:43:19] *** Quits: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP) (Ping timeout)
[03:45:06] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[03:45:20] *** Quits: tautologico (iorek@703660AA.CFE755C8.C27E1635.IP) (Quit: tautologico)
[03:45:52] *** Joins: zz_kimundi (kimundi@moz-93826068.dip0.t-ipconnect.de)
[03:46:16] *** zz_kimundi is now known as kimundi
[03:49:03] *** Joins: jakedust (Jake@moz-9CC82466.dsl.telesp.net.br)
[03:49:08] *** Quits: jakedust (Jake@moz-9CC82466.dsl.telesp.net.br) (Quit: jakedust)
[03:49:19] *** Joins: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP)
[03:50:48] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[03:55:11] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[03:55:50] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[03:56:20] * ski . o O ( "Please simplify the syntax for Great Justice" by Greg in 2013-11-11 at <https://mail.mozilla.org/pipermail/rust-dev/2013-November/006466.html> )
[03:57:34] <o11c> my wish was for a language without curly braces, since curly braces always lead to holy wars
[03:58:02] *** Joins: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP)
[03:58:08] <tikue> it's either curly braces or `end` and they're essentially the same
[03:58:22] <o11c> I mean indentation, like python
[03:58:25] <tikue> idk how you can do closures with just indentation
[03:58:37] <o11c> python is the only language I know where everyone agrees how to format their code
[03:58:40] <tikue> python hasnt' figured it out yet either
[03:59:03] <o11c> in python, you just do a named def first if the body is more than one expression
[03:59:22] <tikue> right
[03:59:27] <benh> In go they have a program that agrees for you
[03:59:49] <dcrewi> just add more indention for closures?
[03:59:52] <o11c> I think it would be tolerable if 'do' took an indented block, since non-do closures are rare enough that you can afford to name them
[04:00:16] <o11c> dcrewi: the hard case is func(closure1, closure2)
[04:00:42] <o11c> (not familiar enough with rust yet to write actual closures there)
[04:00:57] <tikue> i think the trouble with closures, coupled with a preference to keep c++ style syntax, are reason enough to toe the line on this issue
[04:01:12] <o11c> yeah
[04:01:19] <tikue> though i'd love to see an indentation-matters rust :) 
[04:01:22] <o11c> Rust has done enough without getting rid of curly braces
[04:01:22] <dcrewi> o11c: I was assuming you'd need some special start-of-closure like \ which defines the base indention for the closure
[04:01:37] <dcrewi> yes
[04:01:44] <o11c> I would like to see a language with a fully decoupled parser
[04:01:54] <dcrewi> what do you mean
[04:01:55] <o11c> so that you can choose your own syntax, and get the same semantics
[04:02:12] <rntz> ... all languages have that, if you just write a preprocessor.
[04:02:22] <rntz> so I'm not sure what it is specifically you're looking for.
[04:02:55] <o11c> only Forth makes a serious attempt at doing it in the language itself
[04:02:59] *** Joins: Yurumechan (23f9939a@B2F514.E4420F21.EEF52F3A.IP)
[04:04:09] <rntz> what is meant by "in the language itself"?
[04:04:12] <dcrewi> I understand that lisp's reader macros are plenty flexible enough to implement your own syntax however you like
[04:04:40] <dcrewi> ugh, I let myself get sucked into this conversation
[04:04:57] <mark_edward> is libsyntax fully decoupled from rustc?
[04:05:22] <dbaupp> mark_edward: no, librustc depends heavily on libsyntax
[04:05:36] <mark_edward> right but what are libsyntax's dependencies
[04:05:47] <dbaupp> extra and std
[04:06:18] <mark_edward> so you could see rewrite libsyntax, provide the same exports and stuff, and link that to rustc
[04:06:43] <strcat> rewrite libsyntax every week* ;p
[04:07:10] <o11c> yeha ... this would be  post-1.0 project
[04:07:15] <mark_edward> o11c: it seems modular enough already. you could write your own libsyntax i think
[04:07:32] <strcat> o11c: 1.0 doesn't mean nothing changes anymore
[04:07:36] <dbaupp> you could drop in a new parser, probably.
[04:07:53] <strcat> o11c: it certainly doesn't mean implementation details will be any more stable
[04:09:28] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[04:10:52] *** Joins: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP)
[04:15:33] <aatch> whitespace significance doesn't end holy wars, it just shifts more focus towards tabs vs. spaces. People fight about stupid shit, taking something away just makes them fight about something else.
[04:16:21] <tikue> go does a good job solving that
[04:16:22] <o11c> aatch: python has solved that problem - everyone agrees to use 4 spaces
[04:16:50] *** Joins: sankha93 (Instantbir@CAF6D3FF.9C875DCD.9105FBCF.IP)
[04:17:00] <benh> solve it by making tabs switch the parser into the "clearly this is actually a makefile" mode
[04:17:04] <benh> imo
[04:17:12] * bjz wishes languages went for syntax independence
[04:17:36] <bstrie> solve it by making tabs an alternate character for initiating line comments
[04:17:45] <bjz> ie. the syntax is a user interface feature provided by the editor
[04:17:47] <benh> I don't in general trust language designers to be good graphical-code-editor-app designers, though :)
[04:17:59] <mimcpher> bstrie: oh god, that would lead to hilarious bugs
[04:17:59] <bstrie> bjz: rust isn't the language to solve the problem of syntax!
[04:18:12] <o11c> hm (reading about go), is there a rust-format ?
[04:18:21] <bjz> bstrie: no, unfortunately not. maybe in ten years
[04:18:23] <bstrie> o11c: there's been one for a long time, but it's pretty rotted
[04:18:27] <bstrie> o11c: needs to be rewritten
[04:18:27] <benh> o11c: We have a pretty printer, but I think it's not correct.
[04:18:30] <o11c> mimcpher: exactly why it should be done
[04:18:56] <benh> https://github.com/mozilla/rust/issues?labels=A-pretty for a start
[04:19:26] <bstrie> in any case, for all you people out there with strong opinions on $PROGRAMMING_LANGUAGE_SUBJECT, please realize that change comes gradually and over many decades
[04:19:43] <SiegeLord> I use tabs in my python code 8)
[04:19:48] <bstrie> once rust makes systems programming languages safe, *then* we can replace rust with a language with decoupled syntax
[04:19:49] <benh> heretic
[04:19:55] <SiegeLord> And in Rust code too ;)
[04:19:59] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[04:20:01] <tikue> SiegeLord: that was you?!! >:O
[04:20:21] <aatch> Eh, wanting syntax independence in programming is like wanting alphabet independence in writing.
[04:20:25] <bjz> bstrie: it's funny that John McCarthy didn't intend lisp to be used with s-exprs
[04:20:26] <SiegeLord> Well, I'm careful to follow the guidelines of the project I'm contributing :P
[04:20:30] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[04:20:35] <mimcpher> aatch: hell yeah I want alphabet independence
[04:20:36] <bstrie> bjz: what a hack eh? :)
[04:20:40] <SiegeLord> So spaces in my rustc contributions ;)
[04:20:51] <mimcpher> aatch: Cree syllabics are totally better than the latin alphabet
[04:20:57] <Luqman> acrichto: does linked failure not kill tasks that are waiting for input (i.e from stdin) ?
[04:21:19] <aatch> mimcpher, that may be true, but I'm not going to consider what you write to be "English"
[04:21:20] *** Quits: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP) (Ping timeout)
[04:21:56] <mimcpher> aatch: :-)
[04:22:15] <mimcpher> aatch: we should decouple the noises too, and maybe the grammar
[04:22:41] <aatch> mimcpher, ok, you can go and garble and write gibberish in the corner if you want.
[04:23:01] <acrichto> Luqman: sadly no, linked failure does horrible things with I/O so it's all unkillable right now
[04:23:04] <aatch> Anyway, different topic.
[04:23:23] <acrichto> Luqman: everything about linked failure and I/O can be fixed, but linked failure right now isn't solid enough to test agaist (it itself has freqeunt segfaults/races)
[04:23:32] <aatch> Note to self, when disabling copying in C++, remember to get your method signatures correct -.-
[04:23:55] <o11c> aatch: Υοθ μεαν λικε τηισ?
[04:24:21] <Luqman> acrichto: ah. i currently have a process who's main task will die but the whole process won't since one task is stuck waiting for stdin :P
[04:24:45] <acrichto> Luqman: yeah it's kinda unfortunate, brson wants to redesign linked failure from the ground up entirely
[04:24:58] <acrichto> Luqman: in doing so, I will be more than willing to make all uv calls interruptable
[04:25:24] *** Joins: dherman (dherman@moz-44834EBD.kaist.ac.kr)
[04:25:24] *** ChanServ sets mode: +ao dherman dherman
[04:25:44] <Luqman> acrichto: cool
[04:25:57] <dbaupp> aatch: by "get your method signatures correct" you mean `rm -rf *.cpp; vim foo.rs` right?
[04:26:48] <aatch> dbaupp, I wish. However, this is my HipHop postgres extension, so...
[04:27:31] *** jorendorff is now known as jorendorff_away
[04:27:45] <dbaupp> aatch: ah... looks like you've gotta rewrite HipHop. (Doing the same for postgres itself would be cool, but is obviously optional.)
[04:28:25] <aatch> dbaupp, dear god that would be insane. the HPHP codebase is massive.
[04:28:26] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[04:28:41] <dbaupp> aatch: no time to lose!
[04:28:52] <bstrie> is HPHP the official abbreviation for HipHop
[04:28:53] <bstrie> because
[04:28:58] <bstrie> that is not really much of an abbreviation
[04:29:36] <bstrie> imo
[04:29:39] <aatch> bstrie, technically, HPHP is an abbreviation of HipHop PHP
[04:29:41] <sam113101> no it's (h(i|o)p){2>
[04:29:53] <bstrie> sam113101: that was going to be my proposed middle ground
[04:29:57] <sam113101> (h(i|o)p){2}*
[04:30:06] *** jorendorff_away is now known as jorendorff
[04:30:11] *** Joins: axitkhurana (Adium@63F3AA56.9CFBD76D.30E7AE68.IP)
[04:30:24] <sfackler> acrichto: would interruptable IO include things like read with a timeout?
[04:30:26] <aatch> There's also hhvm, which is HipHop Virtual Machine.
[04:30:39] <bstrie> I didn't realize there was anything besides the VM
[04:30:49] <acrichto> sfackler: yes, although I plan on doing that before linked failure is all sorted out
[04:31:00] <sfackler> cool
[04:31:06] <aatch> bstrie, HipHop started life as a compiler, PHP->C++
[04:31:25] <sam113101> aatch: what is it, now?
[04:31:43] <aatch> A virtual machine, like Zend PHP, but it doesn't suck.
[04:31:44] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[04:31:52] <sam113101> o_O
[04:32:04] <acrichto> sfackler: right now I'm trying to remove io_error
[04:32:12] <acrichto> emphasis on *trying*
[04:32:25] <aatch> ~5x faster than Zend, and take it from me, the code base is much nicer.
[04:33:04] <sfackler> I'll be so happy when io_error goes away
[04:33:06] *** Quits: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) (Ping timeout)
[04:33:20] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[04:33:26] <sam113101> it's still php though
[04:33:31] <bstrie> right
[04:33:38] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[04:33:39] <bstrie> making php faster is not doing the world a service
[04:33:40] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[04:33:46] <sam113101> haha
[04:34:08] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[04:34:22] * dbaupp reminds bstrie that this is #rust, not #bash-php ;)
[04:34:27] <bstrie> I use php every day!!
[04:34:35] *** Joins: brson (brson@5AB4884B.FCC4549.14D5B978.IP)
[04:34:36] *** ChanServ sets mode: +ao brson brson
[04:34:40] <cmr> All the more reason to bash it, eh?
[04:34:41] <aatch> Eh, there's sorta 2 PHPs, the PHP that everybody sees and cringes at because it was written by somebody that barely programs.
[04:34:42] <bstrie> my company pays zend THOUSANDS OF DOLLARS A YEAR for this garbage
[04:34:56] * bstrie writhes
[04:34:57] <ion> The implementation of the PHP VM not itself sucking doesn’t really make things much better. :-P
[04:35:11] <dbaupp> bstrie: "some of my best friends are php"
[04:35:13] *** Quits: themgt (themgt@moz-83F07CDA.cm.vtr.net) (Ping timeout)
[04:35:21] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[04:35:26] <aatch> bstrie, why on earth would your company do that?
[04:35:41] <bstrie> aatch: because they're a stereotypical enterprise
[04:35:55] <bstrie> too much money, not enough sense
[04:36:00] <tjc> aatch: clearly you haven't heard much about bstrie's job :-D
[04:36:09] <aatch> bstrie, that sucks. I'm at a start up, hence why I can write C++ one day and PHP the next.
[04:36:15] <Luqman> acrichto: but i found a neat use for io_error :P just wrap all my net stuff in a function and trap any conditions and possibly reconnect
[04:36:19] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[04:36:19] *** ChanServ sets mode: +ao pcwalton pcwalton
[04:36:24] <bstrie> aatch: oh, right, the other reason: because it's the only thing besides java that runs on our IBM mainframes
[04:36:29] <bstrie> os/400!!!
[04:36:34] <bstrie> AIX compatibility layers!!
[04:36:37] <klutzy> bstrie: "making php faster is not doing the world a service": http://www.reddit.com/r/programming/comments/1q8vz2/php_interpreter_using_pypy_technology/
[04:36:38] <sam113101> woah
[04:36:55] <klutzy> bstrie: presentor says it's not good to open source for that reason :p
[04:36:56] <bstrie> klutzy: yes, I saw that presentation
[04:36:57] <dbaupp> <3 pypy
[04:37:01] <mimcpher> bstrie: wait, PHP runs on OS/400?!
[04:37:13] *** Quits: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP) (Quit: Leaving.)
[04:37:17] <bstrie> mimcpher: it does on the aix compatibility layer over the iSeries OS
[04:37:43] <aatch> PHP also gets more pleasant when you can type-hint everything.
[04:37:49] <bstrie> for which we also pay ibm THOUSANDS OF DOLLARS A YEAR for the privelige of using
[04:38:11] <cmr> Only thousands?
[04:38:14] <cmr> Shockingly low
[04:38:19] <bstrie> cmr: you're right, I don't know the exact numbers
[04:38:38] <mimcpher> At least it's not Solaris
[04:39:04] <cmr> bstrie: you should use cmoss. it boots!
[04:39:06] * mimcpher enjoyed an excellent "We don't have to support Solaris anymore" party in 2010
[04:39:42] <aatch> mimcpher, I'm a web dev, so I get to rage at old versions of IE
[04:39:51] *** Quits: brson (brson@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[04:40:40] <bstrie> cmr: mainframes don't boot, they "IPL"
[04:40:49] <bstrie> this is an arduous process that requires our sysadmin to stay late
[04:40:59] <o11c> hm, it looks like Rust does not handle errors in close()
[04:41:10] <o11c> that can lead to data loss, it should fail!
[04:42:08] <sp3d> bstrie: mainframes have their own name for *everything* :D
[04:42:22] *** Quits: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP) (Ping timeout)
[04:42:35] <dbaupp> o11c: which .close()?
[04:42:41] <o11c> libc close
[04:42:52] <o11c> in io::FdRes drop
[04:43:11] <o11c> haven't looked if there are any other calls to libc close
[04:43:16] <benh> That's kinda awkward because I assume close() gets called a bunch during unwinding, so fail!()ing again would be fatal
[04:43:35] <benh> potentially leading to more data loss as subsequent close() calls get skipped?
[04:43:48] <o11c> ugh, Rust didn't solve that C++ proble? I hought it was obvious ...
[04:44:01] <benh> My understanding might be lacking
[04:44:19] <o11c> in C++, exceptions during stack-unwinding have to be fatal because excetpions can be caught
[04:44:33] <benh> afaik if you fail during unwinding, unwinding doesn't run destructors in user code anymore and unwinding just frees ~-memory or something.
[04:44:45] <o11c> but rust doesn't have that problem, it always killls the whole task
[04:44:57] <o11c> I would hope it would call the *rest* of the destructors still
[04:45:15] <benh> I believe it currently aborts and the intention is to unwind without calling more destructors :(
[04:45:22] <benh> maybe someone can correct me here
[04:45:29] <o11c> that said - even abort() would be better than ignoring a failed close()
[04:45:37] <benh> acrichto: ^?
[04:46:04] <cmr> o11c: how do you continue unwinding when a destructor fails? the resource hasn't been freed. Nothing to do *except* abort.
[04:46:06] <dbaupp> https://github.com/mozilla/rust/issues/910 is the issue, fwiw.
[04:46:41] *** Quits: Jesin (Jessin_@moz-C1EBF9B4.dept.lehigh.edu) (Ping timeout)
[04:46:43] *** jorendorff is now known as jorendorff_away
[04:47:08] <o11c> cmr: for the simple case, the resources are completely independent, so you just ignore it
[04:47:12] *** Joins: brson (brson@5AB4884B.FCC4549.14D5B978.IP)
[04:47:12] *** ChanServ sets mode: +ao brson brson
[04:47:15] <cmr> o11c: that's not robust
[04:47:29] <o11c> for the complicated case, one of the resources is inside the other
[04:47:38] <o11c> cmr: you're still fail!ing ...
[04:47:48] <acrichto> benh: unwinding runs all destructors on the stack, is that what you're asking?
[04:48:01] <o11c> and maybe you could do some condition first
[04:48:09] <benh> acrichto: I was asking what happens if one of the destructors fails, do subsequent destructors run?
[04:48:27] <acrichto> benh: it depends, we don't support nested failure right now, so a failure in a failure will abort
[04:48:42] <acrichto> benh: on the other hand, if a destructor just fail!()s for the first time, then it's like any old other failure, all other destructors are run
[04:49:12] <benh> I meant a destructor failing during unwinding
[04:49:34] <benh> Is the design to allow for failure during unwinding not aborting, eventually?
[04:49:44] <acrichto> it's not entirely clear
[04:49:53] <acrichto> right now the best candidate is "kill the task but leak everything"
[04:49:59] <acrichto> I haven't thought too closely about it though
[04:50:11] <acrichto> I think there are safety implications of unwinding twice, but I'm not sure
[04:50:23] <Amanieu> the standard practice in C++ is that destructors should not throw and if you care about data loss then you should close the file explicitly and check for errors
[04:50:37] <o11c> Amanieu: missing the point
[04:50:44] <o11c> if fail! happens, you don't get a chance
[04:52:27] <Amanieu> well the problem with continuing to run destructors after one has failed is that later destructors assume previous ones succeeded
[04:53:37] <Amanieu> struct T { ~T2 } => If the T2 destructor fails, then you have a memory leak since T assumes T2 has been destroyed
[04:54:16] <o11c> hm? no, a failed destructor would still free *memory*
[04:55:03] <acrichto> in general I don't believe that destructors unwind, but this was a problem in I/O code b/c blocking a task can inject a linked failure 
[04:55:15] <o11c> like T.drop() { try { T2.drop() } catch (...) {} finally { free(T2); } }
[04:55:29] *** Joins: Khmar (user@8D107082.DB3E3FE1.657EB0E6.IP)
[04:56:08] <o11c> incidentally, there is a very useful C++ pattern that involves throwing from a destructor (it's in a case where you can guarantee you aren't already unwinding)
[04:56:49] <benh> Is that some "must handle this cleanup manually" enforcement?
[04:57:04] *** Quits: ricepuddin (graham@moz-7D68765A.cable.virginm.net) (Ping timeout)
[04:57:18] <dbaupp> what does, e.g., D do when throwing from a dtor?
[04:58:14] <o11c> the pattern is to return an object from a function that can fail, and never store it in a variable, but you *can* call functions on it
[04:58:56] <o11c> FailGuard this_may_fail(); void something() { this_may_fail(); /*may throw*/ this_may_fail().handle(); /*never throws*/ }
[04:59:08] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[04:59:50] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[05:00:54] *** Quits: dherman (dherman@moz-44834EBD.kaist.ac.kr) (Quit: dherman)
[05:03:01] *** Quits: sankha93 (Instantbir@CAF6D3FF.9C875DCD.9105FBCF.IP) (Quit: Gone to save the world!)
[05:06:51] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[05:08:58] *** Quits: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP) (Ping timeout)
[05:09:00] *** Joins: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP)
[05:12:08] <tjc> cmr: Does the path rewrite address what you wanted in https://github.com/mozilla/rust/issues/7201?
[05:13:01] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[05:13:35] *** Joins: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP)
[05:14:55] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[05:16:16] *** Quits: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP) (Ping timeout)
[05:16:47] *** Joins: Heather (Heather@19663F6.F53BAACC.9C17E900.IP)
[05:16:52] <Heather> Hello
[05:17:00] <Heather> what is rustpkg?
[05:17:50] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[05:19:52] <Heather> I was checking around and found some weird files around called .travis.yml
[05:19:53] *** Quits: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) (Ping timeout)
[05:20:14] <Heather> Usually those files contains whatever personal crap ...
[05:20:21] <eddyb> Heather: those are for travis-ci
[05:20:27] <Heather> so I'm wondering how it's desired to work
[05:20:51] <eddyb> not personal and not crap, not sure what you're thinking of
[05:20:56] <SiegeLord> Is that travis thing useful?
[05:20:59] <klutzy> .travis.yml contains information for travis buildbot
[05:21:22] <klutzy> so if someone makes pull request, travis sees it and performs build test automatically
[05:21:22] <dbaupp> SiegeLord: useful as any other continuous integration bot
[05:21:42] <Heather> so it's not for me and not for other but for bot
[05:22:10] <Heather> and travis is always running on debian / ubuntu :S seems like
[05:22:12] <dbaupp> SiegeLord: (and doubly so with http://hiho.io/rust-ci/ , which is useful for keeping your code up-to-date)
[05:22:18] <eddyb> http://about.travis-ci.org/docs/user/getting-started/
[05:22:21] <klutzy> well it is at least "works for this config" certification :p
[05:23:23] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[05:23:24] *** ChanServ sets mode: +ao pcwalton pcwalton
[05:23:32] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[05:24:11] <klutzy> Heather: travis is quite common in github land. maybe you've seen "build passing" images on README. it's from travis
[05:25:00] *** Quits: tjc (tjc@moz-BBE3ABD.mv.mozilla.com) (Quit: Places to go, people to annoy)
[05:25:01] <Heather> klutzy I see :S
[05:25:46] *** Quits: dew1 (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[05:25:59] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:27:52] *** Joins: Sharp (Sharp@1710C26.8381A41.8725677B.IP)
[05:29:24] <mimcpher> rusti: fn f(i: int){[1,1,2,3,5,8,13][i]}; f(5)
[05:29:26] -rusti- <anon>:9:22: 9:40 error: mismatched types: expected `()` but found `<VI6>` (expected () but found integral variable)
[05:29:26] -rusti- <anon>:9          fn f(i: int){[1,1,2,3,5,8,13][i]}; f(5)
[05:29:26] -rusti-                                ^~~~~~~~~~~~~~~~~~
[05:29:26] -rusti- error: aborting due to previous error
[05:29:26] -rusti- application terminated with error code 101
[05:29:37] <mimcpher> rusti: fn f(i: int)->int{[1,1,2,3,5,8,13][i]}; f(5)
[05:29:39] -rusti- 8
[05:34:33] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[05:34:44] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:37:15] *** Quits: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz) (Client exited)
[05:37:31] *** Quits: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[05:37:31] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[05:38:19] *** Joins: bjz (bjz@B398BE78.F804C29E.D35A31DF.IP)
[05:39:25] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[05:40:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[05:41:17] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[05:42:36] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[05:43:39] <Heather> what means : task '<unnamed>' failed at 'Unhandled condition: nonexistent_package: (package_id::PkgId{path: std:: path::windows::Path{repr: ~"std", prefix: None, sepidx: None}, short_name: ~"std", version: NoVersio n}, ~"supplied path for package dir does not exist, and couldn't interpret it as a URL fragment")',
[05:44:24] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[05:46:56] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Ping timeout)
[05:47:10] <dbaupp> Heather: it's a rustpkg bug... I meet it too, and I don't know how to fix it.
[05:47:45] <Heather> okay I will just imagine that my rustpkg integration will work one day
[05:49:26] <SiegeLord> I think I'm going to look into implementing multi-crate packages... the way rustpkg works currently just clashes too much with how I expect things to work
[05:49:30] <dbaupp> Heather: oh! i think that bug is caused by `/tmp` being on a different filesystem to the one you are using with rustpkg, so fi you set TMPDIR to something on the same file system (e.g. `mkdir ~/.tmp; TMPDIR=~/.tmp rustpkg install whatever`) it seems to work ok... ish.
[05:49:40] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[05:50:45] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[05:51:11] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[05:51:14] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[05:51:41] <Heather> dbaupp :S
[05:51:58] <Heather> dbaupp let me try...
[05:52:06] <dbaupp> Heather: you should be used to rust having bugs by now :P
[05:52:33] <Heather> dbaupp huh?
[05:52:34] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[05:52:54] <dbaupp> Heather: rust has a lot of bugs, so it's not surprising when you meet a new one :)
[05:53:41] *** Quits: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net) (Quit: dbaupp)
[05:54:18] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[05:54:40] *** Joins: jdm (jdm@5AB4884B.FCC4549.14D5B978.IP)
[05:54:40] *** ChanServ sets mode: +o jdm
[05:55:55] *** Joins: dbaupp (Thunderbir@moz-4CA0D523.lns20.syd6.internode.on.net)
[05:56:02] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[05:56:27] <Heather> dbaupp seems like same error with TMPDIR
[05:56:49] <dbaupp> Heather: oh :( looks like you will just have to wait for rustpkg to be fixed
[05:57:05] <Heather> okay )
[05:57:17] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[05:58:14] <Heather> dbaupp how can I show build / passwd or alike on github?
[05:58:32] <dbaupp> I don't understand the question
[05:58:51] <Heather> let me check
[05:59:17] <Heather> dbaupp something alike : [![Build Status](https://travis-ci.org/bjz/cgmath-rs.png?branch=master)](https://travis-ci.org/bjz/cgmath-rs)
[05:59:20] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[05:59:46] <Heather> dbaupp I should register project there?
[06:00:43] *** Quits: erickt (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[06:01:15] *** Joins: fabiand (fabiand@moz-A34DA49D.adsl.alicedsl.de)
[06:02:08] <o11c> http://about.travis-ci.org/docs/user/getting-started/
[06:02:11] <bjz> Heather: you register your project on rust-ci, and enable travis
[06:02:16] <dbaupp> Heather: oh, if you register the project with travis, then you just replace bjz with heather (or whatever your GH username is) and cgmath-rs with your repo name
[06:03:04] <bjz> http://hiho.io/rust-ci
[06:03:04] <bjz> Heather: check my .travis.yml files for examples of how to set it up
[06:03:05] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[06:03:44] <SiegeLord> Huh... how do you open files these days?
[06:03:56] <SiegeLord> Path::new(filename).open_writer doesn't work anymore
[06:04:26] <Heather> let me check
[06:04:35] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[06:04:43] <bjz> File::open(path), I think
[06:04:46] * kmc registers how-do-you-open-files-today-in-rust.com
[06:04:51] *** Quits: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP) (Ping timeout)
[06:04:59] <Heather> let filereader = File::open(p);
[06:05:13] <Heather> then you can do let reader  = @mut f as @mut io::Reader;
[06:05:33] <kmc> 'rustpkg install' doesn't seem to detect that the suorce files are newer than the built library
[06:05:37] <kmc> so it won't rebuild
[06:05:45] <kmc> anyone have a fix for this?
[06:06:04] <kmc> or i can just add some rm -rf commands to my Makefile, wcpgw
[06:07:27] <Luqman> Heather: you don't need to cast to @mut Reader
[06:08:53] <sfackler> kmc: touch lib.rs && rustpkg install :P
[06:09:15] <kmc> sfackler: it doesn't work, that's my problem
[06:09:21] <SiegeLord> warning: missing crate link meta `package_id`...
[06:09:29] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[06:09:34] <kmc> it uses the build products already present in my workspace
[06:09:36] <SiegeLord> What exactly do I put in as the package_id?
[06:09:49] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[06:10:11] <sfackler> kmc: https://github.com/mozilla/rust/issues/9416 is the bug to track
[06:10:16] <sfackler> oh
[06:10:17] <sfackler> maybe not
[06:11:31] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[06:13:24] <Heather> wow .... travis looks cool
[06:13:32] <Heather> I can see in realtime buildprocess
[06:13:51] <Heather> wow
[06:13:56] <Heather> such charming
[06:14:14] <Heather> added here : https://github.com/Heather/Mirana
[06:14:26] *** Quits: avsej (avsej@DF1824D5.EFF97412.48F984E6.IP) (Client exited)
[06:14:28] *** Joins: amey (user@9284AA42.60650FE8.9D7331A6.IP)
[06:14:34] <Heather> kmc dbaupp bjz should I add mirana to rustpkg projects list?
[06:15:13] <amey> Hi, is there a way of getting a vector of, say, 10 zeroes without filling up the vector in a loop?
[06:15:39] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[06:16:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:16:39] <o11c> rust's makefiles are annoying .. they keep trying to rebuild *everything* when one thing fails
[06:16:53] <dbaupp> amey: if you want a ~[int], then ~[0, .. 10]
[06:17:10] <bjz> dbaupp: oh, you can do that?!
[06:17:18] <kmc> oh, I thought it would be ~vec::from_elem(10, 0)
[06:17:20] <dbaupp> amey: (or std::vec::from_elem(10, 0) if the length isn't known at compile time)
[06:17:24] <kmc> er, drop that ~
[06:17:31] <bjz> kmc: no need for the ~
[06:17:35] <bjz> hah
[06:17:41] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[06:17:43] <amey> dbaupp: awesome, thanks!
[06:18:03] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[06:18:29] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[06:18:37] <benh> rusti: let i: ~[int] = ~[0, ..10]; i
[06:18:38] -rusti- ~[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[06:18:57] <o11c> rusti: let i: ~[int] = ~[1, ..10]; i
[06:18:58] -rusti- ~[1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
[06:19:22] <SiegeLord> Hmm... how would you specify a specific package to look for via extern mod?
[06:19:54] <dbaupp> SiegeLord: `extern mod foo = "package_id";`?
[06:20:22] <SiegeLord> Oh, just that...
[06:20:31] *** Quits: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) (Ping timeout)
[06:20:31] <Heather> dbaupp what travis do if it can't find .travis.yml file?
[06:20:37] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[06:20:50] <dbaupp> Heather: don't know
[06:20:52] <o11c> Heather: this is all in the travis docs
[06:21:29] <o11c> in this case, it does something completely and utterly retarded four hysterical raisins
[06:21:32] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[06:22:15] *** Quits: whitglint (uid15486@moz-31ABA2C0.irccloud.com) (Quit: )
[06:22:25] *** Joins: whitglint (uid15486@moz-31ABA2C0.irccloud.com)
[06:22:30] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[06:22:49] <SiegeLord> Yeah... so it's a bit bizzare... I'm not sure how to use rustpkg effectively...
[06:23:15] <amey> How about a range of numbers? let i: ~[int] = ~[1..10] is what I thought might work, but turns out it doesn't
[06:23:18] <SiegeLord> It seems the best idea is to create a workspace, manually check things into src/ and use local package_id's
[06:23:39] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[06:23:57] <SiegeLord> But by using local package id's, you basically forbid yourself from doing the automatic fetching from a remote repository
[06:24:13] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[06:24:14] <amey> and the range function returns a std::iter::Range<int> 
[06:24:48] *** Quits: DasIch (dasich@moz-5EDA591.de) (Ping timeout)
[06:25:08] <dbaupp> rusti: range(0, 10).to_owned_vec()
[06:25:09] -rusti- ~[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[06:25:26] <dbaupp> amey: ^
[06:25:29] <amey> dbaupp: Is that a property of all iterators?
[06:25:34] <dbaupp> amey: yes
[06:25:38] <amey> dbaupp: Cool, thanks!
[06:25:45] <dbaupp> amey: http://static.rust-lang.org/doc/master/std/iter/trait.Iterator.html#method.to_owned_vec
[06:25:58] <dbaupp> i.e. anything that implements the Iterator trait has that method.
[06:26:08] <SiegeLord> Although I guess you could manually create this directory structure: /src/github.com/User/Repo/
[06:26:17] <SiegeLord> Kind of... clunky I think though
[06:26:22] <amey> dbaupp: Ah, ok, thanks
[06:27:30] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:27:53] *** Quits: tikue (tikue_star@275DC78D.2ACBBF24.689607DE.IP) (Ping timeout)
[06:28:51] *** Joins: joelteon (bzzt@moz-317E8D0C.io)
[06:29:12] *** Joins: [squiddy] (squiddy@moz-DB566C67.dip.tu-dresden.de)
[06:29:29] *** Quits: [squiddy] (squiddy@moz-DB566C67.dip.tu-dresden.de) (Quit: Leaving)
[06:31:40] <amey> Is there a way of typecasting integers? std::vec::from_elem<uint>(max_factor, 0) returns [int], I need [uint] and the declaration of from_elem is
[06:31:40] <amey> fn from_elem<T: Clone>(n_elts: uint, t: T) -> ~[T]
[06:31:43] *** Quits: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se) (Ping timeout)
[06:31:52] <amey> So it looks like I need to typecast the "0" to a uint?
[06:32:35] <benh> Try 0u
[06:32:52] <benh> If it wasn't a literal, you'd go with 'x as uint', I think
[06:33:35] <dbaupp> amey: inference normally means that `0` is fine (clearly it's not working for this exact case, and so the 0 is defaulting to int)
[06:33:36] <amey> rusti: std::vec::from_elem<uint>(max_factor, 0u);
[06:33:37] -rusti- pastebinned 8 lines of output: http://sprunge.us/jgEC
[06:33:54] <ktt3ja> what would an ExprPath look like?
[06:34:00] <dbaupp> rusti: (std::vec::from_elem::<uint>(10, 0u),std::vec::from_elem(10, 0u))
[06:34:01] -rusti- (~[0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u], ~[0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u])
[06:34:09] <amey> rusti: let i: ~[uint] = std::vec::from_elem<uint>(max_factor, 0u);i
[06:34:10] -rusti- pastebinned 8 lines of output: http://sprunge.us/HBHj
[06:34:13] <dbaupp> ktt3ja: `std::vec::from_elem::<uint>`
[06:34:19] <amey> ok, that works
[06:34:35] <dbaupp> rusti: let i: ~[uint] = std::vec::from_elem(max_factor, 0); i
[06:34:36] -rusti- <anon>:9:46: 9:56 error: unresolved name `max_factor`.
[06:34:36] -rusti- <anon>:9          let i: ~[uint] = std::vec::from_elem(max_factor, 0); i
[06:34:36] -rusti-                                                        ^~~~~~~~~~
[06:34:36] -rusti- error: aborting due to previous error
[06:34:36] -rusti- application terminated with error code 101
[06:34:44] <dbaupp> rusti: let i: ~[uint] = std::vec::from_elem(10, 0); i
[06:34:45] -rusti- <anon>:9:26: 9:53 error: mismatched types: expected `~[uint]` but found `~[int]` (expected u but found )
[06:34:45] -rusti- <anon>:9          let i: ~[uint] = std::vec::from_elem(10, 0); i
[06:34:45] -rusti-                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~
[06:34:45] -rusti- error: aborting due to previous error
[06:34:45] -rusti- application terminated with error code 101
[06:34:52] <dbaupp> hm, that's weird :/
[06:35:24] <dbaupp> inference really should be working there, but it clearly doesn't.
[06:35:38] *** Quits: revls (uid14245@moz-5F4AA75A.irccloud.com) (Quit: Connection closed for inactivity)
[06:35:47] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[06:35:47] <amey> ouch
[06:35:47] <amey> perhaps you should file a bug? Is it definitely supposed to work here?
[06:36:01] <dbaupp> amey: note that giving a type-hint for a generic requires an extra `::` to avoid C++'s ambiguity between comparison operators and type hints
[06:36:06] <dbaupp> yeah, I'll file one
[06:36:29] <amey> std::vec::from_elem::<uint>(10, 0);
[06:36:38] <amey> oops, sorry
[06:36:40] <amey> rusti: std::vec::from_elem::<uint>(10, 0);
[06:36:41] -rusti- ()
[06:36:56] <amey> dbaupp: thanks
[06:37:04] <amey> dbaupp: Also, the ::<uint> doesn't seem to be working
[06:37:23] <amey> rusti: std::vec::from_elem(10, 0u);
[06:37:24] -rusti- ()
[06:37:34] <SiegeLord> Lose the ;
[06:37:41] <amey> Oh, return, right
[06:37:56] <amey> rusti: std::vec::from_elem::<uint>(10, 0)
[06:37:57] -rusti- ~[0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u, 0u]
[06:38:07] <amey> awesome
[06:38:09] <amey> SiegeLord: dbaupp: thanks
[06:38:31] <SiegeLord> Just rediscovered the extern mod std(name="std", vers="0.9-pre"); syntax
[06:38:58] <SiegeLord> Maybe it could be co-opted for the multiple crate idea...
[06:39:07] <dbaupp> amey: https://github.com/mozilla/rust/issues/10436
[06:39:18] <SiegeLord> Like... extern mod std(name="std", vers="0.9-pre", pkg="some_pkg");
[06:39:39] <amey> dbaupp: cool
[06:39:59] <dbaupp> amey: btw, the "idiomatic" version is `std::vec::from_elem(10, 0u)` i.e. giving 0 an explicit type with its type suffix, rather than giving the type hint via the ugly `::<uint>` (not that it matters particularly)
[06:40:45] * Heather added Mirana to public pustpkg list :)
[06:41:08] <amey> dbaupp: Right, I'm just taking note of the ::<uint> notation since it's notably different from the one I'm used to C++/Java. Will use 0u in practice.
[06:41:51] *** Joins: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net)
[06:42:04] <Heather> what's sqlite3 library package name in travis / ubuntu
[06:42:50] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Quit: z0w0)
[06:43:04] *** Joins: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP)
[06:43:28] <SiegeLord> libsqlite3-dev maybe
[06:43:49] <Heather> SiegeLord thank, let me try
[06:44:17] <dbaupp> amey: yup, I assumed you were :)
[06:44:37] *** Quits: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP) (Input/output error)
[06:44:41] *** Quits: abnrngr (user@C31B7093.A9FCDC29.B3C843D.IP) (Ping timeout)
[06:44:58] <dbaupp> amey: fwiw, the inference seems to work sometimes (see the issue, edited a new example into it)
[06:45:23] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[06:45:27] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Client exited)
[06:45:47] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[06:46:30] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[06:47:02] *** Parts: paupau (posttext@moz-3F7DB997.hsd1.ca.comcast.net) ()
[06:47:27] <Luqman> shouldn't it be possible to do something like: let x = Foo { ... }; let y = Foo { a: f(x.a), ..x };
[06:47:54] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[06:50:05] <SiegeLord> It is, afaik
[06:50:42] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[06:52:13] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[06:52:39] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[06:54:17] *** Joins: tikue (tikue_star@275DC78D.2ACBBF24.689607DE.IP)
[06:55:18] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[06:55:34] <amey> dbaupp: Oh, could the Clone be what's causing the discrepancy?
[06:55:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[06:56:30] <dbaupp> amey: maybe
[06:57:34] <dbaupp> amey: looks like it... removing the Clone bound from doesnt (and making the body just `~[x]`) makes it work ok
[06:58:56] *** Quits: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[06:59:02] <amey> dbaupp: up
[06:59:07] <amey> dbaupp: *ok
[06:59:19] <dbaupp> amey: updated the issue
[07:01:40] <amey> dbaupp: What's the difference between <T: Clone> and <T>?
[07:01:59] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[07:02:08] *** Quits: cubic (cubic@moz-80241A3A.mc.videotron.ca) (Connection reset by peer)
[07:02:15] <mimcpher> amey: clone is a restriction on the generic parameter
[07:02:31] <mimcpher> So T has to be clonable
[07:02:31] <amey> That it must have the Clone trait?
[07:02:31] <dbaupp> yes
[07:02:31] <amey> ok
[07:02:31] <mimcpher> yes
[07:03:20] <amey> dbaupp: Ah, right, just saw that you updated the title of the bug as well
[07:03:56] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[07:04:46] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Quit: Leaving...)
[07:05:05] <dbaupp> amey: (I was incorrect btw, the term is "trait bounds" or just "bounds" rather than "type bounds".)
[07:05:33] <amey> dbaupp: (ah, ok)
[07:07:09] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[07:09:28] <amey> http://static.rust-lang.org/doc/0.8/std/vec.html doesn't appear to have documentation for the `filter` method, is it documented elsewhere?
[07:10:20] <tikue> amey: filter is an iterator extension method so it should be under std/iter
[07:10:52] <dbaupp> http://static.rust-lang.org/doc/0.8/std/iterator.html#trait-iterator
[07:11:13] * dbaupp wishes we had rustdoc_ng for 0.8 
[07:11:36] <tikue> i think the docs for vec are fairly hard to follow even in master
[07:11:43] <tikue> i couldn't find documentation on len() the other day
[07:12:05] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[07:12:05] *** ChanServ sets mode: +o pnkfelix
[07:12:15] <amey> tikue: dbaupp: thanks
[07:12:20] <tikue> amey: np
[07:12:44] <dbaupp> tikue: that's the problem of built-ins requiring traits, and traits on built-ins not being documented well
[07:13:04] <dbaupp> (i.e. the only place to see that a built-in implements a trait is on the page for the trait itself)
[07:13:43] <tikue> dbaupp: oh i didn't realize that...that'd explain it then
[07:14:09] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[07:14:20] <dbaupp> tikue: of course, the "easiest" way to find such docs is to use your favourite version of grep on std/vec.rs (`git grep 'fn len' ...` works well)
[07:14:36] <tikue> yeah :) but the docs are so pretty!
[07:15:04] <dbaupp> tikue: they also have a search... but searching for 'len' gives a pile before Container.len (the relevant one)
[07:15:28] <tikue> even then, there's no easy way to know that Container.len is what you're looking for
[07:15:44] <dbaupp> yes, I agree.
[07:16:36] <nlminhtl> What's incorrect? https://gist.github.com/Ignotus/0673fd7981fe568c0b8b
[07:16:43] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[07:17:01] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[07:17:22] <tikue> nlminhtl: T needs to implement Sub I believe
[07:17:44] <tikue> nlminhtl: try making the type parameter T: Sub
[07:17:44] <nlminhtl> tikue: but T is generic float
[07:18:01] *** Joins: jensnockert (jensnocker@moz-612361F7.wireless.lu.se)
[07:18:03] <tikue> or just T: Num
[07:18:20] <dbaupp> nlminhtl: the compiler won't know that it's a generic float until you tell it
[07:18:27] <nlminhtl> tikue: I'm calling like this one https://gist.github.com/Ignotus/99682a5614608a98c2ff
[07:18:42] <dbaupp> nlminhtl: the bounds need to be on the generics at the declaration (same as Haskell, different to C++)
[07:19:06] <dbaupp> (<T: Num> is the lowest effort solution to getting the required operations.)
[07:19:07] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Ping timeout)
[07:19:37] <tikue> nlminhtl: try changing the line to `impl<T: Num> ...`
[07:19:39] <nlminhtl> dbaupp: so I must tell explicitly that T supports some operations in my generic code, mustn't I?
[07:19:44] <tikue> nlminhtl: yes exactly
[07:19:46] <dbaupp> nlminhtl: yes, exactly
[07:19:49] <tikue> dbaupp: :P
[07:19:51] * dbaupp had more commas \o/
[07:20:10] <tikue> shouldn't it be a semicolon? ;D
[07:20:24] * dbaupp doesn't know or care :P
[07:20:47] *** Joins: notmatt (notmatt@moz-3C7AF18C.lightspeed.sntcca.sbcglobal.net)
[07:21:49] <dbaupp> nlminhtl: btw, you can write that vector code as `let a = std::vec::from_fn(10, |_| point2d::Point2d { x: rng.gen::<float>(), y: rng.gen() });` and let type inference handle the rest
[07:24:28] <tikue> nlminhtl: if you're using sqrt(T) you'll need the Algebraic trait parameter as well, so it probably needs to be <T: Num + Algebraic>
[07:25:04] <dbaupp> I think Algebraic might provide a hypot method for exactly that computation too.
[07:25:28] <dbaupp> rusti: 3.0.hypot(&4.0)
[07:25:29] -rusti- pastebinned 14 lines of output: http://sprunge.us/fSMJ
[07:25:30] <nlminhtl> tikue: yes, I have "dicovered" :)
[07:25:32] <tikue> dbaupp: yes you're right, i never knew that
[07:25:35] <dbaupp> rusti: 3.0f64.hypot(&4.0)
[07:25:36] -rusti- 5f64
[07:25:47] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Ping timeout)
[07:25:57] <tikue> hypot is weird as infix oO
[07:26:21] <dbaupp> rusti: std::num::hypot(3.0f64, 4.0)
[07:26:22] -rusti- 5f64
[07:26:26] <tikue> nice
[07:26:33] <tikue> i always forget you can call traits that way
[07:26:37] <dbaupp> you can't
[07:26:42] <dbaupp> that's a manually written wrapper
[07:26:44] <tikue> ohh
[07:26:53] <tikue> but you can call traits that way that don't take &self can't you?
[07:27:03] <dbaupp> https://github.com/mozilla/rust/blob/master/src/libstd/num/mod.rs#L179
[07:27:08] <tikue> trait::<for Foo>::bar(baz) or something
[07:27:16] <dbaupp> Trait::foo(), yes
[07:27:50] <dbaupp> currently <for SelfType> doesn't work, so it only works when there's some way to indicate the Self type to rustc (e.g. if it returns Self, or takes a parameter with Self)
[07:28:20] <tikue> yeah i ran into that the other day
[07:28:25] <tikue> i don't remember exactly what the code was...
[07:28:32] <dbaupp> https://github.com/mozilla/rust/blob/master/src/libstd/num/mod.rs#L347 is a work-around
[07:28:47] <tikue> https://gist.github.com/tikue/b9619e847c3ee65e39c4
[07:28:52] <tikue> ^ doesn't work yet
[07:28:57] <dbaupp> Called like `Primitive::bits(None::<uint>)`
[07:29:14] <tikue> ah yeah
[07:30:16] <amey> what would be the idiomatic way of filtering a sequence multiple times in a loop? I tried `let mut it = range(1, max);` and then `it = it.filter(....)` inside the loop, but it ends up as a std::iter::Range, and filter returns a std::iter::Filter
[07:30:21] *** Quits: notmatt (notmatt@moz-3C7AF18C.lightspeed.sntcca.sbcglobal.net) (Client exited)
[07:30:39] *** Quits: brson (brson@5AB4884B.FCC4549.14D5B978.IP) (Connection reset by peer)
[07:30:58] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Connection reset by peer)
[07:31:03] <tikue> amey: off the top of my head -- and I'm not sure if this is the best approach -- you could cast it to ~Iterator
[07:31:08] *** Quits: jdm (jdm@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[07:31:17] *** Joins: brson (brson@5AB4884B.FCC4549.14D5B978.IP)
[07:31:17] *** ChanServ sets mode: +ao brson brson
[07:31:40] <mimcpher> I've had this question once or twice before, and seen other people ask: http://stackoverflow.com/questions/19923351/in-rust-how-can-i-create-task-that-runs-in-its-own-os-thread
[07:31:48] <mimcpher> So I thought I'd put it on SO
[07:31:53] <amey> tikue: with a ` as ~Iterator` after the filter call?
[07:31:54] *** Quits: FreeFull (freefull@D89A5B80.2CE4D4F4.159B5998.IP) (Quit: )
[07:32:00] *** Joins: jdm (jdm@5AB4884B.FCC4549.14D5B978.IP)
[07:32:00] *** ChanServ sets mode: +o jdm
[07:32:24] <amey> tikue: because that's the only typecast I know :) (and it's not working here)
[07:32:45] *** pmoore|away is now known as pmoore
[07:33:13] <o11c> ugh, running the rust test suite leaves /tmp/ full of junk
[07:33:19] <tikue> amey: one sec
[07:33:33] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[07:34:05] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[07:35:04] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[07:36:23] <tikue> getting a weird error when i try this
[07:36:34] <tikue> rusti:  let mut it = ~range(1u, 10) as ~Iterator<uint>; it = ~it.filter(|i: uint| i % 2 == 0) as ~Iterator<uint>; for i in it { println!("{}", i); }
[07:36:34] -rusti- pastebinned 5 lines of output: http://sprunge.us/dWGW
[07:37:18] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[07:37:35] <tikue> anyone have an idea ^ ?
[07:39:23] *** Joins: azita (Azita@5AB4884B.FCC4549.14D5B978.IP)
[07:39:32] *** Joins: Jesin (Jessin_@moz-5C1F7BD2.res.lehigh.edu)
[07:41:25] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Connection reset by peer)
[07:42:34] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[07:49:26] *** Quits: jensnockert (jensnocker@moz-612361F7.wireless.lu.se) (Input/output error)
[07:50:27] <amey> tikue: Decided to go with vector's `retain` method for now :\
[07:51:32] <tikue> amey: that actually seems like a pretty good option
[07:51:52] <tikue> amey: you could always do one filter outside the loop first
[07:52:25] <amey> tikue: yeah, I just really wanted to leave the vector immutable
[07:52:46] <amey> tikue: I tried that, but Filter returns "weird" values, so I was getting errors like the following:
[07:53:07] <amey> error: mismatched types: expected `std::iter::Filter<,uint,std::iter::Range<uint>>` but found `std::iter::Filter<,ui
[07:53:07] <amey> nt,std::iter::Filter<,uint,std::iter::Range<uint>>>` (expected struct std::iter::Range but found struct std::iter::Filter)
[07:53:15] <amey> Sorry, should probably have used pastebin there
[07:53:35] <amey> http://pastebin.com/3cFeNLjP
[07:53:36] <tikue> ah actually the parameters would be different so that wouldn't work anyway
[07:54:00] <tikue> amey: the problem is that the size of the struct changes each iteration
[07:54:16] <tikue> so the only way i can think to do it is by trait object since that size is known
[07:54:20] <tikue> trait pointer rather
[07:54:51] <tikue> but for some reason that's not working either...can't quite figure out why ~Iterator would not implement filter
[07:54:57] <amey> tikue: but why is the size increasing? Is it for lazy evaluation or something?
[07:55:10] <tikue> amey: because filter() creates a new struct that contains the previous struct
[07:55:15] <amey> tikue: I don't know about trait pointers yet, so that's probably out of my league
[07:55:22] <amey> tikue: Ah, ok
[07:55:36] <tikue> it.filter() makes a Filter struct that contains `it`
[07:56:03] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[07:56:07] <tikue> and then when you call filter_object.next() it internally calls it.next() and then does the filtering. essentially the filters chain all the way down
[07:56:17] <amey> tikue: Because Filter is actually a struct with its own methods
[07:56:20] <tikue> yeah
[07:56:33] <amey> tikue: Yeah, got it now. I was expecting filter to behave in the lispy way
[07:56:34] <tikue> amey: so actually thinking about it, in place mutation is a better option anyway
[07:56:59] <amey> tikue: Yep, looks like it
[07:57:07] <tikue> amey: yeah the iterators are very similar to how python's would work
[07:57:17] <amey> tikue: Still wish there were a lispy way here too though :)
[07:57:43] <tikue> amey: rust used to have internal iterators. is that what you mean by lispy?
[07:58:01] *** Joins: HansiHE (HansiHE@moz-7DF634EA.com)
[07:58:19] <amey> tikue: Probably? What I mean is, in the lisps that I've used map and filter just return plain lists
[07:58:36] *** Joins: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP)
[07:58:36] *** ChanServ sets mode: +ao pcwalton pcwalton
[07:58:42] <tikue> ah right. well you can do it that way if you'd like
[07:58:48] <tikue> you can simply make a new vec every time
[07:59:10] <amey> tikue: Yeah, but it looks ugly. Looks like `retain` is indeed the only clean option for now.
[08:00:39] <tikue> rusti: let mut v: ~[uint] = range(1u, 10).collect(); v = v.move_iter().filter(|i| i % 2 == 0).collect(); for i in v.move_iter() { print!("{},", i) }
[08:00:40] -rusti- 2,4,6,8,()
[08:00:44] <tikue> amey: ^
[08:01:05] <tikue> you could make helper methods to "clean" it up 
[08:01:26] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[08:02:39] <amey> tikue: Ah, didn't know about `collect`. I was converting it with `.to_owned_vec().iter()`, which was really ugly
[08:02:42] <amey> tikue: Thanks!
[08:03:06] <tikue> amey: to_owned_vec() is the same thing as collect but doesn't require type inference which is useful sometimes
[08:03:13] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[08:03:33] <amey> tikue: collect seems to also be converting it to an iterator, right?
[08:03:43] <tikue> amey: collect converts to a vec
[08:03:53] <tikue> or rather it can convert to any container
[08:03:59] <tikue> in this case it's converting to ~[uint]
[08:04:39] <amey> tikue: oh, move_iter is the one that's actually converting it to the iterator. My bad
[08:04:44] <tikue> yea
[08:05:13] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[08:06:30] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[08:06:43] *** Quits: LRN (LRN@moz-50DF30B.nationalcablenetworks.ru) (Ping timeout)
[08:07:25] *** Joins: LRN (LRN@moz-50DF30B.nationalcablenetworks.ru)
[08:09:09] <tikue> amey: this might be the kind of thing you want to do
[08:09:20] <tikue> https://gist.github.com/tikue/25735e7d0ca13d7a5b9e
[08:09:42] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[08:10:17] <tikue> amey: though, a looping filter seems like it could be converted to a fold as well?
[08:11:57] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[08:12:18] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[08:12:32] <tikue> or perhaps a scan
[08:12:59] * tikue isn't sure
[08:14:01] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[08:14:02] *** Joins: sigma (sigma@moz-39E40618.range86-143.btcentralplus.com)
[08:14:06] <amey> tikue: haha, you made it beautiful by putting the hard part in a function
[08:14:15] <amey> tikue: which is what you'd suggested in the first place
[08:14:25] <amey> tikue: Yeah, this looks pretty good, thanks :)
[08:15:17] *** Quits: tikue (tikue_star@275DC78D.2ACBBF24.689607DE.IP) (Ping timeout)
[08:16:48] *** Joins: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP)
[08:18:36] *** Quits: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP) (Ping timeout)
[08:18:38] *** Quits: Sharp (Sharp@1710C26.8381A41.8725677B.IP) (Quit: Sharp)
[08:24:04] *** Quits: h0rrorvacui (h0rrorvacu@moz-5B34B08.sip.bhm.bellsouth.net) (Quit: ZQ)
[08:25:49] *** Quits: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr) (Ping timeout)
[08:29:30] *** Quits: nlminhtl (ignotus@moz-BA3DE7EF.volia.net) (Quit: Konversation terminated!)
[08:30:56] *** Joins: Ferreus (ferreus@moz-210E4EED.dip0.t-ipconnect.de)
[08:32:40] *** Joins: eddyb_ (Mibbit@moz-B97E9B0E.lbi.ro)
[08:37:32] <eddyb_> cmr: I was looking at your linalg... it should be pretty easy to make this work: let S = System::new(3); let [x, y, z] = S.vars(); S.eq(x + 2*y + z, 5); S.eq(x - z, y); S.eq(y - 3*z, 4*x); let [x_val, y_val, z_val] = S.solve().unwrap();
[08:38:02] <eddyb_> cmr: but I don't think I have to time to play with such things :(
[08:41:29] *** Joins: alonlevy (alon@moz-74377C14.bb.netvision.net.il)
[08:45:13] <dbaupp> eddyb_: that'd be neat
[08:48:03] <pcwalton> why did we back out jemalloc again?
[08:48:06] <pcwalton> I want to inline the fast path
[08:48:09] <eddyb_> System::eq(a, b) => System::push(a - b)
[08:48:50] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Quit: z0w0)
[08:48:59] <dbaupp> pcwalton: it wasn't being used properly and was making linux 7x slower
[08:49:00] *** Joins: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP)
[08:49:04] <pcwalton> hmm
[08:49:11] <pcwalton> I want to be able to inline the fast path for allocations
[08:49:16] <pcwalton> WebKit is doing it
[08:49:22] <dbaupp> pcwalton: https://github.com/mozilla/rust/pull/9933
[08:49:26] <pcwalton> and first of all we have too many allocations so I want to fix it
[08:49:36] <pcwalton> but then I think we will probably want to do what WebKit is doing
[08:49:49] *** Quits: mark_edward_ (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net) (Ping timeout)
[08:50:02] <pcwalton> I'd just like some way to be able to inline the fast path for malloc
[08:50:47] *** Joins: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP)
[08:50:57] <eddyb_> pcwalton: in other news, with my SlamAllocator in rustic, allocating something of a known size becomes a single function call (no arguments) to a function with about 4-5 instructions in the fast path, IIRC
[08:51:23] <pcwalton> eddyb_: (1) can you inline it? (2) how else does it compare to malloc? (3) can we use it in servo? ;)
[08:51:55] <pcwalton> I guess we don't have CustomSmartPoint<Trait> yet which means that it'll be annoying to use, bah
[08:52:06] <pcwalton> but I'm willing to pull out all the stops to beat WebKit so
[08:52:08] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[08:52:19] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[08:52:33] *** Quits: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP) (Ping timeout)
[08:52:38] <eddyb_> yes (although it kinda bloats the code), it's a multi-thread and multi-process safe SLAB-like allocator with a word overhead for all allocations (and a minimum size class of two words)
[08:52:43] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[08:52:49] <pcwalton> eddyb_: got a link to the code?
[08:52:51] <pcwalton> I'm very interested
[08:53:21] <eddyb_> (it would be very cheap without the atomics)
[08:53:59] *** Quits: azita (Azita@5AB4884B.FCC4549.14D5B978.IP) (Quit: azita)
[08:54:12] *** Joins: houzi (houzi@moz-4F6A1E26.getinternet.no)
[08:54:17] <eddyb_> pcwalton: to get the argumentless function call to work, I had to use a macro to "manually" specialize the size classes, that accounts for most of the mess in the code
[08:54:32] <eddyb_> https://github.com/eddyb/rustic/blob/slam/src/mem/slam.rs
[08:54:48] *** Quits: brson (brson@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[08:55:07] <pcwalton> bookmarked
[08:55:14] <pcwalton> really awesome!
[08:55:47] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[08:55:55] <eddyb_> it's not yet on rustic master because strcat won't pull my rust-core allocator changes (it's pretty hard to get right *and* working :/)
[08:56:48] <pcwalton> ah
[08:57:25] <pcwalton> back in a bit
[08:57:32] *** Quits: pcwalton (pcwalton@5AB4884B.FCC4549.14D5B978.IP) (Quit: pcwalton)
[09:00:35] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[09:00:53] <dbaupp> eddyb_: which allocator changes... I don't see a PR?
[09:01:20] *** Quits: jdm (jdm@5AB4884B.FCC4549.14D5B978.IP) (Ping timeout)
[09:03:50] *** Joins: Ms2ger (Ms2ger@moz-F84178D5.ugent.be)
[09:04:08] <eddyb_> dbaupp: rust-core. if you're there, maybe it got closed
[09:04:44] <eddyb_> waiting for pcwalton to get back so I can continue talking :P
[09:05:56] <dbaupp> eddyb_: oh, right... closed. https://github.com/thestinger/rust-core/pull/4
[09:07:07] <eddyb_> he wants rust-core to be a crate (when we get static linking and LTO), but that makes it close to impossible to provide some implementation to rust-core :(
[09:07:26] <Heather> Unsupported extension: MultiWayIf :( no my favorite extension on travis... bad travis
[09:08:04] <Heather> btw... why there is nothing alike a ? b : c in rust? or is there?
[09:08:37] <dbaupp> if a {b} else {c}
[09:09:01] <Heather> dbaupp I know, but C++ syntax looks twice better
[09:09:38] <Heather> dbaupp same problem in haskell but multiwayif extension resolves it
[09:10:35] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[09:11:08] <eddyb_> `${fn}Expr(ty, expr) if ty == expr.get_type() => expr`
[09:11:12] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[09:11:19] <Heather> eddyb_ macro !?
[09:11:24] <eddyb_> dbaupp: this is gonna be crazy. whenever it's going to get finished
[09:11:34] <eddyb_> Heather: just ES6 template strings, don't worry about 'em
[09:11:49] <dbaupp> eddyb_: the decompiler-to-Rust?
[09:11:54] <Heather> eddyb_ em ?
[09:12:06] <eddyb_> Heather: 'em == them
[09:12:49] <eddyb_> dbaupp: Rust codegen for the "disassembler"-to-"IR"
[09:12:58] <eddyb_> the Expr there is part of the "IR"
[09:13:29] <dbaupp> ah
[09:14:29] <eddyb_> it's neat writing this in Rust, but at the same time frustrating - because I'll (mostly) only use constant operations - for emulation
[09:16:05] <pnkfelix> eddyb_: is there a good link with a writeup of the SLAM allocator?  I have only found links to talk abstracts and a few email threads looking for where it lives now
[09:16:14] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Quit: z0w0)
[09:16:27] <pnkfelix> eddyb_: (I mean a link for the high-level descriptions, and pros/cons.  Not your rust code.)
[09:16:53] <eddyb_> pnkfelix: that's probably a different thing
[09:17:53] <pnkfelix> eddyb_: Ah, kernel (and parallel processing) specific, versus your slam is  . . . ?
[09:18:36] <pnkfelix> (well, based on http://forum.osdev.org/viewtopic.php?f=15&t=20878&start=0 I guess the SLAM there is also for multi-processor ...)
[09:19:24] *** Joins: engla (engla@moz-F64E1B0F.cust.bredbandsbolaget.se)
[09:19:39] *** Quits: m_kato (m_kato@moz-C286AD9A.bitcat.net) (Quit: Leaving...)
[09:19:49] <eddyb_> there are exactly two implementations in existence: the original Pedigree one (in C++) and my rewrite (in Rust)
[09:20:23] <eddyb_> the C++ one is full of fancy checks, magic numbers (even Bochs-specific watchpoints)
[09:21:35] <eddyb_> pnkfelix: http://pedigree-project.org/projects/pedigree/wiki/SlabDraft those were the first changes to the generic SLAB implementation
[09:21:42] <pnkfelix> eddyb: thx
[09:22:13] <eddyb_> I *think* I've done a better job with the recovery algorithm than the great James Molloy himself :P
[09:22:14] <dbaupp> eddyb_: so the name "SLAM" is purely from the pedigree one?
[09:22:53] <eddyb_> dbaupp: I think the "rationale" for the name is in the osdev thread
[09:22:56] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[09:23:00] <pnkfelix> eddyb_: you might want to consider a different name, considering how poor the google results are for "SLAM allocator" right now
[09:23:41] <pnkfelix> eddyb_: (Unless the concepts of the two projects are actually, or at least potentially, related)
[09:24:15] <dbaupp> eddyb_: well, yeah... my point is just that it's got no connection to the SLAM from the linux kernel (assuming I'm reading google correctly)
[09:24:37] <eddyb_> dbaupp: nope
[09:24:39] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Ping timeout)
[09:24:49] <pnkfelix> eddyb_: But then again, maybe suggesting that you rename "slam" has about as much value as suggesting you rename "slab" as well (for the same reason)
[09:24:53] *** Joins: yota (sdouche@moz-7D878FB8.securactive.net)
[09:25:37] <eddyb_> pnkfelix: I could call it SLAB (B from my last name, as M came from James Molloy)
[09:25:43] <eddyb_> oh, wait, that's already used :P
[09:26:01] <pnkfelix> eddyb_: wait, I thought the "M" was for Multiprocessor … I must have totally misread that thread
[09:26:07] <dbaupp> eddyb_: "BLAM"
[09:26:18] <pnkfelix> oh that is awesome
[09:26:27] <dbaupp> pnkfelix: "I've named it the "SLAM" allocator ("SLAB" à la James Molloy),"
[09:26:38] <eddyb_> dbaupp: nested quotes :D
[09:26:48] <eddyb_> oh dear, the mibbit emoticons are atrocious
[09:26:57] <dbaupp> eddyb_: it's alright, you're not a compiler.
[09:27:00] <o11c> blam sounds cool
[09:27:04] <dbaupp> (at least, I don't think you are.)
[09:27:10] <pnkfelix> dbaupp: oh man my reading comprehension is at a zero today
[09:27:22] <dbaupp> pnkfelix: just woke up?
[09:27:32] <pnkfelix> dbaupp: I wish I could use that excuse
[09:27:42] <dbaupp> haha
[09:28:57] <eddyb_> there's a log, right? can someone point pcwalton to this conversation, later?
[09:29:17] <dbaupp> eddyb_: https://botbot.me/mozilla/rust/msg/7749324/
[09:29:25] <dbaupp> (i.e. yes)
[09:30:38] *** Joins: genbattle (quassel@moz-44ABD640.jetstream.xtra.co.nz)
[09:30:41] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[09:30:48] <Heather> offtopic but maybe someone knows how can I use newer GHC on travis?
[09:31:01] <dbaupp> Heather: which version do you need?
[09:31:48] <Heather> dbaupp 7.6.x
[09:32:10] <Heather> dbaupp not sure which but any version supporting MultiWayIf =) can't find since when it available
[09:32:47] *** Quits: lkey (chatzilla@25653362.1DD2AC9D.49CEED6B.IP) (Ping timeout)
[09:32:57] <dbaupp> Heather: https://github.com/travis-ci/travis-ci/issues/882 might contain something useful
[09:33:10] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[09:33:23] <Heather> just googled it too )
[09:33:46] <eddyb_> pcwalton, pnkfelix: my contribution to SLAM (or BLAM, if you will. don't ask for a backronym) is to the recovery algorithm (reliable O(n)). for object sizes smaller than a page, SLAM doesn't require freeing the page immediately, it can run the recovery algorithm, like a garbage collector, in idle time
[09:35:14] <eddyb_> pcwalton: no idea if that's an useful property for Servo. I can probably expand on the concepts if you want. oh, and I meant to get some benchmarks going, but I'm not sure how to do them
[09:35:38] *** Joins: lkey (chatzilla@25653362.1DD2AC9D.49CEED6B.IP)
[09:37:16] <eddyb_> pcwalton: this is the entire allocation function (for object size of 0x1000) http://i.imgur.com/1d3bA9O.png
[09:37:24] <dbaupp> eddyb_: does #[bench]'ing a series of allocations in a loop suffice? https://github.com/mozilla/rust/wiki/Doc-unit-testing#benchmarking
[09:38:13] *** Quits: boredomist (ruqs@B16F530C.DC641F2C.BCAEBB33.IP) (Ping timeout)
[09:38:15] *** Quits: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net) (Connection reset by peer)
[09:38:26] *** Joins: huhlig-home (huhlig@moz-C8339267.hfc.comcastbusiness.net)
[09:38:44] <eddyb_> (I may have exaggerated a bit about the code size. my memory is kinda bad, heh :P)
[09:39:16] <eddyb_> the fast path is the same for all allocation sizes, the slow path is longer for those smaller than a page (because there's an inner loop)
[09:40:06] <eddyb_> dbaupp: maybe... but I should probably update my rust-git first, it's a couple weeks behind, I think
[09:40:29] <pcmattman> a couple weeks... recompile all the things! :)
[09:40:39] <eddyb_> (so I'm not testing against a different allocator than master or something)
[09:41:16] <dbaupp> eddyb_: as long as your rust includes https://github.com/mozilla/rust/pull/9933 , you should be using the system allocator (which master is still using)
[09:42:08] <eddyb_> dbaupp: and I have to come up with a few tests, for different allocation sizes - I doubt perf will be the same for four bytes and growing a large vector
[09:42:48] <pnkfelix> eddyb_: I'm seeing if I can find any interesting microbenchmarks suites of value for you to look into porting to your allocator
[09:43:02] <pnkfelix> eddyb_: (e.g. by surveying the ISMM proceedings)
[09:43:05] <eddyb_> oh, about that, a graph with the realloc cost would be interesting (you can do it in-place, there's enough info available)
[09:43:45] <eddyb_> is the ~ heap non-shared?
[09:44:14] <dbaupp> eddyb_: no, ~ is the sendable one
[09:44:30] <dbaupp> (but, it's not always sendable.)
[09:44:40] <eddyb_> hmpf. and @ was per-task?
[09:44:51] <dbaupp> yes
[09:45:21] *** Parts: Heather (Heather@19663F6.F53BAACC.9C17E900.IP) ()
[09:45:27] <dbaupp> (~T, where T contains a @ is also per-task. fwiw.)
[09:46:06] <dbaupp> (i.e. semantically... currently everything is just allocated with plain old malloc, afaik)
[09:46:30] <eddyb_> so it needs some thread-safety
[09:46:41] *** Joins: Jackneill (Jackneill@moz-805F9566.pool.digikabel.hu)
[09:47:42] <eddyb_> fun fact: if you were to have a different SLAM/BLAM allocator for each task, you wouldn't need thread-safety for alloc/free aaaaaand you could free (but not recover, although that can fixed) a pointer from a different task than where it was allocated
[09:47:56] <ChrisMorgan> acrichto: what wouldn't run about the rust-http/comparisons/run.py? I want to be able to fix it up if I can.
[09:48:07] <pnkfelix> eddyb: see e.g. http://acdc.cs.uni-salzburg.at/
[09:48:10] <dbaupp> eddyb_: you still need OS-thread safety, fwiw.
[09:48:27] <eddyb_> maybe it's useless, but it sure does sound like a cool thing to have
[09:48:46] <eddyb_> dbaupp: what for? scheduler internals?
[09:49:03] <eddyb_> you can have a special thread-safe arena, if that's what you need
[09:50:29] <dbaupp> eddyb_: tasks are multiplex on multiple OS-threads i.e. putting things in *thread*-local storage will likely break
[09:50:40] <dbaupp> *multiplexed
[09:51:11] <eddyb_> and task-local would be painful. I think I see what's going on
[09:53:36] <eddyb_> pnkfelix: thanks, but it doesn't support Rust, and exposing a plain C interface would get rid of the known-allocation-size inlining
[09:54:41] <pnkfelix> eddyb_: My intention was to just say "there might be good benchmarks to port to Rust here"
[09:54:48] *** Quits: genbattle (quassel@moz-44ABD640.jetstream.xtra.co.nz) (Ping timeout)
[09:54:55] <pnkfelix> eddyb_: Not to imply that those benchmarks were something you could immediately compile in rust.
[09:54:55] *** Joins: genbattle (quassel@moz-44ABD640.jetstream.xtra.co.nz)
[09:54:58] <eddyb_> which means you have to go through next-pow-2 (which could be only two instructions with clz), some checks and a jump table
[09:54:59] *** Joins: nawfel (Mibbit@545C3BFB.DC42D29D.13B3C60E.IP)
[09:55:12] <eddyb_> pnkfelix: ah, okay, more work :)
[09:55:49] <eddyb_> ewww, C
[09:55:50] <pnkfelix> eddyb_: Yeah, so maybe not a great idea.  I have not yet read the paper they wrote up on it.
[09:56:30] *** Joins: notmatt (notmatt@moz-3C7AF18C.lightspeed.sntcca.sbcglobal.net)
[09:58:15] *** Quits: notmatt (notmatt@moz-3C7AF18C.lightspeed.sntcca.sbcglobal.net) (Ping timeout)
[10:00:39] <eddyb_> oh wow, the longer the deallocation delay, the better jemalloc performs at allocating? (for a section of the graph).... wtf?
[10:02:24] <eddyb_> I don't think SLAM/BLAM could compete with jemalloc. its main virtue is simplicity
[10:02:28] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Ping timeout)
[10:04:00] *** Joins: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP)
[10:04:18] <pnkfelix> eddyb_: Are you talking about Figure 8 in the paper ?
[10:05:09] <eddyb_> pnkfelix: yupp
[10:05:27] <eddyb_> or maybe it's the other way around, low deallocation delays cause it to do more work. that makes sense
[10:05:31] <pnkfelix> eddyb_: I'm not sure what one is supposed to conclude from that anomaly.  Its worth noting that jemalloc is starting from a significantly slower allocation time when deallocation delay = 0.
[10:06:42] *** Joins: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP)
[10:07:51] <eddyb_> http://cksystemsteaching.github.io/pintos-for-students/ interesting
[10:08:06] <eddyb_> (I started clicking on links from that ACDC page)
[10:08:28] *** Quits: GeneralMaximus (ankur@15904EB6.A825C662.4C155415.IP) (Ping timeout)
[10:08:52] *** Joins: mark_edward_ (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net)
[10:09:39] *** Joins: andre (andre@CA528A4A.45A4338E.8EE27E6.IP)
[10:14:17] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[10:17:52] *** Joins: oberstet (quassel@moz-50FAC9D.dynamic.mnet-online.de)
[10:19:33] *** Joins: sammykim (sammykim@5AB4884B.FCC4549.14D5B978.IP)
[10:20:50] <eddyb_> rusti: 5u8 + 3u64
[10:20:50] -rusti- <anon>:9:15: 9:19 error: mismatched types: expected `u8` but found `u64` (expected u8 but found u64)
[10:20:50] -rusti- <anon>:9          5u8 + 3u64
[10:20:50] -rusti-                         ^~~~
[10:20:50] -rusti- error: aborting due to previous error
[10:20:50] -rusti- application terminated with error code 101
[10:22:13] *** Quits: geomyidae__ (uid214@moz-E77DEB21.irccloud.com) (Quit: Connection closed for inactivity)
[10:23:23] <sammykim> why is this error? http://pastebin.mozilla.org/3486246
[10:23:41] <sammykim> Without <T> that works well.
[10:24:03] *** Quits: nawfel (Mibbit@545C3BFB.DC42D29D.13B3C60E.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:25:34] <dbaupp> sammykim: because there compiler can't work out which type `T` should be used to call f()
[10:25:56] <dbaupp> sammykim: e.g. if f was `std::mem::size_of::<T>()` then the output would change based on different T's
[10:26:00] *** Quits: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net) (Quit: Sharp)
[10:26:07] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Connection reset by peer)
[10:26:31] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[10:28:07] <dbaupp> sammykim: it might be fixed with (for example) `Buffer::<int>::f`
[10:28:17] * dbaupp can't remember if that works yet
[10:28:30] <Thiez> Is there any chance of 'const' coming back?
[10:28:40] *** Quits: genbattle (quassel@moz-44ABD640.jetstream.xtra.co.nz) (Ping timeout)
[10:29:51] <bjz> dbaupp: that has been fixed
[10:29:54] *** Joins: sweet_kid (Upasana@BD2D9C72.D06DD960.4A5F0685.IP)
[10:31:29] <bjz> dbaupp: so, Buffer::<int>::f should work
[10:32:55] *** Joins: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP)
[10:32:56] <dbaupp> bjz: ah, cool
[10:33:21] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[10:35:15] *** Joins: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com)
[10:36:54] <ChrisMorgan> I also find myself with a case where being able to modify an object while there are a great number of references to it would be convenient.
[10:38:25] <Thiez> I had a datastructure in mind that owned some elements that could refer to one another and possibly contain a cycle
[10:38:49] <Thiez> but I believe the references to one another would have to be const
[10:40:18] <Ms2ger> Cycles are hard
[10:40:18] <bjz> Thiez: why do you need `const` for that?
[10:40:51] <Thiez> bjz: because if element A references B with &, then I can never modify B?
[10:40:51] <myname> why no @?
[10:41:07] <Thiez> @ is going away :)
[10:41:18] *** Quits: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net) (Ping timeout)
[10:41:26] <Thiez> and it would have to be @mut in that case
[10:41:44] *** Quits: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP) (Ping timeout)
[10:43:45] <Thiez> and if A references B and B references A, then if I have a mutable ref to A and I access A->B->A, then I have &mut and & to the same object at the same time
[10:44:04] <sammykim> Thanks dbaupp I will try that
[10:45:20] *** Quits: sammykim (sammykim@5AB4884B.FCC4549.14D5B978.IP) (Quit: Lost terminal)
[10:46:19] <Amaranth> ChrisMorgan: How did that benchmark go yesterday?
[10:46:38] <ChrisMorgan> Amaranth: very badly indeed. 50% drop instead of 20-30% increase.
[10:46:40] *** Quits: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net) (Quit: Leaving.)
[10:46:42] <Amaranth> Ouch
[10:47:03] *** Joins: g3orge (g3orge@moz-369F78A7.access.hol.gr)
[10:47:39] <dbaupp> ChrisMorgan: any idea why?
[10:47:39] <Amaranth> Well I still remember when setting GOMAXPROCS to something other than 1 was usually a slowdown and look where they are now.
[10:47:57] *** Quits: sweet_kid (Upasana@BD2D9C72.D06DD960.4A5F0685.IP) (Quit: Leaving)
[10:49:55] <ChrisMorgan> dbaupp: "spawn" is now the operation that's taking the longest, and that includes spawning a task, taking the stream out of a cell and creating a BufferedStream (mine, not std::rt::io::buffered's).
[10:50:18] <nmatsakis> Thiez: I personally would rather like to add const back, though perhaps with another name. But right now I think the main way to workaround this situation is to employ @mut and avoid borrowing to &. Eventually the Mut<T> type would provide similar capabilities without employing @
[10:50:27] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[10:50:59] <ChrisMorgan> &semimut
[10:51:11] <dbaupp> `&readonly T`
[10:51:15] <Thiez> readyonly is nice
[10:51:21] <Thiez> readonly*
[10:51:43] <dbaupp> (similar problems to calling it const, since & is also "readonly", semantically.)
[10:51:48] <Thiez> nmatsakis: thanks for that information :)
[10:51:59] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[10:52:08] <Thiez> actually & is not "readonly" but "readonly_for_everyone"
[10:52:13] <dbaupp> ChrisMorgan: oh, any more details on what part of that is the worst?
[10:53:05] <dbaupp> ChrisMorgan: e.g. is it a regression of task::spawn?
[10:53:08] <ChrisMorgan> acrichto said it looked to be BufferedStream::new that was spending a lot of time. Can't think why, it's a trivial constructor that does 128KB of allocation.
[10:53:20] <dbaupp> ah
[10:53:27] <dbaupp> I guess 128KB is a lot?
[10:53:40] <eddyb_> dumb memset/
[10:53:47] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[10:53:53] <eddyb_> s/\//?/
[10:54:19] <Thiez> get a separate task that does nothing but allocate 128KB chunks and zero them, then make them available to BufferedStream ;)
[10:55:15] <dbaupp> haha, sits there filling a shared port with as many 128KB chunks as it can
[10:55:20] <ChrisMorgan> Well, it suggests one of two things: that [0u8, ..0x10000] *used* to be cheap and is no longer, or that it's needing to move the memory than it used to (I'm not quite clear on how that part works).
[10:55:31] <dbaupp> ... gotta have enough connections or you'll go OOM.
[10:55:45] <eddyb_> ChrisMorgan: does it use all the zeroed memory?
[10:56:01] <eddyb_> pretty sure ~[T] allocs the capacity without touching it
[10:56:25] <dbaupp> ChrisMorgan: can you use std::unstable::intrinsics::uninit() rather than 0 (assuming every byte is written before being read)?
[10:56:58] <ChrisMorgan> eddyb_: ~[T] is also heap-allocated whereas I believe [0u8, ..0x10000] is stack allocated?
[10:57:20] <eddyb_> ChrisMorgan: that entire 128KB thing is on-stack?
[10:57:36] <eddyb_> bbl, going home
[10:57:47] <ChrisMorgan> I believe that would be the case.
[10:58:07] <dbaupp> I guess it has to zero the whole thing with a plain old loop
[10:58:19] <dbaupp> (which doesn't explain why it'd be slower now, of course.)
[10:58:36] *** Quits: eddyb_ (Mibbit@moz-B97E9B0E.lbi.ro) (Quit: http://www.mibbit.com ajax IRC Client)
[10:59:31] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[11:08:03] <Thiez> do we have a way to specify a T that does not implement some trait already?
[11:08:12] <dbaupp> Thiez: no
[11:08:31] <Thiez> would it make sense to add a built-in 'Not' or 'NotImpl' trait that allows this?
[11:08:35] <dbaupp> Thiez: of interest, https://github.com/mozilla/rust/issues/10414#issuecomment-28259491
[11:10:11] <Thiez> if a NotImpl-trait would exist in a PR, would it get accepted?
[11:12:43] <dbaupp> how would NotImpl work as a trait?
[11:12:44] <Ms2ger> Thiez, the answer to that question is in a Heisenberg-uncertain state until such a PR exists ;)
[11:13:03] <dbaupp> fn foo<T: NotImpl<OtherTrait>>(...) { } ?
[11:13:14] <dbaupp> that wouldn't work currently.
[11:13:33] *** Quits: StarLight (StarLight@moz-C4DC57FA.dynamic.avangarddsl.ru) (Ping timeout)
[11:13:36] <Thiez> no it wouldn't
[11:13:40] <Thiez> but I imagine it could
[11:13:46] <dbaupp> maybe
[11:13:47] <Thiez> if NotImpl were added to the compiler
[11:13:57] <Thiez> I imagine it wouldn't be that hard either
[11:14:19] <Thiez> the coherency rules enable it quite nicely
[11:14:34] <dbaupp> I'd guess that one would get a much higher probability of acceptance if the submitter were to consult with nmatsakis before working on it.
[11:14:59] *** Quits: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Ping timeout)
[11:15:03] * Thiez gently prods nmatsakis.
[11:16:23] *** Quits: ofeldt (ofeldt@moz-382B6ED0.dip0.t-ipconnect.de) (Ping timeout)
[11:17:08] <o11c> what would stop someone from implemeting the trait later?
[11:17:27] <Thiez> the coherency rules
[11:17:33] *** Joins: StarLight (StarLight@moz-36A78DE0.dynamic.avangarddsl.ru)
[11:17:47] <Thiez> a trait must either be implemented in the crate that defines the trait, or in the crate that defines the type
[11:17:49] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[11:18:05] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[11:18:08] *** Joins: nkoep (nik@moz-542C2079.pool.mediaways.net)
[11:18:36] <Thiez> so if trait T is defined in crate A, and type U is defined in crate B, then crate C cannot come along and say 'impl T for U'
[11:18:56] <Thiez> unless C = A or C = B
[11:19:44] *** Joins: eddyb9 (eddy@41C5F390.C75CDC83.4A6B528C.IP)
[11:20:31] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:20:47] <eddyb9> ahh, how I wish I could pattern-match in function arguments or by type
[11:21:45] <kimundi> eddyb9: A function argument is a pattern :P
[11:22:06] <eddyb9> an irrefutable one
[11:22:13] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[11:22:14] <kimundi> yeah
[11:22:21] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:22:35] <kimundi> (And by type sounds like something that would be possible with &Any)
[11:23:05] <eddyb9> - or restrict generics to certain type sets which have something in common, like cas.... whaa nevermind, I see how I can do that :D
[11:23:26] <kimundi> traits and enums :P
[11:23:50] <eddyb9> although it would require writing "as" wrappers for all the combinations of two primitive types
[11:24:02] *** Joins: fyolnish (fyolnish@moz-87F8AFD7.uqwimax.jp)
[11:24:30] <kimundi> ... WHich we already have
[11:24:47] <eddyb9> but only in std
[11:25:03] <kimundi> FromPrimitve and ToPrimitive and other  related traits in std::num
[11:25:09] <kimundi> ah, yeah
[11:25:14] *** Joins: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com)
[11:25:19] <eddyb9> (and I have my own primitive types, like u1/i1, f80, etc.)
[11:25:32] *** Quits: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Client exited)
[11:25:33] *** Joins: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com)
[11:25:39] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Ping timeout)
[11:27:38] <eddyb9> I need some kind of "implement all trait methods for a type as fail!()" syntax extension
[11:28:00] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[11:28:49] <eddyb9> I won't write full implementation for things like u256/i256 and f80, as I'll never need them
[11:30:58] *** Joins: notmatt (notmatt@moz-3C7AF18C.lightspeed.sntcca.sbcglobal.net)
[11:31:31] <eddyb9> I'm slightly amused at u1/i1. negation is a noop
[11:32:41] <eddyb9> maybe I shouldn't even allow i1 and non-bitwise operations between two u1
[11:32:41] *** Quits: notmatt (notmatt@moz-3C7AF18C.lightspeed.sntcca.sbcglobal.net) (Ping timeout)
[11:33:27] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[11:34:21] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[11:34:29] *** Joins: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net)
[11:34:38] *** Joins: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP)
[11:34:52] *** Joins: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP)
[11:37:03] *** Joins: Sorella_ (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP)
[11:38:16] *** Quits: Sorella_ (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Quit: Ex-Chat)
[11:41:07] *** Quits: Ms2ger (Ms2ger@moz-F84178D5.ugent.be) (Quit: bbl)
[11:45:50] <eddyb9> kimundi: I have a problem: I want a trait ConvertTo<T>, and I want to use it in a generic function... but that T is the type parameter of the generic function, and the type it is implemented on is one of a few primitive types, used in the generic function
[11:46:40] <kimundi> eddyb9: I don't understand
[11:46:40] <eddyb9> I don't think type bounds can express something like that :(
[11:47:09] *** Joins: Ralith (ralith@moz-132F2FD4.sea.wa.customer.broadstripe.net)
[11:48:21] <eddyb> back home, real keyboard :D
[11:48:26] <kimundi> trait ConvertSelfTo<T> { fn convert(self) -> T; }  fn foo<To, From: ConvertSelfTo<To>>() { ... } // SOmething like that?
[11:48:34] *** Quits: eddyb9 (eddy@41C5F390.C75CDC83.4A6B528C.IP) (Ping timeout)
[11:48:57] <eddyb> kimundi: yes, except there's a few different types for From, used in the function
[11:49:15] <pnkfelix> eddyb: why do you need that level of specific-ness?  Parametricity is not meant to encode "choose from a small enumerated set of types" ?
[11:49:34] <eddyb> pnkfelix: because otherwise it won't work
[11:49:36] <pnkfelix> eddyb: is it so you can dispatch to an appropriate size class or something?
[11:50:12] <kimundi> Well, as long as the specific types all implement ConvertSelfTo<To> is ought to work, you wouldn't even need the From : ConvertSelfTo<To>  bound
[11:50:28] <eddyb> e.g. ConvertSelfTo::convert(1u32) as i64
[11:50:51] <pnkfelix> eddyb: I don't think you want "as i64"
[11:51:06] <pnkfelix> eddyb: I think you want `let x : i64 = ConvertSelfTo::convert(1u32);`
[11:51:11] <eddyb> or that :)
[11:51:15] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[11:51:23] <eddyb> that will always work, because both types are known
[11:51:49] <eddyb> let x : T = ConvertSelfTo::convert(1u32); won't work
[11:52:58] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[11:53:10] <eddyb> because u32 needs to implement ConvertSelfTo<T>, and that needs to be asserted by a type bound
[11:53:38] <dbaupp> eddyb: where are you getting 'T' from
[11:53:39] <dbaupp> ?
[11:53:51] <dbaupp> oh, I see the problem...
[11:53:55] <eddyb> I guess I can have fn foo<T: ConvertFrom<u32> + ConvertFrom<i32> .... (all primitive types plus more)>
[11:54:36] <dbaupp> can you have an empty ConvertSelfFrom trait, with `impl<T, S: ConvertSelfTo<T>> ConvertSelfFrom<S> for T {}`?
[11:54:54] <dbaupp> oh, that's basically what you just said.
[11:55:37] <eddyb> your idea is interesting because I can also provide a proper implementation for that trait. and I might need both, depending on what I'm doing
[11:56:10] <pnkfelix> eddyb: why not this: https://gist.github.com/pnkfelix/7429674
[11:56:40] <eddyb> pnkfelix: From is not generic in my case
[11:57:05] <dbaupp> at the very least you can have `trait ConvertPrimitive {} impl<T: ConvertFrom<u32> + ...> ConvertPrimitive for T {}` so you only need to write `T: ConvertPrimitive` rather than repeating all the relevant ones
[11:57:06] <eddyb> ah, you mean a freestanding generic function?
[11:57:27] <eddyb> dbaupp: now it's starting to look good :D
[11:57:34] <eddyb> I just needed to switch things around
[11:58:11] <dbaupp> or even `impl<S: SomeOtherTrait, T: ConvertFrom<S>> ConvertPrimitive for T {}` ... but you may be straining the trait-matching algorithm a bit there
[11:58:12] <pnkfelix> eddyb: so do you want ConvertFrom<S> instead of ConvertTo<T> ?
[11:58:15] * dbaupp isn't sure
[11:58:59] *** Quits: amro (quassel@D9E34ACF.8AAAF769.FAAB0799.IP) (Ping timeout)
[11:59:10] <eddyb> pnkfelix: I can express type bounds with ConvertFrom
[11:59:14] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[11:59:40] <eddyb> pnkfelix: your solution won't work, because my function is only generic on To
[12:00:03] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[12:00:27] <pnkfelix> eddyb: I haven't posted a solution using ConvertFrom yet ...
[12:01:14] <eddyb> pnkfelix: you want to do it without making the set of primitives explicit?
[12:01:30] <pnkfelix> eddyb: there, now gist is updated: https://gist.github.com/pnkfelix/7429674
[12:01:37] <pnkfelix> eddyb: but perhaps this is what you're already talking about
[12:01:55] <eddyb> [13:53] <eddyb> I guess I can have fn foo<T: ConvertFrom<u32> + ConvertFrom<i32> .... (all primitive types plus more)>
[12:02:04] <eddyb> sorry for wasting your time :P
[12:02:05] *** Joins: ofeldt (ofeldt@moz-94D1B9B0.dip0.t-ipconnect.de)
[12:02:38] <pnkfelix> eddyb: ah, I didn't read your msg preceding my first gist posting carefully enough.
[12:03:32] *** Quits: erick (erick@E1304535.2A7189BF.BE19388.IP) (Ping timeout)
[12:03:40] *** Joins: erick (erick@E1304535.2A7189BF.BE19388.IP)
[12:03:47] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[12:04:26] <pnkfelix> eddyb: not sure yet if having multiple bounds all with the same trait name (and just different instantiations of it) is going to work out well for you, though.  I cannot remember how well we currently deal with that.
[12:06:24] <dbaupp> rusti: trait Foo<T> { fn bar(&self, x: T) {} } impl<T> Foo<T> for int {} fn baz<T: Foo<i32> + Foo<f64>>(x: T) { x.bar(1i32); x.bar(1f64); } baz(1i)
[12:06:25] -rusti- pastebinned 5 lines of output: http://sprunge.us/eYhV
[12:06:35] <dbaupp> not well (at least, not well in 0.8)
[12:07:01] <pnkfelix> eddyb: so you might (for now) need to make traits like `ConvertFromI32`, `ConvertFromI64`, etc
[12:07:23] <pnkfelix> eddyb: I had a blog post about some syntaxes that might attempt to fix this, it ties into the potential future work on associated items.
[12:07:58] <dbaupp> (I would file that, or at least check if it or something similar has already been filed, but I gtg, so someone else can/should.)
[12:08:11] <eddyb> what, + is broken?
[12:08:25] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[12:08:27] <eddyb> there has to be something more important that's affected by this
[12:08:42] <pnkfelix> eddyb: when you have multiple bounds with the same trait (but different instantiations of its type parameters), I don't think we currently deal with it well
[12:08:51] <pnkfelix> eddyb:  so its not all of `X: T + S` that's broken
[12:08:53] *** Joins: Ms2ger (Ms2ger@moz-C91E35CE.ugent.be)
[12:08:59] <pnkfelix> eddyb: just one case that is of particular interest.
[12:09:30] <eddyb> uhm, why? incomplete implementation?
[12:09:54] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[12:10:11] <pnkfelix> eddyb: (i'm trying to find an already filed issue on this, I assume there must be one)
[12:10:20] <pnkfelix> eddyb:  it ties into e.g. 
[12:10:22] <pnkfelix> eddyb:  https://github.com/mozilla/rust/issues/6894
[12:10:46] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[12:11:02] *** Quits: fyolnish (fyolnish@moz-87F8AFD7.uqwimax.jp) (Client exited)
[12:12:26] <eddyb> pnkfelix: not sure if I see the connection
[12:12:28] <pnkfelix> eddyb: but that's not the really correct issue number on this
[12:13:28] <pnkfelix> eddyb: when you have `fn foo<X : T1 + T2>() { … }`, you can write, in the body, `T1::meth()` or `T2::meth()`
[12:13:32] <eddyb> https://github.com/mozilla/rust/issues/6894#issuecomment-19077708
[12:13:46] <eddyb> I'm right there :D
[12:14:11] <pnkfelix> eddyb: but when you have `fn foo<X: T<A> + T<B>> { … }`, then `T::meth()` is ambiguous.
[12:14:13] *** Quits: ab (alex@BC9D99CC.37C1012D.FE617B51.IP) (Ping timeout)
[12:14:28] <pnkfelix> eddyb: so you need some way to disambiguate.
[12:14:36] <eddyb> riiight, but dbaupp's example isn't using Foo::bar
[12:15:17] *** Quits: ofeldt (ofeldt@moz-94D1B9B0.dip0.t-ipconnect.de) (Ping timeout)
[12:15:21] <pnkfelix> eddyb: right, its using another aspect of resolve
[12:15:22] <eddyb> or do you mean X::meth?
[12:16:21] <pnkfelix> eddyb: I don't yet know whether dbaupp's example represents a currently known (but fixable) bug in resolve, or if it represents a deficiency in the language.
[12:16:35] <pnkfelix> eddyb: My memory is that we don't want to do argument-dependent lookup
[12:16:58] <pnkfelix> eddyb: which I am pretty sure that dbaupp's example, as written, would rely upon.  But I might be misclassifying it.
[12:17:21] <eddyb> but outside of the generic function, you can use argument-depent lookup right right, I think
[12:18:40] *** Joins: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de)
[12:20:56] <eddyb> rusti: trait Foo<T> { fn bar(from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} fn baz<T: Foo<i32> + Foo<f64>>(x: T) { Foo::bar(1i32); Foo::bar(1f64); } baz(1i)
[12:20:57] -rusti- pastebinned 4 lines of output: http://sprunge.us/LRMQ
[12:22:06] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[12:22:09] *** Joins: ricepuddin (graham@moz-7D68765A.cable.virginm.net)
[12:22:35] *** Quits: amey (user@9284AA42.60650FE8.9D7331A6.IP) (Ping timeout)
[12:22:37] <eddyb> rusti: trait Foo<T> { fn bar(from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} fn baz<T: Add + Foo<i32> + Foo<f64>>() -> T { T::bar(1i32) + T::bar(1f64) } baz::<int>()
[12:22:37] -rusti- pastebinned 20 lines of output: http://sprunge.us/SIZb
[12:22:52] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Quit: WeeChat 0.4.3-dev)
[12:22:52] <pnkfelix> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} fn baz<T: Foo<i32> + Foo<f64>>(x: T) { let _x:int = Foo::bar(1i32); let _y: int = Foo::bar(1f64); } baz(1i)
[12:22:53] -rusti- pastebinned 5 lines of output: http://sprunge.us/ZaWQ
[12:23:23] <eddyb> my last example is what you were talking about in that issue, I think
[12:24:18] <pnkfelix> eddyb: I'm trying to point out that I don't think you are dealing with the error messages from rusti properly.  It needs to know the Self type being returned by the `bar` invocations in order to resolve them to an impl.
[12:24:36] *** Joins: ofeldt (ofeldt@moz-B450C213.dip0.t-ipconnect.de)
[12:24:37] <pnkfelix> eddyb: that's why I added the `let _x: int = … ; let _y : int = …; ` to my example.
[12:24:48] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} fn baz<T: Foo<i32> + Foo<f64>>(x: T) { let _x: T = Foo::bar(1i32); let _y: T = Foo::bar(1f64); } baz(1i)
[12:24:49] -rusti- pastebinned 5 lines of output: http://sprunge.us/CZRE
[12:25:06] <pnkfelix> eddyb: right, now I think we're back where dbaupp left us.
[12:25:38] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[12:26:17] <eddyb> rusti: trait Foo<T> { fn bar(from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} fn baz<T: Add + Foo<i32> + Foo<f64>>() -> T { Foo::bar(1i32) + Foo::bar(1f64) } baz::<int>()
[12:26:18] -rusti- pastebinned 4 lines of output: http://sprunge.us/DYPh
[12:26:42] <eddyb> rusti: trait Foo<T> { fn bar(from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} fn baz<T: Add<T, T> + Foo<i32> + Foo<f64>>() -> T { Foo::bar(1i32) + Foo::bar(1f64) } baz::<int>()
[12:26:43] -rusti- pastebinned 7 lines of output: http://sprunge.us/LehM
[12:27:17] <eddyb> all hail type inferrence
[12:27:45] *** Joins: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr)
[12:28:08] *** pmoore is now known as pmoore|away
[12:28:33] *** Joins: brson (brson@9C2E78E6.8C982E60.292610BC.IP)
[12:28:33] *** ChanServ sets mode: +ao brson brson
[12:28:42] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} fn baz<T: Foo<i32> + Foo<f64>>() { let _x: T = Foo<i32>::bar(1i32); let _y: T = Foo<f64>::bar(1f64); } baz::<int>()
[12:28:44] -rusti- pastebinned 20 lines of output: http://sprunge.us/cOZc
[12:29:11] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} fn baz<T: Foo<i32> + Foo<f64>>() { let _x: T = Foo::<i32>::bar(1i32); let _y: T = Foo::<f64>::bar(1f64); } baz::<int>()
[12:29:12] -rusti- pastebinned 5 lines of output: http://sprunge.us/bXDJ
[12:29:29] <eddyb> what on earth does that even mean?
[12:29:45] <eddyb> there's no more fancy lookup going on, the traits are known
[12:32:40] <eddyb> pnkfelix: it's obviously a bug: http://sprunge.us/LIBA http://sprunge.us/dHHX
[12:33:22] <eddyb> waaait. I'm not yet sure I'm interpreting it correctly :/
[12:33:35] <pnkfelix> eddyb: I'm trying to find where that syntax `Foo::<T>::bar` was introduced, I believe it was added only recently
[12:34:29] <pnkfelix> eddyb: wait, you only have one Foo<f64> bound on T there
[12:34:45] <eddyb> pnkfelix: does it even care about the explicit type param? or Foo is just aliased to its first/last occurrence in type bounds?
[12:35:00] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[12:35:16] <eddyb> the latter doesn't seem sound, because you can have any number of type parameters, with any number of bounds
[12:35:41] <pnkfelix> eddyb: I don't understand what you example is attempting to illustrate anymore.  You've got two different instatiations of Foo that you're calling, and each returns Self, but the T type that you're binding it to only says it implements one of the two
[12:35:43] <eddyb> pnkfelix: I was trying to reproduce this error message http://sprunge.us/bXDJ
[12:36:13] <pnkfelix> eddyb: okay, that one is different to me, because *that* T actually says it implements both of the traits.
[12:36:27] <eddyb> it only cares about the first one
[12:36:29] <pnkfelix> eddyb: (Even though it gives the same error message, which does seem like a bug)
[12:36:45] *** Quits: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP) (Ping timeout)
[12:37:00] <pnkfelix> eddyb: My working hypothesis is that we simply don't deal with multiple instances of the same trait in one list of bounds propelry.
[12:37:17] <eddyb> but... there's nothing special about it X_X
[12:37:38] *** Quits: sorella (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Client exited)
[12:37:49] *** Joins: pcwalton (pcwalton@9C2E78E6.8C982E60.292610BC.IP)
[12:37:49] *** ChanServ sets mode: +ao pcwalton pcwalton
[12:38:02] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} fn boo() {}} impl<T> Foo<T> for int {} fn baz<T: Foo<i32> + Foo<f64>>() { Foo::boo(); } baz::<int>()
[12:38:03] -rusti- pastebinned 4 lines of output: http://sprunge.us/PeQN
[12:38:04] <pnkfelix> eddyb: I'm not saying we *shouldn't* deal with it in some way.
[12:38:05] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[12:38:14] *** pmoore|away is now known as pmoore
[12:38:24] <eddyb> from that error, I conclude Foo is not aliased
[12:38:26] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[12:38:40] <eddyb> pnkfelix: it's just ignoring type bounds
[12:39:03] <eddyb> for no reason whatsoever. half-implemented?
[12:39:28] <ChrisMorgan> "path: Path," → "unresolved name `Path`. Did you mean `path`?" This seems a little ingenuous.
[12:39:31] <pnkfelix> eddyb: again, I don't know how you can conclude much from http://sprunge.us/PeQN  ; you haven't provided a type for the Self parameter in that example, so the compilation is probably failing earlier in the method resolution attempts.   That is, its not a good way to narrow the behavior.
[12:39:56] <eddyb> I concluded Foo is not aliased, as you've said
[12:40:05] *** Quits: pcwalton (pcwalton@9C2E78E6.8C982E60.292610BC.IP) (Quit: pcwalton)
[12:40:11] <pnkfelix> eddyb: I don't know what you mean by "Foo is not aliased"
[12:40:20] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[12:40:20] *** Quits: alonlevy (alon@moz-74377C14.bb.netvision.net.il) (Ping timeout)
[12:40:24] <eddyb> Foo is the same name, inside the function, as outside
[12:40:34] *** Joins: sorella (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP)
[12:40:36] <eddyb> nothing magic happens because it appears in type bounds
[12:41:18] <eddyb> Foo<i32> and Foo<f64> are two distinct traits (which, on another level, are specializations of a generic trait)
[12:42:16] *** Joins: jdm (jdm@9C2E78E6.8C982E60.292610BC.IP)
[12:42:16] *** ChanServ sets mode: +o jdm
[12:43:26] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[12:43:54] <pnkfelix> eddyb: I agree they should be distinct traits.  I still don't know if they are always properly treated as such.
[12:45:56] <eddyb> I don't know if I feel like digging through compiler code right now. and I really want to get this done :D
[12:46:04] *** Quits: sorella (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP) (Client exited)
[12:46:31] <pnkfelix> eddyb: Well, You've already said that the set of types is relatively small
[12:46:51] <pnkfelix> eddyb: So can't you encode your needs as a set of traits, `FromI32`, `FromF64`, etc ?
[12:47:15] <eddyb> "aliasing" the traits isn't a problem. I can even group them into ConvertableFromPrimitive or something
[12:49:08] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} trait FooAll {} impl<T: Foo<i32> + Foo<f64>> FooAll for T {} fn baz<T: FooAll>() { let _x: T = Foo::<i32>::bar(1i32); let _y: T = Foo::<f64>::bar(1f64); } baz::<int>()
[12:49:09] -rusti- pastebinned 7 lines of output: http://sprunge.us/fEKK
[12:49:59] <eddyb> is that pointing to the generic impl?
[12:51:16] * ChrisMorgan apologises for slandering Rust ten minutes ago with his "path: Path,"; that was in fact correct, he misinterpreted the line number to where that was the argument type rather than the struct field value
[12:51:53] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} trait FooI32{} impl<T: Foo<i32>> FooI32 for T {} trait FooF64{} impl<T: Foo<f64>> FooF64 for T {} trait FooAll {} impl<T: FooI32 + FooF64> FooAll for T {} fn baz<T: FooAll>() { let _x: T = Foo::<i32>::bar(1i32); let _y: T = Foo::<f64>::bar(1f64); } baz::<int>()
[12:51:53] -rusti- pastebinned 4 lines of output: http://sprunge.us/LPTC
[12:52:39] <eddyb> maybe I need to chain the methods or something
[12:52:54] <pnkfelix> eddyb: I was thinking more along the lines of `let _x : T = FooI32::bar(1i32);`, etc.
[12:53:18] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[12:53:20] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[12:53:32] <pnkfelix> eddyb: (Its just a workaround for the bug)
[12:53:49] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[12:54:35] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} trait FooI32: Foo<i32>{} impl<T: Foo<i32>> FooI32 for T {} trait FooF64: Foo<f64>{} impl<T: Foo<f64>> FooF64 for T {}  fn baz<T: FooI32 + FooF64>() { let _x: T = FooI32::bar(1i32); let _y: T = FooF64::bar(1f64); } baz::<int>()
[12:54:36] -rusti- pastebinned 8 lines of output: http://sprunge.us/FCYZ
[12:54:39] *** Quits: axitkhurana (Adium@63F3AA56.9CFBD76D.30E7AE68.IP) (Quit: Leaving.)
[12:55:55] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} trait FooI32: Foo<i32>{} impl<T: Foo<i32>> FooI32 for T {} trait FooF64: Foo<f64>{} impl<T: Foo<f64>> FooF64 for T {}  fn baz<T: FooI32 + FooF64>() { let _x: T = Foo::<i32>::bar(1i32); let _y: T = Foo::<f64>::bar(1f64); } baz::<int>()
[12:55:56] -rusti- pastebinned 5 lines of output: http://sprunge.us/MXRH
[12:56:04] <eddyb> WTF
[12:56:29] <eddyb> pnkfelix: I have no idea what's going on
[12:56:42] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} trait FooI32: Foo<i32>{} impl<T: Foo<i32>> FooI32 for T {} trait FooF64: Foo<f64>{} impl<T: Foo<f64>> FooF64 for T {}  fn baz<T: FooI32 + FooF64>() { let _x: T = Foo::<i32>::bar(1i32); } baz::<int>()
[12:56:43] -rusti- task <unnamed> failed at 'explicit failure', <anon>:9
[12:56:43] -rusti- application terminated with error code 101
[12:56:50] <pnkfelix> eddyb: I havne't conveyed clearly enough to you what I was suggesting.
[12:56:56] <eddyb> pnkfelix: the bug is worse than I thought
[12:56:58] <pnkfelix> eddyb: I'm saying get rid of Foo<T>
[12:57:00] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[12:57:05] <eddyb> no, Foo<T> works
[12:57:14] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[12:57:38] <eddyb> rusti: trait Foo<T> { fn bar(_from: T) -> Self {fail!();} } impl<T> Foo<T> for int {} trait FooI32: Foo<i32>{} impl<T: Foo<i32>> FooI32 for T {} trait FooF64: Foo<f64>{} impl<T: Foo<f64>> FooF64 for T {}  fn baz<T: FooF64>() { let _x: T = Foo::<i32>::bar(1i32); } baz::<int>()
[12:57:39] -rusti- pastebinned 5 lines of output: http://sprunge.us/ACii
[12:57:50] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[12:57:54] <pnkfelix> eddyb: My claim is that with multiple occurrences in a single bounds list, it doesn't.
[12:58:06] <pnkfelix> eddyb: I know you say you've disproved that claim, but I don't understand your counterexample
[12:58:06] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Client exited)
[12:58:12] <eddyb> but now it's not a generic trait in a bound list
[12:58:16] <pnkfelix> eddyb:  and I don't think you and I want to spend time debating your counterexample
[12:58:45] <pnkfelix> eddyb: I had *thought* you wanted a workaround to get your project done, but maybe I misinterpreted your earlier statement about not wanting to dive into rustc right now.
[12:59:17] *** Joins: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP)
[12:59:17] *** ChanServ sets mode: +ao dherman dherman
[12:59:37] <eddyb> one way I wanted to work around doesn't work. FooI32 and FooF64 are no longer specializations, but they inherit from specializations of Foo
[13:00:05] <pnkfelix> eddyb: the only way I can see that working is if they each have their own method they introduce ...
[13:00:09] <pnkfelix> eddyb: let me try that.
[13:00:21] <eddyb> pnkfelix: does it recursively collect type bounds?
[13:00:38] *** Quits: Ms2ger (Ms2ger@moz-C91E35CE.ugent.be) (Ping timeout)
[13:00:45] <eddyb> so it ends up with FooI32 + FooF64 + Foo<i32> + Foo<f64>?
[13:01:05] <eddyb> (the latter two being inherited by the former two)
[13:01:57] *** Joins: sorella (quildreen@9D963F5D.DF5D8AE7.54BCAB54.IP)
[13:03:13] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[13:03:58] *** Joins: Blub\w (wry@moz-8EE7A167.wireless.dyn.drei.com)
[13:05:55] *** Joins: sweet_kid (Upasana@EA1B4F4D.9254DCFF.1228A288.IP)
[13:07:04] <jfbk> sometime in the last week master has stopped building for me on OSX 10.8, anyone else seeing that?
[13:07:12] <pnkfelix> my  idea  above (to let you keep defining Foo<T>) doesn't work.  So I'm going back to my original suggestion: https://gist.github.com/pnkfelix/7430501
[13:07:14] <pnkfelix> eddyb: ^
[13:08:36] <pnkfelix> eddyb: I'm not saying its pretty.  I'm just trying to help with the "really want to get this done"
[13:08:43] <eddyb> pnkfelix: I would forward to Foo<T>
[13:08:58] <pnkfelix> eddyb: Well if you get that variant working, let me know.
[13:10:47] <pnkfelix> eddyb: for me, my attempts to encode it yield a lot of "conflicting implementations for trait `Foo`" errors.
[13:11:29] <pnkfelix> eddyb: Ah, probably because of this: https://github.com/mozilla/rust/issues/7590
[13:11:39] *** Joins: fyolnish (fyolnish@moz-87F8AFD7.uqwimax.jp)
[13:12:07] <pnkfelix> eddyb: notably, as noted by tjc: "coherence ignores type arguments to generic traits when determining whether there are multiple implementations of a trait for the same type."
[13:12:17] <eddyb> GAAAAAH
[13:12:22] <pnkfelix> eddyb: I left out the word "currently" in the above.
[13:12:27] <pnkfelix> eddyb: we want to fix that, I believe.
[13:12:34] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[13:12:36] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[13:13:15] * eddyb wonders if specializations of a generic trait are ever distinguished :(
[13:13:20] *** Quits: fyolnish (fyolnish@moz-87F8AFD7.uqwimax.jp) (Ping timeout)
[13:13:40] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[13:18:48] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[13:19:47] *** Quits: Khmar (user@8D107082.DB3E3FE1.657EB0E6.IP) (Ping timeout)
[13:20:02] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[13:22:21] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[13:22:23] *** Quits: alp (alp@moz-D1CEC204.com) (Quit: FLAG_FIN)
[13:23:01] *** flaper87|afk is now known as flaper87
[13:26:58] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[13:27:18] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[13:29:05] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[13:30:12] *** Joins: Ms2ger (Ms2ger@moz-FED0935A.ugent.be)
[13:35:55] *** Quits: Ms2ger (Ms2ger@moz-FED0935A.ugent.be) (Ping timeout)
[13:36:13] *** Joins: Ms2ger (Ms2ger@moz-FED0935A.ugent.be)
[13:36:32] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[13:36:41] <zokier`> are there windows rust nightlies floating around somewhere?
[13:37:03] <eddyb> zokier`: the snapshot compiler is somewhat usable
[13:37:25] <eddyb> (but to get it, you need to put together a few URL parts yourself)
[13:37:57] <bjz> eddyb: you mean the 0.8 one?
[13:38:47] <eddyb> no, I mean the latest snapshot (which should never be more than 3-4 days old)
[13:39:03] <bjz> oh good
[13:39:10] <bjz> I was worried
[13:39:38] <bjz> windows nightlies would be amazing
[13:39:44] <eddyb> something could package stage3 into an installer for windows, not just a snapshot
[13:39:56] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[13:41:39] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[13:42:26] <ChrisMorgan> eddyb: snapshots have been known to get *lots* older than 3-4 days.
[13:42:38] *** Joins: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP)
[13:43:13] <Thiez> hmmn, I see one downside of NotImpl<T>; impl<T: NoImpl<B>> A for T {} impl<T: NoImpl<A>> B for T{}
[13:43:16] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[13:43:52] <eddyb> Thiez: looks recursive
[13:44:07] <eddyb> ChrisMorgan: interesting, when I looked in the file listing them, I didn't see a larger interval. but I didn't read through the entire history
[13:44:15] <Thiez> I think it looks more like a contradiction
[13:44:38] <Thiez> T implements A only if T does not implement A
[13:44:55] <Thiez> or shorter: impl<T: NotImpl<A>> A for T {}
[13:44:59] <ChrisMorgan> eddyb: we went for over a month without a snapshot a couple of months ago. That led to there being a *lot* of conditional code just waiting for the next snapshot for it to be able to be removed...
[13:45:43] <eddyb> Thiez: your first example is corecursive, which wouldn't work *anyway* in the type system
[13:46:34] <eddyb> (it does result in a contradiction, but only if you consider it mathematically)
[13:47:31] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Quit: leaving)
[13:47:36] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[13:47:42] <eddyb> but it already makes my head spin
[13:47:54] *** Joins: cubic (cubic@moz-80241A3A.mc.videotron.ca)
[13:47:59] <mletterle> おはよう rustistas.
[13:48:51] <sanxiyn> mletterle: Evening in Japan
[13:49:19] <eddyb> rusti: let おはよう = "foobar"; おはよう
[13:49:20] -rusti- "foobar"
[13:49:37] <mletterle> True enough :) こんばんは
[13:50:59] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[13:53:09] <mletterle> rusti: let つ="っ"; つ
[13:53:10] -rusti- "\u3063"
[13:56:21] <pnkfelix> acrichto: ping
[13:58:05] *** Joins: alonlevy (alon@moz-92551128.red.bezeqint.net)
[13:59:34] <eddyb> rusti: let つ="っ"; println(つ)
[13:59:34] -rusti- っ
[13:59:35] -rusti- ()
[14:00:35] *** Quits: beifeng (Mibbit@284C36E7.3062CEC3.670EEFD.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:01:18] *** Joins: zatnosk (zatnosk@31AE4F7A.F285E7E8.9E52235C.IP)
[14:03:28] *** Quits: tav (tav@moz-40D7C5F6.range109-154.btcentralplus.com) (Ping timeout)
[14:04:04] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[14:06:05] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[14:06:20] *** Quits: XgF (quassel@moz-58044BA0.ldn1.uk.e43.eu) (Client exited)
[14:08:01] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[14:11:49] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[14:12:53] *** Joins: fyolnish (fyolnish@moz-FE3BC902.uqwimax.jp)
[14:13:36] *** flaper87 is now known as flaper87|afk
[14:14:21] *** Joins: XgF (quassel@moz-C1F31E58.members.linode.com)
[14:14:37] *** Joins: kirneh (kirneh@moz-ACBB9422.k955.webspeed.dk)
[14:14:38] *** Quits: fyolnish (fyolnish@moz-FE3BC902.uqwimax.jp) (Ping timeout)
[14:15:50] *** Joins: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com)
[14:19:25] *** Quits: sanxiyn (tinuviel@B4104EBB.3CC170B1.1E14B209.IP) (Quit: Leaving)
[14:22:55] *** Quits: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP) (Quit: dherman)
[14:26:00] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[14:27:12] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[14:33:41] *** Joins: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au)
[14:34:13] *** Joins: ianj (ianjneu@moz-7140CF01.ccs.neu.edu)
[14:38:10] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[14:41:47] *** Joins: valenting_2 (Mibbit@C8B4B20A.B535C8D.9ECD61CB.IP)
[14:43:24] <valenting_2> hey guys, any idea of how I can kill a supervized child task without calling fail?
[14:44:09] <valenting_2> i'm looking for somethink like let t = task::spawn_unsupervized {}; t.kill();
[14:44:40] <kimundi> What's wrong with fail?
[14:45:12] <bstrie> you mean the ability to kill a task from outside, rather than from inside?
[14:45:19] <valenting_2> yup
[14:45:28] <kimundi> Alternativly, send a message that causes the task to kill itself
[14:45:40] <bstrie> that's what I was thinking
[14:45:46] <valenting_2> that's the best idea I came up with as well... 
[14:45:56] <valenting_2> i was wondering if there is another way
[14:45:57] <bstrie> but perhaps there's a way to do what you want
[14:46:00] <bstrie> not sure
[14:46:37] <Amaranth> In other languages it is either not possible to do this or not recommended so even if such a feature exists I'd recommend not using it and doing your own message
[14:46:54] <brson> it isn't possible with rust tasks
[14:48:02] <valenting_2> ok, thanks guys :D
[14:48:12] <valenting_2> really grateful
[14:49:01] <brson> it could be possible someday, but it requires some fixes to linked failure and some way to name tasks
[14:49:31] <brson> right now tasks are anonymous, which i rather like
[14:49:32] <bstrie> I thought we already had named tasks... don't error messages always say something about "unnamed tasks" failing?
[14:49:42] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[14:49:45] <brson> name like, as a variable
[14:49:52] <brson> they can have names, like people do
[14:49:56] <bstrie> haha
[14:50:07] <bstrie> ok, so they have names as identifiers, but not names as handles
[14:50:11] <brson> yeah
[14:52:07] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[14:56:26] <ChrisMorgan> I think things like speculative work would benefit from the ability to kill tasks immediately other than by linked failure? (Sure, you could just add another unlinked task as the spawner of the speculative work and then have it wait for a kill signal, but that's more effort all round and may involve two copies of data rather than one.)
[14:56:50] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[14:57:11] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[14:58:56] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[14:59:40] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[15:02:02] *** Joins: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP)
[15:06:52] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[15:08:21] <zokier`> what version of gcc I need currently for windows build? the wiki is bit unclear about that
[15:09:31] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[15:10:38] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[15:15:42] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:17:33] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Quit: leaving)
[15:17:38] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[15:17:53] <bstrie> zokier`: the wiki should specify a version of mingw that comes with the right version of gcc
[15:18:39] *** Quits: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de) (Ping timeout)
[15:19:22] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Quit: leaving)
[15:19:28] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[15:20:40] *** Joins: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de)
[15:21:48] <zokier`> it says "Roll mingw back to the latest: mingw-get upgrade" and just after that it says that I should have <4.6
[15:22:12] *** jorendorff_away is now known as jorendorff
[15:22:12] <zokier`> https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust#quick-steps-for-windows-environment-setup this is what i'm reading
[15:23:03] *** Joins: Kruppe (user@moz-A6CA08BD.net.uwaterloo.ca)
[15:23:54] *** Joins: fyolnish (fyolnish@moz-FE3BC902.uqwimax.jp)
[15:24:06] *** Quits: JanC (janc@moz-A6B15A85.dsl.scarlet.be) (Ping timeout)
[15:24:50] *** Quits: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net) (Quit: Jesse)
[15:25:39] *** Quits: fyolnish (fyolnish@moz-FE3BC902.uqwimax.jp) (Ping timeout)
[15:26:18] *** kimundi is now known as zz_kimundi
[15:26:28] <bstrie> zokier`: sorry, I've never built rust on windows before, I can't give any tips
[15:27:11] <zokier`> well i'll try with 4.5, lets see what happens :)
[15:27:44] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[15:29:20] *** Joins: Savago (Savago@D8B9C081.E820043D.D4C04133.IP)
[15:29:26] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[15:30:15] <mletterle> zokier`: Update the wiki with whatever you find, if you could... I plan on doing windows builds sooner or later.. >.>
[15:31:21] *** Joins: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com)
[15:32:08] *** Joins: Sharp (Sharp@moz-7B61DF4.dsl.static.sonic.net)
[15:33:30] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[15:33:41] *** Quits: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net) (Client exited)
[15:34:02] *** Joins: Skif (emschwar@moz-CA025D57.ip.mcleodusa.net)
[15:34:07] <zokier`> umm. i think make just crashed or something, stuck on "extracting rust-stage0/bin/third-party/README.txt" while make consumes a whole core
[15:34:13] <zokier`> this is promising
[15:34:34] *** Joins: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net)
[15:34:58] <bstrie> it's a pretty hefty readme
[15:35:21] <cmr> Wouldn't safely killing a task at an arbitrary point require throwing an exception in its context?
[15:35:29] <cmr> When would that even be valid?
[15:36:22] <Ms2ger> Mm, exceptions
[15:36:52] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[15:37:10] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[15:37:36] <cmr> dbaupp: the ProcessStatus PR is going to make multibuilder much more ugly :(
[15:38:19] <cmr> hmm maybe not!
[15:38:20] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[15:38:26] <cmr> if status.success()
[15:38:30] <cmr> notbad.png
[15:38:32] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Connection reset by peer)
[15:38:36] *** Joins: pnkfelix1 (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[15:38:56] *** Joins: JanC (janc@moz-1862E1D9.dsl.scarlet.be)
[15:39:10] *** pnkfelix1 is now known as pnkfelix
[15:39:19] <brson> cmr: it would only happen at preemption points, so it wouldn't be foolproof
[15:39:36] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[15:39:44] <cmr> bstrie: ok, makes sense
[15:39:52] <bstrie> cmr: I'm glad you understand
[15:39:56] <cmr> heh
[15:39:59] <nmatsakis> Ms2ger: why do you ask?
[15:40:20] <nmatsakis> Ms2ger: I'm... more-or-less happy with that design I sketched out, though I kind of wish it had fewer moving parts 
[15:40:30] <Ms2ger> nmatsakis, I'd like to actually use it in Servo :)
[15:40:35] <nmatsakis> ah :)
[15:40:56] *** Joins: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP)
[15:41:02] *** Quits: Kxepal (Miranda@moz-428D43AB.pppoe.mtu-net.ru) (Ping timeout)
[15:41:41] <bstrie> brson: are you all in korea now?
[15:41:56] <nmatsakis> Ms2ger: I thikn it's happening, but nobody is working on it
[15:42:05] <Ms2ger> nmatsakis, dunno if you've seen what we ended up with, but it's not pretty :)
[15:42:09] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[15:42:23] <Ms2ger> (unless you like Rust Bingo)
[15:42:35] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Max SendQ exceeded)
[15:42:51] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[15:44:11] *** Joins: Kxepal (Miranda@moz-64407EE.pppoe.mtu-net.ru)
[15:45:59] <brson> bstrie: yep!
[15:47:15] <zokier`> https://gist.github.com/anonymous/7433105 well that didn't work out
[15:47:33] <jdm> Ms2ger: what's this you're referring to?
[15:47:42] *** Quits: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de) (Ping timeout)
[15:47:46] <Ms2ger> jdm, inheritance
[15:47:55] <jdm> oh, right
[15:48:09] <Ms2ger> I hope you're not attached to AbstractNode? :)
[15:48:16] <jdm> pfft
[15:48:23] <jdm> only in the abstract sense
[15:48:35] <Ms2ger> jdm++
[15:48:54] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[15:48:56] <cmr> eddyb: that's a really cool idea. It's only possible for like x*3 though, not 3*x, afaik
[15:49:19] <Ms2ger> jdm, (and you didn't even include my janitorial duties in Servo!)
[15:49:31] <eddyb> cmr: hmpf. interesting... (and problematic, I think)
[15:49:32] *** Joins: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de)
[15:49:40] <jdm> whenever we get a This Week In Servo, it'll happen
[15:49:49] *** Quits: KindOne (KindOne@E22D0913.5ADC762.34F73994.IP) (Ping timeout)
[15:49:50] *** Joins: fyolnish (fyolnish@moz-FE3BC902.uqwimax.jp)
[15:50:17] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[15:50:56] *** Joins: notmatt (notmatt@moz-3C7AF18C.lightspeed.sntcca.sbcglobal.net)
[15:53:06] *** Quits: notmatt (notmatt@moz-3C7AF18C.lightspeed.sntcca.sbcglobal.net) (Client exited)
[15:53:26] <eddyb> cmr: oooh damn, it means I can't do 1u32 << expr (where Expr is of type Expr) :(
[15:53:31] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[15:54:22] *** Joins: KindOne (KindOne@E22D0913.5ADC762.34F73994.IP)
[15:54:57] <cmr> eddyb: yes, it's unfortunate. Thankfully it's fixable, std::num just needs to be modified to use a trait for the RHS
[15:55:16] <eddyb> huh?
[15:55:32] <eddyb> cmr: oh, you mean a generic. wouldn't work for <<, though
[15:55:40] <cmr> eddyb: why not?
[15:56:22] <eddyb> wait, derp. rshl. gotcha :D
[15:56:24] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[15:57:17] <eddyb> (radd or addr? can't remember which one Python uses)
[15:57:30] <cmr> eddyb: this is just the overloading workaround in http://smallcultfollowing.com/babysteps/blog/2012/10/04/refining-traits-slash-impls/ btw
[15:59:36] <eddyb> you can impl<A, B, C: ReverseAdd<A, B>> Add<C, B> for A, I guess
[16:00:19] *** Quits: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com) (Ping timeout)
[16:00:40] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[16:01:38] *** Joins: beifeng (Mibbit@408AEF45.145C8DEA.64FAF8EC.IP)
[16:01:57] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[16:03:23] *** Quits: brson (brson@9C2E78E6.8C982E60.292610BC.IP) (Ping timeout)
[16:05:21] <eddyb> cmr: well... I wasn't implementing anything other than Add<Expr, Expr> for Expr, anyway
[16:09:02] *** Quits: paulproteus (quassel@199.199.210.158) (Ping timeout)
[16:09:39] *** Joins: paulproteus (quassel@458FE134.3EC36C88.CBDCF1DC.IP)
[16:11:38] *** Joins: GeneralMaximus (ankur@1D0406CE.1B0DA661.BE90E62C.IP)
[16:11:42] *** Quits: Ms2ger (Ms2ger@moz-FED0935A.ugent.be) (Quit: bbl)
[16:12:14] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[16:12:19] *** Joins: FreeFull (freefull@133CB72F.B3D53FFC.AE02ECA4.IP)
[16:12:36] *** Quits: KindOne (KindOne@E22D0913.5ADC762.34F73994.IP) (Ping timeout)
[16:13:41] *** Joins: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net)
[16:17:03] *** Joins: KindOne (KindOne@383F2045.D40F8E6E.EC6A1518.IP)
[16:18:29] *** Joins: unbracketed (textual@moz-DD541BA.lsanca.fios.verizon.net)
[16:18:34] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[16:20:49] *** Quits: Ferreus (ferreus@moz-210E4EED.dip0.t-ipconnect.de) (Ping timeout)
[16:27:48] *** Joins: huseby (huseby@moz-E3F1D7ED.guilhem.org)
[16:29:47] *** Quits: GeneralMaximus (ankur@1D0406CE.1B0DA661.BE90E62C.IP) (Quit: Computer has gone to sleep.)
[16:30:53] *** Quits: huseby (huseby@moz-E3F1D7ED.guilhem.org) (Quit: Leaving)
[16:31:13] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[16:32:08] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[16:32:28] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[16:32:28] *** Quits: sigma (sigma@moz-39E40618.range86-143.btcentralplus.com) (Quit: Leaving.)
[16:33:06] *** Quits: osa1 (omer@moz-63168A82.hsd1.in.comcast.net) (Ping timeout)
[16:34:59] *** Quits: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com) (Quit: arodier74)
[16:35:25] *** Joins: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com)
[16:36:33] *** Quits: g3orge (g3orge@moz-369F78A7.access.hol.gr) (Ping timeout)
[16:36:38] *** Quits: fyolnish (fyolnish@moz-FE3BC902.uqwimax.jp) (Client exited)
[16:39:37] *** Quits: Savago (Savago@D8B9C081.E820043D.D4C04133.IP) (Ping timeout)
[16:39:58] *** Joins: g3orge (g3orge@moz-369F78A7.access.hol.gr)
[16:40:44] *** Quits: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr) (Ping timeout)
[16:41:54] *** Joins: jensnockert (jensnocker@moz-A02864B8.wireless.lu.se)
[16:43:14] *** Quits: alonlevy (alon@moz-92551128.red.bezeqint.net) (Ping timeout)
[16:45:33] *** Joins: huseby (huseby@moz-30056280.clients.your-server.de)
[16:46:18] *** Quits: jensnockert (jensnocker@moz-A02864B8.wireless.lu.se) (Connection reset by peer)
[16:46:49] *** Joins: jensnockert (jensnocker@moz-A02864B8.wireless.lu.se)
[16:48:43] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[16:49:08] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[16:49:30] *** Joins: nif (Mibbit@moz-B6DFA19D.wireless.oberlin.edu)
[16:50:34] *** Joins: mikezaby (mikezaby@moz-AA896205.home.otenet.gr)
[16:50:34] *** Quits: valenting_2 (Mibbit@C8B4B20A.B535C8D.9ECD61CB.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:52:14] *** Joins: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr)
[16:52:18] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Client exited)
[16:52:40] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[16:53:28] *** Quits: KindOne (KindOne@383F2045.D40F8E6E.EC6A1518.IP) (Ping timeout)
[16:54:20] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[16:54:48] <acrichto> ChrisMorgan: I think it may just be osx that couldn't run it, numbers rarely got printed and when they did they made no sense, after about 6k connections the bencher would stop responding (not sure why)
[16:55:25] <acrichto> ChrisMorgan: also, 128KB is a huge allocation, especially to completely zero, malloc is hugely faster than calloc, and you're doing malloc + memset and the memset is really killing you
[16:55:43] <acrichto> ChrisMorgan: see #10424 I merged yesterday
[16:55:44] <acrichto> pnkfelix: pong
[16:56:35] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[16:56:51] <pnkfelix> I was seeing a rustpkg test failure on tests::test_c_dependency_no_rebuilding
[16:58:08] *** Quits: Kruppe (user@moz-A6CA08BD.net.uwaterloo.ca) (Ping timeout)
[17:00:08] *** Joins: alan (alan@moz-FE02DD30.sat6.rackspace.com)
[17:00:25] <acrichto> I've been seeing that on and off
[17:00:29] <acrichto> I'm not entirely sure why
[17:00:33] <acrichto> I thought I fixed it...
[17:00:45] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[17:02:29] *** Parts: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) ()
[17:02:36] *** Joins: lfox (lfox@moz-861E573F.nyc.biz.rr.com)
[17:02:46] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[17:02:47] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[17:04:29] *** Quits: jensnockert (jensnocker@moz-A02864B8.wireless.lu.se) (Connection reset by peer)
[17:06:40] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[17:07:11] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[17:07:22] <pnkfelix> acrichto: I need to double check against the HEAD of master
[17:07:32] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:07:51] *** Quits: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de) (Ping timeout)
[17:08:06] *** Joins: pnkfelix1 (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[17:08:36] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Connection reset by peer)
[17:08:40] <pnkfelix1> acrichto: I was testing on a branch that was based off of master from November 10th
[17:08:42] *** pnkfelix1 is now known as pnkfelix
[17:08:46] <pnkfelix> acrichto: so I mostly wanted to know if this was known to have been fixed recently or not
[17:08:49] *** Joins: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de)
[17:08:53] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[17:09:16] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[17:10:25] <pnkfelix> acrichto: (going afk, but any info would be appreciated.  otherwise I'll report back after I've tested on my rebased branch)
[17:11:10] *** Joins: axitkhurana (Adium@D11FB110.5E7A94F9.6AA50C35.IP)
[17:11:43] *** Parts: nif (Mibbit@moz-B6DFA19D.wireless.oberlin.edu) ()
[17:17:15] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[17:17:31] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[17:17:32] *** Joins: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net)
[17:17:53] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[17:19:38] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[17:20:05] *** Quits: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com) (Quit: arodier74)
[17:20:51] *** Joins: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP)
[17:21:53] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[17:22:10] *** Joins: DasIch (dasich@moz-5EDA591.de)
[17:22:40] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Client exited)
[17:22:49] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[17:23:09] *** Joins: Ms2ger (Ms2ger@45E56866.3CF91143.187A1082.IP)
[17:24:17] *** Quits: zatnosk (zatnosk@31AE4F7A.F285E7E8.9E52235C.IP) (Quit: Computer has gone to sleep)
[17:25:16] *** Joins: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com)
[17:27:02] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[17:28:45] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Ping timeout)
[17:29:49] <acrichto> pnkfelix: hm, I'd recommend rebasing, if you've got my uv-rewrite branch and it's still failing, then there's probably still the bug in there
[17:36:11] *** Joins: nif (Mibbit@F773C385.3B36E0FD.F275000D.IP)
[17:38:56] *** Quits: mikezaby (mikezaby@moz-AA896205.home.otenet.gr) (Input/output error)
[17:39:21] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[17:39:22] *** Quits: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com) (Quit: arodier74)
[17:39:43] *** Joins: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com)
[17:40:18] *** Joins: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca)
[17:40:19] *** Joins: nlminhtl (ignotus@moz-BA3DE7EF.volia.net)
[17:40:53] *** Joins: boredomist (ruqs@8186917.CC8FA3EE.E3401B6E.IP)
[17:41:27] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[17:41:42] *** Joins: notmatt (notmatt@118CCA77.D1B89392.602E4FC1.IP)
[17:41:47] *** Quits: g3orge (g3orge@moz-369F78A7.access.hol.gr) (Ping timeout)
[17:42:05] *** Joins: g3orge (g3orge@moz-369F78A7.access.hol.gr)
[17:44:43] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[17:46:49] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:47:14] *** Joins: fyolnish (fyolnish@moz-29867CC0.uqwimax.jp)
[17:48:55] *** Quits: fyolnish (fyolnish@moz-29867CC0.uqwimax.jp) (Ping timeout)
[17:49:00] *** Joins: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[17:50:12] *** pmoore is now known as pmoore|away
[17:50:20] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[17:50:59] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Ping timeout)
[17:51:05] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[17:51:35] *** zz_kimundi is now known as kimundi
[17:52:35] *** Joins: osa1 (uid13910@moz-5F4AA75A.irccloud.com)
[17:54:52] *** Joins: Kruppe (user@moz-310F8E31.net.uwaterloo.ca)
[17:55:45] *** Quits: z0w0 (zack@moz-FE2A0BDD.lnse2.woo.bigpond.net.au) (Client exited)
[17:57:19] *** Parts: nif (Mibbit@F773C385.3B36E0FD.F275000D.IP) ()
[17:57:51] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[17:57:56] *** Quits: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de) (Ping timeout)
[17:59:48] *** Joins: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de)
[18:02:19] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[18:02:40] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[18:04:08] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:04:23] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[18:05:25] <tiffany> ah.. I didn't read the email about the thread being closed until after I wrote a reply to it
[18:07:43] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[18:07:49] *** Quits: oberstet (quassel@moz-50FAC9D.dynamic.mnet-online.de) (Client exited)
[18:08:03] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:08:51] *** Joins: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[18:08:51] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Connection reset by peer)
[18:09:55] <Leo`> tiffany: I found this thread to be quite amusing :P
[18:11:13] <SiegeLord> Yay for moderation, I say... bikesheds are just so infuriating to read
[18:11:37] <tiffany> I'd say it was a bit beyond bikeshedding
[18:11:52] *** Quits: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr) (Ping timeout)
[18:11:59] <SiegeLord> Well, whatever it was... it just wasn't constructive
[18:12:02] <cmr> yeah
[18:12:03] <tiffany> yeah..
[18:12:21] *** Quits: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP) (Ping timeout)
[18:12:37] <tiffany> I think the most absurd thing in  the thread was when they said that the pointer types should be removed because they don't know what they're for
[18:14:46] <cmr> tiffany: fwiw ARC there means automatic reference counting, ala objc
[18:15:07] <tiffany> uh.. what's the difference from RC, then?
[18:15:25] <cmr> in rust? nothing
[18:15:59] <tiffany> huh
[18:16:33] *** Quits: Kruppe (user@moz-310F8E31.net.uwaterloo.ca) (Ping timeout)
[18:16:43] *** Joins: nuts (tii@822A8E7E.6AD15BF5.75D3BBDB.IP)
[18:18:09] *** Quits: Cromulent (Cromulent@moz-C2470BE2.cable.virginm.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[18:18:12] <SiegeLord> I thought A stood for atomic
[18:18:14] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[18:18:44] <jdm> not in objective-c land
[18:18:46] <sfackler> it does in rust, but in ObjC's ARC it stands for automatic
[18:19:56] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[18:20:00] *** Quits: lfox (lfox@moz-861E573F.nyc.biz.rr.com) (Quit: ZZZzzz…)
[18:20:14] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[18:20:23] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[18:20:34] *** Quits: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo)
[18:20:40] <cmr> The key observation is that reference counting is gc
[18:20:52] *** Joins: avsej (avsej@D9A610B8.4841F515.FB33447D.IP)
[18:23:00] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[18:23:19] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[18:26:07] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[18:26:19] *** Joins: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[18:27:09] <tiffany> I don't know how this person found out what ARC without finding out what pointers are for
[18:27:13] <tiffany> what ARC does*
[18:27:42] *** Quits: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP) (Ping timeout)
[18:27:53] *** Joins: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP)
[18:28:29] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[18:29:19] *** Quits: jdm (jdm@9C2E78E6.8C982E60.292610BC.IP) (Quit: Lost terminal)
[18:30:19] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:30:34] *** Joins: alonlevy (alon@moz-B0E66DB7.static.bezeqint.net)
[18:30:52] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[18:31:09] <bstrie> my kingdom for whomever comes up with a better name for ARC
[18:31:58] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[18:32:04] <SiegeLord> ☢RC
[18:32:10] <cmr> TSRC: Thread Safe Reference Counting
[18:32:38] *** Quits: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo)
[18:32:39] <bstrie> cmr: submit the PR
[18:32:48] <cmr> heh
[18:32:55] <cmr> I think Arc is a fine name
[18:33:01] <bstrie> nope, nope nope nope
[18:33:17] <bstrie> we'll be fielding questions about the difference between ours and ObjC's arc until judgment day
[18:33:30] <cmr> The question has only come up twice
[18:33:39] <bstrie> you haven't been paying attention, then
[18:33:47] <cmr> guilty as charged
[18:33:54] <bstrie> this has come up innumerable times since arcs were introduced
[18:33:54] *** Quits: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net) (Quit: bholley)
[18:33:58] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[18:34:00] <bstrie> we've always intended to come up with a better name
[18:34:07] <bstrie> but everyone is lazy!
[18:34:30] <SiegeLord> Src for shared RC
[18:34:31] <cmr> I don't think there's a different name that doesn't lose information.
[18:34:43] <bstrie> even AtRC
[18:34:47] <bstrie> the point is
[18:34:50] <bstrie> that acronym is taken
[18:34:53] <bstrie> full stop
[18:35:01] *** jorendorff is now known as jorendorff_away
[18:35:07] <bstrie> no need to contribute to the confusion
[18:35:09] *** Joins: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP)
[18:35:10] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:35:11] <bblum> i'm with cmr here
[18:35:17] <bblum> the name is taken in a different language
[18:35:20] <bblum> it's not a showstopper
[18:35:23] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[18:35:30] <bblum> and any other name is just so much uglier
[18:35:31] <bstrie> bblum: you named it in the first place, your opinion is discarded :P
[18:35:48] <bblum> bstrie: first that's not a reason to discard my opinion; second i didn't name it in the first place
[18:36:05] *** jorendorff_away is now known as jorendorff
[18:36:07] <bstrie> actually
[18:36:08] <bstrie> how about this
[18:36:11] <bstrie> ARC -> RC
[18:36:17] <bstrie> RC -> URC
[18:36:21] <bstrie> unatomic reference counting
[18:36:40] <bstrie> <-- saves the day
[18:36:45] <SiegeLord> Is Arc meant to be widely used?
[18:37:06] <cmr> SiegeLord: no
[18:37:20] <SiegeLord> Maybe just do AtomicRC then, to discourage its use
[18:37:27] <SiegeLord> *AtomicRc
[18:37:53] *** Joins: fyolnish (fyolnish@moz-CC00FF84.uqwimax.jp)
[18:38:00] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[18:38:03] <bstrie> nah, that's too long
[18:38:05] <mletterle> ☢RC was best. People would have to figure out how to type it first.
[18:38:07] <bstrie> it won't get used at all
[18:38:49] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:38:57] <tiffany> I agree with AtomicRC
[18:39:10] <bblum> AtomicRC is ok
[18:39:29] <SiegeLord> Wasn't there AtomicOption or w/e?
[18:39:33] <bblum> RWAtomicRC is kind of
[18:39:34] <bblum> less good
[18:39:35] *** Quits: fyolnish (fyolnish@moz-CC00FF84.uqwimax.jp) (Ping timeout)
[18:39:40] <bblum> SiegeLord: that's an entirely different thing
[18:40:33] *** Joins: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com)
[18:40:53] *** Quits: vmx (vmx@moz-55DBC78A.dip0.t-ipconnect.de) (Quit: Leaving)
[18:41:27] <SiegeLord> Is RWArc not equivalent to RcMut?
[18:42:28] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Ping timeout)
[18:42:36] <sfackler> RWArcs can be used in multiple tasks
[18:42:42] *** Quits: moostik (Icedove@5A22E6A1.10715965.BCDF592F.IP) (Ping timeout)
[18:43:30] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[18:43:43] <SiegeLord> Well, yes aside from that... I'm just possibly suggesting changing RWArc to ArcMut to address bblum's point
[18:44:20] <bblum> i dislike the 'Mut' suffix :(
[18:44:40] *** Joins: genbattle (quassel@moz-44ABD640.jetstream.xtra.co.nz)
[18:44:45] *** Joins: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net)
[18:44:47] <bblum> AtomicRCMut is clear in meaning but getting pretty far into TreeTableWrapperFactorySingleton territory
[18:44:55] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[18:46:28] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[18:46:49] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[18:47:06] <sfackler> If the Mut proposal happened, could ArcMut<T> be replaced with Arc<Mut<T>>? I think the Freeze issue has been resolved
[18:47:24] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[18:47:51] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[18:48:28] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[18:50:47] <bblum> sfackler: um
[18:50:49] <bblum> what freeze issue
[18:51:06] <bblum> Arc<Mut<T>> is not supposed to work
[18:52:36] *** Quits: beifeng (Mibbit@408AEF45.145C8DEA.64FAF8EC.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:52:42] <sfackler> oh, right c.c
[18:53:06] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[18:53:09] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[18:53:19] <cmr> why not?
[18:53:33] <sfackler> there's no locking around mutation
[18:53:47] <cmr> ah
[18:53:48] <bblum> :P
[18:53:57] * cmr hasn't looked at Mut<T> at all
[18:55:45] <cmr> I think we should have an #[affine] rather than NonCopyable
[18:55:48] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:55:54] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[18:56:52] *** Quits: genbattle (quassel@moz-44ABD640.jetstream.xtra.co.nz) (Ping timeout)
[18:57:39] <sfackler> specifically called affine, or just an attribute instead of a zero sized field?
[18:57:49] <cmr> just an attribute
[18:57:59] <cmr> affine seems like the obvious name to me
[18:58:03] <cmr> "make this an affine type"
[18:58:12] *** Joins: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[18:58:27] <sfackler> I'd go for #[no_copy] or something like that to have one less thing people have to look up on wikipedia :P
[18:58:57] *** Quits: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo)
[18:59:06] <cmr> but that conflicts with the ability to clone it (which is not removed), and the fact that you *can* copy it, you just can't use it after said copy (ie, it moves)
[18:59:41] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[18:59:54] *** Quits: lmandel1 (uid15702@moz-E77DEB21.irccloud.com) (Ping timeout)
[19:00:50] *** Quits: heftig (heftig@moz-299C586C.dip0.t-ipconnect.de) (Ping timeout)
[19:01:25] *** Joins: lmandel1 (uid15702@moz-E77DEB21.irccloud.com)
[19:03:33] *** Quits: andre (andre@CA528A4A.45A4338E.8EE27E6.IP) (Quit: leaving)
[19:04:03] *** Joins: heftig (heftig@moz-BFBECE4.dip0.t-ipconnect.de)
[19:04:18] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[19:05:12] *** Joins: icebattle (wayne@8A14A542.EBE2EE2B.C7CEC4ED.IP)
[19:05:55] *** Quits: alonlevy (alon@moz-B0E66DB7.static.bezeqint.net) (Ping timeout)
[19:06:13] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[19:06:19] *** Joins: alonlevy (alon@moz-B0E66DB7.static.bezeqint.net)
[19:07:22] *** Quits: icebattle (wayne@8A14A542.EBE2EE2B.C7CEC4ED.IP) (Quit: leaving)
[19:07:25] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:08:20] *** Joins: eholk (eholk@moz-BA312F07.crest.iu.edu)
[19:09:11] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[19:09:42] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:09:45] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[19:10:16] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:10:40] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[19:10:54] <adridu59> guys, what's the difference between := and = in a makefile?
[19:11:13] <eddyb> adridu59: one of them evaluates and assigns
[19:11:46] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[19:12:08] *** Joins: icebattle (icebattle@8A14A542.EBE2EE2B.C7CEC4ED.IP)
[19:12:11] <eddyb> adridu59: the other one (ask ##workingset on freenode or read the manual. I'm not sure which is which) only sets the expression, but the evaluation is lazy
[19:12:34] <adridu59> eddyb: thanks, found the doc http://www.gnu.org/software/make/manual/html_node/Overriding.html#Overriding
[19:14:13] *** Quits: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[19:14:31] <mark_edward> is this how rust macros work? http://wiki.dlang.org/DIP50#Abstract
[19:14:33] *** Joins: srpablo (Mibbit@moz-4B1F7E74.hsd1.nj.comcast.net)
[19:14:38] *** Quits: icebattle (icebattle@8A14A542.EBE2EE2B.C7CEC4ED.IP) (Quit: Leaving)
[19:15:04] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[19:15:09] *** Joins: icebattle (icebattle@8A14A542.EBE2EE2B.C7CEC4ED.IP)
[19:15:23] <cmr> mark_edward: having never used it, it looks similar
[19:15:32] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[19:15:33] <pauls> mark_edward: uh, you're probably better off reading the Rust macro tutorial.
[19:15:53] *** Quits: nkoep (nik@moz-542C2079.pool.mediaways.net) (Ping timeout)
[19:16:12] <pauls> D macros, I believe, don't have as sophisticated a system for invocation syntax.
[19:16:27] <SiegeLord> That's just a DIP, D doesn't have macros
[19:16:47] <pauls> SiegeLord: Oh, I see.
[19:16:51] <SiegeLord> Well, at least not AST macros
[19:16:52] *** Quits: axitkhurana (Adium@D11FB110.5E7A94F9.6AA50C35.IP) (Quit: Leaving.)
[19:16:58] <SiegeLord> It has... string mixins
[19:17:18] <pauls> Rust macros take tokens as arguments, but parse them into ASTs before using them.
[19:17:19] *** Joins: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP)
[19:17:47] <SiegeLord> Which essentially entails manipulating a string at compile time, and then inserting the string somewhere in the code to be parsed
[19:18:17] *** Joins: nkoep (nik@moz-1C6EABE9.pool.mediaways.net)
[19:18:29] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[19:18:35] <SiegeLord> Like... mixin("int a = 1;") is identical to just doing int a = 1;
[19:19:39] <mark_edward> pauls: i know how to use rust amcros, i was just curious
[19:19:53] <SiegeLord> But obviously (in D) it could be mixin(ctfe_function());
[19:20:29] <cmr> "obviously": some of us have never used D in depth :p
[19:21:50] *** Joins: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[19:21:52] <SiegeLord> Well yes... skip that word
[19:22:41] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[19:22:56] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[19:23:09] *** Joins: jvshahid (jvshahid@moz-53774307.nycm.ny.megapath.net)
[19:23:15] *** Joins: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net)
[19:23:22] *** Quits: srpablo (Mibbit@moz-4B1F7E74.hsd1.nj.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:24:53] *** jorendorff is now known as jorendorff_away
[19:28:11] *** Joins: valenting (Thunderbir@6F630D40.173A6960.FB866788.IP)
[19:28:51] *** Quits: icebattle (icebattle@8A14A542.EBE2EE2B.C7CEC4ED.IP) (Quit: Leaving)
[19:29:05] *** Joins: icebattle (icebattle@8A14A542.EBE2EE2B.C7CEC4ED.IP)
[19:30:31] *** Joins: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com)
[19:30:35] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[19:31:11] *** Joins: echristo (echristo@B3AA7BA8.D6CCE4AE.77834EAA.IP)
[19:32:33] <sfackler> engla: ping
[19:35:13] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[19:36:33] *** Quits: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo)
[19:38:23] *** Joins: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu)
[19:38:27] *** Joins: fyolnish (fyolnish@moz-AF352EA2.uqwimax.jp)
[19:40:06] *** Quits: matt-r (mattr@8B499E37.E81D922B.BECC6F7D.IP) (Ping timeout)
[19:40:15] *** Quits: fyolnish (fyolnish@moz-AF352EA2.uqwimax.jp) (Ping timeout)
[19:40:22] *** Joins: matt-r (mattr@8B499E37.E81D922B.BECC6F7D.IP)
[19:42:40] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[19:43:10] *** Quits: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com) (Connection reset by peer)
[19:44:00] *** Joins: doomlord_ (servitor@moz-4625DF14.range86-184.btcentralplus.com)
[19:45:19] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[19:45:26] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[19:48:08] *** Quits: maxiepoo (Max@moz-FFD7044A.nuwlan.northwestern.edu) (Quit: maxiepoo)
[19:49:51] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[19:50:13] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[19:50:30] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[19:52:19] <erickt> It sure is quiet today on #rust
[19:52:43] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:55:10] *** Joins: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP)
[19:55:10] *** ChanServ sets mode: +ao dherman dherman
[19:56:09] <erickt> since it's already pretty quiet... how crazy do you all think it'd be for us to allow regular fns to infer the return type? I've been experimenting with converting serialize.rs over to iterators. It turns out it's pretty easy to use with iterator chaining, but I'm not sure if I can make a syntax extension to auto impl Decodable/Encodable because the return type for chained iterators is insane
[19:57:02] <cmr> erickt: I don't think it's a very good idea since it makes it easy to break ABI
[19:57:30] <erickt> cmr: auto-inferring the return type?
[19:57:39] <benh> I've ran into the iterator return types before and sympathize ;)
[19:58:01] <cmr> erickt: yes
[19:58:42] <SiegeLord> It seems like it's sort of a documentation nightmare...
[19:59:19] <strcat> it's a code reading nightmare for sure
[19:59:50] <strcat> we would need a way to deal with it for returning unboxed closures if we ever got them
[19:59:57] <strcat> that's why C++14 has return type inference
[20:00:11] <strcat> there could be alternative solutions to that specific issue
[20:00:13] <cmr> that's -> decltype(auto), right?
[20:00:16] <cmr> (In C++)
[20:00:24] <strcat> yes
[20:00:33] <strcat> it's possible there's another form of it though
[20:01:05] <erickt> generators would be perfect for my purpose. Or having the ability to pack my iterator into a ~Iterator, but unfortunately the T in Iterator<T> in my case contains a 'self lifetime and I haven't figured out how make that work
[20:01:05] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Connection reset by peer)
[20:01:08] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[20:01:28] <strcat> erickt: ~Iterator is going to be surprisingly slow, though
[20:01:49] <cmr> strcat: Do we do any devirtualization?
[20:01:52] <strcat> ~1000x slower for a simple loop over a vector based on the benchmark before
[20:01:58] <strcat> cmr: we don't optimize in the frontend
[20:02:04] <SiegeLord> Can you do something like... fn foo<T: Func>() -> T ?
[20:02:10] <cmr> SiegeLord: yes
[20:02:15] <strcat> and in practice, devirtualization never happens
[20:02:19] <strcat> even when the compiler tries to do it
[20:02:25] <strcat> it's not a realistic optimization
[20:02:33] <cmr> ok
[20:02:34] <SiegeLord> But you'd have to specify the T at call-site, right?
[20:02:35] <strcat> using trait objects -> you are making virtual function calls
[20:02:47] <strcat> using rust's boxed closures -> it's likely you are making virtual calls, but sometimes they go away
[20:03:07] <strcat> (they hurt performance even if they go away, because they go away too late)
[20:03:09] <cmr> SiegeLord: yes.
[20:03:19] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Ping timeout)
[20:03:37] <cmr> SiegeLord: Inference works for that, but it's not an ABI concern since it's not even a function: it's AST included in metadata that is monomorphized at executable compile-time
[20:03:56] *** Joins: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net)
[20:04:33] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[20:04:54] <SiegeLord> Hmm, ok... just thinking about C++ closures... I guess there may be a better solution
[20:06:04] *** Quits: Jesin (Jessin_@moz-5C1F7BD2.res.lehigh.edu) (Quit: Leaving)
[20:07:05] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Quit: Leaving)
[20:09:06] <erickt> cmr: I'm not completely sold on the ABI concern. We're leaking iterator internals right now when we return them, inferring the return type wouldn't change that
[20:09:35] *** Joins: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[20:09:44] <cmr> erickt: right, but it will let you change your return without letting you modify the the signature
[20:09:48] <cmr> to me, that's a huge nono
[20:10:33] *** Quits: q66__ (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[20:10:45] <erickt> well the signature does change, just not the source code of the signature ;)
[20:11:07] <erickt> doc wise rustdoc could print out the inferred type
[20:11:14] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[20:12:59] *** Quits: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP) (Ping timeout)
[20:12:59] <SiegeLord> Can you return nested structs?
[20:13:12] *** Joins: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP)
[20:14:21] <SiegeLord> I.e. structs defined inside the function
[20:14:30] *** Joins: maxiepoo (Max@moz-DEDB4821.nuwlan.northwestern.edu)
[20:15:13] <erickt> SiegeLord: I don't believe so
[20:15:58] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[20:17:22] <erickt> do we have a typeof operator? If so, I could do something crazy like `type T = typeof({ let x = [1,2,3]; let y = [4,5,6]; x.iter().chain(y.iter()) })`
[20:17:33] <cmr> erickt: we do not, unfortunately
[20:17:54] *** Joins: Florob (Florob@moz-39532932.de)
[20:18:57] <erickt> cmr: actually we might. I see in libsyntax::parse::parser reference to a ty_typeof type
[20:19:53] *** Quits: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP) (Ping timeout)
[20:20:00] *** Joins: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP)
[20:20:38] *** Joins: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru)
[20:20:45] <erickt> shucks! `error: internal compiler error: typeof is reserved but unimplemented`
[20:20:48] *** Joins: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[20:21:04] *** Joins: Kruppe (user@moz-797F290.net.uwaterloo.ca)
[20:21:23] *** jorendorff_away is now known as jorendorff
[20:21:38] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[20:21:42] *** Joins: squiddy (squiddy@moz-CB783B19.adsl.alicedsl.de)
[20:23:03] *** Joins: squiddy_ (squiddy@moz-21A767E.adsl.alicedsl.de)
[20:23:30] *** Quits: squiddy (squiddy@moz-CB783B19.adsl.alicedsl.de) (Ping timeout)
[20:23:34] *** Quits: Ms2ger (Ms2ger@45E56866.3CF91143.187A1082.IP) (Quit: nn)
[20:24:53] *** Quits: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP) (Ping timeout)
[20:24:53] *** Quits: alonlevy (alon@moz-B0E66DB7.static.bezeqint.net) (Ping timeout)
[20:25:20] *** Joins: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP)
[20:25:52] *** Quits: g3orge (g3orge@moz-369F78A7.access.hol.gr) (Quit: leaving)
[20:26:03] *** Joins: squiddy__ (squiddy@moz-63452334.adsl.alicedsl.de)
[20:26:18] *** Quits: osa1 (uid13910@moz-5F4AA75A.irccloud.com) (Quit: )
[20:26:29] *** Quits: squiddy_ (squiddy@moz-21A767E.adsl.alicedsl.de) (Ping timeout)
[20:26:46] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[20:27:02] *** Quits: fabiand (fabiand@moz-A34DA49D.adsl.alicedsl.de) (Quit: Verlassend)
[20:27:51] *** Joins: squiddy_ (squiddy@moz-A474DF5A.adsl.alicedsl.de)
[20:28:22] *** Quits: squiddy__ (squiddy@moz-63452334.adsl.alicedsl.de) (Ping timeout)
[20:28:22] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:29:03] *** Quits: japaric (japaric@FEDDDB01.42146A62.CBF5D49D.IP) (Ping timeout)
[20:31:09] *** Quits: dredozubov (dredozubov@moz-1E374954.nationalcablenetworks.ru) (Quit: Leaving...)
[20:31:23] *** Quits: Kruppe (user@moz-797F290.net.uwaterloo.ca) (Ping timeout)
[20:32:36] *** Joins: squiddy__ (squiddy@moz-12480845.adsl.alicedsl.de)
[20:32:53] *** Quits: squiddy_ (squiddy@moz-A474DF5A.adsl.alicedsl.de) (Ping timeout)
[20:33:40] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[20:34:55] *** Quits: moostik (Icedove@DEF0989.ED71B4E7.BCDF592F.IP) (Ping timeout)
[20:36:33] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[20:39:01] *** Joins: fyolnish (fyolnish@moz-8A2BE74F.uqwimax.jp)
[20:39:14] *** Joins: squiddy_ (squiddy@moz-34C2DEF8.adsl.alicedsl.de)
[20:39:46] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[20:39:52] *** Quits: squiddy__ (squiddy@moz-12480845.adsl.alicedsl.de) (Ping timeout)
[20:40:10] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[20:40:46] *** Quits: fyolnish (fyolnish@moz-8A2BE74F.uqwimax.jp) (Ping timeout)
[20:41:19] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[20:41:40] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[20:42:06] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[20:42:08] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[20:42:10] *** Joins: squiddy__ (squiddy@moz-64B88417.adsl.alicedsl.de)
[20:42:26] *** Quits: squiddy_ (squiddy@moz-34C2DEF8.adsl.alicedsl.de) (Ping timeout)
[20:43:05] <erickt> I filed an RFC about return type deduction here: https://github.com/mozilla/rust/issues/10448
[20:43:14] <cmr> cool
[20:43:14] <erickt> feel free to add more pros/cons to it :)
[20:43:18] <cmr> RFC is good
[20:43:29] <strcat> we have a lot of open RFCs though
[20:43:38] <strcat> and they don't really have any discussion and stay open forever
[20:44:07] <erickt> off for lunch, back in a bit
[20:44:25] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[20:45:04] <bstrie> erickt: would the plan to allow _ in type hints to allow for partial type inference alleviate the need for this RFC?
[20:45:34] <bstrie> i.e. let x: Option<_> = Some(function_with_weird_return_type())
[20:45:36] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[20:46:07] <SiegeLord> I think that since there is this nebulous plan to add C++-style closures, then the solution should address that use as well
[20:46:28] <strcat> SiegeLord: it's not the only solution to that though
[20:46:34] <strcat> I was wrong
[20:46:37] *** Joins: squiddy_ (squiddy@moz-577AE36E.adsl.alicedsl.de)
[20:46:39] <strcat> C++ does it that way because it's C++
[20:46:39] <bstrie> does C++ have once fns?
[20:46:45] <strcat> it doesn't need once fns
[20:46:52] *** Quits: squiddy__ (squiddy@moz-64B88417.adsl.alicedsl.de) (Ping timeout)
[20:46:59] <SiegeLord> Right, that's what I'm saying... the alternative solutions might work for this case too
[20:47:00] <strcat> it doesn't have restrictions on what you can do
[20:47:08] <strcat> if it's safe, you can do it in C++
[20:47:27] <strcat> the compiler doesn't have to analyze it and decide it's safe, it just has to not be defined as undefined behaviour
[20:47:31] <SiegeLord> I'd love to see what the alternative solutions look like though
[20:48:06] <strcat> SiegeLord: you just let people return unboxed closures, as the return type
[20:48:15] <SiegeLord> Just doing fn() -> auto seems to me a leap into write-only code
[20:48:33] <strcat> and teach it to infer a different type per call
[20:48:42] <strcat> like it already does for each closure itself
[20:48:43] <SiegeLord> strcat: How would you write that type though?
[20:49:00] <strcat> fn foo<T: fn(int, int)>() -> T {}
[20:49:01] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[20:49:08] <strcat> er
[20:49:22] <strcat> eranyway yes
[20:49:25] *** Quits: infynyxx_ (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[20:49:29] <strcat> it's a type inference issue
[20:49:54] <SiegeLord> Right, that's exactly what I proposed a bit earlier... and I think it'd be relatively ok in other uses too
[20:50:19] <eddyb> err, you mean Fn<(), int, int>
[20:50:19] <strcat> so it's essentially a restricted form of the general inference
[20:50:24] <eddyb> (or Callable)
[20:50:38] <strcat> eddyb: no, I mean a fn trait-like thing that's part of the type system
[20:50:57] <strcat> it has to be part of the type system to have unboxed closures
[20:51:08] <strcat> it could be a lang item but it would be a pain
[20:51:13] <strcat> because there are no variadic generics
[20:51:14] *** Joins: squiddy__ (squiddy@moz-9C525B7D.adsl.alicedsl.de)
[20:51:25] *** Quits: squiddy_ (squiddy@moz-577AE36E.adsl.alicedsl.de) (Ping timeout)
[20:52:32] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[20:53:29] <eddyb> strcat: you can choose to solve the right problem :D
[20:53:50] *** Joins: Shikotan (kvirc@DB08BC8B.200216AA.E9D0DC51.IP)
[20:54:11] *** Joins: squiddy_ (squiddy@moz-3504313.adsl.alicedsl.de)
[20:54:24] *** Quits: squiddy__ (squiddy@moz-9C525B7D.adsl.alicedsl.de) (Ping timeout)
[20:54:45] *** Quits: Shikotan (kvirc@DB08BC8B.200216AA.E9D0DC51.IP) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[20:56:42] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[20:56:49] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[20:57:06] *** Joins: pnkfelix (pnkfelix@moz-43495417.fbx.proxad.net)
[20:57:06] *** ChanServ sets mode: +o pnkfelix
[20:57:48] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[20:58:57] *** Quits: squiddy_ (squiddy@moz-3504313.adsl.alicedsl.de) (Ping timeout)
[20:59:11] *** Quits: Jackneill (Jackneill@moz-805F9566.pool.digikabel.hu) (Input/output error)
[20:59:26] *** Joins: squiddy (squiddy@moz-B6B9C896.adsl.alicedsl.de)
[20:59:59] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Ping timeout)
[21:03:22] *** Joins: squiddy_ (squiddy@moz-846E7620.adsl.alicedsl.de)
[21:03:31] *** Quits: squiddy (squiddy@moz-B6B9C896.adsl.alicedsl.de) (Ping timeout)
[21:03:39] *** Quits: maxiepoo (Max@moz-DEDB4821.nuwlan.northwestern.edu) (Quit: maxiepoo)
[21:04:57] <mark_edward> is there a standardized interface for digests in Rust, as in Go/Pythin>
[21:05:00] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[21:05:22] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[21:06:28] <bstrie> mark_edward: not that I know of, doesn't seem like it would be too hard to make though
[21:06:54] <bstrie> assuming that we can dig up an md5 implementation somewhere
[21:06:56] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:07:16] <bstrie> as a proof of concept
[21:07:59] *** Quits: squiddy_ (squiddy@moz-846E7620.adsl.alicedsl.de) (Ping timeout)
[21:09:03] <dcrewi> they used to be in libextra, but now live here: https://github.com/DaGenix/rust-crypto
[21:09:52] *** Quits: sweet_kid (Upasana@EA1B4F4D.9254DCFF.1228A288.IP) (Quit: Leaving)
[21:11:04] <mark_edward> dcrewi: i have a basic implementation of Keccak here: https://github.com/MarkJr94/rust-keccak would it be of any use? it's not too performant yet
[21:11:33] <bstrie> mark_edward: are you like a world-renowned crypto expert
[21:11:37] <bstrie> (please say yes)
[21:11:56] *** Quits: eddyb (eddy@336E3A7F.D51DAF03.FB866788.IP) (Ping timeout)
[21:11:58] *** Joins: CarpNet (Alasdair@moz-25C796BC.cable.virginm.net)
[21:12:06] <mark_edward> nope! just ported code from C. i'm sure there's at least 50 timing attacks possible
[21:12:24] <mark_edward> it's all safe code, if that helps
[21:13:28] <bstrie> not against timing attacks, it doesn't :P
[21:13:36] <dcrewi> mark_edward: I'm not the one to ask
[21:13:37] <mimcpher> hash functions are usually a little less important to defend against timing attacks though
[21:13:55] <mark_edward> also it needs updating to track rust-master
[21:14:11] <strcat> mimcpher: they aren't just used for hashing
[21:14:16] <strcat> they are primitives used elsewhere
[21:14:20] <mimcpher> strcat: of course
[21:14:30] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[21:14:33] *** Joins: JamesNZ (james@moz-264643C7.bitstream.orcon.net.nz)
[21:14:39] <mark_edward> dcrewi: is it useful at all as a starting point at least?
[21:14:41] <strcat> we don't have stuff like volatile so it would be hard to even pretend you wrote something to be secure against timing attacks
[21:14:42] <mimcpher> But I'm not sure I've seen a practical exploit using timing of a hash function
[21:14:44] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:15:11] <mimcpher> (But then, why lower the bar if we don't have to?)
[21:15:20] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:15:40] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[21:16:30] *** Quits: huseby (huseby@moz-30056280.clients.your-server.de) (Broken pipe)
[21:16:44] <mimcpher> keccak is a pretty sweet construction though.  Now I want to try and implement somthing using this, and then exploit it :)
[21:17:32] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[21:17:52] <strcat> I think a lot of it has to do with the design of the algorithm anyway (table lookups are bad)
[21:18:02] *** Joins: tjc (tjc@moz-BBE3ABD.mv.mozilla.com)
[21:18:02] *** ChanServ sets mode: +o tjc
[21:19:01] <mimcpher> AES in particular was easy to do in a way that permitted cache timing attacks from table lookups
[21:19:39] <mark_edward> keccak has a lot of table lookup
[21:19:39] *** Joins: huseby (huseby@moz-52B306B9.chrismail.de)
[21:19:51] <strcat> table lookups generally mean it is totally vulnerable to timing attacks
[21:19:59] <strcat> modern ciphers try to avoid it afaik
[21:20:27] <mimcpher> Well, you just have to do your lookups linearily
[21:20:37] <mimcpher> Or making sure you hit all the cache lines the same way
[21:20:57] <mimcpher> Which, of course, is a pain for performance
[21:21:01] <mark_edward> my code is almost a 1-1 translation of the reference code
[21:21:14] <mark_edward> do you think the reference code would've been insecure?
[21:21:30] <strcat> mimcpher: branch prediction matters too, can't have any branches on secrets
[21:21:57] <mimcpher> strcat: Yeah, that's one thing that I have *no idea* how to prevent against in rust code
[21:22:03] <strcat> mark_edward: where was the reference from?
[21:22:12] <strcat> mimcpher: well, use algorithms not vulnerable to timing attacks
[21:22:19] <strcat> (salsa20/chacha20, siphash)
[21:22:36] <strcat> they don't use branches on secrets and don't rely on tables for performance
[21:22:59] *** Quits: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP) (Ping timeout)
[21:23:00] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:23:03] <strcat> ofc if you don't control the algorithm you need to use you're screwed I guess
[21:23:10] *** Joins: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP)
[21:23:27] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[21:23:27] * strcat wishes our RNG was chacha20
[21:23:32] <strcat> it'd be so fast! ;p
[21:24:20] * pcmattman 's RNG of choice: http://xkcd.com/221/
[21:24:21] <mark_edward> strcat: from here http://keccak.noekeon.org/files.html i can't tell which version offhand though. it was post 3.0 i know that
[21:24:56] <strcat> well, just from that page I assume it is vulnerable
[21:25:01] <strcat> 'Against cache-timing attacks, the most efficient implementations involve no table lookups. Against power analysis attacks and variants, countermeasures can take advantage of the quadratic round function.'
[21:25:25] <strcat> it's one of those algorithms "cheating" for performance by using insecure techniques :)
[21:25:32] <mark_edward> :(
[21:25:52] <strcat> they'll say it can be secure from timing attacks but I'm sure they used the insecure implementations for all the benchmarks leading to it being accepted as SHA3
[21:26:15] <strcat> NIST is a joke anyway, they allowed algorithms to be compromised by the NSA
[21:26:18] <sfackler> I can't track it down, but I remember a blog post from a security guy working on fixing a timing attack in something (openssl maybe?) and they ended up finding that it was due in part to the fact that the speed of IDIV depends on the magnitude of one of the arguments
[21:26:31] <strcat> they probably picked the algorithm most vulnerable to timing attacks ;p
[21:26:38] <mimcpher> I have some friends who work for five eyes type people, and they seem pretty enthusiastic about Keccak :P
[21:27:01] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[21:27:59] *** Quits: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP) (Ping timeout)
[21:28:00] *** Quits: avsej (avsej@D9A610B8.4841F515.FB33447D.IP) (Client exited)
[21:28:05] *** Joins: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP)
[21:28:20] <mark_edward> https://github.com/gvanas/KeccakCodePackage/blob/master/KeccakF-1600/Optimized/KeccakF-1600-64.macros
[21:28:25] *** Quits: victorporof (victorporo@9B024C76.73B1E539.9B1E38F4.IP) (Client exited)
[21:28:41] <mark_edward> how i wish C was not the language of choice for systems things
[21:28:51] <JamesNZ> Sorry if this is an oft-asked question, but is there a roadmap showing approximately when rust 1.0 will be released (i.e a stable release)?
[21:29:20] <mark_edward> strcat: how do i allow missing doc stuff?
[21:29:24] <strcat> JamesNZ: no
[21:29:39] <strcat> mark_edward: #[allow(missing_doc)], but everything new in the stdlib should have docs
[21:29:44] <bstrie> JamesNZ: the "backcompat" tags on the issue tracker can give you some indication, though https://github.com/mozilla/rust/issues?labels=&milestone=&page=1&state=open
[21:29:45] <JamesNZ> strcat: Ok, thanks.
[21:29:53] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:30:00] <strcat> bstrie: at least the lang backcompat ones
[21:30:02] <strcat> not really the lib ones
[21:30:13] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:30:27] <bstrie> JamesNZ: "sometime next year" is our vague current target :)
[21:30:42] <mark_edward> strcat: well i have some stuff that is marked `pub` but it's not exposed to the outside world, it's just lowlevel stuff that i need accessible to a higher levell wrapper
[21:31:03] <JamesNZ> bstrie: Sweet :)
[21:31:07] *** Quits: Blub\w (wry@moz-8EE7A167.wireless.dyn.drei.com) (Quit: bb2m)
[21:31:13] *** Joins: refold (gman@moz-42D68426.a258.priv.bahnhof.se)
[21:31:15] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[21:31:21] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:31:55] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[21:32:56] *** Joins: icarot (yaaic@moz-C92E6072.wavecable.com)
[21:34:53] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[21:35:06] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[21:35:53] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Client exited)
[21:36:14] *** Joins: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP)
[21:37:28] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:37:47] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Ping timeout)
[21:37:58] *** Quits: samnardoni (samnardoni@FC9A45BE.3393236F.BFD1ABFD.IP) (Ping timeout)
[21:38:36] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[21:40:43] <erickt> bstrie: I was thinking `_` would work out really well for a type inference hint
[21:41:20] <dcrewi> mark_edward: could you show me?
[21:41:33] <dbaupp> cmr: I thought I pushed by exit status fix already... ?
[21:41:39] <dbaupp> *my
[21:42:51] <mark_edward> dcrewi: most of the code is here: https://github.com/MarkJr94/rust-keccak/blob/master/reference.rs and here: https://github.com/MarkJr94/rust-keccak/blob/master/sponge.rs
[21:43:35] <bstrie> erickt: I believe that the devs have already agreed to add something like that
[21:44:55] <erickt> bstrie: I know nmatsakis has mentioned using _ in the typarams and types inside a fn, but I'm not sure if I've seen anyone mentioning `fn foo() -> _ { 5 }`
[21:45:42] *** Quits: unbracketed (textual@moz-DD541BA.lsanca.fios.verizon.net) (Quit: Computer has gone to sleep.)
[21:45:52] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[21:46:04] <bstrie> I haven't seen anything about return types, no
[21:46:12] <bstrie> that actually seems a bit hazardous
[21:46:56] <erickt> bstrie: I have an RFC for this, want to add any comments here? https://github.com/mozilla/rust/issues/10448
[21:47:01] <bstrie> the reason why I like our implicit-return-without-semicolon rule is because we require return types
[21:47:14] <bstrie> so that catches the error when you just happen to forget the semicolon
[21:49:00] <erickt> bstrie: that's a reasonable point. Perhaps the main advantage of return type deduction would be for returning iterators.
[21:49:11] *** Joins: Kingsley (kingsley@9B172CBE.BEA5C56D.DF4B730F.IP)
[21:49:29] *** Joins: fyolnish (fyolnish@moz-495C7AA.uqwimax.jp)
[21:49:31] <bstrie> erickt: your code example there doesn't really do anything with return types
[21:50:09] <bstrie> if the functions was going to return `iter`, I presume that allowing _ for partial type inference would only require you to write `fn foo() -> Chain<_>`
[21:50:10] <erickt> if we had generators it would eliminate my (current) argument for return type deduction
[21:50:20] <bstrie> assuming that we allow such things in function signatures
[21:50:52] <bstrie> erickt: well the plan is to have generators, eventually :P
[21:51:09] *** Quits: fyolnish (fyolnish@moz-495C7AA.uqwimax.jp) (Ping timeout)
[21:51:14] *** Quits: spider-mario (spidermari@moz-2F72F6FF.dsl.quantic-telecom.net) (Input/output error)
[21:51:25] <bstrie> even if "eventually" is "once a bunch of microsoft patents expire"
[21:51:25] <nmatsakis> bstrie: I had not planned to allow `_` in argument or return types
[21:51:32] <bstrie> nmatsakis: that's fair
[21:51:34] <nmatsakis> bstrie:  or at least not to take the place of a type
[21:51:35] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[21:52:10] *** Joins: tulloch (tulloch@moz-99B7EB8.nat.csx.cam.ac.uk)
[21:52:49] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[21:55:42] *** Joins: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp)
[21:55:54] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[21:56:19] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[21:56:33] *** Quits: Diamond (dick@moz-80556682.ks.ks.cox.net) (Quit: Leaving.)
[22:02:03] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:02:24] *** Joins: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com)
[22:03:12] *** Quits: tetsuharu (tetsuharu@moz-A3FEAA56.ap219.ftth.ucom.ne.jp) (Quit: )
[22:05:12] *** Joins: eddyb9 (eddy@336E3A7F.D51DAF03.FB866788.IP)
[22:06:36] *** Quits: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com) (Quit: Jesse_)
[22:08:39] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[22:11:32] *** Joins: jfb (jfb@2ABF3B40.D6CCE4AE.77834EAA.IP)
[22:12:13] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[22:12:14] *** Quits: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp) (Ping timeout)
[22:12:18] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[22:12:47] *** Joins: nattofriends (tsutsumi@moz-A9E340E1.fuqu.jp)
[22:13:45] *** Joins: wikkit (Mibbit@moz-B234C23B.rev.numericable.fr)
[22:14:16] *** Joins: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr)
[22:15:30] *** Quits: tulloch (tulloch@moz-99B7EB8.nat.csx.cam.ac.uk) (Ping timeout)
[22:15:52] *** Joins: nejucomo (Adium@moz-C07D5168.p2p.sfo1.mozilla.com)
[22:15:53] *** Joins: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk)
[22:17:02] <wikkit> hi everyone!
[22:17:11] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[22:17:25] <wikkit> stupid question: how do you convert from ~str to [u8]?
[22:17:29] *** Quits: canhtak (canhtak@moz-24D0A1FD.wl.t.ulaval.ca) (Quit: canhtak)
[22:17:48] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[22:18:04] <wikkit> I found the std::str::from_utf8 function, but how do I do the opposite ?
[22:18:12] <wikkit> I found the std:: str::from_utf8 function, but how do I do the opposite ?
[22:18:18] <Luqman> wikkit: one of {to,as,into}_bytes()
[22:18:47] <Luqman> i.e "my string".to_bytes()
[22:19:17] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:19:33] <wikkit> seems simple... but I'm confused, I can't find this in the docs
[22:20:55] <Luqman> wikkit: er, sorry
[22:20:59] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[22:21:01] <Luqman> there is no to_bytes
[22:21:06] <Luqman> just as_bytes or into_bytes
[22:21:20] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[22:22:09] <Luqman> wikkit: as for where to find it, as_bytes is listed under the StrSlice trait while into_bytes is under the OwnedStr trait
[22:22:10] <tikue_> wikkit: the docs currently do a poor job of the builtin types
[22:22:31] <wikkit> ok thx very much it works!
[22:22:47] <tikue_> unless they're part of a trait -- which this one actually is, as Luman points out -- methods on builtin types are tricky to hunt down
[22:22:54] <wikkit> my bad, I didn't look into the StrSlice
[22:23:11] <tikue_> rather, part of a trait in the corresponding module you'd expect. str in this case
[22:23:11] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Ping timeout)
[22:23:21] *** Quits: Earnestly (earnest@38FE72A5.82423D8F.BFD1ABFD.IP) (Ping timeout)
[22:23:35] <tikue_> one I've found particularly challenging is tracking down the len() method on ~[]. 
[22:23:50] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[22:23:55] <tikue_> because it's implemented as part of the Container trait which doesn't live in the vec module
[22:27:13] *** Quits: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP) (Quit: dherman)
[22:27:42] *** Quits: lmandel (lmandel@13F2CEC5.7672369.D8E68FF6.IP) (Quit: lmandel)
[22:27:58] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Connection reset by peer)
[22:28:21] <wikkit> yes: it also works on ~str, but I can't find any reference to len(), or Container for str!
[22:28:35] *** Joins: mikezaby (mikezaby@moz-AA896205.home.otenet.gr)
[22:29:14] *** Joins: jgilbert (jgilbert@moz-4C088FCE.hsd1.ca.comcast.net)
[22:31:40] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Client exited)
[22:32:00] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[22:32:29] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[22:33:48] *** Quits: willingc (willingc@moz-B4760708.san.res.rr.com) (Ping timeout)
[22:33:55] *** Joins: geoffhill (geoffhill@moz-738DC0DB.org)
[22:34:10] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[22:34:23] *** Joins: dg (dg@moz-AF6F3E94.com)
[22:36:00] *** Quits: tulloch (tulloch@moz-1C33A2E7.nat.csx.cam.ac.uk) (Ping timeout)
[22:37:03] *** Joins: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk)
[22:37:18] *** Joins: berleon (leon@moz-BF3525A1.superkabel.de)
[22:37:27] *** Joins: Jesse (jruderman@moz-9754CB0.hsd1.ca.comcast.net)
[22:38:23] <dbaupp> wikkit: you can see it listed here: http://static.rust-lang.org/doc/master/std/container/trait.Container.html
[22:39:10] <wikkit> yes I saw that one
[22:39:55] <wikkit> but I can't find the link between str and the Container trait
[22:42:05] *** Joins: willingc (willingc@moz-B4760708.san.res.rr.com)
[22:42:19] <sfackler> the docs don't currently work very well with built in types like str, uint, etc
[22:42:30] *** Quits: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net) (Quit: bholley)
[22:42:41] <sfackler> that link would normally be located on the page for the type Container is implemented for, but that doesn't exist for str
[22:43:28] *** Joins: ktt3ja (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net)
[22:43:39] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[22:44:20] <dbaupp> wikkit: the "link" is at the bottom `impl<'self> Container for &'self str` etc (unfortunately, that's the only place in the whole docs that it's mentioned)
[22:45:32] <wikkit> ok I see now
[22:45:46] <wikkit> I was expecting to see that under str, or a trait in str
[22:46:15] *** Joins: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net)
[22:47:15] *** Joins: japaric (japaric@C9DBF810.55B992BD.5C7588CA.IP)
[22:47:27] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[22:48:10] <erickt> wikkit: do you actually want a [u8], or do you want a c-style string?
[22:49:03] <dbaupp> wikkit: fwiw, the module "std::str" has no direct connection to the type str, it's just where we put string related things (and it just so happens to have been given the same name).
[22:49:45] <dbaupp> wikkit: the correct solution would be to make the type `str` (partially) defined in the library, like e.g. Option or Result. (which do have sensible docs about trait impls)
[22:50:30] <strcat> strings could be fully defined in the stdlib
[22:50:33] <strcat> the language only needs slices
[22:50:49] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[22:51:01] *** Joins: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP)
[22:51:01] *** ChanServ sets mode: +ao dherman dherman
[22:51:36] <dbaupp> strcat: ~"foo"?
[22:51:39] *** jorendorff is now known as jorendorff_away
[22:52:33] <ktt3ja> what would ast::ExprCall be?
[22:52:45] <o11c> syntactic sugar for ~str(['f', 'o', 'o']) 
[22:52:58] <dbaupp> ktt3ja: <expr>(<expr>, <expr>)
[22:53:04] <dbaupp> ktt3ja: i.e. a function call
[22:53:17] <dbaupp> ktt3ja: (I hope you're adding doc comments to these variants :) )
[22:53:21] <erickt> bstrie: the other argument for a `_` return type argument is that it can simplify writing macros or syntax extensions. `typeof(expr)` can help in some circumstances, but I'm not sure if it can handle all cases
[22:53:35] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[22:53:40] <ktt3ja> if it's something like foo::bar(), would that be an ExprCall or ExprPath?
[22:53:45] <dbaupp> ktt3ja: both
[22:54:02] <dbaupp> ktt3ja: ExprPath == foo::bar, ExprCall = <path>()
[22:54:32] <erickt> bstrie: a partial return type of `Chain<_>` would also help
[22:54:35] <ktt3ja> oh
[22:54:35] *** Quits: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net) (Quit: bholley)
[22:54:40] *** Quits: lfox (lfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: ZZZzzz…)
[22:55:11] <dbaupp> erickt: surely it does handle all cases? `fn foo() -> typeof(<body of foo>) { <body of foo> }` would be exactly the same as inferring the return type?
[22:55:23] *** Joins: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net)
[22:55:32] *** Quits: bholley (anonymous@moz-FCAF9AAB.hsd1.ca.comcast.net) (Quit: bholley)
[22:56:27] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[22:56:34] <erickt> dbaupp: the problem is for methods. Should `-> typeof(<body of foo>)` have access to the priv members of a struct?
[22:57:22] <dbaupp> erickt: if the body of foo would normally have access: yes; if it wouldn't: no. (i.e. same privacy rules?); or are you talking about something more subtle?
[22:58:19] <erickt> dbaupp: probably not. I was thinking `struct Foo { priv x: ~[int] } impl Foo { fn foo(&self) -> typeof(self.x.iter()) { x.iter() }`
[22:59:02] <erickt> err, `{ self.x.iter() }`
[22:59:40] <dbaupp> erickt: aha; yeah, personally I'd think that's reasonable
[23:00:09] *** Joins: dew1 (Instantbir@moz-E4452B8F.static.stls.mo.charter.com)
[23:00:53] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:01:10] <erickt> dbaupp: I think so too. It'd be nasty enough for humans to avoid, but it'd be okay for code generators. I'll add it to the rfc
[23:01:22] *** Quits: dew (Instantbir@moz-E4452B8F.static.stls.mo.charter.com) (Ping timeout)
[23:01:23] *** Joins: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net)
[23:01:37] *** Quits: devbug (quassel@2D4E172D.4C8B6099.9B57EA59.IP) (Ping timeout)
[23:02:44] <dbaupp> return_type_infer!(fn foo_bar(x: int, y: int) -> _ { body }) might work, with some macro magic.
[23:03:10] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Ping timeout)
[23:03:10] <dbaupp> (i.e. the macro puts the appropriate things in the _)
[23:03:12] <erickt> dbaupp: unfortunately `typeof` doesn't yet work :( https://github.com/mozilla/rust/issues/3228
[23:04:00] <dbaupp> erickt: yeah (I was working in the hypothetical world in which it did work)
[23:04:18] *** Quits: mikezaby (mikezaby@moz-AA896205.home.otenet.gr) (Input/output error)
[23:04:59] *** Quits: simlay (simlay@moz-1C72F8DD.hsd1.ca.comcast.net) (Quit: Lost terminal)
[23:05:20] *** kimundi is now known as zz_kimundi
[23:05:33] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[23:05:37] *** Quits: lkuper (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Quit: lkuper)
[23:05:59] *** Quits: CarpNet (Alasdair@moz-25C796BC.cable.virginm.net) (Quit: Leaving)
[23:06:07] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[23:07:07] <erickt> dbaupp: added the `typeof` alternative to https://github.com/mozilla/rust/issues/10448
[23:09:16] <dbaupp> erickt: cool
[23:12:30] <erickt> ls
[23:12:33] <erickt> oops
[23:13:09] <dbaupp> . ..
[23:13:50] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[23:13:56] <erickt> ha
[23:14:13] <erickt> how did you know!?
[23:15:03] * dbaupp is a unix utility
[23:15:40] <erickt> man dbaupp
[23:16:07] <tjc> try man -k ;-)
[23:16:25] <strcat> dbaupp: why have ~"foo" but not the same thing for the other string types we'll have?
[23:16:28] <strcat> ropes, small strings
[23:16:58] * strcat would rather have generic string literals with &str as the fallback
[23:17:04] * dbaupp would too
[23:18:05] <strcat> and Str (for dynamically sized ones) could just be a generic wrapper around a vector-like type (vector, rope, small vector)
[23:18:23] <strcat> or at least type Str = String<Vec<u8>>
[23:19:09] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[23:19:26] <sp3d> that would be cool
[23:21:37] *** Joins: maxiepoo (Max@moz-6F50ADE.hsd1.il.comcast.net)
[23:22:48] *** Quits: Scriptor (anonymous@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:23:05] *** Joins: pcwalton (pcwalton@9C2E78E6.8C982E60.292610BC.IP)
[23:23:05] *** ChanServ sets mode: +ao pcwalton pcwalton
[23:27:17] *** Quits: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net) (Client exited)
[23:29:20] *** Joins: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net)
[23:29:31] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[23:30:54] *** Joins: brson (brson@9C2E78E6.8C982E60.292610BC.IP)
[23:30:54] *** ChanServ sets mode: +ao brson brson
[23:33:08] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Quit: Leaving...)
[23:33:33] *** Quits: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr) (Ping timeout)
[23:36:39] *** Quits: wilmoore (wilmoore@moz-7EE4D9D6.mystrotv.com) (Ping timeout)
[23:37:00] *** Parts: bran (bran@moz-AC832EC7.compute-1.amazonaws.com) ()
[23:38:08] *** Quits: pcwalton (pcwalton@9C2E78E6.8C982E60.292610BC.IP) (Quit: pcwalton)
[23:38:43] *** Joins: abnrngr (user@C31B7093.A9FCDC29.B3C843D.IP)
[23:39:03] *** Quits: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com) (Quit: brendan)
[23:40:59] *** Quits: jvshahid (jvshahid@moz-53774307.nycm.ny.megapath.net) (Ping timeout)
[23:42:17] *** Quits: abnrngr (user@C31B7093.A9FCDC29.B3C843D.IP) (Input/output error)
[23:43:01] *** Joins: admnor (random@moz-5A33CAF5.range86-169.btcentralplus.com)
[23:44:18] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[23:44:29] *** Joins: brendan (brendaneic@moz-BBE3ABD.mv.mozilla.com)
[23:44:31] *** Joins: jvshahid (jvshahid@moz-53774307.nycm.ny.megapath.net)
[23:44:42] <tjc> If anyone has a moment to review a quick rustpkg pull request: r? https://github.com/mozilla/rust/pull/10342
[23:46:15] *** Quits: brson (brson@9C2E78E6.8C982E60.292610BC.IP) (Ping timeout)
[23:47:18] *** Joins: moostik (Icedove@moz-4AD91EE4.w82-121.abo.wanadoo.fr)
[23:47:24] <cmr> tjc: on it
[23:47:33] *** Joins: abnrngr (user@C31B7093.A9FCDC29.B3C843D.IP)
[23:48:31] <tjc> cmr: thanks
[23:48:51] <erickt> cmr: too late! already r+'ed it
[23:48:55] <cmr> nooo
[23:48:57] <cmr> ok :)
[23:50:30] *** Joins: fyolnish (fyolnish@moz-D1D1A0A7.uqwimax.jp)
[23:51:03] <tjc> don't fight over it, I'll have more pull requests :-)
[23:51:13] <Luqman> with enough trawling over the openssl docs i got AES encryption over tcp working https://gist.github.com/luqmana/8a93b7ea349b732cbda0
[23:51:14] <tjc> thanks erickt
[23:51:21] <erickt> anytime
[23:52:02] *** Quits: dherman (dherman@9C2E78E6.8C982E60.292610BC.IP) (Quit: dherman)
[23:52:22] *** Quits: fyolnish (fyolnish@moz-D1D1A0A7.uqwimax.jp) (Ping timeout)
[23:53:01] *** Quits: wikkit (Mibbit@moz-B234C23B.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[23:53:29] *** Quits: ianj (ianjneu@moz-7140CF01.ccs.neu.edu) (Input/output error)
[23:56:09] *** Quits: tulloch (tulloch@moz-6809CC86.nat.csx.cam.ac.uk) (Ping timeout)
[23:56:31] *** Quits: jvshahid (jvshahid@moz-53774307.nycm.ny.megapath.net) (Ping timeout)
[23:56:31] *** Quits: valenting (Thunderbir@6F630D40.173A6960.FB866788.IP) (Ping timeout)
[23:56:45] *** Joins: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com)
[23:56:52] *** Joins: skeet70 (skeet70@moz-697F48F2.bzm-mt.client.bresnan.net)
[23:57:57] *** Joins: jvshahid (jvshahid@moz-53774307.nycm.ny.megapath.net)
[23:58:57] *** Joins: lfox (lfox@993C33BE.AE625458.ECED8BE3.IP)
[23:59:29] *** Joins: Skif_ (emschwar@moz-CA025D57.ip.mcleodusa.net)
[23:59:57] *** Quits: houzi (houzi@moz-4F6A1E26.getinternet.no) (Ping timeout)
