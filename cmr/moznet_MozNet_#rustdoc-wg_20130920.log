[00:01:28] <cmr> Seldaek: Hi, it's in the doc attr. Not a big deal.
[00:02:29] <cmr> acrichto: I think a light dotted underline for links would be fine.
[00:02:50] <acrichto> yeah I'd be ok with that
[00:02:55] <acrichto> although I'd still prefer them all the same color
[00:03:05] <acrichto> but I'm not super strongly opinioned about that
[00:03:07] <cmr> I like the color-coded-by-item-type
[00:03:26] <cmr> I can see why it'd be contentious though
[00:03:38] <cmr> And I don't care about it strongly either.
[00:05:10] <acrichto> yay apathy!
[00:05:33] <acrichto> hm ok so my rust version of rustdoc_web is getting to the point where "most things are there"
[00:05:43] <acrichto> the output is vastly different though
[00:05:58] <acrichto> but I'm wondering if I should merge rustdoc_web in node.js form, or power through this for another day or so
[00:08:20] <cmr> I think we should merge it
[00:08:33] <cmr> Get the rustdoc_ng docs as the official docs for trunk for a few days
[00:08:37] <cmr> meh
[00:08:39] <cmr> I don't know
[00:08:40] <acrichto> http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/
[00:08:50] <acrichto> it's going to be a lot of effort though
[00:08:50] <cmr> oh you're a CMU student?
[00:08:52] <cmr> Or was?
[00:08:53] <acrichto> merging rustdoc_web
[00:08:55] <cmr> *were
[00:08:55] <acrichto> I was
[00:08:58] <cmr> Yeah
[00:09:06] <cmr> CMU rejected me for undergrad :(
[00:09:09] <cmr> I don't blame them though
[00:09:10] <acrichto> :(
[00:09:24] <cmr> My hgih school transcript is... rocky
[00:11:00] <cmr> Hm
[00:11:08] <cmr> I think I prefer the summary at the top
[00:15:44] <acrichto> I took a few liberties when porting :)
[00:24:14] <acrichto> cmr: I'm not sure I ever ran this by you, but the way that I'm writing the rustdoc_web-rs port is that you'll invoke it as "rustdoc_ng html path/to/crate"
[00:24:25] <cmr> acrichto: you did, I approved.
[00:24:26] <acrichto> and you could otherwise run "rustdoc_ng json path/to/crate"
[00:24:28] <acrichto> ah cool
[00:24:31] <acrichto> just wanted to make sure :)
[00:24:57] <acrichto> plugins affecting the html with their json output could get tricky
[00:25:04] <acrichto> but plugins should still be able to modify the crate directly
[00:42:49] <acrichto> lol "no results, go try duckduckgo"
[01:27:30] <acrichto> cmr: x-crate references are missing generics I think
[01:27:39] <cmr> acrichto: example?
[01:28:05] <acrichto> Option<A>
[01:28:17] <acrichto> becomes External(~"std::option::Option", ~"enum")
[01:28:26] <acrichto> if it's not in libstd
[01:31:56] <acrichto> haha my super janky algorithm worked the first time for generating links between structs and things
[01:32:57] <cmr> acrichto: so the bug with external paths is that it uses a ~str rather than an actual Path
[01:34:06] <acrichto> is that just an implemntation thing or like rustc doesn't give you enough info?
[01:35:12] <cmr> Not sure, I'm checking now.
[01:35:17] <cmr> I get it from the metadata.
[01:35:39] <acrichto> surely it doesn't come out as ~str though?
[01:36:05] <cmr> let path = syntax::ast_map::path_to_str_with_sep(item_path(doc), "::", sess.intr())
[01:36:19] <acrichto> aha
[01:36:25] <acrichto> well not a big issue
[01:36:31] <cmr> So
[01:36:33] <cmr> Yeah
[01:36:35] <acrichto> these docs are mostly for libstd right off the bad
[01:36:36] <acrichto> bat*
[01:36:38] <cmr> metadata doesn't have the generics :\
[01:36:47] <acrichto> it should...
[01:36:54] <acrichto> something has the generics at least
[01:36:55] <cmr> Let me look further
[01:37:31] <cmr> item_ty_param_defs maybe?
[01:37:39] <cmr> I have no idea how to use metadata or what's in it, if you can't tell :P
[01:37:39] <acrichto> dunno :(
[01:37:43] <acrichto> lol
[01:37:50] <acrichto> I feel like that all the time with rustc
[01:37:57] <cmr> Yeah
[01:37:59] <cmr> So do I
[01:38:05] <cmr> libsyntax is actually fairly nice
[01:40:23] <cmr> I was stuck for like 3 days trying to solve an item
[01:40:30] <cmr> solve a metadata problem, that is
[01:40:43] <cmr> I accost pcwalton and he gives m e the answer in like 5 seconds.
[01:41:11] <acrichto> lol
[01:41:22] <acrichto> I suppose that's what happens when you write half the compier
[01:41:27] <acrichto> anyway, food now, brb
[03:09:38] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Leaving...)
[03:56:00] <acrichto> Seldaek: ping
[06:00:08] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[06:34:34] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Ping timeout)
[06:35:13] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[06:39:58] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[06:40:00] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[07:58:13] <Seldaek> acrichto: ?
[08:00:18] <Seldaek> acrichto: there are some things you might have overlooked in my implementation that makes it a bit nicer than your "rustdoc html path/" model
[08:01:20] <Seldaek> acrichto: given it lets you build multiple versions at once from the json files, if you do so you should have a dropdown show up on every doc page that allows you to quickly switch between versions for example
[08:01:44] <Seldaek> also it makes it possibly easier to build multiple crates at once, which is needed for cross-crate hyperlinks
[08:01:53] <Seldaek> not sure how rustdoc_ng works on multi-crate stuff
[08:01:55] <acrichto> yeah those two things I haven't tackled yet
[08:02:16] <acrichto> I'm not entirely sure how multiple versions will work, nor how cross-crate things will work
[08:02:32] <acrichto> one problem with cross-crate things is that all rustdoc_ng outputs is External(path, type)
[08:02:46] <acrichto> when what you want is some sort of "ResolvedPath"
[08:02:53] <Seldaek> yes, well not really
[08:03:22] <acrichto> ?
[08:03:36] <Seldaek> the way I handled it is this https://github.com/Seldaek/rustdoc_web/blob/master/rustdoc.js#L65
[08:03:43] <Seldaek> it has "known crates" urls
[08:03:53] <Seldaek> and if it gets an External thing that has a path in that crate
[08:03:55] <acrichto> I was hoping to avoid that
[08:03:56] <Seldaek> it just generates a link for it
[08:04:07] <Seldaek> why that? and how? :)
[08:04:14] <acrichto> yeah how is hard
[08:04:17] <acrichto> not entirely sure
[08:04:23] <Seldaek> also see https://github.com/Seldaek/rustdoc_web/blob/master/rustdoc.js#L348
[08:04:29] <acrichto> but hard-coding things isn't always the best
[08:04:41] <Seldaek> it's not hardcoded it's configurable in the json too
[08:04:46] <acrichto> Seldaek: that ignores things like typarams and lifetimes though
[08:04:53] <acrichto> like Option is useless cross-crate
[08:05:09] <Seldaek> not sure why
[08:05:16] <Seldaek> isn't Option usually Option<Foo>
[08:05:28] <Seldaek> then you have a link on Option to std/.. and Foo will be a link to wherever it makes sense
[08:05:32] <acrichto> rustdoc_web in the node js form I don't think puts typarams at all anywhere
[08:05:46] <Seldaek> eh?
[08:06:07] <Seldaek> yes it does
[08:06:09] <Seldaek> or it did
[08:06:18] <acrichto> http://seld.be/rustdoc/master/std/option/enum.Option.html
[08:06:22] <acrichto> look at all the return values
[08:06:26] <acrichto> it's all "Option"
[08:06:45] <Seldaek> might be a new bug somewhere
[08:06:45] <acrichto> as opposed to http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/option/enum.Option.html
[08:06:56] <Seldaek> but http://seld.be/rustdoc/master/std/rt/io/struct.IncomingIterator.html definitely has typarams & lifetimes
[08:07:11] <acrichto> not down below
[08:07:21] <acrichto> Acceptor/Iterator/Option all have typarams
[08:07:38] <Seldaek> well I call bug :)
[08:07:41] <Seldaek> pretty sure this worked
[08:07:49] <acrichto> yeah like it's not that bad at all
[08:07:52] <acrichto> I wouldn't worry about it
[08:07:59] <acrichto> I'm approaching done-ness with the rust version
[08:08:08] <acrichto> by tomorrow night I think I may have it 100% working
[08:08:20] <acrichto> although some things will be slightly different
[08:09:06] <Seldaek> I hope we can discuss those :)
[08:09:36] <acrichto> oh yeah
[08:09:42] <acrichto> I don't want many differences at all
[08:09:45] <acrichto> they should all be super minor
[08:10:10] <Seldaek> there was lots of planning and thinking and feedback that went into the whole thing, so please don't take too many liberties when porting the output at least without a good rationale
[08:10:35] <acrichto> oh yeah no don't worry :(
[08:10:38] <acrichto> :)*
[08:10:45] <Seldaek> but it's cool for now, you did awesome progress already 
[08:10:51] <acrichto> sorry if I sound like I'm re-doing everythig lol
[08:10:55] <acrichto> I'm definitely not
[08:10:58] <Seldaek> didn't expect this to be so fast
[08:11:06] <acrichto> 0.8's on the horizon!
[08:11:08] <Seldaek> but I don't know rust so well so it sounds scary to me
[08:11:20] <acrichto> it's all pretty similar
[08:11:34] <acrichto> a little uglier b/c there's no sass/templates/whatnot
[08:11:57] <Seldaek> yeah, I really think we should keep sass in as dev dependency
[08:12:05] <Seldaek> just commit the css output so people can build docs without needing it
[08:12:24] <acrichto> css really isn't that bad
[08:12:29] <acrichto> we already have a huge number of dependencies in rust
[08:12:39] <acrichto> it's bad enough to have pandoc
[08:12:40] <Seldaek> well this isn't really a dependency for most people
[08:12:50] <acrichto> we'd have to bundle libsass
[08:12:51] <Seldaek> it's really only if you want to tweak the css output that you need sass 
[08:12:56] <Seldaek> noo
[08:13:31] <Seldaek> can't we just write a comment in the css saying "this is generated, run sass *somehow* on the sass sources to update the file"
[08:13:42] <Seldaek> then let people install sass how they want
[08:13:44] <acrichto> it's not really that necessary though
[08:13:49] <acrichto> like sass is nice
[08:13:51] <Seldaek> I expect like 3 people to contribute to the css files
[08:13:51] <acrichto> don't get me wrong
[08:13:55] <acrichto> but you can easily get by without it
[08:13:59] <Seldaek> so I don't quite get the fuss about the dep
[08:14:23] <acrichto> well it may just be my opinion
[08:14:31] <acrichto> but for me it's always just "one more thing"
[08:14:38] <acrichto> and those "one more things" pile up really quickly
[08:15:17] <Seldaek> well I'd rather have one more thing for the very few people interested in css tweaks than having people mess things up because there are no more variables to keep things consistent for example
[08:15:45] <Seldaek> obviously just my opinion too ;)
[08:16:30] <Seldaek> I just think css is only maintainable if only one person ever touches it, and doesn't go away for too long
[08:17:11] <Seldaek> anyway it's not the biggest of issues
[08:17:23] <acrichto> so there's 389 lines of scss
[08:17:30] <acrichto> and 258 lines of css
[08:17:34] <acrichto> so it's not like there's an explosion issue
[08:18:01] <Seldaek> no I'm not worried about that I'm worried about "let me tweak this padding here by 2px and make the whole thing inconsistent" :)
[08:18:16] <acrichto> yeah that's where I always want scss
[08:18:19] <Seldaek> I'm anal about these things, and I know most devs aren't
[08:18:21] <acrichto> I really wish css had variables sometimes
[08:19:02] <acrichto> https://github.com/alexcrichton/rust/tree/rustdoc-web if you're curious btw
[08:19:17] <acrichto> https://github.com/alexcrichton/rust/blob/rustdoc-web/src/rustdoc_ng/html/static/main.css
[08:20:24] <acrichto> just got searching working yay
[08:20:33] <acrichto> oh that's what I pinged about
[08:20:36] <acrichto> was the format of the search index
[08:20:43] <acrichto> but I think I ended up figuring it out anyway
[08:21:05] <Seldaek> ok
[08:21:10] <Seldaek> it has some optional stuf
[08:21:33] <Seldaek> like some things have parent-lala because they are not on a page of their own
[08:21:55] <acrichto> yeah I may have put some extraneous things in there
[08:22:16] <Seldaek> try not too bloat it too much because it's already pretty huge :)
[08:22:21] <Seldaek> gzip helps but only so much
[08:22:27] <acrichto> the search index?
[08:22:30] <Seldaek> yeah
[08:22:34] <acrichto> oh I did what you did
[08:22:40] <acrichto> just needed to figure out what you did :P
[08:22:42] <Seldaek> ok ok
[08:22:45] <acrichto> although I did double it in size for a bit
[08:22:49] <acrichto> but that was a bug in rusdoc_ng
[08:22:51] <Seldaek> I mean it's a 1.2MB js file here
[08:22:55] <Seldaek> it's kinda nuts
[08:23:03] <acrichto> 650K here :)
[08:23:06] <acrichto> wait what
[08:23:08] <acrichto> how
[08:23:16] <acrichto> ...
[08:23:19] <acrichto> maybe I'm missing something
[08:23:34] <acrichto> http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/index.html
[08:23:39] <Seldaek> tbh the size could be substantially reduced by removing the "desc" field
[08:23:43] <acrichto> can you test the search a bit and see if I'm missing something?
[08:23:45] <Seldaek> because I don't think we search on that anymore
[08:24:03] <acrichto> oh actually
[08:24:06] <acrichto> it's no longer js
[08:24:07] <acrichto> it's json
[08:24:13] <acrichto> so you don't have to escape "
[08:24:20] <acrichto> which would reduce the size by a large amount I think
[08:24:26] <acrichto> not by half though...
[08:24:34] <Seldaek> I doubt it :)
[08:24:37] <Seldaek> and please don't make it json
[08:24:44] <acrichto> why not?
[08:24:50] <Seldaek> because then it doesn't load if you are opening the files locally withouts erver
[08:24:53] <Seldaek> server*
[08:25:03] <Seldaek> security sandbox kicks in if there is no origin
[08:25:10] <Seldaek> and it doesn't let ajax loads go through
[08:25:17] <acrichto> wtf browsers
[08:25:18] <acrichto> lol
[08:25:19] <Seldaek> that's why it's a js file, json-p style
[08:25:21] <acrichto> I had no idea
[08:25:32] <Seldaek> yeah no worries you're the second person to change it to json ;)
[08:25:50] <Seldaek> out of two people having touched the code :p
[08:26:17] <Seldaek> I mean I don't know if opening over file:// protocol is a use case, but I'd think yes if you build locally
[08:26:25] <acrichto> oh it totally is
[08:26:31] <Seldaek> as for testing the search, I can't because all js files are 404?
[08:26:31] <acrichto> that's how I'd always use it
[08:26:44] <acrichto> yeah something's funny...
[08:31:26] <acrichto> ugh I'll look at this tomorrow
[08:31:29] <acrichto> I'm tired...
[08:37:32] <Seldaek> acrichto: 'night
[14:43:22] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[14:43:25] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[17:39:23] <cmr> Seldaek: example of extremely broken type signature
[17:39:24] <cmr> http://seld.be/rustdoc/master/std/iter/trait.Iterator.html
[17:39:28] <cmr> flat_map method
[17:39:47] <cmr> https://github.com/mozilla/rust/blob/master/src/libstd/iter.rs#L305-306
[21:07:02] <acrichto> alright guys, got a good milestone
[21:07:10] <acrichto> cmr Seldaek  can you guys browse around www.contrib.andrew.cmu.edu/~acrichto/doc/
[21:07:13] <acrichto> and see if anything is missing
[21:07:25] <acrichto> things I know about are:
[21:07:28] <acrichto> multiple versions
[21:07:43] <cmr> http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/option/index.html
[21:07:48] <cmr> 'std' link in the left sidebar
[21:07:50] <acrichto> that was fast lol
[21:07:50] <cmr> goes to current page
[21:07:53] <cmr> I expect it to go to crate root
[21:08:04] <acrichto> yes, I would expect that too
[21:08:30] <cmr> Did you fix all the comment stripping bugs?
[21:08:33] <acrichto> yes
[21:08:36] <acrichto> all that I could find
[21:08:42] <cmr> You are my hero
[21:08:43] <cmr> <3
[21:08:48] <acrichto> :D
[21:09:05] <acrichto> so one major change between Seldaek's mine are long/short docblocks
[21:09:16] <acrichto> I never make a distinction between the two to always put documentation at the top
[21:09:41] <cmr> I think it's fine
[21:09:48] <cmr> I think I prefer it this way
[21:09:50] <acrichto> wanna make sure Seldaek is cool with that as well though
[21:09:57] <acrichto> I'd love to see collapsible sections
[21:10:21] <cmr> Do you want bugs or feature suggestions?
[21:10:33] <acrichto> bugs right now mainly
[21:10:41] <acrichto> I wanna get up to speed with nodejs, land, then iterate
[21:11:27] <cmr> Ideally you'd be able to click on the method in the top of the page like  http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/ascii/trait.AsciiCast.html and it would jumpt o the method lower on the page
[21:11:59] <acrichto> I totally agree
[21:13:38] <cmr> Uh
[21:13:40] <cmr> http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/managed/index.html
[21:13:42] <cmr> "lolhaha"
[21:13:44] <cmr> is not uint.
[21:14:00] <cmr> pub static RC_MANAGED_UNIQUE : uint = (-2) as uint;
[21:14:01] <cmr> pub static RC_IMMORTAL : uint = 0x77777777;        
[21:14:03] <cmr> corresponding source
[21:14:09] <acrichto> cmr: hahaha
[21:14:17] <acrichto> that's from when I didn't have type formatting implemented
[21:14:21] <acrichto> I kinda like it like that...
[21:14:40] * acrichto changes one line
[21:16:39] <cmr> Is there something wrong with pandoc that we're not getting syntax highlighting?
[21:17:03] <cmr> acrichto: source links are missing
[21:17:15] <acrichto> cmr: oh argh yeah that was the second big thing I'm missing
[21:17:26] <acrichto> cmr: I may just not have the right things installed on my system
[21:17:29] <acrichto> or I'm missing a stylesheet?
[21:17:33] <cmr> Actually that's mod.rs's fault.
[21:18:15] <acrichto> cmr: nah I'm missing a stylesheet
[21:18:19] <acrichto> all the spans/things are there
[21:19:24] <acrichto> bit by my own format syntax
[21:19:29] <acrichto> # is not what you think
[21:19:35] <cmr> http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/libc/types/os/arch/posix01/struct.stat.html
[21:19:37] <cmr> Spillover
[21:19:56] <acrichto> weird
[21:20:05] <cmr> acrichto: I'm specifically looking at std::rt::io's documentation, so that specific one is missing a {.rust}
[21:21:20] <cmr> acrichto: besides those few things, lgtm
[21:21:27] <acrichto> sweet, thanks
[21:21:41] <cmr> Also
[21:21:49] <cmr> If you could generate pandoc for the type definitions
[21:21:57] <cmr> And run those through for highlighting
[21:21:59] <cmr> that'd be pcool
[21:22:11] <cmr> slower a lot though :\
[21:22:40] <acrichto> that may be tougher
[21:22:46] <acrichto> b/c we hyperlink everything in definitions
[21:22:52] <acrichto> which pandoc wouldn't do for us
[21:22:54] <cmr> http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/fmt/parse/enum.PluralKeyword.html
[21:23:01] <cmr> Oh
[21:23:03] <cmr> Yeah, good point.
[21:23:06] <cmr> Forgot about that.
[21:23:13] <acrichto> in theory it's possible
[21:23:14] <cmr> Could you generate the link in the markdown?
[21:23:16] <acrichto> like we know what everything is
[21:23:26] <cmr> Not really a big deal, just a nice-to-ahve
[21:23:58] <acrichto> woohoo links from trait methods to their definitions now work
[21:24:16] <cmr> Update the site yet?
[21:24:23] <acrichto> nah not yet
[21:24:33] <acrichto> statics' types are rendering
[21:25:00] <acrichto> need to fix 'std' linking to the current page
[21:27:35] <acrichto> ok updated
[21:27:42] <acrichto> gotta figure out that word wrap
[21:28:22] <acrichto> huh maybe that's what &#8203; is
[21:30:10] <acrichto> yep that was it
[21:34:07] <acrichto> hm, I appear to have broken http://localhost:8081/std/bool/fn.all_values.html
[21:34:11] <acrichto> whoops, wrong path
[21:34:24] <acrichto> http://www.contrib.andrew.cmu.edu/~acrichto/doc/std/bool/fn.all_values.html
[21:44:02] <acrichto> cmr: comment cleaning turns "/// test\n/// test\n/// test" into nothing
[21:44:08] <acrichto> "longest_common_prefix" is everything :)
[21:44:21] <cmr> mmm
[21:44:37] * acrichto writes a different test case and ignores this
[22:33:09] <dbaupp> what about a single of documentation? does that get entirely removed too?
[22:37:24] <cmr> dbaupp: should be fine; previously they didn't get stripped at all.
[23:32:52] *** Quits: dbaupp (Thunderbir@moz-EAA09AEF.lns20.syd7.internode.on.net) (Ping timeout)
[23:51:22] <cmr> acrichto: ping
[23:51:57] <acrichto> cmr: pong
[23:52:33] <cmr> acrichto: do you know much about middle::privacy? Does it do all the proper privacy checking, or is a lot of that logic still in resolve?
[23:52:44] <acrichto> lots of that logic is still in resolve
[23:52:50] <acrichto> I tried to rip it all out at some point
[23:52:58] <acrichto> but failed miserably because of imports
[23:53:08] <acrichto> it should all be in middle::privacy though
[23:53:24] <cmr> I was going to try doing the same thing but got intimidated
[23:53:33] <acrichto> lol
[23:53:54] <acrichto> although 8125 should probably dictate the next move in privacy
[23:54:09] <acrichto> whoops 8215
[23:54:15] <cmr> Was going to say :P
