[00:00:08] <ChrisMorgan> acrichto: using Vundle shouldn't affect it at all
[00:00:56] *** Quits: eatkinson (eatkinson@moz-9550586.airbears2.berkeley.edu) (Quit: eatkinson)
[00:01:04] <steveklabnik> brson: second signature checks out too
[00:01:28] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[00:02:14] <steveklabnik> brson: hashes both check out
[00:02:34] *** Joins: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net)
[00:02:44] <brson> steveklabnik: thanks
[00:03:25] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[00:06:54] <derboi_c> strcat: thera is also a magic [] to desactivate morestack?
[00:07:43] *** Quits: BitPuffin (isak@moz-49828767.cust.tele2.se) (Ping timeout)
[00:08:07] *** Joins: wil (wil@moz-BA773703.bootp.virginia.edu)
[00:08:43] <strcat> derboi_c: no, you probably just have to provide it yourself for now
[00:09:28] <derboi_c> strcat: i do it, but in morestack there a some function of librt :D
[00:09:35] <derboi_c> circulare for and seek
[00:09:47] <derboi_c> s/librt/librustrt/
[00:09:49] <brson> does the 'release notes' link on rust-lang.org point to the correct tag location for anybody? it's pointing to the wrong tag name here
[00:10:17] <cmr> It's release-0.7 for me
[00:10:19] <steveklabnik> 404
[00:10:23] <steveklabnik> it's the right URL
[00:10:29] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[00:10:31] <steveklabnik> https://github.com/mozilla/rust/blob/release-0.8/RELEASES.txt
[00:10:36] <brson> it should be '0.8', not 'release-0.8'
[00:10:45] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Input/output error)
[00:10:48] <brson> guess we're waiting for the changes to trickle through the tubes
[00:10:49] <SiegeLord> Works for me
[00:10:58] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:10:59] <cmr> Ok, force refresh made it 0.8
[00:11:04] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Max SendQ exceeded)
[00:11:11] <strcat> brson: github also lets you attach release notes to tags now via the web ui
[00:11:31] <strcat> brson: https://github.com/mozilla/rust/releases/tag/0.8 via edit tag
[00:11:33] <strcat> dunno if we care
[00:11:35] <strcat> but why not? ;p
[00:11:41] <steveklabnik> it will make them regardless
[00:11:44] <acrichto> brson: nice job preparing all this
[00:11:44] <steveklabnik> might as well paste them in
[00:11:48] <ChrisMorgan> strcat: because it's PROPRIETARY!
[00:12:08] *** Quits: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net) (Quit: Leaving.)
[00:12:09] <ChrisMorgan> (Just like the issues subsystem.)
[00:12:24] <steveklabnik> sure, but having it duplicated wont hurt
[00:13:44] * pcwalton pops open a bottle of champagne
[00:14:02] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[00:14:03] <steveklabnik> it's not official till its tweeted ;)
[00:14:14] <acrichto> \o/
[00:15:01] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[00:15:04] <brson> hm, I guess I'll tweet from rustlang
[00:15:21] <engla> Congratulations Rust! So many improvements since 0.7
[00:15:24] <SiegeLord> Woohoo
[00:15:31] <Eridius> woo
[00:15:36] <steveklabnik> wooo!
[00:15:45] <steveklabnik> https://news.ycombinator.com/newest <- posted the ML announcement there.
[00:15:45] * strcat has to push 0.8 to the arch repos now ;p
[00:15:47] <derboi_c> :D
[00:16:00] <Eridius> steveklabnik: good idea. direct link: https://news.ycombinator.com/item?id=6454443
[00:16:22] <steveklabnik> ahh i guess on IRC there wont be a referrer
[00:16:26] <steveklabnik> if you tweet a HN link it gets flagged
[00:16:34] <Eridius> steveklabnik: oh? that's.. curious
[00:17:05] <Eridius> steveklabnik: damn, you harvested that sweet sweet reddit karma as well :P
[00:17:14] *** Joins: canhtak (jeremy@moz-B197A39C.wl.t.ulaval.ca)
[00:18:19] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:18:24] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[00:18:25] <brson> my bullets were formatted incorrectly :(
[00:18:29] <kmc> I wish we could just ignore HN and its hidden, capricious rules
[00:18:44] <brson> all of them :(
[00:19:00] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[00:19:03] <strcat> brson: ah it ate the indents?
[00:19:09] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[00:19:57] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[00:24:03] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Quit: Leaving)
[00:24:53] <derboi_c> strcat: #[main] was suppose to name the symbol with the same name that function?
[00:25:21] <Eridius> egads, libstd/os.rs has `use prelude::*;`
[00:25:40] <strcat> derboi_c: #[start] will always output 'main', afaik
[00:25:41] <Luqman> derboi_c: no, main just indicates what function (by any name) is your main
[00:25:55] <Luqman> first main -> #[main]
[00:26:28] <steveklabnik> Eridius: i quit HN for two years, was just barely off the top 100 list when i came back. there's a reason i'm steveklabnik1 on reddit as well ;)
[00:26:37] <steveklabnik> kmc: me too. and reddit. reality :/
[00:27:05] <amatus> rusti: let p = &Path("/some/file/path.txt"); p.open_reader(std::rt::io::Open);
[00:27:06] -rusti- <anon>:7:47: 7:80 error: type `&std::path::PosixPath` does not implement any method in scope named `open_reader`
[00:27:06] -rusti- <anon>:7          let p = &Path("/some/file/path.txt"); p.open_reader(std::rt::io::Open);
[00:27:06] -rusti-                                                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[00:27:06] -rusti- error: aborting due to previous error
[00:27:08] -rusti- application terminated with error code 101
[00:27:23] <amatus> how do i fix that?
[00:27:30] <kmc> it's harder for me to judge Reddit as a whole because different subreddits are vastly different... plus it doesn't have the same "thumb on the scale" issue as HN with pg
[00:27:43] <kmc> but they have many other problems in common
[00:27:45] <cmr> "thumb on the scale"?
[00:28:02] <derboi_c> StarLight: ok, as I thinks (and see) so. I search a lot, but i don't find how to force symbole. Do you know?
[00:28:09] <acrichto> amatus: http://static.rust-lang.org/doc/master/std/rt/io/file/trait.FileInfo.html
[00:28:16] <acrichto> amatus: `use std::rt::io::file::FileInfo`
[00:28:49] <steveklabnik> there will be a 0.10, yes? like, it's not 6 months till 1.0 ;)
[00:29:04] <kmc> cmr: Hacker News is a promotional tool for Y Combinator and for the "startup lifestyle" that serves YC's financial ends, and Paul Graham has no qualms about manipulating article rankings, secretly muting people, etc. to further these goals
[00:29:13] <amatus> wow, this is super counterintuitive
[00:29:19] *** Joins: optimusbrine (optimusbri@moz-10CF392D.tampfl.fios.verizon.net)
[00:29:41] <Eridius> steveklabnik: 0.a
[00:29:45] <ChrisMorgan> I wish he had time to make an IRC library so I could write a helpful bot for this channel to do things like provide doc links... but I guess HTTP is enough to be going on with. :-(
[00:29:53] <steveklabnik> Eridius: lol
[00:30:01] <Eridius> ChrisMorgan: I've been considering rewriting my Go IRC library in Rust. It was my original plan
[00:30:06] <Eridius> is the networking mature enough for that yet?
[00:30:10] <ChrisMorgan> Sure.
[00:30:10] <steveklabnik> Eridius: yup
[00:30:13] <cmr> ChrisMorgan: Once I've made my way with rust-http, I also need an HTTP library.
[00:30:23] *** Joins: erickt1 (Adium@8C9ECD8F.3A598286.F12515B4.IP)
[00:30:30] <Eridius> do we actually have the ability to resolve DNS now?
[00:30:32] <ChrisMorgan> cmr: was that an insult or an error or something else?
[00:30:34] <ChrisMorgan> Eridius: yes
[00:30:34] *** Joins: Ralith (ralith@moz-36466B9F.customer.broadstripe.net)
[00:30:37] <Eridius> \o/
[00:30:51] <amatus> is there a simple rust httpd?
[00:30:54] <ChrisMorgan> brson implemented it in rust-http :-)
[00:31:01] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My lid went down)
[00:31:02] <ChrisMorgan> amatus: rust-http is both client and server
[00:31:03] <amatus> acrichto: thanks btw :)
[00:31:13] <amatus> oh excellent
[00:31:21] <cmr> ChrisMorgan: A statement of a fact of the project I'm working on.
[00:31:27] <acrichto> amatus: np :), do note though that almost all of std::rt is in flux and is likely to change
[00:31:38] <ChrisMorgan> cmr: your statement implies that rust-http isn't an HTTP library?
[00:31:39] <cmr> Erm
[00:31:41] <brson> oops. forgot to update the docs page on the wiki
[00:31:43] <cmr> s/HTTP library/IRC library/
[00:31:48] * ChrisMorgan thought so
[00:31:53] * cmr is tired
[00:32:14] <Eridius> when is std::rt::io going to move out of std::rt?
[00:33:08] <ChrisMorgan> amatus: rust-http is far from mature, but do play around with it.
[00:33:48] <pcwalton> error: can only cast an @-pointer to an @-object, not a type error
[00:33:53] <pcwalton> my favorite appearance of "type error"
[00:34:00] <acrichto> hahaha
[00:34:01] <cmr> Hahah
[00:34:05] <cmr> That's the best one I've seen
[00:34:08] <ChrisMorgan> Eridius: if writing an IRC library, I hope it'll be implementing the protocol at a nice low level for convenience.
[00:34:15] <steveklabnik> brson: good job! thanks for powering through the annoying problems ;)
[00:34:18] <pcwalton> I had an old IRC library
[00:34:22] <pcwalton> but it's very old, rust 0.3 or something
[00:34:43] <ChrisMorgan> Send for the palaeontologists!
[00:34:58] <steveklabnik> ChrisMorgan: Eridius i think this blog post makes sense for that kind of sentiment: http://blog.jcoglan.com/2013/05/06/websocket-driver-an-io-agnostic-websocket-module-or-why-most-protocol-libraries-arent/
[00:35:13] <Eridius> ChrisMorgan: the way my Go one works is it has a callback mechanism that lets you register handlers for any event, and it dispatches events for every incoming IRC command, along with default handlers for all of the required ones. But I'm not sure this is really the best approach
[00:35:48] <cmr> Eridius: fwiw, it's what the irc libraries I've traditionally used do as well
[00:36:05] <strcat> or just make a pipe and send events over it?
[00:36:09] <strcat> enum of events
[00:36:21] <Eridius> the problem is when multiple consumers want to handle the same incoming line, but don't really want anyone else to do so
[00:36:54] <strcat> pcwalton: https://github.com/mozilla/rust/pull/9538 r?
[00:37:10] <ChrisMorgan> An alternative model is having an IrcClient trait with methods for each command with a dispatcher to parse and send to the appropriate method; default methods to avoid the need to implement every command, probably.
[00:37:12] <brson> steveklabnik: thanks!
[00:37:18] <pcwalton> brson: what do you feel about PR #9538?
[00:37:26] <pcwalton> I'm inclined to r+ but I figured I should run it by you
[00:37:48] <Eridius> ChrisMorgan: sure, I can do something like that for the library, so as a client you can implement the trait yourself, or just use a built-in implementation
[00:38:14] <brson> pcwalton: +1
[00:38:21] <Eridius> although it can't have a method for every command because there are a _lot_ of commands, and different ircds add new ones. So it would maybe implement concrete methods for all the required/important commands, and then a single generic handler for the rest
[00:39:04] <Eridius> I wish there was some way of saying `use foo::* except for Foo,Bar`
[00:39:35] <strcat> pcwalton: fwiw, it only decreases the IR from 487k lines to 463k with no-op but it breaks inline of intrinsics
[00:39:43] <strcat> (often breaks, not always)
[00:39:48] <pcwalton> ah
[00:39:50] <pcwalton> yeah
[00:39:52] <pcwalton> mergefunc is better
[00:40:01] <strcat> mergefunc is a lot better but doesn't properly cast aggregates in all cases yet
[00:40:07] <ChrisMorgan> Eridius: actually, you might just want a message enum, similar to many of rust-http's enums (e.g. Header { Allow(~[Method]), Dnt(uint), ..., ExtensionHeader(~str, ~str) }). Leave dispatch out of it at the lowest level.
[00:40:09] <strcat> they fixed int <-> ptr casts last week
[00:40:15] <strcat> someone is working on it upstream
[00:40:27] <strcat> works on libextra now ;]
[00:40:35] <Eridius> ChrisMorgan: true
[00:40:36] *** Quits: optimusbrine (optimusbri@moz-10CF392D.tampfl.fios.verizon.net) (Ping timeout)
[00:41:04] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[00:41:06] <Eridius> ChrisMorgan: the downside to this approach is the library can't adopt any new codes as first-class codes (so to speak) without breaking existing clients, because existing clients would expect those codes as "extension" codes
[00:41:08] <ChrisMorgan> The other can sit on top of that with ease.
[00:42:03] <ChrisMorgan> I've been wondering about whether that will come back to bite me with rust-http (I use that approach extensively), but have come to the conclusion that the benefits of the rigidly strong typing are probably going to outweigh it.
[00:43:02] *** Joins: optimusbrine (optimusbri@moz-10CF392D.tampfl.fios.verizon.net)
[00:43:50] *** Quits: optimusbrine (optimusbri@moz-10CF392D.tampfl.fios.verizon.net) (Quit: )
[00:46:07] <strcat> pcwalton: they force-enabled it on clang's trunk for their builtbot so they have to fix it now ;p
[00:46:20] <pcwalton> strcat: oh good
[00:46:39] <strcat> not actually enabled for a user build, but it looks like they have patches the buildbot applies
[00:47:08] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[00:47:33] *** Quits: erickt1 (Adium@8C9ECD8F.3A598286.F12515B4.IP) (Quit: Leaving.)
[00:47:37] <strcat> https://github.com/llvm-mirror/llvm/commit/33300d91b66a86fc39482dd262fb735ca54d92e1
[00:47:53] <strcat> it was also broken with address spaces (fixed) but we don't use them anymore anyways
[00:48:13] <strcat> https://github.com/llvm-mirror/llvm/commit/80361492ae7ea9fedbb5a55c72d4aea6a3d600b1 that fixed libextra
[00:48:59] *** Quits: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net) (Ping timeout)
[00:51:16] <c74d> Does Rust have an easy way to stringify an enum value?
[00:51:32] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[00:51:52] *** Joins: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net)
[00:51:54] <acrichto> c74d: format!("{:?}", my_enum_value)
[00:52:11] <acrichto> or #[deriving(ToStr)] on the enum and my_enum_value.to_str()
[00:52:13] <benh> Also works for non-enum values with varying degrees of prettiness
[00:52:36] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Client exited)
[00:52:56] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[00:53:17] <c74d> acrichto: I have Rust 0.7; format! is from 0.8?
[00:53:29] <acrichto> c74d: ah, then fmt!("%?", my_enum_value)
[00:53:30] <amatus> well that was a completely pointless exercise, i can't get the raw fd out of a FileReader
[00:53:30] *** Quits: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[00:54:35] <c74d> acrichto: Okay, thanks.
[00:55:35] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Ping timeout)
[00:57:15] *** Joins: jesse99 (jesse99@moz-8B1E0C5D.hsd1.wa.comcast.net)
[00:57:30] *** Joins: jaeman (Mibbit@B4104EBB.3CC170B1.1E14B209.IP)
[00:58:34] *** Quits: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com) (Ping timeout)
[00:59:07] <ChrisMorgan> Aww... I tried making another trait and implementing it for FileReader to see if I could access self.stream (priv) inside it. Answer: no.
[00:59:50] *** Quits: RMF (RMF@moz-A7EEA849.dsl.telepac.pt) (Ping timeout)
[01:00:01] <strcat> pcwalton: libextra -> 417k with neither, 399k with type_use, 370k with mergefunc, 367k with both
[01:00:07] <strcat> pcwalton: but lots that are 'both' are possibly wrong
[01:00:12] <strcat> since it merges ones using repr
[01:00:25] <acrichto> strcat: that's an awesome stat
[01:00:31] <acrichto> also mergefunc
[01:01:13] <strcat> and mergefunc will get better ;]
[01:01:26] <brson> cmr: what's the rustdoc schema version? does it need to be incremented with the rust version?
[01:01:54] <strcat> we can also make our code friendly for it by making sure ints/ptrs aren't treated differently, etc.
[01:01:54] <acrichto> brson: it only gets updated when the structure changes, I probably should have updated it by now but it's not related to rust's version number
[01:02:13] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[01:02:15] <cmr> brson: what acrichto said
[01:02:17] <acrichto> brson: structure as in rustdoc's own internal structure, it's just a coincidence that it's 0.8 right now
[01:02:29] <pcwalton> whoa
[01:02:33] <pcwalton> cool
[01:02:40] * pcwalton <3 mergefunc
[01:03:37] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[01:04:00] <acrichto> pcwalton: when you resolve a call to an externally defined trait, does it resolve to A. the method declaration in the external crate, B. the method definition in the external crate, or C. possibly the default method if there is one
[01:04:07] <cmr> https://github.com/cmr/gl-rs/tree/master/generator generator.rs is the crate file. Why is it making https://gist.github.com/anonymous/15ab7f6be95c26418592 ?
[01:04:07] *** Joins: RMF (RMF@moz-A7EEA849.dsl.telepac.pt)
[01:04:11] <Luqman> r? https://github.com/mozilla/rust/pull/9551
[01:04:19] <pcwalton> it resolves to the declaration I think
[01:04:33] <acrichto> ok
[01:04:41] *** Quits: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net) (Client exited)
[01:04:42] <pcwalton> Luqman: you are a hero.
[01:04:58] <acrichto> Luqman: !!
[01:05:01] <cmr> (The wip commit on the top of that branch is the changeset that made it stop working... )
[01:05:17] <benh> nice
[01:06:03] *** Quits: jesse99 (jesse99@moz-8B1E0C5D.hsd1.wa.comcast.net) (Client exited)
[01:06:12] *** Joins: jesse99 (jesse99@moz-8B1E0C5D.hsd1.wa.comcast.net)
[01:06:41] *** Quits: wil (wil@moz-BA773703.bootp.virginia.edu) (Quit: leaving)
[01:06:47] <strcat> Luqman: I'll cherry-pick that into my internal global one because they'll conflict
[01:06:57] <acrichto> Luqman: this makes it so that you can't share sessions among compilations?
[01:07:41] <Luqman> acrichto: what do you mean?
[01:07:55] <acrichto> Luqman: I thought that before you could use the same session to compile multiple inputs
[01:08:06] <acrichto> but this looks like it consumes the session when you compile an input now
[01:08:17] <strcat> acrichto: you could clone it, it's not that big
[01:08:28] <strcat> would be less overhead since it gets passed around everywhere
[01:08:58] <Luqman> acrichto: yea in certain places i just made it take it by value if it wasn't used after but that could be changed
[01:09:04] *** Joins: pjenvey (pjenvey@moz-B23F7990.org)
[01:09:30] <Luqman> also, had to play some tricks with resolve :(
[01:09:31] *** Joins: wil (wil@moz-BA773703.bootp.virginia.edu)
[01:09:51] <Luqman> i give it the session which it puts in a Cell and at the end it gives it back
[01:10:06] *** Joins: frogonia (Mibbit@moz-F493A63E.bootp.virginia.edu)
[01:10:12] <acrichto> :(
[01:10:16] <wil> Question: Is there a way to import C structs as there is for C functions in the FFI? Specifically, I'm looking to get sigaction, so I don't have to redefine it.
[01:10:29] <acrichto> Luqman: is there any way for phase 3 to take &mut Session ?
[01:11:01] <acrichto> wil: rust structs have an ABI-compatible layout, but you currently have to clone it in rust sadly.
[01:11:12] <acrichto> wil: as in you have to copy the definition from C to rust
[01:11:29] <cmr> wil: bindgen will do it but glibc's sigaction struct has unions, which won't fly.
[01:11:37] <wil> acrichto: Ah, alright. That's what I thought, but I was hoping for a lazy solution. Thanks!
[01:11:48] <cmr> wil: did you see https://github.com/cmr/rust-signal ?
[01:11:57] <SiegeLord> bindgen can handle unions these days
[01:12:00] <cmr> SiegeLord: how?
[01:12:43] <Luqman> acrichto: no, cause of the resolve pass :( I couldn't thread a borrowed pointer through it
[01:12:55] <wil> cmr: I had not, but thanks! That's fairly similar to what I have so far. Thanks!
[01:13:21] <acrichto> Luqman: what did resolve need to own the session for?
[01:13:22] <SiegeLord> cmr: Some transmutes
[01:14:14] <SiegeLord> https://github.com/SiegeLord/RustAllegro/blob/master/src/ffi/events.rs#L126
[01:14:22] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[01:14:33] <Luqman> acrichto: i couldn't give a &T because only &'static is allowed in @ which resolve makes use of
[01:14:42] <cmr> SiegeLord: handy!
[01:14:52] <cmr> None of those methods should be safe.
[01:14:56] <cmr> But still, handy.
[01:15:00] <Luqman> also, er i'm going to remove the r+ cause I need to fix rustpkg :P
[01:15:01] *** Joins: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[01:15:06] <acrichto> Luqman: is that the only blocker for phase3 taking &mut Session?
[01:15:38] <cmr> Well, returns pointers, so maybe not.
[01:16:06] <Luqman> acrichto: yea pretty much. i don't even think it need &mut
[01:16:29] <acrichto> Luqman: hmm, I'd be more comfortable ripping that out, let me see if I can do that real quick
[01:16:30] *** Joins: jgilbert (jgilbert@moz-2763DC04.hsd1.ca.comcast.net)
[01:17:03] <Luqman> acrichto: is this gonna result in a refactor of resolve now? :P
[01:17:15] <acrichto> Luqman: yeah let me see if I can do that with not too much pain
[01:17:35] <acrichto> and ofc llvm needs to recompile itself
[01:18:59] <steveklabnik> http://www.reddit.com/r/programming/comments/1n7qqz/rust_08_released/ccg57gk
[01:19:03] <steveklabnik> check me. just to make 1000% sure
[01:20:09] <steveklabnik> one of the reasons i love rust is that i get to re-learn low level stuff
[01:20:35] *** Joins: eatkinson (eatkinson@moz-E57448EF.airbears2.berkeley.edu)
[01:20:44] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[01:21:36] <tikue_> steveklabnik: sounds right to me
[01:21:45] *** Quits: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net) (Input/output error)
[01:21:45] *** Quits: bogen (dwight@moz-8B4E7E75.dsl.rcsntx.swbell.net) (Ping timeout)
[01:21:55] *** Joins: bogen (dwight@moz-30A7F8A5.tx.res.rr.com)
[01:22:13] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[01:22:41] <strcat> pcwalton: huh, there's actually more than one person working on mergefunc
[01:22:50] <strcat> they have russian-looking names so maybe they work together
[01:23:26] <steveklabnik> tikue_: thanks. one would hope i wouldn't mess up something so basic, but i'm having a stressful day
[01:23:33] <steveklabnik> so double checks are good :)
[01:23:48] * strcat is probably reading too much into syllables in names ;p
[01:25:54] <strcat> acrichto: any idea if LLVM passes need to be built with LLVM?
[01:26:12] <acrichto> strcat: how so? like can we write one in rust?
[01:26:29] <strcat> acrichto: well, it'd be written in C++ and compiled to a .so LLVM can be told to load
[01:26:33] <brson> do we have any sense of how much it costs to be wasting the first argument register on the environment?
[01:26:42] <frogonia> Can someone tell me what's wrong with my code below? fd is a file descriptor. 
[01:26:43] <frogonia> let mut new_options:run::ProcessOptions = run::ProcessOptions::new();  new_options.in_fd = Some(fd);
[01:26:53] <acrichto> strcat: I don't see why that needs to be compiled with llvm?
[01:26:58] <frogonia> let mut new_options:run::ProcessOptions = run: :ProcessOptions ::new();  new_options.in_fd = Some(fd);
[01:27:08] <frogonia> let mut new_options:run::  ProcessOptions = run::  ProcessOptions::new();  new_options.in_fd = Some(fd);
[01:27:13] <strcat> brson: since I made binaries mark all functions as internal, it's optimized out in non-libs now at least
[01:27:26] <strcat> but I think it does cost a lot in libs.
[01:27:46] <brson> strcat: the first argument  gets removed?
[01:27:55] <steveklabnik> is there a specific reason why some docs are in the wiki and some are in the docs?
[01:28:02] <strcat> brson: yeah, deadargelim works on internal functions - but we mark *all* non-generic functions in libs as external
[01:28:03] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[01:28:13] <strcat> brson: since if you #[inline] a function, it can do cross-library calls to priv fns
[01:31:26] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[01:32:35] <strcat> acrichto: ah, it needs to be compiled in the LLVM source tree but you don't have to compile LLVM afaict
[01:32:36] <tikue_> is rustpkg supposed to put the executables in bin/ ?
[01:32:43] <strcat> I want to make a non-nullable ptr pass
[01:33:07] <strcat> set metadata on non-raw ptr params/returns -> mark as non-null in pass
[01:33:12] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[01:33:19] <strcat> it makes it not vectorize sometimes
[01:33:23] <acrichto> /Users/alex/code/rust2/src/librustc/middle/resolve.rs:5578:0: 5578:1 error: file ended with unbalanced delimiters
[01:33:26] <acrichto> thanks rustc
[01:33:58] <Luqman> acrichto: so yea, looks like i'll definitely have to change it to take & since otherwise it may not work in rustpkg :(
[01:34:12] <acrichto> Luqman: working on resolve right now, I may be able to get it done
[01:34:26] <Luqman> \o/
[01:34:34] <brson> acrichto: that's the worst error. i don't know what the parser can do better though
[01:34:58] <acrichto> brson: I wonder if the unbalanced delimiter could be shown
[01:35:01] <tikue_> how do I set my RUST_PATH so that I can run programs built with rustpkg without having to go into the architecture-specific subdirectory?
[01:35:18] <acrichto> or "if line > 1000 { println(sorry....) } "
[01:35:36] <brson> acrichto: I don't think the parser can know which delimiter it was
[01:35:42] <acrichto> :(
[01:36:32] <strcat> the real reason for LLVM/clang existing is the amazing algorithms it uses to identify missing semicolons
[01:36:36] <strcat> ;p
[01:37:05] <mcpherrin> strcat: If only it could pull a javascript and insert them for you ;)
[01:37:06] *** Quits: steveklabnik (steveklabn@moz-389D91E.public.wayport.net) (Ping timeout)
[01:37:09] <acrichto> yay git diff
[01:38:12] <brson> if it wasn't possible to define items anywhere then the parser could find places to stop, but as it is it just keeps chewing through syntax until it hits the end of the file
[01:38:56] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[01:39:18] *** Joins: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP)
[01:40:01] *** Quits: pcwalton (pcwalton@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: pcwalton)
[01:40:11] <ChrisMorgan> Surely it could say "this one wasn't closed"?
[01:40:53] *** Joins: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net)
[01:40:58] *** Quits: vodik (simon@moz-2D668626.cpe.net.cable.rogers.com) (Ping timeout)
[01:41:40] *** Joins: quibbit (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net)
[01:42:07] <quibbit> Is there a rust equivalence of continue in java (cont doesn't work)?
[01:42:18] <mcpherrin> quibbit: "loop"
[01:42:19] <tikue_> do Streams implement Reader/Writer? If not, why?
[01:42:32] <quibbit> ok thanks!
[01:42:39] <cmr> tikue_: Stream is literally just Reader+Writer
[01:42:47] <tikue_> cmr: sorry I mean Port/Chan
[01:42:50] <engla> quibbit: that `loop` will be renamed to continue soon :)
[01:43:28] <strcat> we could just replace 'loop {}' with 'while true {}' too... it's sad to reserve a nice word like that
[01:43:36] <cmr> it is
[01:43:36] <brson> tikue_: io::comm_adapters contains some theoretical implementations that all just fail
[01:43:38] <benh> :(
[01:44:02] <acrichto> pcdummy: resolve is so pained for horizontal whitespace
[01:44:06] <acrichto> sry, pcwalton
[01:44:09] <tikue_> brson: oo. theoretically fixable?
[01:44:12] <polyfractal> congrats on 0.8 guys, pretty cool to watch Rust move at such a quick pace :)
[01:44:16] <tikue_> oh wait
[01:44:23] <tikue_> brson: you just meant they're not implemented yet?
[01:44:27] <engla> tikue_: so you mean a Chan<u8> ?
[01:44:30] <brson> tikue_: yes
[01:44:35] *** Joins: brendan (brendaneic@moz-55B1EDE8.public.wayport.net)
[01:44:44] <tikue_> awesome
[01:44:54] <tikue_> engla: no like Chan<Foo> 
[01:45:07] <tikue_> engla: that takes care of serializing deserializing etc
[01:45:10] <engla> but Reader/Writer is based on bytes only
[01:45:17] <brson> tikue_: oh these are for ~[u8]
[01:45:23] <brson> tikue_: you probably want extr::flatpipes
[01:45:27] <tikue_> ah ok
[01:45:46] <brson> but flatpipes uses std::io not std::rt::io :-/
[01:45:55] <brson> until somebody ports it!
[01:46:08] <tikue_> brson: well I mean, net_stream could implement Reader/Writer<~[u8]>
[01:46:13] <tikue_> and then also serialize and deserialize
[01:46:15] <tikue_> on top of that
[01:46:38] *** Quits: RMF (RMF@moz-A7EEA849.dsl.telepac.pt) (Ping timeout)
[01:47:07] <brson> personally I really like `loop { }`. maybe we can get rid of `while`?
[01:47:17] <tikue_> we could get rid of both and use for
[01:47:26] <tikue_> for x < n { } like go
[01:47:31] <strcat> brson: we could make 'loop condition {}' work
[01:47:45] <tikue_> for  { }
[01:47:58] <ChrisMorgan> Unfamiliar. (Not a breaker, but undesirable.)
[01:48:26] *** Quits: sp3d (a@6361F3B1.19CD1E54.8354FB35.IP) (Ping timeout)
[01:48:28] <strcat> takes me so long to upload these rust packages
[01:49:29] <strcat> tikue_: I think it would probably be too ambiguous with `for`
[01:49:39] <tikue_> ah ok
[01:49:44] *** Quits: riley (riley@8BA43816.9AA11D69.65DDFA89.IP) (Client exited)
[01:49:48] <tikue_> brson: what would be involved with porting flatpipes?
[01:49:54] <brson> strcat: that's cool that you've open sourced rust for rubyists
[01:49:55] <tikue_> would it be scary
[01:49:58] <cmr> I really wouldn't like to see while be turned into loop
[01:50:01] *** Quits: wil (wil@moz-BA773703.bootp.virginia.edu) (Quit: leaving)
[01:50:10] <strcat> brson: you mean steveklabnik? ;p
[01:50:21] <benh> Ruby also has loop { } :) :)
[01:50:24] <brson> strcat: lol yes
[01:50:31] <strcat> looks like he timed out
[01:50:32] <brson> he's not even here
[01:51:12] <strcat> rust 0.8 in the arch repos now ;), off it goes to all the mirrors
[01:51:25] <brson> tikue_: it may be simple. start by changing which Reader and Writer traits it's using and see what breaks. there aren't any in-tree uses of flatpipes so it's pretty self-contained
[01:52:02] <tikue_> brson: great, thanks
[01:52:08] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[01:53:37] *** Quits: frogonia (Mibbit@moz-F493A63E.bootp.virginia.edu) (Quit: http://www.mibbit.com ajax IRC Client)
[01:54:07] <acrichto> what was the reason for forbidding `self` as an identifier?
[01:55:54] *** Quits: Earnestly (earnest@moz-BE290A2B.dyn.plus.net) (Ping timeout)
[01:58:34] <tikue_> brson: there's a pipe_stream but no stream_stream :P 
[01:59:02] *** Quits: quibbit (Mibbit@moz-6B6EE8C0.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[02:00:57] *** Quits: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net) (Ping timeout)
[02:01:56] *** Quits: Ralith (ralith@moz-36466B9F.customer.broadstripe.net) (Ping timeout)
[02:05:24] <acrichto> <3 non-exhaustive matches
[02:05:45] <acrichto> Luqman: one more borrow check error in resolve
[02:06:05] <Luqman> acrichto: <3 awesome!
[02:06:16] *** Joins: Ralith (ralith@moz-36466B9F.customer.broadstripe.net)
[02:07:40] *** Joins: sp3d (a@6361F3B1.19CD1E54.8354FB35.IP)
[02:07:54] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[02:08:08] *** Quits: brendan (brendaneic@moz-55B1EDE8.public.wayport.net) (Ping timeout)
[02:09:36] <acrichto> Luqman: ofc I leave the hardest one for last :(
[02:10:00] <Luqman> acrichto: do you have a branch up somewhere?
[02:10:09] <acrichto> no, but I could
[02:10:39] *** Quits: eatkinson (eatkinson@moz-E57448EF.airbears2.berkeley.edu) (Quit: eatkinson)
[02:10:44] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[02:10:55] <acrichto> Luqman: https://github.com/alexcrichton/rust/tree/less-at-mut
[02:11:04] <ChrisMorgan> And the opposite of non-exhaustive: excessively exhaustive where it doesn't notice it, or unmatchable: match x { A if true => (), A if false => unreachable!(), A => unreachable!(), None => () }
[02:11:20] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Max SendQ exceeded)
[02:12:15] <strcat> http://strcat.zapto.org:8000/ has 0.8 now :)
[02:12:39] <acrichto> Luqman: I'll try to finish this by tonight, but gonna head home now
[02:16:38] <ChrisMorgan> Is `a + b` syntax sugar for `a.add(&b)`, or `(&a).add(&b)`, or does it depend?
[02:18:24] *** Quits: azakai (alon@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[02:21:03] *** Joins: eatkinson (eatkinson@moz-E57448EF.airbears2.berkeley.edu)
[02:22:33] <derboi_c> How i can compile (on freeBSD amd64) an 32 bit code
[02:23:00] <derboi_c> --target i686-pc-freeBSD => Segmented stacks not supported on FreeBSD
[02:23:33] <derboi_c> --target i686-pc-linux => -ldl uses (only when i use target) so no compatible freebsd
[02:23:58] *** Quits: seryogah (holoirc@moz-9E1A4F71.dip0.t-ipconnect.de) (Ping timeout)
[02:24:49] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[02:27:11] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[02:28:41] <ChrisMorgan> cmr: could the r+ on https://github.com/mozilla/rust/pull/9522 be retracted? (See all my comments on it.) It's next on bors' queue.
[02:29:38] <cmr> ChrisMorgan: done
[02:30:27] <ChrisMorgan> Thanks.
[02:30:35] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[02:30:35] *** ChanServ sets mode: +ao dherman dherman
[02:30:37] <cmr> thanks for taking a closer look at it :)
[02:30:41] * cmr didn't notice the typos
[02:31:09] <ChrisMorgan> With my question on what `a + b` is syntax sugar for, is it always `(&a).add(&b)` (rather than `a.add(&b)`), or does it depend?
[02:31:29] <jyyou> derboi_c: segmented stacks does not work on freebsd i386
[02:32:20] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[02:32:43] *** Quits: canhtak (jeremy@moz-B197A39C.wl.t.ulaval.ca) (Quit: canhtak)
[02:33:03] <derboi_c> strcat: yes, but i don't lauch my prog in freebsd, freebsd is just my host compile
[02:33:32] <cmr> derboi_c: then you shouldn't be using --target, --target is for what platforms the compiler will be able to generate binaries for.
[02:34:23] <derboi_c> cmr: ok, so i must used what to just compile an 32bit code without os specifique target
[02:34:40] *** Quits: bytewise (bytewise@moz-4A801D04.unitymediagroup.de) (Quit: Leaving)
[02:36:44] *** Quits: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca) (Quit: Leaving.)
[02:37:00] <polyfractal> is there a way to capture stdout of a task?  I have a few unit tests that catch the failure, but still print the fail!()
[02:37:20] <cmr> polyfractal: tasks don't have separate stdout.
[02:37:22] *** Quits: zz_kimundi (kimundi@moz-822AC7D.dip0.t-ipconnect.de) (Ping timeout)
[02:37:30] *** Joins: vodik (simon@moz-2D668626.cpe.net.cable.rogers.com)
[02:37:33] <cmr> polyfractal: it'd need to not write to stdout to be filterable.
[02:37:42] <derboi_c> cmr: only --target give possibility to set and 32bit code no?
[02:38:06] <cmr> derboi_c: What is your end goal?
[02:38:17] <cmr> derboi_c: linux + #[no_std] might be acceptable.
[02:38:24] <derboi_c> cmr: do a 32 kernel
[02:38:29] <derboi_c> 32bit
[02:38:47] <cmr> derboi_c: use linux, and just use #[no_std]
[02:38:55] <cmr> (works for me just fine)
[02:39:21] <polyfractal> cmr: hm, ok.  Revision of question then…is there a way to catch the output of a fail!() macro ?
[02:39:29] <cmr> polyfractal: not currently no
[02:39:44] <polyfractal> cmr: ok, thanks.  Just a cosmetic issue anyhow :)
[02:40:16] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[02:40:17] <acrichto> brson: ping
[02:40:24] *** Joins: zz_kimundi (kimundi@moz-221F72D2.dip0.t-ipconnect.de)
[02:40:42] *** zz_kimundi is now known as kimundi
[02:41:18] * ChrisMorgan loves that he was able to get a rust-http plug to the top of the 0.8 HN thread https://news.ycombinator.com/item?id=6454443
[02:41:22] <derboi_c> cmr: already do
[02:41:52] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[02:42:08] <derboi_c> cmr: use linux => target i686-pc-linux? if yes, yes already done
[02:42:14] <cmr> derboi_c: yes
[02:42:33] <derboi_c> --lib add -ldl, -ldl doesn't exist on freeBSD
[02:42:47] <cmr> derboi_c: it doesn't need to
[02:42:56] <cmr> target is separate from host
[02:43:47] <derboi_c> Yes, but rustc force -ldl
[02:43:51] <derboi_c> and fail
[02:44:06] <polyfractal> ChrisMorgan: been meaning to look at the code but haven't gotten there yet…does rust-http server support POSTs (or more generically, just reading the request body)?
[02:44:17] <cmr> derboi_c: I use rustc -c and then link manually (which I need to do anyway to my kernel)
[02:44:33] <ChrisMorgan> polyfractal: yes, though not ideally yet.
[02:44:46] <ChrisMorgan> No transfer encoding support for reading, yet.
[02:45:21] <polyfractal> ChrisMorgan: awesome! will definitely play with it soon then :D
[02:46:06] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[02:46:08] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Connection reset by peer)
[02:46:10] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:46:11] <derboi_c> cmr: i do it, but with -c, you must set a main function, so you must add --lib, which in 32bin on freeBSB (i686-pc-linux) failed
[02:46:15] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[02:46:58] <derboi_c> You can't do separate compilation with rustc (i don't test with 0.8, i going to do it know)
[02:49:06] <derboi_c> it the same things with 0.8, you must have a main function if you want used "-c"
[02:50:34] <strcat> does -c --lib work?
[02:50:38] *** Joins: vk (chatzilla@moz-F552A44C.tmodns.net)
[02:50:58] *** Joins: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca)
[02:51:05] <strcat> can definitely use --lib --emit-llvm, and then compile the bytecode with clang + mix in C
[02:51:10] <derboi_c> strcat: no for 32bit code =/ need -ldl
[02:51:22] <derboi_c> strcat: ok i go try
[02:52:43] *** Quits: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca) (Ping timeout)
[02:54:02] <kmc> did I mention that I <3 <3 <3 having working debug info
[02:54:08] <kmc> it's so awesome to see rust code in GDB or objdump -S
[02:54:34] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[02:54:59] <sully> wait, that works now
[02:55:01] <sully> that is so good!
[02:55:05] <sully> can you step, or just see lines?
[02:55:56] <derboi_c> strcat: O.o if i say you that --emit-llvm do nothing, stdout empty, no file create...
[02:56:26] <jack> if i have a module called rust-foo-bar that ends up on disk as librust-foo-bar, how do i dclare it in extern mod?
[02:56:42] <derboi_c> 'rustc --emit-llvm -o libstd --lib libstd/mod.rs'
[02:56:47] <cmr> derboi_c: it should make a .bc file
[02:57:03] <cmr> -o frequently doesn't work correctly.
[02:58:36] <derboi_c> cmr: ok thakn
[02:58:51] <kmc> sully: you can step
[02:58:53] <kmc> not perfectly
[03:00:02] <engla> jack: wasn't it extern mod foo = "rust-foo-bar";?
[03:02:51] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[03:03:27] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[03:04:08] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[03:05:17] <jack> engla: yeah. i had tried that but it didn't work, but turns out there were two issues :)
[03:05:24] <jack> engla: that did end up working :)
[03:05:32] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Ping timeout)
[03:05:58] *** Quits: ercx__ (ercan@moz-7CFF3469.dyn.optonline.net) (Quit: WeeChat 0.4.1)
[03:06:52] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[03:06:54] <kmc> sully: I can also break by line number
[03:06:59] <kmc> although I can't print local variables
[03:07:05] <sully> nice to the first
[03:07:09] <sully> printing local variables seems hard
[03:07:11] <cmr> Ugh. Overlong borrows strike again :(
[03:07:31] <kmc> sully: yeah
[03:07:45] <brson> acrichto: pong
[03:08:07] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[03:08:16] <acrichto> brson: it appears that mac4 can't create a snapshot, but mac3 can, mac4 has routinely been getting some weird valgrind errors, and I'm wondering if there's a version mismatch
[03:08:24] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[03:08:26] *** Joins: pcwalton (pcwalton@moz-BE33DA21.fw1.sfo1.mozilla.net)
[03:08:26] *** ChanServ sets mode: +ao pcwalton pcwalton
[03:08:27] <acrichto> I'm trying to access them, but still working on that...
[03:10:54] <acrichto> Luqman: aha, it's building!
[03:11:14] <Luqman> awesome!
[03:11:23] <brson> acrichto: mac3 doesn't have valgrind installed
[03:11:46] <acrichto> brson: well that's depressing
[03:11:58] <acrichto> turns out there was a version mismatch!
[03:12:05] <cmr> heh
[03:12:34] <brson> acrichto: added your keys to mac3 and 4: administrator@rust-mac3.mv.mozilla.com
[03:12:46] <brson> mac5 and 6 aren't accessible by dns atm
[03:13:13] <brson> acrichto: https://github.com/mozilla/rust/issues/8267
[03:13:31] <acrichto> brson: ah that makes sense
[03:16:06] <acrichto> brson: hm, it appears I'm having ssh-agent forwarding difficulties, I'm not entirely trusting my gateway host (office.mozilla.org) right now
[03:18:08] *** Joins: mib_fxf76n (Mibbit@moz-5FB39C29.gae.googleusercontent.com)
[03:19:17] *** Quits: vodik (simon@moz-2D668626.cpe.net.cable.rogers.com) (Ping timeout)
[03:19:35] <mib_fxf76n> Hello guys. I've just tried the 0.8 version in windows. But it doesn't work.
[03:19:37] <mib_fxf76n> F:\Backup\Rust>rustc hello.rs error: internal compiler error: unexpected failure note: the compiler hit an unexpected failure path. this is a bug note: try running with RUST_LOG=rustc=1 to get further details and report the re sults to github.com/mozilla/rust/issues
[03:20:18] <acrichto> mib_fxf76n: oh dear that's not good, what was the code that you're compiling?
[03:20:51] <acrichto> Luqman: https://github.com/mozilla/rust/pull/9556
[03:20:53] <mib_fxf76n> the code on rust-lang.org
[03:21:04] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[03:21:13] <mib_fxf76n> A very small taste of what it looks like
[03:21:44] <acrichto> can you run it again with RUST_LOG=rustc=1 ?
[03:21:48] <acrichto> just to see what the output is
[03:21:51] <ChrisMorgan> "A very small taste of what it looks like: internal compiler error" :P
[03:22:33] <Luqman> acrichto: r+ :D
[03:22:43] <mib_fxf76n> and the code in the src/test/bench/shootout-binarytrees.rs
[03:22:54] <ChrisMorgan> mib_fxf76n: also, what OS are you using? Windows 7? 64-bit or 32-bit?
[03:22:56] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[03:23:05] <mcpherrin> hmm I just grabbed a windows system and installed 0.8.  I get "the program can't start because libgcc_s_dw201.dll is missing"
[03:23:05] <mib_fxf76n> windows 7 64-bit
[03:23:12] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[03:23:54] <acrichto> mib_fxf76n: I don't think that 64-bit rust on windows is working just yet
[03:23:54] <mib_fxf76n> I use the gcc_s_dw stdc++ pthread dll of MinGW 4.5.2
[03:24:12] <acrichto> mcpherrin: there's a series of hoops to jump through for rust on windows right now
[03:24:12] <mib_fxf76n> acrichto but the 0.7 version works
[03:24:19] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[03:24:37] <acrichto> mib_fxf76n: that may have been by luck more than anything else, it's not officially supported yet
[03:24:43] <mcpherrin> acrichto: I kinda assumed the installer would do those (I knew building it yourself had hoops)
[03:24:53] <mib_fxf76n> acrichto: how to turn on RUST_LOG=rustc=1
[03:24:57] <mcpherrin> I haven't used rust on windows before and it's not a lovely start :P
[03:25:19] <acrichto> mcpherrin: https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust
[03:25:21] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[03:25:33] <acrichto> mib_fxf76n: RUST_LOG=rustc=1 rustc hello.rs
[03:25:37] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Connection reset by peer)
[03:26:03] *** Joins: aeqwa (aeqwa@moz-2AF0000F.dsl.tropolys.de)
[03:26:04] <ChrisMorgan> mib_fxf76n: "set RUST_LOG=rustc=1"
[03:26:13] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[03:26:13] <ChrisMorgan> Then run "rustc hello.rs"
[03:26:14] <acrichto> mcpherrin: yeah we wish we had more time to work on this, but I think that the general idea is to move to a pure-llvm toolchain which would lift our dependency on mingw and would fix a lot of build issues
[03:26:26] <mcpherrin> I'll just stick to using linux :P
[03:26:33] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Client exited)
[03:26:40] <mib_fxf76n> acrichto: warning: invalid logging spec '1 ', ignoring it task <unnamed> failed at 'failure in CreateProcess: 绯荤粺鎵句笉鍒版寚瀹氱殑鏂囦 欢銆? ', C:\bot\slave\dist2-win\build\src\libstd\run.rs:532 error: internal compiler error: unexpected failure note: the compiler hit an unexpected failure path. this is a bug note: try running with RUST_LOG=rustc=1 to get further details
[03:26:43] <ChrisMorgan> acrichto: sorry, no inline environment variable setting in Command Prompt.
[03:26:59] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[03:27:14] <acrichto> ChrisMorgan: aww :(
[03:28:07] <acrichto> mib_fxf76n: yeah we may just be using the wrong versions of windows functions, that looks like a 64 vs 32 problem sadly
[03:30:47] <ChrisMorgan> And 绯荤粺鎵句笉鍒版寚瀹氱殑鏂囦 欢銆 doesn't make sense as UTF-16LE either (that was my first guess), nor does it appear to translate into English; is it genuine junk data?
[03:31:42] <klutzy> I guess it's chinese msg from GetLastError() api
[03:32:35] <mib_fxf76n> klutzy: yeah. I'm using a Chinese version of windows 7
[03:32:38] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[03:33:00] <erickt1> cmr: I removed the offending patch from https://github.com/mozilla/rust/pull/9352
[03:33:03] *** Quits: ross (ross@moz-5EA04060.br.br.cox.net) (Quit: )
[03:33:40] *** Joins: Ferreus_ (ferreus@moz-1C834CDB.dyn.telefonica.de)
[03:33:54] <mib_fxf76n> acrichto: Can it be fixed?
[03:33:59] *** Quits: vk (chatzilla@moz-F552A44C.tmodns.net) (Ping timeout)
[03:34:05] <acrichto> mib_fxf76n: not easily that I'm aware of
[03:34:06] <cmr> erickt1: I find myself feeling quite strongly about safe vs unsafe, but I've been wrong a lot in that area
[03:34:07] *** Quits: Ferreus (ferreus@moz-DEC4442C.dyn.telefonica.de) (Ping timeout)
[03:34:56] *** Quits: Jesin (Jessin_@moz-394702A3.cc.lehigh.edu) (Quit: Leaving)
[03:35:05] <erickt1> cmr: I understand what you mean, I'm just not sure what is "unsafe"
[03:35:32] <cmr> and tbh I can't remember the details of that patch anymore :p
[03:35:59] <erickt1> the main point was to micro optimize c_str.with_c_str
[03:36:11] *** Quits: bogen (dwight@moz-30A7F8A5.tx.res.rr.com) (Ping timeout)
[03:36:17] <erickt1> it was based off a suggestion from graydon back when I first made c_str
[03:38:16] <cmr> I love destructuring.
[03:38:21] <ChrisMorgan> mib_fxf76n: but does that message make sense? Google Translate can't make head or tail of it
[03:38:40] <Eridius> erickt1: what was the unsafe stuff? PR sadly doesn't keep history
[03:38:59] <mib_fxf76n> acrichto: :(. I wish Rust can work on windows. A lot of my friend are  interest in Rust. but, you know, they're not linux guys.
[03:39:23] <erickt1> Eridius: I want to remove `unsafe` from `ToCStr::with_c_str_unchecked`
[03:39:33] <cmr> Ah yes
[03:39:33] <Eridius> erickt1: no
[03:39:45] <cmr> The reason I didn't agree was because interior nulls can become security vulns.
[03:39:48] <tikue_> will rustpkg update git repos when running `rustpkg install <repo>` ?
[03:40:01] <acrichto> mib_fxf76n: we certainly plan on getting there! windows is a tier 1 platform for us and we're very interested in supporting it, it's just not quite there just yet
[03:40:06] <Eridius> erickt1: the `unsafe` is there because that function can be used to violate invariants
[03:40:06] <erickt1> Eridius: my argument is that this is not strictly unsafe, as some C apis work fine with interior nulls, and some do not
[03:40:18] <mib_fxf76n> ChrisMorgan: let me try. they're messy code on my machine.
[03:40:31] <Eridius> erickt1: CString represents a sequential block of non-NUL bytes terminated by a NUL
[03:41:09] <Eridius> erickt1: although the worst-case behavior of .to_c_str_unchecked() is that your resulting CString represents a block of memory that's smaller than the original
[03:41:19] <Eridius> i.e. "foo\0bar" becomes just "foo\0"
[03:41:35] <Eridius> which means that the invariant of "no interior NULs" is preserved. However, the resulting value is not what you'd expect, and does not represent the source value any longer
[03:41:44] <Eridius> which is why the `unsafe` is there, because it means you need to be sure
[03:42:00] <tikue_> or I suppose more generally, _can_ rustpkg update git repos?
[03:42:22] <cmr> tikue_: probably the only person who can answer that is not present
[03:42:27] <jack> anyone know what I'm doing wrong here? https://gist.github.com/metajack/6723825
[03:42:28] <erickt1> Eridius: technically you can say you need to be sure whenever you pass something to a C api :)
[03:42:42] <Eridius> erickt1: C APIs are going to be unsafe anyway
[03:43:06] <erickt1> Eridius: so then should all of the CStr functions be unsafe?
[03:43:15] <acrichto> jack: foo needs &self or some sort of self definition
[03:43:15] <nejucomo> tikue: I'm not sure, but in the first few hours of playing with go, it blew away (silently) my local changes to a third party package, and I've never trusted that model since.
[03:43:17] <Eridius> jack: foo is not a method, it's a function. You forgot the &self
[03:43:21] <sfackler> tikue_: https://github.com/mozilla/rust/issues/9476
[03:43:24] <Eridius> erickt1: no. Why would they be?
[03:43:29] * jack facepalms
[03:43:37] <Eridius> erickt1: I can use CStrings safely, and pass them to other safe APIs that take CStrings
[03:43:53] <ChrisMorgan> jack: you're triggering internal errors, that's the problem.
[03:43:59] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[03:44:07] <Eridius> nejucomo: the only Go command that clones or updates git repos is `go get`
[03:44:08] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[03:44:42] <nejucomo> Eridius: It may have been that then.
[03:44:45] <erickt1> Eridius: but as far as all the c compilers that I tested, none seem to consider having nulls in a C string as actually being unsafe
[03:44:48] <jack> extra::url::Url is private now? :(
[03:45:05] <ChrisMorgan> There's a PR for that.
[03:45:14] <Eridius> erickt1: that's because C can't tell the difference
[03:45:20] <Amaranth> erickt1: C compilers have some idea of safe/unsafe?
[03:45:21] <nejucomo> Anyway, I hope rustpkg makes it easy to say "please install the source code in /my/path/to/source without modifying anything in that directory".
[03:45:26] <tikue_> sfackler: thank you
[03:45:35] <jack> ChrisMorgan: are the docs not up to date? http://static.rust-lang.org/doc/master/extra/url/struct.Url.html
[03:45:49] <ChrisMorgan> jack: https://github.com/mozilla/rust/pull/9506
[03:45:54] <Eridius> erickt1: a CString _cannot_ have interior NULs. It's quite literally impossible to construct one, because at its core it just holds a *-ptr and everything that interprets a CString stops at the first NUL
[03:46:15] <jack> Oh. probably slightly out of date.
[03:46:19] <ChrisMorgan> jack: so, only fixed ten hours ago.
[03:46:44] <erickt1> Eridius: what do you mean? You can easily do `int main() { foo("foo\0bar"); }`
[03:46:44] * ChrisMorgan needs to rebuild rust; five days out of date
[03:46:56] <Eridius> erickt1: and "Foo\0bar" isn't a CStr. It's just a char*
[03:46:59] *** Joins: mib_0ift39 (Mibbit@360D50.EC0E66C4.8DE9D37C.IP)
[03:47:19] <Eridius> erickt1: not all char*'s are c-strings
[03:47:47] <nejucomo> Here's an example of an (at the time) widely-deployed critical security vulnerability due to different software interpreting nul characters as terminators or not: http://hackaday.com/2009/07/29/black-hat-2009-breaking-ssl-with-null-characters/
[03:48:06] <ChrisMorgan> Then too there are double-null-terminated lists, e.g. "item\0another\0yet more\0\0"...
[03:48:29] <Eridius> ChrisMorgan: yes, and those sorts of things don't use CString. They just use *libc::c_char
[03:48:34] <nejucomo> I'm not sure how relevant it is to the discussion, but if rust code and c code disagree on, say, the string length, that seems quite unsafe.
[03:48:40] <ldunn> hmmmm. Compiler failure compiling unit metadta :S
[03:48:52] <erickt1> Eridius: as far as I know, the only thing specified by a C String is that it's null terminated
[03:49:10] <Eridius> erickt1: not just NUL-terminated, but terminated by the first NUL
[03:49:12] *** Quits: eatkinson (eatkinson@moz-E57448EF.airbears2.berkeley.edu) (Quit: eatkinson)
[03:49:26] <Eridius> erickt1: as a trivial example, strlen() gives you the length of the C String. And it stops at the first NUL
[03:49:56] <erickt1> but that's just the api for one function
[03:50:42] <Eridius> erickt1: that's the definition of a C String
[03:50:44] <Amaranth> I think if you gave me something called CString that didn't just stop at the first \0 I'd probably write something with a security vulnerability because of it
[03:51:33] <Jesse> nejucomo: just one more way that calling C code is unsafe. but the new Rust lib should help by task-failing if you try to convert a rust string that contains an internal null into a C string.
[03:51:51] <nejucomo> One problem here is that there's no type in C for a nul-terminated char*, it's just a convention which happens to be widely but inconsistently deployed.
[03:52:29] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[03:52:38] * nejucomo runs man strncpy
[03:52:45] <mib_fxf76n> ChrisMorgan: the message is: System can not find the specified file.
[03:52:49] * Eridius idles to eat dinner
[03:52:54] <mib_fxf76n> warning: invalid logging spec '1 ', ignoring it task <unnamed> failed at 'failure in CreateProcess:  System can not find the specified file.', C:\bot\slave\dist2-win\build\src\libstd\run.rs:532 error: internal compiler error: unexpected failure note: the compiler hit an unexpected failure path. this is a bug note: try running with RUST_LOG=rustc=1 to get furt
[03:53:37] *** Joins: bogen (dwight@moz-8B4E7E75.dsl.rcsntx.swbell.net)
[03:55:24] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Ping timeout)
[03:56:11] <erickt1> Amaranth: so we do have two fns to make a CString: with_c_str, and with_c_str_unchecked. I'm just not sure if it's at the level of needing unsafe
[03:56:34] <engla> strcat: a bug fix for you https://github.com/mozilla/rust/pull/9557
[03:57:16] *** Joins: ciferkey (ciferkey@moz-BB7DAA60.wireless.umass.edu)
[03:57:20] <strcat> engla: I think it'd be better to use Option to avoid the static
[03:57:32] <engla> nice, that's even better
[03:58:40] * erickt1 checks the c standard...
[03:59:20] <engla> that's much better.
[03:59:24] <strcat> pcwalton: oh, I forgot about trying out https://github.com/mozilla/rust/issues/8957 (marking functions with unnamed_addr)
[03:59:32] <strcat> so mergefunc doesn't need to leave behind thunks
[03:59:56] <strcat> so it's actually better than that earlier number, if we go through with that
[04:00:15] <dbaupp> cmr: ah! the off-screen prompt; always a fun trick :(
[04:01:12] *** Quits: Ferreus_ (ferreus@moz-1C834CDB.dyn.telefonica.de) (Quit: WeeChat 0.4.1)
[04:01:23] <engla> strcat: you must have been thinking about this issue before, to come up with the None idea so quickly?
[04:01:39] <strcat> engla: I remember doing it somewhere else
[04:01:43] <strcat> might be in the stdlib, *shrug*
[04:02:29] <engla> well since {:?} is safe now, we have to do this change ^^
[04:06:59] *** Quits: mib_0ift39 (Mibbit@360D50.EC0E66C4.8DE9D37C.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:07:07] *** Quits: ciferkey (ciferkey@moz-BB7DAA60.wireless.umass.edu) (Quit: )
[04:08:13] <erickt1> cmr / Eridius: according to the c99 standard in 6.4.5 there's no mention of not allowing nulls. It's just that most, but not all, apis that take char* stop at null. I'm okay with keeping this unsafe, I'm just used to using `unsafe` to mark functions that if used incorrectly, will cause a segfault or memory corruption or etc
[04:08:48] <erickt1> cmr / Eridius: http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1124.pdf
[04:09:33] <Jesse> i'd rather rename "_unchecked" to something more precise than force the function to be unsafe
[04:09:36] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[04:09:44] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[04:09:48] <Jesse> say exactly what it isn't checking or what it does
[04:10:53] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[04:11:29] <engla> a C string can't have interior zero bytes, since it ends at the first zero byte encountered
[04:11:51] <erickt1> Jesse: say "with_c_str_allow_interior_nulls"?
[04:12:27] <Jesse> sure
[04:13:06] *** Quits: lmandel (lmandel@moz-76CE9D51.cable.teksavvy.com) (Quit: lmandel)
[04:14:33] <erickt1> engla: but as far as I know, there's no strict definition of what exactly is a c string, which is what is making this so complicated
[04:15:03] <engla> well it should be simple
[04:15:09] <kmc> "with_c_str_nulls_as_overlong_utf8"  </bad_ideas>
[04:15:28] <erickt1> lol
[04:15:37] <engla> you're pointing at the string literal section which allows you to create arbitrary byte arrays (with a terminating zero byte)
[04:16:08] <erickt1> kmc: that is a good point though, I'm curious what the C utf8 apis do. I believe utf8 allows for interior nulls, so I wonder if those apis all take lengths
[04:16:17] <kmc> fyi some linkers will merge suffixes of literal strings in the special string literal section
[04:16:46] <kmc> erickt1: well NUL is a Unicode character like any other, and since it's under 128, its encoding matches ASCII, the single byte 00
[04:17:15] <engla> "A byte with
[04:17:15] <engla> all bits set to 0, called the null character, shall exist in the basic execution character set; it
[04:17:18] <engla> is used to terminate a character string.
[04:17:21] <kmc> but also you can construct a multi-byte UTF-8 sequence whose payload bits are all zero, and while that's not legal UTF-8, many programs will interpret it as the codepoint zero, but it doesn't contain any zero bytes
[04:17:31] <kmc> that's the "overlong encoding"
[04:17:44] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[04:18:03] *** Quits: jgilbert (jgilbert@moz-2763DC04.hsd1.ca.comcast.net) (Ping timeout)
[04:18:08] <engla> 0xC0 0x80 is one popular encoding of 0
[04:18:11] <kmc> but it's illegal in standard UTF-8 and you can't expect software to do anything reasonable with it
[04:18:12] <engla> also invalid
[04:18:14] <kmc> yeah http://en.wikipedia.org/wiki/UTF-8#Modified_UTF-8
[04:18:23] <erickt1> engla: where did you find that?
[04:18:37] <engla> 5.2.1 in C99
[04:18:50] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[04:19:19] <engla> anyway, a string literal can clearly be used to create an array that contains "more" than just one c string.
[04:19:32] <strcat> it's generally just wrong to use C strings for anything but file paths
[04:19:37] <strcat> or some identifier specific to the library
[04:19:39] *** Joins: nejucomo1 (Adium@moz-434492BB.dsl.static.sonic.net)
[04:19:41] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Connection reset by peer)
[04:19:54] <erickt1> strcat: totally agree. c strings are dumb :)
[04:20:03] <nejucomo1> I have within an rs: mod a { use parent::utils::thing; fn blah() { … thing … } } mod utils { … fn thing … }
[04:20:09] <nejucomo1> -but this does not resolve.
[04:20:16] <nejucomo1> What am I missing?
[04:20:23] *** nejucomo1 is now known as nejucomo
[04:20:42] <erickt1> engla: Okay you convinced me :) 5.2.1 is why with_c_str_unchecked should be unsafe then
[04:20:46] <strcat> erickt1: very happy that we don't have \0 at the end of our strings anymore like C++
[04:20:48] <erickt1> thanks for finding it
[04:21:08] <strcat> it made them very quirky...
[04:21:18] <nejucomo> Oh, it's "super" not "parent"...
[04:21:51] <erickt1> strcat: yeah they were weird to work with
[04:22:22] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[04:22:45] <engla> hehe this conversation. some of us know the C string representation as a fundamental law
[04:23:19] <erickt1> engla: the problem is I've run into some C apis that don't care about that fundamental law :(
[04:23:58] <pcwalton> looks like servo is 30% faster than both gecko and webkit on this reflow page
[04:24:04] <pcwalton> first raw throughput result
[04:24:10] <erickt1> pcwalton: that's awesome!
[04:24:12] <pcwalton> cautiously optimistic, like all benchmarks it could be wildly wrong!
[04:24:18] <erickt1> heh
[04:24:29] <pcwalton> btw no parallelism yet
[04:24:31] <pcwalton> that comes later
[04:25:28] <erickt1> engla: of course, I think most of those violations are from windows api. For example, GetEnvironmentStringsA
[04:25:57] <Amaranth> I thought 0xC0 0x80 was mostly only used by Java
[04:26:10] <Amaranth> Then again I'd never actually heard of anything using it until recently
[04:28:29] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[04:29:17] *** Joins: seryogah (holoirc@moz-7E93FB81.dip0.t-ipconnect.de)
[04:29:18] <dbaupp> pcwalton: \o/
[04:29:29] *** Quits: tikue_ (tkuehn@B489EA5.B9B3942C.689607DE.IP) (Quit: tikue_)
[04:29:42] <nejucomo> erickt1: I'm not so sure *most* of the violations are in the windows api.  ;-)
[04:29:49] <pcwalton> as far as I can tell it's mostly just because I looked at the asm and tweaked compiler optimizations until it got faster ;)
[04:29:52] <pcwalton> there's nothing really magical about it
[04:30:21] *** Quits: mib_fxf76n (Mibbit@moz-5FB39C29.gae.googleusercontent.com) (Quit: http://www.mibbit.com ajax IRC Client)
[04:31:38] <strcat> engla: the sane way is taking uint8_t * and size_t ;p
[04:31:47] <strcat> then you get speed + compatibility with anything
[04:31:53] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[04:31:53] *** ChanServ sets mode: +ao dherman dherman
[04:31:57] <erickt1> well anyway, it doesn't matter. c strings by definition don't include interior nulls, so I was wrong :)
[04:32:02] <strcat> also, UTF-8 in signed chars (which is common, for char) is awful
[04:34:03] *** Joins: MrOrdinaire (Mibbit@1143DEE0.A607747.FD383126.IP)
[04:34:47] <engla> strcat: yes, I think there are lots of applications where it makes sense to use utf-8 in zero-terminated strings though
[04:36:01] <dbaupp> engla: (as long as you're very careful about it)
[04:39:37] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[04:39:44] *** Joins: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net)
[04:41:17] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[04:43:51] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Client exited)
[04:44:55] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[04:47:41] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[04:49:27] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[04:49:42] <jeaye> Congrats on 0.8, folks. Good work, as usual. :)
[04:50:04] <erickt1> jeaye: how's all your graphics stuff coming along?
[04:50:35] <jeaye> It's coming! Slowly but steadily.
[04:52:03] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[04:52:10] <jeaye> Darn @fn was removed. :(
[04:52:15] <erickt1> cool, I hope to use it someday
[04:52:48] <jeaye> That'd be great! Thanks for asking.
[04:53:42] *** Quits: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net) (Client exited)
[04:53:58] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[04:54:09] <erickt1> jeaye: how's the cross over between your stuff, and that physics stuff that showed up a month or so ago? are you using it, or developing your own for q3?
[04:54:17] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[04:55:18] <jeaye> I'm not yet performing any physics calculations. When I do, I'll probably roll my own minimalistic implementation that's very tailored to q3.
[04:55:21] *** Quits: pcwalton (pcwalton@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: pcwalton)
[04:55:50] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[04:56:14] *** Joins: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net)
[04:56:15] <jeaye> Physics should happen much later down the road though. I'd like to get some networking going first, to ensure physics are written with networking in mind.
[04:56:52] <jeaye> Aside from Windows builds, getting basic networking is the next biggest challenge for 0.3
[04:57:20] <erickt1> jeaye: are you going raw sockets? or have you considered zeromq/nanomsg?
[04:57:48] <jeaye> My intentions were to use raw sockets, since that's what I've most experience with.
[04:58:01] <jeaye> But those others may be equally suited for the task.
[04:58:12] <jeaye> Do you recommend any?
[04:58:34] <nejucomo> When I run: rust test —help   -I get the output of rustc —help
[04:58:41] <nejucomo> Same for some other rust subcommands.
[04:59:03] <nejucomo> Is there a ticket for this?  -or is that the desired behavior?
[04:59:03] <nejucomo> (I figured out that I meant: rust help test)
[04:59:29] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[04:59:44] <erickt1> jeaye: the one downside to those two is they lean towards maximizing throughput over latency. But zeromq at least has a huge following in the high frequency trading, so it could be worth checking out
[04:59:47] <jeaye> nejucomo: rust help test
[05:00:28] *** Quits: aeqwa (aeqwa@moz-2AF0000F.dsl.tropolys.de) (Quit: Lost terminal)
[05:00:49] <jeaye> erickt1: Thanks for the heads up. I'll be sure to consider it before starting.
[05:01:02] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[05:01:10] <dbaupp> nejucomo: there's probably not a bug, but it's probably worth filing one
[05:01:12] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[05:01:29] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[05:01:38] <dbaupp> nejucomo: (the behaviour is because the rust tool passes the trailing arguments straight to rustc without looking at them at all.)
[05:01:53] *** Joins: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP)
[05:01:53] *** ChanServ sets mode: +o jdm
[05:02:54] <nejucomo> dbaupp: Yeah, I figured as much, after a moment of confusion.
[05:02:56] *** Quits: SteveMcQwark (steven099@moz-7CFCF343.cpe.net.cable.rogers.com) (Quit: SteveMcQwark)
[05:04:53] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[05:04:59] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[05:05:03] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Connection reset by peer)
[05:07:22] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[05:07:33] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[05:10:43] * nejucomo ponders &~[T] versus &[T]
[05:11:38] <jack> If you can't have an empty impl, do you do derive an empty trait?
[05:11:46] <dbaupp> nejucomo: would you like an explanation?
[05:11:55] <dbaupp> jack: you can have one, can't you?
[05:12:03] <dbaupp> rusti: trait Foo {} impl Foo for uint {}
[05:12:04] -rusti- ()
[05:12:04] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[05:12:12] <jack> error: obsolete syntax: empty implementation
[05:12:35] <nejucomo> dbaupp: Well..  I never even considered &~[T], until I realized I have a trait method which takes &K for impl K, then wrote an impl for ~[T]...
[05:12:43] <tikue> rusti: struct Foo; impl Foo {}
[05:12:44] -rusti- ()
[05:13:06] <nejucomo> dbaupp: Sure.
[05:13:09] <jack> ah. i htink you need hte {} now, but didn't used to
[05:13:19] <tikue> jack: that was changed within the past few days i think
[05:13:23] <dbaupp> jack: ah, right. yeah, acrichto changed that
[05:13:25] * tikue remembers seeing the pr
[05:13:46] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[05:13:56] <tikue> jack: that error message could be less ambiguous
[05:14:15] <nejucomo> dbaupp: Actually, now that I'm thinking about it, I'm wondering how:  fn f(x: &[T]) {} ; f(~[])  // actually works (or if it even does)...
[05:14:16] <tikue> "obsolete syntax: semicolon-terminated empty implementation
[05:14:33] * nejucomo opens the borrow tutorial again.
[05:14:39] <dbaupp> nejucomo: &~[T] is the same as &S with S = ~[T], i.e. it's just a reference to a vector. &[T] is a slice, which is a pointer + length, so it points into another vector allocated somewhere. @[T], ~[T] and [T, ..n] all automatically coerce to &[T]
[05:15:21] <dbaupp> nejucomo: i.e. v: ~[T] -> &[T] is basically transmuting the tuple (data pointer of v, v.len())
[05:15:24] <nejucomo> dbaupp: Ah, thanks for the reminder.
[05:15:45] <nejucomo> So ~[T] -> &[T] moves the unique ptr, right?
[05:15:50] <dbaupp> no
[05:15:54] <dbaupp> it's a borrow
[05:16:03] <nejucomo> Oh… of course.
[05:16:05] <dbaupp> just like ~T -> &T without moving too
[05:16:57] <nejucomo> So ~[T] -> &[T] is a special case of borrowing (because a slice is created), compared to general ~T -> &T ?
[05:17:27] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[05:18:34] <nejucomo> I have a trait similar to: trait MyT { fn send(&self, consumer: &mut A); fn recv(producer: &B) -> Self }
[05:19:09] <nejucomo> I wrote an impl for ~[T]…  but I kind of wish I could write one impl for "vectors"…  I don't see how it's possible, though.
[05:19:22] <tikue> in rust-lang.org code sample, x doesn't need to be twice-dereferenced if nums is initialized as `let nums = [0i, 1, 2, 3];`
[05:19:33] * tikue thinks it'd be nicer
[05:19:52] <strcat> or we could make a new example with shinier things
[05:20:00] <tikue> strcat: yes i agree with that too 
[05:20:15] <dbaupp> nejucomo: yes ~[] borrowing is a special case, you can write an imp for &'self [T], since the other vectors will actually autoborrow and use this impl
[05:20:19] <tikue> strcat: any ideas/
[05:20:24] <strcat> nope!
[05:20:26] <strcat> ;p
[05:20:35] <tikue> well for starters, what do you consider "shiny"
[05:20:42] <jack> chain is now map_move righ?
[05:20:48] <tikue> jack: for what?
[05:20:53] <strcat> jack: it's and_then
[05:20:55] <jack> oh, and_then i bet
[05:20:56] <nejucomo> dbaupp: What would the static "recv" method return for an &'self [T] impl?
[05:20:59] <dbaupp> rusti: trait Foo { fn foo(&self) {} } impl<'self,T> Foo for &'self [T] {} (~[1,2]).foo() // nejucomo 
[05:20:59] -rusti- ()
[05:21:22] <strcat> jack: https://github.com/mozilla/rust/pull/9359 fwiw, my proposal to make the API much smaller
[05:21:22] <dbaupp> nejucomo: oh, I see. yeah, I don't think that would work, if it returns Self.
[05:21:23] * tikue anticipates another big option name change on the horizon...
[05:21:37] <strcat> jack: er, linked to the pull rather than the issue with the explanation
[05:21:46] <nejucomo> Maybe I should break up send and recv into two traits...
[05:21:55] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Client exited)
[05:22:03] *** Joins: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp)
[05:22:45] <nejucomo> I think that would have better code reuse…  It doesn't make sense to recv an &[T] but it does make sense to send one, so I think there's actually more asymmetry than I first realized.
[05:23:26] <nejucomo> Well…  off to various night-time non-IRC activities.  Thanks for clarifying dbaupp.
[05:23:29] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[05:23:55] *** Joins: Zhouxuan (Mibbit@929AFF50.56C2F0D6.49CF464C.IP)
[05:27:22] *** Joins: Shaladdle (Shaladdle@moz-424BC304.hsd1.pa.comcast.net)
[05:27:33] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[05:29:26] *** Joins: minzh (Mibbit@AEC6E6CC.5CE80800.D2BA945D.IP)
[05:32:09] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[05:32:15] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[05:33:03] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[05:33:57] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[05:34:04] *** Quits: GeneralMaximus (ankur@60889107.85AE207.274D17D6.IP) (Ping timeout)
[05:35:41] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[05:35:55] *** Joins: hornetblack (Mibbit@2AFB1FEA.819E143E.2FD8C834.IP)
[05:36:17] *** Quits: hornetblack (Mibbit@2AFB1FEA.819E143E.2FD8C834.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:42:49] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[05:43:05] *** Quits: vk (chatzilla@moz-389FEE13.hsd1.ca.comcast.net) (Quit: ChatZilla 0.9.90.1 [Firefox 24.0/20130911164256])
[05:46:50] *** Joins: GeneralMaximus (ankur@D2B0412E.F036F587.BE90E62C.IP)
[05:53:30] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[05:55:00] *** Joins: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net)
[05:55:31] <jdm> good old U-NOV2010\eugals
[05:55:37] <jdm> glad to see their contributions to rust 0.8 being recognized
[05:56:01] <strcat> ha
[05:56:08] *** Quits: minzh (Mibbit@AEC6E6CC.5CE80800.D2BA945D.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[05:58:33] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[06:02:17] * tikue just read the condition tutorial
[06:02:24] <tikue> they seem really cool; i haven't seen much rust code with them though
[06:02:33] <tikue> s/much/any
[06:04:13] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:05:18] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[06:05:26] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[06:05:33] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[06:06:05] *** Joins: maik (maik@moz-82B7232D.dip0.t-ipconnect.de)
[06:06:41] *** Joins: fabiand (fabiand@moz-3EE5E08C.adsl.alicedsl.de)
[06:07:08] *** Quits: jdm (jdm@92FB48CA.8B5E9DF.9A8C35B4.IP) (Ping timeout)
[06:08:46] *** Joins: unbloat (unbloat@5BC9F1D1.3238CD1B.A3D1B221.IP)
[06:09:29] *** Joins: valenting (Thunderbir@C6866972.77435D89.FB866788.IP)
[06:09:46] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[06:09:46] *** ChanServ sets mode: +o jdm
[06:16:10] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[06:17:05] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[06:21:39] *** Quits: azita (Azita@moz-C1FB2A8.hsd1.ca.comcast.net) (Quit: azita)
[06:26:23] *** Quits: maik (maik@moz-82B7232D.dip0.t-ipconnect.de) (Ping timeout)
[06:28:23] *** Joins: umbs (Mibbit@C84B2351.15F2CAE9.AE5E6562.IP)
[06:29:04] *** Quits: umbs (Mibbit@C84B2351.15F2CAE9.AE5E6562.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[06:33:52] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[06:35:53] *** Joins: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP)
[06:36:08] *** Quits: alisdair (textual@1697D94C.7742FB18.FBC8476D.IP) (Quit: Textual IRC Client: www.textualapp.com)
[06:37:15] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[06:42:02] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: WeeChat 0.4.1)
[06:44:18] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[06:46:28] *** Quits: valenting (Thunderbir@C6866972.77435D89.FB866788.IP) (Ping timeout)
[06:51:50] <hansjorg> No release-0.8 tag in git yet?
[06:52:25] <acrichto> this time it was only called 0.8 I think
[06:55:53] *** Joins: sergi (textual@moz-DB55470C.upc-a.chello.nl)
[06:56:20] *** Quits: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Quit: Bye!)
[06:56:26] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[07:00:06] *** Joins: blinky (Mibbit@moz-A52338A8.pools.arcor-ip.net)
[07:03:45] <strcat> nicer git describe version that way
[07:04:15] <strcat> % git describe                                       
[07:04:17] <strcat> 0.8-39-geb3ebb7
[07:04:30] <strcat> last tag 0.8, 39 commits since then, current id is eb3...
[07:04:41] <strcat> (for the 0.8 commit itself it'll just say 0.8)
[07:04:56] <strcat> anyway usable as an ever-incrementing nightly pkg version.
[07:05:21] <hansjorg> Ah, ok. 0.8 it is then. Was just relying on x-release in a script :)
[07:06:01] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[07:07:26] *** Quits: santiago (santiago@moz-8ADE82B4.socal.res.rr.com) (Quit: Textual IRC Client: http://www.textualapp.com/)
[07:08:07] *** jack is now known as jack|zzz
[07:08:18] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[07:11:48] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[07:12:29] *** Joins: santiago (santiago@moz-8ADE82B4.socal.res.rr.com)
[07:13:12] *** Quits: blinky (Mibbit@moz-A52338A8.pools.arcor-ip.net) (Quit: http://www.mibbit.com ajax IRC Client)
[07:21:02] *** Joins: jason_ (jason@moz-EC85D533.members.linode.com)
[07:21:36] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[07:21:49] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[07:24:20] *** Joins: jviereck (Adium@moz-D03659.dip0.t-ipconnect.de)
[07:29:01] *** Quits: jviereck (Adium@moz-D03659.dip0.t-ipconnect.de) (Quit: Leaving.)
[07:30:25] *** Quits: ronny (ronnypfa@moz-E7EE6ABE.uberspace.de) (Quit: fsck server aliases)
[07:32:35] *** flaper87|afk is now known as flaper87
[07:33:34] *** Joins: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[07:33:44] *** Joins: squiddy (squiddy@moz-3674C0.adsl.alicedsl.de)
[07:37:43] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[07:39:41] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[07:41:06] *** Joins: tgummerer (tgummerer@moz-5DC8FA44.tbcn.telia.com)
[07:41:31] *** Joins: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net)
[07:42:59] <glyc> Hey guys, if I write a test and it fails!(), I'd like to have it print out the doc attribute for the failing test. Is the text of the doc available to the function someway? i.e. can I printfln!("failed test describes itself as: %s", docstring); ?
[07:43:12] *** Quits: tgummerer (tgummerer@moz-5DC8FA44.tbcn.telia.com) (Ping timeout)
[07:45:14] <strcat> glyc: no, it's not available at runtime
[07:45:31] <flaper87> w0000t, 0.8 is out! :D
[07:45:44] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[07:45:44] <flaper87> damn, I've got to figure out what's going on with this code
[07:45:59] <glyc> strcat: drat. workaround come to mind?
[07:46:11] <strcat> glyc: I don't think there's really any way to do it atm
[07:46:18] <strcat> there could be
[07:46:23] <strcat> just not implemented
[07:46:26] <ChrisMorgan> With difficulty, you could preprocess it using rustdoc and generate code...
[07:47:01] <glyc> it does seem kindof extra-linguistic, because I only want it to be printed if the test fails
[07:47:03] <ChrisMorgan> I actually mean closer to "preprocess it and with the assistance of librustdoc generate code"
[07:47:50] <ChrisMorgan> (libsyntax could also be used directly, but my guess is that librustdoc would make it easier.)
[07:51:24] <glyc> let me suppose that I've been supplied with a list of the names of some failing tests, and I want to print out the #[doc] comments for them
[07:51:49] <ChrisMorgan> That would be much more attainable. Not certain how difficult it would be.
[07:52:06] <glyc> I'm guessing librustdoc might help, but not sure where to start
[07:52:39] <ChrisMorgan> Bah, docs don't seem to be made automatically for librustdoc.
[07:52:59] <glyc> meta-bah!
[07:53:06] <glyc> :-)
[07:53:28] *** Quits: MrOrdinaire (Mibbit@1143DEE0.A607747.FD383126.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:54:51] *** Joins: sk (sk@D904A3B4.50B2D8C.78DD174B.IP)
[07:55:53] <ChrisMorgan> (Solution there: `rustdoc html -o doc/ src/librustdoc/rustdoc.rs`.)
[07:55:58] <ChrisMorgan> But sorry, I've got to go now.
[07:56:15] <glyc> I'm not seeing a section on docs in the manual, is there a discussion about them someplace?
[07:56:23] *** Joins: ceninan (ceninan@moz-6BD43586.a370.priv.bahnhof.se)
[07:56:27] <glyc> thanks Chris
[07:56:47] <ChrisMorgan> Go to your rust repo clone and run that rustdoc command, then open doc/rustdoc/index.html.
[07:56:55] <ChrisMorgan> May or may not help.
[07:57:40] *** Joins: nkoep (nik@moz-FA1A612A.pool.mediaways.net)
[07:57:41] *** Joins: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[07:58:09] <glyc> great, thanks. checking it out ...
[07:58:13] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[07:58:35] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[08:07:23] *** Quits: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[08:10:09] *** Quits: Ralith (ralith@moz-36466B9F.customer.broadstripe.net) (Ping timeout)
[08:13:33] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Ping timeout)
[08:14:13] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[08:14:33] *** Joins: Ralith (ralith@moz-36466B9F.customer.broadstripe.net)
[08:14:55] *** Quits: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca) (Ping timeout)
[08:15:00] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: sleep)
[08:18:25] *** Quits: msingle (Thunderbir@moz-1A29E89B.nrflva.fios.verizon.net) (Ping timeout)
[08:20:39] *** Quits: Ke (jkarlson@moz-40397852.org.aalto.fi) (Quit: leaving)
[08:21:32] *** Quits: unbloat (unbloat@5BC9F1D1.3238CD1B.A3D1B221.IP) (Quit: Leaving)
[08:21:54] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[08:22:25] *** Quits: GeneralMaximus (ankur@D2B0412E.F036F587.BE90E62C.IP) (Ping timeout)
[08:26:23] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[08:27:34] *** Joins: GeneralMaximus (ankur@9100E1CF.9857D29E.BE90E62C.IP)
[08:28:20] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[08:29:59] *** Joins: jaen (jaen@moz-520261D4.neoplus.adsl.tpnet.pl)
[08:31:11] *** Joins: rwall (rwall@moz-820DAEA7.biscuit.org.uk)
[08:31:26] *** Joins: gabriel (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net)
[08:33:32] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[08:34:10] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[08:34:36] *** Joins: CarpNet (ac@moz-FD24B77.sohonet.co.uk)
[08:35:27] *** Quits: Tad (Tom@moz-C8B2B6F7.navalrp.co.uk) (Ping timeout)
[08:36:42] *** Joins: Associat0r (Associat0r@moz-ACC51C1E.upc-h.chello.nl)
[08:37:01] *** Quits: Shaladdle (Shaladdle@moz-424BC304.hsd1.pa.comcast.net) (Quit: Leaving)
[08:38:24] *** Parts: sergi (textual@moz-DB55470C.upc-a.chello.nl) (Textual IRC Client: www.textualapp.com)
[08:41:09] *** Quits: Associat0r (Associat0r@moz-ACC51C1E.upc-h.chello.nl) (Quit: Associat0r)
[08:41:32] *** Quits: KindOne (KindOne@F96FB12C.9C5C45A3.EC6A1518.IP) (Ping timeout)
[08:41:54] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[08:43:35] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[08:44:31] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[08:44:59] *** Joins: Ms2ger (Ms2ger@9D0A393.CB23CDC6.3773EA9F.IP)
[08:45:17] *** Joins: KindOne (KindOne@3D81F738.EA06E3F.34F73994.IP)
[08:49:29] *** Joins: calatalee (Mibbit@48E49EEC.9674D649.86279662.IP)
[08:50:44] *** Quits: KindOne (KindOne@3D81F738.EA06E3F.34F73994.IP) (Ping timeout)
[08:52:28] *** Joins: Earnestly (earnest@moz-BE290A2B.dyn.plus.net)
[08:54:31] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[08:54:38] *** Joins: KindOne (KindOne@A91E4B9D.B3929A3A.34F73994.IP)
[08:56:29] *** rwall is now known as rwall_
[08:57:40] *** Joins: alex-abreu (alex@moz-7421D6C9.mc.videotron.ca)
[08:59:44] *** rwall_ is now known as rwall
[09:00:20] *** Quits: calatalee (Mibbit@48E49EEC.9674D649.86279662.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:01:52] *** Quits: KindOne (KindOne@A91E4B9D.B3929A3A.34F73994.IP) (Ping timeout)
[09:02:58] *** Quits: Zhouxuan (Mibbit@929AFF50.56C2F0D6.49CF464C.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[09:05:52] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[09:05:52] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[09:06:07] *** Joins: KindOne (KindOne@moz-D75CF3E3.dynamic.ip.windstream.net)
[09:06:42] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[09:10:14] *** Seld is now known as Seldaek
[09:14:53] <bjz> what is the location of the linux nightly builds?
[09:15:36] <dbaupp> bjz: which distro?
[09:15:55] <bjz> http://www.reddit.com/r/programming/comments/1n7qqz/rust_08_released/ccgb6xv?context=3
[09:16:22] <dbaupp> there's strcats arch one, and there's a ubuntu one around
[09:16:25] *** Joins: victorporof (victorporo@77FE7E86.477C3F8E.79933D60.IP)
[09:16:30] <dbaupp> dunno the links
[09:16:35] <bjz> mmk
[09:17:13] <dbaupp> google told me ;P
[09:17:19] <hansjorg> bjz: for ubuntu: https://launchpad.net/~hansjorg/+archive/rust
[09:19:45] *** Quits: ceninan (ceninan@moz-6BD43586.a370.priv.bahnhof.se) (Client exited)
[09:20:38] <dbaupp> bjz: commented
[09:21:02] <bjz> oh, me too
[09:21:05] <bjz> :P
[09:21:34] * dbaupp was 17 seconds faster \o/
[09:21:36] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[09:22:19] <dbaupp> bjz: commented on your comment :P
[09:22:54] * bjz thinks it is incumbent upon him to comment on you comment on my comment
[09:23:22] <quvarxa> How do I go from ~[&str] to **c_char ?
[09:24:16] <Ms2ger> With a bit of work, probably... &str isn't null-terminated
[09:24:44] <dbaupp> quvarxa: you'll need to make a ~[*c_char] (via std::c_str) and then convert this to a **c_char with .as_imm_buf
[09:25:04] <quvarxa> Thanks!
[09:25:25] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[09:26:04] <dbaupp> quvarxa: to be safe you'll actually need a ~[std::c_str::CString] and then use that to make a ~[*c_char], and keep the ~[CString] vec around for at least as long as the **c_char is used
[09:26:34] * dbaupp files a bug to make this easier to use, since it's a little subtle to get correct
[09:33:15] *** Joins: Lanlord (Lanlord@moz-570D039C.cable.mindspring.com)
[09:33:59] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Ping timeout)
[09:34:17] *** Joins: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au)
[09:35:50] *** Quits: Lanlord (Lanlord@moz-570D039C.cable.mindspring.com) (Quit: Leaving)
[09:39:09] *** Joins: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP)
[09:45:37] *** Quits: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP) (Ping timeout)
[09:47:32] *** Joins: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[09:50:36] <Ms2ger> "Functional programming combines the flexibility and power of abstract mathematics with the intuitive clarity of abstract mathematics."
[09:50:37] <Ms2ger> Discuss
[09:50:51] <ldunn> "haha"
[09:51:26] *** Quits: fyolnish (fyolnish@moz-BE2BAE5B.miinet.jp) (Client exited)
[09:53:42] <myname> funny quote
[09:59:20] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[10:05:23] *** Quits: victorporof (victorporo@77FE7E86.477C3F8E.79933D60.IP) (Quit: victorporof)
[10:08:13] *** Joins: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com)
[10:08:16] *** Quits: doomlord_ (servitor@moz-2BA2D1DA.range86-184.btcentralplus.com) (Connection reset by peer)
[10:11:45] *** Joins: doomlord_ (servitor@moz-2BA2D1DA.range86-184.btcentralplus.com)
[10:12:02] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:12:38] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Max SendQ exceeded)
[10:13:48] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[10:19:10] *** Joins: BitPuffin (isak@moz-49828767.cust.tele2.se)
[10:19:37] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[10:19:57] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[10:23:25] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:25:07] *** Quits: gabriel (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[10:32:01] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[10:33:46] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[10:34:25] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[10:36:07] *** Quits: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP) (Ping timeout)
[10:41:55] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[10:44:05] <dbaupp> quvarxa: fwiw, https://github.com/mozilla/rust/issues/9564
[10:44:08] *** Joins: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP)
[10:45:20] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[10:47:47] *** Joins: victorporof (victorporo@8AB918FF.D4B9BCD.9B1E38F4.IP)
[11:03:34] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[11:03:53] *** Joins: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com)
[11:09:47] *** Quits: seryogah (holoirc@moz-7E93FB81.dip0.t-ipconnect.de) (Ping timeout)
[11:23:13] <dbaupp> cmr: ping
[11:25:30] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[11:31:18] *** Joins: n1nja (Mibbit@moz-DADBCFB6.hsd1.il.comcast.net)
[11:31:30] <n1nja> so you guys probably get this a lot
[11:31:36] <n1nja> but any good Eclipse plugins for rust?
[11:33:22] *** Quits: n1nja (Mibbit@moz-DADBCFB6.hsd1.il.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[11:39:31] *** Quits: jaen (jaen@moz-520261D4.neoplus.adsl.tpnet.pl) (Ping timeout)
[11:40:36] *** Joins: maik (maik@moz-82B7232D.dip0.t-ipconnect.de)
[11:40:44] *** Quits: GeneralMaximus (ankur@9100E1CF.9857D29E.BE90E62C.IP) (Ping timeout)
[11:46:13] *** Joins: novabyte (novabyte@74BB045.6F0D1B91.366C66F5.IP)
[11:47:02] <pnkfelix> n1nja: Not to my knowledge.  We have some editor plugins in src/etc/ but there isnt one for eclipse there.
[11:47:41] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[11:47:45] <pnkfelix> (oh darn, he disappeared behind a smoke bomb)
[11:48:36] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[11:49:07] <dbaupp> :( its a little sad when a newbie pops in and out without a response during these quite few hours.
[11:49:26] <myname> people use eclipse?
[11:49:44] <dbaupp> *quiet
[11:49:53] *** Quits: nkoep (nik@moz-FA1A612A.pool.mediaways.net) (Client exited)
[11:50:03] <ldunn> Android dev used to be more or less locked to Eclipse, didn't it?
[11:50:26] <pnkfelix> myname: I found eclipse wasn't so bad for reading source code if one had a *ton* of screen real estate
[11:50:42] *** Joins: nkoep (nik@moz-FA1A612A.pool.mediaways.net)
[11:53:13] *** Quits: nkoep (nik@moz-FA1A612A.pool.mediaways.net) (Ping timeout)
[11:54:47] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Ping timeout)
[11:54:57] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[11:55:18] *** Quits: maik (maik@moz-82B7232D.dip0.t-ipconnect.de) (Ping timeout)
[11:56:44] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[11:59:25] *** Joins: olafurw (olafurw@moz-91127A56.ru.is)
[12:00:14] *** Joins: maik (maik@moz-82B7232D.dip0.t-ipconnect.de)
[12:00:27] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[12:01:03] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[12:03:09] *** jorendorff_away is now known as jorendorff
[12:04:17] *** Quits: maik (maik@moz-82B7232D.dip0.t-ipconnect.de) (Ping timeout)
[12:05:51] *** Joins: maik (maik@moz-82B7232D.dip0.t-ipconnect.de)
[12:07:43] *** Joins: nkoep (nik@moz-52C632B0.vpn.rwth-aachen.de)
[12:09:28] *** Quits: maik (maik@moz-82B7232D.dip0.t-ipconnect.de) (Ping timeout)
[12:09:29] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[12:11:12] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[12:11:44] *** Joins: GeneralMaximus (ankur@38A29E30.3B7EC11C.BE90E62C.IP)
[12:13:52] *** Joins: charmander (Mibbit@84BA93C3.A76631D8.FB77E8F1.IP)
[12:15:57] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[12:16:49] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[12:18:52] *** Quits: charmander (Mibbit@84BA93C3.A76631D8.FB77E8F1.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:22:31] *** Joins: eagen (eagen@8737942B.7A99C13A.B7961A98.IP)
[12:25:59] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[12:26:03] *** Joins: tiffany (kawaii@moz-EB8B0C08.dhcp.embarqhsd.net)
[12:28:49] *** Joins: acabrera (alcabrera@4B9B70ED.4D823036.F18532AE.IP)
[12:31:20] *** Joins: jaen (jaen@FB01674D.56B727FE.4B52F012.IP)
[12:31:45] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[12:31:47] *** Quits: nathan7 (nathan@moz-60FC7746.nathan7.eu) (Ping timeout)
[12:31:59] *** Joins: tav (tav@moz-196E6F10.sohonet.co.uk)
[12:34:11] *** Joins: Diamond (dick@moz-FEA87A60.ks.ks.cox.net)
[12:34:55] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[12:37:46] *** jkarlson is now known as Ke
[12:42:27] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[12:42:45] *** Joins: ciferkey (ciferkey@moz-714CDBE1.wireless.umass.edu)
[12:43:00] *** Quits: ciferkey (ciferkey@moz-714CDBE1.wireless.umass.edu) (Quit: )
[12:43:49] *** Joins: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[12:44:39] <ChrisMorgan> Is macro_rules a macro or a syntax extension? What's the difference betwixt the twain?
[12:45:26] *** Joins: nathan7 (nathan@moz-60FC7746.nathan7.eu)
[12:45:39] <engla> macro_rules is a syntax extension that implements macros
[12:46:33] <engla> I guess only things defined with macro_rules! should be called macros
[12:46:44] <dbaupp> ChrisMorgan: in rust parlance, a syntax extension is written in Rust in syntax::ext, and macros are the things with macro_rules
[12:47:20] <ChrisMorgan> So what's a "foo!" thing called? "A syntax extension or macro"?
[12:47:26] <dbaupp> I think they're procedural macros and ... structural(really unsure about this one?) macros respectively in common terms
[12:47:43] *** Joins: zokier (zokier@moz-3F9D23A2.dhcp.inet.fi)
[12:48:14] <dbaupp> don't know, I just flip randomly between the various options :S
[12:48:59] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[12:49:21] *** Joins: zokier` (zokier@moz-C4357EA7.kapsi.fi)
[12:49:43] *** Quits: zokier (zokier@moz-3F9D23A2.dhcp.inet.fi) (Quit: changing client)
[12:50:24] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[12:51:14] *** jorendorff is now known as jorendorff_away
[12:52:23] *** Joins: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net)
[12:52:59] *** Joins: bytewise (bytewise@moz-4A801D04.unitymediagroup.de)
[12:54:03] <sw17ch> Size-polymoprhism on tuples; isn't that what I understand to be kind-polymorphism in Haskell?
[12:54:36] *** Joins: gokce (Mibbit@CD21EA63.55DBA505.232D870F.IP)
[12:57:52] <gokce> Hello, can someone tell me how to properly run files under `mk` such as `/mk/ctags.mk`?
[12:58:15] <dbaupp> ChrisMorgan: be careful: 1 << n for n > bits of type gives unspecified results
[12:58:25] <dbaupp> pnkfelix: ^ (gokce's question)
[12:58:49] <ChrisMorgan> dbaupp: of course I won't go for silly values of N.
[12:58:56] <pnkfelix> gokce: have you already run configure in a build directory ?
[12:59:10] <klutzy> sw17ch: `make TAGS.vi` or `make TAGS.emacs`
[12:59:19] <klutzy> sw17ch: all mk/*.mk files are included in Makefile
[12:59:27] <dbaupp> klutzy: (wrong person ;) )
[12:59:33] <klutzy> oops!
[12:59:40] <pnkfelix> gokce: e.g. `mkdir MyBuild; cd MyBuild; ../configure --my-options`
[12:59:41] <klutzy> gokce: ^
[13:00:00] <pnkfelix> gokce: once you've run configure, you'll have the makefile that klutzy was talking about.
[13:00:05] <sw17ch> :)
[13:00:11] <gokce> I had run configure but without a build directory
[13:00:31] <pnkfelix> gokce: yeah… some people do that, I think.  I cannot remember if it works or not, TBH
[13:00:31] <gokce> make TAGS.vi worked, thanks
[13:00:37] <klutzy> it's also fine I think
[13:00:44] <polyfractal> ChrisMorgan: How would I go about "injecting" a chan into your http server, so that `handle_request` can communicate with the main application? Or is there a better/alternate way to integrate the two?
[13:00:56] <pnkfelix> (just a little dangerous for my taste.  Though I've worked on plenty of projects where it was the only optoin)
[13:01:06] <dbaupp> pnkfelix: it does work with rust
[13:01:17] * dbaupp is possibly a bad person by using only in-tree builds :S
[13:01:21] <klutzy> is there a way to create a binary with additional .o files?
[13:01:36] <klutzy> I used --link-args "-L. some.o" but seems it does not work now :p
[13:01:45] <polyfractal> ChrisMorgan: Or perhaps a more general question:  Should I be thinking about tasks in Rust as distinct pools of threads/tasks that I spin up, or more like JS where you can spawn new tasks everywhere without any structure?
[13:01:52] <pnkfelix> klutzy: that … should work...
[13:01:53] <ChrisMorgan> polyfractal: add the appropriate members to the struct that you're implementing  Server on.
[13:02:20] <polyfractal> ChrisMorgan: ah, doh.  Not sure why I was thinking that I couldn't modify the struct. 
[13:02:26] <pnkfelix> klutzy: you can use -Z print-link-args to see the command that rustc is creating to invoke the linker
[13:02:41] <ChrisMorgan> The &self in handle_request is a clone of the original struct.
[13:03:01] <pnkfelix> klutzy: (and then analyze that, perhaps run it yourself, to try to track down what's going wrong)
[13:04:14] <dbaupp> ChrisMorgan: clone as in Clone.clone?
[13:04:21] <ChrisMorgan> Think so.
[13:04:30] <dbaupp> can you avoid that?
[13:04:37] <ChrisMorgan> Different tasks: no.
[13:05:31] <klutzy> pnkfelix: ah, yes, --link-args works, it was just different problem
[13:05:37] <klutzy> pnkfelix: thanks!
[13:05:41] <ChrisMorgan> dbaupp: (that's right, ain't it?)
[13:06:04] <dbaupp> ChrisMorgan: approximately... you can transfer ownership into a task
[13:06:10] <klutzy> pnkfelix: anyway, I thought it was a bit hacky. --link-args is the best way to do?
[13:06:24] <ChrisMorgan> dbaupp: but we've got to serve multiple responses at once, so that isn't possible.
[13:06:26] <dbaupp> ChrisMorgan: but, looking at the code, you're using several tasks, so yes, cloning is fine
[13:06:27] <dbaupp> yup
[13:06:56] <pnkfelix> klutzy: for now I think your options are only (1.) --link-args, or (2.) use rustc solely to generate .o files and libraries (via --lib), and then run the link step yourself.
[13:06:59] <dbaupp> (well, I guess you could move self into an Arc, maybe?)
[13:07:04] <ChrisMorgan> polyfractal: start tasks to your heart's content. rust-http will start one task per request, but you can spawn as many inside that as you like.
[13:07:06] <pnkfelix> klutzy: neither is perfect, I'll freely admit.
[13:07:15] *** Quits: gokce (Mibbit@CD21EA63.55DBA505.232D870F.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[13:07:37] <pnkfelix> klutzy: (especially since for step (2.), I don't think there's a better option than running rustc once with -Z print-link-args and then cut-and-pasting that into a makefile… :(   )
[13:07:46] <ChrisMorgan> dbaupp: Arc wouldn't let you serve multiple requests at once, would it?
[13:08:23] <bogen> I see there is an each_line for ReaderUtil, is there an equivalent iterator for str?
[13:08:26] *** Quits: LRN (LRN@moz-50DF30B.nationalcablenetworks.ru) (Ping timeout)
[13:08:48] *** Quits: nkoep (nik@moz-52C632B0.vpn.rwth-aachen.de) (Ping timeout)
[13:09:04] <polyfractal> ChrisMorgan: Ok, so I shouldn't be worrying about managing pools of threads/tasks?  Does Rust handle queuing of tasks, or will it try to give everyone an equal share of CPU time (leading to potentially excessive context switching) ?
[13:09:15] * polyfractal is still trying to wrap his head around task-best-practices
[13:09:26] *** Quits: six600110 (six600110@moz-3C5CCD60.neo.res.rr.com) (Ping timeout)
[13:09:45] <ChrisMorgan> I'm not the right person to ask about those sorts of details. I've got a fairly good idea of what goes on, but I don't know it all.
[13:09:50] <dbaupp> ChrisMorgan: sure would! Arc is basically the cross-task version of @
[13:10:29] <polyfractal> ChrisMorgan: ok, ill find harass someone else.  Thanks for the http lib, btw.  was playing with it last night and works great!
[13:10:33] <ChrisMorgan> dbaupp: but then I think you'd be needing to implement Server on Arc<MyServer> instead of MyServer?
[13:10:48] * ChrisMorgan stares in shock at the statement that "it works great", knowing otherwise
[13:10:57] *** Quits: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net) (Ping timeout)
[13:11:08] <polyfractal> :P
[13:11:08] <dbaupp> polyfractal: it *doesn't* have preemptive scheduling, so it basically does just queue tasks
[13:11:29] <ChrisMorgan> Rust's current scheduling algorithms are distinctly suboptimal; allocation of tasks to threads is not done well. But this too shall pass.
[13:11:34] <dbaupp> (it does have cooperative scheduling though, so a task can (and automatically does) let other tasks run in some instances)
[13:11:44] <polyfractal> ChrisMorgan:  well, my bar for "working great" in Rust is low:  does it compile?  Does it run and look like it's working?  Awesome!
[13:11:46] *** Joins: LRN (LRN@moz-50DF30B.nationalcablenetworks.ru)
[13:11:53] <klutzy> oh, pub extern fn is internal in llvm ir
[13:11:54] <dbaupp> ChrisMorgan: I'm saying in serve_forever, moving self into an arc
[13:12:09] <klutzy> so my .o file failed to link..
[13:12:15] * ChrisMorgan rejoices that polyfractal is so easy to please
[13:12:16] <dbaupp> ChrisMorgan: (but, yes, the user impling Server for Arc<MySever> would work too)
[13:12:54] * ChrisMorgan suddenly wonders whether handle_request should be taking &mut self rather than &self
[13:13:43] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[13:13:47] <dbaupp> that would preclude using Arc rather than cloning the whole struct, and it would make concurrent handling weird.
[13:14:27] *** Quits: tav (tav@moz-196E6F10.sohonet.co.uk) (Ping timeout)
[13:14:40] <ChrisMorgan> How does task local storage work with regard to new tasks? Can they access that of a parent?
[13:14:47] <dbaupp> especially since each clone serves a single request? so any modifications that *require* &mut self and cannot be done with &self would be lost immediately
[13:14:57] <dbaupp> ChrisMorgan: no, each task has entirely disjoint TLS
[13:15:07] <polyfractal> dbaupp: interesting about scheduling.  Will do some more reading…I've never worked with "green threads" before, seems quite different from managing regular threadpools.  Thanks!
[13:15:39] *** Joins: tav (tav@moz-196E6F10.sohonet.co.uk)
[13:16:18] <dbaupp> polyfractal: I didn't say, but Rust is designed so that you can just spin up a new task cheaply for any non-trivial piece of work (even if it's quite small)
[13:16:59] <bstrie> oh ha, I was just asking polyfractal a question on reddit, turns out he's right here...
[13:17:00] <dbaupp> some old benchmarks indicated task spawning was a microsecond or two or ten IIRC, and there has been optimisation work since then.
[13:17:10] <bstrie> polyfractal: approximate data structures are blowing my mind
[13:17:22] <dbaupp> bstrie++
[13:17:37] <polyfractal> dbaupp: no performance penalty of context switching across thousands of tasks?  I realize they are multiplexed onto a small number of threads, but I dont quite know how that works :)
[13:17:56] <polyfractal> bstrie:  awesome!  They are super cool data structures
[13:18:14] <ChrisMorgan> dbaupp: it's just to do with an idea that suddenly occurred to me which would allow what's basically a custom request type and somewhere to conveniently store data for the duration of the request. But then when I think about it further we can just have handle_request pass the Request and ResponseWriter on to a new type and then call methods on it instead; that's probably better as then the server doesn't need to pretend to be a request with
[13:18:20] <dbaupp> polyfractal: there is presumably some, but short tasks will normally complete without being descheduled at all (I guess)
[13:18:28] <bogen> where are all the str iterators listed in the dcoumentation? Under which module?
[13:18:36] <dbaupp> ChrisMorgan: (you got cut off at `a request with`)
[13:18:44] <bstrie> bogen: std::str, I'd guess
[13:18:52] <ChrisMorgan> ... dummy data that gets cloned all the time.
[13:19:12] <ChrisMorgan> dbaupp: I wondered whether I would, decided to try it and see what would happen so that I know the limits
[13:19:21] <sw17ch> Do tasks work cooperatively in Rust or is there an interrupt of sorts?
[13:19:22] <dbaupp> bogen: http://static.rust-lang.org/doc/master/std/str/index.html, methods on http://static.rust-lang.org/doc/master/std/str/trait.StrSlice.html
[13:19:47] <polyfractal> dbaupp: what happens if it's a long-lived stretch of operations?  Like the server code spawns a task to perform a computation, and that computation spawns a task to load from disk, and then it all collapses back to the networking task.  Is this an anti-pattern?  In other languages, I'd have distinct threadpools for networking, computation, I/O
[13:19:52] <dbaupp> sw17ch: coorperative
[13:19:57] <sw17ch> yesssss
[13:20:10] <ChrisMorgan> Interesting... that's a cut-off at about 444 characters. Wonder what that limit is derived from...
[13:20:15] <dbaupp> polyfractal: no, that's what they're designed for
[13:20:25] <polyfractal> dbaupp: awesome…i shall stop worrying :)
[13:20:31] <bogen> dbaupp: thanks, I found in StrSlice what I was looking for, line_iter
[13:20:35] <dbaupp> ChrisMorgan: 512-ish - user name + channel name + some other things
[13:20:51] <ChrisMorgan> That was my guess, but 68 seems a pretty big slice to come out of it.
[13:21:03] <ChrisMorgan> polyfractal: yep, "learn to stop worrying and love tasks"
[13:21:08] <dbaupp> ChrisMorgan: read the spec :P
[13:21:12] <polyfractal> bstrie: I love how intuitive the approximate data structures are.  Once you dig into the details, they are such simple ideas :)
[13:21:19] <polyfractal> ChrisMorgan:  hehehe
[13:21:35] <ChrisMorgan> dbaupp: servers probably have different limits. But I've done enough RFC reading for today.
[13:22:15] <dbaupp> ChrisMorgan: you can never do enough RFC reading; how on earth will you implement every one if you stop reading? :P
[13:22:58] <ChrisMorgan> Did you know: getting fed up with reading RFC 2616 in one colour, I wrote a Vim syntax highlighter for RFCs a few weeks ago? It was then that I realised just how horribly inconsistently they're formatted. (I'd already realised how riddled with errors and unspecified behaviour they are.)
[13:22:59] <dbaupp> sw17ch: (that said, they're not entirely user-cooperative: they will get descheduled on IO, and probably on things like chan.send() and port.recv())
[13:23:05] <ChrisMorgan> dbaupp: "for today"
[13:23:13] <dbaupp> ChrisMorgan: lucky
[13:23:41] <sw17ch> dbaupp: that's what I would expect.
[13:24:13] <dbaupp> sw17ch: good good, just checkin' (std::task::deschedule does a "hard" yield-to-scheduler, too)
[13:24:28] <ChrisMorgan> Did you know: the HTTP header ``etag: w/"=?US-ASCII?B?U3VwZXIg?= =?UTF-8?Q?Encoding=E2=84=A2?="`` should (I think) be interpreted as the weak entity tag ``Super Encoding™``.
[13:24:40] <ChrisMorgan> That's what I learned from my RFC reading today.
[13:24:43] <bstrie> I hope that after 0.9 we progress to 0.0xA
[13:24:50] <sw17ch> My other assumption would be that, fundamentally, there's a 'ready-to-run' queue of tasks and a 'blocked' set of tasks.
[13:24:56] <ChrisMorgan> bstrie: RFC it!
[13:24:57] <dbaupp> bstrie: we don't hex floats :'(
[13:25:00] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[13:25:01] <bstrie> not yet!
[13:25:03] <bstrie> there's an issue for it
[13:25:12] <dbaupp> sw17ch: I'm not an expert on the new rt, but I believe so
[13:25:47] <ChrisMorgan> The experts on newrt are probably all asleep at present.
[13:25:48] <polyfractal> Ok, final question for now.  Say I have five persistent, mutable data structures that want to perform operations on.  I can give one data structure to each of five new tasks, but how would I handle additional new tasks?  Keep them in a vector and pop them off, block thread while vector is empty (waiting on on of the structures to come back)?  
[13:25:56] <dbaupp> sw17ch: in fact, I think we spawn a few OS threads each with a scheduler with its own queues and they work steal from each other for the ready-to-run ones
[13:25:59] <flaper87> sw17ch: dbaupp tasks are descheduled on some operations
[13:26:19] <flaper87> .send and .recv deschedulet asks and they both implement the SelectInner and Select traite
[13:26:26] <flaper87> trait
[13:27:25] *** Joins: nkoep (nik@moz-FA1A612A.pool.mediaways.net)
[13:27:27] *** jorendorff_away is now known as jorendorff
[13:27:28] <flaper87> blocked tasks are represented by the BlockedTask trait (std::kill)
[13:27:42] <dbaupp> polyfractal: you could have a stream of them, and the tasks just .recv() on a SharedPort
[13:27:58] <sw17ch> So it's a fairly no-surprises scheduler then. Cool.
[13:28:11] <flaper87> sw17ch: it is :)
[13:28:22] <ChrisMorgan> Realise that the scheduler is prone to plenty of change still.
[13:28:38] <dbaupp> polyfractal: (actually, I'm not sure I understand the question_
[13:28:41] <flaper87> ChrisMorgan: yeah, that too!
[13:28:42] *** Joins: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com)
[13:29:03] *** Joins: Lurk_ (chatzilla@moz-F088D030.hsd1.in.comcast.net)
[13:29:10] <sw17ch> flaper87: I have given myself a weekends-for-the-next-year task of trying to get Rust to work in place of FreeRTOS on an ARM chip with <200kb of ram. A simple scheduler with cooperative tasks makes this less painful.
[13:30:10] <dbaupp> it relies on libuv internally I believe, which may make things tricky
[13:30:11] <sw17ch> Though, I need to learn more about how LLVM works inside first.
[13:30:12] <flaper87> sw17ch: tasks will use os threads and more cores when possible, otherwise they'll be run cooperatively 
[13:30:12] <polyfractal> dbaupp: heh, it was poorly worded.  Say I have five counters which I want to increment, but potentially thousands of incoming HTTP requests.  I want to hand those counters to five tasks and then queue up the rest of the requests that need to increment the counter until one of the first five tasks finishes.
[13:30:22] *** Joins: io2 (io2@moz-A6202C16.home.otenet.gr)
[13:30:28] *** Joins: frogonia (Mibbit@moz-A52338A8.pools.arcor-ip.net)
[13:30:29] <klutzy> pnkfelix: I firgured out the problem; when rustc builds .rs to .o, `extern fn` was always global regardless of `pub`, but now `pub extern fn` is always local.
[13:30:37] *** Joins: mib_p3geuj (Mibbit@moz-ED9083D3.superkabel.de)
[13:30:45] <klutzy> pnkfelix: but I don't know if this is really bug or not since what I did was really a hack
[13:31:06] <pnkfelix> klutzy: `local` ?  As in, analogous to a C static method ?
[13:31:13] <dbaupp> polyfractal: isn't that most simply handled by having the 5 counters wrapped in locks, and each task just modifies it inside the lock?
[13:31:31] * sw17ch wishes that network communication wasn't in the RT.
[13:31:33] <pnkfelix> klutzy: (i.e. not exposed for linking to other object code?)
[13:31:36] <dbaupp> polyfractal: specifically extra::arc::{RWArc, MutexArc}
[13:32:01] <dbaupp> sw17ch: it makes the tasks interact with IO better, I guess (?)
[13:32:11] <klutzy> pnkfelix: yes. "t" is shown when I run `nm`
[13:32:29] <polyfractal> dbaupp: ah, was unaware that Rust had locking mechanisms… I need to spend more time skimming the docs before asking questions.  Thanks!
[13:32:31] <sw17ch> dbaupp: libuv?
[13:32:40] <dbaupp> polyfractal: but you could have a stream through which you pass the counter objects, yes
[13:32:53] *** Quits: mib_p3geuj (Mibbit@moz-ED9083D3.superkabel.de) (Quit: http://www.mibbit.com ajax IRC Client)
[13:32:55] *** Joins: aeqwa (aeqwa@moz-EC37FE73.dsl.tropolys.de)
[13:33:07] <dbaupp> sw17ch: node.js's event loop library; it handles multithreaded io and so on efficiently
[13:34:27] <flaper87> sw17ch: libuv is used by Rust's RT, take a look at https://github.com/mozilla/rust/blob/master/src/libstd/rt/uv/uvio.rs
[13:34:39] *** Joins: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP)
[13:35:09] *** Joins: cstrahan (cstrahan@moz-28929FF1.public.wayport.net)
[13:36:55] <bstrie> agh, we probably should have mentioned rustdoc_ng in the detailed release notes
[13:36:59] <bstrie> sorry cmr
[13:37:13] <bstrie> it only just now occurred to me
[13:37:16] *** Joins: canhtak (jeremy@moz-9672486C.wl.t.ulaval.ca)
[13:37:16] <dbaupp> (and Seldaek and acrichto)
[13:37:28] <bstrie> who? :)
[13:37:58] <bstrie> I'm still mad at Seldaek for removing the trunk doc links!!! :P
[13:38:19] <bstrie> and then trying to surreptitiously put them back
[13:38:22] <bstrie> like I wouldn't notice!!
[13:39:32] <Seldaek> bstrie: brson put them back ;)
[13:39:33] <flaper87> hahahahha
[13:39:51] <Seldaek> bstrie: I just went out to drink and forgot all about your mysery :p
[13:39:55] <bstrie> haha
[13:40:13] <bstrie> this is the appropriate response to my incoherent whining
[13:41:20] <klutzy> pnkfelix: oh, `extern fn` are exported as global when I built --lib instead of -c. I don't know if it is consistent, but anyway I should stop using `--link-args some.o` hack and use dynamic lib
[13:41:51] <pnkfelix> klutzy: … whoah
[13:42:08] <pnkfelix> klutzy: I'm surprised that there's that level of difference between `--lib` and `-c` ...
[13:43:02] <klutzy> pnkfelix: yes really interesting. I guess it's side effect
[13:43:46] <ChrisMorgan> Ah... how does this work: http://static.rust-lang.org/doc/master/extra/url/fn.query_to_str.html and http://static.rust-lang.org/doc/master/extra/url/fn.query_from_str.html. The latter is not public (a mistake) and has different items in its sidebar. Has it merely not been deleted and is thus out of date?
[13:44:12] <dbaupp> polyfractal: re-skimming docs vs asking questions: #rust is often very efficient for getting pointers in the right part of the docs to skim. :)
[13:44:14] <ChrisMorgan> (s/master/0.8/ and the query_from_str one is broken, as I would expect.)
[13:44:39] <ChrisMorgan> Yeah, #rust is a *marvellous* channel.
[13:44:50] <dbaupp> ChrisMorgan: probably the deletion things yes
[13:45:05] <dbaupp> acrichto: ^ ChrisMorgan's two links above
[13:45:45] <ChrisMorgan> Stale things really shouldn't be left there. The old docs are still there, for example. http://static.rust-lang.org/doc/master/extra/url/index.html is new docs, http://static.rust-lang.org/doc/master/extra/url.html is old docs.
[13:46:04] <polyfractal> dbaupp: noted :)
[13:47:28] <dbaupp> ChrisMorgan: apparently there is an AWS command that will delete the old files when you upload new ones... but it's apparently not working (or we're not using it, but I thought brson mentioned it)
[13:47:39] * ChrisMorgan contemplates whether rust-http should move to #rust-http or not. The advantage of staying in #rust is that it's more prominent and so more people get accidentally exposed to it and entrapped: mwah hah hah—and all that.
[13:48:06] <flaper87> ChrisMorgan: hahahahahha
[13:48:16] <flaper87> like me
[13:48:17] <flaper87> :D
[13:48:39] <dbaupp> ChrisMorgan: for everyone in #rust, the first reaction to the merest mention of HT... will get us screaming rust-http
[13:48:48] <dbaupp> (so it doesn't even matter :P )
[13:49:12] *** Quits: frogonia (Mibbit@moz-A52338A8.pools.arcor-ip.net) (Quit: http://www.mibbit.com ajax IRC Client)
[13:49:14] <ChrisMorgan> That's the way I like it :-)
[13:49:56] *** Joins: jdm (jdm@moz-AC9499B2.cable.teksavvy.com)
[13:49:56] *** ChanServ sets mode: +o jdm
[13:50:01] <bstrie> don't get too eager with channel fragmentation
[13:50:24] <dbaupp> ChrisMorgan: https://github.com/mozilla/rust/issues/7476
[13:50:26] <bstrie> if rust-http ever has 50 people working and talking about it at once, then maybe take it somewhere else
[13:50:31] <bstrie> otherwise it's fine here
[13:51:02] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[13:51:04] <ChrisMorgan> That's my general feeling.
[13:51:07] *** jorendorff is now known as jorendorff_away
[13:51:21] <ChrisMorgan> Still, I registered #rust-http a few weeks ago.
[13:57:23] *** Joins: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[13:57:47] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[13:58:19] *** jorendorff_away is now known as jorendorff
[13:59:36] <klutzy> pnkfelix: ..and the visibility is affected by #[crate_type = "lib"]; stuff. If I add it to code and do -c, then extern fns become global again
[13:59:39] *** Joins: six600110 (six600110@moz-3C5CCD60.neo.res.rr.com)
[13:59:48] <klutzy> so --lib vs. -c comparison was unfair
[14:00:11] <pnkfelix> klutzy: hmm.  Okay.  I've barely used -c
[14:00:47] <klutzy> I use -c only for debug :p
[14:00:55] <pnkfelix> klutzy: it might all be consistent.  Not sure yet.
[14:01:41] <klutzy> pnkfelix: I think it is just a dark matter until we discuss how to do static link
[14:01:57] *** Joins: tav_ (tav@moz-196E6F10.sohonet.co.uk)
[14:01:59] *** Quits: Lurk_ (chatzilla@moz-F088D030.hsd1.in.comcast.net) (Ping timeout)
[14:02:03] <klutzy> my program is.. llvm frontend for some esoteric language, where runtime lib is written in rust
[14:02:33] <dbaupp> klutzy: rust works for that? \o/
[14:03:06] <klutzy> so my compiler produces some llvm ir, then llc builds it into output.o file, then I built executable by `rustc rt.rs --link-args "output.o"`'
[14:03:14] <klutzy> this is quite horrible hack :p
[14:03:27] *** Quits: tav (tav@moz-196E6F10.sohonet.co.uk) (Ping timeout)
[14:03:27] *** tav_ is now known as tav
[14:03:59] <klutzy> dbaupp: esolang-to-llvm compiler is also written in rust!
[14:04:06] <klutzy> https://github.com/klutzy/aheui-llvm
[14:04:41] <bstrie> coincidentally, rustc is also an llvm frontend for some esoteric language
[14:05:32] <pnkfelix> klutzy: unfortunately I do not think I'm going to be able to help you debug aheui programs.
[14:06:07] <dbaupp> http://esolangs.org/wiki/Aheui I don't have the right fonts :(
[14:06:25] * flaper87 doesn't have the right fonts either
[14:07:30] <bstrie> pnkfelix: you can help debug it if you just use google translate to turn it into english
[14:07:31] <dbaupp> klutzy: heh, using rustc's llvm bindings; awesome
[14:07:36] <bstrie> here's the example from the wiki, englified:
[14:07:42] <bstrie> Balburt makbyat myeotdu butmeok muk ttamak bulppo ppuda Mah muknu ppeoppwok ppwokppwok tteomyot but also ttubut damuk dappwok ppwokppo byarhmyeot ppyeota mukbut damak bolbyorh damak makhui Jimin bars made ​​worse
[14:07:43] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[14:07:53] <pnkfelix> bstrie: oh yes, that's great
[14:08:02] <dbaupp> it is an esolang after all
[14:08:10] <bstrie> pnkfelix: see, here the problem is that, as per the last line, you're making the bars worse
[14:08:15] <bstrie> really you want to be making the bars better
[14:08:31] <dbaupp> klutzy: I imagine this may be the fastest & most optimising implementation of Aheui around?
[14:08:50] <bstrie> dbaupp: not like people generally try to optimize esolang compilers...
[14:09:12] *** jorendorff is now known as jorendorff_away
[14:09:53] *** Joins: exobit_ (textual@moz-E06F46F0.corp.bitshelter.com)
[14:09:53] <klutzy> dbaupp: until some guy brings me a hardware implemention
[14:09:59] *** Quits: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr) (Quit: http://www.mibbit.com ajax IRC Client)
[14:10:07] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[14:11:02] <dbaupp> klutzy: haha, as long as the hardware is designed/laid out in Rust, it's fine by me :P
[14:11:29] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[14:12:43] *** Quits: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com) (Ping timeout)
[14:13:06] <dbaupp> (i know some people were doing a coursera course about that sorta stuff and at least one person implemented a routing algorithm in Rust)
[14:16:48] *** Quits: quvarxa (chatzilla@moz-978E4C31.static.tpgi.com.au) (Quit: ChatZilla 0.9.90.1 [Firefox 25.0/20130923194050])
[14:19:27] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[14:19:32] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[14:20:01] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[14:20:31] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[14:20:33] <fabiand> hey - the manual of 0.8 doesn't mention that they go away at some point, wasn't it planned to dorp them?
[14:20:41] <fabiand> and congrats to 0.8
[14:20:53] <bstrie> fabiand: that what doesn't go away?
[14:21:06] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Connection reset by peer)
[14:21:15] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[14:21:24] <dbaupp> http://michaelwoerister.github.io/2013/09/27/what-you-call-the-present.html "we radical Rusticals"
[14:21:41] <fabiand> bstrie, maybe I'm mixing something up . but wasn't it planned to drop managed boxes?
[14:21:59] *** Joins: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net)
[14:22:03] <bstrie> fabiand: ah, it was planned to move them into a library. hasn't happened yet.
[14:22:19] <fabiand> bstrie, ah yes ... I meant dropping them from the core lang and moving them into a lib ..
[14:22:48] *** Joins: emakarov (Mibbit@moz-ED9083D3.superkabel.de)
[14:23:05] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[14:23:36] <pnkfelix> (reading michaelwoerister's post) holy cow, maybe we support Eclipse after all.
[14:23:42] <jdm> :)
[14:24:09] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[14:24:09] *** ChanServ sets mode: +ao dherman dherman
[14:24:57] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[14:25:52] <dbaupp> pnkfelix: Do we have syntax highlighting/whatever else eclipse support entails?
[14:26:22] <bstrie> dbaupp: C++ syntax highlighting kinda works on rust. It's what I use on wikipedia :P
[14:26:25] <pnkfelix> dbaupp: no, I was just marvelling at the runtime debugging in the screenshots
[14:26:29] <bstrie> oh damn, have to update wikipedia
[14:26:52] <bstrie> goodgood, someone remembered to update the rust-lang.org example
[14:26:52] <dbaupp> pnkfelix: yeah, it's amazing <3 mw's work
[14:27:38] *** Joins: flowsnake (flowsnake@moz-1918C33E.aztw.cable.virginmedia.com)
[14:27:44] <ChrisMorgan> Good old michaelwoerister :-)
[14:28:59] *** Quits: jmgrosen (jmgrosen@moz-848F6087.sb.sd.cox.net) (Quit: jmgrosen)
[14:31:30] *** jack|zzz is now known as jack
[14:32:41] *** Joins: jstevans1 (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[14:32:53] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[14:33:27] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[14:33:33] *** Joins: jensnockert (jensnocker@F1E3FD84.8AAAF769.FAAB0799.IP)
[14:36:01] *** jorendorff_away is now known as jorendorff
[14:36:29] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[14:38:15] *** Joins: saml (sam@moz-14C16814.cst.lightpath.net)
[14:40:39] *** Quits: nkoep (nik@moz-FA1A612A.pool.mediaways.net) (Ping timeout)
[14:41:33] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[14:41:51] <cmr> dbaupp: pong
[14:41:53] *** Quits: BitPuffin (isak@moz-49828767.cust.tele2.se) (Ping timeout)
[14:42:30] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[14:42:51] *** Quits: a__ (a__@moz-4CC03B10.nycmny.fios.verizon.net) (Client exited)
[14:42:53] <ChrisMorgan> Is there a good reason why do we not have `impl<'self, K, V> Index<K, Option<&'self V>> for Map<K, V> { fn index(&self, key: &K) -> Option<&'self V> { self.find(key) } }`? (i.e. map[key] instead of map.find(key).)
[14:43:09] <dbaupp> cmr: did some new benchmarks go up ~ a day ago?
[14:43:29] <dbaupp> ChrisMorgan: Index doesn't work very well yet
[14:43:55] <dbaupp> ChrisMorgan: https://github.com/mozilla/rust/issues/6515
[14:44:05] * ChrisMorgan only knows that he tried using Index yesterday and found it worked at least basically, in spite of what he had been told earlier about it
[14:44:18] *** Joins: maik (maik@moz-DD39128A.dip0.t-ipconnect.de)
[14:44:44] <dbaupp> were you indexing with integers?
[14:45:16] <ChrisMorgan> No!
[14:45:23] <dbaupp> oh, weird (https://github.com/mozilla/rust/issues/6588)
[14:46:17] <cmr> dbaupp: yes
[14:46:42] <cmr> dbaupp: why?
[14:47:26] *** Quits: bogen (dwight@moz-8B4E7E75.dsl.rcsntx.swbell.net) (Quit: Leaving.)
[14:48:08] <dbaupp> cmr: were they old ones?
[14:49:27] * ChrisMorgan just found himself typing `return self;` at the end of a method by accident, rather than simply `self`
[14:49:56] <pnkfelix> dbaupp: I wonder if its something about how the singleton tuple struct is treated
[14:50:16] <pnkfelix> dbaupp: like maybe it dereferences its contents before checking if the wrapper implements Index ?  
[14:50:23] * pnkfelix experiments making it a non-tuple
[14:51:12] <pnkfelix> yes that seems to fix it, I'll make a note on the bug
[14:51:24] <dbaupp> I clearly should've been more specific in the issue report. :(
[14:52:07] *** Joins: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com)
[14:52:10] <cmr> dbaupp: they might have been, there was some significant weirdness going on where it was building 3month old commits.
[14:52:13] <cmr> It's fixed now, though
[14:52:58] <pnkfelix> What is the right terminology for "singleton tuple wrapper struct" ?  Surely that's not the right lingo.
[14:53:01] <cmr> dbaupp: I'm removing time.txt from the new runs.
[14:53:17] <dbaupp> cmr: why?
[14:53:18] <cmr> dbaupp: just to make it go faster over this huge amount of commits
[14:53:29] *** Quits: jaen (jaen@FB01674D.56B727FE.4B52F012.IP) (Ping timeout)
[14:53:31] *** Joins: spott_ (spott@moz-9B11536C.hsd1.co.comcast.net)
[14:53:35] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Connection reset by peer)
[14:53:36] <dbaupp> cmr: does it make it slow?
[14:53:39] <cmr> it's also not really that interesting of data, a few hundred ms either way doesn't particularly matter.
[14:53:49] <cmr> dbaupp: it runs the build again, but without memory accounting.
[14:53:53] <dbaupp> oh
[14:54:46] <cmr> anyway, ~600 commits going now, should take... about 40 hours :p
[14:54:46] <dbaupp> ok, that's fine, remind me to update my scripts if the things don't appear an hour or so after you upload (apparently github can be that slow :S )
[14:54:58] *** Joins: nkoep (nik@moz-EF05DC0E.vpn.rwth-aachen.de)
[14:55:04] <benh> pnkfelix: the tutorial has "There is a special case for tuple structs with a single field, which are sometimes called "newtypes" (after Haskell's "newtype" feature)." 
[14:55:07] <pnkfelix> is "newtype" 
[14:55:19] <pnkfelix> benh: thanks, you matched what I was just about to guess
[14:55:35] *** Joins: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net)
[14:55:52] <benh> Maybe there's a more official terminology hidden in a comment in the parser somewhere ;)
[14:56:06] <cmr> everyone just calls them newtypes
[14:56:16] <cmr> I had no idea what the hell "singleton tuple wrapper struct" meant though :p
[14:56:19] <dbaupp> cmr: will you be uploading results as it goes, or just all at the end?
[14:56:24] <cmr> dbaupp: as it goes
[14:56:31] <dbaupp> cmr: ok
[14:56:39] <cmr> And it should be fixed now to *actually* do that, since I'm using gzip -f now
[14:56:49] * dbaupp wasn't looking forward to his updator handling 600 commits in one go
[14:57:15] <cmr> heh
[14:57:30] *** Quits: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net) (Quit: jmgrosen)
[14:58:06] <pnkfelix> cmr: I was hoping to pull in a bunch of fish with that phrase and hopefully one of them would match someone's understanding.  But I should have just written "What's the name for this pattern: `struct S(int)`"
[14:58:06] <dbaupp> pnkfelix: nice catch btw :)
[14:58:43] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Input/output error)
[14:59:11] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: sw17ch)
[14:59:12] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[15:00:14] *** Quits: maik (maik@moz-DD39128A.dip0.t-ipconnect.de) (Ping timeout)
[15:00:14] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[15:00:54] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Ping timeout)
[15:01:36] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[15:01:51] *** Quits: sk (sk@D904A3B4.50B2D8C.78DD174B.IP) (Quit: Leaving)
[15:05:09] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[15:05:11] *** Joins: sw17ch (sw17ch@moz-39D8564F.wndsny.tds.net)
[15:05:31] *** Joins: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net)
[15:05:49] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[15:06:13] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Input/output error)
[15:06:42] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[15:06:59] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (No route to host)
[15:07:24] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[15:07:26] *** Joins: Jesin (Jessin_@moz-394702A3.cc.lehigh.edu)
[15:11:38] *** Quits: dew (Instantbir@moz-A7596059.dhcp.wstv.il.charter.com) (Ping timeout)
[15:12:01] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[15:12:55] *** Joins: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP)
[15:14:52] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Ping timeout)
[15:15:41] *** Quits: spott_ (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[15:16:07] *** Quits: lenstr (lenstr@E0E80B8D.ED45D46B.DFEAE789.IP) (Client exited)
[15:16:46] <cmr> Hahah, mw linked to one of my favorite songs
[15:18:41] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[15:18:43] *** Joins: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net)
[15:19:49] <dbaupp> cmr: are you dead?
[15:19:58] <cmr> dbaupp: I'm a robot!
[15:21:06] <bjz> barrp
[15:22:01] *** Quits: jstevans1 (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[15:22:01] *** Quits: olafurw (olafurw@moz-91127A56.ru.is) (Quit: WeeChat 0.4.1)
[15:22:07] *** Joins: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[15:23:43] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[15:25:06] <bstrie> rusti: {}
[15:25:06] -rusti- ()
[15:25:10] *** Quits: eagen (eagen@8737942B.7A99C13A.B7961A98.IP) (Client exited)
[15:26:36] *** Joins: yonran (yonran@moz-962F33EB.acuitus.com)
[15:27:14] *** Quits: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP) (Ping timeout)
[15:27:31] *** Joins: erickt (etryzelaar@8C9ECD8F.3A598286.F12515B4.IP)
[15:28:15] *** Joins: josh (josh@moz-348C4790.hsd1.mn.comcast.net)
[15:30:08] <klutzy> gosh. I got ICE when I build some program with -L /path/to/rust-http/build, then I built rust-http with recent rustc for other stuff. then ICE has gone
[15:30:21] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[15:30:33] <nmatsakis> so excited about http://michaelwoerister.github.io/2013/09/27/what-you-call-the-present.html
[15:31:01] <klutzy> there seems ICE around rustc changes but I don't know what version I built the lib on was
[15:31:16] <bstrie> I like to imagine nmatsakis printing out all the emacs source and throwing it in the trash, then gleefully using eclipse for the rest of his life
[15:31:28] <bjz> Woah
[15:32:14] <pnkfelix> bstrie: I would imagine Emacs-based developers are going to benefit equally from mw's work
[15:32:31] <pnkfelix> (though I have not actually tested this hypothesis)
[15:32:33] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[15:32:45] <nmatsakis> bstrie: I actually used eclipse quite a bit in the past... :)
[15:32:57] <nmatsakis> (and even enjoyed it)
[15:33:09] <pnkfelix> nmatsakis: do you know how to write plugins for it?
[15:33:10] <nmatsakis> writing java code without it just seems kind of nutso to me now
[15:33:13] <erickt> woah. we got a debugger working now?!
[15:33:15] <nmatsakis> pnkfelix: I did write a plugin or two
[15:33:16] <olsonjeffery> is eclipse really the best gdb frontend?
[15:33:23] <bstrie> I use eclipse for work
[15:33:38] <bstrie> in fact I use two different IDEs based on eclipse, one for PHP code and one for RPG-IV code
[15:33:38] <nmatsakis> pnkfelix: in particular I wrote a unit testing plugin for the compiler course I was teaching at ETH, so it could integrate with my extensions to JUnit
[15:33:43] <pnkfelix> nmatsakis: I tried once, but it seemed a very dark art...
[15:33:50] <nmatsakis> pnkfelix: no darker than elisp
[15:33:54] <nmatsakis> pnkfelix: not saying much :)
[15:34:06] *** Joins: thewonderidiot (mstewart@moz-E41129BA.ipnetworksinc.net)
[15:34:07] <pnkfelix> nmatsakis: so you say.  I found the self-documentation of Elisp to be superior.
[15:34:19] <nmatsakis> pnkfelix: true
[15:34:42] *** Quits: StarLight (StarLight@moz-5873EB8D.dynamic.avangarddsl.ru) (Ping timeout)
[15:34:45] <pnkfelix> nmatsakis: but, nonetheless, Elisp extensions are also a dark art.
[15:34:52] *** Joins: eagen (eagen@8737942B.7A99C13A.B7961A98.IP)
[15:35:00] <nmatsakis> pnkfelix: ok I revise my statement. "only mildly darker than elisp"
[15:35:28] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[15:35:49] *** Joins: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com)
[15:36:32] *** Quits: novabyte (novabyte@74BB045.6F0D1B91.366C66F5.IP) (Quit: Leaving.)
[15:38:48] *** Joins: Lurk_ (chatzilla@moz-F088D030.hsd1.in.comcast.net)
[15:39:02] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[15:39:04] *** Joins: StarLight (StarLight@moz-FFA9EA5.dynamic.avangarddsl.ru)
[15:40:05] *** Joins: jstevans1 (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[15:40:18] <bstrie> rusti: "test"
[15:40:23] <bstrie> rusti is sooo slow today
[15:40:26] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[15:40:30] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[15:41:26] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[15:42:25] *** Joins: a__ (a__@moz-4CC03B10.nycmny.fios.verizon.net)
[15:42:33] *** Quits: jdm (jdm@moz-AC9499B2.cable.teksavvy.com) (Ping timeout)
[15:43:06] <dbaupp> bstrie: you scared it off
[15:43:23] *** Joins: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[15:43:54] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[15:43:54] *** Quits: jstevans1 (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[15:44:13] <erickt> crazy idea: this thread (https://mail.mozilla.org/pipermail/rust-dev/2013-September/005759.html) got me thinking about anonymous structs and named arguments. What if we were able to *infer* the name of a struct? As in `struct Point { x: int, y: int } fn foo(p: Point) { ... } foo({x: int, y: int})`?
[15:44:29] <erickt> err, `foo({x: 1, y: 2})`
[15:44:44] *** Joins: BitPuffin (isak@moz-49828767.cust.tele2.se)
[15:44:55] <amatus> it's just crazy enough to work!
[15:45:10] *** Joins: sk (sk@61A494B3.BA40E8A.AAC02D62.IP)
[15:45:15] *** Joins: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[15:45:26] <erickt> it'd be similar to us inferring the type of `15`
[15:45:29] <pnkfelix> erick: hmm, is there any risk of a parsing ambiguity there?  Not sure.
[15:45:38] <nmatsakis> erickt: we've talked about it from time to time...
[15:45:41] <pnkfelix> erickt: ^
[15:45:43] <erickt> pnkfelix: I'm sure there is :)
[15:45:59] <pnkfelix> erickt: seems like you'd surely lose LL(1)-ness ...
[15:46:22] *** Quits: sw17ch (sw17ch@moz-39D8564F.wndsny.tds.net) (Quit: sw17ch)
[15:46:33] <pnkfelix> erickt: (though there might be easy fixes to the syntax, e.g. something like `_ { x: 3, y: 2 }` when you want the name inferred.
[15:47:00] <klutzy> cmr: seems that rustdoc does not show `insert` method on HashMap (which is from trait MutableMap, and the trait has default method)
[15:47:05] <erickt> nmatsakis: I'm not surprised :)
[15:47:21] <klutzy> cmr: so I tried to search "insert", then it lead me 404 page
[15:47:27] *** Quits: jensnockert (jensnocker@F1E3FD84.8AAAF769.FAAB0799.IP) (Input/output error)
[15:49:06] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[15:52:29] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[15:53:05] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[15:53:07] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[15:53:49] *** Joins: kvark (Mibbit@9A8A5739.49975FB2.AE2D72A6.IP)
[15:54:37] <kvark> Hi! Is SSL supported/planned in the std/extra?
[15:54:44] <SimonSapin> This milestone seems redundant: https://github.com/mozilla/rust/issues?milestone=19 (ie. one mis-categorized issue)
[15:55:31] <bstrie> where the heck did that come from
[15:55:50] <bstrie> kvark: I think our plans are to use OpenSSL
[15:56:09] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[15:56:41] <kvark> bstrie: ok, thanks... Too bad GIST requires SSL connection.
[15:56:48] <dbaupp> bstrie, SimonSapin: I imagine the milestone assignee typed "well-def" into the box and expected completion to work, but instead hit the "create a new milestone button"
[15:56:49] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[15:57:02] <steveklabnik> yes, openssl is the plan
[15:57:11] <steveklabnik> crypto is hard, we're already building an entire language
[15:57:19] <steveklabnik> that's the current position, anyway
[15:57:23] <dbaupp> is it? I thought openssl had licensing issues?
[15:57:33] <klutzy> bstrie: any reason to use openssl particulary?
[15:57:38] <steveklabnik> klutzy: licensing
[15:57:54] <steveklabnik> dbaupp: it's only an issue for distributing binaries
[15:57:59] <klutzy> steveklabnik: openssl license is really tricky, it is apache + 4-cluase bsd but + means "both should be satisfied"
[15:58:04] <dbaupp> steveklabnik: aren't we?
[15:58:12] <steveklabnik> yes, at the moment.
[15:58:17] <steveklabnik> so ruby for example
[15:58:25] <steveklabnik> it doesn't INCLUDE openssl by default
[15:58:30] <dbaupp> and what about users of rust distributing their own binaries?
[15:58:35] <steveklabnik> but if you have it on your system, when you compile it, it will pick it up and link to it
[15:58:51] <klutzy> I guessed we would use nss or crypto++
[15:58:54] <steveklabnik> i am not a lawyer nor an expert on what's up with openssl's licensing
[15:59:11] <klutzy> well, nss is MPL/LGPL but anyway
[15:59:12] <steveklabnik> that's what was put down in the meeting notes, i'm just the reporter ;)
[15:59:36] <klutzy> ssl world is a mess
[15:59:54] *** Joins: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net)
[15:59:59] <cmr> klutzy: insert isn't shown because it's a default method that HashMap doesn't reimplement.
[16:00:04] <cmr> klutzy: What page is the 404 on?
[16:00:21] <pnkfelix> SimonSapin: yeah I 'll fix it
[16:00:27] <bstrie> wut, I thought openssl was from the freebsd people
[16:00:36] <bstrie> which basically doesn't have any license at all
[16:00:39] <bstrie> that's the point
[16:00:42] <pnkfelix> SimonSapin: it might have been me mis-using the command line tool, maybe.  Or maybe misusing the web interface
[16:00:43] <klutzy> cmr: searching "insert" showed std::container::MutableMap::MutableMap::insert, and clicking it led me to http://static.rust-lang.org/doc/master/std/container/MutableMap/trait.MutableMap.html
[16:00:58] <cmr> klutzy: Hm, that's very clearly the wrong url.
[16:01:06] <klutzy> openssl is neither apache nor 4-bsd
[16:01:15] <klutzy> it's deceptive at first glance
[16:01:30] <yonran> Hello. I'm having trouble fixing a compiler error  "cannot assign to `(*self).count` because it is borrowed". Is there any way to forget a borrowed pointer without unraveling a match? util::ignore doesn't seem to do the trick. https://gist.github.com/yonran/6730835
[16:01:35] *** Joins: bjz_ (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[16:01:37] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[16:01:44] <klutzy> its license text even use the term 'dual license' for 'you must satisfy both'
[16:01:49] *** Joins: mib_etud02 (Mibbit@moz-788A5A86.pool.mediaways.net)
[16:02:35] <tiffany> uhh...
[16:02:39] <tiffany> http://static.rust-lang.org/doc/master/std/iter/Iterator/trait.Iterator.html is an Access Denied error?
[16:02:46] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[16:02:47] *** Quits: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net) (Client exited)
[16:02:56] <cmr> tiffany: it's the wrong url
[16:03:02] <cmr> it should be std/iter/trait.Iterator.html
[16:03:08] <cmr> There's an extra path
[16:03:10] <tiffany> I got there from the search bar
[16:03:22] <cmr> yes, klutzy also just reported that bug
[16:03:24] <dbaupp> cmr: it's almost certainly the same issue as insert + MutableMap
[16:03:29] <steveklabnik> tiffany: http://static.rust-lang.org/doc/0.8/std/iter/trait.Iterator.html
[16:03:30] <dbaupp> hah :)
[16:03:32] <pnkfelix> nmatsakis: I thought for sure you would start writing all of your identifiers using Greeκ identifiers once that passport comes
[16:03:40] <dbaupp> tiffany: what did you search for?
[16:03:42] <klutzy> cmr: I had no idea if it was issued. should I issue new one?
[16:03:56] <tiffany> zip
[16:04:04] <cmr> klutzy: please do!
[16:04:22] <dbaupp> tiffany: ah, yup; it appears to be a bug with default methods + search
[16:04:36] <tiffany> skybox.rs:57:20: 57:27 error: failed to find an implementation of trait std::vec::Vector<u8> for u8
[16:04:37] <tiffany> skybox.rs:57         let r: u8 = c1 + c2;
[16:04:40] <tiffany> uh...
[16:04:57] <dbaupp> is either c1 or c2 a [u8] ?
[16:05:02] <bstrie> ...does printf! not use format! ?
[16:05:16] <cmr> bstrie: it should?
[16:05:17] <steveklabnik> bstrie: it does on HEAD iirc, but not on 0.8
[16:05:18] *** Quits: kvark (Mibbit@9A8A5739.49975FB2.AE2D72A6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[16:05:18] <cmr> uWait no
[16:05:20] <tiffany> they're the result of .map(|(&c1,&c2)| on a .zip'd iterator
[16:05:21] <bstrie> ah I see
[16:05:23] <cmr> bstrie: print! does, not printf!
[16:05:24] <bstrie> it's println!
[16:05:29] <bstrie> yeah
[16:05:36] <cmr> unless a PR landed to change it while I wasn't looking.
[16:05:46] * dbaupp likes how excited people get about macros
[16:05:47] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Quit: rebooting)
[16:05:52] <tiffany> rusti: let a = ~[1,2,3]; let b = ~[4,5,6]; a.iter().zip(b.iter()).map(|&c1,&c2| c1+c2).collect()
[16:05:55] -rusti- pastebinned 10 lines of output: http://sprunge.us/jKbD
[16:06:20] <klutzy> cmr: created https://github.com/mozilla/rust/issues/9566
[16:06:31] <tiffany> rusti: let a = ~[1,2,3]; let b = ~[4,5,6]; a.iter().zip(b.iter()).map(|(&c1,&c2)| c1+c2).collect()
[16:06:31] -rusti- <anon>:7:45: 8:5 error: cannot determine a type for this bounded type parameter: unconstrained type
[16:06:32] -rusti- <anon>:7          let a = ~[1,2,3]; let b = ~[4,5,6]; a.iter().zip(b.iter()).map(|(&c1,&c2)| c1+c2).collect()
[16:06:32] -rusti- <anon>:8     };
[16:06:32] -rusti- application terminated with error code 101
[16:06:45] <tiffany> rusti: let a = ~[1,2,3]; let b = ~[4,5,6]; let r: ~[int] = a.iter().zip(b.iter()).map(|(&c1,&c2)| c1+c2).collect(); r
[16:06:46] -rusti- ~[5, 7, 9]
[16:06:48] <dbaupp> rusti: let a = ~[1,2,3]; let b = ~[4,5,6]; a.iter().zip(b.iter()).map(|(&c1,&c2)| c1+c2).to_owned_vec()
[16:06:49] -rusti- ~[5, 7, 9]
[16:06:51] <tiffany> okay...
[16:07:20] <klutzy> cmr: on default method, is it indended not to show them on HashMap? what I originally wanted to search was the HashMap's insert() method
[16:08:29] <tiffany> I don't know why this is giving me an error when rusti is doing it just fine
[16:08:36] <steveklabnik> lol
[16:08:41] <klutzy> and since the doc only showed fn insert_or_update_with, I confused that whether there was a great method name renaming
[16:08:43] <steveklabnik> because rusti is broken :)
[16:08:48] <steveklabnik> (just kidding)
[16:08:53] <tiffany> oh
[16:08:54] <tiffany> nevermind
[16:09:49] *** Joins: Kruppe (user@moz-253119B0.esg.uwaterloo.ca)
[16:10:46] *** Joins: mikezaby (mikezaby@moz-908EA8DE.home.otenet.gr)
[16:11:01] <engla> klutzy: maybe the docs can leave a hint that the trait provides further default methods
[16:11:07] <engla> klutzy: but to list them all might be too verbose
[16:11:19] * nejucomo noticies convo about openssl...
[16:11:42] <dbaupp> engla++
[16:11:46] <nejucomo> Why would an openssl binding be in libstd or libextra, instead of just remaining a third party library?
[16:11:49] <mib_etud02> ./configure in rust/ should pass fairly quickly shouldn't it? I haven't compiled rust in a while and did a command line tools upgrade just the other day and now trying to compile rust it seems stuck at: configure: CFG_CCACHE 
[16:12:08] <nejucomo> -or a bigger picture question: What is the scope of libextra?
[16:12:10] <mib_etud02> I killed it after 10min (with a cpu utilization of 100%)
[16:12:12] <cmr> mib_etud02: try killing it and running it again.
[16:12:14] <dbaupp> nejucomo: libextra is designed to become a collection of third-party libraries
[16:12:15] <cmr> ok
[16:12:19] <nejucomo> (-and libstd)
[16:12:28] <cmr> klutzy: It's intended, but it's sloppy and needs to be fixed.
[16:12:29] <nejucomo> dbaupp: So, maybe roughly like python's stdlib?
[16:12:30] <dbaupp> nejucomo: (or at least, external libraries maintained by the rust team)
[16:12:42] <nejucomo> And what is the scope of libstd?
[16:12:51] <cmr> klutzy: a problem with it is that for things like Iterator, the huge amount of default methods are going to become burdensome
[16:12:52] <dbaupp> nejucomo: which libextra then depends on an reexports
[16:12:57] <pnkfelix> mib_etud02: can you gist the flags you are passing to configure ?
[16:12:59] <dbaupp> nejucomo: not sure if that has been deifined yet
[16:13:01] <dbaupp> *defined
[16:13:05] <bstrie> Seldaek: where's the repo for the rust home page?
[16:13:11] <cmr> bstrie: graydon/rust-www
[16:13:14] <steveklabnik> bstrie: Seldaek graydon/rust-www
[16:13:16] <bstrie> kk
[16:13:17] <steveklabnik> cmr: argh
[16:13:18] <steveklabnik> :)
[16:13:24] * Seldaek watches quietly :p
[16:13:39] <nejucomo> I'm inclined to have a really nice packaging system and minimal stdlib.
[16:13:41] <klutzy> engla: cmr: hmm it makes sense. but my use case was: open HashMap -> search "insert" on the page :p
[16:13:57] <cmr> klutzy: yeah, it's not the greatest.
[16:13:59] <mib_etud02> pnkfelix: I just did: git clone https://github.com/mozilla/rust.git && cd rust && ./configure  -- no special flags
[16:14:01] <Seldaek> bstrie: don't you go and add 0.7 tutorial links! :)
[16:14:07] <bstrie> Seldaek: WATCH ME
[16:14:09] <nejucomo> Then "libextra" could instead be a blessed set of packages which are subject to careful review, integration testing, etc...
[16:14:22] <steveklabnik> mib_etud02: yeah, configure usually doesn't take long
[16:14:26] <cmr> nejucomo: libstd, as I understand it, is supposed to be the runtime and support for the builtin datatypes.
[16:14:37] <nejucomo> cmr: Ok.
[16:15:08] <mib_etud02> xcrun is the program utilizing 100% cpu
[16:15:09] <pnkfelix> mib_etud02: that is weird. If you aren't doing --enable-cache, I do not know why it would do anything at that step, let alone get stuck on in...
[16:15:15] <dbaupp> bstrie: I quite liked the 0.5 tutorial
[16:15:39] <nejucomo> That reminds me…  What are the biggest hurdles to writing a library in rust which can be linked into a C program and provide a "natural" C interface?  The obvious one to me seems to be the runtime.
[16:15:53] <steveklabnik> dbaupp: what did you like about it?
[16:16:00] <cmr> nejucomo: The only one is the runtime, really.
[16:16:01] <bstrie> dbaupp: if you have any more classic hits, keep em coming
[16:16:05] <dbaupp> steveklabnik: (it was a joke)
[16:16:12] <bstrie> remember the really really old faux-sphinx style docs?
[16:16:12] <steveklabnik> dbaupp: ahhh. :)
[16:16:17] * dbaupp should be funnier
[16:16:22] <nejucomo> cmr: Which includes tasks and gc, right?
[16:16:22] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[16:16:23] *** ChanServ sets mode: +ao dherman dherman
[16:16:23] <steveklabnik> no, i just woke up
[16:16:26] <steveklabnik> :)
[16:16:28] <cmr> nejucomo: yes.
[16:16:34] <cmr> nejucomo: and TLS
[16:16:47] <nejucomo> Is there a plan for a —no-runtime rustc mode that will consider @ and task apis compile-time-errors?
[16:16:53] <cmr> nejucomo: right now, you really need to do #[no_std] to have it actually usable.
[16:16:59] <nejucomo> TLS is?
[16:17:01] <mib_etud02> pnkfelix: yeah, I thought so too. I've had problems compiling rust the other week, aborted unable to find libuv IIRC, so I upgraded command line tools and started from scratch, now this happens...
[16:17:03] <cmr> std::local_data
[16:17:07] <cmr> (task local storage)
[16:17:08] <steveklabnik> nejucomo: transport level security. think ssl
[16:17:09] <nejucomo> Ah.
[16:17:16] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[16:17:19] <nejucomo> "Thread-Local Storage"?
[16:17:22] <steveklabnik> oh wait
[16:17:26] <steveklabnik> am i getting my tlas crossed?
[16:17:31] <dbaupp> steveklabnik: yup
[16:17:32] <nejucomo> steveklabnik: Yes.
[16:17:33] <cmr> tasks are different than threads, but analogous
[16:17:33] <steveklabnik> yes, in this context it'd be thread local storage
[16:17:34] <steveklabnik> dammit
[16:17:46] <steveklabnik> we were talking about openssl
[16:17:49] <steveklabnik> :)
[16:17:52] <dbaupp> steveklabnik: task local, but yes, that one.
[16:17:52] <nejucomo> In this local context, although there was another thread were TLS was the SSL kind.  ;-)
[16:18:03] <steveklabnik> ha!
[16:18:04] <cmr> heh
[16:18:07] <nejucomo> This is the problem with sharing state between threads.
[16:18:37] <cmr> nejucomo: Anyway, I have some ideas for different runtime profiles, but rust code using one profile wouldn't be able to use rust code in another.
[16:19:01] <nejucomo> So I was asking about runtime-less C-compatible rust because I was pondering how possible it is to begin replacing C libraries with rust rewrites in a piecemeal fashion.
[16:19:30] <nejucomo> (You can tell I'm drinking the koolaid.)
[16:19:41] <nejucomo> Let's rewrite all the things!
[16:19:45] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[16:19:50] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[16:19:56] <cmr> nejucomo: basically all you need to do is `extern "C" fn foo()`, instead of `fn foo()`
[16:19:57] <dbaupp> #[no_std] works pretty well for that
[16:20:00] <steveklabnik> it's gonna happen eventually
[16:21:13] <klutzy> extern "C" with #[no_mangle] works greatly
[16:21:30] * nejucomo is reminded of a far future space-opera scifi he read where-in the starships are running a unix descendent, and there's just hundreds of years of layers on top of layers.
[16:21:43] <sp3d> I think I just read that one
[16:21:48] <cmr> Title?
[16:21:53] <sp3d> A Deepness In the Sky?
[16:21:58] <nejucomo> I think it was "Fire upon the Deep" by Vernor Vinge.
[16:22:03] <sp3d> same author
[16:22:10] <sp3d> probably same universe
[16:22:10] <nejucomo> It doesn't directly mention unix, but alludes to it.
[16:22:29] <sp3d> Deepness describes (doesn't name) the epoch ;)
[16:22:36] <nejucomo> sp3d: Yes, Deepness is chronologically a prequel, but was written after Fire.
[16:22:41] <sp3d> mm
[16:24:22] *** Joins: sergi (textual@moz-DB55470C.upc-a.chello.nl)
[16:24:47] * cmr adds them to the list
[16:26:02] *** Quits: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[16:26:30] *** Quits: Ralith (ralith@moz-36466B9F.customer.broadstripe.net) (Ping timeout)
[16:28:26] <pnkfelix> Is there an iterator method or function that gives back an wrapped iterator that will yield None infinitely after the first time the inner iterator says None ?
[16:28:27] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[16:28:40] <cmr> pnkfelix: fuse
[16:28:49] <pnkfelix> cmr: thnaks
[16:29:22] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[16:30:07] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[16:30:26] *** Joins: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net)
[16:31:25] *** Joins: Ferreus (ferreus@moz-1C834CDB.dyn.telefonica.de)
[16:32:41] <glyc> I'm trying to get rusti back. It is crashing in dl-object.c in libstd. But I can find no source file for that, mysteriously. Where does dl-object.c live?  https://github.com/mozilla/rust/issues/9567
[16:32:52] <glyc> (rusti the repl)
[16:32:56] *** Quits: infynyxx (infynyxx@moz-E95B370B.nyc.res.rr.com) (Client exited)
[16:33:01] *** Joins: tjc (tjc@moz-FEE214EF.tmodns.net)
[16:33:01] *** ChanServ sets mode: +o tjc
[16:33:12] *** Joins: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net)
[16:33:33] <cmr> glyc: backtrace?
[16:33:34] <dbaupp> glyc: probably src/rt/jemalloc
[16:33:45] <cmr> oh it's all in the issue
[16:33:48] *** Quits: arodier74 (Thunderbir@moz-25EB015.in-addr.btopenworld.com) (Quit: arodier74)
[16:33:49] <glyc> cmr: backtrace is on the ticket https://github.com/mozilla/rust/issues/9567
[16:34:21] <pnkfelix> dlopen
[16:34:41] <pnkfelix> its part of the implementation of dlopen
[16:34:46] <pnkfelix> glyc: ^
[16:34:59] <glyc> pnkfelix: that makes sense
[16:35:03] <glyc> given the name!
[16:35:23] <Seldaek> is graydon completely off rust business? havent' seen him here in a while.. I thought he'd just take a step back
[16:35:24] <glyc> but that also means its probably not the origin of the bug...
[16:35:27] <c74d> Is there a guide to the meanings of rustc’s error messages?
[16:35:42] <cmr> c74d: no
[16:36:31] <glyc> so the first rust-only function in the backtrace seems to be loadCrate -> #14 0x00007fc9e5ebf085 in RustMCJITMemoryManager::loadCrate (this=0x7fc9e405da00,      file=0x7fc9e42474a0 "/usr/cn/rust/debug-build/install/lib/rustc/x86_64-unknown-linux-gnu/lib/libstd-6c65cf4b443341b1-0.8.so", err=0x7fc9e4247000) at src/rustllvm/RustWrapper.cpp:130
[16:36:40] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[16:38:00] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[16:38:18] <pnkfelix> glyc: TBH I'm still confused, though, because I do not see a dl-object.c in the source for glibc 
[16:38:30] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[16:38:42] <glyc> pnkfelix: it's probably in the linux source
[16:38:48] <glyc> its so low level
[16:39:13] <glyc> the next higher error is at #16 0x00007fc9ea10d3c9 in back::link::jit::exec::anon::expr_fn::ah ()    from /usr/cn/rust/debug-build/install/bin/../lib/librustc-d3cb8c2ccd84a7a7-0.8.so
[16:39:21] <c74d> What does “error: cannot move out of dereference of & pointer” mean, for a function return value of the form `self.a[index]`, where `a` is a vector of an enum type? I assume it means that it’s trying to transfer ownership of the enum value but can’t?
[16:39:22] <glyc> (higher function on the backtrace)
[16:39:43] <c74d> I don’t want to transfer ownership; can I make it copy instead?
[16:39:50] <glyc> .clone() maybe
[16:40:06] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:40:21] *** Joins: pnathan (Adium@B9840254.2CD8A5F8.477B877D.IP)
[16:40:27] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.1)
[16:40:35] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[16:40:35] <pnkfelix> glyc: Ah, I wasn't looking in the right spot in glibc
[16:40:48] <glyc> pnkfelix: you found?
[16:41:05] <pnkfelix> glyc: (this info is likely only useful to you if you wanted to take the route of building your own local copy of glibc so you could step through the code.)
[16:41:10] * strcat is glad type_use is gone ;p
[16:41:31] <c74d> glyc: Thanks, that worked.
[16:41:34] <mib_etud02> Just installed command line tools (xcode462_cltools_10_86938259a) and now it passes CFG_CCACHE (leaving it blank), weird... But no problem atm, because xcode5 breaks ghc...
[16:41:38] <glyc> pnkfelix: yeah, it's unlikely the error is in the dynamic loader
[16:42:02] <pnkfelix> glyc: I think its in sys/elf/dl-object.c   but yes, I am aware the error itself is unlikely to be in the dynamic loader.
[16:42:03] <bstrie> strcat: that was the slow resolve thing, right?
[16:42:11] <strcat> bstrie: no
[16:42:30] <pnkfelix> glyc: but nonetheless, it can be nice at times to not be forced to treat these things like black boxes..
[16:42:33] <bstrie> then I cannot be glad that it is gone because I know not what it is
[16:42:34] <glyc> pnkfelix: cool, I'll take a quick look
[16:42:48] <strcat> bstrie: it would try to reuse generic instantiations
[16:42:51] <strcat> incorrectly
[16:43:02] *** Quits: canhtak (jeremy@moz-9672486C.wl.t.ulaval.ca) (Ping timeout)
[16:43:09] <strcat> by trying to keep track of whether they just depended on size/representation or nothing
[16:43:10] <bstrie> so did we do it correctly or did we just give up on reusing generics
[16:43:18] <strcat> bstrie: we will use LLVM's mergefunc
[16:43:25] <bstrie> cool
[16:43:25] <strcat> it works on libextra already
[16:43:32] <strcat> and libsyntax/librustc
[16:43:35] <bstrie> punting to llvm is 100% best strategy always
[16:43:44] <strcat> hits an assert on libstd atm but they're fixing it upstream
[16:43:53] <strcat> someone decided to start caring about it
[16:44:16] <strcat> very recently it didn't work on any complex code.... in fact our LLVM is a bit too old :)
[16:44:18] *** Joins: canhtak (jeremy@moz-9672486C.wl.t.ulaval.ca)
[16:44:32] <strcat> bstrie: https://github.com/mozilla/rust/issues/9222
[16:44:36] <bstrie> but, we're using 3.3!
[16:44:48] <bstrie> now we have to track llvm master :|
[16:44:50] <strcat> we're using close to trunk
[16:45:02] <strcat> mergefunc was majorly fixed in the past 2 weeks
[16:45:11] <strcat> numbers (in lines of IR):
[16:45:12] <strcat> libextra -> 417k with neither, 399k with type_use, 370k with mergefunc, 367k with both
[16:45:13] <bstrie> so I guess C++ much not use it too much
[16:45:33] <strcat> I think all the things type_use was merging that mergefunc doesn't catch were bugs
[16:45:38] <bstrie> are those extra 3k the incorrect merges?
[16:45:41] <strcat> probably
[16:45:43] <strcat> as in, it doesn't care about std::repr
[16:45:51] <strcat> no type bound -> must not be important!
[16:46:19] <strcat> it also had manually set "cares about nothing", "cares about size/representation" and "cares about type" per intrinsic
[16:46:34] <strcat> it basically assumed type bounds + intrinsics told the whole story..
[16:47:12] <strcat> the visit_tydesc one (or whatever it is) had 'cares about type'
[16:47:37] <strcat> but for whatever reason we got stuff like https://github.com/mozilla/rust/issues/6971
[16:48:42] <strcat> bstrie: https://github.com/mozilla/rust/issues/8957 if we do that, mergefunc will get even better :)
[16:49:42] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[16:49:50] *** Joins: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP)
[16:49:51] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[16:49:58] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[16:50:14] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[16:51:36] *** Quits: tjc (tjc@moz-FEE214EF.tmodns.net) (Quit: zzzzzzzzzz)
[16:52:05] *** Joins: rlbaker (rlbaker@moz-D05907D4.hfc.comcastbusiness.net)
[16:53:31] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[16:53:37] <bstrie> strcat: is there any reason why function addresses are significant in c++?
[16:53:41] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[16:53:53] <strcat> bstrie: addresses of every object are significant in C++
[16:54:05] <strcat> C++ compilers have to compile empty structs as non-zero-size by default
[16:54:09] <bstrie> ok, so what's the reason for that then :P
[16:54:16] <strcat> bstrie: just the semantics they chose
[16:54:27] <strcat> it can be useful to compare function pointers for equality
[16:54:36] * strcat shrugs
[16:54:52] <glyc> I don't mean to disparage all the work put into the new runtime, but since it is relatively untried/untested, is there some way to run on a really-simple-and-very-likely-to-be-correct runtime?  I see https://github.com/pcwalton/zero.rs , but I do need libstd
[16:54:59] <strcat> bstrie: I want to add #[address_significant]
[16:55:09] <strcat> but meh
[16:55:18] <strcat> until there's a real use case, why bother ;p
[16:55:19] <cmr> glyc: it's quite well tested, the core parts that you'd be using
[16:55:27] <tiffany> is there a way I can measure time with rust?
[16:55:35] <pnkfelix> cmr: I think glyc wants to swap in a different runtime … ?
[16:55:41] *** Joins: five (five@moz-F45C65F8.v4.ngi.it)
[16:55:53] <pnkfelix> cmr: (though really I'm just making wild inferences...)
[16:55:53] <glyc> cmr: I'd really like to have a single-threaded runtime, so I can fork(2) sanely
[16:55:54] <strcat> glyc: don't actually need zero.rs anymore, it's obsolete
[16:56:02] *** Quits: Lurk_ (chatzilla@moz-F088D030.hsd1.in.comcast.net) (Ping timeout)
[16:56:11] <glyc> strcat: ok
[16:56:14] <strcat> you need #[no_std] if you want fork
[16:56:24] <glyc> no libstd?
[16:56:25] <strcat> well, fork with more than just being able to call exec right away.
[16:56:31] <glyc> strcat: right
[16:56:47] <glyc> I would still want libstd
[16:56:48] <strcat> glyc: no libstd, but almost all of it would work without the runtime started
[16:56:54] <tiffany> there's sleep functions but there doesn't appear to be any way to get the current time, or measure timespans...
[16:57:11] *** Quits: canhtak (jeremy@moz-9672486C.wl.t.ulaval.ca) (Quit: canhtak)
[16:57:41] <strcat> extra::time
[16:57:42] <pnkfelix> tiffany: extra::time ?
[16:57:46] *** Quits: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu) (Quit: WeeChat 0.4.1)
[16:57:55] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[16:58:16] <tiffany> oh
[16:58:19] <tiffany> I had been searching std
[16:58:46] <strcat> glyc: we could make the runtime fork-safe if we really wanted
[16:58:49] <strcat> jemalloc is fork-safe
[16:58:53] <strcat> uses pthread_atfork
[16:59:13] <pnkfelix> tiffany: std is a good place to start, since the stuff there is more likely to be supported for long term.  But a fair amount of useful stuff currently lives in extra
[16:59:16] <glyc> strcat: that wold be great
[16:59:39] *** Joins: maik (maik@moz-DD39128A.dip0.t-ipconnect.de)
[16:59:41] <tiffany> is there no built in way to do math on timespec?
[17:00:57] <strcat> glyc: https://github.com/mozilla/rust/issues/9568
[17:00:58] <glyc> strcat: only difficulty was that I couldn't keep the runtime from starting an extra thread, even with RUST_THREADS=1; https://github.com/mozilla/rust/issues/9373
[17:01:43] <glyc> strcat: nice! that jemalloc is good
[17:01:50] <glyc> strcat: that's a huge part
[17:02:10] *** Quits: paulproteus (quassel@rose.makesad.us) (Ping timeout)
[17:02:34] *** Quits: maik (maik@moz-DD39128A.dip0.t-ipconnect.de) (Ping timeout)
[17:02:51] *** Joins: DAddYE (DAddYE@moz-61EB081B.hfc.comcastbusiness.net)
[17:03:14] *** Joins: paulproteus (quassel@moz-E86A3B42.makesad.us)
[17:04:07] <zeuxcg> rustpkg question
[17:04:21] <zeuxcg> so say I'm building a library that I want other people to use with rustpkg
[17:04:38] <zeuxcg> is the best practice to have my own src/ folder in the repository, so that people can clone it and add it to workspace?
[17:04:54] <cmr> zeuxcg: no
[17:05:13] <cmr> zeuxcg: keep it all toplevel, so rustpkg can actually fetch it
[17:05:36] <zeuxcg> from a library user perspective, say I want to use a library that I have as a git submodule, that does not have src/ folder
[17:05:46] <zeuxcg> I have to clone it into my own src folder, right?
[17:05:56] <zeuxcg> can I use subfolders while keeping the package name the same somehow?
[17:06:18] <zeuxcg> I'd like to separate third-party deps from my own code
[17:06:20] *** Joins: azakai (alon@moz-BBE3ABD.mv.mozilla.com)
[17:06:37] <zeuxcg> maybe I need to add submodules to deps/src/ folder and add "deps" to RUST_PATH?
[17:06:37] *** Joins: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net)
[17:07:13] <zeuxcg> I previously used this folder structure:
[17:07:22] <zeuxcg> deps/glfw-rs/...
[17:07:23] <cmr> jack: ^ can you comment on that?
[17:07:30] <cmr> zeuxcg: you wouldn't do that with rustpkg
[17:07:31] <zeuxcg> deps/rust-leveldb/...
[17:07:33] <zeuxcg> src/...
[17:07:40] <zeuxcg> src was my own code, deps was third-party
[17:07:43] <cmr> you'd just say extern mod glfw = "github.com/bjz/glfw-rs"
[17:07:49] <zeuxcg> I'm wondering how I should structure my project
[17:08:15] <steveklabnik> zeuxcg: check out the new tutorial
[17:08:30] <steveklabnik> http://static.rust-lang.org/doc/0.8/tutorial-rustpkg.html
[17:08:35] <steveklabnik> and let me know how to make it better :)
[17:08:41] <steveklabnik> that should get you going
[17:08:57] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[17:10:02] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[17:10:12] *** Quits: Jesin (Jessin_@moz-394702A3.cc.lehigh.edu) (Quit: Leaving)
[17:10:12] <sw17ch> steveklabnik: thanks for posting the blog stuff
[17:10:28] <steveklabnik> any time.
[17:10:36] <steveklabnik> let me know if it works out for you
[17:10:57] <yonran> Rust question: If I have a match that binds a variable in a destructuring enum pattern, can I end the variable's lifetime inside the match arm, or do I have to exit the match and do a conditional afterwards? Example: https://gist.github.com/yonran/6730835
[17:11:08] *** Quits: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP) (Input/output error)
[17:11:11] <zeuxcg> cmr: but then I'm pointing to tip
[17:11:16] <zeuxcg> or whatever it's called in git
[17:11:26] <steveklabnik> HEAD
[17:11:28] <zeuxcg> so any time I build I get a new version and have potential issues?
[17:11:34] <steveklabnik> zeuxcg: you can specify a revision
[17:11:40] <steveklabnik> either through a version or through a commit
[17:11:47] <zeuxcg> ah, ok
[17:12:10] <engla> master is the development version
[17:12:15] *** Joins: LU324 (weechat@9AF4F288.83671C58.1B5D53D7.IP)
[17:12:49] <steveklabnik> zeuxcg: the manual is more comprehensive than the tutorial, here's the relevant section on linking to a specific version: http://static.rust-lang.org/doc/0.8/rustpkg.html#package-identifiers
[17:13:11] <steveklabnik> tl;dr: mypkg#0.3 will give you version 0.3
[17:13:23] <steveklabnik> which corresponds to a tag 0.3 in their repo
[17:13:49] <engla> HEAD is just the git name for the currently checked out revision
[17:14:07] *** Joins: canhtak (jeremy@moz-9672486C.wl.t.ulaval.ca)
[17:14:10] <steveklabnik> right, 'HEAD of master' was what i was implying, which is the same as master
[17:14:17] *** Joins: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[17:14:46] <dcrewi> yonran: I'm not sure about the general case, but with Options you could do "if self.bar_if_test().is_some() { self.count += 1 }" right?
[17:14:56] <bstrie> yonran: I think you have to end the match
[17:15:05] <glyc> steveklabnik: is rustpkg test the same as rust test ?
[17:15:11] <bstrie> or do something otherwise different
[17:15:26] <engla> steveklabnik: either way, it sounds like some language imported from svn, so it conflicts with git terminology unfortunately
[17:15:26] <steveklabnik> glyc: it was just implemented last night, i haven't checked it out yet.
[17:15:29] <bstrie> but I'm not great at lifetime questions
[17:15:29] *** Quits: mib_etud02 (Mibbit@moz-788A5A86.pool.mediaways.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:15:35] <steveklabnik> engla: totally
[17:15:42] <steveklabnik> glyc: https://github.com/mozilla/rust/pull/9549
[17:16:10] <glyc> steveklabnik: nice
[17:16:20] <glyc> love the velocity of Rust
[17:16:39] <yonran> dcrewi: Yes, if I didn't need to use the variable, I could use is_some() or placeholder (match {Some(_),...}). But I wanted to use the variable a little, and then not use it anymore.
[17:16:40] <steveklabnik> glyc: it's at least differnet in that it automatically looks for a test.rs file
[17:16:57] <steveklabnik> glyc: whereas rustc can compile any file with tests on. but rust test may be similar.
[17:17:15] *** Quits: tav (tav@moz-196E6F10.sohonet.co.uk) (Quit: tav)
[17:17:44] <glyc> steveklabnik: ah I see. So rustpkg test only runs test.rs, no unit tests #[test] mixed with code like rust test
[17:18:02] <yonran> Thanks, dcrewi and bstrie.
[17:19:05] <steveklabnik> glyc: yes. my understanding (i'm compiling right now...) is that 'rustpkg test foo' will basically rust test src/foo/test.rs
[17:19:08] *** Quits: Kruppe (user@moz-253119B0.esg.uwaterloo.ca) (Ping timeout)
[17:19:27] *** Joins: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP)
[17:20:07] *** Joins: maik (maik@moz-DD39128A.dip0.t-ipconnect.de)
[17:20:16] <glyc> steveklabnik: nice!
[17:20:50] <glyc> glyc: having a heirarchical organization for tests makes a ton of sense
[17:21:03] <steveklabnik> agreed
[17:21:05] <glyc> lol self comment
[17:21:45] *** Quits: squiddy (squiddy@moz-3674C0.adsl.alicedsl.de) (Ping timeout)
[17:21:47] <glyc> steveklabnik: it would be nice to be able also indicate that any #[test] tests in a particular part of the module tree should be run 
[17:21:56] <tiffany> I'm having a problem where IsaacRng isn't working as a valid Rng
[17:22:03] <tiffany> plasma.rs:14:41: 14:60 error: mismatched types: expected `&mut std::rand::Rng<no-bounds>` but found `&mut std::rand::IsaacRng` (expected trait std::rand::Rng but found &-ptr)
[17:22:03] *** Joins: Ralith (ralith@A8995AA9.62B6AF6A.922221DB.IP)
[17:22:04] <glyc> when working on a new module, for instance
[17:22:13] <steveklabnik> we're still sorting out if tests in separate files is better in the same file or worse
[17:22:39] <steveklabnik> so you're right, i guess i'm saying it's a semi-open question
[17:22:49] <engla> tiffany: do you want to use it as a trait object `&mut Rng` or generically?  `fn f<R: Rng>(rng: &mut R)` ?
[17:23:13] <glyc> steveklabnik: I use both
[17:23:15] <engla> tiffany: to use it as &mut Rng you have to do the cast to that explicitly
[17:23:15] <tiffany> trait object
[17:23:22] <tiffany> uh.. how do I do that?
[17:23:36] <glyc> steveklabnik: in-file for microtests, and separate file for integration/acceptance tests
[17:23:43] <engla> let mut rng = rng::new();  &mut rng as &mut Rng
[17:23:55] <engla> something like that
[17:24:08] <steveklabnik> glyc: my first impression is that's the worst of both worlds. can you explain how you pick what goes where to me? i'm always open to changing my opinions :)
[17:24:24] <glyc> steveklabnik: lol. 
[17:24:35] <tiffany> stars.rs:27:19: 27:39 error: cannot call a generic method through an object
[17:24:36] <tiffany> uhh..
[17:24:41] <tiffany> oh
[17:24:43] *** Joins: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com)
[17:24:57] <glyc> steveklabnik: :-)  "how you pick what goes where" <-- not sure what this means
[17:25:08] <steveklabnik> which tests go with the source and which go in separate files
[17:25:38] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[17:25:39] <glyc> steveklabnik: microtests are typically 7 lines or less, and they test a single aspect of a single codepath through a function
[17:25:53] <glyc> steveklabnik: microtests go alongside the code they test
[17:26:53] <steveklabnik> hmm. i will admit to coming from a mostly dynamically typed background, so most of my tests are less than 7 lines ;)
[17:27:03] <steveklabnik> is this more of a unit/functional test distinction, kinda?
[17:27:18] <glyc> steveklabnik: integration/acceptance tests will almost always cover more end-to-end properties of the system, and since they aren't tied to just one module typically, and want to be runnable separately from the microtests, they go in their own file(s)
[17:27:22] *** Joins: riley (riley@8BA43816.9AA11D69.65DDFA89.IP)
[17:27:29] *** Joins: timot (timot@moz-5DFC99F3.bredband.tre.se)
[17:27:31] <steveklabnik> okay, i think that distinction makes a lot of sense, thank you.
[17:28:25] *** Joins: seryogah (holoirc@moz-7E93FB81.dip0.t-ipconnect.de)
[17:28:37] <engla> tiffany: which method is it that can't be called?
[17:28:44] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[17:28:56] <glyc> steveklabnik: so I'm actually psyched to see that rustpkg test could be the ideal thing for doing acceptance tests, while rust test will run your microtests
[17:29:06] <steveklabnik> yeah, seems good
[17:29:08] <tiffany> I fixed it, you can't use dynamic dispatch to call a generic function because that makes no sense
[17:29:17] <steveklabnik> and you could Makefile to do both
[17:29:30] <steveklabnik> though really, having it be in rustpkg test with a flag or something would be better
[17:29:44] <engla> tiffany: aha, so even .gen()?
[17:30:00] <tiffany> .gen() is a generic yeah
[17:30:12] <glyc> steveklabnik: agreed
[17:30:57] <glyc> gotta run
[17:31:07] *** Quits: glyc (Mibbit@moz-20CEEF38.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[17:33:03] *** Quits: pnkfelix (pnkfelix@87C1F78E.1DE10CA8.D8E68FF6.IP) (Quit: Leaving.)
[17:33:22] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[17:33:26] *** Quits: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP) (Client exited)
[17:34:25] *** Quits: cstrahan (cstrahan@moz-28929FF1.public.wayport.net) (Ping timeout)
[17:34:51] *** Joins: cstrahan (cstrahan@moz-28929FF1.public.wayport.net)
[17:35:59] <cmr> How can I flatten a ~[~[T]] into a ~[T]?
[17:36:09] <steveklabnik> find something heavy...
[17:36:12] <cmr> heh
[17:36:12] * steveklabnik grins
[17:36:14] <acrichto> cmr: vec::connect I think
[17:36:24] <acrichto> maybe vec::concat
[17:36:34] * acrichto searches the docs and finds vec::connect
[17:36:34] <cmr> concat, actually
[17:36:35] <cmr> but yes
[17:36:38] <cmr> thanks!
[17:36:58] <acrichto> oh connect has a separator
[17:37:57] *** Quits: maik (maik@moz-DD39128A.dip0.t-ipconnect.de) (Ping timeout)
[17:39:24] *** Quits: CarpNet (ac@moz-FD24B77.sohonet.co.uk) (Quit: Leaving)
[17:39:37] *** Joins: voxpopuli (fanservice@18CFDA68.B6327B1F.689607DE.IP)
[17:39:45] <engla> cmr: flat_map is a good flattener maybe
[17:39:52] <engla> it's got the name for it
[17:40:16] <engla> oh wait, it doesn't work with nested vec to start with..
[17:40:28] *** Joins: tjc (tjc@moz-FEE214EF.tmodns.net)
[17:40:28] *** ChanServ sets mode: +o tjc
[17:40:28] <zeuxcg> cmr: for the "extern mod glfw  = "github.com/..."" to work, the git repository should have a lib.rs at the root, right?
[17:40:40] <cmr> I looked at flat_map, but couldn't understand it :\
[17:40:43] <zeuxcg> so I can't use glfw-rs like that right now :)
[17:40:49] <cmr> "An iterator that maps each element to an iterator, and yields the elements of the produced iterators
[17:40:53] <cmr> I mean.. what?
[17:40:56] <zeuxcg> because it has its own workspace structure with an src/ folder
[17:41:05] <cmr> zeuxcg: it shouldn't, send a patch to fix it
[17:41:14] <strcat> cmr: it's magic!
[17:41:16] <steveklabnik> src/glfw/lib.rs if it's using rustpkg
[17:41:28] <zeuxcg> steveklabnik: it has src/glfw/lib.rs
[17:41:29] <engla> cmr: sorry! :-(
[17:41:39] <steveklabnik> i forget if glfw is using it or not
[17:41:41] <engla> cmr: it's the monadic bind for iterators ^^
[17:41:53] <cmr> repos shouldn't be their own workspace
[17:42:00] <cmr> engla: that doesn't clarify anything at all :p
[17:42:15] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[17:42:22] <engla> rusti: range(0,3).flat_map(|x| range(0, x)).to_owned_vec()
[17:42:22] <cmr> My usecase for this was really convoluted though
[17:42:23] -rusti- ~[0, 0, 1]
[17:42:34] <cmr> And simplified by using for loops rather than nested adaptors
[17:43:07] <engla> rusti: range(0,5).flat_map(|x| range(0, x)).to_owned_vec()
[17:43:07] -rusti- ~[0, 0, 1, 0, 1, 2, 0, 1, 2, 3]
[17:43:15] *** Quits: five (five@moz-F45C65F8.v4.ngi.it) (Ping timeout)
[17:43:20] *** Joins: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com)
[17:43:42] <cmr> rusti: let xs = ~[~["a", "b"], ~["c", "d"], ~["e", "f"]]; xs.iter().flat_map(|x| x.iter()).to_owned_vec()
[17:43:44] -rusti- pastebinned 16 lines of output: http://sprunge.us/dPKA
[17:44:46] <engla> rusti: let xs = ~[~["a", "b"], ~["c", "d"], ~["e", "f"]]; xs.move_iter().flat_map(|v| v.move_iter()).to_owned_vec()
[17:44:47] -rusti- ~["a", "b", "c", "d", "e", "f"]
[17:45:01] *** Quits: infynyxx_ (infynyxx@moz-E95B370B.nyc.res.rr.com) (Ping timeout)
[17:45:22] <engla> it's impossible to use with certain lifetimed iterators..
[17:45:40] <engla> and move_iter is no fun (inefficient)
[17:46:15] *** Quits: tjc (tjc@moz-FEE214EF.tmodns.net) (Quit: zzzzzzzzzz)
[17:46:16] <engla> anyway, I actually thought of vec::flat_map
[17:46:57] <zeuxcg> cmr: but then how do you work on glfw-rs if you're a developer? Do you check it out to a src/ folder? Seems contrived.
[17:47:09] <zeuxcg> also, glfw-rs has examples
[17:47:28] <zeuxcg> should they be in a separate repository?
[17:47:29] <cmr> zeuxcg: any awkwardness is due to insufficiencies in rustpkg
[17:47:42] <steveklabnik> we've been discussing a blessed src subdir for examples
[17:47:52] <steveklabnik> two or three of us made a src/examples to go along with our src/foo
[17:48:44] *** Joins: jdm (jdm@FCCEA34F.7672369.D8E68FF6.IP)
[17:48:44] *** ChanServ sets mode: +o jdm
[17:49:56] *** Quits: cstrahan (cstrahan@moz-28929FF1.public.wayport.net) (Ping timeout)
[17:49:59] *** Joins: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP)
[17:50:56] *** Joins: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch)
[17:53:20] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[17:53:25] <cmr> Heh, I just used an Option<()> as a bool
[17:53:30] <cmr> quite silly..
[17:53:32] <bstrie> waht
[17:53:41] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Client exited)
[17:53:44] <bstrie> terrible
[17:53:50] <cmr> bstrie: let mut found: Option<()> = None; for ... { found = Some(()) }
[17:53:57] <strcat> sets internally use Option<()> as a bool
[17:53:59] <cmr> It made sense though! It used to store a copy of the structure it found
[17:54:01] <strcat> ;p
[17:54:31] <strcat> since they're a map wrapper
[17:55:09] <engla> it's a 64-bit bool
[17:55:42] <strcat> for now ;p
[17:55:50] <strcat> optimizes out anyway, they don't store it
[17:56:15] <engla> right
[17:56:29] *** Quits: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP) (Client exited)
[17:57:20] *** Quits: timot (timot@moz-5DFC99F3.bredband.tre.se) (Ping timeout)
[18:03:08] *** Quits: Amaranth (travis@moz-F81BB56A.cpe.cableone.net) (Quit: Linkinus - http://linkinus.com)
[18:04:36] <zeuxcg> cmr: btw, the tutorial tells you to create your own workspace :) http://static.rust-lang.org/doc/0.8/tutorial-rustpkg.html
[18:04:43] <zeuxcg> see "git add src"
[18:05:08] *** Joins: five (five@moz-F45C65F8.v4.ngi.it)
[18:05:20] <zeuxcg> or actually that's probably for steveklabnik 
[18:05:34] <steveklabnik> yes, cmr, what do you mean?
[18:05:43] <steveklabnik> every rustpkg project should have a workspace.
[18:05:47] <cmr> steveklabnik: why?
[18:05:48] <steveklabnik> as far as i know
[18:05:59] <steveklabnik> ... you do work in a workspace?
[18:06:11] *** Quits: cdidd (cdidd@moz-12257DFD.broadband.corbina.ru) (Input/output error)
[18:06:20] <cmr> Sure, but your project is intended to live in another workspace.
[18:06:27] <cmr> Nested workspaces like that seem really weird
[18:06:32] <steveklabnik> that's just details
[18:06:49] <steveklabnik> why?
[18:07:13] <ion> Thank you Mario! But your project is in another workspace.
[18:07:16] <steveklabnik> all your dependencies end up in .rust (wherever your RUST_PATH is)
[18:07:26] <steveklabnik> you don't even end up seeing them.
[18:08:04] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[18:08:08] <cmr> Yes, right, but I don't see why you'd want an extra src subdir. The repo is already your source. rustpkg needs to be able to be able to build the current dir without forcing it to be part of a workspace.
[18:08:19] <steveklabnik> which one is extra?
[18:08:22] <cmr> The src subdir was always a workaround for the temporary implementation of "rustpkg build" without a pkgid
[18:08:28] <cmr> src/glfw
[18:08:38] <steveklabnik> hmmmmmm
[18:08:40] <cmr> the contents of src/glfw should be in the repo root, as I see it
[18:08:48] <cmr> And if your repo has multiple crates
[18:08:48] *** Joins: Amaranth (travis@moz-F81BB56A.cpe.cableone.net)
[18:08:58] <cmr> it should be $ROOT/{crate1,crate2}
[18:09:16] <steveklabnik> i guess i can see that as an option, i'm not sure that's the way rustpkg is supposed to be used.
[18:09:23] <cmr> it is, afaik
[18:09:25] <steveklabnik> too bad tjc isn't around
[18:09:31] <steveklabnik> well then all my docs for it are wrong ;)
[18:09:48] <steveklabnik> well, i mean, they work
[18:09:53] <steveklabnik> but they don't tell you to do that.
[18:10:02] <steveklabnik> to be clear, i just want to document what the RIGHT way to do things is
[18:10:09] <cmr> right
[18:10:10] <steveklabnik> i dont really care what that is as long as we're all on the same page
[18:10:10] <cmr> yeah
[18:10:24] <cmr> rustpkg currently doesn't support anything else, if you want to say `rustpkg build` while you're working on a project.
[18:10:29] <cmr> So it's not WRONG
[18:10:30] <steveklabnik> okay, cool.
[18:10:36] <cmr> Just... not how it's going to end up, I think
[18:10:56] <steveklabnik> word. that's cool by me, i care about current at the moment.
[18:11:14] <steveklabnik> i really dislike source files in the root
[18:11:28] <steveklabnik> but i care more about unity than my preferences ;)
[18:12:04] <steveklabnik> it's kinda funny, i'm a pretty messy person in real life
[18:12:12] <steveklabnik> but with software... directories!
[18:12:14] <steveklabnik> :)
[18:12:38] *** Joins: timot (timot@moz-5DFC99F3.bredband.tre.se)
[18:13:12] <cmr> heh
[18:14:32] <steveklabnik> oh no, i accidentally built rust from my fork, whose master is really old. time to re-compile....
[18:14:34] *** Joins: mib_85zp5d (Mibbit@moz-7A4C54E9.cable.virginmedia.com)
[18:14:37] *** Quits: mib_85zp5d (Mibbit@moz-7A4C54E9.cable.virginmedia.com) (Quit: mib_85zp5d)
[18:15:07] <jstevans> How do I remove rust 0.7 from my system?
[18:15:24] <cmr> jstevans: make uninstall, if you used the makefiles
[18:18:58] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[18:18:59] *** ChanServ sets mode: +ao brson brson
[18:19:50] *** Joins: tjc (tjc@moz-BE33DA21.fw1.sfo1.mozilla.net)
[18:19:50] *** ChanServ sets mode: +o tjc
[18:21:18] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[18:21:55] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[18:21:56] *** Joins: rubberpen (Mibbit@moz-9CE9E022.dip0.t-ipconnect.de)
[18:22:42] <cmr> Ugh
[18:22:42] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[18:22:44] <cmr> My rustc updated
[18:22:49] <cmr> And now this code ICEs ;|
[18:23:05] *** Joins: azita (Azita@moz-BBE3ABD.mv.mozilla.com)
[18:23:09] * cmr hopes it's out-of-date metadata in deps
[18:23:10] <bstrie> cmr: downgrade, use 0.7 forever
[18:24:11] *** Quits: canhtak (jeremy@moz-9672486C.wl.t.ulaval.ca) (Quit: canhtak)
[18:24:46] *** Quits: lucian (lucian@6B2B4644.4304AE1E.CE5E78F6.IP) (Ping timeout)
[18:28:49] <polyfractal> is there any particular reason why f32/f64 implement Algebraic (e.g. pow, sqrt, etc) but the various integers do not?
[18:29:39] <bstrie> polyfractal: iirc bjz was involved in the numerics dicussion, might be able to answer your question
[18:29:50] <polyfractal> bstrie: will look it up, thanks.
[18:29:52] <cmr> polyfractal: I imagine that the integers can't even pretend to obey the identities Algebraic implies
[18:30:28] *** Quits: sergi (textual@moz-DB55470C.upc-a.chello.nl) (Quit: Computer has gone to sleep.)
[18:30:46] <cmr> rusti: let x = 6341.152f; x.sqrt().rsqrt() == x
[18:30:47] -rusti- false
[18:30:57] <cmr> rusti: let x = 6341.152f; x.sqrt().rsqrt()
[18:30:58] -rusti- 0.11206189
[18:31:03] <cmr> hm, I think I did it wrong
[18:31:28] <polyfractal> fair enough.  From an ignorant-user point of view, it's inconsistent that I can do my_float.pow(2), but have to do int::pow(my_int, 2)
[18:31:30] <cmr> rusti: let x = 6341.152f; x.sqrt() * x.rsqrt()
[18:31:31] -rusti- 1
[18:32:31] <engla> for pow you have a point polyfractal 
[18:32:40] <bstrie> indeed
[18:33:12] <cmr> I think the numeric library should be more abstract algebra, but apparently that was turned down.
[18:33:25] * cmr hasn't read the extensive numeric reform thread yet
[18:33:38] <engla> I don't know if anything was decided
[18:34:05] <bstrie> polyfractal: could you file a bug so we don't forget?
[18:34:08] <engla> int::pow doesn't have the same signature as num::pow, because int's version is  fn pow(base: int, exponent: uint) -> int
[18:34:21] <engla> with an uint exponent
[18:34:46] <polyfractal> bstrie: sure :)
[18:39:12] *** Quits: rubberpen (Mibbit@moz-9CE9E022.dip0.t-ipconnect.de) (Quit: http://www.mibbit.com ajax IRC Client)
[18:39:27] *** Joins: rubberpen (Mibbit@moz-9CE9E022.dip0.t-ipconnect.de)
[18:40:35] *** Quits: rubberpen (Mibbit@moz-9CE9E022.dip0.t-ipconnect.de) (Quit: http://www.mibbit.com ajax IRC Client)
[18:41:08] <cmr> So, is there something like extend, but in the opposite direction? Remove everything from this iterator
[18:41:17] <cmr> I should probably be using a set rather than a vector.
[18:42:03] <cmr> I feel like there used to be a remove_all, but maybe not.
[18:42:25] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Input/output error)
[18:43:47] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[18:43:58] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[18:44:12] <cmr> Ok yeah I really need to be using a set, nevermind.
[18:47:47] *** Joins: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[18:48:26] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[18:49:12] *** Joins: rhelmer (rhelmer@moz-DB4A9C19.scl3.mozilla.com)
[18:49:16] *** Joins: frogonia (Mibbit@moz-2E1EFB35.pool.mediaways.net)
[18:49:18] *** Quits: Axord (xord@moz-1B228827.lsanca.dsl-w.verizon.net) (Quit: I'm sure it's perfectly safe)
[18:49:22] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[18:49:52] *** Quits: zeuxcg (zeuxcg@moz-80D1F912.hsd1.ca.comcast.net) (Ping timeout)
[18:50:53] <polyfractal> How would I go about building a dynamic multidimensional array?  I need an array of integer arrays, and I don't know the length of either at compile time. 
[18:51:03] <cmr> ~[~[int]]
[18:51:30] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Ping timeout)
[18:51:41] *** Joins: valenting (Thunderbir@55FBCC0.8C025854.E16F0CF5.IP)
[18:52:17] *** Joins: maik (maik@moz-DD39128A.dip0.t-ipconnect.de)
[18:53:07] *** Joins: jaen (jaen@moz-E0979827.copit.pl)
[18:53:57] <polyfractal> cmr: ah, got it, I was trying to statically allocate the "outer" portion (buckets = ~[~[u32], ..i] ) instead of generating it with vec::from_elem
[18:53:59] <polyfractal> :D
[18:55:08] *** ozten is now known as ozten|afk
[18:55:48] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[18:58:53] *** Quits: five (five@moz-F45C65F8.v4.ngi.it) (Ping timeout)
[18:59:58] *** Quits: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP) (Connection reset by peer)
[19:00:20] *** Joins: vadimcn (chatzilla@A2267643.76F9E272.DA40C4B3.IP)
[19:00:43] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[19:00:48] *** Quits: KindOne (KindOne@moz-D75CF3E3.dynamic.ip.windstream.net) (Ping timeout)
[19:02:01] *** Joins: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP)
[19:02:40] *** Joins: SiegeLord (sl@moz-3D449DF.bstnma.fios.verizon.net)
[19:03:48] *** Joins: TheDust (Stijn@moz-8C2076C2.upc-d.chello.nl)
[19:04:03] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[19:04:41] *** Joins: Kruppe (user@moz-A46941C6.net.uwaterloo.ca)
[19:05:06] *** Joins: KindOne (KindOne@moz-D75CF3E3.dynamic.ip.windstream.net)
[19:05:51] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Ping timeout)
[19:07:25] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[19:09:34] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:10:34] *** Joins: jensnockert (jensnocker@moz-2DBD7676.mobileonline.telia.com)
[19:13:28] *** Quits: frogonia (Mibbit@moz-2E1EFB35.pool.mediaways.net) (Quit: http://www.mibbit.com ajax IRC Client)
[19:14:25] *** Quits: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP) (Client exited)
[19:14:43] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[19:15:29] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[19:16:21] *** Joins: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP)
[19:18:59] <polyfractal> Oh god this looks like I'm mangling my keyboard…is this legit?  I want a vector of RWarcs which each manage a vector of u32:  locks: ~[~RWArc<~[u32]>]
[19:19:15] <polyfractal> it compiles...but...
[19:19:27] <strcat> why is the RwArc in ~?
[19:19:33] <cmr> you probably just want ~[RWArc<~[u32]>]
[19:19:58] <polyfractal> ok.  Still trying to figure out when things should be owned/on the heap and when they shouldn't
[19:20:02] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[19:20:20] <strcat> polyfractal: ~ is for making recursive data structures
[19:20:28] *** Joins: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net)
[19:20:29] <strcat> if you don't have a recursive data structures, chances are you don't want ~
[19:20:40] <strcat> structure*
[19:20:53] <strcat> beyond that, it is useful in rare circumstances where you have very large values
[19:21:00] <strcat> but you should measure first... indirection rarely helps
[19:21:29] <polyfractal> strcat: I thought it also moves it from stack to heap, right?  If you have say a vector of 20k ints…that would blow out the stack no?
[19:21:41] <strcat> polyfractal: no, it won't 'blow the stack'
[19:21:54] * polyfractal knows nothing about low level memory apparently
[19:21:55] <polyfractal> ok :)
[19:22:05] <strcat> and when the runtime is finished, rust will have growable stacks again
[19:22:11] <strcat> polyfractal: just don't use ~ when you don't need it
[19:22:23] <engla> well you use ~[] for a dynamic array, so it's sort of another case that's not a recursive datastructure
[19:22:26] <strcat> *only* time you need it is a recursive struct/enum
[19:22:35] <strcat> engla: ~[] isn't ~T
[19:22:44] <engla> I'm going to add that
[19:22:48] <Ms2ger> Also ~str
[19:22:55] <strcat> neither of which is a ~T
[19:23:06] <polyfractal> ok, so my usage of ~[u32] is fine, since I want a vector of u32s ?
[19:23:11] <cmr> polyfractal: yes
[19:23:23] <engla> I'm assuming a newcomer will assume that ~[] has something to do with ~T. and it has *something*
[19:23:23] <flaper87> brson: ping
[19:23:30] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Connection reset by peer)
[19:23:35] <strcat> polyfractal: ~[T] is the language's dynamically sized vector, it's not the same thing as a unique pointer
[19:23:43] <engla> polyfractal: but yes, note that vectors, ~[T], is a special case. It has an indirection so that it can grow
[19:23:43] <jack> Can I not `pub use foo::Bar;` when foo is private?
[19:23:44] <strcat> engla: great reason to call them Vec/Str instead
[19:23:51] <jack> (foo is my child module here)
[19:23:51] <engla> strcat: yes
[19:23:55] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[19:24:27] *** Quits: Ms2ger (Ms2ger@9D0A393.CB23CDC6.3773EA9F.IP) (Quit: nn)
[19:24:56] <polyfractal> strcat engla:  ahh, ok, didn't realize the ~ on a vector is different from a unique ~ pointer
[19:25:05] <polyfractal> think i need to reread the pointers tutorial (again) anyway
[19:25:25] <myname> it kinda makes sense to me
[19:25:33] <engla> see, I guessed correctly :)
[19:26:15] <myname> if you'd make ~[T] a pointer and you have to move it somewhere else to grow, you had to change the pointer, which is something you might not want to do
[19:27:44] <strcat> a pointer doesn't make sense as the representation for ~[T] anyway
[19:27:51] <jack> I really want doc search to be over both std and extra
[19:27:54] <steveklabnik> we discussed this yesterday a bit too
[19:27:57] <steveklabnik> i also found it confusing
[19:28:06] <steveklabnik> we should write this down....
[19:28:09] <polyfractal> ++
[19:28:14] <cmr> jack: #rustdoc-wg ;)
[19:28:18] <strcat> steveklabnik: ~[T] and ~str would be better off called Vec<T>/Str
[19:28:25] <strcat> they are really nothing to do with ~T
[19:28:35] <steveklabnik> yeah
[19:28:47] <steveklabnik> but the fact that ~[T] and ~T look so much alike is really, really confusing
[19:28:56] <strcat> https://github.com/mozilla/rust/issues/8981 very real performance reason for them not to be just a pointer too
[19:29:07] <cmr> Would Vec and Str still be language builtins, at that point, or would we remove them?
[19:29:10] <engla> you would have to abandon the ~[T] and &[T] similarity of the types then
[19:29:14] <cmr> I don't see any particular reason they have to be.
[19:29:14] <engla> but maybe that's for the better
[19:29:33] <strcat> cmr: well, atm you can't write smart pointers or vectors in the stdlib that are correct
[19:29:36] <strcat> but we need to fix that anyway
[19:30:04] *** Quits: mikezaby (mikezaby@moz-908EA8DE.home.otenet.gr) (Input/output error)
[19:30:10] <strcat> https://github.com/mozilla/rust/issues/9509
[19:30:27] <SiegeLord> ~Trait doesn't have too much to do with ~T either :P
[19:30:42] <strcat> it does
[19:30:49] <strcat> it's implemented as a pointer, and always will be
[19:30:56] <strcat> it will if we implement dynamically sized types, ~Trait will be ~T
[19:31:17] <doomlord_> is it a pair of pointers (i thought) .. what is it thats a pointer to a struct and pointer to vtable (is that how it works)
[19:31:36] <strcat> well.. yeah, it's still a pair of ptrs
[19:31:43] *** Joins: cstrahan (cstrahan@DB1CB554.80B5DDE4.2D737EA7.IP)
[19:31:52] <strcat> so I guess not quite ~T...
[19:32:26] <strcat> but it would be an implementation detail afaik
[19:32:32] <doomlord_> the common factor between all these things is unique-ownership still,right? but the low level details differ
[19:32:48] <strcat> doomlord_: almost everything is unique ownership
[19:32:59] *** Joins: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[19:33:05] <strcat> anything without @/@mut/*/& in it
[19:33:18] <doomlord_> its nice having the really compact syntax ~ for something so common compared to 'modern-c++'
[19:33:31] <steveklabnik> doomlord_: it's nice to hear you say that, many people seem to say the opposite
[19:33:34] <strcat> it shouldn't be common
[19:33:35] <cmr> doomlord_: I agree with that.
[19:33:36] <engla> you can dereference ~T but not ~str or ~Trait. maybe that's an obvious difference.
[19:33:40] <strcat> I don't.
[19:33:44] <strcat> unique ptrs should be very rare
[19:33:49] <doomlord_> but i can see how all the permuations with shared ownership can explode beyond simplicity
[19:33:50] <cmr> I mean ~[] compared to std::vector
[19:33:51] <strcat> if you're using them off you're doing something wrong ;p
[19:33:59] <steveklabnik> strcat: i know you are way smarter than me, maybe i haven't written enough rust yet
[19:34:02] <strcat> cmr: sure, and by using that syntax we confuse almost everyone
[19:34:06] <engla> It's very nice to have the ~T syntax.
[19:34:06] <cmr> yeah :(
[19:34:08] <steveklabnik> it seems like so many things take pointers that you need to have them
[19:34:19] <cmr> The syntax is nice and short, but incomprehensible when trying to understand.
[19:34:29] <strcat> steveklabnik: lots of things take &
[19:34:32] <strcat> or return &
[19:34:32] <SiegeLord> What about &[], will that be gone too?
[19:34:32] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[19:34:43] <steveklabnik> ... i have a perl AND ruby tattoos, so i can't speak to the understandability of symbols
[19:34:43] <SiegeLord> It's hardly a &T either
[19:34:44] <engla> SiegeLord: it would have to be a type like  Slice<'a, T>
[19:34:48] <strcat> steveklabnik: the only *semantic* reason to ever use ~ is really to make a recursive data structure
[19:34:51] <SiegeLord> Yeah, that's bad :P
[19:34:56] <steveklabnik> strcat: right, sooooo i guess what you're saying is that ... 
[19:35:04] <strcat> or ~Trait objects.... but trait objects are very rare too
[19:35:14] <steveklabnik> let x = 5. fn foo(x: &int);
[19:35:16] <steveklabnik> what do?
[19:35:20] <strcat> &x
[19:35:22] <SiegeLord> That's the case where notational convenience should supercede consistency
[19:35:24] <steveklabnik> ah ha!
[19:35:29] <steveklabnik> this may be the bit of missing-ness in my brain
[19:35:42] <strcat> steveklabnik: &int is a view of an int, anywhere
[19:35:43] <steveklabnik> see, my brain goes 'oh, we need a reference, so gotta ~5
[19:35:51] <engla> SiegeLord: but &[T] vs ~[T] is confusing too.
[19:35:52] *** Joins: tikue_ (tkuehn@58063012.87C752B1.689607DE.IP)
[19:36:02] <cmr> steveklabnik: you can take a pointer to a value on the stack
[19:36:02] <SiegeLord> engla, Lifetimes are 10000x more confusing
[19:36:09] <strcat> steveklabnik: ~T exists when you need to make something that's large pointer-size
[19:36:14] <steveklabnik> this is a big conceptual breakthrough for me
[19:36:16] <steveklabnik> thank you.
[19:36:20] <SiegeLord> You're trying to remove a minor stumbling block in front of a cliff :P
[19:36:21] *** Quits: lucian (lucian@moz-22A14C6A.cable.virginmedia.com) (Ping timeout)
[19:36:23] <engla> SiegeLord: well  Slice<T> is the same as &[T]
[19:36:33] <strcat> steveklabnik: the 3 use cases of ~T all have to do with making something pointer-size
[19:36:38] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[19:36:39] <engla> SiegeLord: you can omit the liftimes in the same situations
[19:36:42] <strcat> ~Trait -> you don't know the actual size of the object, you must use indirection
[19:36:45] <indirect> SiegeLord: isn't it better to have your balance when you go over a cliff? :P
[19:36:57] <SiegeLord> indirect, You're climbing the cliff :P
[19:37:02] <strcat> steveklabnik: or a recursive structure, where it would otherwise be infinitely sized and wouldn't work
[19:37:18] <steveklabnik> and the third?
[19:37:19] <strcat> steveklabnik: or the final very, very rare case when you actually pass some *huge* thing around by-value everywhere and ~ might make that a bit cheaper
[19:37:24] * steveklabnik nods
[19:37:27] <steveklabnik> okay. this is awesome.
[19:37:27] <strcat> but usually you pass around a & ref to it
[19:37:32] <SiegeLord> engla, It's 10x as ugly... it's bad enough that there's no slice syntax
[19:37:36] <steveklabnik> i wasn't PLANNING on re-writing the pointer tutorial today....
[19:37:37] <steveklabnik> ;)
[19:37:43] <SiegeLord> *slice creation syntax
[19:38:00] <strcat> steveklabnik: anyway I hope it makes sense why ~ exists now :), it's just for indirection for that size invariant
[19:38:23] <steveklabnik> yes. yes yes yes.
[19:38:30] <strcat> technically, for objects no larger than pointers, rustc could avoid allocating
[19:38:45] <strcat> would need to make the borrow header thing in the tydesc an enum with 3 states instead of a bool
[19:38:54] <doomlord_> is there the equivalent of variable-length (length=immutable) arrays allocated with alloca on the stack in C
[19:39:01] <strcat> doomlord_: no
[19:39:22] *** Joins: jgilbert (jgilbert@moz-BBE3ABD.mv.mozilla.com)
[19:39:29] <strcat> theoretically possible, but maybe the cost is too high
[19:39:55] <engla> SiegeLord: is it really ugly? I think it's easier to understand
[19:39:59] *** Quits: GeneralMaximus (ankur@38A29E30.3B7EC11C.BE90E62C.IP) (Ping timeout)
[19:40:01] <steveklabnik> we also decided that 'box' vs 'pointer' makes sense, yes? a pointer points at a box?
[19:40:08] <engla> SiegeLord: that's a guess about understanding though
[19:40:12] <steveklabnik> we used to say 'unique box' and at some point wnet into 'unique pointer'
[19:40:12] <strcat> steveklabnik: kind of
[19:40:33] <strcat> steveklabnik: I mean, ~int is just a ptr (1-word) pointing at an int (1-word)
[19:40:40] <strcat> + hidden magical allocator stuff, but that's not in or around the box
[19:40:44] <steveklabnik> ok
[19:41:25] <steveklabnik> what's a good explanation for what a box is?
[19:42:06] <strcat> steveklabnik: I think you should just explain it how I explained it to you (why it exists, when to use it)
[19:42:12] <steveklabnik> yeah totally
[19:42:13] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Quit: Leaving)
[19:42:22] *** Joins: foodoo (foodoo@moz-9624083A.pool.mediaways.net)
[19:42:31] *** Quits: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP) (Client exited)
[19:42:32] *** ozten|afk is now known as ozten
[19:42:34] <steveklabnik> the box part is for my own understanding
[19:42:37] <strcat> the 'box' thing is sort of weird because it's just pointing at the object
[19:43:14] <steveklabnik> oh yeah
[19:43:18] <steveklabnik> this is coming back to me now
[19:43:23] <strcat> it's true that @ pointers have a header
[19:43:26] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[19:43:28] <strcat> so they are truly a "box"
[19:43:31] <steveklabnik> basically boxes are for types that aren't machine-native
[19:43:35] <steveklabnik> yes?
[19:43:39] <strcat> steveklabnik: no
[19:43:43] <strcat> steveklabnik: rust doesn't box things like that
[19:43:56] <steveklabnik> right but other languages do, yeah?
[19:43:56] <strcat> struct { x: int, y: int } is laid out in memory as |int|int|
[19:43:59] <strcat> steveklabnik: yeah
[19:44:01] <strcat> steveklabnik: java
[19:44:03] <steveklabnik> that's why you have int vs. Integer in java
[19:44:13] <steveklabnik> okay, yes. connecting some dots
[19:44:19] *** Quits: maik (maik@moz-DD39128A.dip0.t-ipconnect.de) (Ping timeout)
[19:44:19] <strcat> steveklabnik: right, Integer is essentially @mut int in rust
[19:44:32] <Yoric> Integer is mutable?
[19:44:38] <strcat> maybe @int then
[19:44:52] * Yoric hasn't used Java in some time, though.
[19:44:59] <SiegeLord> engla, I don't know... I spent 10 minutes understanding that &[] is not &T, but I still get lifetime errors to this day
[19:45:02] <steveklabnik> yeah i dont remember either
[19:46:07] <strcat> steveklabnik: http://static.rust-lang.org/doc/master/tutorial.html#boxes I made an earlier attempt at explaining it that way here
[19:46:12] <engla> SiegeLord: ok but lifetimes are the same for &'self [T] and Slice<'self, T>
[19:46:13] <strcat> but since then I've gotten better at explaining it
[19:46:15] <strcat> practice!
[19:46:17] <strcat> ;p
[19:46:37] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[19:46:59] *** Quits: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net) (Quit: jmgrosen)
[19:47:15] <strcat> really, really need "you do not need owned boxes (or unique pointers, whatever we call them) except in these 2 circumstances: ..." + mention the final rare perf reason
[19:47:27] <thewonderidiot> oh man. I thought I understood ~ but now I'm totally lost again, haha
[19:47:50] * polyfractal has decided he has no idea how lifetimes work anymore either
[19:48:15] <polyfractal> strcat: when I read through articles/tutorials/docs…it makes it sound like you should use "owned boxes" ~ everywhere
[19:48:26] <strcat> yeah I can see why people get that impression
[19:48:33] <strcat> ~ should be viewed as code smell most of the time
[19:48:33] <SiegeLord> &[] are really fundamental to Rust, it'd be a real shame if they don't have a good syntax for them... ~[] are pretty fundamental too as they are commonly used as bases for &[]
[19:48:37] <polyfractal> its like "Holy crap look at these memory structures that protect you!  Use them on everything!"
[19:48:37] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Ping timeout)
[19:48:46] <thewonderidiot> pcwalton even says that in his "which pointer should I use" blog post. Have things changed since then or was I missing the point?
[19:48:56] <polyfractal> strcat:  good to know…should put that disclaimer in the docs/articles somewhere :)
[19:49:03] <strcat> thewonderidiot: you shouldn't use pointers just because they're there
[19:49:06] <strcat> you should use plain old values
[19:49:21] <strcat> and references (&, &mut)
[19:49:32] <strcat> it should be *very* rare to need ~ outside of a tree structure you're implementing
[19:49:43] <strcat> and you shouldn't need to make a tree very often, the stdlib has nice containers
[19:49:43] <thewonderidiot> interesting
[19:50:00] <strcat> thewonderidiot: ~T just takes some T and makes it 1-word in size, via indirection
[19:50:03] <strcat> that is the only purpose
[19:50:05] <SiegeLord> I'd rather remove ~T and keep ~[] :P
[19:50:29] <strcat> and you only need that for dynamic dispatch (which usually isn't idiomatic), or recursive structures
[19:50:39] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[19:50:56] <polyfractal> strcat: if i need to give a value to a function and I want that function to modify that value, that would be a case for "owned boxes" right?  That's how I interpreted ~ when I read docs:  you use it when you want to transfer control of a value to someone else
[19:51:01] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Input/output error)
[19:51:07] <strcat> polyfractal: no, it wouldn't
[19:51:09] <polyfractal> (which i now assume is incorrect :P)
[19:51:10] <polyfractal> heh
[19:51:10] <strcat> pass them a value
[19:51:14] <strcat> ~T is not more useful than T
[19:51:25] <flaper87> r? https://github.com/mozilla/rust/pull/9574 really small commit 
[19:51:28] <strcat> it is T with an extra destructor, and indirection to make it pointer-size
[19:51:29] <strcat> *nothing* else
[19:52:36] <strcat> rusti: fn foo(x: int) { println!("{}", x) } let x = 5; foo(x)
[19:52:38] -rusti- 5
[19:52:38] -rusti- ()
[19:52:51] <strcat> rusti: fn foo(mut x: int) { x = 10; println!("{}", x) } let x = 5; foo(x); println!("{}", x)
[19:52:52] -rusti- 10
[19:52:52] -rusti- 5
[19:52:52] -rusti- ()
[19:53:13] <strcat> rusti: fn foo(x: &mut int) { *x = 10; println!("{}", *x) } let mut x = 5; foo(&mut x); println!("{}", x)
[19:53:14] -rusti- 10
[19:53:14] -rusti- 10
[19:53:14] -rusti- ()
[19:53:43] <strcat> no reason to *ever* put an int in a ~, unless you want to cast it as ~Trait to use dynamic dispatch
[19:53:52] <steveklabnik> strcat: what about @?
[19:54:00] <steveklabnik> what's the simple use cases?
[19:54:05] <strcat> @/@mut are for shared ownership, rather than the usual single owner
[19:54:08] <polyfractal> strcat: I dont even know what that means, so I shall strike all ~ from my code where possible :)
[19:54:24] <steveklabnik> when do you NEED shared ownership in rust code?
[19:54:26] <strcat> polyfractal: it's possible everywhere, unless you have something recursive ;p
[19:54:32] <strcat> steveklabnik: you don't ever really *need* shared ownership
[19:54:35] <strcat> it's just often convenient
[19:54:41] <steveklabnik> seems good
[19:56:00] <strcat> steveklabnik: if you can't (easily) design something in a way where there's a single owner from which you pass around references
[19:56:47] * steveklabnik nods
[19:57:00] <strcat> there are not really use cases for @/@mut until the program gets large/convoluted and you need a more efficient/manageable solution than copying or passing around lots of data
[19:57:22] <strcat> or.... if you have non-copyable types
[19:57:24] <strcat> say, a file
[19:57:36] <strcat> and you can't structure in a way where there can be 1 owner
[19:57:55] <polyfractal> switching gears completely, I'm reading an article on tasks….is "|move arc2|"  syntax for a closure?  do task::spawn |move arc2|
[19:58:01] <steveklabnik> move is gone
[19:58:06] <strcat> long gone! ;p
[19:58:07] <polyfractal> thought so!
[19:58:09] <polyfractal> :D
[19:58:12] <strcat> polyfractal: there's a tasks tutorial
[19:58:13] <steveklabnik> |foo| { code } is a closure
[19:58:21] <strcat> steveklabnik: well
[19:58:23] <strcat> don't need {}
[19:58:24] <steveklabnik> ish
[19:58:24] <steveklabnik> yeah
[19:58:27] <strcat> |...| expr
[19:58:45] <strcat> {} lets you have more than one expr, since it's an expr itself
[19:58:51] <polyfractal> strcat: revision to my statement: was reading an article on Arc management (I'm also reading the tutorial on tasks too, and noticed the difference in syntax, hence the question)
[19:59:13] <polyfractal> gotcha, thanks
[20:00:15] <polyfractal> I don't understand the "do spawn || { " syntax in the tasks tutorial though.  What are those double pipes for?
[20:00:31] <cmr> closure with no args
[20:00:40] <polyfractal> ohhhh
[20:00:40] <polyfractal> doh
[20:01:02] <polyfractal> haha, now that was a silly question right after asking about closures :P
[20:01:02] *** Quits: Yurume (yurume@AC58A8CE.8A059B47.E313B915.IP) (Ping timeout)
[20:01:11] <strcat> polyfractal: you can omit || if you're using 'do'
[20:01:15] *** Quits: josh (josh@moz-348C4790.hsd1.mn.comcast.net) (Quit: josh)
[20:01:18] <strcat> and it has no args
[20:01:18] <strcat> rusti: do spawn {}
[20:01:19] -rusti- ()
[20:02:24] <strcat> steveklabnik: I'll send a PR a bit later rewriting that owned boxes section
[20:02:43] * strcat understands what's wrong with it now :)
[20:02:44] <steveklabnik> strcat: okay! i'm focusing on taking the borrowed tutorial and turning it into a full pointer tutorial
[20:02:55] *** Joins: canhtak (jeremy@moz-3FFB5CDA.wl.t.ulaval.ca)
[20:02:55] <steveklabnik> i think you'll like it
[20:03:03] <steveklabnik> thank you for being so patient with me, as always.
[20:03:06] <strcat> np :)
[20:04:06] *** Quits: acabrera (alcabrera@4B9B70ED.4D823036.F18532AE.IP) (Ping timeout)
[20:05:01] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[20:05:30] <cmr> steveklabnik: did you see http://cmr.github.io/blog/2013/08/13/rust-by-concept/ too?
[20:05:31] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[20:05:33] *** Quits: voxpopuli (fanservice@18CFDA68.B6327B1F.689607DE.IP) (Ping timeout)
[20:05:51] <steveklabnik> i dont think so
[20:05:54] <steveklabnik> i'll check it out, thanks
[20:06:06] <steveklabnik> what is the new way to print something with a format?
[20:06:09] <steveklabnik> they all look the same
[20:06:18] <steveklabnik> just an int
[20:07:28] *** Quits: canhtak (jeremy@moz-3FFB5CDA.wl.t.ulaval.ca) (Quit: canhtak)
[20:08:11] <cmr> steveklabnik: http://static.rust-lang.org/doc/master/std/fmt/index.html
[20:08:20] <steveklabnik> yeah but printf
[20:08:25] <steveklabnik> or whatever, didn't all that change?
[20:08:28] *** Joins: acabrera (alcabrera@1994AFB3.88896D71.F18532AE.IP)
[20:08:40] <jack> Odd. glfw-rs has a struct Modifiers(int); and it impls a method `contains`. But if i call the method it says it can't find it.
[20:08:41] <cmr> what do you mean?
[20:09:06] <cmr> print! and println! are the macros for print{,ln}(format!(...))
[20:09:16] <steveklabnik> https://github.com/mozilla/rust/pull/9550
[20:09:19] <steveklabnik> was what i was thinking of
[20:09:29] <steveklabnik> println! is what i want, thanks
[20:09:56] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[20:11:14] *** Joins: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP)
[20:11:18] <cmr> jack: looks like it should work to me :\
[20:11:35] <jeaye> jack: Like so? https://github.com/bjz/glfw-rs/commit/59b3a82ae88a934462362d6e5633d315435cc82a
[20:13:37] <jack> yes. exactly like that.
[20:13:41] <jack> but it doesn't work :(
[20:13:51] <jeaye> :|
[20:13:51] *** Quits: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net) (Quit: Leaving.)
[20:13:59] <jeaye> bjz_: ping ^
[20:14:21] <jack> jeaye, cmr: https://gist.github.com/metajack/6734528#file-glfw_windowing-rs-L203
[20:14:32] *** Quits: nkoep (nik@moz-EF05DC0E.vpn.rwth-aachen.de) (Ping timeout)
[20:14:32] *** Quits: wilsonk-laptop (kvirc@moz-8E86F35A.cg.shawcable.net) (Ping timeout)
[20:14:40] <jack> it fails with mods does not implement any method `contains`.
[20:15:07] <jeaye> Remove line 204?
[20:15:11] <SiegeLord> Is there a mutex primitive that can be atomically created? 
[20:15:16] <jack> jeaye: doh!
[20:15:18] <jack> thanks for spotting that.
[20:15:24] <jeaye> Sure thing.
[20:16:20] *** Joins: squiddy (squiddy@moz-3674C0.adsl.alicedsl.de)
[20:16:23] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[20:17:11] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[20:18:23] <SiegeLord> What I want to do is initialize a C library, but I want to do it in a thread safe manner... so I need some way to safely set a global initialization flag
[20:19:11] <strcat> use a sane C library instead? ;p
[20:19:18] <strcat> or an atomic bool
[20:19:18] <brson> SiegeLord: creating proper mutex bindings is the subject of https://github.com/mozilla/rust/issues/9105
[20:19:28] <strcat> is_init as an atomic bool
[20:21:11] *** Joins: kherge (Mibbit@A9C30D0F.296F3964.822873CF.IP)
[20:21:24] *** Joins: GeneralMaximus (ankur@B94A34D7.5E52A1B.BE90E62C.IP)
[20:21:30] *** Quits: fabiand (fabiand@moz-3EE5E08C.adsl.alicedsl.de) (Quit: Verlassend)
[20:21:34] <SiegeLord> How do you do atomics in Rust?
[20:21:36] *** Joins: JanC (janc@moz-12DFBB97.dsl.scarlet.be)
[20:21:39] *** Joins: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com)
[20:22:12] <brson> SiegeLord: std::unstable::atomics has a bunch of atomic types
[20:22:27] <SiegeLord> Hmm... why wasn't that found by the doc's search...
[20:22:39] *** Joins: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com)
[20:22:51] *** Quits: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com) (Connection reset by peer)
[20:23:09] <brson> SiegeLord: std::unstable is #[doc(hidden)]
[20:23:18] <SiegeLord> I see...
[20:23:23] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[20:23:40] <flaper87> SiegeLord: it's used by Port and Chan (look at std:rt:comm)
[20:23:54] *** Joins: wilsonk-laptop (kvirc@moz-8E86F35A.cg.shawcable.net)
[20:24:01] <flaper87> (there's an example of AtomicUint, IIRC) 
[20:24:27] *** Quits: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net) (Quit: dherman)
[20:25:18] <bjz_> jack: did you figure it out?
[20:25:27] <jack> bjz_: PEBKAC of course.
[20:26:05] <SiegeLord> Does 'swap' return the new value or the old value?
[20:26:20] <bjz_> jack: PEBKAC?
[20:26:55] <bjz_> ahaha
[20:26:57] <bjz_> http://en.wikipedia.org/wiki/User_error
[20:27:15] <strcat> SiegeLord: which swap?
[20:27:21] <strcat> util::swap doesn't return anything
[20:27:29] <SiegeLord> strcat, AtomicBool::spap
[20:27:33] <strcat> oh
[20:28:06] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[20:28:19] *** Quits: tgummerer (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[20:28:22] <SiegeLord> It uses atomic_xchg
[20:28:22] <strcat> SiegeLord: it will put a new value in and give the old one, afaik
[20:28:33] <SiegeLord> Sweet
[20:28:42] <SiegeLord> I guess the other behaviour would not be nearly as useful
[20:28:57] <bjz_> jack: actually, it might be better if I turn it into a record-style struct
[20:29:12] <bjz_> jack: that would prevent things like that happening
[20:29:29] *** Joins: canhtak (jeremy@moz-3FFB5CDA.wl.t.ulaval.ca)
[20:29:32] *** Parts: kherge (Mibbit@A9C30D0F.296F3964.822873CF.IP) ()
[20:30:55] *** Joins: nrc (nrc@7BE24E90.A5032A01.3CFC199D.IP)
[20:30:56] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[20:31:21] *** flaper87 is now known as flaper87|afk
[20:31:33] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[20:31:33] *** Quits: kkris (kkris@moz-CB70009.yourvserver.net) (Ping timeout)
[20:31:50] * bjz_ believes that good design can mitigate PEBKACs
[20:32:11] <cmr> bjz_: or you could do `priv int`, I think?
[20:32:16] * cmr doesn't remember if that is allowed
[20:32:36] <bjz_> huh?
[20:32:48] <cmr> rusti: struct Foo(priv int); Foo(12)
[20:32:49] -rusti- pastebinned 7 lines of output: http://sprunge.us/aIRg
[20:32:52] <cmr> nvm
[20:32:57] *** Quits: tjc (tjc@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: zzzzzzzzzz)
[20:32:57] <bjz_> :P
[20:33:06] *** Joins: nkoep (nik@moz-FA1A612A.pool.mediaways.net)
[20:33:06] * cmr thought that was allowed
[20:34:11] *** Quits: Sindwiller (quassel@moz-743130B2.dynamic.hispeed.ch) (Client exited)
[20:34:48] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[20:34:57] <steveklabnik> strcat: last question, this time about borrowed pointers: do you think that 'writing functions that take pointers when you don't care about ownership' is a good succinct explanation?
[20:35:18] <steveklabnik> are there other good use cases?
[20:35:21] *** Joins: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net)
[20:36:32] <tedh> hi strcat
[20:36:37] <strcat> hi
[20:36:55] <tedh> i saw a perf regression on a parallel benchmark with https://github.com/mozilla/rust/pull/9474
[20:37:21] <strcat> tedh: probably just because inlining heuristics are just heuristic
[20:37:22] <tedh> having trouble paring it down, but might be related to inlining
[20:37:31] <strcat> it will inline more now
[20:37:43] <strcat> might need inline(never) somewhere it makes a bad choice
[20:37:57] <tedh> ok, cool, i'll try that
[20:38:00] <tedh> thanks
[20:38:03] <cmr> PGO would be neat
[20:38:09] <strcat> llvm lacks it
[20:38:14] <strcat> they added infrastructure for it
[20:38:20] <strcat> just no one has written pgo aware passes
[20:38:27] <cmr> ah, shame.
[20:38:37] *** Quits: nkoep (nik@moz-FA1A612A.pool.mediaways.net) (Ping timeout)
[20:39:10] <bjz_> jack: https://github.com/bjz/glfw-rs/commit/4ff68c6fb1610d26ef4a8194f0086358b6cb49b1
[20:39:22] <bjz_> jack: thanks!
[20:40:26] <jack> heh
[20:40:34] <jack> Saving me from my future self!
[20:40:45] <bjz_> from mine too, of course
[20:40:46] *** Joins: maik (maik@moz-DD39128A.dip0.t-ipconnect.de)
[20:40:58] *** Joins: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net)
[20:41:42] <bjz_> one should not blame the user for predictable 'brain failures', one must design a system to take those into account
[20:41:52] <steveklabnik> r+
[20:42:25] <strcat> rusti: fail!("user error: replace user")
[20:42:29] -rusti- pastebinned 13 lines of output: http://sprunge.us/KPEc
[20:44:07] *** flaper87|afk is now known as flaper87
[20:44:14] <flaper87> SiegeLord: it gives back the old value
[20:44:33] *** Joins: tjc (tjc@moz-BE33DA21.fw1.sfo1.mozilla.net)
[20:44:33] *** ChanServ sets mode: +o tjc
[20:44:59] *** Quits: tjc (tjc@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: zzzzzzzzzz)
[20:46:16] *** Quits: canhtak (jeremy@moz-3FFB5CDA.wl.t.ulaval.ca) (Ping timeout)
[20:48:11] *** Quits: lenstr (lenstr@CD7D5ABA.83A99F98.85938D85.IP) (Client exited)
[20:49:10] *** Quits: bytbox (s@moz-DC83764A.washdc.fios.verizon.net) (Ping timeout)
[20:49:19] <strcat> tedh: oh and you can pass -inline-threshold to llvm
[20:49:38] *** Joins: bytbox (s@moz-DC83764A.washdc.fios.verizon.net)
[20:49:43] <strcat> tedh: rustc foo.rs -O --llvm-args -inline-threshold=150
[20:49:49] <strcat> for example, for really conservative inlining
[20:49:58] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[20:50:20] <strcat> (default is 275 or something, don't quite remember)
[20:50:33] <strcat> maybe 225 with --opt-level=2 and 275 with --opt-level=3
[20:50:35] * strcat shrugs
[20:50:53] *** Joins: canhtak (jeremy@moz-3FFB5CDA.wl.t.ulaval.ca)
[20:52:12] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Connection reset by peer)
[20:52:28] *** Joins: dherman (dherman@moz-6CA476B1.hsd1.ca.comcast.net)
[20:52:29] *** ChanServ sets mode: +ao dherman dherman
[20:52:37] <strcat> I think it will usually always inline ones with a single caller if they're internal
[20:52:44] <strcat> so that's the big change
[20:52:56] *** Joins: nkoep (nik@moz-244AABA1.vpn.rwth-aachen.de)
[20:53:07] <strcat> (churn in all the perf numbers, with *most* being better)
[20:55:05] *** Quits: sw17ch (sw17ch@moz-62998E95.hfc.comcastbusiness.net) (Quit: sw17ch)
[20:56:01] *** Quits: azita (Azita@moz-BBE3ABD.mv.mozilla.com) (Quit: azita)
[20:58:37] <Eridius> well huh. I can pass Some as a func to a .map. That's cute
[20:58:47] <cmr> hah, really?
[20:58:58] <cmr> I knew constructors were functions, but I didn't know it went that deep
[20:58:58] <strcat> yeah
[20:59:06] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[20:59:14] <strcat> tuple struct constructors (including enum variants) are functions
[20:59:16] <strcat> for real
[20:59:19] <strcat> rusti: Some
[20:59:20] -rusti- pastebinned 10 lines of output: http://sprunge.us/giQB
[20:59:25] *** Quits: msingle (Thunderbir@moz-930E5D97.hr.hr.cox.net) (Ping timeout)
[20:59:30] <Eridius> let xs = [1,2,3]; println!("{:?}", xs.iter().map(Some).to_owned_vec())
[20:59:31] <strcat> rusti: Some::<int>
[20:59:32] -rusti- fn(int) -> std::option::Option<int>
[20:59:34] <strcat> ;]
[20:59:38] <Eridius> rusti: let xs = [1,2,3]; println!("{:?}", xs.iter().map(Some).to_owned_vec())
[20:59:39] -rusti- ~[Some(&1), Some(&2), Some(&3)]
[20:59:39] -rusti- ()
[20:59:43] <strcat> rusti: struct Foo(int, int); Foo
[20:59:43] -rusti- fn(int, int) -> main::Foo
[20:59:51] <strcat> rusti: Some::<~[u8]>
[20:59:52] -rusti- fn(~[u8]) -> std::option::Option<~[u8]>
[20:59:56] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Connection reset by peer)
[21:00:08] <strcat> that should really say extern fn
[21:00:09] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[21:00:10] <strcat> should fix that
[21:00:11] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[21:00:52] *** Quits: Jesse_ (jruderman@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[21:01:17] *** Quits: tikue_ (tkuehn@58063012.87C752B1.689607DE.IP) (Quit: tikue_)
[21:01:38] *** Joins: tikue_ (tkuehn@58063012.87C752B1.689607DE.IP)
[21:02:01] *** Quits: tikue_ (tkuehn@58063012.87C752B1.689607DE.IP) (Quit: tikue_)
[21:02:10] *** Joins: Jesse (jruderman@moz-BBE3ABD.mv.mozilla.com)
[21:02:32] *** Joins: tgummerer (tgummerer@moz-5DC8FA44.tbcn.telia.com)
[21:03:02] *** Quits: valenting (Thunderbir@55FBCC0.8C025854.E16F0CF5.IP) (Ping timeout)
[21:03:53] <polyfractal> sooo, I'm getting this error: "cannot move out of dereference of & pointer", and Im not sure I know what it means.  Generated from this code (I'm trying to obtain one of my RWarc to write to): http://pastebin.com/mQPTDSwS
[21:04:19] <Eridius> polyfractal: you're trying to move the RWarc<~[u32]> that's stored in self.locks at the position self.currentCounter
[21:04:22] <kmc> polyfractal: do you understand what's meant by "move" generally?
[21:04:56] <Eridius> polyfractal: I'm not particularly familiar with arc, but I believe you want to .clone() it
[21:04:59] <kmc> you can't move out of a dereferenced borrowed pointer because you're just borrowing the object; the owner you've borrowed it from might want to use that field later
[21:05:04] <Eridius> as in `let lock = self.locks[self.currentCounter].clone();`
[21:05:13] *** Joins: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net)
[21:05:16] <kmc> and yeah the point of [Rw]Arc is that you can .clone() them cheaply (because it just bumps a refcount)
[21:05:48] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[21:05:55] <polyfractal> Eridius: cool, I'll try that
[21:06:12] <polyfractal> kmc: No, actually im not sure I know what it means by "move".  reassign ownership?
[21:06:15] <Eridius> polyfractal: note that cloning it here is pretty much specific to Arc/RWarc
[21:06:17] <kmc> basically yeah
[21:06:28] <Eridius> normally you'd just borrow the field, with `&self.locks[...]`, but since you're sending it to another task that won't work
[21:06:36] <polyfractal> ahh, gotcha
[21:06:43] <polyfractal> yeah i tried using & and it yelled at me :)
[21:06:48] <kmc> a move might be implemented by copying memory, but the source is considered unusable afterwards (and the compiler will enforce this)
[21:07:54] <kmc> this is mostly clearly useful in the case of ~-pointers
[21:08:02] <strcat> polyfractal: assignment/passing/returning are by-shallow-copy, for all types, but if the type has a destructor/&fn/&mut it moves ownership (can't use source anymore)
[21:08:10] <strcat> for safety
[21:08:24] <kmc> it's very cheap to move a ~-pointer because it's just a pointer; but you're not allowed to copy them because then the heap-allocated box wouldn't have a unique owner
[21:08:31] <kmc> (which would break the deterministic deallocation of such boxes)
[21:09:29] <polyfractal> ok…i parsed about 60% of that.  Taking notes though, so I'll do some more reading/fiddling :)
[21:09:34] <kmc> okay :)
[21:09:36] <polyfractal> thanks guys!
[21:09:38] <kmc> feel free to ask more questions
[21:10:04] <Eridius> polyfractal: have you used C++11?
[21:10:05] *** Quits: foodoo (foodoo@moz-9624083A.pool.mediaways.net) (Connection reset by peer)
[21:10:22] <kmc> you can talk about ownership in plain C too, it's just part of API documentation rather than part of the language
[21:10:30] *** Quits: io2 (io2@moz-A6202C16.home.otenet.gr) (Ping timeout)
[21:10:39] <kmc> a function like strdup() allocates and passes ownership to the caller
[21:10:41] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Connection reset by peer)
[21:10:44] <strcat> yup, gtk/glib has to document all pointer returns/parameters as transfer-none/transfer-full/whatever
[21:10:46] <polyfractal> Eridius: nope!  Last time I touched C++ was like 10 years ago in high school :)
[21:10:56] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[21:10:58] <kmc> it would be unsafe for strdup() to hold onto the pointer it's returned, because the caller is free to free() it at any time
[21:11:05] <Eridius> polyfractal: ok, forget I asked
[21:11:09] <polyfractal> :P
[21:11:32] *** Quits: timot (timot@moz-5DFC99F3.bredband.tre.se) (Ping timeout)
[21:11:44] <kmc> in Rust it would be fn dup(x: &str) -> ~str
[21:11:55] *** Quits: tgummerer (tgummerer@moz-5DC8FA44.tbcn.telia.com) (Ping timeout)
[21:11:58] *** Joins: timot (timot@moz-730F561B.bredband.tre.se)
[21:12:07] <strcat> which is what Clone does
[21:13:18] <polyfractal> i see
[21:14:30] <polyfractal> I've been firmly planted in PHP/JS/Python for several years now, with small smatterings of Java (and biologist before that!).  Rust is quite the conceptual change for me :)
[21:14:51] *** Joins: jstevans1 (Instantbir@moz-735D8260.washdc.fios.verizon.net)
[21:15:09] <steveklabnik> polyfractal: high five! I'm primarily coming from Ruby
[21:15:15] <steveklabnik> fun, isn't it?
[21:15:39] <polyfractal> it is!  It's nice to actually worry about where bytes are allocated, instead of _-~magic~-_
[21:16:08] <cmr> polyfractal: and *without* segfaults and other nasties!
[21:16:13] <polyfractal> :D
[21:16:20] <steveklabnik> cmr: usualy ;)
[21:16:21] <strcat> you can have ownership bugs in python/java too
[21:16:23] *** Quits: jstevans (Instantbir@moz-735D8260.washdc.fios.verizon.net) (Ping timeout)
[21:17:00] <strcat> you can leak non-memory resources (especially when exceptions are thrown), use-after-close, and have all kinds of mutability bugs or not keeping track of how deep you're passing things
[21:17:14] <strcat> still have to think about the same stuff if you're writing correct code
[21:18:16] <strcat> >>> xs = {1, 2, 3}
[21:18:18] <strcat> >>> ys = xs
[21:18:20] <strcat> >>> for x in xs: ys.add(x + 1)
[21:18:22] <strcat> ... 
[21:18:24] <strcat> Traceback (most recent call last):
[21:18:26] <strcat>   File "<stdin>", line 1, in <module>
[21:18:28] <strcat> RuntimeError: Set changed size during iteration
[21:18:43] *** Quits: Skif (emschwar@moz-D781D8AA.hsd1.co.comcast.net) (Client exited)
[21:18:46] <strcat> (silly example)
[21:19:23] *** jorendorff is now known as jorendorff_away
[21:19:46] <strcat> if you don't use @mut, mutability/ownership bugs like that are static errors
[21:20:02] *** Joins: tikue_ (tkuehn@885B1A5.2ACBBF24.689607DE.IP)
[21:20:17] <polyfractal> yeah, I do like how the compiler forces those errors into the open (yeah, I realize that is a design feature of Rust) :)
[21:20:26] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[21:23:59] <steveklabnik> strcat: what's a good example of ~T?
[21:24:20] <cmr> steveklabnik: ~int
[21:24:26] <strcat> ~int is useless though
[21:24:32] <cmr> yeah
[21:24:36] <steveklabnik> right, i mean useful.
[21:24:41] <strcat> steveklabnik: a recursive data structure, like a linked list 
[21:24:44] <strcat> or a binary search tree
[21:24:58] <steveklabnik> i was trying to present those two cases separately...
[21:25:02] <cmr> enum List<T> { Nil, Cons(T, ~List<T>) }
[21:25:03] <steveklabnik> ~Trait must be a pointer, becuase you don't know the size of the
[21:25:03] <steveklabnik> object, so indirection is mandatory.
[21:25:07] <steveklabnik> was what you said before
[21:25:14] <strcat> steveklabnik: yeah, that's the other case
[21:25:19] *** Quits: timot (timot@moz-730F561B.bredband.tre.se) (Ping timeout)
[21:25:19] *** Quits: huseby (huseby@moz-4E8C421A.husebyhome.com) (Quit: Leaving)
[21:25:40] <strcat> well you should say "you can't have an unboxed trait object, because ..."
[21:25:42] <steveklabnik> is there a succinct motivating example?
[21:26:35] *** Joins: io2 (io2@moz-A6202C16.home.otenet.gr)
[21:26:43] *** Joins: huseby (huseby@moz-4E8C421A.husebyhome.com)
[21:27:23] <strcat> something like HashMap<int, ~Foo> where Foo is a trait letting you do something
[21:27:28] <engla> a vector ~[~Trait] is of course homogenous (every element is the same type) but conceptually heterogenous, as each may wrap a different concrete type
[21:27:37] *** Quits: acabrera (alcabrera@1994AFB3.88896D71.F18532AE.IP) (Quit: leaving)
[21:27:37] <Jesse> i think the fact that you can send and freeze them is more interesting
[21:27:43] <engla> but every element ~Trait must be the same size in a vector
[21:27:49] <strcat> Jesse: that's not something ~ gives you
[21:28:16] <strcat> the only thing ~ gives you is pointer-size, it is strictly less useful than the inner type beyond that
[21:28:23] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[21:28:30] <strcat> because it adds a destructor
[21:28:41] <strcat> so that adds restrictions (move semantics)
[21:28:48] *** Joins: sw17ch (sw17ch@B33CF817.B14B64CB.284344F5.IP)
[21:29:07] <doomlord_> can you make a '&Trait' .. borrow a pointer to an existing struct, and combine it with a vtable ptr for a particular trait 
[21:29:15] <Jesse> strcat: eh?
[21:29:33] *** Quits: BitPuffin (isak@moz-49828767.cust.tele2.se) (Ping timeout)
[21:29:33] *** Quits: maik (maik@moz-DD39128A.dip0.t-ipconnect.de) (Ping timeout)
[21:29:39] <strcat> you are better off having T than ~T, you can do more than it - you need ~T when you have to force stuff to be pointer-size
[21:29:40] <Jesse> strcat: i can send or return a ~Point. i can't do that with a Point, because it's in my stack frame.
[21:29:46] <strcat> Jesse: that's not true
[21:29:53] <strcat> you can return Point
[21:30:01] <strcat> it is more efficient than allocating ~Point and returning it
[21:30:10] <strcat> large values are returned via an output pointer
[21:30:17] <strcat> it's *always* better to not box things prematurely
[21:30:30] <engla> strcat: It unifies types, say a collection of closures that capture int, ~str or float into just a trait Closure. So you can erase type parameter differences. That must be one of the very useful unique things with it
[21:30:53] <strcat> engla: that's part of being pointer-size
[21:30:54] *** Joins: fabiand (fabiand@moz-3EE5E08C.adsl.alicedsl.de)
[21:31:01] <engla> well
[21:31:10] <engla> ~Struct<X, Y, Z> is also pointer size
[21:31:16] <strcat> yes
[21:31:22] <strcat> all ~T are the same size, so you can do dynamic dispatch on them and you can use them to make recursive data structures
[21:31:24] *** Joins: lucian (lucian@moz-22A14C6A.cable.virginmedia.com)
[21:31:26] <strcat> 2 useful semantic cases, nothing else
[21:31:56] <engla> allright I find my example is something that comes up in practice
[21:32:31] <engla> in particular to use objects like closures
[21:32:35] *** Quits: rlbaker (rlbaker@moz-D05907D4.hfc.comcastbusiness.net) (Ping timeout)
[21:32:37] <strcat> why does it help?
[21:33:13] <strcat> Jesse: if T is not sendable, ~T is not sendable
[21:33:17] <engla> I guess you won't like this example in particular strcat 
[21:33:20] <engla> https://github.com/blake2-ppc/qc.rs/blob/master/lazy.rs
[21:33:20] <strcat> Send on ~T requires that T be Send in the first place
[21:33:28] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[21:33:37] <engla> You can't keep the list of thunks otherwise, because the thunks all close over different types
[21:33:46] <engla> so the thunk structs have different sizes
[21:33:49] *** Joins: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu)
[21:34:09] <strcat> yeah, so it all comes back to the pointer-size invariant ;p
[21:34:14] *** Quits: fabiand (fabiand@moz-3EE5E08C.adsl.alicedsl.de) (Quit: Verlassend)
[21:34:14] *** Joins: BitPuffin (isak@moz-49828767.cust.tele2.se)
[21:34:16] <strcat> need that for type erasure
[21:34:30] <engla> well trait objects are two pointers
[21:34:46] <engla> pointer size is part of it, but only trait objects lets you do this
[21:34:47] <strcat> engla: the ptr to the object is pointer-size, that's the ~
[21:35:00] <strcat> with ~Trait, ~ only applies to the object ptr
[21:35:02] *** Quits: nkoep (nik@moz-244AABA1.vpn.rwth-aachen.de) (Quit: Leaving)
[21:35:08] <strcat> the other ptr is always essentially &'static
[21:35:18] <engla> ok where does the ~ apply for ~[]?
[21:35:25] <engla> does this analogy really work?
[21:35:26] <strcat> it doesn't, ~[] isn't a unique ptr
[21:35:33] <strcat> it's bad syntax
[21:35:35] <strcat> confuses people
[21:35:46] <engla> it is some kind of unique pointer
[21:35:48] <strcat> no
[21:35:58] <strcat> it's not necessarily even a pointer
[21:36:08] <engla> I know it's a pointer
[21:36:18] <strcat> { len, cap, data * } wouldn't be
[21:36:31] <engla> well I would know if you changed it, too
[21:36:36] <engla> please go ahead and do it :)
[21:36:54] <Jesse> i think of it as a fat pointer
[21:37:01] <strcat> it's a container
[21:37:06] <strcat> is std::hashmap a pointer?
[21:37:10] *** Joins: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net)
[21:37:16] <strcat> extra::treemap?
[21:37:20] <engla> right
[21:37:51] * strcat shrugs
[21:38:16] <strcat> lots of people are very confused by what ~ is and what it provides from our docs
[21:38:19] <strcat> so they overuse it
[21:38:23] <steveklabnik> yup
[21:38:45] <steveklabnik> working on it
[21:38:45] <engla> returning a pointer to a new object is common other places
[21:38:49] <steveklabnik> i think you'll like what i've got
[21:38:57] <engla> I guess that's why many write  fn new() -> ~MyStruct
[21:39:02] *** Joins: heftig_ (heftig@moz-A1350D02.dip0.t-ipconnect.de)
[21:39:10] *** Joins: CarpNet (Alasdair@moz-EF831A5E.cable.virginmedia.com)
[21:39:11] <strcat> steveklabnik: we also really need to make it clear that you shouldn't return ~Box/@Box unless you have one to start with
[21:39:21] <steveklabnik> strcat: cool.
[21:39:23] <strcat> should return a value, and the caller can do what they want
[21:39:30] <steveklabnik> totally, this makes sense
[21:39:36] *** Quits: heftig (heftig@moz-4B3AF61E.dip0.t-ipconnect.de) (Ping timeout)
[21:39:37] <strcat> performance-wise...
[21:39:39] <engla> it's a great feature of the language
[21:39:41] <strcat> http://ix.io/8ge
[21:39:49] <strcat> this writes the return value directly into the allocated box
[21:39:51] <strcat> there is no copy
[21:40:25] <strcat> the caller allocates a box, passes it into foo as the out pointer, and then foo writes four 5 to it
[21:40:47] <strcat> need to make it really clear that ~ isn't for optimizing returns ;p
[21:40:57] <strcat> let the caller choose what to do
[21:42:26] <strcat> http://ix.io/8gf if we tweaked a few things it would just eliminate the allocation completely... since it's a dead store
[21:42:51] *** Quits: sankha93 (Instantbir@7061CD01.D6BD0D91.22D41759.IP) (Quit: Gone to save the world!)
[21:44:20] *** Quits: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net) (Input/output error)
[21:44:26] *** Quits: aeqwa (aeqwa@moz-EC37FE73.dsl.tropolys.de) (Quit: Lost terminal)
[21:46:14] *** Quits: jensnockert (jensnocker@moz-2DBD7676.mobileonline.telia.com) (Connection reset by peer)
[21:48:22] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Input/output error)
[21:48:41] *** Quits: CarpNet (Alasdair@moz-EF831A5E.cable.virginmedia.com) (Quit: Leaving)
[21:48:51] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[21:49:01] *** Joins: jensnockert (jensnocker@moz-2DBD7676.mobileonline.telia.com)
[21:50:10] <strcat> 17:46:44 davidstrauss | thestinger: Our goal is 10k containers/services on a box. With our current model, that would be 40k+ units. The test set is 4k mount+automount pairs, yielding 8k units.
[21:50:10] *** Joins: andrew-d_w (andrew-d_w@moz-9A2674DF.dsl.static.sonic.net)
[21:50:32] *** Quits: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net) (Ping timeout)
[21:50:37] * strcat wants 10k concurrent rusti requests ;p
[21:51:14] *** Quits: squiddy (squiddy@moz-3674C0.adsl.alicedsl.de) (Ping timeout)
[21:53:07] *** Joins: squiddy (squiddy@moz-3674C0.adsl.alicedsl.de)
[21:53:14] *** Joins: jonathanmarvens (jonathanma@moz-5A7C3C77.hsd1.ma.comcast.net)
[21:55:34] *** Quits: tikue_ (tkuehn@885B1A5.2ACBBF24.689607DE.IP) (Quit: tikue_)
[21:56:11] <polyfractal> Trip report:  refactored my code to use concurrent tasks, writing to a configurable number of shared, mutable counters using RWarc…awesome!  Pegs CPU at 100% across all cores…awesome!  Performance?  Two orders of magnitude slower than single-threaded :P
[21:56:21] <polyfractal> heh
[21:56:23] *** Quits: steveklabnik (steveklabn@moz-5EF6C37C.socal.res.rr.com) (Ping timeout)
[21:56:52] <polyfractal> oh i bet i know why...
[21:57:00] <strcat> use message passing instead? ;p
[21:57:16] <strcat> you need work units big enough to allow parallelism and not just lock contention
[21:58:10] *** flaper87 is now known as flaper87|afk
[21:59:08] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Client exited)
[21:59:08] *** Joins: raze (raze@moz-4E6675AF.bredband.comhem.se)
[21:59:09] *** jorendorff_away is now known as jorendorff
[21:59:17] <sw17ch> Maybe it's a silly question: does the Rust culture generally like moving things out of the runtime or including more things or keeping it right where it is?
[21:59:50] *** Joins: rarosu (rarosu@F6D059FD.9F6C8C5.92AEF337.IP)
[21:59:54] <raze> what is the syntax for mutable borrowed parameters? I've scanned through the tutorial but I can't seem to find any example?
[21:59:58] <strcat> &mut
[22:00:17] <raze> ah thanks
[22:00:24] <strcat> raze: parameters are just values though, same syntax as elsewhere
[22:00:33] <strcat> borrowed pointers are values themselves
[22:01:08] <strcat> (unlike C++ references)
[22:01:09] *** Joins: voxpopuli (fanservice@moz-FE161659.wv.cc.cmu.edu)
[22:01:42] <cmr> sw17ch: what do you mean?
[22:02:09] <sw17ch> cmr: If it's possible, would the rust community support moving things out of the runtime and standard library and into something else?
[22:02:19] <sw17ch> cmr: as an example, the runtime currently appears to support network communication
[22:02:27] <sw17ch> cmr: which feels library-y to me
[22:02:39] <strcat> the runtime is implemented in the standard library
[22:03:05] <strcat> #[no_std] is how you avoid using it
[22:03:37] <sw17ch> strcat: i'm still getting used to the idea of *another* language (beyond C) that has the runtime as an optional component
[22:03:47] <kmc> sw17ch: also the core IO stuff needs to integrate with the scheduler
[22:03:49] <sw17ch> strcat: but there are things that are lost when the runtime isn't used
[22:03:55] <kmc> (in this case via libuv)
[22:04:00] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Ping timeout)
[22:04:05] <strcat> sw17ch: nothing you can't implement yourself
[22:04:11] <strcat> the other "magical" parts are lang items
[22:04:17] <strcat> networking doesn't have any lang items
[22:04:20] <strcat> it's entirely library code
[22:04:21] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[22:04:33] <kmc> sw17ch: have you seen zero.rs? it's used for the proof of concept kernel in Rust and also the proof of concept Linux kernel module in Rust
[22:04:38] <kmc> and maybe some embedded stuff
[22:04:45] <strcat> zero.rs is obsolete now
[22:04:46] <sw17ch> kmc: yes, i'm actually thinking about zero.rs right now.
[22:04:46] <cmr> zero.rs is old and unnecessary
[22:04:48] <kmc> oh really?
[22:04:50] <kmc> neat
[22:04:51] <cmr> yup
[22:04:56] <strcat> kmc: minimal runtimeless program
[22:04:59] <kmc> so now you just put #[no_std] in your crate?
[22:05:01] <cmr> rustc errors if you use langauge items you haven't defined
[22:05:02] <cmr> yup
[22:05:02] <sw17ch> (I'd really like the option of being able to plug in alternate runtimes.
[22:05:03] <sw17ch> )
[22:05:17] <kmc> sw17ch: yeah, there's a lot of interest in different "profiles" for using Rust in various restricted environments
[22:05:19] <strcat> #[no_std]; #[start] fn main(_: int, _: **u8) -> int { }
[22:05:24] <kmc> I don't think there's much word towards standardizing it yet
[22:05:30] <strcat> kmc: it will ask for lang items as you use them
[22:05:32] <kmc> strcat: cool, and then you just implement lang items if you need them?
[22:05:32] <kmc> awesome
[22:05:34] <kmc> <3
[22:05:36] <sw17ch> I'd really like the option of being able to have the standard library depend on the runtime (or parts of it depend on the runtime), but still be able to write my own.
[22:05:46] <strcat> kmc: http://ix.io/8fH like that
[22:05:51] <strcat> it's pretty great ;p
[22:06:09] <cmr> sw17ch: The idea of runtime profiles is you can implement the core pieces of the runtime yourself.
[22:06:25] <kmc> so networking code doesn't have lang items, but it depends on the scheduler via needing to call std::rt::start or whatever?
[22:06:43] <kmc> I presume that libuv-aware network calls won't work if you call directly from your #[start]
[22:06:44] <strcat> kmc: yeah, it depends on the scheduler rust spins up via the start lang item
[22:07:03] <kmc> how hard is it to build a Rust program and not link libc, either?
[22:07:09] <strcat> kmc: easy
[22:07:12] <kmc> awesome
[22:07:21] <kmc> I have an old toy in C that I should port, then
[22:07:23] <strcat> kmc: you can also compile to IR and do link-time optimization with other C files
[22:07:39] <strcat> so you don't even have to pay for library/object boundaries if you use some C
[22:07:43] <strcat> as long as you compile with clang
[22:07:51] <strcat> clang happily compiles rust's IR.
[22:08:09] <strcat> just need to not use #[fixed_stack_segment]
[22:08:22] <sw17ch> cmr: that's pretty much what i want. i'm envisioning a system where i've written things like context switching and memory management myself. (bare metal systems for embedded platforms)
[22:09:00] <kmc> man I don't know *any* other language that lets you define your own RTS in such a simple piecemeal way
[22:09:04] <kmc> that's very very cool.
[22:09:14] <cmr> sw17ch: see https://github.com/mozilla/rust/pull/8454 and its discussion
[22:09:25] *** Joins: sinma (sinma@moz-6A11C47C.fbx.proxad.net)
[22:09:40] <strcat> kmc: if you ignore the stdlib/runtime, rust is also basically as efficient as C/C++ already too...
[22:09:42] <sw17ch> If I *could* get to the point where I could port the whole RT to the embedded platform, I'd be able to use Rust in place of nearly every reason I end up using FreeRTOS or similar operating systems.
[22:09:44] *** Quits: seryogah (holoirc@moz-7E93FB81.dip0.t-ipconnect.de) (Quit: seryogah)
[22:09:46] <kmc> strcat: sure
[22:09:53] <strcat> kmc: it's just not quite as clever at passing/returning as clang
[22:09:59] <strcat> I want to fix that soon
[22:10:03] <sw17ch> The important bit, though, is being able to port the runtime and specify which to use at compile time.
[22:10:05] <kmc> dang now I have *two* strange projects for this weekend and no time for either
[22:10:15] <sinma> Hi, can I use easily gettext in Rust?
[22:11:02] <sinma> If I understand right, I need a binding but there’s no binding for gettext :(
[22:11:43] <kmc> sinma: check out http://static.rust-lang.org/doc/master/tutorial-ffi.html, bindings can be pretty easy to write (depending on the library)
[22:12:02] *** Quits: ksev (DrunkenPan@745B767B.989A61DC.CA5B6332.IP) (Ping timeout)
[22:12:11] <strcat> kmc: could use rust's inline asm support to do syscalls yourself too ;p
[22:12:53] <strcat> makes a really nice low-level language if you use it that way
[22:12:57] *** Joins: ecr (Thunderbir@moz-10C88DA7.dyn.cs.washington.edu)
[22:13:02] *** Quits: ecr (Thunderbir@moz-10C88DA7.dyn.cs.washington.edu) (Quit: ecr)
[22:13:11] <strcat> (our inline asm is a bit quirky though)
[22:13:21] <sinma> kmc: I think gettext should not be a problem but it’s still annoying. At least, it seems the API is stable.
[22:13:26] *** Quits: saml (sam@moz-14C16814.cst.lightpath.net) (Quit: Leaving)
[22:13:26] *** Joins: ecr (ereed@moz-10C88DA7.dyn.cs.washington.edu)
[22:14:38] *** Parts: ecr (ereed@moz-10C88DA7.dyn.cs.washington.edu) ()
[22:14:42] <kmc> strcat: is it documented?
[22:15:05] *** Quits: Kruppe (user@moz-A46941C6.net.uwaterloo.ca) (Ping timeout)
[22:15:05] *** flaper87|afk is now known as flaper87
[22:15:11] *** Quits: squiddy (squiddy@moz-3674C0.adsl.alicedsl.de) (Quit: Leaving)
[22:15:28] <strcat> kmc: don't think so
[22:15:32] <cmr> aatch and dbaupp both have examples of doing manual syscalls.
[22:15:40] <cmr> grease-bench and rust-malloc
[22:15:41] <strcat> I think Luqman made it? bug him about it :)
[22:15:50] <strcat> cmr: although, not the efficient way
[22:15:54] <sinma> kmc: in the tutorial, there is `#[link_args = "-lsnappy"]`. Do I need something similar for gettext?
[22:16:00] <kmc> probably
[22:16:05] <strcat> doing it the efficient way is hard
[22:16:24] <kmc> strcat, Luqman: ok what's quirky about it ;)
[22:17:36] *** Joins: ecr (ecr@moz-10C88DA7.dyn.cs.washington.edu)
[22:17:39] <strcat> something weird about parameters when I tried it, don't clearly remember
[22:17:42] <kmc> ah
[22:17:48] <cmr> dbaupp: ping
[22:17:49] *** Quits: ecr (ecr@moz-10C88DA7.dyn.cs.washington.edu) (Quit: )
[22:17:56] <kmc> well I'd be fine with writing a "syscall" function in C anyway
[22:18:02] <kmc> this project will already have some not-inline assembly too
[22:18:46] <kmc> strcat: ok so how do I actually build without linking libc?
[22:19:10] <flaper87> mmh, I'm in another borrowed-cant-move trap. http://pastebin.mozilla.org/3158060 I need to call block_on (L12)  but self_ is being borrowed in line 7. Any good way to do that without passing self to the closure ?
[22:19:14] <strcat> kmc: emit IR with rust (-S --emit-llvm) and compile without rustc
[22:19:16] <strcat> via clang
[22:19:30] <strcat> rustc likes passing 200 linker params so you can't even not link to librustrt with it
[22:20:08] <strcat> kmc: -ffreestanding -fno-builtin to clang, iirc
[22:20:17] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[22:20:24] <Luqman> kmc: er, i don't think it handled some constraints properly (or even at all)
[22:20:33] <kmc> strcat: cool
[22:20:41] <strcat> kmc: you have to provide memcpy/memmove/memcpy yourself though
[22:20:44] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[22:20:44] <strcat> because LLVM calls them
[22:20:48] <strcat> and maybe other things
[22:21:16] *** Joins: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP)
[22:21:21] <strcat> kmc: ah yeah, -fno-builtin makes it not call anything but those, and makes it not assume things based on symbol names
[22:21:35] <strcat> rust mangles symbols anyway
[22:21:39] <sinma> kmc: hey, the tutorial about FFI is pretty short! But I didn’t know gettext at all.
[22:21:40] <strcat> so you don't really need it
[22:22:24] <jason_> is there any documentation on #[cfg()]?
[22:22:31] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Ping timeout)
[22:23:14] *** Joins: kkris (kkris@moz-CB70009.yourvserver.net)
[22:23:14] <jason_> i've seen target_os and test inside cfg(), but i'm wondering where to find other build config options and info on what the possible values for target_os are
[22:24:32] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[22:25:02] *** Quits: rarosu (rarosu@F6D059FD.9F6C8C5.92AEF337.IP) (Quit: leaving)
[22:25:06] <brson> jason_: no docs, just code https://github.com/mozilla/rust/blob/master/src/librustc/driver/driver.rs#L68
[22:25:22] <jason_> good enough, ty
[22:26:15] *** Joins: ecr (Thunderbir@moz-10C88DA7.dyn.cs.washington.edu)
[22:26:59] <flaper87> any idea?
[22:27:48] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[22:28:59] <polyfractal> Ok, does this sound reasonable:  say there are 1000 counters, each sitting in their own task.  There is a central "registry" of SharedChan's, and as new tasks are spawned to handle incoming requests, they clone the appropriate SharedChan to talk to the appropriate counter.  
[22:29:11] * polyfractal has realized he is terrible at concurrent code :(
[22:29:11] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[22:29:29] *** Quits: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP) (Quit: buildmaster reconfigured: bot disconnecting)
[22:29:34] *** Joins: spott_ (spott@moz-5158CBDE.colorado.edu)
[22:29:45] *** Quits: spott (spott@moz-5158CBDE.colorado.edu) (Connection reset by peer)
[22:30:20] *** Quits: TheDust (Stijn@moz-8C2076C2.upc-d.chello.nl) (Quit: Leaving)
[22:32:00] *** Joins: bogen (dwight@moz-8B4E7E75.dsl.rcsntx.swbell.net)
[22:33:55] *** flaper87 is now known as flaper87|afk
[22:34:21] <Eridius> rusti: (fmt!("%x", 62u), format!("{:x}", 62u))
[22:34:22] -rusti- (~"3e", ~"3e")
[22:35:29] *** Quits: bent (chatzilla@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: ChatZilla 0.9.90.1-rdmsoft [XULRunner 22.0/20130619132145])
[22:36:07] *** Joins: rust-buildbot (rust-build@505BFA3.C3CCCE8C.D25A875A.IP)
[22:36:38] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.1)
[22:37:37] *** Quits: jensnockert (jensnocker@moz-2DBD7676.mobileonline.telia.com) (Connection reset by peer)
[22:37:44] *** Joins: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net)
[22:39:00] *** Quits: sinma (sinma@moz-6A11C47C.fbx.proxad.net) (Quit: Konversation terminated!)
[22:40:56] *** flaper87|afk is now known as flaper87
[22:41:15] *** Joins: dew (Instantbir@moz-EEE6B2F8.dhcp.stls.mo.charter.com)
[22:42:15] <jmgrosen> how can I compile a 32bit rustc on a 64bit OS?
[22:42:19] *** Joins: tjc (tjc@moz-17B89992.tmodns.net)
[22:42:19] *** ChanServ sets mode: +o tjc
[22:42:35] *** Quits: sw17ch (sw17ch@B33CF817.B14B64CB.284344F5.IP) (Ping timeout)
[22:42:43] <cmr> jmgrosen: --target i686-unknown-linux-gnu or whichever triple you fancy.
[22:43:05] *** flaper87 is now known as flaper87|afk
[22:44:28] *** Joins: skippydippy (Mibbit@moz-3A458E69.pools.arcor-ip.net)
[22:44:32] <jmgrosen> cmr: yeah, I tried that, but it's complaining about not having a C compiler -- what do I want to install?
[22:44:53] <cmr> jmgrosen: not quite sure
[22:44:57] <jmgrosen> ok
[22:45:04] *** Quits: skippydippy (Mibbit@moz-3A458E69.pools.arcor-ip.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:45:13] <cmr> acrichto: strcat: do you know how? iirc you have cross compiled
[22:45:52] <acrichto> jmgrosen: oh I tihnk it's like --build-triples or something like that, let me check real quick
[22:46:09] <brson> jmgrosen: on debian-based distroes it requires various gcc-multilib packages
[22:46:12] <acrichto> jmgrosen: ./configure --disable-valgrind --enable-optimize --enable-optimize-tests --build-triple=i686-unknown-linux-gnu --host-triples=i686-unknown-linux-gnu
[22:46:13] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:46:18] <acrichto> that's the configure line the bots are using
[22:46:28] <acrichto> build/host are the important ones I believe
[22:46:30] <jmgrosen> thanks, guys
[22:46:37] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:47:29] *** Joins: tikue_ (tkuehn@885B1A5.2ACBBF24.689607DE.IP)
[22:50:31] *** Quits: spott_ (spott@moz-5158CBDE.colorado.edu) (Connection reset by peer)
[22:50:31] *** Joins: spott (spott@moz-5158CBDE.colorado.edu)
[22:52:53] *** Quits: io2 (io2@moz-A6202C16.home.otenet.gr) (Ping timeout)
[22:54:04] *** Joins: Azdle (patrick@moz-8C723B60.hsd1.mn.comcast.net)
[22:54:55] *** Quits: BitPuffin (isak@moz-49828767.cust.tele2.se) (Ping timeout)
[22:55:11] <SiegeLord> Hmm... so you know how you can't implement a trait for a type if both are not in your crate? What about a type of the form Type<T> where Type is not in your crate, but T is?
[22:55:52] *** Quits: Jesin (Jessin_@moz-48B48C95.eecs.lehigh.edu) (Quit: Leaving)
[22:58:19] *** Quits: KindOne (KindOne@moz-D75CF3E3.dynamic.ip.windstream.net) (Ping timeout)
[23:01:59] <Eridius> SiegeLord: that could still conflict with an implementation for, say, Type<T> for all T
[23:02:07] <Eridius> so I expect the answer is still no
[23:02:14] *** Joins: KindOne (KindOne@moz-D75CF3E3.dynamic.ip.windstream.net)
[23:02:21] *** Joins: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP)
[23:02:43] <SiegeLord> Hmm... so much for my typestate emulation... although I think it's too annoying anyway
[23:03:41] <engla> SiegeLord: it sounds like it could possibly be allowed, but no form of trait impl specialization like that is allowed at the moment
[23:04:06] <engla>  / not implemented
[23:04:42] *** Quits: ecr (Thunderbir@moz-10C88DA7.dyn.cs.washington.edu) (Quit: ecr)
[23:05:23] <cmr> Is it possible to make a &[u8] of a u23, ie, I want a 4-byte slice of the u32
[23:05:27] <cmr> So I can run to_hex on it
[23:06:26] *** Joins: ecr (Mibbit@F06EF90.A19A88BC.64990CF8.IP)
[23:06:30] <bytewise> cmr: you could transmute the u32 to [u8, ..4]
[23:06:36] <Eridius> rusti: 64u32.to_bytes()
[23:06:50] <Eridius> dammit where's rusti?
[23:06:56] <Eridius> I forgot the lsb val anyway
[23:07:13] <Eridius> cmr: to_bytes::ToBytes. Should be implemented for u32
[23:07:28] <Eridius> although it would give you ~[u8]
[23:07:29] *** Quits: ecr (Mibbit@F06EF90.A19A88BC.64990CF8.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:07:31] <engla> we still want to rename ToBytes
[23:07:50] <engla> it's just that anything with deriving requires several steps :/
[23:10:22] <cmr> bytewise: I think you win
[23:10:33] <cmr> for the non-copying solution
[23:10:37] <cmr> slash allocating
[23:10:49] *** Quits: Larry (larryfox@moz-343B6F0C.nyc.biz.rr.com) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:12:17] *** Quits: cstrahan (cstrahan@DB1CB554.80B5DDE4.2D737EA7.IP) (Ping timeout)
[23:15:00] <Eridius> tjc: there are two uses of the old path.get_relative_to(), one in librustpkg and the other in librustc. I'm not certain what that old function was actually supposed to do. can you explain?
[23:15:11] <Eridius> since I need to adapt the code for the new .get_relative_to() which actually makes sense
[23:15:31] <tjc> Eridius: I'll have to look -- I don't really understand the rustc code, but I should be able to explain the rustpkg code
[23:15:53] <Eridius> it's in installed_packages.rs
[23:16:10] <cmr> "Finds the relative path from one file to another"
[23:16:28] <Eridius> cmr: yeah but in testing it did something silly like, IIRC, find the relative path from the parent directory of one path to the parent directory of the other
[23:16:31] <Eridius> but I'm not 100% positive
[23:16:33] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Input/output error)
[23:16:42] <tjc> Eridius: The installed_packages code is looking at a list of absolute file paths...
[23:16:48] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[23:16:50] <tjc> and it wants to strip off everything that isn't part of the package ID
[23:17:10] <tjc> so it says `p.push("lib/")` is the common part of the path, and lib is the full path...
[23:17:22] <tjc> get_relative_to in that case strips off the common part and gives back the interesting part
[23:17:36] <tjc> shouldn't be too hard to change… it seems like get_relative_to takes its arguments backwards
[23:17:38] <Eridius> tjc: ok, but that sounds like a sane get_relative_to. Is the trailing / important? Is that why it worked ok?
[23:17:41] <Eridius> (because the old path didn't normalize)
[23:17:48] <tjc> Eridius: I suspect so, but I don't completely remember
[23:17:51] <Eridius> yeah my new get_relative_to flipped the order of the arguments
[23:18:08] <tjc> Yeah, that makes more sense to me
[23:18:23] *** jorendorff is now known as jorendorff_away
[23:19:57] *** Joins: ofeldt (ofeldt@moz-9CE75C81.dip0.t-ipconnect.de)
[23:20:11] *** Joins: maik (maik@moz-DD39128A.dip0.t-ipconnect.de)
[23:20:49] *** Joins: RMF (RMF@moz-A7EEA849.dsl.telepac.pt)
[23:21:08] *** Quits: ofeldt- (ofeldt@moz-539A02CF.dip0.t-ipconnect.de) (Ping timeout)
[23:21:13] *** Joins: steveklabnik (steveklabn@moz-A6B56C6E.lsan.ca.megapath.net)
[23:21:20] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[23:21:47] *** Quits: RMF (RMF@moz-A7EEA849.dsl.telepac.pt) (Quit: Textual IRC Client: www.textualapp.com)
[23:24:42] <jeaye> Is there any way to force the naming of a library?
[23:24:50] <jeaye> -o libfoo.so doesn't cut it.
[23:25:43] <jeaye> I was looking to use the lib name as a target in a GNU Makefile.
[23:26:08] <cmr> jeaye: heh, servo went through that hell today!
[23:26:10] <cmr> jack: tjc: ^
[23:26:20] *** Quits: maik (maik@moz-DD39128A.dip0.t-ipconnect.de) (Ping timeout)
[23:26:44] <jeaye> Right now I have to rebuild each time because of it. :P
[23:28:03] <tjc> jeaye: jack came up with a fix for that today -- I'm looking up the issue number
[23:28:23] <jeaye> Probably using a dummy file and `touch`ing it
[23:29:05] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[23:29:10] *** Quits: jmgrosen (jmgrosen@moz-A3814C08.sd.sd.cox.net) (Quit: jmgrosen)
[23:29:49] *** Quits: tjc (tjc@moz-17B89992.tmodns.net) (Ping timeout)
[23:30:21] *** Joins: cstrahan (cstrahan@moz-71FAC30.hsd1.va.comcast.net)
[23:31:08] <jeaye> Aww, he timed out. :|
[23:31:29] *** Joins: tjc (tjc@moz-17B89992.tmodns.net)
[23:31:29] *** ChanServ sets mode: +o tjc
[23:31:30] *** Quits: Scriptor (historium@moz-E06F46F0.corp.bitshelter.com) (Quit: Scriptor)
[23:32:32] <tjc> jeaye: No, it wasn't that simple
[23:32:42] <tjc> jeaye: https://github.com/mozilla/rust/issues/9572
[23:33:36] <jeaye> No commits associated with it. Do you have a link to his fix?
[23:33:39] *** Parts: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (leaving)
[23:34:27] <tiffany> hm
[23:34:28] <tjc> jeaye: http://irclog.gr/#browse/irc.mozilla.org/servo/34000
[23:34:28] <tiffany> that's weird
[23:34:41] <tiffany> this small rust project seems to have a memory leak
[23:34:45] <tiffany> it doesn't do any ffi stuff or anything
[23:34:58] <tiffany> it's a kind of bad one too
[23:35:15] <tiffany> it ends up eating several hundred megabytes over the course of the program running (a few minutes)
[23:35:23] <cmr> tiffany: can you share it?
[23:35:53] <steveklabnik> cmr: where are the format! docs again? sorry :()
[23:35:59] <cmr> steveklabnik: std::fmt
[23:36:03] <steveklabnik> ty
[23:36:09] <steveklabnik> too easy
[23:36:13] <cmr> :p
[23:36:25] <tiffany> er, I guess it does do ffi, but not in the spot it's leaking
[23:36:43] <tiffany> http://paste.lymiahugs.com/tiffany/50690b6f92c840e9df2c3ae195182d8587c6d4b8.gz this is a tar.gz of the code
[23:37:02] <tiffany> it depends on noise-rs and mozilla's png binding
[23:37:13] <tjc> brson: how do I fix this problem on the Windows try bot? http://buildbot.rust-lang.org/builders/try-win/builds/589/steps/compile/logs/stdio
[23:38:13] <cmr> tiffany: what's the crate file / how to compile?
[23:38:30] <tiffany> rustc skybox.rs
[23:38:31] *** Quits: tjc (tjc@moz-17B89992.tmodns.net) (Quit: zzzzzzzzzz)
[23:38:34] <cmr> ok
[23:39:12] *** Joins: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net)
[23:40:22] <cmr> tiffany: what's this -lshim it needs?
[23:40:31] <tiffany> that's part of rust-png
[23:40:41] <cmr> oh, so just copy shim.o over?
[23:40:49] <cmr> or, libshim.a I suppose
[23:41:04] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:41:21] <cmr> tiffany: how to invoke?
[23:42:14] <Ralith> ii/win 29
[23:42:17] <Ralith> wups
[23:44:39] <cmr> 512 up 12053 foo.png
[23:44:41] <cmr> good enough :p
[23:46:35] <cmr> tiffany: valgrind doesn't report anything as leaked
[23:46:48] <cmr> With a size of 100
[23:47:24] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[23:47:37] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[23:49:20] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:49:55] <cmr> tiffany: indeed, memory usage stays fairly constant around 90K
[23:49:56] <cmr> (RES)
[23:50:08] <cmr> 3 jumps so far
[23:50:13] <cmr> each of about 1.4K
[23:50:55] <cmr> (under valgrind)
[23:51:06] <cmr> (so those might be valgrind expanding is whateveritdoes)
[23:51:31] <steveklabnik> whew!
[23:51:34] <steveklabnik> pr time!!!!!
[23:51:58] *** Joins: MauricioC (mauricioc@moz-2CFCD404.impa.br)
[23:52:25] <dbaupp> cmr: pong (I guess it was just irfy?)
[23:54:33] *** Quits: gandalf (zbraniecki@moz-BE33DA21.fw1.sfo1.mozilla.net) (Quit: My lid went down)
[23:55:09] *** Quits: infynyxx (infynyxx@DB780A29.749BA1D.DCC373F0.IP) (Client exited)
[23:56:03] *** Quits: canhtak (jeremy@moz-3FFB5CDA.wl.t.ulaval.ca) (Ping timeout)
[23:56:10] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[23:56:55] *** Quits: vodik (simon@moz-CBE4BB13.cable.teksavvy.com) (Ping timeout)
[23:57:29] <cmr> tiffany: ok, I see the leak now
[23:57:38] <cmr> During rendering stars?
[23:57:56] *** Quits: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com) (Ping timeout)
[23:58:25] *** Joins: vodik (simon@moz-CBE4BB13.cable.teksavvy.com)
[23:58:39] *** Joins: Excureo (c@moz-EB93D257.static.knwc.wa.charter.com)
[23:58:42] <cmr> tiffany: not sure it's actually a leak, it's at fairly constant memory now
