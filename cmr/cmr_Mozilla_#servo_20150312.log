[00:00:08] <jack> Maybe njn's flow memory logging could do that?
[00:00:13] <pcwalton> not without some way to enumerate all flows a flow holds
[00:00:23] <pcwalton> if you have that you can make a graph
[00:00:29] <njn> jack: not really
[00:00:35] <jack> We already have a way to dump the flow tree
[00:00:52] <pcwalton> if you make the flow tree dumper complete enough you could make a dot graph or something
[00:00:57] <jack> Would it be sufficient to look there, or is it during construction that is the problem?
[00:01:29] <pcwalton> if indeed it is the hypothetical box and/or inline-block a sufficiently complete flow dumper should reveal the problem
[00:01:35] <kmc> njn: I was just thinking about making a debug version of Arc
[00:01:43] <kmc> that logs all of the events for each object, with backtraces
[00:02:54] <jack> pcwalton: But if the leak is in construction, it's possible to endup with no cycles in the final flow tree but have created and leaked some flows in construction, no?
[00:03:19] <kmc> this would catch any leaked cycle as long as you can enumerate the flow tree
[00:03:26] <kmc> except that it's not using standard Arc :/
[00:04:29] <jack> kmc: So I've basically got that right now, except it doesn't identify the cycle easily.
[00:04:58] * jack tries dumping the flow tree
[00:06:55] <jack> pcwalton: There can't be a cycle in BlockFlow I don't think.
[00:07:38] <jack> Unless fragment can have a link to a flow
[00:07:48] <jack> Trying to look through the struts for where that could happen
[00:08:14] *** Joins: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net)
[00:08:15] <pcwalton> fragment can have a link to a flow if it's an inline-block
[00:08:15] <jack> Oh, InlineAbsoluteHypotheticalFragmentInfo
[00:08:23] <pcwalton> or that, yes
[00:08:28] <jack> and InlineBlockFragmentInfo
[00:08:54] <pcwalton> jack: also look at AbsDescendants
[00:08:56] *** Joins: bjwbell (user@moz-5rbuu3.frokca.sbcglobal.net)
[00:09:02] <jack> So if I just print out block's fragment and add Debug to those, that should be enough to trigger infinite loop if there is a cycle.
[00:09:08] *** Quits: kendlecc (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:09:16] <pcwalton> interestingâ€¦ I would think so
[00:11:00] *** Joins: erickt (erickt@moz-lmug77.client.dsl.net)
[00:12:04] *** Quits: mccr8 (mccr8@moz-cfhap5.mtv2.mozilla.com) (Quit: )
[00:12:49] *** Quits: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net) (Connection closed)
[00:14:04] *** Quits: mystor (mystor@moz-vpa.r78.15.130.IP) (Connection closed)
[00:14:23] *** Joins: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net)
[00:14:30] *** Joins: mystor (mystor@moz-vpa.r78.15.130.IP)
[00:16:49] *** Quits: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net) (Quit: âœ§*ã€‚ãƒ¾( Â´ /// `ã€‚ )ï¾‰ï¾žâœ§*ã€‚)
[00:17:00] <jack> Not having Arc<Flow> really sucks.
[00:17:11] <jack> I suppose that needs to go on our list of Rust asks
[00:17:22] <steveklabnik> it's generally wanted
[00:17:34] * steveklabnik is assuming Flow is a trait here
[00:19:37] <jack> 2Yes
[00:20:24] <steveklabnik> :) maybe yinz could get it bumped up in priority then :)
[00:20:32] *** Joins: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net)
[00:21:02] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[00:23:42] <bjwbell> jack: Any chance you can backport https://github.com/tomaka/glutin/commit/903c9b1aad951e683de08c1d902a12c95bcd84c2 to the servo glutin backport branch too? I've a servo PR waiting for it
[00:24:04] <jack> bjwbell: we're rust upgrading right now I believe.
[00:24:24] <jack> But if that doesn't catc hit, I can backport that for you
[00:25:03] <bjwbell> jack: great, I can wait for the rustup. Hopefully it'll be done soon
[00:25:11] *** Joins: caitp (caitp@moz-lmogh4.cable.rogers.com)
[00:29:30] *** chmanchester is now known as chmanchester|brb
[00:30:11] *** nrc|afk is now known as nrc
[00:30:51] *** Joins: bellows (Mibbit@moz-juv.9o3.252.72.IP)
[00:31:23] *** Quits: chmanchester|brb (chmancheste@moz-lmo.64e.222.162.IP) (Quit: )
[00:32:04] *** Joins: playjax (chatzilla@moz-2sd7e6.optusnet.com.au)
[00:33:25] *** Quits: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net) (Quit: âœ§*ã€‚ãƒ¾( Â´ /// `ã€‚ )ï¾‰ï¾žâœ§*ã€‚)
[00:34:21] *** Quits: bellows (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[00:34:22] *** Joins: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net)
[00:35:12] *** AutomatedTester is now known as AutomatedTester|AFK
[00:36:06] *** Joins: bholley (bholley@moz-qpv0dk.ca.comcast.net)
[00:36:42] *** Quits: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net) (Quit: âœ§*ã€‚ãƒ¾( Â´ /// `ã€‚ )ï¾‰ï¾žâœ§*ã€‚)
[00:36:43] *** Joins: aweinstock (aweinstock@moz-8mcrmr.us)
[00:37:16] *** Joins: Daniellynet (Cupcake@moz-bci30q.customer.tdc.net)
[00:41:50] *** Quits: mystor (mystor@moz-vpa.r78.15.130.IP) (Connection closed)
[00:45:30] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[00:47:35] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[00:49:33] *** Quits: erickt (erickt@moz-lmug77.client.dsl.net) (Ping timeout: 121 seconds)
[00:50:46] *** Quits: bholley (bholley@moz-qpv0dk.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[00:52:52] *** Joins: erickt (erickt@moz-njt.vqi.14.76.IP)
[00:53:16] *** Quits: ienzam (enzam@moz-2jsbpn.dynamic.upc.ie) (Ping timeout: 121 seconds)
[00:53:29] *** Joins: chmanchester (chmancheste@moz-lmo.64e.222.162.IP)
[00:55:22] *** Joins: dstrbad (dstrbad@moz-3rib75.dsl.iskon.hr)
[00:59:24] *** Quits: dstrbad (dstrbad@moz-3rib75.dsl.iskon.hr) (Ping timeout: 121 seconds)
[00:59:31] <jack> here's af low tree dump of GotG with subflow printed for BlockFlows
[00:59:32] <jack> https://gist.githubusercontent.com/metajack/2f0b2b14b9192387e54a/raw/flowtree.dump
[00:59:44] <jack> It didn't go into an infinite loop there.
[01:07:29] *** Quits: ted (luser@moz-q84dqp.east.verizon.net) (Quit: Leaving)
[01:13:08] *** Quits: brendan (brendaneich@moz-0gq.0rd.102.38.IP) (Client exited)
[01:17:18] <njn> I've added an extra `Url` parameter to LayoutTaskFactory::create. So now components/layout_traits/lib.rs needs `use url::Url`. I add that and rustc tells me I also need `extern crate url`. I add that and it says "can't find crate for `url`"
[01:17:37] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[01:18:40] <gw> njn: add the url crate as a dependency to the layout_traits/Cargo.toml as well
[01:19:55] *** Quits: fabrice (fabrice@moz-jgq4p2.ujol.1ibb.0101.2620.IP) (Ping timeout: 121 seconds)
[01:20:35] <njn> gw: thank you
[01:21:36] <njn> works, yay
[01:23:20] *** Joins: ted (luser@moz-q84dqp.east.verizon.net)
[01:27:51] *** Quits: Rastus_Vernon (uid15187@moz-k0e6oo.charlton.irccloud.com) (Quit: )
[01:29:17] *** Quits: Savago (Savago@moz-8hd.3b6.246.162.IP) (Client exited)
[01:29:49] *** Quits: playjax (chatzilla@moz-2sd7e6.optusnet.com.au) (Connection closed)
[01:31:04] *** Quits: brson (brson@moz-cfhap5.mtv2.mozilla.com) (Quit: leaving)
[01:31:20] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[01:31:20] *** ChanServ sets mode: +o pcwalton
[01:31:27] *** Joins: brson (brson@moz-ib4.pdv.48.37.IP)
[01:31:27] *** ChanServ sets mode: +o brson
[01:31:34] *** Joins: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net)
[01:34:21] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[01:35:03] <jack> pcwalton: https://gist.githubusercontent.com/metajack/2f0b2b14b9192387e54a/raw/flowtree.dump
[01:35:15] <jack> that's the full flow tree. i can't see an obvious cycle.
[01:35:15] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[01:36:02] <pcwalton> hmm
[01:36:07] <pcwalton> I think we really need to reduce the page
[01:36:13] <pcwalton> it's finding a needle in a haystack
[01:42:58] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[01:48:47] *** Quits: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net) (Connection closed)
[01:48:52] *** Quits: Nekit1234007 (nekit@moz-vfr.64q.51.84.IP) (Quit: leaving)
[01:54:51] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[01:55:27] *** Joins: Rastus_Vernon (RastusVerno@moz-th44la.torservers.net)
[01:58:23] *** Joins: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net)
[02:04:06] *** Quits: dbaron (dbaron@moz-vuesma.2rkg.9kg1.0101.2620.IP) (Ping timeout: 121 seconds)
[02:09:03] *** Quits: chmanchester (chmancheste@moz-lmo.64e.222.162.IP) (Quit: )
[02:09:47] *** Joins: acgtyrant (acgtyrant@moz-3kd.b79.160.124.IP)
[02:12:30] <njn> jdm: about https://critic.hoppipolla.co.uk/showcomment?chain=10964...
[02:13:37] <njn> jdm: should I check the result of the send() at https://github.com/servo/servo/pull/5193/files#diff-ac20d4dfaff4522ec78bdd6f12f7445cR139 ?
[02:13:38] <crowbot1> Issue #5193: Add memory reporting infrastructure and use it to measure the display list. - https://github.com/servo/servo/pull/5193
[02:13:39] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[02:14:16] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[02:14:56] *** Joins: mib_dgyzon (Mibbit@moz-juv.9o3.252.72.IP)
[02:15:10] *** Joins: bholley (bholley@moz-qpv0dk.ca.comcast.net)
[02:15:58] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[02:16:50] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[02:18:14] *** Quits: mib_dgyzon (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:18:17] *** Joins: moa (Cedric@moz-quu9i9.enlightenment.org)
[02:18:19] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[02:21:00] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[02:21:01] *** Quits: {0}grant ({0}grant@moz-63ubas.in.charter.com) (Connection closed)
[02:22:11] *** Quits: brson (brson@moz-ib4.pdv.48.37.IP) (Quit: leaving)
[02:22:35] *** Quits: bholley (bholley@moz-qpv0dk.ca.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[02:22:35] *** Joins: slyu (slyu@moz-2hf62a.HINET-IP.hinet.net)
[02:23:55] *** Parts: slyu (slyu@moz-2hf62a.HINET-IP.hinet.net) ()
[02:23:58] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[02:28:30] * njn does just that
[02:28:48] *** Quits: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net) (Connection closed)
[02:29:22] *** Quits: empoZ (empoZ@moz-ccitnk.priv.bahnhof.se) (Connection closed)
[02:29:47] *** Quits: chc4 (chc4@moz-pdo0at.ma.comcast.net) (Quit: not bees???)
[02:34:55] *** Joins: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net)
[02:35:13] *** Joins: reem (reem@moz-ujiea5.coob.q2h1.0009.2601.IP)
[02:35:29] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[02:35:29] *** ChanServ sets mode: +o pcwalton
[02:42:03] *** Joins: Caspy7 (chatzilla@moz-qg6.7b1.185.99.IP)
[02:43:18] <Caspy7> so, uh, is there anyone that's usually responsible for posting "this week" on Reddit?
[02:43:51] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[02:44:00] *** Joins: Pierre (pierre@moz-lmh.0pq.89.116.IP)
[02:46:39] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[02:48:30] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[02:48:50] *** Quits: zxq9 (ceverett@moz-c1f1em.asahi-net.or.jp) (Quit: Konversation terminated!)
[02:50:55] *** Joins: sawrubh (uid6719@moz-sr8l1j.brockwell.irccloud.com)
[02:52:51] *** Joins: zxq9 (ceverett@moz-c1f1em.asahi-net.or.jp)
[02:55:03] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[02:56:30] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[02:56:55] *** Joins: pachuco (Mibbit@moz-juv.9o3.252.72.IP)
[02:57:25] *** Quits: pachuco (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:58:05] <Manishearth> njn: yep, ~/.cargo is useless if you don't use anything other than Servo
[03:02:25] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[03:02:25] *** ChanServ sets mode: +o pcwalton
[03:03:13] <Manishearth> SimonSapin: http://www.reddit.com/r/rust/comments/2yppk0/this_week_in_servo_27/cpbypkh?context=3
[03:09:36] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[03:09:56] *** Quits: garvank (Garvan@moz-1fp.d2n.140.24.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[03:11:32] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[03:17:46] *** Quits: reem (reem@moz-ujiea5.coob.q2h1.0009.2601.IP) (Connection closed)
[03:18:05] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[03:18:24] *** Quits: zslayton (Mibbit@moz-0gsjuf.res.rr.com) (Quit: http://www.mibbit.com ajax IRC Client)
[03:18:24] *** Joins: _zxq9_ (ceverett@moz-qsm369.mesh.ad.jp)
[03:20:03] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[03:20:44] *** Quits: DroidLogician (Austin@moz-9lhp5e.ca.charter.com) (Quit: Leaving)
[03:21:05] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[03:22:24] *** Quits: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net) (Connection closed)
[03:24:15] *** Joins: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net)
[03:25:13] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Ping timeout: 121 seconds)
[03:25:40] *** Joins: hoverbear (hoverbear@moz-csaicn.gv.shawcable.net)
[03:27:42] *** Quits: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net) (Connection closed)
[03:28:49] *** Quits: Rastus_Vernon (RastusVerno@moz-th44la.torservers.net) (A TLS packet with unexpected length was received.)
[03:29:12] *** Joins: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net)
[03:34:40] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[03:35:03] *** Parts: bjwbell (user@moz-5rbuu3.frokca.sbcglobal.net) ("ERC (IRC client for Emacs 25.0.50.1)")
[03:37:34] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[03:41:59] *** Quits: kimundi (kimundi@moz-sbftss.dip0.t-ipconnect.de) (Ping timeout: 121 seconds)
[03:42:49] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[03:42:49] -ghservo- [13servo] 15bors-servo 04force-pushed 06auto from 141f33b53 to 147b6e314: 02http://git.io/A9I6iA
[03:42:49] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[03:42:50] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[03:42:50] -ghservo- [13servo] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/p6zH
[03:42:50] -ghservo- 13servo/06auto 148223f69 15Ms2ger: Remove plugin attributes from extern crates.
[03:42:50] -ghservo- 13servo/06auto 1427a76f1 15bors-servo: auto merge of #5201 : Ms2ger/servo/plugins, r=jdm
[03:42:50] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[03:43:28] *** Joins: kimundi (kimundi@moz-ere.cfn.188.87.IP)
[03:45:42] *** Joins: ttaubert (uid2620@moz-6d2u0s.uxbridge.irccloud.com)
[03:47:27] *** kimundi is now known as zz_kimundi
[03:48:45] *** Joins: jdm (jdm@moz-6sq.tjp.175.184.IP)
[03:48:45] *** ChanServ sets mode: +qo jdm jdm
[03:49:52] *** Quits: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net) (Connection closed)
[03:50:36] *** Joins: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net)
[03:54:23] *** zz_kimundi is now known as kimundi
[03:57:16] *** Joins: wldcordeiro (wldcordeiro@moz-h7mvf3.hmj8.a2nn.0007.2601.IP)
[03:59:10] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[03:59:10] -ghservo- [13saltfs] 15Manishearth closed pull request #24: Move SERVO_CACHE_DIR outside of src dir (06master...06cache-dir) 02http://git.io/pKYs
[03:59:10] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[03:59:12] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[03:59:12] -ghservo- [13saltfs] 15Manishearth pushed 2 new commits to 06master: 02http://git.io/p6aS
[03:59:12] -ghservo- 13saltfs/06master 14295bea6 15Matt Brubeck: Move SERVO_CACHE_DIR outside of src dir
[03:59:12] -ghservo- 13saltfs/06master 14b0d2640 15Manish Goregaokar: Merge pull request #24 from mbrubeck/cache-dir...
[03:59:12] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[04:01:46] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[04:01:50] <jdm> Caspy7: usually that's Manishearth
[04:02:12] <Manishearth> Caspy7: I did post, right?
[04:03:36] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[04:03:46] <Manishearth> but yeah, me
[04:04:03] *** Joins: palodequeso (quassel@moz-i85m6b.pa.comcast.net)
[04:04:15] <Caspy7> Manishearth: ah, my bad, I hadn't seen it and when I used my handy addon with the link I had, it didn't show it posted to /r/rust, but I see it is in fact there
[04:04:40] <Manishearth> sometimes reddit is slow to show things on the homepage
[04:04:42] <Manishearth> *shrug*
[04:05:13] <pcwalton> http://i.imgur.com/pXn3VFM.png ok, it's leaving space vertically and horizontally now
[04:05:14] <Caspy7> I keep getting different results. I don't know what the issue is
[04:05:41] <pcwalton> now what's left is to extend the thinner borders so that they go in the middle of the thicker borders
[04:07:36] <pcwalton> Firefox's rendering is http://i.imgur.com/RbsaCNc.png
[04:08:01] <Gankro> > Downloading Cargo nightly: 100.3%
[04:08:03] <pcwalton> and I have no idea why it shoves 2, 6, and 8 "out of the way" of the border -- the spec doesn't say to do that from what I see, so I'm not going to do that
[04:08:07] <Gankro> mach is a pretty good program
[04:09:00] <pcwalton> I personally think Servo's rendering will look better than Firefox's once I extend the borders properly, since the numbers are all aligned into rows and columns instead of spaced out weirdly
[04:12:40] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[04:15:07] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[04:15:38] <hoverbear> That feeling while you wait to get the confirmation of a employment application. xD
[04:19:07] <Caspy7> while I'm here I might as well ask: It won't be possible to replace Gecko in Firefox on desktops, but what about Android?
[04:19:09] *** Quits: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt) (Ping timeout: 121 seconds)
[04:20:22] *** Joins: mdln (mdln@moz-eo1a6k.res.bhn.net)
[04:21:40] <jdm> Caspy7: it's more plausible.
[04:22:07] *** Joins: jxs (joaoxsouls@moz-odlbq5.fcsh.unl.pt)
[04:23:33] <Caspy7> I don't know how much non standard stuff is in it I guess
[04:23:55] <hoverbear> I'm thinking more about Boot2Geck to be honest, Caspy7 
[04:24:59] <Caspy7> hoverbear: yeah, that where I was figuring the first real replacement/displacement would be seen. I know you guys are working on B2S
[04:25:23] <Caspy7> but I'd love to see something more than BMP on desktop. Did I hear something about a video codec?
[04:26:03] <hoverbear> Caspy7: I think pcwalton had youtub working.
[04:26:27] <pcwalton> I don't have youtube.com working, but the raw videos can be played with rust-media
[04:26:35] <hoverbear> Heck that's even better
[04:26:45] <pcwalton> real YouTube requires Media Source Extensions, at least
[04:26:54] <hoverbear> pcwalton: We can advertise that it's add-free!
[04:26:56] <hoverbear> ad*
[04:27:24] <Caspy7> pcwalton: well, you can enable HTML video on Firefox without MSE and get a few resolutions
[04:27:50] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[04:27:50] -ghservo- [13servo] 15bors-servo closed pull request #5201: Remove plugin attributes from extern crates. (06master...06plugins) 02http://git.io/pKrq
[04:27:50] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[04:37:34] *** Quits: acgtyrant (acgtyrant@moz-3kd.b79.160.124.IP) (Quit: å •å…¥ /dev/null)
[04:38:10] *** Quits: palodequeso (quassel@moz-i85m6b.pa.comcast.net) (Ping timeout: 121 seconds)
[04:39:02] *** Quits: Pierre (pierre@moz-lmh.0pq.89.116.IP) (Ping timeout: 121 seconds)
[04:39:27] *** Quits: caitp (caitp@moz-lmogh4.cable.rogers.com) (Ping timeout: 121 seconds)
[04:40:47] <wldcordeiro> Caspy7: Why would it not be able to replace Gecko in the desktop? Long term it could be possible?
[04:41:10] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[04:42:02] <Caspy7> wldcordeiro: desktop Firefox uses XUL. Which is very nonstandard
[04:42:17] <Caspy7> wldcordeiro: Servo has no intentions of implementing XUL
[04:42:38] <Caspy7> most (all?) addons would break and the UI itself is written in XUL
[04:44:37] *** Quits: evanfarrar (evanfarrar@moz-dncs33.east.verizon.net) (Ping timeout: 121 seconds)
[04:45:19] <wldcordeiro> Caspy7: Ah true, that would be a long shot and technically a whole new browser at that point. 
[04:46:51] *** darkowlzz|afk is now known as darkowlzz
[04:48:27] <Caspy7> wldcordeiro: On desktop Servo could probably only *displace* Gecko through a new browser. My hope, and I have no idea if it's in the realm of possibility, is if there would be a way to save some of the code from Firefox - perhaps some could be converted - and help serve to start this new theoretical browser
[04:48:46] <Caspy7> because creating a new browser from scratch would seem like it would really suck
[04:49:04] <Caspy7> and a lot of work has gone into many aspects of Firefox that really do work pretty well
[04:50:00] <wldcordeiro> Caspy7: Especially the addons ecosystem. It'd be a shame to lose all that and unless Servo's performance was absurdly better it'd be hard to convince people to jump ship.
[04:50:23] *** Quits: gozala (uid5923@moz-ftm4af.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[04:52:16] <Caspy7> wldcordeiro: exactly, addons is a huge thing. I'm no expert, but Jetpack based addons might be an easier thing to do. Non-jetpack however are probably a harder sell. Also, this theoretical browser would probably be getting quite a redesign under the hood having learned from Firefox's mistakes and so a lot of the internal workings that addons rely on could change
[04:52:54] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[04:56:21] *** Joins: fabrice (fabrice@moz-r84lgh.ca.comcast.net)
[04:58:12] <wldcordeiro> jdm: I'm having trouble with getting the scriptmsg split up. There's some complications of having a common variant on the worker and main scriptmsg types.
[04:58:39] <Caspy7> for instance, we don't really have a permission model for addons - like we do with web apps (and I think I heard Chrome does with addons)
[04:58:52] <jdm> wldcordeiro: hmm, sorry to hear that. happy to help however I can!
[04:59:07] *** Joins: Pierre (pierre@moz-lmh.0pq.89.116.IP)
[05:01:47] <wldcordeiro> jdm: It seems like it's harder to handle the msg types if you have a common variant on the worker/main scriptmsgs rather than a main/worker variant on the common. There's places that scriptchan's send are used with variants from each.
[05:04:22] <jdm> wldcordeiro: that probably means that we need to add a clone_specific method to NonWorkerScriptChan and pass around NonWorkerScriptChan in a few places instead of Box<ScriptChan+Send>
[05:04:40] <jdm> if I'm understanding the problem correctly
[05:05:54] <jdm> but I think it's important to keep the split of WorkerMsg/MainThreadMsg/CommonMsg because it allows us to say "this task will only receive messages of this type"
[05:06:12] <jdm> whereas right now we say "this task _should_ only receive messages of this type"
[05:06:25] <wldcordeiro> That does sound like it could help, there's places like script::dom::window that make it particularly challenging
[05:06:36] <wldcordeiro> Right.
[05:07:00] <wldcordeiro> Would that be something that another issue should handle creating or wrap it into this one I've been working on btw?
[05:09:00] *** Joins: mystor_ (mystor@moz-ldavpp.home3.cgocable.net)
[05:09:00] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[05:09:09] *** Quits: Pierre (pierre@moz-lmh.0pq.89.116.IP) (Ping timeout: 121 seconds)
[05:11:18] <jdm> wldcordeiro: it's up to you - you could throw it all together now and see if it's worth extracting separately later.
[05:12:18] *** Joins: Pierre (pierre@moz-lmh.0pq.89.116.IP)
[05:13:09] <wldcordeiro> jdm: cool, what were the ScriptChan changes you requested by the way? were they merged into master? I recall you mentioning them in the pr but I didn't see an issue or pr that affected scriptchan.
[05:13:32] <jdm> wldcordeiro: I pointed it out in my Critic comments
[05:13:35] *** Joins: cakecatz (cakecatz@moz-1souik.smart2j.com)
[05:13:54] <wldcordeiro> jdm: Ah I see it was in that.
[05:14:30] *** Quits: CoreDuo (CoreDuo@moz-jgeuu4.coreduo.me.uk) (Quit: ZNC - http://znc.sourceforge.net)
[05:17:23] <wldcordeiro> Well thanks for the help, if anything I'll stick to the gh issue so it's easier to reference to.
[05:19:09] *** Joins: CoreDuo (CoreDuo@moz-jgeuu4.coreduo.me.uk)
[05:19:33] *** Joins: playjax (chatzilla@moz-2sd7e6.optusnet.com.au)
[05:19:40] <jdm> ok!
[05:19:45] <jdm> thanks for doing this work :)
[05:20:32] <wldcordeiro> jdm: No problem :D It's interesting to work with. Rust is a really cool language and Servo seems like a great project to learn more about it in.
[05:29:09] *** Joins: acgtyrant (acgtyrant@moz-dfv.4sk.186.39.IP)
[05:32:24] *** Quits: mystor_ (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[05:32:48] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Connection closed)
[05:34:26] *** Quits: erickt (erickt@moz-njt.vqi.14.76.IP) (Ping timeout: 121 seconds)
[05:34:57] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[05:36:56] *** Joins: caitp (caitp@moz-lmogh4.cable.rogers.com)
[05:40:25] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Connection closed)
[05:40:48] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[05:45:23] *** Quits: Pierre (pierre@moz-lmh.0pq.89.116.IP) (Ping timeout: 121 seconds)
[05:45:30] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[05:48:12] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[05:48:32] <cajbir> jdm: I'm looking for easy servo tasks to get my feet wet. Is issue 2108 being worked on?
[05:48:32] <crowbot1> Issue #2108: Rename ambigous unwrapping in bindings code - https://github.com/servo/servo/issues/2108
[05:48:48] <jdm> cajbir: nope!
[05:49:06] <cajbir> jdm: Ok if I request in the issue to get assigned?
[05:49:12] <jdm> cajbir: sure :)
[05:49:43] <cajbir> jdm: cool, done, thanks.
[05:50:08] * jdm didn't realize that cajbir == doublec
[05:50:16] <jdm> long time no see!
[05:51:33] *** Joins: Pierre (pierre@moz-lmh.0pq.89.116.IP)
[05:52:16] * jdm goes to bed
[05:52:17] *** Quits: jdm (jdm@moz-6sq.tjp.175.184.IP) (Quit: )
[05:52:19] <cajbir> jdm: haha yep!
[05:58:39] *** Quits: hoverbear (hoverbear@moz-csaicn.gv.shawcable.net) (Quit: Time to hibernate.... ZzZz...)
[06:06:34] *** Quits: ekiara (emk@moz-o2c214.tech.co.ke) (Quit: leaving)
[06:06:37] *** Joins: ekiara (emk@moz-o2c214.tech.co.ke)
[06:10:11] *** Quits: caitp (caitp@moz-lmogh4.cable.rogers.com) (Ping timeout: 121 seconds)
[06:10:43] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[06:18:45] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[06:22:42] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[06:22:42] -ghservo- [13servo] 15doublec opened pull request #5202: Fix #2108 by renaming unwrap functions to native_from_reflector (06master...06rename_unwrap) 02http://git.io/p6F6
[06:22:42] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[06:26:34] *** Joins: kmicu (kmicu@moz-uga.edn.218.91.IP)
[06:28:58] *** Joins: Pierre_ (pierre@moz-fd3.md1.90.128.IP)
[06:29:41] *** Quits: Pierre (pierre@moz-lmh.0pq.89.116.IP) (Ping timeout: 121 seconds)
[06:33:00] *** Joins: dbaron (dbaron@moz-rb4k89.dynamic.fusionbroadband.com)
[06:34:16] *** Quits: njn (chatzilla@moz-i76q70.iinet.net.au) (Quit: ChatZilla 0.9.91.1 [Firefox 39.0a1/20150309142159])
[06:41:14] *** Quits: agile (mike@moz-m71dqt.rcsntx.sbcglobal.net) (Connection closed)
[06:47:21] *** Joins: bogdan_maris (Instantbird@moz-662.esi.231.62.IP)
[06:50:01] *** Quits: Caspy7 (chatzilla@moz-qg6.7b1.185.99.IP) (Ping timeout: 121 seconds)
[06:50:41] *** nrc is now known as nrc|afk
[06:51:37] *** darkowlzz is now known as darkowlzz|afk
[06:53:45] *** Quits: wldcordeiro (wldcordeiro@moz-h7mvf3.hmj8.a2nn.0007.2601.IP) (Ping timeout: 121 seconds)
[06:54:15] *** Joins: dstrbad (dstrbad@moz-rsl7v1.net.t-com.hr)
[06:55:26] *** Joins: bjz (bjz@moz-4l6.mjm.52.113.IP)
[06:56:22] *** Quits: bjz (bjz@moz-4l6.mjm.52.113.IP) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[06:57:35] *** Joins: bjz (bjz@moz-4l6.mjm.52.113.IP)
[06:57:54] *** Quits: psd (psd@moz-acc.mpg.78.202.IP) (A TLS packet with unexpected length was received.)
[06:58:10] *** Joins: agile (mike@moz-m71dqt.rcsntx.sbcglobal.net)
[07:00:40] *** darkowlzz|afk is now known as darkowlzz
[07:00:41] <SimonSapin> Manishearth: Thanks. Replied.
[07:05:03] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[07:05:27] *** Quits: bjz (bjz@moz-4l6.mjm.52.113.IP) (Ping timeout: 121 seconds)
[07:05:46] *** Joins: psd (psd@moz-mae.ero.215.180.IP)
[07:15:21] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[07:19:26] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[07:24:31] *** Quits: untitaker (untitaker@moz-0kb2h3.highway.telekom.at) (Ping timeout: 121 seconds)
[07:28:32] *** Quits: Gankro (uid71432@moz-sc2bd6.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[07:29:58] *** Joins: untitaker (untitaker@moz-n9v0fd.highway.telekom.at)
[07:32:33] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[07:34:11] *** Quits: moa (Cedric@moz-quu9i9.enlightenment.org) (Ping timeout: 121 seconds)
[07:36:19] *** Joins: wldcordeiro (wldcordeiro@moz-h7mvf3.hmj8.a2nn.0007.2601.IP)
[07:36:48] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[07:37:45] *** Joins: Ms2ger (Ms2ger@moz-t9m.9ho.190.193.IP)
[07:38:56] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[07:39:42] *** Joins: TheHydroImpulse (TheHydroImp@moz-r25mqk.ed.shawcable.net)
[07:42:22] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[07:46:39] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[07:51:53] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[07:51:53] -ghservo- [13servo] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/piIz
[07:51:53] -ghservo- 13servo/06auto 142af19b2 15Chris Double: Fix #2108 by renaming unwrap functions to native_from_reflector...
[07:51:53] -ghservo- 13servo/06auto 14d7e9b8b 15bors-servo: auto merge of #5202 : doublec/servo/rename_unwrap, r=Ms2ger...
[07:51:53] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[07:55:57] *** Joins: psd_ (psd@moz-mae.ero.215.180.IP)
[07:57:33] *** Quits: aweinstock (aweinstock@moz-8mcrmr.us) (Quit: leaving)
[07:57:45] *** Quits: eddyb (eddyb@moz-mmq.pug.25.188.IP) (Quit: Konversation terminated!)
[07:57:48] *** Joins: eddyb_ (eddyb@moz-mmq.pug.25.188.IP)
[07:58:17] *** Joins: aweinsto1k (aweinstock@moz-8mcrmr.us)
[07:58:26] *** aweinsto1k is now known as aweinstock
[07:59:07] *** Quits: psd (psd@moz-mae.ero.215.180.IP) (Ping timeout: 121 seconds)
[08:00:00] *** Joins: pakupaku (pl@moz-lc4.ai6.55.193.IP)
[08:02:13] *** Quits: eddyb_ (eddyb@moz-mmq.pug.25.188.IP) (Ping timeout: 121 seconds)
[08:02:14] *** Joins: aravindavk (aravinda@moz-m6j.f0d.244.121.IP)
[08:13:57] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Connection closed)
[08:15:45] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[08:15:52] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[08:17:22] *** Joins: bjz (bjz@moz-puppgq.tpgi.com.au)
[08:18:08] *** Quits: psd_ (psd@moz-mae.ero.215.180.IP) (Ping timeout: 121 seconds)
[08:19:48] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[08:26:42] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[08:30:39] *** Joins: reem (reem@moz-1i55fb.coob.q2h1.0009.2601.IP)
[08:30:59] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[08:31:33] *** Joins: psd_ (psd@moz-acc.mpg.78.202.IP)
[08:31:45] *** Quits: wldcordeiro (wldcordeiro@moz-h7mvf3.hmj8.a2nn.0007.2601.IP) (Ping timeout: 121 seconds)
[08:33:51] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[08:33:51] -ghservo- [13servo] 15bors-servo closed pull request #5202: Fix #2108 by renaming unwrap functions to native_from_reflector (06master...06rename_unwrap) 02http://git.io/p6F6
[08:33:51] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[08:33:55] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[08:33:55] -ghservo- [13servo] 15bors-servo closed issue #2108: Rename ambigous unwrapping in bindings code 02http://git.io/pisc
[08:33:55] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[08:34:52] *** Quits: dbaron (dbaron@moz-rb4k89.dynamic.fusionbroadband.com) (Ping timeout: 121 seconds)
[08:36:29] *** Joins: mihneadb (mihneadb@moz-b5r.gbu.120.86.IP)
[08:42:09] *** psd_ is now known as psd
[08:43:07] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[08:45:06] *** Quits: reem (reem@moz-1i55fb.coob.q2h1.0009.2601.IP) (Connection closed)
[08:45:11] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[08:47:28] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[08:56:12] *** Quits: valentin (icecold@moz-ufp.552.196.81.IP) (Quit: Leaving.)
[08:56:13] *** Joins: valentin (icecold@moz-ufp.552.196.81.IP)
[09:00:51] *** Joins: Nekit1234007 (nekit@moz-vfr.64q.51.84.IP)
[09:04:34] *** Joins: slyu (slyu@moz-2hf62a.HINET-IP.hinet.net)
[09:06:14] *** darkowlzz is now known as darkowlzz|afk
[09:06:18] *** Quits: cyndis (cyndis@moz-bmdn13.kapsi.fi) (Ping timeout: 121 seconds)
[09:08:21] *** Quits: acgtyrant (acgtyrant@moz-dfv.4sk.186.39.IP) (Ping timeout: 121 seconds)
[09:16:06] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[09:20:09] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[09:20:49] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[09:25:09] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[09:25:09] *** Quits: nrc|afk (nrc@moz-4bhi2i.xtra.co.nz) (Ping timeout: 121 seconds)
[09:26:20] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[09:27:37] *** Joins: reem (reem@moz-pus16t.coob.q2h1.0009.2601.IP)
[09:28:21] *** Quits: mihneadb (mihneadb@moz-b5r.gbu.120.86.IP) (Quit: Bye)
[09:31:26] *** Joins: mihneadb (mihneadb@moz-b5r.gbu.120.86.IP)
[09:33:41] *** Joins: cyndis (cyndis@moz-bmdn13.kapsi.fi)
[09:36:40] *** Joins: laumann (thomas@moz-bcl.hq0.225.130.IP)
[09:40:42] *** darkowlzz|afk is now known as darkowlzz
[09:44:32] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[09:44:32] -ghservo- [13servo] 15Ms2ger 04force-pushed 06rustup_20150311 from 1454cb274 to 145f504f1: 02http://git.io/piz8
[09:44:32] -ghservo- 13servo/06rustup_20150311 145449e5c 15Ms2ger: Upgrade rustc to d3c49d2140fc65e8bb7d7cf25bfe74dda6ce5ecf/rustc-1.0.0-dev.
[09:44:32] -ghservo- 13servo/06rustup_20150311 14e513393 15Ms2ger: Fix mach build
[09:44:32] -ghservo- 13servo/06rustup_20150311 14005000c 15Ms2ger: Stop using env::var_string
[09:44:32] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[09:47:36] *** Quits: cakecatz (cakecatz@moz-1souik.smart2j.com) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[09:50:36] *** Joins: acgtyrant (acgtyrant@moz-dfv.4sk.186.39.IP)
[09:52:27] *** Joins: caitp (caitp@moz-lmogh4.cable.rogers.com)
[09:54:50] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[09:54:50] -ghservo- [13servo] 15Ms2ger pushed 1 new commit to 06rustup_20150311: 02http://git.io/piaC
[09:54:50] -ghservo- 13servo/06rustup_20150311 14262b899 15Ms2ger: Fixes
[09:54:50] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[10:00:51] *** Joins: jviereck (Adium@moz-v899hj.ethz.ch)
[10:01:04] *** Quits: jviereck (Adium@moz-v899hj.ethz.ch) (Connection closed)
[10:01:04] *** Joins: jviereck1 (Adium@moz-v899hj.ethz.ch)
[10:01:25] *** Joins: jviereck (Adium@moz-28htm3.ethz.ch)
[10:01:38] *** Joins: cakecatz (cakecatz@moz-1souik.smart2j.com)
[10:01:51] *** Joins: dstrbad_ (dstrbad@moz-287ol4.net.t-com.hr)
[10:04:17] *** Quits: dstrbad (dstrbad@moz-rsl7v1.net.t-com.hr) (Ping timeout: 121 seconds)
[10:05:06] *** Quits: jviereck1 (Adium@moz-v899hj.ethz.ch) (Ping timeout: 121 seconds)
[10:06:45] *** Joins: eibwen (eibwen@moz-i37.e5n.231.217.IP)
[10:11:32] *** Joins: mib_h1lb04 (Mibbit@moz-juv.9o3.252.72.IP)
[10:14:59] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[10:16:18] *** Quits: slyu (slyu@moz-2hf62a.HINET-IP.hinet.net) (A TLS packet with unexpected length was received.)
[10:16:27] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[10:18:03] *** Quits: mib_h1lb04 (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[10:19:17] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[10:20:32] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[10:25:00] *** Quits: caitp (caitp@moz-lmogh4.cable.rogers.com) (Ping timeout: 121 seconds)
[10:27:35] *** Quits: reem (reem@moz-pus16t.coob.q2h1.0009.2601.IP) (Connection closed)
[10:27:53] *** Quits: psd (psd@moz-acc.mpg.78.202.IP) (Ping timeout: 121 seconds)
[10:29:20] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[10:33:26] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Ping timeout: 121 seconds)
[10:36:55] *** Joins: mahdi (mahdi@moz-sa5.a9p.244.151.IP)
[10:41:08] *** Quits: jviereck (Adium@moz-28htm3.ethz.ch) (Quit: Leaving.)
[10:50:15] *** Quits: valentin (icecold@moz-ufp.552.196.81.IP) (Ping timeout: 121 seconds)
[10:54:11] *** Quits: gw (uid31717@moz-hcr55a.charlton.irccloud.com) (Quit: Connection closed for inactivity)
[10:56:04] *** Joins: psd (psd@moz-acc.mpg.78.202.IP)
[10:56:12] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[10:56:12] -ghservo- [13servo] 15narfg opened issue #5203: No line break after links 02http://git.io/pi9b
[10:56:12] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[10:56:15] *** Quits: dstrbad_ (dstrbad@moz-287ol4.net.t-com.hr) (A TLS packet with unexpected length was received.)
[10:56:47] *** mdoglio|afk is now known as mdoglio
[10:58:15] *** Joins: eddyb_ (eddyb@moz-6g5.iqr.166.109.IP)
[11:00:50] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[11:01:18] *** Joins: valentin (icecold@moz-ufp.552.196.81.IP)
[11:03:40] *** Quits: sawrubh (uid6719@moz-sr8l1j.brockwell.irccloud.com) (Quit: Connection closed for inactivity)
[11:09:08] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[11:13:26] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[11:16:51] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[11:19:23] *** Quits: eddyb_ (eddyb@moz-6g5.iqr.166.109.IP) (Ping timeout: 121 seconds)
[11:20:58] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[11:24:36] *** Quits: cakecatz (cakecatz@moz-1souik.smart2j.com) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[11:27:20] *** Quits: barosl (barosl@moz-7vg.qma.67.220.IP) (Connection closed)
[11:33:00] *** Joins: barosl (barosl@moz-7vg.qma.67.220.IP)
[11:34:59] *** Joins: cakecatz (cakecatz@moz-1souik.smart2j.com)
[11:38:08] *** Quits: playjax (chatzilla@moz-2sd7e6.optusnet.com.au) (Connection closed)
[11:39:48] *** Quits: crowbot1 (nodebot@moz-eacqfa.compute-1.amazonaws.com) (A TLS packet with unexpected length was received.)
[11:39:49] *** Joins: crowbot (nodebot@moz-md5r3k.compute-1.amazonaws.com)
[11:44:27] *** Joins: Nefzaoui (nefzaoui_@moz-11u.mj3.1.197.IP)
[11:51:52] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[11:51:52] -ghservo- [13servo] 15bors-servo pushed 3 new commits to 06auto: 02http://git.io/pPe5
[11:51:52] -ghservo- 13servo/06auto 14ab4b34d 15hirschenberger: Fix #5176 by premultiplying the alpha channel to the color channels...
[11:51:52] -ghservo- 13servo/06auto 142a91c31 15hirschenberger: Add reftest for issue #5176
[11:51:52] -ghservo- 13servo/06auto 146593cf9 15bors-servo: auto merge of #5194 : hirschenberger/servo/gif_alpha_background, r=larsbergstrom...
[11:51:52] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[11:52:03] *** Joins: caitp (caitp@moz-lmogh4.cable.rogers.com)
[11:52:06] *** Joins: ienzam (enzam@moz-2jsbpn.dynamic.upc.ie)
[11:55:37] *** Joins: mib_2cxfmj (Mibbit@moz-juv.9o3.252.72.IP)
[11:56:17] *** Quits: mib_2cxfmj (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[12:00:41] *** Joins: jviereck (Adium@moz-siekha.bmup.g469.067c.2001.IP)
[12:03:16] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[12:04:57] *** Joins: dinfuehr (dinfuehr@moz-t870pb.highway.telekom.at)
[12:05:05] *** Quits: dinfuehr (dinfuehr@moz-t870pb.highway.telekom.at) (Connection closed)
[12:07:36] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[12:13:53] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[12:17:16] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[12:17:32] *** Quits: jviereck (Adium@moz-siekha.bmup.g469.067c.2001.IP) (Quit: Leaving.)
[12:18:18] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Ping timeout: 121 seconds)
[12:21:18] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[12:22:38] *** Quits: ienzam (enzam@moz-2jsbpn.dynamic.upc.ie) (Ping timeout: 121 seconds)
[12:25:43] *** Quits: caitp (caitp@moz-lmogh4.cable.rogers.com) (Ping timeout: 121 seconds)
[12:33:50] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[12:33:50] -ghservo- [13servo] 15bors-servo merged 06auto into 06master: 02http://git.io/pPe5
[12:33:50] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[12:33:54] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[12:33:54] -ghservo- [13servo] 15bors-servo closed issue #5176: Incorrect rendering of images with pixels with A = 0 but RGB != 0 02http://git.io/pYZn
[12:33:54] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[12:43:37] *** Joins: acgtyrant_ (acgtyrant@moz-dfv.4sk.186.39.IP)
[12:43:48] *** Quits: acgtyrant (acgtyrant@moz-dfv.4sk.186.39.IP) (Connection closed)
[12:44:44] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[12:49:02] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Ping timeout: 121 seconds)
[12:50:54] *** Joins: ahal (ahal@moz-blga2k.cpe.pppoe.ca)
[12:52:31] *** Joins: eddyb_ (eddyb@moz-mmq.pug.25.188.IP)
[12:57:26] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[12:58:31] *** Quits: pakupaku (pl@moz-lc4.ai6.55.193.IP) (Quit: WeeChat 1.0.1)
[12:58:33] *** Joins: pakupaku (pl@moz-lc4.ai6.55.193.IP)
[13:00:28] *** darkowlzz is now known as darkowlzz|afk
[13:00:51] *** Joins: caitp (caitp@moz-lmogh4.cable.rogers.com)
[13:01:41] *** Quits: pakupaku (pl@moz-lc4.ai6.55.193.IP) (Quit: WeeChat 1.0.1)
[13:01:44] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[13:01:44] *** Joins: pakupaku (pl@moz-lc4.ai6.55.193.IP)
[13:02:40] *** darkowlzz|afk is now known as darkowlzz
[13:03:27] *** darkowlzz is now known as darkowlzz|afk
[13:06:17] *** darkowlzz|afk is now known as darkowlzz
[13:11:03] *** darkowlzz is now known as darkowlzz|afk
[13:14:27] *** Quits: cakecatz (cakecatz@moz-1souik.smart2j.com) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[13:15:42] *** Joins: dinfuehr (dinfuehr@moz-t870pb.highway.telekom.at)
[13:16:47] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[13:17:36] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[13:19:45] *** Quits: dinfuehr (dinfuehr@moz-t870pb.highway.telekom.at) (Ping timeout: 121 seconds)
[13:21:43] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[13:24:36] *** Joins: ienzam (enzam@moz-0mn6nu.customer.teliacarrier.com)
[13:28:17] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[13:32:25] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Ping timeout: 121 seconds)
[13:32:36] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[13:33:06] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[13:38:29] *** Joins: jdm (jdm@moz-mu9.06r.98.75.IP)
[13:38:29] *** ChanServ sets mode: +qo jdm jdm
[13:41:08] *** Joins: dstrbad (dstrbad@moz-j6ume5.cable.xnet.hr)
[13:41:15] *** Quits: dstrbad (dstrbad@moz-j6ume5.cable.xnet.hr) (A TLS packet with unexpected length was received.)
[13:41:16] *** Joins: dstrbad (dstrbad@moz-j6ume5.cable.xnet.hr)
[13:43:13] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[13:43:29] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[13:45:01] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[13:45:43] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Connection closed)
[13:46:21] *** Joins: isra17 (isra17@moz-gfbmuj.mc.videotron.ca)
[13:46:35] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[13:46:45] *** Quits: aravindavk (aravinda@moz-m6j.f0d.244.121.IP) (Quit: Konversation terminated!)
[13:46:54] *** Quits: acgtyrant_ (acgtyrant@moz-dfv.4sk.186.39.IP) (Quit: å •å…¥ /dev/null)
[13:47:52] *** Joins: slyu (Mibbit@moz-c7ajla.kbronet.com.tw)
[13:48:39] <slyu> Hi, can anyone help me on getting the position of a image element?
[13:49:03] <slyu> SimonSapin introduced me to hit_test() in gfx/display_list
[13:49:24] <jdm> slyu: I can try :)
[13:49:42] <slyu> but I was trying to do this in script/dom, I'm not sure how I can get the DisplayItem in gfx/display_list
[13:51:02] <slyu> jdm: I remember you mentioned something about layout query, will that help?
[13:51:16] <jdm> slyu: yes, you will want to write code for this in the layout side, not script
[13:51:37] <jdm> slyu: I expect you'll need to build something that is halfway between a content box request and a hit test
[13:51:37] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[13:51:38] <jdm> http://mxr.mozilla.org/servo/source/components/layout/layout_task.rs#612
[13:51:51] <jdm> because the image position will rely on information from the flow tree, not the display list
[13:52:22] <jdm> although then again... the fixme at http://mxr.mozilla.org/servo/source/components/layout/layout_task.rs#616 doesn't encourage me
[13:52:25] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[13:53:29] <jdm> slyu: ok, let's focus on hit_test right now
[13:53:53] <jdm> hit_test looks for the element that is under the given Point2D
[13:54:14] <slyu> Hmm... let me push my half-done code so we can discuss
[13:54:49] <jdm> mxr.mozilla.org/servo/source/components/gfx/display_list/mod.rs#398 takes an iterator over DisplayItem types
[13:54:52] <jdm> http://mxr.mozilla.org/servo/source/components/gfx/display_list/mod.rs#524
[13:55:26] *** Joins: palodequeso (quassel@moz-ebjt83.hfc.comcastbusiness.net)
[13:55:55] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[13:55:57] <jdm> note that every DisplayItem has a BaseDisplayItem field
[13:56:03] <jdm> and that contains a DisplayItemMetadata field
[13:56:10] <jdm> which contains this property: http://mxr.mozilla.org/servo/source/components/gfx/display_list/mod.rs#689
[13:56:43] <jdm> so that means that we can iterate over all items in a display list and figure out if it matches the DOM node we want
[13:57:22] <slyu> Wow
[13:57:33] <slyu> Sounds very inefficient
[13:57:53] *** Quits: aweinstock (aweinstock@moz-8mcrmr.us) (Connection closed)
[13:58:04] <slyu> What I am trying to do is here: https://github.com/shinglyu/servo/blob/ismap/components/script/dom/htmlanchorelement.rs#L134
[13:59:01] <slyu> When a user clicks a <a><img/></a>, we need to append the relative corrdinate to the link url
[13:59:32] <slyu> but the coordinate need to be relative to the top-left corner of the <img>
[14:00:44] *** Joins: jiojiajiu (jiojiajiu@moz-ndq.e0f.46.1.IP)
[14:00:49] <jdm> slyu: so this operation probably makes more sense basing it on the content box layout query
[14:01:11] <jdm> where instead of retrieving the width and the height of the element, we retrieve the absolute x and y positioning
[14:01:12] <jdm> http://mxr.mozilla.org/servo/source/components/layout/layout_task.rs#612
[14:02:32] <slyu> Is it used like this? 
[14:02:34] <slyu> http://mxr.mozilla.org/servo/source/components/script/dom/window.rs#583
[14:03:24] <jdm> slyu: yes
[14:06:50] *** Joins: garvank (Garvan@moz-1fp.d2n.140.24.IP)
[14:08:15] <slyu> jdm: It triggered some reflow here, can I do a simpler query, just to get the coordinates?
[14:08:28] <jdm> slyu: it's necessary to do so
[14:08:30] *** Joins: acgtyrant (acgtyrant@moz-3kd.b79.160.124.IP)
[14:08:52] <jdm> if any styles have changed, the old coordinates might be inaccurate
[14:09:03] <slyu> I see
[14:09:19] *** darkowlzz|afk is now known as darkowlzz
[14:09:23] *** AutomatedTester|AFK is now known as AutomatedTester
[14:09:28] <slyu> So I have to trigger a reflow and get the freshest coordinates
[14:09:31] <jdm> yes
[14:11:53] <slyu> Thanks jdm, I need so time to trace these code
[14:12:01] <slyu> *some* time
[14:12:25] <jdm> you're welcome!
[14:16:26] <jdm> slyu: heh, turns out you're implementing this: http://dev.w3.org/csswg/cssom-view/#extensions-to-the-htmlimageelement-interface :)
[14:17:11] *** Quits: caitp (caitp@moz-lmogh4.cable.rogers.com) (Ping timeout: 121 seconds)
[14:28:21] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[14:31:41] <SimonSapin> ignoring transforms, thatâ€™s curious
[14:32:18] *** darkowlzz is now known as darkowlzz|afk
[14:33:36] *** darkowlzz|afk is now known as darkowlzz
[14:36:38] *** eddyb_ is now known as eddyb
[14:38:25] *** darkowlzz is now known as darkowlzz|afk
[14:39:57] *** Quits: palodequeso (quassel@moz-ebjt83.hfc.comcastbusiness.net) (Ping timeout: 121 seconds)
[14:42:28] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Connection closed)
[14:44:54] <Ms2ger> Down to 50 open tabs \o/
[14:45:44] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[14:46:38] *** Joins: cakecatz (cakecatz@moz-rqfnlo.sannet.ne.jp)
[14:47:36] * jdm was down to four the other day, and then came across a lot of links to interesting papers
[14:50:02] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[14:50:14] <Ms2ger> jdm, down from? :)
[14:50:36] <jdm> ~30
[14:50:45] <Ms2ger> Oh
[14:51:04] <Ms2ger> I'm down from ~600
[14:51:51] <jgraham> 30?
[14:52:06] <jgraham> You hardly need a tabbed browser
[14:52:17] <jgraham> In fact have you considered just using Servo?
[14:55:01] <slyu> jdm: Oh, is there a better place for the image element interface code?
[14:55:23] *** Joins: palodequeso (quassel@moz-502.v1c.163.173.IP)
[14:55:25] <jdm> slyu: that can come later
[14:55:30] <jdm> just do what's necessary right now :)
[14:55:47] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[14:55:50] <slyu> OK, thanks
[14:58:58] <slyu> By the way, is there any good introduction on how the w3c specs are organized?
[14:59:24] <jdm> what sort of organization are you asking about?
[14:59:24] <slyu> I don't really get the whole picture
[14:59:55] <jdm> do you mean stuff like the extensions to HTMLImageElement that I linked earlier?
[15:00:23] <jdm> w3c specs support mixins like that to make specs more self-contained (ideally)
[15:00:49] <jdm> so you have a spec that's all about observing the CSS positioning information via the DOM
[15:00:57] <jdm> and a spec about CSS positioning
[15:01:01] <jdm> and a spec about the DOM
[15:01:21] <slyu> Oh I see
[15:01:23] * jdm doesn't know if there's any way to see a bird's-eye view of it all
[15:02:13] <slyu> Ah, I found the answer in wikipedia
[15:02:18] <jgraham> https://platform.html5.org/
[15:02:37] <slyu> Actaully what I am asking is called spec maturation
[15:02:53] <jdm> jgraham: good lord
[15:03:09] <jdm> heh, "bonus features"
[15:03:19] <jgraham> jdm: Plenty to keep you busy :)
[15:03:19] * jdm wonders how he's never come across this before
[15:04:09] <jgraham> It's not too well publicised
[15:04:46] <jdm> "Other core-platform bonus features"
[15:04:49] <jdm> ie. the grab bag
[15:05:22] <jgraham> Yup
[15:05:24] *** Joins: jviereck (Adium@moz-mbj2cc.58bf.g469.067c.2001.IP)
[15:07:28] <Ms2ger> jdm, I started looking at your async networking pr, but I suspect Manishearth would be a better reviewer :)
[15:07:51] <jdm> Ms2ger: Manishearth doesn't have time right now ;_;
[15:08:05] <jdm> I can try to find someone else if you'd prefer
[15:09:01] <Manishearth> Ms2ger: jdm slightly more free today, might have a look
[15:09:11] <Manishearth> I thought Ms2ger had already reviewed part of it
[15:09:22] <Manishearth>  s/thought/assumed
[15:09:24] * jdm disembarks
[15:09:25] *** Quits: jdm (jdm@moz-mu9.06r.98.75.IP) (Quit: )
[15:09:31] <Ms2ger> No, I haven't
[15:10:22] <Manishearth> kay, I'll do it
[15:10:56] * Ms2ger wonders if chocolate would survive being mailed to India
[15:11:21] *** Quits: jiojiajiu (jiojiajiu@moz-ndq.e0f.46.1.IP) (Ping timeout: 121 seconds)
[15:13:55] *** Joins: caitp (caitp@moz-lmogh4.cable.rogers.com)
[15:19:21] * jack gets back to the grind of finding lost memory
[15:20:32] <larsberg> jgraham: that site is... amazing
[15:20:51] <jgraham> :)
[15:27:46] *** darkowlzz|afk is now known as darkowlzz
[15:29:40] *** Quits: jviereck (Adium@moz-mbj2cc.58bf.g469.067c.2001.IP) (Quit: Leaving.)
[15:29:41] *** Quits: bogdan_maris (Instantbird@moz-662.esi.231.62.IP) (Client exited)
[15:32:11] *** Joins: jdm (jdm@moz-j1lnh9.ckpj.s0pt.0450.2001.IP)
[15:32:11] *** ChanServ sets mode: +qo jdm jdm
[15:32:41] *** Joins: Caspy7 (chatzilla@moz-qg6.7b1.185.99.IP)
[15:35:50] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[15:39:41] *** Quits: acgtyrant (acgtyrant@moz-3kd.b79.160.124.IP) (Ping timeout: 121 seconds)
[15:39:56] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[15:39:57] *** jandem-away is now known as jandem
[15:42:34] *** Joins: dbaron (dbaron@moz-rb4k89.dynamic.fusionbroadband.com)
[15:44:12] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[15:47:33] *** Quits: caitp (caitp@moz-lmogh4.cable.rogers.com) (Ping timeout: 121 seconds)
[15:48:25] *** Joins: Gankro (uid71432@moz-sc2bd6.charlton.irccloud.com)
[15:48:58] *** Quits: fabrice (fabrice@moz-r84lgh.ca.comcast.net) (Ping timeout: 121 seconds)
[15:50:26] *** Joins: Savago (Savago@moz-k613vv.ca.comcast.net)
[15:53:38] *** Joins: ProgramFOX (ProgramFOX@moz-eag.sg5.176.91.IP)
[15:53:47] *** Quits: Savago (Savago@moz-k613vv.ca.comcast.net) (Client exited)
[15:53:52] *** Joins: jviereck (Adium@moz-mbj2cc.58bf.g469.067c.2001.IP)
[15:55:01] <Manishearth> Ms2ger: it certainly wouldn't survive being mailed to *me* :P
[15:55:29] *** Quits: slyu (Mibbit@moz-c7ajla.kbronet.com.tw) (Quit: http://www.mibbit.com ajax IRC Client)
[15:56:29] <jack> Ok, I finally found a reduced test case for the leak!
[15:57:00] *** AutomatedTester is now known as AutomatedTester|AFK
[15:57:48] <jdm> \o/
[15:58:37] *** Quits: jviereck (Adium@moz-mbj2cc.58bf.g469.067c.2001.IP) (Quit: Leaving.)
[15:58:42] <jack> Everything leaks for  tests/ref/inline_block_img_a.html
[15:58:44] *** Joins: narfg (chatzilla@moz-fo0095.ei.tum.de)
[15:58:45] <jack> nothign is freed at all
[15:58:56] <jack> and the flow tree is only 6 flows
[15:59:13] *** Joins: jviereck (Adium@moz-mbj2cc.58bf.g469.067c.2001.IP)
[15:59:25] *** ahal is now known as ahal|lunch
[15:59:42] <jack> https://gist.github.com/metajack/743cf366c9dcd29d4e2d
[16:00:12] <jack> No obvious cycles int eh flow tree
[16:00:23] *** Quits: jviereck (Adium@moz-mbj2cc.58bf.g469.067c.2001.IP) (Quit: Leaving.)
[16:02:41] *** Joins: jviereck (Adium@moz-mbj2cc.58bf.g469.067c.2001.IP)
[16:02:54] *** Quits: jviereck (Adium@moz-mbj2cc.58bf.g469.067c.2001.IP) (Quit: Leaving.)
[16:04:14] <narfg> jack: I noticed that even trivial pages like tests/html/hello.html leak on mouse movement 
[16:05:51] *** Joins: aweinstock (aweinstock@moz-8mcrmr.us)
[16:06:15] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[16:06:54] <jdm> jack: so inline-block continues to be a suspicious candidate?
[16:07:03] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[16:07:03] -ghservo- [13servo] 15SimonSapin pushed 2 new commits to 06rustup_20150311: 02http://git.io/pXrL
[16:07:03] -ghservo- 13servo/06rustup_20150311 14f950a44 15Simon Sapin: Update html5ever
[16:07:03] -ghservo- 13servo/06rustup_20150311 142adb282 15Simon Sapin: Some plugin fixes
[16:07:03] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[16:08:31] <jack> I cannot reproduce a leak with hello.html.
[16:08:33] <Ms2ger> Manishearth, I fear you're out of luck, then :)
[16:08:42] <jack> It reflows for every mouse move, but all the flows but the last one are correctly freed.
[16:08:46] <Manishearth> Ms2ger: hah
[16:08:56] <jack> narfg: How are you measuring a leak?
[16:09:07] <jack> (It's possible there is more than one and the one I am chasing is limited to inline-block
[16:09:28] <narfg> I looked at the output of -m 1 and the jemalloc numbers go up every time I move the mouse
[16:09:42] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[16:10:04] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[16:12:39] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[16:12:39] -ghservo- [13servo] 15SimonSapin pushed 1 new commit to 06rustup_20150311: 02http://git.io/pXKV
[16:12:39] -ghservo- 13servo/06rustup_20150311 1420b10f5 15Simon Sapin: Update rustc-serialize for html5ever_macros
[16:12:39] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[16:12:44] <jdm> Ms2ger: #4620 ?
[16:12:46] <crowbot> Issue #4620: Implement a replacement for Vec<Root<T>> - https://github.com/servo/servo/pull/4620
[16:14:14] <Ms2ger> jdm, ?
[16:14:37] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[16:14:37] *** ChanServ sets mode: +o brson
[16:15:07] <jack> 1here are backtraces from every FlowRef manipulation for a single leaked block: https://gist.github.com/metajack/5fd22786677e4998aedc
[16:15:29] <jack> Do we have our own DList?
[16:16:07] <Ms2ger> Don't think so
[16:16:10] *** Quits: isra17 (isra17@moz-gfbmuj.mc.videotron.ca) (Client exited)
[16:16:37] *** Quits: cakecatz (cakecatz@moz-rqfnlo.sannet.ne.jp) (Quit: Textual IRC Client: www.textualapp.com)
[16:17:08] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[16:17:34] <Ms2ger> jdm, that ball seems to be in your camp
[16:19:41] *** Joins: cakecatz (cakecatz@moz-rqfnlo.sannet.ne.jp)
[16:19:55] *** Joins: jviereck (Adium@moz-ihn58j.97ug.g469.067c.2001.IP)
[16:20:29] *** Joins: Jackneill (Jackneill@moz-va5cuo.pool.digikabel.hu)
[16:20:47] *** Quits: mihneadb (mihneadb@moz-b5r.gbu.120.86.IP) (Quit: Computer gone to sleep - Zzzz...)
[16:21:02] <mbrubeck> jack: No, just some extra utility functions for collections::dlist
[16:21:29] <mbrubeck> (which is renamed LinkedList in the next rustup)
[16:22:01] <mbrubeck> our extra stuff: https://github.com/servo/servo/blob/master/components/util/dlist.rs
[16:27:54] *** Joins: fabrice (fabrice@moz-gss2en.mh2d.1ibb.0101.2620.IP)
[16:28:00] <SimonSapin> mbrubeck: In the rustup, type parameters must be used. A work around is to add a PhantomData<_> field, but this makes typed units in rust-geom much more tedious :(
[16:28:19] <mbrubeck> SimonSapin: Yeah :(
[16:28:44] <SimonSapin> error: the trait `rustc-serialize::serialize::Decodable` is not implemented for the type `core::marker::PhantomData<(_, _)>`
[16:29:12] <mbrubeck> ugh
[16:29:59] <mbrubeck> SimonSapin: We'll want to add a lot more constructor functions, so we can write `Length::new(x)` instead of `Length(x, PhantomData)`
[16:29:59] <Manishearth> SimonSapin: I think you can actually circumvent that
[16:30:17] <SimonSapin> Manishearth: how?
[16:30:28] <Manishearth> by locally defining a private trait wth a decode() method of the same signature
[16:30:33] <Manishearth> #[derive] runs at expansion
[16:30:37] <Manishearth> pre-resolution
[16:30:51] <Manishearth> it just expands into calls of clone(), trace(), etc
[16:31:04] <SimonSapin> Manishearth: that would work for error: type `core::marker::PhantomData<(Src, Dst)>` does not implement any method in scope named `encode`
[16:31:05] <Ms2ger> Clone::clone(x)
[16:31:18] <Manishearth> unless they've explicitly hardcoded Decoder::decode(&d,...)
[16:31:20] <SimonSapin> but according to the error message, Decode really wants a trait impl
[16:31:22] <Manishearth> Ms2ger: they do that?
[16:31:28] <Ms2ger> I thought so
[16:31:30] <mbrubeck> I wonder if we can use PhantomFn instead?
[16:31:58] <jack> I cannot find where these extra clones are occuring in build_flow_block_starting_with_fragments
[16:32:09] <SimonSapin> PhantomFn is a trait
[16:32:14] <jack> or where the dlist clone is in build_block_flow_using_construction_result_of_child
[16:32:39] <Manishearth> Ms2ger: dammit, you're right
[16:32:45] <Manishearth> well, jstraceable doesn't :P
[16:32:55] <Manishearth> I tried to make it do that but I couldn't
[16:33:17] <Manishearth> (when it does do that, we can use #[on_unimplemented])
[16:33:26] <Manishearth> couldn't because of autoderef, but I'll try to fix that
[16:33:47] *** Joins: mib_u2a1oj (Mibbit@moz-juv.9o3.252.72.IP)
[16:37:15] <Ms2ger> jack, wild guess: flush_inline_fragments_to_flow_or_list
[16:37:47] <mbrubeck> SimonSapin: So I guess we need to submit a PR to rust-serialize to impl Decodable/Encodable for PhantomData?
[16:39:23] <Manishearth> yes
[16:39:33] <Manishearth> or!
[16:40:31] <Manishearth> use serialize::Decodable as Dec; trait Decodable {...}; impl Decodable for PhantomData {}; impl Decodable for T where T: Dec {}
[16:40:41] <Manishearth> that might get around orphan rules
[16:40:42] <Manishearth> maybe
[16:40:56] <Manishearth> oh wait
[16:40:56] *** Joins: gozala (uid5923@moz-ftm4af.brockwell.irccloud.com)
[16:41:05] <Manishearth> the crates need to be named right for that to work
[16:41:07] <Manishearth> PR works :p
[16:41:41] <jack> even with debug build it seems to be collapsing some of the stack trace :(
[16:43:03] <mbrubeck> Does #[inline] affect even non-optimized builds?
[16:44:03] <jack> it's #[inline(always)] :(
[16:44:05] *** Joins: caitp (caitp@moz-lmogh4.cable.rogers.com)
[16:44:09] <SimonSapin> struct Dummy<T>(T); impl<Unit> ::rustc_serialize::Encodable for PhantomData<Dummy<Unit>>
[16:45:13] *** Joins: pcwalton (pcwalton@moz-u92.384.6.71.IP)
[16:45:13] *** ChanServ sets mode: +o pcwalton
[16:45:15] <mbrubeck> nice
[16:45:53] <pcwalton> I thought of a demo that we could do that would show off Servo's off-main-thread layout
[16:46:24] <pcwalton> render a bunch of bouncing objects around the screen with simple physics using CSS transitions (interpolating between keyframes)
[16:46:39] <pcwalton> animate with absolute positioning instead of using transform
[16:46:53] <pcwalton> I'm pretty sure this would perform badly in other browsers
[16:47:14] <jack> pcwalton: https://gist.github.com/metajack/5fd22786677e4998aedc
[16:47:16] <jack> found a small test case
[16:47:26] <jack> inline_block_img_a leaks every flow
[16:47:33] <pcwalton> excellent
[16:47:46] <pcwalton> please file a bug :) I'll look into it after border-collapse
[16:47:47] <jack> I suspect a cycle in the construction results or something
[16:48:09] <pcwalton> thanks for digging into this!
[16:48:18] <pcwalton> (told you it was inline-block) ;)
[16:48:47] *** Joins: Savago (Savago@moz-h1n.mju.244.17.IP)
[16:48:49] <jack> There might be a similar leak in the other case
[16:48:55] <jack> InlineHypothetical whatever
[16:49:08] <jack> Those seem to be the only two cases where fragments contain flows.
[16:49:41] <pcwalton> petition to rename the hypothetical box in the CSS 2.1 spec to "InlineHypothetical whatever"
[16:49:44] * pcwalton hates that thing
[16:50:06] *** Quits: Savago (Savago@moz-h1n.mju.244.17.IP) (Client exited)
[16:50:14] *** Joins: chmanchester (chmancheste@moz-lmo.64e.222.162.IP)
[16:50:34] <jack> I still dont' understand how IB-splits work or how they are constructed, which is makign this difficult.
[16:50:49] <pcwalton> basically you bubble up inlines around the edges of blocks
[16:50:58] <pcwalton> â€¦inlines block block block inlinesâ€¦
[16:51:07] <pcwalton> merging inlines into blocks as you go up the tree
[16:51:11] <SimonSapin> #[deny(unused_variables)] on by default ?
[16:51:15] *** Joins: azita (Azita@moz-cfhap5.mtv2.mozilla.com)
[16:51:16] <Manishearth> playbot: let x = 1; let y = &(x = 2; 1)
[16:51:17] -playbot- <anon>:14:35: 14:36 error: expected one of `)`, `,`, `.`, or an operator, found `;`
[16:51:17] -playbot- <anon>:14         let x = 1; let y = &(x = 2; 1)
[16:51:17] -playbot- output truncated; full output at: http://bit.ly/1b58S1h
[16:51:24] <Manishearth> playbot: let x = 1; let y = &({x = 2; 1})
[16:51:24] -playbot- <anon>:15:5: 15:6 error: expected one of `.`, `;`, or an operator, found `}`
[16:51:25] -playbot- <anon>:15     });
[16:51:25] -playbot- output truncated; full output at: http://bit.ly/1E8vgh8
[16:52:52] <jack> The final flow tree is B -> B -> B -> I -> B -> I
[16:53:05] <jack> so the first I there has a fragment which points to B
[16:53:10] *** Joins: wldcordeiro (wldcordeiro@moz-h7mvf3.hmj8.a2nn.0007.2601.IP)
[16:53:50] <pcwalton> right
[16:53:55] <pcwalton> that's what I would expect
[16:54:12] <jack> the fragments are ScannedText, Image, InlineBlock
[16:55:00] <jack> which are span.red, img, and span.ib in the HTML
[16:55:09] <jack> So how is this constructed?
[16:55:36] <pcwalton> jack: what happens if you stop relying on {ib} splits?
[16:55:39] <SimonSapin> larsberg: is your clock a bit behind? rustc 1.0.0-dev (d3c49d214 2015-03-10) (built 2015-02-24)
[16:55:39] <pcwalton> i.e. add divs
[16:55:47] <jack> Since it's bottom up, each of those fragments gets constructed first right?
[16:55:55] <pcwalton> yes, each of the fragments will get constructed first
[16:55:56] *** Quits: jviereck (Adium@moz-ihn58j.97ug.g469.067c.2001.IP) (Quit: Leaving.)
[16:56:19] <jack> So they will get ConstructionItem(InlineFragments) ?
[16:56:28] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[16:56:28] -ghservo- [13rust-geom] 15SimonSapin created 06rustup_2015-03-11 (+1 new commit): 02http://git.io/pXhF
[16:56:28] -ghservo- 13rust-geom/06rustup_2015-03-11 14435a48a 15Simon Sapin: Upgrade to rustc 1.0.0-dev (d3c49d214 2015-03-10) (built 2015-02-24)
[16:56:28] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[16:56:44] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[16:56:44] -ghservo- [13rust-geom] 15SimonSapin opened pull request #72: Upgrade to rustc 1.0.0-dev (d3c49d214 2015-03-10) (built 2015-02-24) (06master...06rustup_2015-03-11) 02http://git.io/pXjv
[16:56:44] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[16:56:47] <pcwalton> yes
[16:56:54] <pcwalton> well, here's what I would expect to happen
[16:57:05] *** Joins: jviereck (Adium@moz-ihn58j.97ug.g469.067c.2001.IP)
[16:57:16] <pcwalton> 1. the first X gets an InlineFragment, the image gets an InlineFragment, the second X gets an InlineFragment
[16:57:37] <larsberg> SimonSapin: If that's linux, it's possible - it's a VMWare image and the clock doesn't like updating (despite having NTP set up)
[16:57:41] <jack> so the first will span.red will just have 1 fragment in InlineFragmentsConstructionResult.fragments
[16:57:47] *** Joins: Savago (Savago@moz-h1n.mju.244.17.IP)
[16:58:06] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[16:58:06] -ghservo- [13servo] 15SimonSapin pushed 1 new commit to 06rustup_20150311: 02http://git.io/pXjy
[16:58:06] -ghservo- 13servo/06rustup_20150311 148391a65 15Simon Sapin: Update rust-geom
[16:58:06] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[16:58:16] <jack> And img will be the same?
[16:58:57] <jack> Then what happens with the InlineBlock? It will have fragments of empty? and splits will have something?
[16:59:02] <pcwalton> 2. nothing is done for span.red; a block is constructed for span.green.ib and an inline fragment is constructed for that block
[16:59:20] <pcwalton> there should be no {ib} splits at all here
[16:59:38] <pcwalton> an {ib} split is something like
[16:59:43] <pcwalton> <span>foo<div>whatever</div>blah</span>
[16:59:57] <pcwalton> an {ib} split is not the same as inline-block
[17:00:02] <jack> ok
[17:00:07] *** Quits: dstrbad (dstrbad@moz-j6ume5.cable.xnet.hr) (A TLS packet with unexpected length was received.)
[17:00:08] <pcwalton> sorry, I didn't make the terminology, blame Netscape :)
[17:00:52] <pcwalton> finally 3. we encounter the div and create a BlockFlow and an InlineFlow underneath it, to which all the fragments are appended
[17:01:09] *** Joins: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca)
[17:01:42] *** Quits: ProgramFOX (ProgramFOX@moz-eag.sg5.176.91.IP) (Quit: ChatZilla 0.9.91.1 [Firefox 36.0.1/20150305021524])
[17:02:05] *** Quits: Savago (Savago@moz-h1n.mju.244.17.IP) (Ping timeout: 121 seconds)
[17:03:04] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[17:03:04] <ghservo> [13glutin] 15SimonSapin pushed 67 new commits to 06servo: 02http://git.io/p1fG
[17:03:04] <ghservo> 13glutin/06servo 14353567b 15Pierre Krieger: Start splitting win32::init into multiple functions
[17:03:04] <ghservo> 13glutin/06servo 14dfbf2ad 15Pierre Krieger: Extract and add create_context function
[17:03:04] <ghservo> 13glutin/06servo 146bec85e 15Pierre Krieger: Implement better handling for pixel formats
[17:03:04] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[17:03:32] <hoverbear> SimonSapin: Ping, can I PM you?
[17:03:36] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[17:03:36] -ghservo- [13servo] 15SimonSapin pushed 1 new commit to 06rustup_20150311: 02http://git.io/p1fV
[17:03:36] -ghservo- 13servo/06rustup_20150311 14b5524c0 15Simon Sapin: Update glutin
[17:03:36] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[17:03:38] <SimonSapin> hoverbear: sure
[17:03:42] <jack> I guess I need more details of how InlineFragmentConstructionResult is supposed to look.
[17:03:53] <jack> splits remains empty iti sounds like
[17:04:01] <jack> abs_descendents is empty
[17:04:26] *** Quits: laumann (thomas@moz-bcl.hq0.225.130.IP) (Ping timeout: 121 seconds)
[17:04:28] <pcwalton> yes
[17:04:38] <pcwalton> there are no absolute descendants because nothing is absolutely positioned here
[17:04:42] <pcwalton> there should be no splits
[17:04:44] <jack> so at the bottom each has a DList of 1 element for fragments, itself
[17:05:18] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[17:05:18] <ghservo> [13glutin] 15SimonSapin merged 06servo into 06master: 02http://git.io/p1JX
[17:05:18] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[17:06:05] <pcwalton> should be, yes
[17:06:22] <hoverbear> larsberg: Hi! Can I PM you?
[17:06:32] <larsberg> hoverbear: Sure :-)
[17:06:56] <jack> Where does the inline-block flow get constructed? Does it get ConstructionResult::Flow instead of InlineFragmentConstructionResult?
[17:06:58] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[17:06:58] -ghservo- [13servo] 15SimonSapin pushed 1 new commit to 06rustup_20150311: 02http://git.io/p1Uo
[17:06:58] -ghservo- 13servo/06rustup_20150311 14c13c828 15Simon Sapin: Update glutin for real.
[17:06:58] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[17:08:32] *** Quits: barosl (barosl@moz-7vg.qma.67.220.IP) (Connection closed)
[17:08:56] *** Joins: barosl (barosl@moz-7vg.qma.67.220.IP)
[17:09:31] <pcwalton> it should be an InlineFragmentConstructionResult
[17:09:52] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[17:09:52] -ghservo- [13servo] 15bors-servo pushed 7 new commits to 06auto: 02http://git.io/p1kt
[17:09:52] -ghservo- 13servo/06auto 144e5889d 15yodalee: add unit struct of TextEncoder
[17:09:52] -ghservo- 13servo/06auto 143a75882 15yodalee: implement textencoder constructor
[17:09:52] -ghservo- 13servo/06auto 14de0ba5d 15yodalee: implement encoding method, encoding name variable
[17:09:52] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[17:10:38] *** Quits: barosl (barosl@moz-7vg.qma.67.220.IP) (Connection closed)
[17:13:52] <SimonSapin> Manishearth: Iâ€™m stuck rustupping the plugins crate. Do you want to take a look?
[17:14:20] <jack> pcwalton: when does it get converted to a flow?
[17:15:03] <jack> Do kids have pointers to their parents in tehflow tee?
[17:15:17] <pcwalton> jack: build_fragment_for_inline_Block
[17:15:21] <pcwalton> jack: build_fragment_for_inline_block rather
[17:15:25] <pcwalton> and no
[17:15:26] <pcwalton> they don't
[17:16:05] <Manishearth> SimonSapin: sure
[17:16:15] <Manishearth> SimonSapin: ExprPath hounding you?
[17:16:34] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Ping timeout: 121 seconds)
[17:16:40] *** Quits: jviereck (Adium@moz-ihn58j.97ug.g469.067c.2001.IP) (Quit: Leaving.)
[17:16:42] <SimonSapin> Manishearth: things like expected u32, found syntax::ast::Path
[17:16:42] <jack> Here's a fun one:
[17:16:43] <Manishearth> SimonSapin: note, current queue:  reviewing munksgaard's changes on humpty, reviewing async net, then rustup
[17:16:45] <jack> https://www.irccloud.com/pastebin/VV89Oesk
[17:16:49] <Manishearth> SimonSapin: wut
[17:16:53] <jack> the FlowRef is created on worker1
[17:16:58] <Manishearth> SimonSapin: pastebin?
[17:17:00] <SimonSapin> Manishearth: where u32 is actually NodeId, I think
[17:17:04] <jack> somehow it gets to LayoutTask without ever being cloned
[17:17:06] <Manishearth> SimonSapin: ah
[17:17:09] <jack> and then to worker2
[17:17:19] <jack> This makes no sense at all.
[17:17:46] <Manishearth> SimonSapin: you can check the change in the function prototype by comparing doc.servo.org with doc.rust-lang.org btw
[17:17:53] <Manishearth> it will take around an hour for me to get to the rustup
[17:17:55] <jack> I guess it could be sent
[17:18:19] <SimonSapin> Manishearth: A map formerly keyed on ast::Path is now keyed on NodeId
[17:18:41] <Manishearth> SimonSapin: which map?
[17:18:50] <SimonSapin> https://gist.github.com/anonymous/e0b8cd583f5c0746d461
[17:19:07] <SimonSapin> cx.tcx.def_map
[17:19:27] *** Joins: jiojiajiu (jiojiajiu@moz-p4n.l3g.47.1.IP)
[17:19:33] <Manishearth> SimonSapin: nope, def_map was always keyed on NodeId
[17:19:37] <jack> layout clones it 3 times, (now has 4 references) and then sends one to worker2, worker2 drops, and layout task ends up holding onto one reference forever?
[17:19:40] <Manishearth> the type of ty_id has changed
[17:20:31] <Manishearth> SimonSapin: the variant TyPath was bopped around, compar ethat and fix the match arms useing it
[17:20:44] <pcwalton> jack: maybe it got moved?
[17:20:56] <pcwalton> doesn't have to be cloned to appear elsewhere
[17:21:05] <jack> pcwalton: What happens in the case where a force_reflow happens?
[17:21:13] <pcwalton> what does force_reflow do?
[17:21:18] <pcwalton> I don't know what that method does
[17:21:28] * jack goes to look
[17:21:46] <jdm> pcwalton: jack: it dirties all nodes and then triggers a reflow
[17:21:55] <pcwalton> ok
[17:22:09] <pcwalton> well, in that case, it'll probably reconstruct all flows
[17:24:22] *** Parts: narfg (chatzilla@moz-fo0095.ei.tum.de) ("")
[17:25:16] <jack> That does appear to be the case.
[17:25:43] <jack> (On my machine loading any page causes three reflows, and each flow tree has distinct pointers)
[17:26:05] <jack> I'm trying to figure out why the root Flow would ever leak
[17:27:44] *** Quits: pakupaku (pl@moz-lc4.ai6.55.193.IP) (Quit: WeeChat 1.0.1)
[17:27:55] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[17:30:11] <jack> Here are the stack traces for the very first flow tree's root flow: https://gist.github.com/metajack/d6484d80bab8db9ab58a
[17:30:25] <jdm> jack: does the leak reproduce with non-incremental layout?
[17:30:34] * jdm is looking at http://mxr.mozilla.org/servo/source/components/layout/layout_task.rs#529 and http://mxr.mozilla.org/servo/source/components/layout/construct.rs#83
[17:32:07] <jack> It appears to leak in non-incremental too.
[17:32:27] <jack> Which is excellent news for me, because I can follow that logic way easier
[17:33:05] <jack> It still seems to use a layout worker with -i
[17:33:07] <jack> wtf
[17:33:24] <jdm> jack: why wouldn't it?
[17:33:25] <jack> oh, i confused non-incremental with non-parallel
[17:33:28] *** ahal|lunch is now known as ahal
[17:33:28] <jdm> heh
[17:34:12] <jack> yay, -i -y 1 still leaks
[17:34:20] <jack> That will make this much easier to find.
[17:34:23] *** Quits: pcwalton (pcwalton@moz-u92.384.6.71.IP) (Client exited)
[17:35:45] <jack> Ok. Time for lunch, then I can come dig into this version of the stack traces which are far simpler, and I have correct sequencing to boot.
[17:38:14] <Manishearth> \o/ https://github.com/rust-lang/rust/pull/23310
[17:38:14] <crowbot> Issue #23310: debuginfo: Add GDB pretty printers for slices, Vec<>, and String. - https://github.com/rust-lang/rust/pull/23310
[17:42:22] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[17:42:22] -ghservo- [13rust-geom] 15SimonSapin pushed 1 new commit to 06rustup_2015-03-11: 02http://git.io/p18i
[17:42:22] -ghservo- 13rust-geom/06rustup_2015-03-11 14c47fc0f 15Simon Sapin: Remove work around for https://github.com/rust-lang/rustc-serialize/pull/72
[17:42:22] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[17:42:31] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[17:43:49] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[17:43:49] -ghservo- [13servo] 15SimonSapin pushed 1 new commit to 06rustup_20150311: 02http://git.io/p14W
[17:43:49] -ghservo- 13servo/06rustup_20150311 14a794b80 15Simon Sapin: Update rust-geom again
[17:43:49] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[17:44:26] <jdm> larsberg: do you know why the waterfall is giving a 502 Bad Gateway?
[17:44:50] <larsberg> jdm: I'll check - that usually means that there was a syntax error in the buildbot config and it fell over
[17:45:34] <larsberg> jdm: that was it; fixed and restarted
[17:46:03] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[17:46:03] -ghservo- [13saltfs] 15larsbergstrom pushed 1 new commit to 06master: 02http://git.io/p1BP
[17:46:03] -ghservo- 13saltfs/06master 14881c8ed 15Lars Bergstrom: Fix syntax error in master.cfg
[17:46:03] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[17:49:14] <mbrubeck> oops, sorry.
[17:49:51] <mbrubeck> Manishearth, larsberg: Any opinion on #5200 versus the alternative?  (See the GitHub comments.)
[17:49:51] <crowbot> Issue #5200: Add an environment variable to override cache-dir - https://github.com/servo/servo/pull/5200
[17:50:29] <SimonSapin> mbrubeck: So the PhantomData in rust-geom wasnâ€™t too bad in the end. The only downside is that users have to write Length::new(x) instead of Length(x), and similarly for ScaleFactor
[17:50:30] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[17:50:33] <mbrubeck> I'm leaning toward the environment variable, just because it's easier to set it in one place (well, two places) in the buildbot config.
[17:50:33] <larsberg> mbrubeck: No worries; I should have tail'd the log and noticed (I usually do!). It's hard to write any of those config files correctly by hand, which is why I usually do my edits on-server :-)
[17:50:38] <mbrubeck> SimonSapin: yay!
[17:52:15] <larsberg> mbrubeck: I like the explicit use of the servobuild config file over environment variables. We're already a bit env-var-happy on the android & gonk builds and I hate to continue down that road too much.
[17:54:10] *** Joins: barosl_ (barosl@moz-7vg.qma.67.220.IP)
[17:54:18] <mbrubeck> larsberg: Okay. On the plus side, we can also move CARGO_HOME into .servobuild
[17:54:59] <larsberg> mbrubeck: That would be nice! I was glad to have the fix (to avoid the skia download) but this solution seems great.
[17:55:02] <mbrubeck> larsberg: Is there any better way to copy a file into the working dir?  I was a bit surprised that http://docs.buildbot.net/current/manual/cfg-buildsteps.html?highlight=addstep#slave-filesystem-steps has a CopyDirectory command but no CopyFile command.
[17:55:31] <SimonSapin> Anyone knows what this new fallbacks argument is? https://github.com/bjz/gl-rs/commit/368255d830ca991b029a3b324650aaff2d2560cf#diff-13b275f071f2ff9d63e8d29d33ab6f82R118
[17:55:51] <cmr> SimonSapin: yes
[17:56:16] *** Joins: mccr8 (mccr8@moz-m84lpe.ca.comcast.net)
[17:56:18] <cmr> SimonSapin: before, gl-rs would unconditionally emit fallbacks to extension methods for core-profile methods.
[17:56:29] <cmr> this is really useful on mesa, but not universally desired.
[17:56:34] <SimonSapin> cmr: rust-glx and gleam are missing it. Should I use All or None?
[17:56:55] <cmr> SimonSapin: All
[17:57:00] <SimonSapin> cmr: I have no idea what extension methods or a core-profile is :]
[17:57:03] <SimonSapin> ok, thanks
[17:57:31] *** Quits: barosl_ (barosl@moz-7vg.qma.67.220.IP) (Quit: Leaving)
[17:57:31] *** Quits: aweinstock (aweinstock@moz-8mcrmr.us) (Quit: Lost terminal)
[17:59:51] *** Quits: fabrice (fabrice@moz-gss2en.mh2d.1ibb.0101.2620.IP) (Ping timeout: 121 seconds)
[17:59:54] *** Joins: fabrice1 (fabrice@moz-gpdte1.ujol.1ibb.0101.2620.IP)
[18:00:55] *** Joins: mcanders (textual@moz-vmcvq9.near.illinois.edu)
[18:01:27] *** Joins: ghservo (ghservo@moz-l3t.5u0.30.192.IP)
[18:01:27] -ghservo- [13saltfs] 15mbrubeck opened pull request #25: Add a .servobuild file (06master...06servobuild) 02http://git.io/p1ab
[18:01:27] *** Parts: ghservo (ghservo@moz-l3t.5u0.30.192.IP) ()
[18:01:50] *** Quits: mib_u2a1oj (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[18:03:21] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[18:03:21] -ghservo- [13rust-glx] 15SimonSapin created 06rustup_2015-03-11 (+1 new commit): 02http://git.io/p1wm
[18:03:21] -ghservo- 13rust-glx/06rustup_2015-03-11 14f210386 15Simon Sapin: Upgrade to rustc 1.0.0-dev (d3c49d214 2015-03-10) (built 2015-02-24)
[18:03:21] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[18:05:05] *** Joins: Savago (Savago@moz-h1n.mju.244.17.IP)
[18:05:16] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[18:05:16] -ghservo- [13rust-glx] 15SimonSapin opened pull request #10: Upgrade to rustc 1.0.0-dev (d3c49d214 2015-03-10) (built 2015-02-24) (06master...06rustup_2015-03-11) 02http://git.io/p1r4
[18:05:16] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[18:05:44] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[18:05:44] -ghservo- [13gleam] 15SimonSapin created 06rustup_2015-03-11 (+1 new commit): 02http://git.io/p1ri
[18:05:44] -ghservo- 13gleam/06rustup_2015-03-11 14fb17a36 15Simon Sapin: Upgrade to rustc 1.0.0-dev (d3c49d214 2015-03-10) (built 2015-02-24)
[18:05:44] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[18:05:57] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[18:05:57] -ghservo- [13gleam] 15SimonSapin opened pull request #15: Upgrade to rustc 1.0.0-dev (d3c49d214 2015-03-10) (built 2015-02-24) (06master...06rustup_2015-03-11) 02http://git.io/p1rS
[18:05:57] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[18:08:13] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[18:08:13] <ghservo> [13rust-cgl] 15SimonSapin pushed 1 new commit to 06master: 02http://git.io/p1oi
[18:08:13] <ghservo> 13rust-cgl/06master 14211afc4 15Simon Sapin: Upgrade to rustc 1.0.0-dev (d3c49d214 2015-03-10) (built 2015-02-24)
[18:08:13] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[18:09:44] <jiojiajiu>  ~
[18:10:51] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[18:11:45] *** Quits: jiojiajiu (jiojiajiu@moz-p4n.l3g.47.1.IP) (Connection closed)
[18:12:26] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[18:12:26] -ghservo- [13rust-layers] 15SimonSapin pushed 1 new commit to 06master: 02http://git.io/p16o
[18:12:26] -ghservo- 13rust-layers/06master 14df3a14d 15Simon Sapin: Update for rust-geom API change....
[18:12:26] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[18:16:59] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[18:17:44] <larsberg> mbrubeck: I typically use https://github.com/servo/saltfs/blob/master/android-dependencies.sls#L93-L98 to set up files from salt that I need there. Not sure on buildbot commands, either :-)
[18:20:11] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[18:23:19] <Manishearth> mbrubeck: I prefer the alternative
[18:25:27] *** Quits: mccr8 (mccr8@moz-m84lpe.ca.comcast.net) (Quit: computer sleep)
[18:25:28] <Manishearth> but landing this now is also okay
[18:25:32] <Manishearth> I like env vars
[18:25:48] <Manishearth> however limiting they may be, they're great for automation and all
[18:26:47] <larsberg> Manishearth: only when they're properly logged, passed through all of the various subprocesses that get created, set and unset at the appropriate magical times...
[18:26:59] <Manishearth> hah
[18:27:13] * larsberg has been bitten before by env variables
[18:27:28] <jdm> http://www.reddit.com/r/rust/comments/2ytj97/an_http2_library_in_rust/
[18:27:52] <jdm> seanmonstar: ^
[18:30:50] <seanmonstar> get him!
[18:31:00] <seanmonstar> \o/
[18:31:40] <Manishearth> jdm: doing your PR now
[18:31:45] <Manishearth> may not finish it, but we'll see
[18:31:46] <jdm> you're the best
[18:33:43] <Manishearth> lol @ the latest Reddit sidebar
[18:34:38] <kmc> bstrie++
[18:34:39] *** Joins: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca)
[18:34:47] <kmc> also he cooked me dinner last night
[18:35:21] <Manishearth> yum
[18:37:19] <seanmonstar> jdm Omg so excited. I'm finishing up faster parsing, we might have h2, and aio in the future?
[18:38:06] <jdm> big things are afoot
[18:41:08] *** Quits: ienzam (enzam@moz-0mn6nu.customer.teliacarrier.com) (Ping timeout: 121 seconds)
[18:41:47] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[18:41:47] *** ChanServ sets mode: +o pcwalton
[18:42:26] *** Quits: dbaron (dbaron@moz-rb4k89.dynamic.fusionbroadband.com) (Quit: 8403864 bytes have been tenured, next gc will be global.)
[18:44:37] <Manishearth> I wonder how much of the  costs of the inter-engine GC that brendan was talking about in HN are borne by us in our inter-language DOM dance
[18:45:44] <tomaka> Is there something new about the squatter on crates.io? :3
[18:46:08] <tomaka> what about publishing the crates with another name?
[18:46:12] * Manishearth pokes jack 
[18:47:27] <Manishearth> tomaka: http://i.imgur.com/EzqkQ2s.jpg
[18:48:03] <jdm> heh
[18:49:23] <Manishearth> we need more memes in the codebase
[18:49:36] <Manishearth> we'll truly be a modern browser then
[18:49:55] *** Joins: nrc|afk (nrc@moz-4bhi2i.xtra.co.nz)
[18:50:04] <pcwalton> I'll have you know that servo can render burritocats really well
[18:50:12] <Manishearth> +1
[18:50:22] <Manishearth> can that be out "image missing"? please?
[18:50:25] <Manishearth> *our
[18:51:41] * jdm gazed fondly upon longcat a couple weeks ago
[18:51:56] <jdm> truly those were heady days
[18:52:16] * pcwalton ponders making a longcat out of collapsed borders and using that for the border-collapse reftest
[18:52:24] <SimonSapin> pcwalton: Iâ€™m making everything 'static in util::task and util::taskpool for now, though we might want to take advantage of the more flexible Send later
[18:52:29] <Manishearth> pcwalton++
[18:52:33] <pcwalton> SimonSapin: works for me
[18:52:46] <Manishearth> SimonSapin: sshh, Important Things are being discussed ;)
[18:52:57] <pcwalton> btw, my reftest for collapsed borders is probably going to fail in Gecko and WebKit
[18:53:06] <Manishearth> SimonSapin: isn't the static bound going to die soon?
[18:53:09] <Manishearth> or something
[18:53:09] <pcwalton> which is, as far as I can tell, not a bug in Servo
[18:53:17] <pcwalton> because Gecko just doesn't seem to follow the spec
[18:53:23] <pcwalton> and WebKit probably just copied Gecko
[18:53:29] <SimonSapin> Manishearth: it is?
[18:53:41] <Manishearth> SimonSapin: i mean the necessity of the static bound on Send, sorry
[18:53:42] <pcwalton> SimonSapin: incidentally re twitter, I asked sicking in the elevator yesterday why browsers behave weirdly with border-collapse
[18:53:53] <pcwalton> he said that CSS 2.0 didn't define border-collapse very well at all
[18:53:56] <pcwalton> CSS 2.1 improved it
[18:54:01] <SimonSapin> Manishearth: right, it was implied previously, but not anymore
[18:54:09] <SimonSapin> now Iâ€™m adding it explicitly
[18:54:10] <Manishearth> SimonSapin: wait what?
[18:54:15] <Manishearth> hm, I thought it was going away
[18:54:16] <pcwalton> but I guess what happened is that browsers implemented in CSS 2.0, then CSS 2.1 came out and they only made a half-hearted attempt to conform to the new spec
[18:54:16] * Manishearth checks
[18:54:26] <SimonSapin> Manishearth: right, Send does not imply 'static anymore
[18:54:26] <pcwalton> browsers implemented border-collapse in CSS 2.0, that is
[18:54:50] *** Quits: Ms2ger (Ms2ger@moz-t9m.9ho.190.193.IP) (Ping timeout: 121 seconds)
[18:55:11] <Manishearth> SimonSapin: huh
[18:55:43] <Manishearth> I must have read that rfc inside-out or something
[18:56:33] <SimonSapin> Manishearth: in other words, &'a T could never be Send before. Now it can
[18:56:41] <Manishearth> yep
[18:57:23] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[18:58:26] *** Quits: mcanders (textual@moz-vmcvq9.near.illinois.edu) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[19:00:12] <Manishearth> jdm: that vtable dispatch on Box<AsyncResponseTarget> shouldn't affect perf there, right?
[19:00:24] <Manishearth> not at the resource fetch scale
[19:00:27] <jdm> Manishearth: right
[19:01:07] <Savago> pcwalton: display lists seems to be all the rage in this daysâ€¦ http://trac.webkit.org/wiki/March%202015%20Meeting
[19:01:36] <pcwalton> wow, I didn't think WebKit would come around :)
[19:01:39] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[19:01:47] <pcwalton> they seemed pretty committed to immediate mode
[19:01:53] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[19:01:53] -ghservo- [13servo] 15jdm closed pull request #5025: Issue4768 textencoder (06master...06issue4768-textencoder) 02http://git.io/AVgu
[19:01:53] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[19:02:17] <Savago> pcwalton: I will know more when Simon Fraser does his session on display lists.
[19:02:25] *** Joins: mcanders (textual@moz-vmcvq9.near.illinois.edu)
[19:03:01] <Manishearth> jdm: also, think our heavily-Sender-based design could later be replaced by coroutines/generators if Rust ever gets them (though that sounds doable as an extension, albeit rather tedious)
[19:03:24] *** Joins: mccr8 (mccr8@moz-cfhap5.mtv2.mozilla.com)
[19:03:46] <Manishearth> (random thoughts)
[19:03:51] *** Joins: ghservo (ghservo@moz-abh.5u0.30.192.IP)
[19:03:51] -ghservo- [13servo] 15bors-servo pushed 2 new commits to 06auto: 02http://git.io/pMk4
[19:03:51] -ghservo- 13servo/06auto 14586c12c 15Patrick Walton: layout: Implement `border-spacing` per CSS 2.1 Â§ 17.6.1 and the legacy...
[19:03:51] -ghservo- 13servo/06auto 148e81122 15bors-servo: auto merge of #4417 : pcwalton/servo/border-spacing, r=larsbergstrom...
[19:03:51] *** Parts: ghservo (ghservo@moz-abh.5u0.30.192.IP) ()
[19:03:53] *** Quits: mccr8 (mccr8@moz-cfhap5.mtv2.mozilla.com) (Connection closed)
[19:04:02] <jdm> Manishearth: I don't get how you would avoid sending data between threads?
[19:04:03] <pcwalton> Savago: really interested to see what he thinks :)
[19:04:14] *** Joins: mccr8 (mccr8@moz-cfhap5.mtv2.mozilla.com)
[19:04:23] * pcwalton is pretty happy how the border-collapse implementation is shaping up
[19:04:38] <Manishearth> jdm: No, I mean when we just want to send data between different intermediate handlers like the mime sniffer, etc
[19:04:39] <Savago> Is he a former Mozillan? He is using a Firefox t-shirt.
[19:04:42] <pcwalton> it's full of necessary complexity but it's as clean as I can make it
[19:04:43] <Manishearth> not so important now
[19:04:54] <jdm> oh
[19:04:56] <pcwalton> I think smfr is an old-time Netscape person? maybe
[19:05:03] <Savago> pcwalton: interesting.
[19:05:11] <pcwalton> roc and/or bz would know more :)
[19:05:48] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[19:05:48] -ghservo- [13servo] 15jdm reopened pull request #5025: Issue4768 textencoder (06master...06issue4768-textencoder) 02http://git.io/AVgu
[19:05:48] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[19:05:52] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[19:06:59] *** Joins: Signed (Signed@moz-d3q.ag5.190.182.IP)
[19:07:49] *** Quits: azita (Azita@moz-cfhap5.mtv2.mozilla.com) (Client exited)
[19:08:52] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[19:09:13] *** Quits: Signed (Signed@moz-d3q.ag5.190.182.IP) (Quit: )
[19:10:02] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[19:14:46] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[19:17:20] <jgraham> http://www.smfr.org/work/resume.html
[19:17:43] <jgraham> (or "yes" if you like, but there's a citation)
[19:20:40] <Manishearth> jdm: wow, lots of trait pointers
[19:20:54] *** Joins: dstrbad (dstrbad@moz-4gmhn2.dsl.iskon.hr)
[19:22:17] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[19:22:36] <jdm> Manishearth: yeeeep
[19:22:37] *** Joins: Jayflux (Jason@moz-03lsr1.as13285.net)
[19:23:03] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[19:23:09] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[19:23:13] *** Quits: mkcp (mkcp@moz-5ln.0t9.55.68.IP) (Connection closed)
[19:23:15] <Manishearth> jdm: btw, would prefer if the preflight was handled in resource_task, but that seems like the job of Fetch
[19:23:28] <Manishearth> ...which has stabilised now mostly but I don't have time to write
[19:23:43] *** Quits: dstrbad (dstrbad@moz-4gmhn2.dsl.iskon.hr) (A TLS packet with unexpected length was received.)
[19:23:55] <jdm> Manishearth: sure, but that's separate from just shifting around the existing code, right?
[19:24:11] <Manishearth> yep
[19:24:21] <Manishearth> was just commenting o nthe 'cors" task
[19:24:25] <Manishearth> *on the
[19:24:28] *** mdoglio is now known as mdoglio|afk
[19:24:33] <jdm> ok
[19:24:37] <Manishearth> I disapprove of a cors task, but till we get Fetch, meh
[19:24:46] <jdm> wait, cors task?
[19:24:47] * jdm checks
[19:24:55] <Manishearth> jdm: might have been killed later on
[19:24:57] <Manishearth> second commit
[19:25:12] <Manishearth> sorry, third
[19:25:14] <jdm> yeah, I kill it later
[19:25:34] <Manishearth> \o/
[19:26:24] <jdm> that code was literally copied from the existing code that does exactly that :)
[19:26:25] <Manishearth> 14%, lots to go, popping out for a bit now and internet's going to go in half an hour, so I might finish up tomorrow morning
[19:26:28] <Manishearth> really?
[19:26:31] * Manishearth bonks self
[19:26:47] <jdm> Manishearth: http://mxr.mozilla.org/servo/source/components/script/dom/xmlhttprequest.rs#258
[19:27:11] <Manishearth> oh, right
[19:27:15] <Manishearth> good 'ol XHR:CORS
[19:27:29] <Manishearth> past me was an idiot
[19:27:39] <Manishearth> (present me is also an idiot, but less so)
[19:27:43] *** Quits: mystor (mystor@moz-ldavpp.home3.cgocable.net) (Connection closed)
[19:27:44] * Manishearth -> brb
[19:29:03] * jdm lied, I don't kill the cors task later
[19:29:12] <jdm> there's a comment about redesigning http_fetch to do it properly
[19:34:08] *** Joins: mystor (mystor@moz-ldavpp.home3.cgocable.net)
[19:34:15] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Connection closed)
[19:34:57] *** Joins: valentin1 (icecold@moz-ufp.552.196.81.IP)
[19:34:59] *** Quits: valentin (icecold@moz-ufp.552.196.81.IP) (Connection closed)
[19:35:34] <jack> Manishearth: none. I think he's referencing Dart + JS + DOM
[19:38:36] *** Joins: crowbot1 (nodebot@moz-9u7ktu.compute-1.amazonaws.com)
[19:38:38] *** Quits: MrZeus (Orestes@moz-n8pa5v.skybroadband.com) (Ping timeout: 121 seconds)
[19:39:33] *** Quits: crowbot1 (nodebot@moz-9u7ktu.compute-1.amazonaws.com) (A TLS packet with unexpected length was received.)
[19:40:15] *** Quits: Savago (Savago@moz-h1n.mju.244.17.IP) (Client exited)
[19:43:09] *** nrc|afk is now known as nrc
[19:43:47] *** Joins: Savago (Savago@moz-h1n.mju.244.17.IP)
[19:45:12] *** Joins: dbaron (dbaron@moz-vuesma.2rkg.9kg1.0101.2620.IP)
[19:46:24] *** Joins: chc4 (chc4@moz-dc8.7km.96.65.IP)
[19:47:09] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[19:47:22] *** Joins: dstrbad (dstrbad@moz-4gmhn2.dsl.iskon.hr)
[19:47:24] *** Quits: TheHydroImpulse (TheHydroImp@moz-r25mqk.ed.shawcable.net) (Client exited)
[19:47:57] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[19:47:57] -ghservo- [13servo] 15SimonSapin pushed 5 new commits to 06rustup_20150311: 02http://git.io/pMEf
[19:47:57] -ghservo- 13servo/06rustup_20150311 14d7c9407 15Simon Sapin: More dependency updates
[19:47:57] -ghservo- 13servo/06rustup_20150311 1424d4303 15Simon Sapin: plugins builds.
[19:47:57] -ghservo- 13servo/06rustup_20150311 14ca76e2e 15Simon Sapin: util builds
[19:47:57] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[19:48:31] *** Quits: Savago (Savago@moz-h1n.mju.244.17.IP) (Client exited)
[19:48:49] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[19:48:49] -ghservo- [13servo] 15bors-servo merged 06auto into 06master: 02http://git.io/pMk4
[19:48:49] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[19:48:50] *** Joins: ghservo (ghservo@moz-0l2.5u0.30.192.IP)
[19:48:50] -ghservo- [13servo] 15bors-servo closed pull request #4417: layout: Implement `border-spacing` per CSS 2.1 Â§ 17.6.1 and the legacy `cellspacing` attribute per HTML5 Â§ 14.3.9. (06master...06border-spacing) 02http://git.io/HhuVVQ
[19:48:50] *** Parts: ghservo (ghservo@moz-0l2.5u0.30.192.IP) ()
[19:49:14] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Connection closed)
[19:50:15] *** Quits: ttaubert (uid2620@moz-6d2u0s.uxbridge.irccloud.com) (Quit: Connection closed for inactivity)
[19:51:49] *** Joins: ghservo (ghservo@moz-ij9.5u0.30.192.IP)
[19:51:49] -ghservo- [13servo] 15bors-servo pushed 7 new commits to 06auto: 02http://git.io/pMzk
[19:51:49] -ghservo- 13servo/06auto 144e5889d 15yodalee: add unit struct of TextEncoder
[19:51:49] -ghservo- 13servo/06auto 143a75882 15yodalee: implement textencoder constructor
[19:51:49] -ghservo- 13servo/06auto 14de0ba5d 15yodalee: implement encoding method, encoding name variable
[19:51:49] *** Parts: ghservo (ghservo@moz-ij9.5u0.30.192.IP) ()
[19:52:04] *** Quits: jdm (jdm@moz-j1lnh9.ckpj.s0pt.0450.2001.IP) (Quit: )
[19:53:38] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[19:53:39] *** Joins: azita (Azita@moz-cfhap5.mtv2.mozilla.com)
[19:57:25] *** Quits: cakecatz (cakecatz@moz-rqfnlo.sannet.ne.jp) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[19:59:00] *** AutomatedTester|AFK is now known as AutomatedTester
[19:59:17] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Connection closed)
[20:01:08] *** Joins: mkcp (mkcp@moz-5ln.0t9.55.68.IP)
[20:02:06] *** Joins: jlembeck (jlembeck@moz-gh926i.wa.comcast.net)
[20:03:41] *** Joins: mr_pants (Mibbit@moz-juv.9o3.252.72.IP)
[20:04:14] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[20:05:35] <jack> pcwalton: It appears that the root flow has a refcount of one at the end of layout, which si correct
[20:05:56] <jack> pcwalton: When a reflow happens, it's refcount never decreases even though a new root flow is created.
[20:08:34] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[20:09:19] <jack> Oh, he's not here.
[20:10:14] *** Quits: dstrbad (dstrbad@moz-4gmhn2.dsl.iskon.hr) (A TLS packet with unexpected length was received.)
[20:10:34] *** Joins: ghservo (ghservo@moz-l7j.5u0.30.192.IP)
[20:10:34] -ghservo- [13servo] 15SimonSapin pushed 2 new commits to 06rustup_20150311: 02http://git.io/pM6o
[20:10:34] -ghservo- 13servo/06rustup_20150311 14b32cf93 15Simon Sapin: Remove crate-level #![allow(missing_copy_implementations)] attributes....
[20:10:34] -ghservo- 13servo/06rustup_20150311 14ec8c53d 15Simon Sapin: gfx builds
[20:10:34] *** Parts: ghservo (ghservo@moz-l7j.5u0.30.192.IP) ()
[20:12:07] *** Quits: erickt (erickt@moz-4hh.6p3.217.74.IP) (Quit: leaving)
[20:12:20] *** Joins: TheHydroImpulse (TheHydroImp@moz-r25mqk.ed.shawcable.net)
[20:12:45] *** Quits: mcanders (textual@moz-vmcvq9.near.illinois.edu) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[20:12:51] *** Joins: Savago (Savago@moz-h1n.mju.244.17.IP)
[20:14:49] *** Quits: mahdi (mahdi@moz-sa5.a9p.244.151.IP) (Connection closed)
[20:15:02] *** Joins: mahdi (mahdi@moz-sa5.a9p.244.151.IP)
[20:19:09] *** Joins: ghservo (ghservo@moz-m9l.5u0.30.192.IP)
[20:19:09] -ghservo- [13servo] 15SimonSapin pushed 1 new commit to 06rustup_20150311: 02http://git.io/pM11
[20:19:09] -ghservo- 13servo/06rustup_20150311 145e88c1d 15Simon Sapin: Some compositing fixes
[20:19:09] *** Parts: ghservo (ghservo@moz-m9l.5u0.30.192.IP) ()
[20:19:36] <SimonSapin> alright, Iâ€™m stuck
[20:19:37] <SimonSapin> https://gist.github.com/anonymous/1dd758b5efa042ac0f85
[20:20:11] <SimonSapin> I think frame_tree is a Rc<FrameTree> in these
[20:20:51] *** Quits: Jackneill (Jackneill@moz-va5cuo.pool.digikabel.hu) (A TLS packet with unexpected length was received.)
[20:21:12] *** darkowlzz is now known as darkowlzz|afk
[20:23:24] *** Joins: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca)
[20:26:02] *** Joins: mcanders (textual@moz-kd3.g9o.171.216.IP)
[20:26:38] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[20:26:38] *** ChanServ sets mode: +o pcwalton
[20:26:49] <Savago> Suggestion for Servo memes: http://memegenerator.net/instance/60171266
[20:27:14] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[20:27:36] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[20:27:36] *** ChanServ sets mode: +o pcwalton
[20:28:00] <SimonSapin> haha
[20:28:23] <SimonSapin> Savago: well, they were already cool in Gecko :)
[20:28:36] <SimonSapin> Manishearth: unping for the plugins crate, I managed
[20:28:37] <Savago> SimonSapin: very true, indeed.
[20:28:38] *** Joins: recp (recp@moz-l4i.19q.27.5.IP)
[20:29:01] <Savago> SimonSapin: but I was refering to http://trac.webkit.org/wiki/March%202015%20Meeting
[20:29:11] <Savago> â€œDisplay list drawing [smfr]"
[20:29:14] *** Quits: TheHydroImpulse (TheHydroImp@moz-r25mqk.ed.shawcable.net) (Client exited)
[20:29:28] <Savago> :-)
[20:31:02] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[20:31:10] *** Joins: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca)
[20:31:59] <pcwalton> we now support 90% of the properties used by the 90% or more of websites
[20:32:10] <pcwalton> we now support 90% of the properties used by 90% or more of websites, rather
[20:32:21] <steveklabnik> :)
[20:32:27] <Savago> \o/
[20:33:27] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[20:34:24] <pcwalton> actually, that sounds much worse
[20:34:32] <pcwalton> really, 90% of the properties used by at least 10% of web sites
[20:35:18] *** Joins: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca)
[20:35:22] *** Quits: recp (recp@moz-l4i.19q.27.5.IP) (Client exited)
[20:35:42] <fabrice1> Downloading Cargo nightly: 100.3%
[20:35:56] <fabrice1> I wonder what I got in the extra .3% ;)
[20:36:30] <SimonSapin> fabrice1: we love cargo so much, we never have enough of it
[20:36:48] <steveklabnik> :)
[20:36:56] *** Joins: recp (recp@moz-l4i.19q.27.5.IP)
[20:37:18] <fabrice1> SimonSapin: yep, probably icing on the cake or something...
[20:38:04] <jack> pcwalton: So I've narrowed it down to the root flow having a refcnt of 1 after handle_reflow is finished, which is correct. But when reflow is called again, it never loses the ref even though a new root flow gets build
[20:39:03] *** Quits: recp (recp@moz-l4i.19q.27.5.IP) (Client exited)
[20:39:05] <SimonSapin> pcwalton: 10% of sites? https://twitter.com/pcwalton/status/576119338253426689
[20:39:34] <pcwalton> SimonSapin: yeah, if 10% or more of sites use a property, than Servo supports that property with 90% probability
[20:39:39] <pcwalton> that's what I mean to say
[20:40:12] <pcwalton> jack: aha! the LayoutData is full of unsafe code
[20:40:14] <pcwalton> so that explains a lot
[20:40:28] <SimonSapin> Iâ€™m stuck in the rustup btw, if anyone wants to give it a try
[20:40:36] *** Joins: TheHydroImpulse (TheHydroImp@moz-r25mqk.ed.shawcable.net)
[20:41:49] <jack> so try_get_layotu_data does constructionresult.swap_out9)
[20:42:03] <jack> which is a clone in the parallel case and a mem::replace in the non-parallel case
[20:43:01] <jack> I have no idea why that also calls set_absolute_descendants
[20:43:25] <pcwalton> hmm
[20:44:26] <jack> Lots of parts I don't get here. So with the above in mind the first use is:
[20:44:28] <jack> https://www.irccloud.com/pastebin/6T1KpKkc
[20:44:37] <jack> which swaps out the layout root and then throws it away
[20:45:22] <jack> then the very next block grabs the layout root again
[20:45:54] <jack> which should be ConstructionResult::None now
[20:46:46] <jack> Am I missing something?
[20:47:49] <pcwalton> that is weird
[20:47:58] <pcwalton> something funny is going on in try_get_layout_root perhaps
[20:48:29] <jack> I mena, many things are funny.
[20:48:41] <jack> Why do we do a swap with non-incrememntal but a clone with incremental?
[20:48:55] <pcwalton> well, we might want to reuse parts of the old flow in incremental layout
[20:49:09] <pcwalton> sometimes you want to reuse parts of an old flow in incremental layout -- this is what the "repair" series of functions do
[20:49:23] <pcwalton> for example, consider adding new fragments to the end of a text field
[20:49:49] <jack> My point is that this hides that logic way down in the guts
[20:49:50] <pcwalton> you don't necessarily want to nuke the entire flow and rebuild it from scratch
[20:50:03] <jack> If you pull out the root flow, and it's incremental, just clone and pass the old one along
[20:50:19] <jack> Now there is a code path where the stashed root flow is the old one, and a code path where it is None
[20:50:32] <pcwalton> yeah, it seems strange
[20:50:36] <pcwalton> feel free to change it
[20:50:47] <pcwalton> I dislike pretty much all of layout_task.rs anyway
[20:51:00] <jack> In any case, if it gets swapped out, how does anything work after that?
[20:51:14] <pcwalton> I'm not sure off the top of my head
[20:51:20] <pcwalton> it's been forever since I dove into that code
[20:51:55] <jack> I guess traverse_dom_preorder must stuff the layout root back in
[20:54:51] <jack> Do we set flow construction results in every node?
[20:54:58] <pcwalton> yes, we should
[20:55:11] <pcwalton> though they might have no flow construction result
[20:56:07] <jack> We have the same DOM tree for these forced reflows I hope
[20:56:48] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[20:56:49] <pcwalton> we should
[20:56:54] <jack> is the inside of an if a block boundary with respect to dropping locals?
[20:57:05] <pcwalton> yes
[20:57:29] <jack> ok, so the bug appars to be that when we call try_get_layout_node, it returns a flow with refcnt 1, but that result is discarded.
[20:57:38] <jack> and that flow is never Dropped
[20:57:53] <pcwalton> and I bet try_get_layout_node is unsafe?
[20:58:26] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[20:58:28] <jack> no, but it calls some unsafe things.
[20:58:31] <pcwalton> interesting
[20:59:10] <jack> Basically it just swaps out eh construction result on the root node
[20:59:14] <jack> That seems perfectly fine.
[20:59:16] <jack> It returns that
[20:59:30] <jack> This makes sense. But then we call reflow_all_nodes to mark everything dirty
[20:59:34] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[20:59:35] <jack> and throw away the FlowRef
[20:59:49] <jack> (It's an unused result inside of an if block)
[20:59:59] <jack> but that FlowRef is never dropped
[21:00:00] <jack> wait
[21:00:11] <jack> FlowRef has no drop flag.
[21:00:17] <jack> Why is that?
[21:00:22] <jack> And what are the ramifications of that?
[21:00:22] <pcwalton> just to save space
[21:00:26] <pcwalton> it shouldn't make a difference
[21:00:40] <pcwalton> the ramifications of that as far as the compiler is concerned is that the compiler unconditionally drops it at the end of a block
[21:00:42] <jack> How else is the compiler going to know if it's supposed to drop?
[21:00:48] <pcwalton> it just unconditionally drops it
[21:00:48] <kmc> really?
[21:00:51] <pcwalton> even if it's already dropped
[21:00:53] <pcwalton> and the idea is
[21:00:55] *** Quits: TheHydroImpulse (TheHydroImp@moz-r25mqk.ed.shawcable.net) (Client exited)
[21:00:57] <kmc> i thought the compiler zeros it and counts on the destructor to check a field
[21:01:01] <pcwalton> the Drop impl is responsible for not doing things twice
[21:01:01] <pcwalton> yes
[21:01:06] <kmc> ok, we agree
[21:01:13] *** Joins: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net)
[21:01:19] <kmc> but the destructor itself isn't responsible for zeroing, correct?
[21:01:28] <jack> That should be fine then. The destructor does check.
[21:01:33] <jack> But that destructor is never called!
[21:01:41] <kmc> if the value is moved out then the destructor is called on a zeroed value
[21:01:47] <kmc> but was never called "for real"
[21:01:51] <jack> When will the destructor be invoked?
[21:02:01] <jack> And the end of the if block or at the end of hte function?
[21:02:20] <pcwalton> should be at the end of the if
[21:02:42] *** Quits: Rym_ (y@moz-232.ad4.144.109.IP) (Ping timeout: 121 seconds)
[21:02:42] <pcwalton> I don't see anything called "try_get_layout_node" in Servo
[21:02:58] *** Joins: gw (uid31717@moz-hcr55a.charlton.irccloud.com)
[21:02:58] *** ChanServ sets mode: +o gw
[21:03:15] <jack> try_get_layotu_root
[21:03:16] <jack> sorry
[21:04:36] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[21:04:58] *** Quits: zmike (discomfitor@moz-oek0ra.ct.comcast.net) (Ping timeout: 121 seconds)
[21:05:08] <mbrubeck> jack: And is this the `if` expression you're talking about:? https://github.com/servo/servo/blob/8e811229bae6b338fabcd7df602079730c942889/components/layout/layout_task.rs#L801-L804
[21:05:23] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[21:05:27] <pcwalton> so, because it's returning the flow, I wouldn't expect the destructor to get invoked necessarily
[21:05:33] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[21:05:49] <jack> mbrubeck: exactly
[21:05:52] <mbrubeck> The flow gets moved into the closure passed to `map`
[21:05:55] <jack> it discards the result from map
[21:06:17] <mbrubeck> and should get dropped when the closure finishes
[21:06:42] <jack> I don't quite get how no drop flag works here.
[21:06:49] <jack> won't it get dropped twice?
[21:07:12] <jack> since we hvae no drop flag, we don't know if it gets dropped on a move?
[21:07:21] <mbrubeck> The destructor checks self.object.vtable and bails out if it's already null...
[21:07:49] <jack> My point is that if the refcount weren't 1, decreasing it twice would be just as bad of a bug :)
[21:08:27] <jack> So FlowRef comes into existence from swap_out in try_get_layout_root, and according to pcwalton gets unconditionally dropped at the end of hte function because no drop flag.
[21:08:32] *** Joins: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca)
[21:08:46] *** Joins: bstrie (ben@moz-avu3ju.members.linode.com)
[21:08:52] * mbrubeck is curious if anything changes if you rewrite that without a closure
[21:09:02] <bstrie> "border-spacing lands, and Servo now supports 90% of the CSS properties used by 10% or more of Web sites" <- 10% or more of websites?
[21:09:09] <mbrubeck> i.e., using match or `if let` on the Option<FlowRef> instead
[21:09:13] <jack> meanwhile, it's passed out of the function and appears in this if block. so it should get dropped at the end. it gets passed into a closure, then it will get dropped there to
[21:09:17] <jack> so that's three drops
[21:09:37] <jack> Clearly I must be wrong and have no idea about the drop flag.
[21:09:49] <pcwalton> bstrie: if 10% or more of sites use a property, than Servo supports that property with 90% probability
[21:11:31] <mbrubeck> jack: The map is returning Option<()> since the closure returns ().
[21:12:22] <mbrubeck> So ignoring the result of `map` won't cause any drop.
[21:12:36] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Ping timeout: 121 seconds)
[21:12:43] <jack> The fact remains the flowref shoudl get dropped in the closure
[21:12:45] *** Joins: bholley (bholley@moz-rvkgl6.ca.comcast.net)
[21:12:47] <jack> Right?
[21:13:07] <jack> We move FlowRef into it, and it never comes back out.
[21:16:06] * jack is testing without a closure to see if that helps
[21:16:36] *** Joins: njn (chatzilla@moz-02nu63.iinet.net.au)
[21:16:45] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[21:17:43] *** Joins: zmike (discomfitor@moz-ada.gpg.55.66.IP)
[21:17:51] *** Joins: jviereck (Adium@moz-q6h9e7.dynamic.hispeed.ch)
[21:23:43] *** Joins: TheHydroImpulse (TheHydroImp@moz-4vd.6hg.148.68.IP)
[21:24:07] <jack> Still doesn't get dropped
[21:26:02] <jack> So I added debugging to the top of handle_reflow, and to try_get_layout_root, and FlowRefs are getting created BEFORE try_get_layout_root is called for the first time.
[21:26:06] <jack> WAT?
[21:26:22] *** Joins: erickt (erickt@moz-4hh.6p3.217.74.IP)
[21:26:32] <jack> And the first swap returns a ConstructionResult::Flow
[21:29:38] <jack> nm, it probably isn't needs_reflow on the first pass
[21:31:44] <Savago> pcwalton: questionâ€¦ how image decoding is done in servo? Does it run in a another thread/task?
[21:31:59] <pcwalton> yes, it's the image cache task I think
[21:31:59] *** Quits: jviereck (Adium@moz-q6h9e7.dynamic.hispeed.ch) (Quit: Leaving.)
[21:32:03] *** Quits: psd (psd@moz-acc.mpg.78.202.IP) (Ping timeout: 121 seconds)
[21:32:32] *** Joins: laumann (thomas@moz-n9e72h.0.fullrate.dk)
[21:33:10] <jack> currently suspect he missing drop is here:
[21:33:11] <jack> https://github.com/servo/servo/blob/master/components/layout/construct.rs#L1385-L1387
[21:33:11] *** Joins: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca)
[21:33:49] <jack> When the new flow tree gets built, the root node will get its construction result set, but the old one doesn't seem to drop
[21:34:56] *** Joins: Rym_ (y@moz-232.ad4.144.109.IP)
[21:38:23] * njn watches keenly
[21:38:56] <jack> Pretty sure there is a compiler bug lurking here at this point.
[21:39:31] <gw> jack: if you're in compiler bug territory, does it make any difference if you remove inline(always) from that method?
[21:40:16] *** Quits: mahdi (mahdi@moz-sa5.a9p.244.151.IP) (Connection closed)
[21:40:18] <jack> I tried that!
[21:40:23] <jack> It didn't help :(
[21:40:37] <jack> So now I'm printing out the old ConstructionResult
[21:40:48] <jack> specifically dst.debug_id()
[21:40:53] <jack> but that is always 0
[21:41:01] <jack> so the old construction result has disappeared
[21:41:10] <jack> And therefore there is nothing to drop.
[21:42:34] <hoverbear> Oh hey cool, Hoverbear.org almost works in Servo!
[21:46:26] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[21:47:26] <jack> trait impls can't access private fields?
[21:47:48] *** Quits: palodequeso (quassel@moz-502.v1c.163.173.IP) (Ping timeout: 121 seconds)
[21:49:35] *** Quits: ahal (ahal@moz-blga2k.cpe.pppoe.ca) (A TLS packet with unexpected length was received.)
[21:50:40] *** Joins: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca)
[21:55:35] <huon> jack: they can, if they're in a scope that can access private fields (i.e. the module in which the type is defined)
[21:56:36] *** Joins: jdm (jdm@moz-4vu.06r.98.75.IP)
[21:56:36] *** ChanServ sets mode: +qo jdm jdm
[21:57:03] <jack> Ok, So every time set_flow_construction_result is called, the old value is always 0.
[21:57:13] <jack> Where are the old results going?
[21:59:23] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[22:01:33] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[22:02:03] *** Quits: mr_pants (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[22:05:40] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Ping timeout: 121 seconds)
[22:09:57] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[22:12:55] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[22:14:30] *** Quits: Siyo (Siyo@moz-dm4.ko9.32.178.IP) (Quit: Leaving)
[22:14:46] <jack> pcwalton: how long should we be storing ConstructionResults in nodes?
[22:14:51] *** Joins: Siyo (Siyo@moz-dm4.ko9.32.178.IP)
[22:15:01] <jack> until the next reflow right?
[22:15:18] <pcwalton> they need to stick around permanently so they can be reused
[22:15:25] <pcwalton> one ConstructionResult per node, though
[22:15:31] <pcwalton> well, that's not true
[22:15:41] <pcwalton> Flow construction results need to stick around indefinitely
[22:15:43] <pcwalton> other types don't
[22:16:16] *** Quits: kmicu (kmicu@moz-uga.edn.218.91.IP) (Client exited)
[22:19:20] <jack> Yeah, so where are they going?
[22:19:25] <jack> On the next reflow they are just gone
[22:19:47] *** Quits: Siyo (Siyo@moz-dm4.ko9.32.178.IP) (Quit: Leaving)
[22:19:52] *** Quits: hoverbear (hoverbear@moz-1opgd3.wireless.uvic.ca) (Quit: Time to hibernate.... ZzZz...)
[22:20:01] <jack> do we ever scrub the dom tree of them?
[22:20:07] *** Joins: Siyo (Siyo@moz-dm4.ko9.32.178.IP)
[22:20:54] <pcwalton> when the DOM node is destroyed, it should send the layout data over to the layout task to be destroyed, and then that should destroy the flow construction result
[22:21:06] *** Joins: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net)
[22:21:19] <pcwalton> BRB
[22:21:21] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[22:21:33] <jack> There's no destruction happening at all afaict.
[22:21:42] <jack> I see the same DOM pointers in each reflow
[22:22:43] *** Quits: Siyo (Siyo@moz-dm4.ko9.32.178.IP) (Quit: Leaving)
[22:23:02] <jdm> pcwalton is incorrect
[22:23:08] *** Joins: Siyo (Siyo@moz-dm4.ko9.32.178.IP)
[22:23:12] <jdm> we now separate node layout data destruction from node destruction
[22:24:01] *** Quits: Nefzaoui (nefzaoui_@moz-11u.mj3.1.197.IP) (Quit: Exit)
[22:24:07] <jdm> as of https://github.com/servo/servo/commit/611fd7a8461a27387c06786d06dd48a39c112393
[22:24:16] *** Joins: adu (ajr@moz-m9p.pdt.243.69.IP)
[22:24:47] <jdm> however, in this case they probably happen simultaneously on shutdown
[22:25:26] <jdm> however, https://github.com/servo/servo/commit/611fd7a8461a27387c06786d06dd48a39c112393#diff-24e921ef5c1fcd2522ad0fec42ffcdd3R1325 is also relevant
[22:26:09] <jdm> actually ignore the last link, it's not
[22:26:55] <jack> My code does not have htat.
[22:27:01] <jack> So I'm more confused now.
[22:27:45] <jdm> have what?
[22:28:04] <jack> the layout_data.clear()
[22:28:48] <jack> I can put in some debugging to see if reaping is happening
[22:28:57] *** Quits: bjz (bjz@moz-puppgq.tpgi.com.au) (Quit: My Mac has gone to sleep. ZZZzzzâ€¦)
[22:29:12] <jdm> ah, the clear was replaced in https://github.com/servo/servo/commit/86baef2cc0acfee669b5ffad7eca9ac10a59ad6f
[22:29:38] *** Quits: fabrice1 (fabrice@moz-gpdte1.ujol.1ibb.0101.2620.IP) (Ping timeout: 121 seconds)
[22:29:54] <gw> jack: my understanding is that dom nodes will be allocated once, and stick around until exit, flow construction results are the same (should be allocated once and re-used every reflow). the exception to this is when a flow needs to be reconstructed (e.g. if css display property changes). in that case, the previous flow construction result should be destroyed
[22:29:54] <gw> by the line you referenced in construct.rs earlier. so unless a flow needs to be reconstructed, you shouldn't see any flows destructed (or constructed) for each reflow after the initial construction.
[22:29:59] <jack> Yeah, that's what I have.
[22:30:27] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[22:30:40] <jack> gw: So what I'm seeing is that on the next reflow, when it sets the new construction result, the old one has disappeared.
[22:31:03] <gw> jack: is this with incremental construction enabled or disabled?
[22:31:09] *** Quits: laumann (thomas@moz-n9e72h.0.fullrate.dk) (Ping timeout: 121 seconds)
[22:31:09] <jack> And so that FlowRef never gets dropped, and the flow never freed.
[22:31:09] <gw> err, incremental reflow
[22:31:14] <jack> -i and -y 1
[22:31:27] <jack> nonincremntal and sequential
[22:32:44] <gw> jack: ok that does seem wrong to me. with non-incremental I would expect them to be getting dropped in that line you referenced in construct.rs. If my understanding is correct, that wouldn't explain the memory leaks with incremental reflow enabled though, right, as the flow refs shouldn't be getting destructed in incremental mode?
[22:33:25] *** nrc is now known as nrc|afk
[22:33:36] <jack> they work the same way in the dirty case for screen resizes anyway
[22:33:45] <jack> I think so anyway
[22:34:01] <jack> They should be getting dropped with *dst = result
[22:34:12] <jack> but since the old ones are no longer there, they can't :(
[22:34:42] <gw> jack: ah yes, that's true since that would force a full flow reconstruct. so you're right - both issues could be caused by the same apparent problem
[22:34:48] <jack> Either we have memory corruption or something is swapping in ConstructionResult::None somewhere
[22:36:28] <jack> https://github.com/metajack/servo/tree/memory-debug
[22:36:33] <jack> that's my branch if you want to take a peek
[22:37:14] <gw> even if it's swapping in constructionresult::none, it should still be dropping whatever was there though, right?
[22:37:20] *** Quits: gandalf (zbraniecki@moz-cp7c4m.ca.comcast.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzzâ€¦)
[22:37:22] <jack> yeah
[22:37:48] <jack> and if it's swapping something out it would have to do it not using the helper fucntions, which I have already annotated.
[22:38:26] <jack> https://github.com/metajack/servo/blob/memory-debug/components/layout/construct.rs#L1385-L1387
[22:38:29] <jack> for example
[22:38:55] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[22:39:17] <jack> I feel like something must be clearing the memory without using the correct data structures.
[22:41:44] <gw> jack: an interesting test could be running a recent ref test I added - hide_after_create.html - this sets an iframe to display:none which results in remove_compositor_layers being called. so you could trace that and make sure that is definitely executing, and then also see if the corresponding flow for the iframe that is removed gets dropped (since it should
[22:41:44] <gw> get its construction result set to none when its display property changes).
[22:42:11] <jdm> jack: could you set a watchpoint?
[22:42:14] <jack> gw: the test page I'm using is tests/ref/inline_block_img_a.html
[22:42:17] <jack> it's super simple
[22:42:37] <jack> jdm: Like flag the memory address for the layoutdata of the root node?
[22:42:42] <jdm> jack: right
[22:42:43] *** Quits: ToBeFree (tobefree@moz-782r3e.de) (Ping timeout: 121 seconds)
[22:42:51] <jdm> easiest way to figure out if it's being overwritten without our knowledge
[22:42:52] <jack> I suppose I could if I can figure out how to get to it.
[22:43:08] <jack> I need to run to take the kids to swimming lessons, but will try that next.
[22:43:26] <jdm> jack: if in doubt, just have something else print out the address and add a breakpoint call
[22:43:27] *** Quits: Siyo (Siyo@moz-dm4.ko9.32.178.IP) (Quit: Leaving)
[22:43:37] <gw> jack: well, in the hide_after_create test case, there should only ever be one call to https://github.com/metajack/servo/blob/memory-debug/components/layout/construct.rs#L1224 so you may be able to trace it that way
[22:44:01] <jack> what is child there?
[22:44:08] <jdm> http://doc.servo.org/core/intrinsics/fn.breakpoint.html
[22:44:28] *** Joins: DroidLogician (Austin@moz-9lhp5e.ca.charter.com)
[22:44:45] <gw> jack: child will actually be empty, but the line following that loop should be what clears the compositor layers and drops the iframe flow ref
[22:45:16] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[22:45:41] <jack> There's no iframes in this page
[22:45:52] <jack> and set_flow_construction_result has debugging in it.
[22:46:13] <jack> bbl
[22:46:34] <gw> jack: I was just meaning in respect to the test I mentioned, which has an iframe. any node that gets display:none will go through that path though
[22:47:14] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[22:48:37] *** Joins: palodequeso (quassel@moz-8afrdq.dhcp.embarqhsd.net)
[22:49:12] *** Joins: Siyo (Siyo@moz-dm4.ko9.32.178.IP)
[22:52:51] <Caspy7> well, many of Mozilla's Fozdem talks are up, but looks like the Servo talk isn't yet
[22:53:13] <jdm> boo
[22:53:38] *** Quits: evanfarrar (evanfarrar@moz-lftg5l.east.verizon.net) (Connection closed)
[22:55:04] <mbrubeck> mrobinson, SimonSapin: After #3618, the `BaseFlow::position` rect is a bit weird.  Its origin is the origin of the border box, but its width is the width of the margin box.
[22:55:04] <crowbot> Issue #3618: Include leading margin in inline block size - https://github.com/servo/servo/pull/3618
[22:55:36] <mbrubeck> Which seems to be fine for most code?  I guess the code that cares about the origin and the code that cares about the width are mostly disjoint.
[22:55:55] *** Joins: reem (reem@moz-e8666c.coob.q2h1.0009.2601.IP)
[22:56:52] <mbrubeck> But for RTL layout, I need to find the *left* edge of the box in physical coordinates, which means combining the origin and the size...
[22:58:23] *** Quits: reem (reem@moz-e8666c.coob.q2h1.0009.2601.IP) (Connection closed)
[23:00:13] *** Quits: mdln (mdln@moz-eo1a6k.res.bhn.net) (Ping timeout: 121 seconds)
[23:00:57] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[23:07:19] *** Quits: steveklabnik (steveklabni@moz-kkp.qlp.131.104.IP) (Ping timeout: 121 seconds)
[23:07:23] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[23:08:50] *** Quits: azita (Azita@moz-cfhap5.mtv2.mozilla.com) (Client exited)
[23:09:30] *** Joins: reem (reem@moz-bglv24.coob.q2h1.0009.2601.IP)
[23:10:46] *** Quits: reem (reem@moz-bglv24.coob.q2h1.0009.2601.IP) (Connection closed)
[23:10:56] *** Joins: dstrbad (dstrbad@moz-4gmhn2.dsl.iskon.hr)
[23:14:31] *** Joins: mib_sbnlv2 (Mibbit@moz-juv.9o3.252.72.IP)
[23:14:59] *** Quits: dstrbad (dstrbad@moz-4gmhn2.dsl.iskon.hr) (Ping timeout: 121 seconds)
[23:17:56] *** Joins: fabrice (fabrice@moz-r84lgh.ca.comcast.net)
[23:18:18] *** Quits: Savago (Savago@moz-h1n.mju.244.17.IP) (Client exited)
[23:21:15] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[23:21:38] *** Quits: mib_sbnlv2 (Mibbit@moz-juv.9o3.252.72.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:25:24] *** Quits: reem (reem@moz-2icmmi.ca.comcast.net) (Connection closed)
[23:28:16] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[23:28:16] *** ChanServ sets mode: +o pcwalton
[23:29:13] *** Quits: kaksmet (kaksmet@moz-ismsth.se.alltele.net) (Connection closed)
[23:29:53] <jdm> is it the flow_construction_result field that we're concerned with?
[23:29:57] *** Joins: reem (reem@moz-2icmmi.ca.comcast.net)
[23:30:17] * jdm has watchpoints that aren't triggering at all
[23:31:33] *** Joins: kaksmet (kaksmet@moz-ismsth.se.alltele.net)
[23:31:57] *** Quits: kaksmet (kaksmet@moz-ismsth.se.alltele.net) (Connection closed)
[23:39:01] <pcwalton> watchpoints are pretty flaky IME
[23:39:31] <jdm> my experience is the opposite
[23:40:00] *** Joins: MrZeus (Orestes@moz-fec8v7.as13285.net)
[23:42:17] <jdm> mmm, the experience of only making changes in the layout crate is so much more pleasant than the script crate
[23:42:55] <jdm> it's a full 120 seconds shorter for me
[23:43:14] <jdm> I wonder if we could split layout into stuff that depends on the DOM and stuff that doesn't...
[23:45:34] <jdm> huh, these watchpoints are totally not working for me
[23:45:36] <jdm> interesting
[23:45:43] <jdm> ...maybe lldb will work instead?
[23:47:28] *** Joins: zslayton (Mibbit@moz-0gsjuf.res.rr.com)
[23:48:36] <jdm> no improvement :(
[23:50:24] <pcwalton> sometimes making it either a hardware watchpoint or a software watchpoint works better for me
[23:50:38] <pcwalton> if it was one of them, make it the other
[23:50:48] <pcwalton> you can fiddle with the way you set the watchpoint to make it one or the other
[23:50:58] <pcwalton> if it's a hardware watchpoint, it'll say "hardware watchpoint" in GDB IIRC
[23:54:08] * jdm checks how to force a software one
[23:55:38] <jdm> hoo boy, they weren't kidding about it being slow
[23:55:47] *** Quits: Nekit1234007 (nekit@moz-vfr.64q.51.84.IP) (Quit: leaving)
[23:56:30] *** Joins: hoverbear (hoverbear@moz-csaicn.gv.shawcable.net)
[23:57:21] <Manishearth>  /me learns about software watchpoints
[23:57:33] <Manishearth> I usually just type `watch` and pray
[23:59:09] <jdm> heh
