[00:00:00] * benh would like to require digits on either side of the decimal point
[00:02:04] *** Quits: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net) (Quit: ozten)
[00:06:07] *** Quits: Florob (Florob@moz-39532932.de) (Client exited)
[00:08:10] *** Joins: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net)
[00:08:10] *** ChanServ sets mode: +ao dherman dherman
[00:10:55] *** Quits: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP) (Client exited)
[00:11:03] *** Quits: nkoep (nik@moz-FC3E2242.pool.mediaways.net) (Client exited)
[00:11:16] *** Quits: Tobbi (Tobbi@moz-CAA98E97.xxx) (Ping timeout)
[00:11:25] *** Quits: berleon (leon@moz-755E8ABA.superkabel.de) (Ping timeout)
[00:11:44] *** Quits: stvc (quassel@DDF9BE86.571456BD.9510F13D.IP) (Ping timeout)
[00:11:44] *** Quits: wting (wting@4F978BD6.5564A9BA.9510F13D.IP) (Ping timeout)
[00:11:53] *** Quits: km (quassel@moz-777F24DE.kevinmehall.com) (Ping timeout)
[00:12:01] *** Joins: stvc (quassel@DDF9BE86.571456BD.9510F13D.IP)
[00:12:03] *** Joins: km (quassel@moz-777F24DE.kevinmehall.com)
[00:12:06] <reedlepee> If the output of make check is "test result: ok. 26 passed; 0 failed; 1 ignored; 0 measured  summary of 25 test runs: 6009 passed; 0 failed; 327 ignored "
[00:12:06] *** Joins: geomyidae (quassel@DD6F7E3A.21468E9A.30200F38.IP)
[00:12:21] <reedlepee> does that mean everything went right ??
[00:12:27] *** Joins: wting (wting@4F978BD6.5564A9BA.9510F13D.IP)
[00:12:28] <dbaupp> "0 failed" so yes
[00:12:38] *** Joins: Tobbi (Tobbi@moz-CAA98E97.xxx)
[00:12:38] *** Quits: Tobbi (Tobbi@moz-CAA98E97.xxx) (Max SendQ exceeded)
[00:12:38] *** Quits: eatkinson (eatkinson@moz-261EDE03.hsd1.ca.comcast.net) (Quit: eatkinson)
[00:12:41] <reedlepee> because in the middle of compilation it gave the following error
[00:12:53] <reedlepee> error: found `return` in ident position  bogofile:1 ::abc::def::return                        ^~~~~~  error: aborting due to previous error  task '<unnamed>' failed at 'explicit failure', /home/chitra/ac/myrust/rust/src/libsyntax/diagnostic.rs:98
[00:13:01] <reedlepee> one more
[00:13:08] *** Joins: Tobbi (Tobbi@moz-CAA98E97.xxx)
[00:13:08] *** Quits: Tobbi (Tobbi@moz-CAA98E97.xxx) (Max SendQ exceeded)
[00:13:10] <reedlepee> test ext::expand::test::macros_can_escape_flattened_mods_test ... ok  <test>:1:60: 1:61 <test>:1:57: 1:58 error: macro undefined: 'z'  <test>:1 fn bogus() {macro_rules! z (() => (3+4))}fn inty() -> int { z!() }  error:                                                                      macro undefined: 'z'  ^  <test>:1 task '<unnamed>mod foo {macro_rules! z 
[00:13:22] <benh> yes, that'll mean those two are supposed/expected to fail
[00:13:38] *** Joins: Tobbi (Tobbi@moz-CAA98E97.xxx)
[00:13:38] *** Quits: Tobbi (Tobbi@moz-CAA98E97.xxx) (Max SendQ exceeded)
[00:13:39] <benh> If it says 0 failed at the end you should be good
[00:13:48] <dbaupp> reedlepee: if the output at the end is "0 failed" then it's all ok
[00:14:13] <dbaupp> (if any did fail actually, it will print out a list of the ones that failed with a heading like "Some tests failed".)
[00:16:25] *** Joins: bernard (Mibbit@moz-5729CEA7.hsd1.ca.comcast.net)
[00:16:41] <reedlepee> dbaupp: ohh ohk then i think i have completed checking whether a field should be public or private
[00:16:56] <reedlepee> and changed that field accordingly
[00:17:09] <reedlepee> dbaupp: Now i want to make a pull request
[00:17:37] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[00:17:59] *** Quits: bernard (Mibbit@moz-5729CEA7.hsd1.ca.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[00:19:15] *** kimundi is now known as zz_kimundi
[00:20:17] <reedlepee> dbaupp:could you please help me in making pull request
[00:20:36] <reedlepee> How do i go about making pull request ?
[00:21:10] <Eridius> reedlepee: https://help.github.com/articles/using-pull-requests
[00:21:16] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[00:22:34] *** Quits: blank_name (blank_name@2E4E7E43.800E1818.31EC03F3.IP) (Quit: leaving)
[00:22:53] *** Quits: johns (johns@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[00:22:54] *** Joins: johns (johns@moz-BBE3ABD.mv.mozilla.com)
[00:24:10] *** Joins: blank_name (blank_name@2E4E7E43.800E1818.31EC03F3.IP)
[00:24:30] *** Quits: canhtak (jeremy@moz-44A7DE0.wl.t.ulaval.ca) (Quit: canhtak)
[00:31:53] *** Quits: rveach (kvirc@moz-7E54B3A2.hsd1.ca.comcast.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[00:35:12] *** Joins: bleibig (bleibig@moz-CB11172C.hsd1.ca.comcast.net)
[00:36:54] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[00:37:48] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[00:38:10] *** Quits: dbaupp (Thunderbir@moz-54ADD9F4.lns20.syd6.internode.on.net) (Quit: dbaupp)
[00:38:12] *** Joins: canhtak (jeremy@moz-44A7DE0.wl.t.ulaval.ca)
[00:45:05] *** Joins: kout (agustin@moz-B88DB58B.dialup.adsl.anteldata.net.uy)
[00:45:37] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[00:48:21] *** Quits: Ferreus (ferreus@moz-BD74DCDB.pools.arcor-ip.net) (Ping timeout)
[00:49:30] *** Joins: dbaupp (Thunderbir@moz-54ADD9F4.lns20.syd6.internode.on.net)
[00:51:51] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[01:00:21] *** Joins: mib_z4vls2 (Mibbit@moz-66CCDE54.hsd1.il.comcast.net)
[01:00:29] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[01:00:43] *** Quits: mib_z4vls2 (Mibbit@moz-66CCDE54.hsd1.il.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[01:01:08] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[01:01:28] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[01:02:09] *** Joins: spott_ (spott@moz-9B11536C.hsd1.co.comcast.net)
[01:02:09] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Connection reset by peer)
[01:04:45] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[01:05:06] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[01:06:48] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[01:09:42] *** Joins: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu)
[01:12:20] *** Joins: Ferreus (ferreus@moz-80E5D971.pools.arcor-ip.net)
[01:15:28] <h3r3tic> hey, I'm having some trouble with the borrowing mechanism and mutability. I can't seem to get around borrowing things twice, and borrowck is having an issue with me. https://gist.github.com/h3r2tic/7063614#file-dep_tracker-rs-L35 <- here's one variation of my issue. and here's another: https://gist.github.com/h3r2tic/7063573#file-dep_tracker-rs-L40
[01:15:49] <h3r3tic> would anyone be so kind and enlighten me what the rustic way of dealing with these issues is?
[01:17:10] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[01:17:33] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Client exited)
[01:18:13] <h3r3tic> the former example should be quite simple to understand. I have a graph structure where the nodes sit in a hashtable, as values. they're linked via arrays of strings which are keys into this hash table. I'd like to propagate some state through it, but I can't even get a mutable ref to a node, as iterating over nodes borrows the hash table as mut already
[01:19:40] <dbaupp> you're mut-borrowing from `files` twice, which is invalid, as the compiler can't prove that the two &mut's don't overlap
[01:20:17] <h3r3tic> yeah, the compier is telling me just that. is there some sort of a pattern to get around that?
[01:20:33] <h3r3tic> I may be stuck in a C mindset, but I was expecting this to just work
[01:20:44] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Quit: Konversation terminated!)
[01:21:00] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[01:21:05] <dbaupp> does propagate_mod_state use `self.files`?
[01:21:09] <devbug> h3r3tic: aren't you that guy who made an engine called nucleus or something? (in D)
[01:21:17] *** Quits: lkuper_ (lkuper@moz-C0CD33ED.hsd1.in.comcast.net) (Ping timeout)
[01:21:30] <h3r3tic> dbaupp: yup, it does
[01:21:32] *** sam113101_afk is now known as sam113101
[01:21:33] <h3r3tic> devbug: yup!
[01:21:39] <dbaupp> h3r3tic: using @mut everywhere (rather than) &mut would work
[01:21:45] <dbaupp> but that's ugly
[01:22:07] <devbug> h3r3tic: Your site.
[01:22:11] <devbug> Malware, malware everywhere.
[01:22:17] <devbug> Also, I'd love that GUI lib in C
[01:22:57] <dbaupp> h3r3tic: (I don't really have the brain energy/time to devote to fighting borrowck right now, sorry :( )
[01:23:10] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Ping timeout)
[01:23:52] *** Quits: Earnestly (earnest@moz-BE290A2B.dyn.plus.net) (Ping timeout)
[01:24:07] <h3r3tic> dbaupp: kay... thanks anyway. I tried changing stuff to @mut, but to no avail. the hash table functions return &-references anyway, so that prevents me from switching to @-everything
[01:24:52] <h3r3tic> devbug: you mean it still contains some? I pretty much nuked all PHP from the server, so it shouldn't have any malware right now. not going to touch PHP ever again. some automated wordpress exploit got me.
[01:24:59] <h3r3tic> devbug: and thanks :) but it was a D GUI lib!
[01:25:18] <devbug> h3r3tic: perhaps
[01:25:38] <h3r3tic> dbaupp: oh, unless I make the hashtable store @refs as well. will try that.
[01:25:46] <devbug> I'm just too scared to every go back, now.  Also, that doesn't change the fact I still want it in C.
[01:26:03] <h3r3tic> haha
[01:26:41] <devbug> What was it called, again?
[01:26:52] <devbug> It's not on your BB or GH
[01:27:40] *** Quits: q66_ (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[01:28:44] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: Leaving.)
[01:29:09] <h3r3tic> devbug: bb? gh? wut?
[01:29:18] <devbug> h3r3tic: bitbucket, github
[01:29:43] <eddyb9> headbucket
[01:30:26] <h3r3tic> oh, it is, but in a funny place: https://bitbucket.org/h3r3tic/boxen/src/76f3fab1b8897afb00fff48ed749b8b95fd46611/src/xf/hybrid?at=default
[01:30:41] *** Quits: Ferreus (ferreus@moz-80E5D971.pools.arcor-ip.net) (Quit: WeeChat 0.4.2)
[01:30:47] <devbug> eddyb9: slash > headbucket
[01:31:21] <devbug> h3r3tic: What's boxen?
[01:31:23] <devbug> Your game?
[01:31:46] <h3r3tic> devbug: it was going to be a battlefield-like multiplayer game; before I gave up on D,that is
[01:32:06] <devbug> h3r3tic: ah
[01:34:25] *** Joins: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP)
[01:34:47] <steven_is_false> Hello. I think I'm misunderstanding the method try_recv for Port types.
[01:35:05] <benh> maybe you're looking for peek() :D
[01:35:28] <steven_is_false> If a task that is the only one owning the corresponding Chan dies the try_recv should return None right?
[01:35:38] *** Quits: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP) (Ping timeout)
[01:35:45] <benh> I think so, yeah
[01:35:47] *** Quits: hjr3 (hradtke@1A0AE795.28A5F6C3.A2D40ED2.IP) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[01:36:18] *** Joins: Ownerp (chatzilla@moz-FA25971E.hsd1.ca.comcast.net)
[01:36:30] <h3r3tic> dbaupp: okay, I've managed to insert just enough @mut in places to make it work xD thanks!
[01:37:04] <cmr> h3r3tic: you might bump heads with nmatsakis about it?
[01:37:15] <steven_is_false> I think I know what the problem is.
[01:37:42] <steven_is_false> I have a SharedChan and I don't all of my tasks are quitting.
[01:37:57] *** Quits: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu) (Ping timeout)
[01:38:14] *** Joins: ozten (ozten@moz-DD3B00B4.hsd1.wa.comcast.net)
[01:38:15] *** Joins: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu)
[01:38:18] <Eridius> What's the precedence on `as`?
[01:38:22] <Eridius> I know it's relatively tight, but now tight?
[01:38:24] <Eridius> s/now/how/
[01:38:24] <benh> Eridius: 'confusing'
[01:38:49] <Eridius> benh: yeah, I have some old code that used .to_uint(), but that now returns Option<uint> (even though the source type is a u8! It can't possibly fail)
[01:38:55] *** Parts: Ownerp (chatzilla@moz-FA25971E.hsd1.ca.comcast.net) ()
[01:38:56] <h3r3tic> cmr: good idea! nmatsakis: uh oh, please make my naive multi-mut-borrowing code work! ktnxbai. https://gist.github.com/h3r2tic/7063614#file-dep_tracker-rs-L35    https://gist.github.com/h3r2tic/7063573#file-dep_tracker-rs-L40
[01:39:17] <benh> Eridius: I knew where to look it up at some point though..
[01:39:45] <Eridius> my impression is that it binds tighter than anything outside of method calls and unary - (and maybe unary !), but I'd like to know for sure
[01:40:38] <benh> syntax::ast_util says it's precedence 12, which is higher than any binop
[01:40:56] <Eridius> thanks
[01:41:02] <benh> Not sure where unary operators come in though :(
[01:42:45] <Eridius> I think unary operators are parsed higher than binary
[01:43:03] <Eridius> as in, a binary operator requires two operands, which may be the result of unary operators themselves
[01:43:03] <dbaupp> cmr: do you happen to know if servo uses extra::url ?
[01:43:27] <benh> yeah, parse_binops calls parse_prefix_expr
[01:43:55] <Eridius> honestly, everyone says 'as' is confusing, but that's just because it's unusual. I think if we simply had good documentation it would become less confusing
[01:44:00] <cmr> dbaupp: it does.
[01:44:04] <Eridius> because "binds tighter than any binary operator" is relatively straightforward
[01:44:23] <benh> I think it might have changed at some point?
[01:44:24] *** Quits: spott_ (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[01:44:25] <dbaupp> cmr: thanks
[01:44:39] <cmr> dbaupp: it might not, once their string story gets straightened out.
[01:44:45] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[01:45:31] <cmr> Does anyone have announcement for This Week in Rust?
[01:45:34] <dbaupp> cmr: it's just for https://github.com/mozilla/rust/pull/9969/files#diff-0f02843aa6be409955fbc65c6cb84d36R24
[01:45:47] <benh> cmr: mention the gnome opw thing? :)
[01:45:54] <cmr> benh: check
[01:46:17] <Eridius> cmr: path rewrite landed! \o/
[01:46:19] <benh> i think that's all i noticed re: rust this week ;)
[01:46:19] <dbaupp> cmr: "exercism" is getting a full rust suite (https://github.com/kytrinyx/exercism.io/pull/866)
[01:46:30] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[01:46:50] <Eridius> dbaupp: woo! I've had exercism.io open in Safari for at least 2 weeks now, with me intending to give them a set of Rust exercises
[01:46:53] <Eridius> glad to see laziness pays off!
[01:49:17] *** Quits: kout (agustin@moz-B88DB58B.dialup.adsl.anteldata.net.uy) (Quit: WeeChat 0.4.2)
[01:49:19] <benh> thanks for asking about the precedence of `as`, I think I grok the parser a bit better now :v
[01:49:57] <Eridius> noooo, I just realized raw strings aren't very usable when I want to have \n in there
[01:50:18] *** Joins: elifrey (peripateti@moz-B5928FE2.hsd1.wa.comcast.net)
[01:50:49] <Eridius> it's a shame format!() doesn't understand the same set of escapes regular strings use
[01:50:56] <Eridius> because then format!(r"foo\nbar")) would work
[01:51:07] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[01:51:08] <benh> yeah, but then printing a literal \n gets even harder
[01:51:17] <Eridius> benh: you can't put \n in a format!() string already
[01:51:21] <Eridius> because it treats \ as an escape char
[01:51:24] <Eridius> specifically for \{
[01:51:28] <benh> oh, right
[01:51:31] <benh> argh!
[01:51:37] <dbaupp> rusti: format!("foo{}bar", '\n')
[01:51:38] -rusti- ~"foo\nbar"
[01:51:41] <dbaupp> it's fine :P
[01:51:44] <Eridius> dbaupp: ewww :P
[01:51:55] <benh> Still not a fan of format treating \ specially :(
[01:52:18] <Eridius> benh: tbh neither am I, but as long as it does it, we may as well make it handle the same escapes the compiler does
[01:52:19] <dbaupp> rusti: println!(r"foo{n}bar{n}baz", n='\n') // this is "better"
[01:52:19] -rusti- foo
[01:52:20] -rusti- bar
[01:52:20] -rusti- baz
[01:52:20] -rusti- ()
[01:52:21] <benh> Eridius: In that case I am gonna say that I think I heard format! interpreting \n etc was the plan all along
[01:52:49] <strcat> Eridius: can you just make it multi-line?
[01:53:04] <Eridius> strcat: that's ugly in the code
[01:53:08] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[01:53:19] <strcat> make it a top-level static then ;p
[01:53:20] <benh> Eridius: I think we should make string literals rectangular
[01:53:37] <Eridius> benh: would still be ugly. The \n is the last thing in the string
[01:53:38] *** Joins: ziad (Mibbit@moz-5729CEA7.hsd1.ca.comcast.net)
[01:53:42] <benh> point
[01:54:00] <Eridius> #2249 (finish the polish on format!) says nothing about more escapes
[01:54:16] <Eridius> although that was originally intended for fmt!
[01:54:17] <ziad> Hello all
[01:54:27] <benh> I think it came up after raw strings were decided on
[01:54:40] <Eridius> well I'm not finding an issue for it, so I guess I'll file one
[01:54:44] *** Joins: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca)
[01:54:44] <benh> It's probably a good plan to-- yeah
[01:54:47] <ziad> let x: [int] = [1,2,3];  // error: bare `[]` is not a type
[01:54:55] <ziad> whereas, let x = [1,2,3]; works fine
[01:54:59] <ziad> how come?
[01:55:20] <benh> make sure not to file a PR tho, it sounds like a good first contribution for all the gnome opw applicants we're sure to get >:]
[01:55:21] <strcat> ziad: the type of [1, 2, 3] is [int, ..3]
[01:55:24] <cmr> ziad: the type on that second part is [int, ..3]
[01:55:46] <strcat> rusti: std::mem::size_of::<[u32, ..3]>()
[01:55:47] -rusti- 12u
[01:55:54] <ziad> strcat: thank you
[01:55:58] <strcat> rusti: std::mem::size_of::<[u32, ..6]>()
[01:55:58] -rusti- 24u
[01:56:02] <ziad> is there a way to print the type of a variable?
[01:56:07] <ziad> similar to size_of
[01:56:10] <ziad> type_of?
[01:56:13] <Eridius> filed as 9970
[01:56:15] <strcat> ziad: it's well hidden, but yes
[01:56:17] <strcat> ;p
[01:56:19] <Eridius> ziad: trigger a compiler error regarding the type!
[01:56:33] <ziad> Eridius: sounds good :)
[01:56:33] <Eridius> let x: () = val_to_be_typed;
[01:57:28] <ziad> Another question, if we have a `fn foo() -> SomeStruct`
[01:57:39] <ziad> is SomeStruct returned by value (i.e. copied?)
[01:57:42] <benh> (hm, maybe in lieu of switching to a proper formal grammar and generating a parser for that, we could just create a neat grammar flowchart out of a call graph for the parser module ;)
[01:57:43] <ziad> or does the compiler move it
[01:57:54] <ziad> ala C++'s move constructors
[01:58:09] <benh> it'll be a shallow copy in either case
[01:58:20] <dbaupp> Eridius: https://github.com/mozilla/rust/issues/9970 would be improved by a code example :)
[01:58:45] <ziad> Wouldn't the compiler be able to move it instead of copying?
[01:58:50] <dbaupp> ziad: it's "returned" by an out pointer
[01:58:58] <dbaupp> (a move is a shallow copy (ala memcpy))
[01:59:17] <benh> sorry, i should have said it won't be a deep copy :)
[01:59:30] <Eridius> dbaupp: pfffft, fine :P
[01:59:41] <dbaupp> the *only* difference between a move and an "implicit copy" is the former means that the source is unusable
[01:59:56] *** Joins: aegeaner (Aegeaner@83533B47.BD9EA362.4446104D.IP)
[02:00:07] <dbaupp> (i.e. the compiler doesn't let you use the source again)
[02:00:20] <ziad> So it will still incur a pointer dereference in the callee later on?
[02:00:21] *** Quits: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP) (Connection reset by peer)
[02:00:22] <dbaupp> (although to be 100% correct, you are allow to completely reassign the source)
[02:00:27] *** Quits: elifrey (peripateti@moz-B5928FE2.hsd1.wa.comcast.net) (Quit: WeeChat 0.4.0)
[02:00:37] <strcat> ziad: rust does have copy/move constructors
[02:00:56] <strcat> all types can be copied via a memcpy, types with a destructor move ownership when you do that
[02:01:22] <Eridius> dbaupp: done
[02:01:27] <strcat> returning large objects is via the platform's usual ABI (an out pointer)
[02:01:37] <strcat> it just writes them to a ptr that's passed in
[02:02:19] <ziad> hmm
[02:02:34] <ziad> if we have a Point::new() -> Point { }
[02:02:38] <benh> strcat: does it do some flow sensitivity to figure out that an object that's inevitably returned can be constructed into the out-ptr right away, or is it a shallow copy into the out-ptr right when it returns?
[02:02:58] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[02:03:09] <ziad> the returned Point will be shallow copied, (say it has x,y,and z coords)
[02:03:15] <benh> "it" probably being some llvm pass or other, i'm completely ignorant how that works :(
[02:03:20] <ziad> each one of them will be copied on the stack, did I get that right?
[02:03:32] <dbaupp> ziad: no
[02:04:01] <ziad> hmm, then?
[02:04:06] <dbaupp> if you do `let on_the_stack = Point::new();` then the x y and z coords are written (via the out pointer) directly to `on_the_stack.x` etc
[02:04:07] *** Quits: reedlepee (Mibbit@EC9A78E6.3CAE2EA8.9D59D0D8.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[02:04:28] <ziad> ah, I see
[02:04:45] <dbaupp> if you do `let on_the_heap = ~Point::new()` then the malloc occurs and that pointer passed as the out pointer, and the x y z written to the appropriate places directly on the heap
[02:04:50] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[02:05:12] <ziad> and, if for some reason I wanted an entire copy. I would just do `return Point{x, y}.clone();`?
[02:06:05] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[02:06:10] <benh> what for?
[02:06:21] <ziad> just for the sake of argument
[02:06:22] <ziad> :)
[02:06:31] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[02:06:45] <benh> I wouldn't be sure that that copy doesn't get optimized away, so I dunno
[02:06:54] <ziad> gotcha
[02:07:05] <ziad> what about `let x = &Point{x, y}`
[02:07:22] <ziad> x's type is now &Point
[02:07:22] <dbaupp> that's the same as `let tmp = Point { .. }; let x = &tmp;`
[02:07:40] <ziad> so, any subsequent accesses via `x` would result in a pointer deref, right?
[02:07:50] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[02:08:08] <dbaupp> depends what LLVM does
[02:08:40] <strcat> benh: well, LLVM knows how to write directly into it
[02:08:51] <strcat> benh: because I made the parameter tagged as sret so it knows it's a valid ptr
[02:08:56] <strcat> and won't trap
[02:09:06] <ziad> so that is not part of the language standard then
[02:09:15] <ziad> it's up to the compiler
[02:09:23] <strcat> which part?
[02:09:36] *** Quits: aegeaner (Aegeaner@83533B47.BD9EA362.4446104D.IP) (Quit: Leaving.)
[02:09:43] <ziad> doing let p = &Point{ }
[02:09:43] <strcat> how it passes stuff is just determined by the platform's ABI because rust uses cdecl atm
[02:10:00] <cmr> http://128.153.202.194:4000/blog/2013/10/19/this-week-in-rust/
[02:10:05] <cmr> Suggestions before I deploy it?
[02:10:15] <ziad> so now p.x += 1, is that the same as (*p).x += 1?
[02:10:21] <ziad> (i.e. pointer deref hit)
[02:10:34] <strcat> ziad: no, there will be no actual performance loss
[02:10:43] <strcat> ziad: you can't directly map C or Rust to actual operations on the hardware
[02:10:53] <ziad> I see
[02:11:03] <strcat> C and Rust both exist in a virtual world where pointers aren't just addresses, and the compiler can make a lot of assumptions about aliasing and so on
[02:11:17] <Luqman> cmr: maybe put a comma to separate the names of new contributors?
[02:11:22] *** Joins: aegeaner (Aegeaner@83533B47.BD9EA362.4446104D.IP)
[02:11:25] <cmr> Oh
[02:11:31] <cmr> Those were supposed to be separate lines
[02:11:36] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[02:11:46] <strcat> (for example, C forbids doing pointer arithmetic past the end of an object - not just dereferencing a dangling pointer, *creating* one)
[02:11:50] *** Quits: aegeaner (Aegeaner@83533B47.BD9EA362.4446104D.IP) (Quit: Leaving.)
[02:12:34] <benh> cmr: hm, how is jemalloc being gone a breaking change?
[02:13:11] <benh> would people have been relying on it being there and using the non-standard jemalloc api in their rust programs directly?
[02:13:25] <Eridius> so why did jemalloc go away again?
[02:13:35] <ziad> strcat: I just was trying this out:
[02:13:41] <ziad> struct Point {x: int, y: int} 
[02:13:48] <ziad>   let mut p = &Point{x: 1, y: 2};
[02:14:02] <ziad>     p.x += 1; //error: cannot assign to immutable field
[02:14:05] <cmr> benh: good question, moved.
[02:14:11] <cmr> Eridius: https://github.com/mozilla/rust/issues/9925
[02:14:12] <ziad> whereas if I remove the '&', it works fine
[02:14:14] <strcat> ziad: & is an immutable reference
[02:14:21] <ziad> ah, yes
[02:14:30] <strcat> ziad: making the variable mutable means you can assign another reference to it
[02:14:31] <ziad> works now :)
[02:14:34] <ziad> &mut
[02:14:37] <ziad> thanks
[02:14:43] <strcat> inherited mutability stops at ownership boundaries basically (@, &, and so on)
[02:14:51] *** sam113101 is now known as sam113101_afk
[02:15:23] <Eridius> strcat: slices being represented as number of elements, not bytes, is a breaking change
[02:15:30] <Eridius> for anyone who's using cast::transmute()
[02:15:36] <Eridius> to transmute between slices of differing types
[02:15:51] <strcat> you mean cmr 
[02:15:54] <Eridius> ..err yeah
[02:16:01] <Eridius> dammit you two have the same coloring in my irssi right now
[02:16:02] <Eridius> cmr: ^
[02:16:32] *** Joins: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP)
[02:16:42] <strcat> fwiw you can still transmute them, just have to divide or multiply the len ;p
[02:16:58] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[02:17:06] <cmr> Eridius: moved
[02:17:14] <strcat> still going to be faster, since with the old representation there was going to be a division on every bounds check or length comparison
[02:17:30] <strcat> a[3] would have to divide the byte length by the size
[02:17:41] <strcat> can't multiply the index, because it might overflow (it did that... but I fixed it)
[02:19:12] <Eridius> cmr: was the big Option method name last week?
[02:19:57] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[02:20:00] <cmr> Eridius: yeah
[02:20:04] <Eridius> ok
[02:20:07] <Eridius> in that case, lgtm
[02:20:14] *** Quits: brson (brson@981AA104.E81F12CD.76F66111.IP) (Quit: leaving)
[02:21:17] *** Quits: zz_kimundi (kimundi@moz-D33AF750.dip0.t-ipconnect.de) (Ping timeout)
[02:23:23] *** Joins: ambimorph (amber@moz-F1964F26.hlrn.qwest.net)
[02:23:37] <cmr> thanks :)
[02:23:43] <cmr> (No typos this week!!)
[02:24:22] *** Joins: zz_kimundi (kimundi@moz-F488EB60.dip0.t-ipconnect.de)
[02:24:30] <Eridius> whoa, I had no idea there was serious talk of removing brackets on attributes
[02:24:33] <Eridius> that looks _really_ ugly to me!
[02:24:37] <cmr> http://cmr.github.io/blog/2013/10/19/this-week-in-rust/
[02:24:49] <Eridius> I thought people just wanted to kill the trailing ; and instead use a prefix
[02:24:49] *** zz_kimundi is now known as kimundi
[02:25:21] <Eridius> I don't mind current syntax, but I have no real objection to something like `#^[foo = "bar"]`. But `#^ foo="bar";` is seriously nasty
[02:28:45] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[02:28:57] <dbaupp> Eridius: I think the = syntax is slated for removal (incidentally)
[02:29:34] <Eridius> eh, I don't mind killing that. I assume in favor of `foo("bar")`?
[02:29:44] <dbaupp> yeah, something like that
[02:29:53] <dbaupp> cmr: "include_bin! has been optimized, and the k-nucleotides benchmark now compiles 187x faster." ... and actually compiles
[02:30:34] <Eridius> dbaupp: I thought it compiled before, it just had to read from an external file?
[02:30:40] *** Joins: eatkinson (eatkinson@moz-261EDE03.hsd1.ca.comcast.net)
[02:30:52] <cmr> dbaupp: it compiled, but didn't link.
[02:30:58] <cmr> (I thought)
[02:31:11] <dbaupp> Eridius: well, yes, the comparison was the include_bin!versions before and after
[02:31:19] <dbaupp> cmr: details (but ok)
[02:31:27] <Eridius> ah
[02:31:47] <benh> I'm really having issues with #^, I don't even know why
[02:31:47] <dbaupp> cmr: new contributors is nice :)
[02:31:59] *** sam113101_afk is now known as sam113101
[02:32:28] <ziad> let p = &mut Point{x: 1, y: 2};  println!("{:?}", p); // Does NOT generate warning that "variable does not need to be mutable"
[02:32:30] <dbaupp> cmr: "A bunch of people have already come into IRC about it." more than just reedlepie?
[02:32:32] <ziad> is this an issue?
[02:32:49] <cmr> ziad: the variable isn't mutable.
[02:32:59] <cmr> dbaupp: yes!
[02:33:06] <ziad> it does not have to be a mutable pointer though
[02:33:08] <cmr> dbaupp: I don't have names, but I've seen more than reedlepie
[02:33:09] <dbaupp> cmr: awesome!
[02:33:13] <ziad> it can just be a &Point{}
[02:33:19] <strcat> ziad: there could be a lint for mutable references that could be immutable but I don't think it's common
[02:33:21] <ziad> wouldn't it be a good idea to detect that too?
[02:33:28] <cmr> ziad: sure, if it can prove it's never mutated and doesn't escape, a lint could do that.
[02:33:43] <ziad> sounds good
[02:34:10] *** Quits: paulproteus (quassel@199.199.210.158) (Ping timeout)
[02:34:14] *** Quits: tefter (tefter@B5D119DC.B856A0A1.73804765.IP) (Quit: Leaving)
[02:34:28] <dbaupp> Eridius: "I knew people wanted to remove the trailing ; on outer attributes", inner attributes are the ones with ;
[02:34:40] <dbaupp> #[outer] fn blah() { #[inner]; }
[02:34:54] <Eridius> dbaupp: oops
[02:35:28] <Eridius> dbaupp: now there's no record it ever happened...... (except the emails ya'll got)
[02:36:09] <dbaupp> Eridius: and the irc logs
[02:36:43] * dbaupp links https://botbot.me/mozilla/rust/msg/7063182/ everywhere he can
[02:36:45] <Eridius> (╯°□°）╯︵ ┻━┻
[02:36:50] *** Joins: paulproteus (quassel@458FE134.3EC36C88.CBDCF1DC.IP)
[02:36:54] <benh> those darn emails
[02:37:14] <benh> I wish github did something like delay them by five minutes, then use the most recently edited version and collapse multiple messages for the same issue or something!
[02:38:10] <benh> (and while it's at it it shouldn't show multiple "this issue was referenced in a commit" messages for the "same" commit after rebasing and force-pushing :( )
[02:41:00] <steven_is_false> Is there code for a sleep or recv function yet?
[02:41:49] <dbaupp> rusti: std::rt::io::timer::sleep(2000);
[02:41:52] -rusti- ()
[02:42:45] <steven_is_false> dbaupp: I want timer.sleep_or_recv(2000, my_port);
[02:42:59] <dbaupp> steven_is_false: oh
[02:43:03] <dbaupp> don't think so
[02:43:08] <steven_is_false> Okay
[02:43:16] <dbaupp> you could hack something up with select though
[02:43:19] *** Quits: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com) (Client exited)
[02:43:21] <dbaupp> although it'd be an ugly hack
[02:43:40] *** Joins: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com)
[02:43:56] <dbaupp> spawn a new task that sleeps for 2000 and sends None to a port, and the other (real) port sends Some(value), and you select on them
[02:44:06] <benh> How do you wake the task that's blocking on recv after the timeout happens?
[02:44:20] <steven_is_false> dbaupp: Yeah but how do you get the task to quit?
[02:44:34] <dbaupp> steven_is_false: which task?
[02:44:37] <dbaupp> the sleeping one
[02:44:38] <dbaupp> you don't
[02:44:40] <steven_is_false> I guess I should just make it a daemon task in the first place.
[02:45:02] <dbaupp> just let it sleep in the background and use .try_send to it doesn't crash if the stream gets closed
[02:45:08] <dbaupp> (assuming try_send exists)
[02:45:33] *** Quits: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com) (Ping timeout)
[02:45:36] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[02:45:37] <benh> oh, i thought you were suggesting an extra task that reads out of the port in the original and packs the result in another layer of Option 
[02:46:26] <dbaupp> that'd work too
[02:46:37] <benh> I don't think it will!
[02:46:43] <dbaupp> (like, you'd need some way for the data to get into the Option<T>?)
[02:47:07] <benh> The extra task will receive something even after the caller already stopped blocking because the timeout happened?
[02:47:35] <benh> unless it is also using select I guess but I think it's a bit too complicated for me now
[02:47:50] <steven_is_false> dbaup: Something like? do task::spawn { loop { task::sleep(DELAY); chan.send(()) } } 
[02:47:57] <dbaupp> presumably that extra task would .try_send it, which would fail, and then just continue
[02:48:35] <dbaupp> steven_is_false: well, if you want to select on it, you need your selectees to all have the same type, which in this case would have to be Port<Option<ActualData>>
[02:48:46] <dbaupp> so the timeout stream would just be sending None
[02:48:54] <dbaupp> and the actual data stream would be Some(actual_data)
[02:49:16] <Eridius> uh oh. I just found a use of cast::transmute() to cast between slice sizes
[02:49:30] <Eridius> std::rand::isaac::IsaacRng::new()
[02:49:47] <ziad> Speaking of Option<>, there does not seem to be a flatten() method on it. It should be easy to implement. What's the protocol for a feature suggestion, or to see if there is a consensus? Opening another issue?
[02:50:07] <Eridius> ziad: what is flatten()?
[02:50:13] <dbaupp> Eridius: whoops, forgot about that one when talking to strcat
[02:50:54] <steven_is_false> ziad: It'd be like fn join<T>(x: Option<Option<T>>) -> T?
[02:51:07] <steven_is_false> That'd be useful.
[02:51:12] <Eridius> why would you construct such a beast?
[02:51:14] <dbaupp> Monads \o/
[02:51:28] <ziad> Eridius, steven_is_false: yep
[02:51:47] <Eridius> what about Option<Option<Option<T>>>? Your flatten() can't kill all options at once
[02:52:03] <ziad> hold on, I'm testing int out in scala :)
[02:52:03] <Eridius> actually, maybe with some trait trickery
[02:52:06] <dbaupp> rusti: Some(Some(1i)).map_default(None, |x| x)
[02:52:07] -rusti- Some(1)
[02:52:10] <ziad> Option(Option(3)).flatten => Some(3)
[02:52:12] <dbaupp> rusti: Some(None).map_default(None, |x| x)
[02:52:14] -rusti- pastebinned 12 lines of output: http://ix.io/8CF
[02:52:15] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[02:52:21] <dbaupp> rusti: Some(None::<int>).map_default(None, |x| x)
[02:52:21] -rusti- None
[02:52:32] <dbaupp> rusti: None::<Option<int>>.map_default(None, |x| x)
[02:52:32] -rusti- None
[02:52:33] <ziad> it just goes 1 level
[02:52:38] *** Joins: nwmcsween_ (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[02:52:39] <dbaupp> there ^
[02:52:51] *** Quits: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP) (Ping timeout)
[02:52:58] <ziad> Eridius: I just did a grep on the code base
[02:53:01] <ziad> and it comes up
[02:53:07] <ziad> ./src/libstd/rt/io/mod.rs:    fn next(&mut self) -> Option<Option<T>> {
[02:53:33] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[02:53:33] <ziad> in a couple of other places too
[02:53:35] <dbaupp> that's part of an iterator, so one level gets removed automagically if used with `for`
[02:53:44] <Eridius> ziad: the one you just listed is rather unlikely to be used in practice as-is
[02:53:50] <Eridius> yeah what dbaupp said
[02:54:05] <Eridius> also if you are using it explicitly, both options have semantic meaning
[02:54:12] <Eridius> which flattening destroys
[02:54:19] <ziad> yeah, that's true
[02:54:29] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[02:54:42] <dbaupp> the Option/Maybe monad instance does have it's uses
[02:55:07] <Eridius> dbaupp: yes, but you don't typically construct Option<Option<Option<Option<Option<T>>>>> and then tear it down
[02:55:10] <dbaupp> rusti: None::<Option<int>>.and_then(|x| x)
[02:55:10] -rusti- None
[02:55:17] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[02:55:20] <dbaupp> rusti: Some(None::<int>).and_then(|x| x)
[02:55:21] -rusti- None
[02:55:26] *** Joins: JanC_ (janc@moz-9C6551B9.dsl.scarlet.be)
[02:55:29] <dbaupp> rusti: Some(Some(1i)).and_then(|x| x)
[02:55:29] -rusti- Some(1)
[02:55:40] * dbaupp realised there was a better way
[02:55:50] <dbaupp> Eridius: true enough
[02:56:03] *** Quits: JanC__ (janc@moz-58D3F9C4.dsl.scarlet.be) (Ping timeout)
[02:56:30] *** Quits: busylizzy (lisa@85228838.12D0DC84.211374C4.IP) (Ping timeout)
[02:56:30] *** Quits: luisbg (luisbg@moz-E7587DBE.collabora.co.uk) (Ping timeout)
[02:56:49] *** Joins: busylizzy (lisa@85228838.12D0DC84.211374C4.IP)
[02:56:59] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[02:56:59] *** Quits: dcrewi (david@moz-AB8667CE.gyrae.net) (Ping timeout)
[02:57:02] <bstrie> cmr: just wanted to say once again that twir is a godsend
[02:57:05] <Eridius> rusti: Some(Some(1i)).and_then(util::id)
[02:57:14] -rusti- pastebinned 13 lines of output: http://ix.io/8CI
[02:57:15] <Eridius> rusti: Some(Some(1i)).and_then(std::util::id)
[02:57:15] -rusti- Some(1)
[02:57:19] <Eridius> dbaupp: ^
[02:57:31] <dbaupp> Eridius: |x|x is shorter :P
[02:57:35] <cmr> bstrie: I agree!
[02:57:37] <Eridius> not if you `use std::util::id`!
[02:57:53] <dbaupp> Eridius: that adds 7 characters minimum! :P
[02:58:13] <Eridius> dbaupp: if you need to flatten multiple times it becomes worth it
[02:58:26] <dbaupp> Eridius: yes
[02:58:46] <dbaupp> but only if you do it 4+ times
[02:59:02] <Eridius> clearly we should put id into the prelude
[02:59:18] * dbaupp guesses optimising the number of characters to create a function that does nothing is not a useful activity
[02:59:24] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[03:00:07] <Eridius> hrm, with the change to slices, it might be a good idea to have a convenience function to transmute between slice types
[03:00:20] <Eridius> because cast::transmute() is no longer usable, as you can't just give it a new length
[03:00:20] * dbaupp suggested that
[03:00:36] <Eridius> dbaupp: what solution was used for the existing transmutes in the source base?
[03:00:45] <steven_is_false> id is the only inhabitant of fn<T>(T) -> T
[03:00:46] *** Quits: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP) (Connection reset by peer)
[03:00:46] <dbaupp> Eridius: see std::rand::Rng.fill_bytes
[03:00:57] *** Joins: tetsuharu (tetsuharu@moz-131F8759.xgsnu4.imtp.tachikawa.mopera.net)
[03:00:58] <ercxx> Do i have to put 'extern mod extra;' both in somefile.rs and the mainlibcrate.ls that has 'mod somefile;' ?
[03:00:59] <steven_is_false> id SHOULD be in the prelude as an instance of mempty
[03:01:04] <steven_is_false> I mean mzero
[03:01:06] *** Joins: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com)
[03:01:07] <dbaupp> steven_is_false: no, |x| { loop {} } works too
[03:01:11] <Eridius> ercxx: no, just in the root
[03:01:25] <steven_is_false> dbaupp: Or |_| fail!()
[03:01:37] <dbaupp> steven_is_false: equivalent (for this purpose)
[03:01:50] <steven_is_false> But it still should be some kind of mzero instance or something.
[03:02:02] <Eridius> dbaupp: ugh, 2 transmutes and a repr. eww
[03:02:12] <dbaupp> (otherwise abort(), asm!("junk"), unsafe { *ptr::null() } would all count)
[03:02:18] <ercxx> Eridius: thanks
[03:02:22] <dbaupp> Eridius: yup :(
[03:02:35] *** Joins: ibnc_ (ibnc@moz-8A9CD85B.client.mchsi.com)
[03:02:40] <Eridius> dbaupp: I think we should have cast::transmute_slice<T,R>(&[T]) -> &[R]
[03:02:41] <dbaupp> steven_is_false: we don't really have the type classes for monoids/monads
[03:02:46] *** Joins: luisbg (luisbg@moz-E7587DBE.collabora.co.uk)
[03:02:55] *** Quits: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com) (Connection reset by peer)
[03:03:04] <steven_is_false> Yes, and I'm not sure how we'd do them.
[03:03:04] <dbaupp> Eridius: I agree 100%
[03:03:10] <dbaupp> Eridius: and _mut_slice
[03:03:26] <Eridius> ah right
[03:03:29] <Eridius> maybe I can whip it up now
[03:03:33] <dbaupp> Eridius: if you happen to implement them, you need to be careful of overflow when going to byte lengths
[03:03:54] <Eridius> dbaupp: what would you do in the case of overflow?
[03:04:02] <dbaupp> Eridius: no idea
[03:04:03] <steven_is_false> Right the problem is that we don't have higher order type classes. So we can't do Monad. We can still do Monoid I think.
[03:04:14] <dbaupp> Eridius: ... wait
[03:04:14] <Eridius> also, _can_ you even overflow? The length can't possibly be longer than the total size of an allocation
[03:04:17] <dbaupp> yeah
[03:04:22] <dbaupp> I just thought of that
[03:04:25] <Eridius> :P
[03:04:40] <dbaupp> probably worth doing it with u64's though
[03:04:46] * dbaupp doesn't know
[03:04:46] <earlzlap> So, what exactly does ~[] or ~"" point to? A single reserved byte? 
[03:04:49] <Eridius> one potential issue is the case of transmuting to a type with a size that's not a clean multiple or divident
[03:04:52] <Eridius> *dividend
[03:04:59] <dbaupp> yeah, just do it
[03:05:03] <Eridius> with the old transmute, if you transmuted &[T] -> &[R], then back, you'd get the original slice back
[03:05:06] <Eridius> but we can't do that anymore
[03:05:07] <dbaupp> division rounds down, so it's fine
[03:05:09] <dbaupp> oh
[03:05:09] <Eridius> I think that can be ignored though
[03:05:16] <dbaupp> docs
[03:05:17] <steven_is_false> But Monoid is actually probable something that will be resolved as part of the numerical type trait hierarchy right?
[03:05:20] <Eridius> because hell, it's an unsafe function to begin with. And if you're doing that you have issues
[03:05:25] <Eridius> we could check at runtime, but that's kinda crap
[03:05:32] * dbaupp apparently has issues
[03:05:53] <dbaupp> earlzlap: I think it's equivalent to with_capacity(4), so 4 elements
[03:05:58] <strcat> earlzlap: well, atm heap-allocated vectors are poorly implemented
[03:06:07] <Eridius> it would be a good use case for some sort of compile-time assert coupled with compile-time size_of, but w/e
[03:06:08] <strcat> earlzlap: look at https://github.com/mozilla/rust/issues/8981
[03:06:11] *** Quits: ambimorph (amber@moz-F1964F26.hlrn.qwest.net) (Ping timeout)
[03:06:52] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[03:06:52] <dbaupp> Eridius: I know that fill_bytes is purposely using the round-down-to-ignore-trailing-bytes behaviour, btw
[03:06:54] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[03:07:14] <Eridius> oh? interesting
[03:07:34] <dbaupp> steven_is_false: yeah, we can do Monoid, but many people weren't too keen on going to Haskell-style mathematical jargon
[03:07:52] <Eridius> ah it checks out remaining data too
[03:07:58] <Eridius> so it wouldn't be able to use this cast_slice
[03:07:59] <dbaupp> Eridius: yeah, it transmutes to a &mut [u64] because filling the vector 8 bytes at a time is faster than doing it 1 byte at a time
[03:08:02] <Eridius> err transmute_slice
[03:08:07] <dbaupp> yeah it would... ?
[03:08:13] <Eridius> oh durr of course it would. It can still do the math
[03:08:20] <dbaupp> (assuming there are no runtime checks)
[03:08:21] * Eridius am not smrt today
[03:08:41] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[03:10:04] <steven_is_false> dbaupp: I'm not sure how to solve the jargon problem. I think the abstraction itself is still useful though.
[03:10:19] *** Quits: BitPuffin (isak@moz-98F8BF74.cust.tele2.se) (Ping timeout)
[03:10:20] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[03:10:39] <dbaupp> steven_is_false: I agree
[03:10:41] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Ping timeout)
[03:10:56] <dbaupp> (although my solution to the jargon "problem" is to just use the jargon :P )
[03:11:02] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[03:11:22] *** Joins: dcrewi (david@moz-AB8667CE.gyrae.net)
[03:13:11] *** Quits: JanC_ (janc@moz-9C6551B9.dsl.scarlet.be) (Ping timeout)
[03:13:27] <steven_is_false> That'd work too.
[03:14:27] *** Quits: bleibig (bleibig@moz-CB11172C.hsd1.ca.comcast.net) (Quit: bleibig)
[03:15:07] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[03:15:11] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[03:17:03] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[03:17:08] *** Joins: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP)
[03:18:28] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[03:18:43] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[03:20:17] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Ping timeout)
[03:20:23] <jxs> hey there folks, it's normal that rustc with the flag --parse-only hides errors like unresolved names?
[03:20:49] <jxs> even if it only parses, should rustc display those errors?
[03:21:43] <cmr> jxs: It only parses, it doesn't run any of the later stages.
[03:21:50] <cmr> Ie, all of analysis and translation is skipped.
[03:22:01] <cmr> Including name resolution
[03:22:05] <dbaupp> no, it just runs the parser and then quits
[03:22:05] <dbaupp> no semantic analysis or anything like that
[03:22:25] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[03:22:45] *** Quits: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net) (Quit: dherman)
[03:23:08] *** Joins: reedlepee (Mibbit@EC9A78E6.3CAE2EA8.9D59D0D8.IP)
[03:23:23] *** Quits: barosl (barosl@3DE683B6.E551553C.7544CABF.IP) (Quit: 랜덤은 쇠퇴했습니다.)
[03:23:57] *** Quits: dbaupp (Thunderbir@moz-54ADD9F4.lns20.syd6.internode.on.net) (Ping timeout)
[03:24:31] *** Joins: dbaupp (Thunderbir@moz-54ADD9F4.lns20.syd6.internode.on.net)
[03:24:54] <jxs> hum ok thanks, but then stuff like undefined function names and so one, at what stage is that checked?
[03:25:10] <cmr> jxs: resolution
[03:25:21] <cmr> Are you wanting to run rust just for error reporting?
[03:25:33] <cmr> --no-trans
[03:25:47] <jxs> yeah, it's cause i developed a syntax checker for emacs and 
[03:25:55] <jxs> ok thanks
[03:27:24] <jxs> yeah that seems it thanks
[03:27:38] <jxs> how long does it take on like a 150 loc file?
[03:27:48] <dbaupp> try it?
[03:27:52] <cmr> Shouldn't take any longer than ~100ms
[03:28:21] <dbaupp> jxs: it's highly unlikely to work on any file that's not the crate file
[03:28:56] <dbaupp> i.e. running rustc --no-trans file.rs in isolation will probably hit a pile of "random" errors
[03:29:06] *** sam113101 is now known as sam113101_afk
[03:29:07] *** Joins: JanC_ (janc@moz-6F54248C.dsl.scarlet.be)
[03:29:28] *** Quits: tetsuharu (tetsuharu@moz-131F8759.xgsnu4.imtp.tachikawa.mopera.net) (Client exited)
[03:29:29] <jxs> because of imports and stuff like that?
[03:29:39] <dbaupp> yeah
[03:32:40] *** Parts: steven_is_false (user@C5B76363.1FF1EBF8.1ECA502.IP) (ERC Version 5.3 (IRC client for Emacs))
[03:33:01] *** Joins: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net)
[03:33:02] *** ChanServ sets mode: +ao dherman dherman
[03:34:04] <reedlepee> dbaupp: Do i need to push again after making some changes or only git commit -a would do ?
[03:34:21] <cmr> reedlepee: you also need to push.
[03:34:43] <cmr> reedlepee: making a commit will only create it locally, you need to push the commits onto the server.
[03:37:47] *** Quits: ibnc_ (ibnc@moz-8A9CD85B.client.mchsi.com) (Quit: )
[03:37:53] *** Joins: bleibig (bleibig@moz-CB11172C.hsd1.ca.comcast.net)
[03:38:15] <reedlepee> cmr: ohk :)
[03:38:27] <jxs> ok thanks dbaupp 
[03:38:34] <jxs> but it's kinda working as i had hoped
[03:38:50] <jxs> ehe
[03:38:51] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Ping timeout)
[03:41:17] *** Joins: jsingh (Mibbit@D78EF305.AA9008B0.DDE5D3F6.IP)
[03:42:18] <jsingh> are there any good links on how to write to a RWArc?
[03:42:25] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[03:42:56] *** Quits: johns (johns@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[03:43:04] *** Joins: johns (johns@moz-BBE3ABD.mv.mozilla.com)
[03:44:38] *** Joins: tautologico (shung@C9999EDD.2E0B1C5F.C36097CD.IP)
[03:44:50] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[03:44:57] <tautologico> can I restructure an object from a borrowed pointer?
[03:45:02] <tautologico> *destructure
[03:45:27] <tautologico> I always get error: cannot move out of dereference of & pointer
[03:45:28] <cmr> tedh: non-destructively, yes. you can only take references to its inners.
[03:45:43] <cmr> erm, @tautologico
[03:46:01] <tautologico> how can I say I want a borrowed reference for an inner field?
[03:47:22] <tautologico> I have an enum in which one variant has a ~ptr, I want to destructure the object with a match, borrow the ~ptr and pass the &ptr to another function
[03:47:37] <jsingh> any tips on how to get rid of 'capture of moved value' error? I'm trying to write to a RWArc
[03:48:23] <cmr> let x = &*match foo { SomeVariant(ref x) => x }, I think?
[03:49:24] *** Joins: mib_3447bf (Mibbit@moz-F58AC689.hinet-ip.hinet.net)
[03:49:30] *** Quits: mib_3447bf (Mibbit@moz-F58AC689.hinet-ip.hinet.net) (Quit: mib_3447bf)
[03:49:57] <tautologico> ref makes a &~ptr
[03:52:37] <tautologico> yeah, ref does it
[03:52:51] <ercxx> Can I use a self.variable of a struct in a fn implementing a trait for that struct ?
[03:53:47] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[03:55:52] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[03:56:09] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[03:56:10] *** Joins: jeffdb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[03:56:29] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[03:58:13] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[03:58:57] *** Quits: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net) (Quit: It's a joke, it's all a joke.)
[04:00:36] *** Joins: crembo (crembo@moz-C2B364AA.vc.shawcable.net)
[04:00:41] *** Quits: ziad (Mibbit@moz-5729CEA7.hsd1.ca.comcast.net) (Ping timeout)
[04:08:21] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Ping timeout)
[04:08:26] *** Quits: jxv (jxv@4732E7D7.2AB34561.9B38A32A.IP) (Quit: Leaving)
[04:10:14] *** Quits: jsingh (Mibbit@D78EF305.AA9008B0.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[04:11:09] *** Joins: ww (Mibbit@moz-DFAED48A.lightspeed.sntcca.sbcglobal.net)
[04:12:30] <ww> question: how do I get a deconstructed variable as mut in the match's case?  e.g. match foo() {  case Ok(var1) =>  var1 needs to be mut }
[04:13:16] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[04:14:06] <tautologico> I think the parent has to be mutable
[04:14:10] <tautologico> mutability is inherited
[04:14:48] <tautologico> so maybe match &mut foo() { … 
[04:14:53] <dbaupp> ww: Ok(var1) => { let mut var1 = var1;
[04:15:10] <dbaupp> ww: if https://github.com/mozilla/rust/issues/9792 gets fixed then `Ok(mut var1)`
[04:15:41] <ww> ok, thanks.
[04:16:10] <tautologico> so if I can arbitrarily get mutable references to fields inside immutable structures, what is the use of immutability?
[04:16:46] *** sam113101_afk is now known as sam113101
[04:16:48] <dbaupp> tautologico: you can't
[04:17:02] <dbaupp> `var1` isn't a reference there
[04:17:27] <dbaupp> any & every binding can be made mutable
[04:17:33] <dbaupp> let mut x: &int; is fine
[04:17:54] *** Quits: ww (Mibbit@moz-DFAED48A.lightspeed.sntcca.sbcglobal.net) (Quit: http://www.mibbit.com ajax IRC Client)
[04:17:57] <dbaupp> it allows you to modify the &int stored in x, but not the int that x points to
[04:18:00] <tautologico> ok, I got that var1 is not a ref
[04:18:30] <dbaupp> i.e. you can write `x = &1; x = &2;`, you just can't write `*x = 1; *x = 2`
[04:18:39] <tautologico> yeah
[04:18:51] <tautologico> got it, thanks
[04:18:55] <dbaupp> np
[04:20:40] <tautologico> pointers complicate everything :)
[04:20:50] *** Quits: jeffdb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Quit: jeffdb)
[04:21:16] <tautologico> explicit pointers, of course
[04:21:20] <dbaupp> except for some things :P
[04:21:51] <tautologico> of course sometimes you really need them explicit
[04:28:10] *** Quits: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net) (Quit: dherman)
[04:29:06] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Client exited)
[04:30:25] <earlzlap> Finally got basic URL pattern matching for my MVC framework working :) 
[04:30:35] <pcmattman> wooo! :D
[04:30:39] <earlzlap> A preview of what usage looks like so far: https://gist.github.com/anonymous/7065084
[04:31:15] <earlzlap> I really wish that setting up routes were easier, but I get can't borrow mut test twice, so I don't see a better way so far
[04:32:44] <dbaupp> let ctrl = TestController::new().handles(...); router.controller(ctrl)
[04:33:08] <dbaupp> or ctrl = TestController::new(); router.handler(~"foo", ctrl)
[04:33:12] * dbaupp shrugs
[04:33:41] <earlzlap> But then the controllers have to worry about that and ensuring that Router can keep a simple lifetime is hard heh
[04:34:02] <earlzlap> btw, here is the actual code: https://github.com/Earlz/rustymvc/tree/master/proto
[04:35:51] <earlzlap> I'm almost sure I over-use ~str, but I'd rather not worry about &'self str all over
[04:36:52] <dbaupp> I think that at least `router.controller(~"/say/[message]", |_| Controller::new())` is better, because it forces you to set `ControllerBox.path` once and exactly once
[04:37:10] <dbaupp> (what happens if you forget the .handles, or call it twice on one ControllerBox?)
[04:37:28] <earlzlap> yea, that's a problem I'm wanting to solve by using traits more extensively
[04:37:47] <earlzlap> So that handles() returns a trait that doesn't have handles()
[04:37:54] *** Quits: tautologico (shung@C9999EDD.2E0B1C5F.C36097CD.IP) (Quit: tautologico)
[04:40:47] *** Quits: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca) (Quit: Leaving.)
[04:44:18] *** Joins: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net)
[04:44:18] *** ChanServ sets mode: +ao dherman dherman
[04:44:38] *** sam113101 is now known as sam113101_afk
[04:44:42] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[04:48:00] <mcpherrin> Anyone around to give me a quick tour of how rust uses libuv?
[04:48:17] <mcpherrin> I want to write some network code that the current abstractions don't suffice for
[04:50:52] *** sam113101_afk is now known as sam113101
[04:54:42] *** Quits: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net) (Quit: dherman)
[04:55:23] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[04:57:29] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[04:59:23] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[05:00:43] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[05:03:02] *** Quits: mihneadb (mihneadb@ECA1F581.33B6743.89C0DD0D.IP) (Ping timeout)
[05:03:03] <ercxx> What is this > error: instantiating a type parameter with an incompatible type `MyServer<>`, which does not fulfill `Send`
[05:03:10] <ercxx> and how do I fulfill `Send`
[05:03:12] <ercxx> ?
[05:05:52] *** Joins: mihneadb (mihneadb@CC1999CD.4339B50.5BC07656.IP)
[05:07:08] <mcpherrin> ercxx: things that are Send can be moved between tasks.  I forget exactly what can't be included, but @ types for sure
[05:07:30] <mcpherrin> ercxx: what's your type look like?
[05:09:13] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:09:43] <ercxx> mcpherrin: http://pastebin.mozilla.org/3296048 that's the whole thing.
[05:10:35] <ercxx> commented line which has serve_forever is implemented in rust-http and is part of this : impl<T: Send + Clone + Server> ServerUtil for T { .......
[05:11:13] <ercxx> It doesn't compile with send_forever() uncommented.
[05:11:49] <mcpherrin> ercxx: MyServer shouldn't take a borrowed pointer to rt, I think
[05:11:58] <mcpherrin> instead taking it as an owned pointer
[05:12:37] <mcpherrin> The problem I think (I might be wrong?) is that rt is on `main`'s stack, and serve_forever is probably sending self off to some other task or something
[05:13:22] <ercxx> Here's what I would like to do I can use some help apparently: I want to have a route table with a struct {routes: HashMap<~str, ~fn>}
[05:13:41] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[05:13:42] <ercxx> Then I want this as a global object. Once created I wont modify it.
[05:13:57] <ercxx> Then I want to pass a reference to the server.
[05:14:12] *** Quits: Kxepal (Miranda@moz-31F7E1D4.pppoe.mtu-net.ru) (Ping timeout)
[05:14:13] <ercxx> I thinkg the problem is the server clones itself.
[05:17:12] *** Joins: Kxepal (Miranda@moz-8A197C01.pppoe.mtu-net.ru)
[05:22:29] *** Quits: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net) (Quit: zzz)
[05:32:04] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[05:32:14] *** Quits: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com) (Quit: Konversation terminated!)
[05:39:25] <reedlepee> cp: i686-unknown-linux-gnu/stage2/bin/rustc cp: cannot create regular file `i686-unknown-linux-gnu/stage2/bin/rustc': Text file busy make: *** [i686-unknown-linux-gnu/stage2/bin/rustc] Error 1
[05:39:29] <reedlepee> cp: i686-unknown-linux-gnu/stage2/bin/rustc cp: cannot create regular file `i686-unknown-linux-gnu/stage2/bin/rustc': Text file busy make: *** [i686-unknown-linux-gnu/stage2/bin/rustc] Error 1
[05:39:37] <reedlepee> cp: i686-unknown-linux-gnu/stage2/bin/rustc
[05:39:51] <reedlepee> cp: cannot create regular file `i686-unknown-linux-gnu/stage2/bin/rustc': Text file busy
[05:39:56] <reedlepee> cp: cannot create regular file `i686-unknown-linux-gnu/stage2/bin/rustc':   Text file busy
[05:40:11] <reedlepee> cp: cannot create  regular file `i686-unknown-linux-gnu/stage2/bin/rustc': Text file busy
[05:40:45] <reedlepee> What does that error mean ??
[05:41:18] <reedlepee> while running make check the above error came 
[05:41:56] <mcpherrin> Wow, that's an error I haven't seen in a long time
[05:42:15] <mcpherrin> Usually "text file busy" comes when a program is trying to overwrite itself
[05:42:51] <reedlepee> So what should be done in this case ?
[05:44:25] <reedlepee> mcpherrin??
[05:44:28] <mcpherrin> Is this a fresh compile?
[05:44:35] <mcpherrin> Or are you rebuilding?
[05:44:46] *** Quits: jhenahan (jhenahan@moz-65B7D4EE.hsd1.vt.comcast.net) (Quit: Textual IRC Client: www.textualapp.com)
[05:44:47] <reedlepee> fresh compile??
[05:44:59] <mcpherrin> and what version are you building? git master?
[05:45:02] <reedlepee> i did some changes and then ran make check
[05:45:14] <mcpherrin> any changes to the makefiles?
[05:45:19] <reedlepee> noo
[05:45:32] <reedlepee> changes in libstd and libextra 
[05:45:32] <mcpherrin> I don't know enough about how the makefiles work to really debug this
[05:45:42] *** Quits: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca) (Quit: Leaving)
[05:45:43] <dbaupp> reedlepee: are you running more than one `make`?
[05:46:03] <reedlepee> no ..
[05:46:11] <reedlepee> only one make 
[05:46:18] <reedlepee> make check
[05:46:55] *** Joins: smerft (Mibbit@moz-44881D72.lns20.adl2.internode.on.net)
[05:47:17] <pcmattman> pure and unsourced speculation, but is selinux active?
[05:47:18] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[05:47:45] <pcmattman> and/or -j on make
[05:47:51] <mcpherrin> Oh, and I don't suppose you're trying to use rustc while you're rebuilding it?
[05:48:04] * dbaupp only accepts monadic & peer-reviewed speculation
[05:49:15] <reedlepee> dbaupp: What should I do then ?
[05:51:25] <dbaupp> reedlepee: no idea! :(
[05:51:43] <mcpherrin> What linux are you on?
[05:52:22] <reedlepee> ubuntu 12.04
[05:52:34] <mcpherrin> okay, so something reasonable
[05:52:44] <mcpherrin> hmm, I really don't know what could be happening
[05:53:29] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[05:53:32] <dbaupp> reedlepee: can you try `make clean` and then running `make` again?
[05:53:49] <reedlepee> yeah ohk
[05:54:02] <pcmattman> also a ps aux | grep rustc is maybe not a bad idea either
[05:54:38] <reedlepee> now i ran make check again 
[05:55:44] <acrichto> dbaupp: the aborting did indeed land!
[05:55:50] <acrichto> after many failed attempts...
[05:56:33] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[05:56:35] <mcpherrin> hmmph, libuv doesn't have a nice abstraction for ICMP
[05:56:56] <pcmattman> does anything?
[05:56:56] <mcpherrin> Explitives for people who expect you to write bad network code!
[05:57:19] <mcpherrin> pcmattman: Anyone who wants to do UDP half-correctly should
[05:57:25] <mcpherrin> (handle ICMP, that is)
[05:58:02] <pcmattman> surely the kernel should expose the ICMP status messages at the socket layer?
[05:58:27] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[05:58:31] <mcpherrin> and libuv squishes those messages away
[05:58:47] <pcmattman> ah
[05:58:47] <pcmattman> ew
[05:58:56] <mcpherrin> At least from what I can tell -- haven't tested yet
[06:00:16] <mcpherrin> looks like I just have to do everything with raw sockets
[06:00:21] <dbaupp> acrichto: \o/ moar safety
[06:00:32] <pcmattman> mcpherrin: yay, 2013
[06:02:04] <Eridius> dbaupp: vectors use size_of_nonzero() for their data, right?
[06:02:05] *** Quits: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP) (Connection reset by peer)
[06:02:56] <dbaupp> Eridius: I think that was fixed
[06:03:26] <dbaupp> Eridius: (since we can now just store the length of ~[()] in elements, rather than having to have at least one byte per ())
[06:03:29] <dbaupp> but I don't know
[06:03:39] <dbaupp> Eridius: use the source, luke
[06:03:42] <Eridius> hrm. It's kind of important for a safe transmute_slice
[06:04:11] <mcpherrin> pcmattman: Layer 2 networks are so nice.  Why are the high level fuckers so bad? :(
[06:04:37] <mcpherrin> Layer 3 would be okay if it weren't for NATs
[06:04:47] <mcpherrin> well, shit household NATs at least
[06:05:23] *** Joins: robertknight (robertknig@moz-54528EE0.wby.mendeley.com)
[06:05:26] <Eridius> dbaupp: vec::with_capacity() uses nonzero_size_of() for the allocation amount
[06:05:50] <tiffany> it is 2013 why are we not all using ipv6 with no NATs
[06:05:59] <dbaupp> reedlepee: ah, so strcat didn't fix that
[06:06:04] <Eridius> oh right it's only slices that went element count, right? allocated vectors are still bytes?
[06:06:04] <dbaupp> *Eridius
[06:06:09] <dbaupp> reedlepee: (sorry, wrong person)
[06:06:21] <dbaupp> Eridius: yes
[06:06:24] <pcmattman> tiffany: because people still think NAT == security/firewall, and NAT-less IPv6 is scary.
[06:06:30] <mcpherrin> tiffany: I know, right?  But then, even the switches I make still work better with v4 than v6
[06:06:39] <mcpherrin> (and I make high end network gear....)
[06:06:51] * pcmattman had native IPv6 for a few years, switched ISPs to get onto cable instead of ADSL so no more v6 :(
[06:07:06] *** Quits: robertknight (robertknig@moz-54528EE0.wby.mendeley.com) (Ping timeout)
[06:07:14] <dbaupp> rusti: std::mem::size_of::<[(), .. 4]>()
[06:07:15] -rusti- 0u
[06:07:22] <mcpherrin> Comcast is all about the IPv6
[06:07:36] <pcmattman> mcpherrin: those switchies would surely be optimised for v4 though, because it's what most of the expected traffic will be at the moment
[06:07:47] <pcmattman> there's an extra i in that sentence that makes networking hardware sound cute
[06:07:59] <mcpherrin> pcmattman: Well, it's partly just because of what people need
[06:08:11] <mcpherrin> There's only so much dev time we can spend on features, and having two protocols is work
[06:08:14] <tiffany> mcpherrin: what do you mean you make it? you work at a company that does, or you actually make it yourself?
[06:08:23] <mcpherrin> Company, not me personally
[06:08:30] <pcmattman> mcpherrin: yup
[06:08:33] <mcpherrin> I mean, I have a hand in it.
[06:08:39] <tiffany> interesting
[06:08:47] <mcpherrin> There's also things like table sizes
[06:09:02] <mcpherrin> because v6 addrs are larger, you fit less in your tables
[06:09:03] <tiffany> I have centurylink who has had ipv6 for business customers for decades yet I don't have ipv6 internet
[06:10:18] <mcpherrin> The thing I'm really sad that we don't have yet is internet-wide multicasting
[06:10:20] <tiffany> mcpherrin: the high end gear supports NATs with more protocols than tcp/udp, right?
[06:10:23] <tiffany> eh
[06:10:30] <tiffany> I don't really know what ISPs have against multicast
[06:10:40] <mcpherrin> tiffany: It's impossible right now.
[06:10:50] <mcpherrin> Literally nobody has figured out internet-scale multicast.
[06:10:56] <tiffany> even if you had to pay to broadcast over it it'd still be a huge saving for sites like twitch.tv (if they switched to udp-based streams instead of individual tcp streams, I suppose)
[06:11:05] <tiffany> oh, huh
[06:11:12] <mcpherrin> The control protocols just don't scale
[06:11:57] <mcpherrin> there's lots of little multicast networks -- it's frequently used for stuff like TV over IP
[06:12:14] <mcpherrin> From ASDL providers who offer TV
[06:12:18] *** Joins: csherratt (csherratt@moz-CAF331EA.cable.teksavvy.com)
[06:12:54] <mcpherrin> Lots of multicasting in stock quote feeds
[06:13:27] <mcpherrin> tiffany: Not sure on the exact capabilities of high-end hardware NAT -- the only use case I ever see is udp multicast NAT only
[06:13:58] <mcpherrin> (it's a niche use case)
[06:14:44] <Ralith> tiffany is probably wondering about SCTP NAT
[06:14:52] <tiffany> actually yes
[06:14:58] <mcpherrin> SCTP is sweet tastic
[06:15:04] <Ralith> tell me about it
[06:15:05] *** Joins: ash_136 (ashvini@2533AB18.EDD19DB4.422D491.IP)
[06:15:09] <mcpherrin> THAT's something I'd like to see wider deployment of
[06:15:24] <tiffany> it's so lovely, if only it could roam freely across the consumer NATs
[06:15:40] <ash_136> hello
[06:15:45] <ash_136> new to mozila :)
[06:15:52] <mcpherrin> SCTP gives you datagram messaging like UDP, but reliable, in-order, and congestion controlled like TCP
[06:16:03] <ash_136> I want to participate in OPW
[06:16:07] <ash_136> any one help?
[06:16:08] <ash_136> :)
[06:16:31] <mcpherrin> In a previous life I worked on telecom hardware, which is all about the SCTP
[06:17:02] <mcpherrin> ash_136: At this time of day, you won't find many people involved with OPW around, I think
[06:17:17] <Ralith> windows kernel support wouldn't go amiss either
[06:17:33] <tiffany> and maybe OS X support too
[06:17:41] <mcpherrin> No SCTP in OS X? That's a shame
[06:17:43] <tiffany> and maybe even linux enabling the flag for it by default
[06:17:54] <dbaupp> ash_136: we're happy to help though, are you looking for a good first bug?
[06:17:56] <mcpherrin> But alas, nobody uses SCTP so it doesn't matter
[06:18:05] <ash_136> dbaupp: yes :) I saw the website
[06:18:13] <ash_136> I created mozilla and bugzilla accounts
[06:18:13] <tiffany> the horrible problem of adoption
[06:18:15] <mcpherrin> Just roll your own hacky stuff on top of UDP like everyone else :(
[06:18:26] <ash_136> And I already have a git hub acc
[06:18:26] *** Joins: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP)
[06:18:27] <tiffany> yeah, my plans are to use libusrsctp to tunnel sctp through udp
[06:18:36] <dbaupp> ash_136: ah, if you're looking to work on Rust or Servo then only GH is necessary :)
[06:18:37] <ash_136> so good to start with first bug I suppose
[06:18:39] <mcpherrin> Yeah, that's about the only reasonable thing to do
[06:18:58] <ash_136> dbaupp: Git hub ?
[06:19:09] <dbaupp> acrichto: (do you have any insider info/advice/ability to help with OPW?)
[06:19:09] *** Joins: crembo (crembo@moz-C2B364AA.vc.shawcable.net)
[06:19:14] <dbaupp> ash_136: yes
[06:19:36] <acrichto> dbaupp: how so? tjc's the main man to talk to about logistic-type things
[06:19:48] <dbaupp> acrichto: just wondering, since tjc isn't here
[06:20:22] <acrichto> I do know that there's the #opw channel (which may not have active people at this time), but I'm certainly willing to help out a bit!
[06:20:34] <acrichto> I'm a little limited being on a train right now, but I'll be around for a half hour or so :)
[06:20:35] *** Quits: KindOne (KindOne@moz-42C8DA9E.dynamic.ip.windstream.net) (Ping timeout)
[06:21:01] <Ralith> mcpherrin: of course, there's plenty of people out there who'd use it for damn near everything if they were aware of it and it was well supported...
[06:21:09] <Luqman> ash_136: there's a list of some good first bugs here https://wiki.mozilla.org/GNOME_Outreach_December2013#Start_with_these
[06:21:25] <acrichto> ash_136: sounds like you're off to a good start though!
[06:21:44] <dbaupp> Luqman: ah, that's the page I was trying to find (for some reason I thought it was on the rust wiki)
[06:22:17] <acrichto> ash_136: there's also a wiki page about getting started with development on rust (trying to load it now)
[06:22:33] <acrichto> turns out text over ssh loads faster than a web page
[06:22:33] <dbaupp> https://github.com/mozilla/rust/wiki/Note-getting-started-developing-Rust
[06:22:38] <acrichto> yes, that's it!
[06:22:57] <mcpherrin> augh I hate BSD sockets so much
[06:23:01] <ash_136> so I will start with the bugs then ?
[06:23:01] <mcpherrin> Why is this api so bad
[06:23:12] <ash_136> Thankyou all :)
[06:23:17] <acrichto> ash_136: feel free to ask any questions you've got in #rust about anything, but yes fixing a bug is an excellent place to get started!
[06:23:31] <dbaupp> ash_136: yeah, just pick one from that list (we're happy to help)
[06:23:34] <acrichto> ash_136: do you have areas that you're generally interested in? Things like compiler infrastructure, library work, etc.
[06:23:42] <ash_136> acrichto: dbaupp:Thanks :) 
[06:23:45] <ash_136> No not really
[06:23:49] <ash_136> I am still a beginner
[06:23:52] <acrichto> there's an E-easy tag for bugs on github, but the bugs sadly aren't really all that easy
[06:23:53] <ash_136> so open to all types :)
[06:23:57] *** Joins: KindOne (KindOne@moz-42C8DA9E.dynamic.ip.windstream.net)
[06:24:04] <acrichto> I opened a good chunk today
[06:24:06] <ash_136> let me have a look and get back :)
[06:24:07] <acrichto> let me find it real quick
[06:24:19] <dbaupp> acrichto: I guess the Start-with-these page was a filtering of the E-easy ones
[06:24:33] <Luqman> This I think is particularly easy https://github.com/mozilla/rust/issues/9882
[06:24:39] <acrichto> ash_136: I opened https://github.com/mozilla/rust/issues/9958 today which may not be too hard
[06:24:42] <Luqman> once you find the right place, it's only a couple of lines to add
[06:24:56] <acrichto> ash_136: but feel free to start anywhere! we accept help of any form :)
[06:25:02] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[06:25:08] <acrichto> Luqman: actually that may no longer be easy
[06:25:14] <acrichto> b/c libstd is using inline asm
[06:25:14] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[06:25:30] <Luqman> acrichto: oh right, that's true
[06:25:39] * acrichto should really make feature flags not deny-by-default if unknown
[06:25:41] <Luqman> would have to do the snapshot juggle i guess
[06:26:23] <dbaupp> Adding it as Allow-ed should be ok though
[06:26:36] <ash_136> acrichto:Which is best to start with ?
[06:26:44] <ash_136> front end ? lint or lib?
[06:26:44] *** Quits: KindOne (KindOne@moz-42C8DA9E.dynamic.ip.windstream.net) (Ping timeout)
[06:27:04] <Luqman> ash_136: just choose one that may look interesting to you or perhaps you think you can do
[06:27:19] <acrichto> ash_136: whatever you're most interested, I would read some bugs and see what looks most interesting to you
[06:27:37] <acrichto> ash_136: the asm! bug is a little tricky right now, so you may want to avoid that
[06:27:43] <acrichto> you can blame me for that :(
[06:27:52] *** Joins: KindOne (KindOne@moz-42C8DA9E.dynamic.ip.windstream.net)
[06:28:21] * dbaupp blames acrichto
[06:28:33] <ash_136> https://github.com/mozilla/rust/issues/8767
[06:28:47] <ash_136> does this bogus error exists or is it bogus ? :D
[06:29:06] <dbaupp> rusti: impl B {}
[06:29:09] -rusti- pastebinned 6 lines of output: http://ix.io/8CQ
[06:29:24] <acrichto> ash_136: the bug in that case is that the error message is pretty awful
[06:29:35] <dbaupp> ash_136: yes, the bad error message still happens
[06:29:41] <acrichto> it should really be something like "unknown type B" or something like that
[06:29:53] <acrichto> rusti: impl A for int {}
[06:29:55] -rusti- pastebinned 7 lines of output: http://ix.io/8CR
[06:30:09] <acrichto> ash_136: that's a more appropriate error message ^
[06:30:41] <ash_136> what is impl btw ?:( sorry for lack of knowledge :/
[06:31:02] <ash_136> its a class type?
[06:31:15] <dbaupp> ash_136: have you read the tutorial? http://static.rust-lang.org/doc/master/tutorial.html :)
[06:31:27] <ash_136> nope
[06:31:37] <ash_136> it was nt there in that page
[06:31:39] <ash_136> thanks 
[06:32:40] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[06:32:53] *** Joins: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net)
[06:33:02] *** Quits: nejucomo (Adium@moz-434492BB.dsl.static.sonic.net) (Quit: nejucomo)
[06:33:09] <ash_136> I know only C,C++ lang
[06:33:11] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:33:17] <ash_136> I should learn rust lang ?
[06:33:27] <ash_136> even for fixing theese bugs ?
[06:33:31] <dbaupp> if you want to be working on Rust, yes
[06:33:41] <dbaupp> almost all of Rust is written in Rust itself
[06:34:24] <ash_136> okay can I use rust on ubuntu?
[06:34:34] <bjz> yep!
[06:34:52] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[06:34:54] <bjz> I think it's on apt-get?
[06:35:02] <kimundi> sure, there are even nightly builds that you can uses (and should use, if you want to start with rust)
[06:35:35] <bjz> sudo add-apt-repository ppa:hansjorg/rust; sudo apt-get update; sudo apt-get install rust-nightly
[06:35:36] <bjz> ?
[06:35:43] <bjz> I think
[06:35:58] <DanC> nightly builds? ooh. somehow I missed those. pointer?
[06:36:01] <dbaupp> but if you're working on the compiler/standard libraries they aren't very helpful
[06:36:01] * bjz was copying from his .travis.yml
[06:36:08] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[06:36:10] <bjz> yeah
[06:36:11] <dbaupp> DanC: 0x10349858410 as *uint
[06:36:25] * DanC ?
[06:36:33] <bjz> ash_136: if you're working on rust itself you need to install from master
[06:36:40] <dbaupp> DanC: it's a (raw) pointer
[06:36:41] <DanC> oh. pointer. chuckle.
[06:36:58] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[06:36:59] <dbaupp> https://github.com/mozilla/rust/wiki/Doc-packages,-editors,-and-other-tools#packages
[06:37:59] <dbaupp> oooh, hansjorg has packages back to 0.5
[06:38:02] <DanC> nice.
[06:39:18] <bjz> thanks for your work hansjorg!
[06:41:11] * dbaupp likes how http://hiho.io/rust-ci/ got a pile of "build failing"s after the fmt removal
[06:42:09] <ash_136> bjz:okay so first step is to install from master/???
[06:42:46] <bjz> ash_136: yeah, clone it from github
[06:43:03] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Client exited)
[06:43:33] <dbaupp> fork mozilla/rust to your own account first and clone that one
[06:43:38] *** Quits: KindOne (KindOne@moz-42C8DA9E.dynamic.ip.windstream.net) (Ping timeout)
[06:43:54] <bjz> dbaupp: ah yep, that's right
[06:43:57] <ash_136> how to fork it to my own account?
[06:43:58] *** Joins: KindTwo (KindOne@moz-DA415F46.dynamic.ip.windstream.net)
[06:44:22] <bjz> ash_136: there's a fork button at the top right of the repo page
[06:44:38] <dbaupp> https://github.com/mozilla/rust/ (if you're logged in)
[06:44:41] <ash_136> https://github.com/mozilla/rust?
[06:44:50] <dbaupp> yes
[06:44:52] <bjz> yep
[06:44:59] <dbaupp> [ Fork | 660 ]
[06:45:00] <FreeFull> https://help.github.com/articles/fork-a-repo
[06:45:14] *** KindTwo is now known as KindOne
[06:45:30] <ash_136> I did fork
[06:45:33] <ash_136> :)
[06:45:34] <ash_136> then?
[06:45:55] *** Joins: skade (skade@moz-D8051715.pools.arcor-ip.net)
[06:46:07] <bjz> ash_136: ok, then there's a clone url at the bottom of the right sidebar
[06:46:11] <bjz> "HTTPS clone URL"
[06:46:41] <ash_136> ah yes :)
[06:46:47] <dbaupp> ash_136: the "fork-a-repo" page FreeFull linked describes it too
[06:46:57] *** Joins: z0w0 (zack@moz-C877F2F7.lnse2.cha.bigpond.net.au)
[06:46:58] <ash_136> now in terminal
[06:47:03] <ash_136> git clone website?
[06:47:15] <dbaupp> (specifically, adding an upstream pointing to mozilla/rust is useful)
[06:47:18] <dbaupp> yes
[06:47:31] <bjz> ash_136: they have awesome instructions: https://help.github.com/articles/fork-a-repo
[06:47:58] <ash_136> hey the kernel I have now I installed from Linux kernel
[06:48:05] <ash_136> since I was contributing for it
[06:48:17] <ash_136> should  I change to my old kernel and fork it ?
[06:48:25] <bjz> ?
[06:48:49] <dbaupp> no, the linux kernel you're using shouldn't matter
[06:48:51] <ash_136> bjz:Pardon me for my silly questions
[06:48:54] <bjz> np
[06:48:57] <ash_136> okay thanks :)
[06:49:07] <bjz> yeah, this is just the workflow for github
[06:49:30] <bjz> github uses git, but there are several other things it adds to the process
[06:49:56] <ash_136> dbaupp: what about the upstream pointing to mozilla/rust
[06:49:59] <ash_136> how to do that?
[06:50:13] <dbaupp> https://help.github.com/articles/fork-a-repo#step-3-configure-remotes
[06:50:15] <bjz> it's on the help page we linked
[06:50:41] <dbaupp> (change the URL to be https://github.com/mozilla/rust.git)
[06:51:22] <ash_136> you mean the close url?
[06:51:37] <bjz> ash_136: that will make it easier to merge updates from the main repo into your own fork
[06:51:41] <ash_136> git clone https://github.com/username/Spoon-Knife.git
[06:51:49] <dbaupp> `git remote add upstream <url>`
[06:52:17] <ash_136> okay okay got it :)
[06:52:31] <ash_136> btw here spoonknife is mozilla/rust.git
[06:52:34] <ash_136> right
[06:53:18] <bjz> ash_136: with git you can have multiple remotes, because its a distributed VCS. you pull in changes from upstream so that your up to date as you work, then you push to your fork.
[06:53:59] <bjz> when you want to contribute changes to the main rust repo, github has this thing called a 'Pull Request'
[06:54:44] <bjz> bascally you ask the maintainers of mozilla/rust to pull your changes into master
[06:55:02] *** Quits: csherratt (csherratt@moz-CAF331EA.cable.teksavvy.com) (Quit: csherratt)
[06:55:19] <bjz> does that make sense?
[06:55:20] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[06:57:12] <dbaupp> heh, the github highlighter still has `move` as a keyword but doesn't have `in`.
[06:57:31] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[06:58:00] <bjz> :)
[06:58:28] <bjz> isn't there a repo where you can push changes to?
[06:59:05] <ash_136> huh?
[06:59:17] <bjz> https://help.github.com/articles/why-isn-t-my-favorite-language-recognized
[06:59:30] <bjz> https://github.com/github/linguist
[06:59:33] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[07:00:13] <dbaupp> bjz: awesome, I'll (try to) fix it
[07:00:14] <ash_136> what is the upstream link?
[07:00:20] <bjz> https://github.com/github/linguist/tree/master/samples/Rust
[07:00:30] *** Joins: csherratt (csherratt@moz-CAF331EA.cable.teksavvy.com)
[07:00:33] <ash_136> what is the upstream link?
[07:01:01] <bjz> ash_136: that's the repositry you added with `git remote add upstream <url>`
[07:01:13] <bjz> in this case, it would be mozilla/rust
[07:01:50] <ash_136>  git remote add upstream
[07:01:50] <ash_136>  https://github.com/mozilla/rust??
[07:03:13] <bjz>  https://github.com/mozilla/rust.git
[07:03:26] <bjz> like in the help page we posted
[07:04:00] <balpert> (github works without the .git too)
[07:04:07] <bjz> orly?
[07:04:14] * bjz didn't know that
[07:04:27] <balpert> yeah, it's pretty weird
[07:04:28] <ash_136> git remote add upstream https://github.com/octocat/Spoon-Knife.git
[07:04:43] <ash_136> thhis is what is 
[07:04:46] <bjz> Spoon-Knife is just an example
[07:04:48] <ash_136> given?
[07:04:54] <ash_136> yeah
[07:05:41] <ash_136> so instead of that what should I use?
[07:05:53] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:05:59] <bjz> so translate the example to the task at hand. you want to set up the rust repository, so don't use Spoon-knife
[07:06:10] <ash_136> i got that!!!
[07:06:15] <ash_136> I am getting confused because
[07:06:18] <ash_136> dbaupp
[07:06:21] <ash_136> told something 
[07:06:22] <ash_136> about
[07:06:25] <ash_136> changing the pointer
[07:06:30] <ash_136> in this link
[07:06:36] <ash_136> git remote add upstream https://github.com/mozilla/rust.git
[07:06:38] <ash_136> ??
[07:06:41] <ash_136> is this right?
[07:06:44] <bjz> yes
[07:06:47] <bjz> that is right
[07:06:50] <ash_136> :) thanks!
[07:06:55] <bjz> :P
[07:08:46] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[07:09:01] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[07:09:45] *** Joins: Ms2ger (Ms2ger@moz-C96856.adsl-dyn.isp.belgacom.be)
[07:11:14] <ash_136> done :D
[07:11:16] <ash_136> now next?
[07:12:41] <bjz> so you have cloned your fork, and added the remote?
[07:13:14] <ash_136> yes :)
[07:13:52] <bjz> now follow the instructions to build and install rust: https://github.com/mozilla/rust#linux--os-x
[07:16:03] <ash_136> ashvini@Ashvini:~/rust$ sudo make install g++ 4.4
[07:16:04] <ash_136> [sudo] password for ashvini: 
[07:16:04] <ash_136> make: *** No rule to make target `install'.  Stop.
[07:16:04] <ash_136> ??
[07:16:27] <dbaupp> you need ./configure too
[07:16:42] <Eridius> dammit borrowck
[07:17:10] <ash_136> how to get ./configure
[07:17:12] <dbaupp> ash_136: if you're on linux, just `make`
[07:17:15] <dbaupp> just run it
[07:17:34] <dbaupp> that is run ./configure 
[07:17:34] <ash_136> ashvini@Ashvini:~/rust$ make
[07:17:35] <ash_136> make: *** No targets specified and no makefile found.  Stop.
[07:17:36] <dbaupp> and then run make
[07:17:43] <dbaupp> and then `sudo make install`
[07:18:04] <ash_136> can you tell me how to run ./configure?
[07:18:15] <dbaupp> type that into your terminal and press enter
[07:18:39] <dbaupp> ashvini@Ashvini:~/rust$ ./configure
[07:18:58] <Luqman> > mkdir build && cd build && ../configure && make
[07:19:20] <ash_136> i ran it in rust directory it self
[07:19:42] <dbaupp> that works, but can be bad, occasionally.
[07:20:11] <dbaupp> Luqman's suggestion is better
[07:20:17] <ash_136> :(
[07:20:21] <ash_136> I already did it !!!!!!!!!11
[07:20:24] <dbaupp> you can do it again
[07:20:33] <dbaupp> it's not permanent
[07:20:36] * bjz is bad
[07:20:41] * dbaupp is too
[07:20:44] <Eridius> dbaupp: r? https://github.com/mozilla/rust/pull/9972
[07:20:44] <bjz> ^_^
[07:21:42] *** Joins: zeuxcg (zeuxcg@moz-CBF2B401.pppoe.avangarddsl.ru)
[07:22:14] <ash_136> Again i have to do it :/
[07:22:17] <ash_136> ?
[07:24:49] <dbaupp> Eridius: r+ with those comments
[07:24:58] <dbaupp> ash_136: yes, doing what Luqman suggests is better
[07:25:36] <Eridius> dbaupp: I tried explaining the trailing bytes thing at first, but decided I couldn't figure out a good phrasing
[07:25:49] <dbaupp> Eridius: bad phrasing is better than no phrasing
[07:25:57] <Eridius> yeah but the new behavior is the intuitive behavior really
[07:26:07] <Eridius> the fact that the old transmute() would preserve it A->B->A was actually very weird
[07:27:22] <dbaupp> Eridius: also, just thinking about it: it's probably worth being conservative with the multiplication and using checked_mul + .expect()
[07:27:40] <Eridius> the only possible way it could overflow is if the slice is damaged to begin with
[07:27:43] <ash_136> dbaupp: I did it 
[07:27:51] <ash_136> its happening in rust dirct
[07:27:51] <Eridius> you can't possibly access slice[slice.len()-1] under those circumstances
[07:27:58] <ash_136> what should I do now?!!
[07:28:04] <dbaupp> ash_136: what is "it"?
[07:28:12] <ash_136> ./configure
[07:28:42] <dbaupp> leave it for now, when ./configure finishes do what Luqman suggests
[07:28:48] <dbaupp> (it will be much faster the second time)
[07:29:02] <ash_136> okay 
[07:29:10] <ash_136> AFTER that all the installs ?
[07:29:19] <dbaupp> no, just after the ./configure
[07:29:43] <dbaupp> meh... I guess killing it now (ctrl-C) and doing the mkdir build thing is better
[07:32:07] <ash_136> too late
[07:32:10] <ash_136> it completed :P
[07:32:33] *** Joins: pyrac (pyrac@moz-61FEC861.w83-114.abo.wanadoo.fr)
[07:33:55] *** Quits: pyrac (pyrac@moz-61FEC861.w83-114.abo.wanadoo.fr) (Quit: pyrac)
[07:35:06] *** Quits: skade (skade@moz-D8051715.pools.arcor-ip.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:35:33] <Eridius> dbaupp: PR updated.
[07:35:48] <Eridius> oops damn
[07:35:52] <Eridius> I amended the wrong commit. hold on
[07:36:18] <Eridius> ok, there we go
[07:37:05] <Eridius> huh, github left the line note in there even though it's been addressed now
[07:37:19] *** Joins: pyrac (pyrac@moz-61FEC861.w83-114.abo.wanadoo.fr)
[07:37:20] <Eridius> but only when viewing full changes
[07:37:48] <ash_136> dbaupp: done 
[07:38:00] *** Quits: bytbox (s@moz-54E13927.washdc.fios.verizon.net) (Ping timeout)
[07:38:09] <ash_136> should I install all the g++ and other tools in build??
[07:38:10] *** Quits: eatkinson (eatkinson@moz-261EDE03.hsd1.ca.comcast.net) (Quit: eatkinson)
[07:38:38] *** Quits: fmtq (fmt@moz-5769BD38.static.tpgi.com.au) (Connection reset by peer)
[07:38:46] *** Joins: fmtq (fmt@moz-5769BD38.static.tpgi.com.au)
[07:41:55] *** Joins: Jackneill (Jackneill@moz-C73F60A1.pool.digikabel.hu)
[07:42:52] <bjz> ash_136: do you have the dependencies?
[07:42:57] <ash_136> nope
[07:43:01] <ash_136> I think i have perl
[07:43:02] <bjz> if not install them via apt-get
[07:43:12] <ash_136> in build dir??
[07:43:15] <ash_136> or rust dir??
[07:43:23] <bjz> try $ clang --version
[07:44:03] <ash_136>  g++ --version
[07:44:03] <ash_136> g++ (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3
[07:44:03] <ash_136> Copyright (C) 2011 Free Software Foundation, Inc.
[07:44:07] <ash_136> this should do right?
[07:44:11] <bjz> ok, that's fine
[07:44:37] <ash_136> Python 2.7.3
[07:44:39] <ash_136> fine?
[07:44:42] <bjz> yep
[07:44:57] <bjz> you probably have make and perl
[07:45:06] <ash_136> This is perl 5, version 14, subversion 2 (v5.14.2) built for x86_64-linux-gnu-thread-multi
[07:45:20] <bjz> curl --version?
[07:45:42] <ash_136> GNU Make 3.81
[07:45:57] <bjz> awesome
[07:45:59] <ash_136> curl 7.22.0 (x86_64-pc-linux-gnu) libcurl/7.22.0 OpenSSL/1.0.1 zlib/1.2.3.4 libidn/1.23 librtmp/2.3
[07:46:05] <bjz> ok, you're set
[07:46:15] <bjz> now do what luqman said
[07:46:30] <ash_136> I did that
[07:46:34] <ash_136> I created build
[07:46:37] <ash_136> and then
[07:46:43] <ash_136> ./configure
[07:46:53] *** Quits: alonlevy (alon@moz-3F073415.bb.netvision.net.il) (Ping timeout)
[07:46:59] <bjz> did you cd into the build directory?
[07:47:08] <ash_136> yes
[07:47:18] <bjz> and then ../configure?
[07:47:24] <ash_136> yes
[07:47:30] <bjz> and the make?
[07:47:46] <bjz> (I do make && make install)
[07:47:51] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[07:48:05] <bjz> that way it installs right after it finishes
[07:48:08] *** Quits: reedlepee (Mibbit@EC9A78E6.3CAE2EA8.9D59D0D8.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[07:48:14] <ash_136> did it now
[07:48:24] <bjz> so its finished compiling?
[07:48:40] <bjz> or just started?
[07:48:46] <ash_136> jus started
[07:48:52] <ash_136> after it completes i should run
[07:48:54] <ash_136> make install ?
[07:48:57] <bjz> llvm should take a *long* time to build
[07:48:59] <bjz> yep
[07:49:11] <ash_136> llvm ??
[07:49:16] <ash_136> what is that?
[07:49:27] <bjz> it's a compiler toolkit
[07:49:44] <bjz> the rust compiler spits out llvm ir
[07:49:57] <bjz> and llvm translates it into assembly code
[07:50:10] <bjz> and does lots of optimisations to it
[07:50:17] <ash_136> okay
[07:50:21] <ash_136> now after this?
[07:50:37] <ash_136> I should read the tutorial ?
[07:50:38] <ash_136> :O
[07:50:38] <bjz> after that rustc will compile automatically
[07:50:52] <ash_136> bjz: I am trying to apply for OPW
[07:51:04] <bjz> next time you build rust, it will will be much faster
[07:51:16] <bjz> because it won't have to build llvm again
[07:51:23] <ash_136> okay :)
[07:51:28] <bjz> yeah, I'd reccomend the tutorial
[07:51:31] <ash_136> bjz:I dont have much time since
[07:51:39] <bjz> it's really good
[07:51:41] <ash_136> only 3 weeks for deadline of application
[07:52:07] <ash_136> so tutorial and then bug fixing?
[07:52:12] <bjz> ah well, don't be afraid of asking questions
[07:52:20] <bjz> yeah, that would be best
[07:52:39] <bjz> Rust is written in Rust, so it helps to know the language a bit
[07:52:59] <ash_136> okay I will try reading by today 
[07:53:08] <ash_136> Can I work on bugs parallely?
[07:53:15] <bjz> but yeah, compiling stuff via make is kinda daunting the first time
[07:53:38] <dbaupp> ash_136: if you mean "can I work on bugs while reading the tutorial" yes
[07:53:49] <dbaupp> Eridius: ok
[07:54:11] <dbaupp> Eridius: but, I guess strcat's point is reasonable: maybe put the mut_slice one as a private function in rand/mod.rs?
[07:54:53] <dbaupp> Eridius: oh, you responded
[07:56:20] <dbaupp> Eridius: and I agree with you; provide restricted transmutes to package up the easy mistakes for certain classes of them
[07:56:38] *** Quits: darkf (darkf@moz-F9058B8A.net) (Ping timeout)
[07:58:18] *** Joins: reedlepee (Mibbit@EC9A78E6.3CAE2EA8.9D59D0D8.IP)
[07:58:28] *** Quits: Jackneill (Jackneill@moz-C73F60A1.pool.digikabel.hu) (Ping timeout)
[07:58:37] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[08:00:33] *** Joins: oberstet (quassel@moz-3BBC4C8A.dynamic.mnet-online.de)
[08:00:41] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[08:01:55] *** Quits: mihneadb (mihneadb@CC1999CD.4339B50.5BC07656.IP) (Ping timeout)
[08:02:06] <bjz> Eridius: ooh, that's nice
[08:02:17] <bjz> Eridius: good addition
[08:08:18] *** Quits: reedlepee (Mibbit@EC9A78E6.3CAE2EA8.9D59D0D8.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[08:09:19] *** Quits: heftig (heftig@moz-19B25E43.dip0.t-ipconnect.de) (Ping timeout)
[08:10:01] *** Joins: heftig (heftig@moz-19B25E43.dip0.t-ipconnect.de)
[08:13:20] *** Quits: ash_136 (ashvini@2533AB18.EDD19DB4.422D491.IP) (Ping timeout)
[08:13:33] *** Joins: ash_136 (ashvini@2533AB18.EDD19DB4.422D491.IP)
[08:16:27] *** Joins: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP)
[08:19:53] *** Joins: skade (skade@30BBD5E6.505237C9.CAE22B62.IP)
[08:20:06] *** Joins: alonlevy (alon@moz-B0E66DB7.static.bezeqint.net)
[08:23:19] *** Quits: KindOne (KindOne@moz-DA415F46.dynamic.ip.windstream.net) (Ping timeout)
[08:23:38] *** Quits: mark_edward (quassel@moz-DCB0B750.lightspeed.cicril.sbcglobal.net) (Client exited)
[08:23:39] *** Quits: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[08:23:50] *** Joins: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP)
[08:24:10] <SingingBoyo> So I've got an implementation of Eq for a trait, and a newtype for a struct that also has an impl for Eq... my trait is implemented by that newtype, but apparently rust is finding conflicting Eq impls :/
[08:24:17] <SingingBoyo> do newtype structs automagically get any implementations for the type they're a newtype of as well?
[08:24:23] *** Quits: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net) (Connection reset by peer)
[08:24:50] <SingingBoyo> https://github.com/singingboyo/evict/blob/single-issue-files/src/evict/date_sort.rs has the newtypes and the trait
[08:27:00] *** Joins: KindOne (KindOne@moz-857CFE41.dynamic.ip.windstream.net)
[08:27:01] *** Joins: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com)
[08:28:05] <SingingBoyo> actually hm I think I saw a bug about this at some point, don't mind me
[08:28:24] *** Joins: Jackneill (Jackneill@moz-5C16F392.pool.digikabel.hu)
[08:36:10] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[08:38:01] *** Quits: smerft (Mibbit@moz-44881D72.lns20.adl2.internode.on.net) (Ping timeout)
[08:40:47] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[08:41:20] *** Joins: nkoep (nik@moz-DC7F7F3E.pool.mediaways.net)
[08:43:34] *** Quits: pyrac (pyrac@moz-61FEC861.w83-114.abo.wanadoo.fr) (Quit: pyrac)
[08:45:00] <ash_136> bjz: I finished it :)
[08:45:42] *** Quits: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net) (Ping timeout)
[08:49:06] *** Joins: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net)
[08:50:28] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[08:51:55] *** Joins: CarpNet (Alasdair@moz-EF831A5E.cable.virginmedia.com)
[08:53:35] <dbaupp> ash_136: now you can get started on learning Rust and fixing bugs :)
[08:53:55] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[08:54:16] <dbaupp> SingingBoyo: "implementation of Eq for a *trait*"??
[08:54:20] <dbaupp> how does that work?
[08:55:44] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[08:56:14] <dbaupp> SingingBoyo: oh... it shouldn't
[08:56:28] <dbaupp> rusti: trait Foo {} impl<T: Foo> Eq for T {}
[08:56:31] -rusti- pastebinned 10 lines of output: http://ix.io/8CX
[08:56:50] <dbaupp> rusti: trait Foo {} impl<T: Foo> Eq for T { fn eq(&self, _: &T) -> bool { true } }
[08:56:52] -rusti- pastebinned 7 lines of output: http://ix.io/8CY
[08:58:03] <dbaupp> SingingBoyo: yeah, you can't do that, e.g. what if you implement CreationTimeTracker for uint, would it use the the eq defined in libstd, or would it use the one that it inherits from CreationTimeTracker
[09:00:11] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[09:01:14] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[09:02:10] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[09:03:46] <ash_136> dbaupp:thanks :) will come back later and lok bor bugs :D
[09:03:52] *** Joins: tgummerer_ (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP)
[09:04:34] <SingingBoyo> dbaupp: oh hmm.  Well that's annoying, though I guess it makes sense.
[09:04:52] *** Joins: Heo__ (Heo@13864F63.2DD6919B.56C9C5CA.IP)
[09:05:18] <SingingBoyo> dbaupp: I wouldn't expect it to complain until I actually did implement CreationTimeTracker for uint though.
[09:05:30] <SingingBoyo> (not that I'd do such a thing!)
[09:06:32] <dbaupp> SingingBoyo: yeah, in theory we could have a rule similar to that (since we have a more restrictions about how/where you can implement traits than (e.g.) Haskell)... but we don't yet
[09:06:49] *** Joins: pyrac (pyrac@moz-61FEC861.w83-114.abo.wanadoo.fr)
[09:08:14] <SingingBoyo> dbaupp: I wonder if there's a good way to allow naming impl so that they can be imported (or not imported) as needed.
[09:08:28] <SingingBoyo> dbaupp: Though that may be a whole can of worms that doesn't need opening
[09:09:12] <dbaupp> SingingBoyo: probably a very very large can too
[09:09:58] *** Quits: zeuxcg (zeuxcg@moz-CBF2B401.pppoe.avangarddsl.ru) (Ping timeout)
[09:10:38] <SingingBoyo> dbaupp: yeah.  naming for imports only might not be too bad.  But then someone would want to allow differentiation between multiple imported impls, and that would be ugly.
[09:14:07] <SingingBoyo> dbaupp: while you're around - what's the procedure for adding data structures to libextra/libstd?  just write it, create an issue/PR, and see what people think?
[09:14:19] <dbaupp> SingingBoyo: yeah, I can imagine that would lead to debugging headaches ("why isn't it using this impl?") and to some weird corner cases
[09:14:28] <dbaupp> SingingBoyo: for the most part, yes
[09:14:39] <dbaupp> what data structure?
[09:15:37] <dbaupp> (the "fringe" data structures are being suggested to be placed into an external repo and put on Rust-CI often.)
[09:16:33] <SingingBoyo> dbaupp: oh hmm okay.  nothing specific, since I haven't looked closely enough to see what exists that I just haven't seen, just idle curiosity.
[09:16:36] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[09:17:04] <SingingBoyo> dbaupp: one of my courses at the moment is Data Structures, so they're kind of on my mind :P
[09:18:57] <dbaupp> SingingBoyo: ah, I see :)
[09:19:16] <SingingBoyo> dbaupp: so by 'fringe', something like a skiplist for example?
[09:19:44] <dbaupp> yeah
[09:21:47] *** Joins: jeffdb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[09:23:14] *** Quits: bleibig (bleibig@moz-CB11172C.hsd1.ca.comcast.net) (Quit: bleibig)
[09:24:36] *** Quits: barosl (barosl@3DE683B6.E551553C.7544CABF.IP) (Quit: 랜덤은 쇠퇴했습니다.)
[09:24:52] *** Joins: zeuxcg (zeuxcg@moz-5E7FDC83.dynamic.avangarddsl.ru)
[09:30:17] <bjz> ash_136: awesome!
[09:30:19] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[09:36:40] *** Joins: berleon (leon@moz-42BDCACF.superkabel.de)
[09:45:49] *** Quits: ercxx (ercan@moz-7CFF3469.dyn.optonline.net) (Quit: WeeChat 0.4.2)
[09:46:11] *** Parts: csherratt (csherratt@moz-CAF331EA.cable.teksavvy.com) ()
[09:46:48] *** Quits: pyrac (pyrac@moz-61FEC861.w83-114.abo.wanadoo.fr) (Quit: pyrac)
[09:47:25] *** Quits: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com) (Quit: Leaving)
[09:47:31] *** Joins: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com)
[09:54:43] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[09:56:49] *** Joins: darkf (darkf@moz-F9058B8A.net)
[09:59:35] <AmunRa> Hello, is it possible to build static libs?
[10:01:07] <mcpherrin> AmunRa: Not all the infrastructure is there, but you can have rustc output the llvm IR, and then call llvm yourself to do it
[10:04:27] *** Joins: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net)
[10:06:51] *** Quits: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP) (Connection reset by peer)
[10:07:44] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[10:08:35] *** Quits: jeffdb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Quit: jeffdb)
[10:09:35] <ash_136> bjz : :)
[10:11:00] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Client exited)
[10:11:28] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[10:12:18] *** Quits: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP) (Connection reset by peer)
[10:13:09] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[10:15:35] *** Joins: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr)
[10:19:01] *** Quits: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com) (Ping timeout)
[10:22:15] *** Quits: Jackneill (Jackneill@moz-5C16F392.pool.digikabel.hu) (Ping timeout)
[10:23:21] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[10:28:25] *** Quits: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net) (Ping timeout)
[10:31:01] *** Joins: donri (donri@moz-9BB61102.tbcn.telia.com)
[10:31:08] *** Quits: canhtak (jeremy@moz-44A7DE0.wl.t.ulaval.ca) (Quit: canhtak)
[10:40:00] *** Quits: berleon (leon@moz-42BDCACF.superkabel.de) (Ping timeout)
[10:40:09] <ash_136> Hey anyone there to help for bug fixing ? :D
[10:40:54] *** Joins: Jackneill (Jackneill@moz-5C16F392.pool.digikabel.hu)
[10:42:46] *** Joins: MrFahrenheit (RageOfThou@3FEF494C.29C984D5.783DEDCA.IP)
[10:43:44] *** Joins: crembo (crembo@moz-C2B364AA.vc.shawcable.net)
[10:45:28] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Ping timeout)
[10:48:23] *** Joins: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com)
[10:51:02] <ash_136> hey I want to fix this bug https://github.com/mozilla/rust/issues/8005
[10:51:06] <ash_136> any one ?
[10:56:24] *** Quits: KindOne (KindOne@moz-857CFE41.dynamic.ip.windstream.net) (Ping timeout)
[10:56:27] *** Joins: Earnestly (earnest@moz-BE290A2B.dyn.plus.net)
[10:56:50] *** Joins: Ferreus (ferreus@moz-AE3CB44B.pools.arcor-ip.net)
[11:00:06] *** Joins: KindOne (KindOne@D9528BDE.5ADC762.34F73994.IP)
[11:03:59] <Ms2ger> So which is the good io system? std::io or std::rt::io?
[11:04:42] <ash_136> hello
[11:06:56] *** Quits: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com) (Ping timeout)
[11:07:52] *** Joins: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net)
[11:10:02] *** Joins: bjz (brendanzab@B398BE78.F804C29E.D35A31DF.IP)
[11:11:31] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[11:12:12] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[11:16:37] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[11:17:45] *** Joins: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net)
[11:17:46] *** ChanServ sets mode: +ao dherman dherman
[11:18:42] *** Quits: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net) (Quit: dherman)
[11:20:25] *** Joins: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net)
[11:20:25] *** ChanServ sets mode: +ao dherman dherman
[11:22:41] *** Quits: dherman (dherman@moz-A7B57B40.bltmmd.fios.verizon.net) (Ping timeout)
[11:25:51] *** Joins: canhtak (jeremy@moz-A67811CE.wl.t.ulaval.ca)
[11:28:20] *** Quits: dbaupp (Thunderbir@moz-54ADD9F4.lns20.syd6.internode.on.net) (Ping timeout)
[11:33:23] *** Joins: ksf (ksf@moz-8D2477CB.adsl.hansenet.de)
[11:33:37] <ksf> https://github.com/mozilla/rust/issues/4649
[11:33:42] <ksf> "Probably more importantly, the error should suggest what to do to fix it."
[11:34:07] <ksf> well, how *do* I fix it? I tried quite a few boxing, ownership and cloning tricks, but none helped.
[11:34:35] <ksf> here's an instance of that error: https://github.com/mozilla/rust/blob/master/src/test/compile-fail/bind-by-move-no-guards.rs
[11:34:40] <ash_136> ksf: is that answer for me?
[11:34:49] <ksf> nope, it's a question from me
[11:35:12] <ksf> ash_136, have patience, the channel is still largely sleeping.
[11:35:22] <ash_136> sorry :)
[11:35:49] <kimundi> ksf: You could bind by reference
[11:36:55] <kimundi> Instead of match foo { Some(x) if bar(x) => ... }, write match foo { Some(ref x) if bar(x) => ... } or so
[11:37:50] <kimundi> ash_136: What is your question?
[11:39:46] <ksf> \o/
[11:39:52] <ksf> that, and a clone later.
[11:39:57] * ksf needs to read up on ref
[11:40:01] *** Joins: dbaupp (Thunderbir@moz-54ADD9F4.lns20.syd6.internode.on.net)
[11:40:21] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Ping timeout)
[11:43:58] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[11:44:45] <kimundi> ksf: Not much to read up about, it'S mentioned once in the documentation afaik :P
[11:44:45] *** Joins: skippydippy (Mibbit@46FD1D54.A5C18E33.CE4FAC78.IP)
[11:45:04] <ksf> yeah, under matches, which I skipped, knowing them well from haskell...
[11:45:22] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[11:45:46] <eddyb> is static type inference TODO or WONTFIX?
[11:45:55] <kimundi> ksf: ref is a binding modifier. If a normal binding 'foo' gives you the value T, then 'ref foo' gives you &T, and 'ref mut foo' gives you &mut T
[11:45:56] <eddyb> rusti: static foobar = 0u8;
[11:45:59] -rusti- pastebinned 6 lines of output: http://ix.io/8D3
[11:46:03] <kimundi> eddyb: WONTFIX
[11:46:16] <kimundi> eddyb: static items require their api to be speeled out
[11:46:20] <eddyb> kimundi: but it breaks composition for me :(
[11:46:23] <kimundi> eddyb: same as function signatures
[11:46:33] <kimundi> how that?
[11:46:37] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[11:46:37] *** Quits: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net) (Client exited)
[11:46:57] <dbaupp> eddyb: there might be a typeof(...) at some point
[11:46:58] <eddyb> I need to write macros that take (: type = value) and return a similar thing
[11:47:06] * dbaupp isn't 100% sure of it though
[11:47:16] <kimundi> AH, that sounds more like typeof then
[11:47:41] <ksf> so you'd write static foobar : typeof( 0u8 ) = 0u8;?
[11:47:52] <kimundi> I guess
[11:47:55] <dbaupp> something like that
[11:48:10] <ksf> that'd be just inviting macros to reduce it to static!( foobar = 0u8 )
[11:48:11] *** Joins: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com)
[11:48:18] *** Joins: lidashuang (lidashuang@46FD1D54.A5C18E33.CE4FAC78.IP)
[11:48:27] <eddyb> but then my macros would still have to do : type = value
[11:48:33] <eddyb> aaaah, I see :P
[11:48:43] *** Quits: skippydippy (Mibbit@46FD1D54.A5C18E33.CE4FAC78.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[11:48:56] <dbaupp> the typeof keyword is reserved so that adding it is backward-compatible... but it's addition isn't definite
[11:49:32] <dbaupp> (not definite afaik, that is... maybe one of the coredevs is really set on having it... I don't know.)
[11:49:32] <eddyb> kimundi: although the macros with typeof wouldn't be that much different. simple inference (throw errors when ambiguous. maybe even behind a feature flag) would work better :/
[11:50:02] <kimundi> Well, it's a design decision
[11:50:05] <ksf> yay, the monomorphism restriction hits rust.
[11:50:18] <eddyb> eventually, I'd want to use constructors instead of macros in statics
[11:50:32] <kimundi> If you make statics inferable, then our type inference needs to get upgraded from function-local to whole-crate
[11:51:03] <eddyb> is it a performance issue?
[11:51:12] <ksf> shouldn't be
[11:51:13] <eddyb> or just tons of rewriting compiler code :P?
[11:51:15] <dbaupp> compilation performance maybe
[11:51:16] <kimundi> That, and it makes code harder to reason about
[11:51:54] <eddyb> oh, because then other things would depend on the inferred statics
[11:52:06] <kimundi> Idealla a fixed API should reman as stable as possible. If it is based on inference, then random changes somewhere might accidentially change it
[11:52:24] <dbaupp> CTFE is also a feature that's being thought about (and this one has one of the coredevs pushing it (pcwalton)) so (compile-time) ctors in statics is ok
[11:52:26] * ksf thinks limiting statics to ground types, and erroring out otherwise would be sufficient for clarity.
[11:52:30] <dbaupp> ... will be ok
[11:52:42] <dbaupp> (presumably post-1.0 though)
[11:52:51] <dbaupp> ksf: 
[11:52:57] <dbaupp> .. "ground types"?
[11:53:03] <ksf> non-polymorphic
[11:53:23] <dbaupp> they are currently, I believe (fwiw)
[11:53:31] <eddyb> ksf: non-generic?
[11:53:37] <ksf> yep.
[11:53:41] <dbaupp> rusti: static foo: Option<T> = None;
[11:53:43] -rusti- pastebinned 7 lines of output: http://ix.io/8D4
[11:53:55] <eddyb> rusti: static foo: Option<uint> = None;
[11:53:56] -rusti- ()
[11:53:58] <dbaupp> rusti: static<T> foo: Option<T> = None;
[11:54:00] -rusti- pastebinned 6 lines of output: http://ix.io/8D5
[11:54:21] <eddyb> nah, no generic statics. C++14 has templated constexprs, which are interesting
[11:54:36] <kimundi> I think those minds of static will appear in form of associated constants
[11:54:37] <ksf> c++ has templated everything.
[11:54:43] <ksf> rust has macros.
[11:55:00] <dbaupp> kimundi: what about the skulls?
[11:55:06] <kimundi> trait Foo { static MyType; } impl Foo for uint { static MyType = u16; }
[11:55:09] <eddyb> this is how my macros make the code look: static mut allocator SlamAllocator!(LinearAllocator!());
[11:55:18] <kimundi> kinds of statics*
[11:55:22] <ksf> kimundi, there could also be a distinction between static and pub static.
[11:55:24] <dbaupp> kimundi: :P
[11:55:28] <eddyb> (well, I forgot a parameter there, but you get the idea)
[11:55:30] <dbaupp> eddyb: that works now?
[11:55:36] <ksf> the latter always needing a type, the former not as they're not changing api.
[11:55:45] <eddyb> dbaupp: both macros expand to : type = value
[11:55:50] <dbaupp> rusti: static mut x macro!(whatever!());
[11:55:52] -rusti- pastebinned 6 lines of output: http://ix.io/8D6
[11:56:04] <dbaupp> eddyb: this is contained in another macro?
[11:56:36] <eddyb> dbaupp: SlamAllocator! expects : type = value, because it's generic
[11:56:47] <eddyb> dbaupp: wait, is there a reason my expansion shouldn't work?
[11:57:21] <eddyb> rusti: macro_rules! macro () static mut x macro!(whatever!());
[11:57:22] -rusti- pastebinned 6 lines of output: http://ix.io/8D7
[11:57:39] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[11:57:46] <dbaupp> eddyb: yes, there are a (small) finite set of position in which a macro is allowed
[11:57:50] <eddyb> dbaupp: oh you've got to be kidding me
[11:58:19] <kimundi> It's not just dumb text macros, so the grammar has to fit them. But we really need to support them in more places
[11:58:22] <dbaupp> eddyb: I'm sure there's a way around it
[11:58:23] <eddyb> rusti: macro_rules! macro (() => (uint)) static mut x : macro!();
[11:58:26] -rusti- pastebinned 6 lines of output: http://ix.io/8D8
[11:58:47] <eddyb> rusti: macro_rules! macro (() => (uint = 0)) static mut x : macro!();
[11:58:49] -rusti- pastebinned 6 lines of output: http://ix.io/8D9
[11:58:51] <kimundi> I think your best bet is to write a macro that expands to the whole static declaration :P
[11:59:12] <dbaupp> kimundi: support in more places: https://github.com/mozilla/rust/issues/7727#issuecomment-21620454
[11:59:14] <eddyb> kimundi: can I parse that declaration when it's passed to another macro?
[11:59:44] <dbaupp> eddyb: maybe
[11:59:48] <dbaupp> but probably not
[11:59:54] <kimundi> I'm not sure what that means
[12:00:09] <dbaupp> what is the code that the macros create?
[12:00:33] <eddyb> kimundi: can I parse the argument from inside macro? macro!(static mut name : type = value)
[12:00:53] <dbaupp> eddyb: yes, but foo!(bar!()) expands foo and then bar iirc.
[12:00:55] <kimundi> should work I think
[12:01:05] <eddyb> dbaupp: please be wrong
[12:01:33] <kimundi> Why does the order matter?
[12:01:49] <eddyb> kimundi: because that static declaration is created by anotehr macro
[12:01:52] <dbaupp> rusti: macro_rules! foo ( () => { static x: int = 1; }; (static $x:ident: $ty:type = $expr;) => { 1 } ) foo!(foo!())
[12:01:54] -rusti- pastebinned 9 lines of output: http://ix.io/8Da
[12:02:07] <kimundi> Ah. THAT might be a problem then.
[12:02:16] <dbaupp> rusti: macro_rules! foo ( () => { static x: int = 1; }; (static $x:ident: $ty:type = $e:expr;) => { 1 } ) foo!(foo!())
[12:02:20] -rusti- pastebinned 9 lines of output: http://ix.io/8Db
[12:02:32] <dbaupp> rusti: macro_rules! foo ( () => { static x: int = 1; }; (static $x:ident: $ty:ty = $e:expr;) => { 1 } ) foo!(foo!())
[12:02:34] -rusti- pastebinned 6 lines of output: http://ix.io/8Dc
[12:02:41] <dbaupp> eddyb: there.
[12:02:44] <dbaupp> I'm correct :(
[12:03:17] * eddyb /o\
[12:03:29] *** Quits: brendanc (brendan@moz-CA4BEC19.cs.ubc.ca) (Ping timeout)
[12:03:31] <pcmattman> hmm, the syntax seems like it should expand the inner before the outer
[12:03:48] <dbaupp> eddyb: what's the (expanded) code that you are trying to create with LinearAllocator!() and SlamAllocator!()?
[12:03:50] * pcmattman could be wrong though
[12:04:02] <dbaupp> it can't
[12:04:02] *** Quits: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP) (Connection reset by peer)
[12:04:09] <dbaupp> the outer one can do whatever it likes with the inner token tree
[12:04:11] * ksf wants monads.
[12:04:17] <pcmattman> huh, awesome
[12:04:25] <dbaupp> there's no guarantee that it treats it like Rust source
[12:04:30] <pcmattman> that is not intuitive
[12:04:32] <dbaupp> e.g. https://github.com/mozilla/rust/blob/master/src/test/run-pass/html-literals.rs
[12:04:35] <ksf> all this chaining of Result<> shouts for them
[12:04:42] <eddyb> dbaupp: name : SlamAllocator<LinearAllocator<[u8, ..(N)]>> = SlamAllocator { base: LinearAllocator {...}, ...}
[12:04:59] <dbaupp> rusti: stringify!(println!("foo"))
[12:05:01] -rusti- "println ! ( \"foo\" )"
[12:05:11] <dbaupp> ksf++++++++
[12:05:30] <kimundi> Ha, so the bang _is_ a singluar token and not part of the macro ident
[12:05:40] * kimundi solved another mystery
[12:06:02] <dbaupp> eddyb: it's ugly, but how about static name: SlamAllocType!(LinearAllocType!()) = SlamAlloc!(LinearAlloc!());
[12:06:16] <eddyb> dbaupp: you're still duplicating N
[12:06:27] <dbaupp> eddyb: is that an arg to linearalloc?
[12:06:36] <dbaupp> you shoulda said ;P
[12:06:40] <eddyb> static mut name: SlamAllocType!(LinearAllocType!(4 * 1024 * 1024)) = SlamAlloc!(LinearAlloc!(4 * 1024 * 1024));
[12:06:44] <eddyb> that's not nice :(
[12:06:51] <dbaupp> yeah, but at least it's possible
[12:07:17] * dbaupp thinks that the property of "being possible" is pretty useful 
[12:07:32] <dbaupp> eddyb: do you need to be generic over the inner allocator for the moment?
[12:08:11] <dbaupp> because `SlamLinearAlloc!(name, 4 * (1 << 20))` expanding to the static mut might work too
[12:08:26] *** Joins: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au)
[12:08:44] <eddyb> dbaupp: but... I wanted composition... :((
[12:08:51] *** Joins: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net)
[12:09:07] <dbaupp> eddyb: yup :(
[12:09:12] <eddyb> inference + ctors would make all of this go away
[12:09:42] <dbaupp> you can't have everything (yet)
[12:09:58] * eddyb goes back to crying in his corner
[12:11:09] <dbaupp> rusti: macro_rules! foo ( ($i:ident) => { ($i !("foo {}", 1)) } ) foo!(println)
[12:11:09] -rusti- foo 1
[12:11:09] -rusti- ()
[12:11:12] <dbaupp> \o/
[12:11:38] <eddyb> waaaait, you can do that?
[12:11:41] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[12:11:42] <kimundi> wut?
[12:11:42] * eddyb baffled
[12:11:42] <dbaupp> rusti: macro_rules! foo ( ($i:ident, $tokens:tt) => { ($i !($tokens)) } ) foo!(println, "foo", 1)
[12:11:44] -rusti- pastebinned 6 lines of output: http://ix.io/8Dd
[12:11:54] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[12:12:07] <dbaupp> rusti: macro_rules! foo ( ($i:ident, $($tokens:tt),*) => { ($i !($($tokens),*)) } ) foo!(println, "foo", 1)
[12:12:08] *** Joins: brendanc (brendan@moz-CA4BEC19.cs.ubc.ca)
[12:12:08] -rusti- pastebinned 7 lines of output: http://ix.io/8De
[12:12:17] <dbaupp> rusti: macro_rules! foo ( ($i:ident, $($tokens:tt),*) => { ($i !($($tokens),*)) } ) foo!(println, "foo {}", 1)
[12:12:18] -rusti- foo 1
[12:12:18] -rusti- ()
[12:12:20] <dbaupp> \o/
[12:12:22] <eddyb> so I can have my for_each! macro.... interesting
[12:12:22] <kimundi> That seems like an horrible unintentional workaround xD
[12:12:30] <dbaupp> kimundi: s/horrible/awesome/
[12:12:37] <kimundi> indeed
[12:12:37] <pcmattman> o_o
[12:12:48] <dbaupp> (the "obvious" consequence of ! being a separate token)
[12:13:03] <kimundi> haha
[12:13:29] <dbaupp> rusti: macro_rules! foo ( ($i:ident, $($tokens:tt),*) => { { $i !($($tokens),*);  concat_idents!($i, ln) !($($tokens),*); } } ) foo!(print, "foo {}: ", 1)
[12:13:31] -rusti- pastebinned 6 lines of output: http://ix.io/8Df
[12:13:42] <dbaupp> :'(
[12:14:04] <eddyb> can I match the result of applying a macro like that?
[12:14:07] <bjz> concat_idents! is broken isn't it?
[12:14:28] <kimundi> It is
[12:14:32] <dbaupp> bjz: not entierly
[12:14:53] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[12:14:59] *** Quits: brendanc (brendan@moz-CA4BEC19.cs.ubc.ca) (Ping timeout)
[12:15:27] <dbaupp> rusti: macro_rules! foo ( ($i:ident) => { (concat_idents!($i, ln)("foo")) } ) foo!(print)
[12:15:28] -rusti- foo
[12:15:28] -rusti- ()
[12:15:32] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[12:15:43] <dbaupp> (that does 'print' + 'ln')
[12:15:56] <dbaupp> eddyb: "match"?
[12:16:02] <eddyb> if concat_idents worked, I could have a CtorMacro and CtorMacroType, and compose that way
[12:16:20] <dbaupp> yeah, you currently need Outer(Ctor, CtorType, ...) I guess
[12:16:25] <dbaupp> *Outer!(...)
[12:17:04] <eddyb> dbaupp: so SlamAllocator! would receive LinearAllocator, it would apply the arguments on it, and then extract the static declaration out of the expansion
[12:17:24] <dbaupp> eddyb: yeah, don't think that would work
[12:17:31] * dbaupp wants expand_inner!(..)
[12:18:13] <dbaupp> https://github.com/mozilla/rust/pull/9740#issuecomment-25762329
[12:19:52] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[12:20:41] *** Joins: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP)
[12:21:34] <eddyb> alternatively, give me integers for generic parameters so I don't need to use this hack :/
[12:22:43] * dbaupp wants that too
[12:26:12] *** jorendorff_away is now known as jorendorff
[12:26:56] *** Joins: engla (engla@B362E760.9F8E6AA1.9F815DDE.IP)
[12:30:49] *** Joins: bitshifternz (cam@moz-3971750F.static.tpgi.com.au)
[12:34:03] <bitshifternz> I was wondering what the state of debugging rust is?
[12:34:07] <bitshifternz> I compiled with -Z debug-info and ran elf with gdb but couldn't work out how to load up a .rs or break on a function defined in rust 
[12:34:46] * ksf wants an applicitive functor to collect his Result<>s into a struct :)
[12:35:21] <bitshifternz> any tips?
[12:35:36] *** Joins: nexzen (Mibbit@2D222BF.F8E55E4A.CEE90721.IP)
[12:36:31] *** Joins: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com)
[12:37:53] *** jorendorff is now known as jorendorff_away
[12:40:18] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[12:40:23] <dbaupp> bitshifternz: try -Z extra-debug-info
[12:40:52] <eddyb> expected item but found `;`
[12:40:58] <eddyb> dbaupp: --pretty=expanded doesn't work :(
[12:41:23] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[12:41:28] <eddyb> (i.e. it changes nothing)
[12:42:02] <dbaupp> eddyb: if there's an error in expansion then --pretty=expanded won't work
[12:42:28] <dbaupp> try setting `trace_macros!(true)` or something
[12:42:32] * dbaupp shrugs
[12:42:50] <dbaupp> and/or log_syntax!()
[12:42:51] <ksf> gragl applicative functors won't work, not enough currying in rust.
[12:43:24] <eddyb> need more curry
[12:44:12] <ksf> or what's the idiomatic rust way to turn a couple of Result<>s into a Result<Struct,...> that contains them all, or the first encountered error?
[12:44:40] <engla> there is a function for that in std::result I think
[12:44:48] <engla> std::result::{collect,fold,fold_}
[12:44:50] <dbaupp> rusti: trace_macros!(true); println!("foo") // eddyb
[12:44:52] -rusti- pastebinned 6 lines of output: http://ix.io/8Dn
[12:44:54] <ksf> hmmm collect?
[12:44:56] <dbaupp> that might help too
[12:45:04] <ksf> Iterators aren't polymorphic, aren't they?
[12:45:09] <eddyb> dbaupp: I can't have ; after a macro :/
[12:45:12] <engla> collect is  Iterator<Result<V,E>> -> Result<~[V], E>
[12:45:16] <dbaupp> eddyb: oh, yeah, that
[12:45:21] <dbaupp> eddyb: just remove it
[12:45:38] <dbaupp> eddyb: you can use { .. } grouping on an item macro though, if you think that looks nicer
[12:45:44] <dbaupp> (i.e. foo! { ... }
[12:45:44] <dbaupp> )
[12:46:23] <ksf> yep, collect only gives me a ~[T]
[12:46:49] <dbaupp> ksf: "Iterators aren't polymorphic" what do you mean by that?
[12:47:03] <dbaupp> they can't contain multiple types?
[12:47:06] <ksf> you can't yield a different element type each time.
[12:47:07] <ksf> yes
[12:47:15] <eddyb> use variants
[12:47:21] <engla> you can yield trait objects
[12:47:26] <eddyb> or that
[12:47:29] <engla> it's the same as anywhere in rust
[12:47:48] <dbaupp> yeah, they're essential an "enhanced" version of Haskell's [T]
[12:48:19] <ksf> but I *do* know their exact types. one is a string, the other a url, yet another a treemap, and I've got them in Results and want to have a struct of them, or an error.
[12:48:39] <ksf> going via traits or such would probably be more code than just rolling the whole stuff manually.
[12:48:44] <eddyb> dbaupp: I cannot have a macro declaring the static variable, using macros itself, for the same reason I cannot do it outside of a macro
[12:48:56] <dbaupp> ksf: there's a nice macro give me a second
[12:49:08] <ksf> that's what I wanted to hear :)
[12:49:19] <dbaupp> eddyb: static mut foo: macro!() = macro!() should work?
[12:49:34] <eddyb> dbaupp: nope, it doesn't
[12:49:34] *** Joins: BitPuffin (isak@moz-98F8BF74.cust.tele2.se)
[12:49:36] <engla> ksf: if it's only three values, you can use match? match (a,b,c) { (Ok(a), Ok(b), Ok(c)) => ...    // but extracting the first error is messier I guess.
[12:50:15] <ksf> it's five, plus three nested ones
[12:51:04] <dbaupp> oh... eurgh. can't use a macro to expand to a type :(
[12:51:53] <eddyb> inference would be nice right about now
[12:52:34] <dbaupp> ksf: https://github.com/mozilla/rust/blob/master/src/librustc/middle/borrowck/mod.rs#L35-L42
[12:52:34] <dbaupp> eddyb: yep
[12:52:34] <dbaupp> eddyb: I think you've got no other choice than just typing more things/having less composition for now :(
[12:53:48] <dbaupp> ksf: used like https://github.com/mozilla/rust/blob/master/src/librustc/middle/typeck/infer/sub.rs#L186
[12:54:05] <ksf> that makes the whole thing easier, yes.
[12:54:19] <dbaupp> (i guess https://github.com/mozilla/rust/blob/master/src/librustc/middle/typeck/infer/lattice.rs#L288-L291 makes it clearer)
[12:56:22] *** Quits: z0w0 (zack@moz-C877F2F7.lnse2.cha.bigpond.net.au) (Client exited)
[12:58:04] <ksf> oh, I got it. the problem now is that rustc ignores #[feature(macro_rules)] in my top-level .rc
[12:58:36] *** Quits: engla (engla@B362E760.9F8E6AA1.9F815DDE.IP) (Ping timeout)
[12:58:41] <eddyb> *macros
[13:00:20] <dbaupp> ksf: put a `;` at the end of the attribute
[13:00:40] <ksf> that was it, yes.
[13:00:52] <eddyb> nvm, why did I think it was feature(macros)?
[13:01:27] <eddyb> dbaupp: now something else is going on... why can't I have a generic impl?
[13:01:38] <eddyb> or why does it do this? cannot determine a type for this bounded type parameter: unconstrained type
[13:01:53] <dbaupp> code?
[13:02:17] *** Joins: engla (engla@B362E760.9F8E6AA1.9F815DDE.IP)
[13:02:30] <ksf> \o/
[13:02:34] <kimundi> YOu can implement generically
[13:03:47] <eddyb> oh, I can, I just can't have functions not using the type parameters and there's no auto-borrow
[13:04:56] *** Quits: lidashuang (lidashuang@46FD1D54.A5C18E33.CE4FAC78.IP) (Connection reset by peer)
[13:05:12] <dbaupp> "auto-borrow"?
[13:05:26] *** Joins: squiddy (squiddy@moz-E4B3962C.adsl.alicedsl.de)
[13:07:35] <eddyb> dbaupp: for some reason I was expecting I could pass the argument as if it was by value and it would automatically borrow a reference
[13:07:42] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[13:08:23] *** Quits: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu) (Ping timeout)
[13:08:31] <dbaupp> eddyb: well, references are values
[13:08:53] <dbaupp> but yeah, foo(x) never becomes foo(&x) magically
[13:09:14] <eddyb> dbaupp: so this is the code that builds:
[13:09:16] <eddyb> static mut allocator : slam::SlamAllocator<LinearAllocator<[u8, ..STATIC_HEAP_SIZE]>> = SlamAllocator!(LinearAllocator!(STATIC_HEAP_SIZE));
[13:10:25] <dbaupp> eddyb: better than nothing /o/
[13:10:49] *** Joins: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca)
[13:12:01] <eddyb> rusti: mod std { fn foobar(){} } std::foobar()
[13:12:04] -rusti- pastebinned 7 lines of output: http://ix.io/8Do
[13:12:15] <eddyb> rusti: mod std { pub fn foobar(){} } std::foobar()
[13:12:16] -rusti- ()
[13:13:01] <eddyb> although... if something else imports std, they won't see my "injected" function, would they?
[13:13:41] <dbaupp> rusti: mod std { pub fn foobar(){} } std::str::with_capacity(4)
[13:13:43] -rusti- pastebinned 13 lines of output: http://ix.io/8Dp
[13:13:58] <dbaupp> eddyb: doesn't work as you want :P
[13:14:14] <dbaupp> '<opaque>::std' weird
[13:14:28] <eddyb> dbaupp: I need to inject a function or a static in here: https://github.com/thestinger/rust-core/blob/master/core/heap.rs
[13:14:52] <eddyb> dbaupp: without touching rust-core's source tree
[13:14:56] <dbaupp> eddyb: you're gonna have to inject it with your editor and it's save button/keyboard combo
[13:15:02] <dbaupp> (so no, it's impossible)
[13:15:59] <eddyb> I was suggesting using macros to define exchange_free/exchange_malloc - which would work, but then the free/malloc/realloc (especially realloc) functions wouldn't be available for direct use
[13:16:25] <eddyb> dbaupp: so I need to move all the allocator code in rust-core and control it with cfg?
[13:17:12] <eddyb> gaah I'll never get anything done
[13:17:37] <dbaupp> something like that
[13:17:54] <dbaupp> (Rust should have a very very hairy yak as it's mascot at the moment.)
[13:17:59] <dbaupp> *its
[13:18:08] <eddyb> (implementing the imported C functions requires me to write a proxy in C for each of them, calling the appropriate Rust implementation. and bye bye fast inlined allocation)
[13:18:16] <eddyb> dbaupp: hahahaha
[13:18:26] *** Joins: reedlepee (Mibbit@B424C7C1.213EDE4D.9D59D0D8.IP)
[13:18:50] <dbaupp> eddyb: are you sure LLVM won't inline it? 
[13:19:12] <dbaupp> eddyb: (especially with https://github.com/mozilla/rust/wiki/Mixed-language-link-time-optimization )
[13:20:58] <eddyb> dbaupp: well, we are using clang. but it won't inline directly, without LTO enabled
[13:21:53] <dbaupp> yes, can you enable LTO?
[13:22:05] <eddyb> dbaupp: I also want to get rid of the C code (which is trivial, apart from this proxy nonsense)
[13:23:39] <eddyb> the asm will be a little trickier, but some of it is already implemented in Rust (like the GDT, the asm file has a manually written version)
[13:27:52] *** Quits: dbaupp (Thunderbir@moz-54ADD9F4.lns20.syd6.internode.on.net) (Ping timeout)
[13:28:02] <eddyb> dbaupp: shaving yaks, painting bikes and chasing rabbits
[13:28:19] <eddyb> that was some bad timing :(
[13:28:49] *** Quits: bitshifternz (cam@moz-3971750F.static.tpgi.com.au) (Quit: Ex-Chat)
[13:29:32] *** jorendorff_away is now known as jorendorff
[13:33:24] *** Joins: maik (maik@moz-39AE504.dip0.t-ipconnect.de)
[13:34:16] *** Joins: dbaupp (Thunderbir@moz-54ADD9F4.lns20.syd6.internode.on.net)
[13:37:41] *** Quits: glennsl (textual@moz-5D7B804F.getinternet.no) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[13:38:11] <eddyb> dbaupp: ahem, as I was saying
[13:38:15] <eddyb> dbaupp: shaving yaks, painting bikes and chasing rabbits
[13:39:28] <dbaupp> eddyb: hahaha
[13:40:31] <eddyb> reinventing the wheel with higher-dimension polymorphism just so you can drive in hyperspace
[13:44:00] <eddyb> dbaupp: it's not as addicting as reverse engineering, but I'm still in love with Rust
[13:49:26] *** Quits: engla (engla@B362E760.9F8E6AA1.9F815DDE.IP) (Ping timeout)
[13:51:42] *** Quits: squiddy (squiddy@moz-E4B3962C.adsl.alicedsl.de) (Ping timeout)
[13:54:26] *** Joins: bytbox (s@moz-54E13927.washdc.fios.verizon.net)
[13:55:54] <eddyb> dbaupp: idea: rust-core does: use core_impls::*; in one of its modules. then that core_impls module can be from rust-core, using libc functions (and probably behind a cfg), or it can be provided by the user of rust-core
[13:57:33] <eddyb> rusti: mod foo { fn bark() {} } mod bar { use foo::*; } bar::bark()
[13:57:33] *** Joins: engla (engla@B362E760.9F8E6AA1.9F815DDE.IP)
[13:57:35] -rusti- pastebinned 10 lines of output: http://ix.io/8Dr
[13:57:42] <eddyb> rusti: mod foo { pub fn bark() {} } mod bar { use foo::*; } bar::bark()
[13:57:44] -rusti- pastebinned 10 lines of output: http://ix.io/8Ds
[13:58:05] <eddyb> hmm, how do I make that work?
[13:58:47] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Client exited)
[13:59:13] <eddyb> rusti: pub mod foo { pub fn bark() {} } mod bar { use foo::*; } bar::bark()
[13:59:15] -rusti- pastebinned 10 lines of output: http://ix.io/8Dt
[13:59:37] <eddyb> rusti: pub mod foo { pub fn bark() {} } mod bar { pub use ::foo::*; } bar::bark()
[13:59:39] -rusti- pastebinned 6 lines of output: http://ix.io/8Du
[13:59:52] <eddyb> rusti: pub mod foo { pub fn bark() {} } mod bar { pub use super::foo::*; } bar::bark()
[13:59:54] -rusti- pastebinned 10 lines of output: http://ix.io/8Dv
[14:00:13] <benh> rusti: mod foo { pub fn bark() {} } mod bar { use foo::*; } bar::bark(); 
[14:00:16] -rusti- pastebinned 10 lines of output: http://ix.io/8Dw
[14:00:18] <eddyb> >_>
[14:00:32] <benh> I think the problem might be that rusti nests everything inside main
[14:00:46] <eddyb> but it would work otherwise?
[14:00:54] <myname> is there something like "pub use"?
[14:00:58] <benh> mod bar { pub use foo::*; } seems to work for me
[14:01:02] <eddyb> myname: it is pub use
[14:01:15] <eddyb> (unless you want to know what it does)
[14:01:48] <eddyb> benh: the question was if it could pull foo at all. but since rust-core is inside my crate, I don't see why it couldn't :D
[14:03:40] <ash_136> I want to fix a bug
[14:03:44] <ash_136> anyone wants to help?
[14:04:06] <eddyb> ash_136: show us the bug
[14:06:59] *** Joins: SiegeLord (sl@moz-CAF07B4C.hsd1.ma.comcast.net)
[14:08:32] *** Quits: nexzen (Mibbit@2D222BF.F8E55E4A.CEE90721.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[14:10:26] *** Quits: engla (engla@B362E760.9F8E6AA1.9F815DDE.IP) (Ping timeout)
[14:14:02] *** Joins: engla (engla@moz-B4C2DBB.dialup.ice.net)
[14:15:01] *** Joins: brendanc (brendan@moz-CA4BEC19.cs.ubc.ca)
[14:16:52] *** jorendorff is now known as jorendorff_away
[14:20:39] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[14:21:33] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[14:21:54] <eddyb> is there a way to pull values from cfg into Rust?
[14:22:26] <bjz> cfg! I think
[14:22:45] <ash_136> https://github.com/mozilla/rust/issues/8005
[14:22:46] <kimundi> that just evaluates to true and false, though
[14:22:51] <ash_136> I want to fix this bug
[14:22:53] <eddyb> kimundi: was going to say that :(
[14:23:00] <ash_136> is it good for a beginner ?
[14:23:33] <eddyb> ash_136: it sounds trivial, depends on the internals
[14:23:33] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Ping timeout)
[14:23:58] <ash_136> ok how to start ?
[14:24:28] <bjz> ash_136: probably would want to search for where the message is in the code basee
[14:24:34] <eddyb> ash_136: you should find where that error is reported from and see if you can add a special case if it's caused by a semicolon after the last statement
[14:24:39] <eddyb> bjz: I'm slow :(
[14:25:02] <eddyb> ash_136: or you can probably catch this problem earlier, before flow control analysis
[14:25:02] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[14:25:08] <ash_136> okay can you show me a program which will generate this error?
[14:25:11] <ash_136> simple one?
[14:25:15] <bjz> ash_136: eddyb is right too, you don't want to change it for all cases, since its still a useful message
[14:25:33] <eddyb> rusti: fn foobar() -> int {0;}
[14:25:35] -rusti- pastebinned 7 lines of output: http://ix.io/8Dz
[14:25:45] <eddyb> ash_136: ^^
[14:26:12] <bjz> where the user would have intended: `fn foobar() -> int {0}`
[14:26:30] <bjz> (possibly)
[14:26:58] <bjz> ash_136: do you understand how rust expressions work?
[14:27:54] <eddyb> depending on where you fix this, you could leave the original error and add something like a suggestion: "extra semicolon after last expression in function with a return type" or something along those lines
[14:28:05] <eddyb> rusti: fn foobar() -> int {return 0;}
[14:28:05] -rusti- ()
[14:28:26] *** Joins: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com)
[14:28:34] <eddyb> rusti: fn foobar() -> int {if true {return 0;} else {return 1;};}
[14:28:35] -rusti- ()
[14:28:39] <bjz> http://static.rust-lang.org/doc/master/tutorial.html#expressions-and-semicolons
[14:29:03] <ash_136> eddyb: I am new to rust
[14:29:07] <eddyb> this should be handled only when the error occurs, I'm afraid. you would end up with false positives if you do it before
[14:29:07] <ash_136> I went through the manual
[14:29:21] <bjz> rusti: fn foobar() -> int {if true {0} else {1};}
[14:29:23] -rusti- pastebinned 7 lines of output: http://ix.io/8DB
[14:29:28] <bjz> rusti: fn foobar() -> int {if true {0} else {1}}
[14:29:28] -rusti- ()
[14:29:37] <eddyb> return special-cases everything
[14:29:38] *** Quits: maik (maik@moz-39AE504.dip0.t-ipconnect.de) (Ping timeout)
[14:30:23] *** Quits: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com) (Client exited)
[14:30:32] <ash_136> eddyb: where can i find the error?
[14:30:44] *** Joins: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com)
[14:32:05] <eddyb> ash_136: search the librustc code
[14:32:29] *** Quits: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com) (Ping timeout)
[14:32:29] *** Quits: ash_136 (ashvini@2533AB18.EDD19DB4.422D491.IP) (Ping timeout)
[14:33:00] <eddyb> eddy@eddy-laptop ~/P/rust> grep -r 'not all control paths return a value' src/librustc
[14:33:02] <eddyb> src/librustc/middle/liveness.rs:                    sp, "not all control paths return a value");
[14:33:33] * eddyb is not sure what level of user-friendliness to use
[14:34:17] <bjz> eddyb: oh, left the channel
[14:34:41] <eddyb> pfffft, and I pasted two lines of spam. gj me
[14:37:48] *** Quits: spider-mario (spidermari@moz-81131DB6.fbx.proxad.net) (Input/output error)
[14:39:50] * bjz shakes fist at eddyb
[14:41:00] *** Quits: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net) (Connection reset by peer)
[14:41:04] *** Joins: ambimorph (amber@moz-F1964F26.hlrn.qwest.net)
[14:41:05] *** Quits: wolfwood (wolfwood@moz-A19F104D.pitbpa.fios.verizon.net) (Connection reset by peer)
[14:42:58] *** Joins: cubic (cubic@moz-FE5AD6C7.mc.videotron.ca)
[14:44:24] *** Joins: crembo (crembo@moz-C2B364AA.vc.shawcable.net)
[14:45:08] *** Joins: wilkie (wilkie@moz-A19F104D.pitbpa.fios.verizon.net)
[14:46:04] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Ping timeout)
[14:46:25] *** Joins: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com)
[14:46:35] *** Joins: odb18 (odb18@moz-2C7B4B1D.san.res.rr.com)
[14:46:41] *** Parts: odb18 (odb18@moz-2C7B4B1D.san.res.rr.com) ()
[14:46:47] *** Joins: gunther (Mibbit@moz-4A19983C.ip227.fastwebnet.it)
[14:47:05] *** Joins: geert (geert@moz-5EFDD81E.access.telenet.be)
[14:47:30] <gunther> is there a website which lists the methods for each type?
[14:47:41] <cmr> gunther: the documentation?
[14:47:48] <gunther> yes
[14:48:10] <cmr> http://static.rust-lang.org/doc/master/std/index.html
[14:48:25] *** Joins: myra (myra@9B9315E1.A6025CA.1C37C358.IP)
[14:48:37] <gunther> thanks
[14:48:43] *** Joins: ash_136 (ashvini@BA56CB4C.F9E46DD1.E5F05D4F.IP)
[14:48:48] *** Parts: myra (myra@9B9315E1.A6025CA.1C37C358.IP) ()
[14:53:36] <Yurume> SimonSapin, I'm semi-re-working on rust-encoding, do you have any new issues or so?
[14:53:37] *** Joins: crembo (crembo@moz-C2B364AA.vc.shawcable.net)
[14:55:15] <ash_136> Anyone help on this bug ?
[14:55:21] <ash_136> please a beginner here
[14:55:26] <ash_136> so not able to figure things out
[14:56:52] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[14:56:57] <Yurume> ash_136, one can help you only after you have described what your issue is ;)
[14:58:04] <eddyb> Yurume: he already did and we already tried to help :/
[14:58:12] <Yurume> aha
[14:58:18] <Yurume> sorry I haven't scrolled the log
[14:58:27] * Yurume started reading the log
[14:58:32] <SiegeLord> Not to be a negative Nancy, but trying to fix bugs in rustc of all things is a bad way to learn Rust...
[15:00:26] <Yurume> rusti: fn t() -> int { 4; }
[15:00:36] -rusti- failed to pastebin 7 lines of output
[15:00:36] <SiegeLord> I recall spending multiple days fixing a bug in rustc, and it ended up being a fix of only a few lines
[15:00:37] <Yurume> ...ha?
[15:00:51] <cmr> SiegeLord: yup!
[15:01:01] <Yurume> right, I have learned Rust by making my own software
[15:01:39] <Yurume> rustc is fairly complex and in fact not a representative of (would-be) typical Rust softwares
[15:02:48] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[15:03:17] <SiegeLord> And most of that time was spending finding where exactly the behavior I wanted to fix resided, hah
[15:03:24] <SiegeLord> Once I found it, it didn't take long to fix
[15:04:03] <SiegeLord> Might be easier these days, as you can build rustc with debug symbols
[15:04:14] <eddyb> SiegeLord: same thing here. and I have a a PR that's waiting on a reviewer decision...
[15:04:24] *** Joins: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu)
[15:04:37] <eddyb> SiegeLord: grep all the way. don't forget -i :P
[15:04:57] *** Joins: maik (maik@moz-39AE504.dip0.t-ipconnect.de)
[15:09:09] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[15:10:39] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Client exited)
[15:10:55] *** Quits: engla (engla@moz-B4C2DBB.dialup.ice.net) (Ping timeout)
[15:10:56] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Ping timeout)
[15:12:15] *** Joins: Kruppe (user@moz-E150F49F.cpe.net.cable.rogers.com)
[15:12:18] *** Joins: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net)
[15:12:49] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[15:13:27] *** Joins: pyrac (pyrac@moz-E2FF17D7.w109-214.abo.wanadoo.fr)
[15:17:16] *** Quits: reedlepee (Mibbit@B424C7C1.213EDE4D.9D59D0D8.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[15:18:33] *** Quits: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu) (Ping timeout)
[15:19:46] *** Joins: crembo (crembo@moz-C2B364AA.vc.shawcable.net)
[15:22:47] *** Quits: _Vi (vi@DCE8FCEE.CAA062BC.FDCAC96B.IP) (Quit: _Vi)
[15:23:22] *** Joins: engla (engla@moz-B4C2DBB.dialup.ice.net)
[15:23:59] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[15:27:41] <KokaKiwi> Hoy chan
[15:28:10] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[15:28:37] *** Joins: fra0599 (fra0599@moz-3146A65B.cust.dsl.teletu.it)
[15:28:43] <fra0599> ciaoooo
[15:28:46] <fra0599> !list
[15:28:53] *** Parts: fra0599 (fra0599@moz-3146A65B.cust.dsl.teletu.it) ()
[15:29:18] <myname> wtf?
[15:29:24] <cmr> yeah. happens.
[15:29:39] <myname> do these italian stupid warez people really come on mozilla.org?
[15:29:48] <ash_136> Yurume:https://github.com/mozilla/rust/issues/8005
[15:29:52] <ash_136> I want to fix
[15:29:52] <ash_136> this
[15:29:56] <ash_136> where do I start
[15:29:56] <ash_136> ?
[15:30:29] <Yurume> I'm not an expert on rustc, but maybe #rust-internals channel would be a good start to get help
[15:30:34] <Ms2ger> myname, we've got even more interesting ones... Like Ghost_Of_MNG/JNG
[15:30:35] *** jorendorff_away is now known as jorendorff
[15:31:36] <Yurume> it seems that a flow totality analysis (i.e. does all control paths return a value?) comes *before* the type checker
[15:31:45] <Yurume> but it is just a guess
[15:32:00] <KokaKiwi> I was reading the issue about "Default arguments and keyword arguments" (#6973), last comments are 13d old, so I was wondering if anyone has done something about this issue yet? :o
[15:32:05] <myname> Ms2ger: i always wonder how stupid people really can be
[15:32:52] <klutzy> the error usually comes if you write e.g. if cond { return 1; } else { return; }
[15:32:56] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Client exited)
[15:33:10] <klutzy> but it also comes if you never return something on non-void fn
[15:33:49] <klutzy> so fixing just error message may be easy: check flow and use other msg for such case
[15:33:51] <cmr> KokaKiwi: nope, though doomlord_ had a patch that added a syntax to the AST
[15:33:52] *** Quits: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net) (Ping timeout)
[15:34:05] <Ms2ger> myname, pretty :)
[15:34:07] <klutzy> but maybe there is a room for huge refactoring I guess
[15:35:50] *** Joins: Toussa (Mibbit@moz-8458095B.adsl.alicedsl.de)
[15:35:59] <Toussa> Hi guys!
[15:38:39] <KokaKiwi> cmr: Oh okay, but nobody has written something like a feature's spec or something like that? :o
[15:38:59] <cmr> KokaKiwi: nope
[15:39:04] <cmr> KokaKiwi: do you want to tackle it? :)
[15:39:31] <gunther> is there a way to iterate over a Map, reading each key/value pair?
[15:39:34] <KokaKiwi> That's could be a funny thing to do I guess :D
[15:40:03] <cmr> gunther: .iter()
[15:40:11] <cmr> http://static.rust-lang.org/doc/master/std/hashmap/struct.HashMap.html
[15:40:13] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[15:40:28] *** Joins: crembo (crembo@moz-C2B364AA.vc.shawcable.net)
[15:42:21] *** Quits: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca) (Quit: Leaving.)
[15:42:24] *** Joins: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca)
[15:46:17] *** Quits: pyrac (pyrac@moz-E2FF17D7.w109-214.abo.wanadoo.fr) (Quit: pyrac)
[15:47:45] *** Joins: pyrac (pyrac@moz-E2FF17D7.w109-214.abo.wanadoo.fr)
[15:50:30] *** Joins: glennsl (textual@moz-5D7B804F.getinternet.no)
[15:50:41] *** jorendorff is now known as jorendorff_away
[15:52:40] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Client exited)
[15:56:18] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[15:57:33] *** Joins: tefter (tefter@B5D119DC.B856A0A1.73804765.IP)
[15:58:21] *** Quits: BitPuffin (isak@moz-98F8BF74.cust.tele2.se) (Ping timeout)
[15:58:48] *** Quits: engla (engla@moz-B4C2DBB.dialup.ice.net) (Ping timeout)
[15:59:16] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[16:00:04] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[16:00:41] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[16:02:28] *** Quits: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca) (Input/output error)
[16:04:58] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[16:11:59] <glennsl> hmm.. I'm getting a bus error 10 from using debug! Doesn't seem to be related to specific input to it, but at some point it just gets fed up.
[16:12:21] <glennsl> It's also very deterministic. Fails at the exact same point every time.
[16:13:00] <glennsl> Any idea what this might be?
[16:13:32] *** Joins: engla (engla@moz-B4C2DBB.dialup.ice.net)
[16:17:42] *** Quits: james4k (james@moz-E7990244.consolidated.net) (Ping timeout)
[16:18:30] <gunther> I'm getting an "error: use of possibly uninitialized variable 'char_count'" with this code https://gist.github.com/anonymous/0a519d21422f0d55d85f
[16:18:38] <bjz> ash_136: yeah #rust-internals is a better place to ask about rustc stuff
[16:18:47] *** Joins: nano (nano@moz-74CAD1CA.superkabel.de)
[16:18:59] <bjz> ash_136: I was going to say before you logged off before
[16:19:18] <ash_136> thanks :)
[16:19:24] <gunther> how am i supposed to get around this?
[16:19:53] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[16:21:07] <engla> gunther: you must create a hash table and assign to char_count
[16:21:23] <Toussa> gunther: you must initialize char_count
[16:21:45] <bjz> glennsl: see if you can reduce it
[16:21:58] <engla> let mut char_count = HashMap::new();  would be the usual way
[16:22:03] <bjz> glennsl: can't really say much from here :(
[16:22:07] *** Parts: sruggier (sruggier@B3C08253.4562CF68.6BEEAEBD.IP) ()
[16:22:41] <gunther> allright
[16:23:21] <glennsl> bjz: reduced to this: do 300.times { debug!("."); }
[16:23:30] <bjz> hah!
[16:23:33] <bjz> nice!
[16:23:43] <eddyb> is it possible I can create impossible mod/use constructs?
[16:23:48] <bjz> should post an issue
[16:23:53] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[16:24:05] *** Quits: ChrisMorgan (chris@moz-6AC741CA.static.tpgi.com.au) (Ping timeout)
[16:24:30] <kimundi> eddyb: What do you mean?
[16:24:33] <eddyb> rusti: mod a {use b::*; static A : int = b::B;} mod b {static B : int = 4;}
[16:24:35] -rusti- pastebinned 10 lines of output: http://ix.io/8DN
[16:24:42] <glennsl> bjz: currently fetching master and rebuilding, to see if something might have changed. I last did so yesterday though, so probably not.
[16:24:47] <glennsl> bjz: can you replicate it?
[16:24:53] <eddyb> kimundi: can't demo here, sadly :(
[16:25:06] <bjz> rusti: do 300.times { debug!("."); }
[16:25:07] -rusti- ()
[16:25:17] <Toussa> I have problem with my match here: https://gist.github.com/Einh06/c0c07c774a6fe4208858
[16:25:27] <Toussa> mismatched types: expected `&std::option::Option<A>` but found an enum or structure pattern
[16:25:30] <eddyb> rusti: mod a {use b::*; static A : int = b::B;} mod b {use a::*; static C : int = a::A; static B : int = 4;} b::C
[16:25:33] -rusti- pastebinned 16 lines of output: http://ix.io/8DO
[16:25:33] <eddyb> kimundi: ^^
[16:25:38] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[16:25:45] *** Joins: andrei (Mibbit@moz-34370347.dip0.t-ipconnect.de)
[16:26:10] <andrei> how do you generate a random number from an interval?
[16:26:13] <andrei> rand::rng().gen_int_range(0, 100); - does not work
[16:26:14] <eddyb> kimundi: I have a module providing a type to a second module and using a static from that second module
[16:26:15] <kimundi> eddyb: Using 'pub use' it's possible to create a mutual recursive definition which the compiler will complain about, but other than that, I don't know of anything that would fall under 'impossible'
[16:26:15] <glennsl> bjz: might have to increment it more. I don't want to break poor rusti though
[16:27:03] <kimundi> eddyb: Sounds like it should work, provided you get the use paths right
[16:27:07] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[16:27:19] <eddyb> kimundi: doesn't complain, about recursivity, but I can't see b::B in a
[16:27:41] <eddyb> well, b::B in my case is a type, not a static, but... I don't know :/
[16:28:00] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[16:28:01] <eddyb> it's like some stuff gets split in half and not all the definitions are available
[16:28:52] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[16:29:37] <eddyb> it's this thing to be precise: https://github.com/thestinger/rust-core/pull/4/files#diff-32950e5f350f459ee1727ae404f98597R19
[16:30:29] <eddyb> core_heap_impl uses LinearAllocator, which is defined below, but in the definition of core_heap_impl::allocator, core::heap::LinearAllocator doesn't seem to exist
[16:30:32] <kimundi> eddyb: Are you sure you'Re using crate-relative paths in the use statements?
[16:30:45] <eddyb> kimundi: it's all one crate
[16:31:14] <kimundi> Yeah, but the path in a use statement is relative to the crate root, not to the current module
[16:31:21] <andrei> the following example is from http://www.rustforrubyists.com/book/book.html
[16:31:25] <gunther> can i declare the types of the key/value pairs on the right hand side of the assignment instead of the left? let mut char_count: HashMap<char,uint> = HashMap::new();
[16:31:31] <andrei> let r = rand::rng().gen_int_range(0, 100);
[16:31:38] <andrei> but it doesn't work
[16:32:03] <kimundi> gunther:  = HashMap::<char, uint>::new();
[16:32:06] <kimundi> I think
[16:32:07] <cmr> gunther: HashMap::<int, int>::new()
[16:32:10] <eddyb> kimundi: I know, that's what I'm doing
[16:32:10] <cmr> yes
[16:32:14] <benh> is that new?
[16:32:24] <kimundi> eddyb: Hm, okay
[16:32:28] <cmr> benh: is what new?
[16:32:29] <kimundi> eddyb: Not sure then
[16:32:50] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[16:32:59] <eddyb> kimundi: I've moved the use ...::allocator in a detail submodule, still no go :/
[16:33:12] <andrei> do you guys know how to generate a random number in rust, from a specific interval ?
[16:33:19] <benh> I recall that being HashMap::new::<int, int>(), then impossible or something
[16:33:26] <eddyb> kimundi: OOOOOH I see it
[16:33:39] <eddyb> kimundi: it struck me too late that use statements aren't inherited
[16:33:42] <gunther> let mut char_count = HashMap::<char,uint>::new();    compiles
[16:33:59] <kimundi> eddyb: Ah, yeah they are always just for the module they are written in
[16:34:08] <cmr> benh: you're thinking of SomeTrait::<for X>, but HashMap is a struct.
[16:34:48] <eddyb> kimundi: I did it right in the example I added with the PR, but wrong in my code X_X
[16:34:54] <benh> Still haven't seen ::<> anywhere but the end of a path in actual use :)
[16:35:05] <cmr> benh: well there you go
[16:35:07] <kimundi> haha :)
[16:35:44] <bjz> andrei: std::rand
[16:36:14] <bjz> andrei: http://static.rust-lang.org/doc/master/std/rand/index.html
[16:36:18] <andrei> yes, but if you want something from an interval, the example given in rust for rubyists doesn't work
[16:36:25] <Toussa> any idea why my match does not seems to work (on an Option =/): mismatched types: expected `&std::option::Option<A>` but found an enum or structure pattern
[16:36:42] <cmr> Toussa: you should be matching on &None / &Some
[16:37:18] <Toussa> cmr: Oh?! because i have a &self?
[16:37:19] *** Joins: GeneralMaximus (ankur@4DE176B7.5EBECB05.BE90E62C.IP)
[16:37:22] <bjz> Toussa: usually derefing before you match is better style though
[16:37:32] <cmr> Toussa: Because you're matching on a &Option, not an Option
[16:37:38] *** Quits: GeneralMaximus (ankur@4DE176B7.5EBECB05.BE90E62C.IP) (Quit: Textual IRC Client: www.textualapp.com)
[16:37:44] <bjz> match *opt { ... }
[16:37:53] <andrei> bjz: I'm wodering if  this will work rand::random::<~(0, 100)>()
[16:37:55] <bjz> andrei: what is the example?
[16:38:03] <cmr> andrei: certainly not
[16:38:33] <andrei> http://www.rustforrubyists.com/book/book.html   let r = rand::rng().gen_int_range(0, 100);
[16:38:40] <Toussa> bjr , cmr: a ok, thanks for the advise, make code more clean?
[16:38:55] <cmr> rusti: use std::rand::Rng; std::rand::rng().gen_integer_range(0, 100)
[16:38:57] -rusti- 7
[16:38:58] <cmr> andrei: ^
[16:39:08] <cmr> andrei: std::rand is being overhauled/modernized by dbaupp
[16:39:08] <bjz> http://static.rust-lang.org/doc/master/std/rand/trait.Rng.html#method.gen_integer_range
[16:39:32] <bjz> yayy dbaupp
[16:40:34] <andrei> cmr: trying right now
[16:41:34] *** Quits: heftig (heftig@moz-19B25E43.dip0.t-ipconnect.de) (Ping timeout)
[16:42:12] *** Quits: jfbk (jfbk@moz-EEA9CFB3.nyc.res.rr.com) (Quit: )
[16:42:24] *** Quits: maik (maik@moz-39AE504.dip0.t-ipconnect.de) (Ping timeout)
[16:42:30] <andrei> cmr: that works :D
[16:42:52] <andrei> thanks guys, I will check next only the master docs.
[16:43:23] <Toussa> cmr: cannot move out of dereference of & pointer
[16:43:34] <Toussa> cmr: i don't get it =/
[16:44:42] <cmr> Toussa: right, &Some derefs for you. You're probably saying something like &Some(x), but that would move out of the &Option. You need to say &Some(ref x) (or just Some(ref x) if you did as bjz suggested)
[16:45:43] <Toussa> cmr: right, got it =D i remember now the ref
[16:46:11] *** Joins: heftig (heftig@moz-7609170D.dip0.t-ipconnect.de)
[16:52:50] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[16:54:08] *** Joins: lkuper (lkuper@31F4CB6.A0D37E9B.51B6877.IP)
[16:55:18] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[16:55:49] <cmr> erickt: I just realized I forgot to mention rust-zmq and rust-moustache! I'll get them next week :(
[16:58:14] *** Joins: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com)
[16:58:26] *** Joins: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com)
[16:59:39] *** Joins: ercxx (ercan@moz-7CFF3469.dyn.optonline.net)
[17:00:03] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[17:01:20] *** Quits: ash_136 (ashvini@BA56CB4C.F9E46DD1.E5F05D4F.IP) (Quit: Leaving)
[17:05:43] *** lbergstrom is now known as lbergstrom|away
[17:06:59] <bjz> cmr: also rust-ci
[17:07:01] <bjz> :)
[17:07:28] <bjz> http://hiho.io/rust-ci/
[17:08:56] <cmr> bjz: thanks!
[17:10:38] *** Quits: canhtak (jeremy@moz-A67811CE.wl.t.ulaval.ca) (Quit: canhtak)
[17:11:22] *** Joins: canhtak (jeremy@moz-A67811CE.wl.t.ulaval.ca)
[17:11:46] *** Quits: canhtak (jeremy@moz-A67811CE.wl.t.ulaval.ca) (Quit: canhtak)
[17:11:58] *** Joins: jxv (jxv@4732E7D7.2AB34561.9B38A32A.IP)
[17:12:08] *** Quits: Ms2ger (Ms2ger@moz-C96856.adsl-dyn.isp.belgacom.be) (Ping timeout)
[17:12:16] <earlzlap> Did someone in here develop rust-mustache?  I'm curious as to how it works heh
[17:12:49] *** Joins: Yeri (jasonjasmi@41C91A8A.CE609BA5.E39FBF79.IP)
[17:13:30] <cmr> earlzlap: erickt did
[17:13:32] <ercxx> earlzlap: yeah erickt made it.
[17:13:40] <ercxx> :)
[17:14:07] *** Joins: Ms2ger (Ms2ger@moz-C96856.adsl-dyn.isp.belgacom.be)
[17:14:24] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[17:14:44] *** Joins: nadirs (nadirs@moz-28FA9E21.retail.telecomitalia.it)
[17:14:47] *** Quits: sindork (sindork@ABFA98AB.DD47BB48.F7A44A1B.IP) (Client exited)
[17:15:02] *** Joins: sindork (sindork@ABFA98AB.DD47BB48.F7A44A1B.IP)
[17:15:29] *** Quits: Jackneill (Jackneill@moz-5C16F392.pool.digikabel.hu) (Ping timeout)
[17:15:44] *** Quits: andrei (Mibbit@moz-34370347.dip0.t-ipconnect.de) (Quit: http://www.mibbit.com ajax IRC Client)
[17:15:48] <earlzlap> Is it type-safe-ish? Like if you have a template like "hello {{name}}" and you give it a struct like `let name = Name{ named: ~"foo"}` would it give a runtime or compiler time error? 
[17:16:40] <earlzlap> I don' t understantd quite how the example in the README works heh
[17:17:31] <cmr> earlzlap: it uses extra::serialize
[17:18:17] <earlzlap> I see that, but I don't see how this example works:
[17:18:17] <earlzlap>     let name = Name { name: ~"world" };     let s = mustache::render_str("hello {{name}}!", ctx);     io::println(s);
[17:18:31] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[17:18:43] <earlzlap> what is ctx, and how does it know to receive the variable "name" ?
[17:18:52] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[17:19:48] <cmr> Yeah, that example is pretty broken.
[17:20:08] <earlzlap> is anyone actually using it yet? 
[17:20:38] <cmr> afaict it will encode the data you give it, and when it does .emit_struct_field, it will intercept that name and its value.
[17:20:44] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[17:21:23] <cmr> Yeah, that's what it does.
[17:21:30] <cmr> https://github.com/erickt/rust-mustache/blob/master/mustache.rs#L165
[17:21:53] *** Joins: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com)
[17:22:25] *** Quits: hjr3 (hradtke@moz-E87BDF1F.socal.res.rr.com) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[17:22:57] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[17:23:23] *** Joins: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP)
[17:24:32] <earlzlap> I still need to learn how serialize wrks. heh
[17:24:41] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[17:25:21] <cmr> It's extremely confusing.
[17:26:24] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Client exited)
[17:27:07] *** Quits: nadirs (nadirs@moz-28FA9E21.retail.telecomitalia.it) (Quit: leaving)
[17:27:40] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[17:27:54] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[17:29:22] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Ping timeout)
[17:30:46] <ercxx> What is the proper way of passing lambdas between tasks? I am having hard time writing a url router that uses lambdas. Am I fighting against the language?
[17:31:00] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Client exited)
[17:31:02] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[17:31:07] <ercxx> It seems so simple with a global object.
[17:31:21] <kimundi> YOu need to use ~fn()
[17:31:30] <ercxx> kimundi: I do. 
[17:31:41] <cmr> ~fn:Send, I believe.
[17:31:46] <cmr> That might be obsolete knowledge though
[17:31:53] <ercxx> rust-http tries to clone them
[17:31:59] *** Joins: ofeldt- (ofeldt@moz-F90A2DDF.dip0.t-ipconnect.de)
[17:32:16] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[17:32:19] <kimundi> rusti: let f: ~fn() = || "hello"; f
[17:32:21] -rusti- pastebinned 7 lines of output: http://ix.io/8DV
[17:32:41] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Client exited)
[17:32:49] *** Quits: ofeldt (ofeldt@moz-1564EB92.dip0.t-ipconnect.de) (Ping timeout)
[17:32:56] <kimundi> rusti: let f: ~fn() = ||(); f
[17:32:56] -rusti- fn()
[17:33:04] <kimundi> rusti: let f: ~fn:Send() = ||(); f
[17:33:05] -rusti- fn()
[17:34:12] *** Joins: Jackneill (Jackneill@moz-5C16F392.pool.digikabel.hu)
[17:34:23] * kimundi wonders if it is possible in rust to calculate something only using unit (), lambda || and block {}
[17:35:11] <kimundi> rusti: {||{()}()}
[17:35:13] <myname> is ((())) still valid in your list?
[17:35:14] -rusti- pastebinned 7 lines of output: http://ix.io/8DW
[17:35:48] <ercxx> kimundi: http://pastebin.mozilla.org/3299541
[17:36:02] <eddyb> kimundi: I know you can do some nifty stuff in JS with only [], + and !, but that's because coercion and everything is an object. maybe we'll have a wtf.rs at some point :D
[17:36:21] <kimundi> wat.rs
[17:36:26] <kimundi> I hope we noever come that far xD
[17:36:33] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[17:36:48] <ercxx> I can do s.clone() there but serve_forever complains:  instantiating a type parameter with an incompatible type `MyServer<>`, which does not fulfill `Send`
[17:36:53] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[17:37:19] <ercxx> This is confusing me. How would I fulfill Send?
[17:37:53] <eddyb> rusti: #[deriving(Send)] struct Foobar(int, uint);
[17:37:54] -rusti- ()
[17:38:16] <eddyb> not sure if that does anything, attributes tend to fail silently
[17:38:20] *** Joins: tjc (tjc@moz-6EB4E533.dsl.tsoft.com)
[17:38:20] *** ChanServ sets mode: +o tjc
[17:38:33] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[17:38:49] <cmr> ercxx: Send is automatically "implemented" for types which fulfill the restrictions of Send
[17:38:57] <ercxx> error: unknown `deriving` trait: `Send`
[17:39:08] <cmr> Send implies total ownership. No & and no @ anywhere.
[17:39:43] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[17:39:52] <ercxx> So it can't be used by multiple tasks at the same time, is that right?
[17:40:42] <cmr> No two tasks can reference the same Send data at the same time.
[17:40:52] <kimundi> In general "multible task at the same time" is not possible direct in rust
[17:40:55] <cmr> Not just use, but also reference.
[17:41:04] <kimundi> YOu can use Arc or RWArc to do that though
[17:42:29] <ercxx> what are those?
[17:44:16] <ercxx> I see.
[17:44:39] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[17:44:45] <cmr> Atomically Reference Counted and Read/Write Atomically Reference Counted.
[17:45:11] <cmr> Extends the normal mutability/ownership/aliasing rules through locks and runtime c hecks.
[17:45:19] *** Quits: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net) (Client exited)
[17:45:36] <ercxx> Thanks
[17:46:20] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[17:49:08] *** Joins: thewonderidiot (mike@moz-5506A033.hsd1.ca.comcast.net)
[17:51:30] *** Joins: rveach (kvirc@9B96775A.4E0850CE.9A53B712.IP)
[17:52:25] *** Joins: tedh (tedh@moz-F0B37C08.hsd1.il.comcast.net)
[17:52:55] *** Quits: eddyb9 (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Ping timeout)
[17:57:13] <SimonSapin> Yurume: there was discussion about moving (some of?) rust-encoding to libstd a while ago. I wanted to make sure to get the API right before that happened, this is the result: https://github.com/mozilla/rust/wiki/Proposal-for-character-encoding-API
[17:57:15] *** Quits: lenstr (lenstr@AF8EB999.6049B16A.85938D85.IP) (Ping timeout)
[17:57:15] *** Joins: lenstr_ (lenstr@AF8EB999.6049B16A.85938D85.IP)
[17:57:27] <SimonSapin> Yurume: also see the mailing list archive linked from there
[18:00:42] *** Quits: Mindless` (mindless@moz-9C38D3B4.net) (Ping timeout)
[18:01:42] *** Joins: Mindless` (mindless@moz-9C38D3B4.net)
[18:01:55] <ercxx> How do I put a ~fn:Send() in an Arc? It complains about ~fn:Send() not fulfilling `Freeze`.
[18:02:15] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[18:02:35] <cmr> ~fn:Send+Freeze ? :P
[18:02:56] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[18:03:11] *** Quits: jensnockert (jensnocker@moz-7DC16A5F.afb.bredband2.com) (Input/output error)
[18:03:22] <ercxx> I thought that was a joke until it worked :)
[18:04:15] <cmr> kimundi: I don't think computation would be possible using only (), since you can't represent information with it.
[18:04:32] *** Joins: reedlepee (Mibbit@B424C7C1.213EDE4D.9D59D0D8.IP)
[18:05:42] <kimundi> cmr: hm, true. Might need some way to branch
[18:05:54] *** Quits: Cromulent (Cromulent@moz-983B638D.cable.virginmedia.com) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[18:05:57] <cmr> kimundi: branching isn't as important as being able to represent information :P
[18:06:08] <cmr> You can't do *any computation at all* without that.
[18:06:29] <kimundi> cmr: Need to allow tuple then :P
[18:06:50] <kimundi> (), ((), ()), ((), ((), ()))
[18:06:59] <kimundi> Information! xD
[18:07:51] <cmr> Sure, that's the same way the set-theoretic definitions of numbers are constructed. But our type system can't represent that very well
[18:07:57] <kimundi> cmr Wait, isn't lambda calculus about being able to compute arbitrary things using only functions?
[18:08:00] *** Joins: dwrensha (chatzilla@moz-DE44EA45.hsd1.pa.comcast.net)
[18:08:23] <kimundi> Ah nevermind, we have argmunets there
[18:08:29] <kimundi> arguments, even
[18:08:40] <kimundi> Whatever, I'm rambling :P
[18:09:02] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Ping timeout)
[18:10:10] *** Quits: oberstet (quassel@moz-3BBC4C8A.dynamic.mnet-online.de) (Ping timeout)
[18:10:14] *** Joins: oberstet (quassel@moz-3E7AD045.dynamic.mnet-online.de)
[18:10:19] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[18:10:36] <Ms2ger> kimundi, *untyped* lambda calculus :)
[18:10:39] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[18:11:00] *** Quits: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com) (Ping timeout)
[18:11:24] <eddyb> I.... I can't auto-generate a match block using macros?
[18:11:49] <cmr> eddyb: you should be able to?
[18:12:21] <eddyb> it syntax errors for the match cases (in my case - no pun intended - number literals)
[18:12:29] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[18:12:30] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[18:12:53] <cmr> Does rustc --pretty=expanded look like what you expect?
[18:12:58] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[18:13:23] <FreeFull> cmr: Untyped lambda calculus can represent information using just functions
[18:13:31] <FreeFull> Ah, nevermind
[18:13:39] <FreeFull> I should read everything
[18:13:42] <cmr> :P
[18:13:56] *** Quits: m314159 (marco@moz-161CB040.dynamic.surfer.at) (Ping timeout)
[18:14:02] <FreeFull> Well, you can implement it in Rust =P
[18:14:04] <eddyb> cmr: I'm using chained if/else now, that works :D
[18:14:40] *** Quits: Toussa (Mibbit@moz-8458095B.adsl.alicedsl.de) (Quit: http://www.mibbit.com ajax IRC Client)
[18:15:40] <eddyb> cmr: the problem is that I had $($i => ... $i ...),* and it was trying to parse it from inside-out. that failed, because the syntax is specific to the match block
[18:16:14] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[18:16:59] *** Quits: oberstet (quassel@moz-3E7AD045.dynamic.mnet-online.de) (Client exited)
[18:18:04] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:18:16] <ercxx> is it possible to implement new methods on existing types?
[18:18:20] *** Joins: m314159 (marco@moz-161CB040.dynamic.surfer.at)
[18:18:30] <cmr> ercxx: yes, create a new trait containing those methods, implement the trait for the type.
[18:18:31] <eddyb> wheee
[18:18:35] <cmr> This is called "extension methods"
[18:18:40] *** Quits: lkuper (lkuper@31F4CB6.A0D37E9B.51B6877.IP) (Ping timeout)
[18:18:59] <ercxx> Thank you.
[18:19:09] <eddyb> cmr, dbaupp, pcmattman: allocating an object with a size known at compile-time is just one call
[18:20:10] <eddyb> no arguments passed
[18:21:24] *** Quits: gunther (Mibbit@moz-4A19983C.ip227.fastwebnet.it) (Ping timeout)
[18:21:51] *** Joins: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu)
[18:23:31] *** Joins: james4k (james@moz-E7990244.consolidated.net)
[18:24:48] <eddyb> cmr: look at this sorcery: https://github.com/eddyb/rustic/blob/slam/src/mem/slam.rs#L202-L226
[18:24:51] *** Joins: gunther (Mibbit@moz-4A19983C.ip227.fastwebnet.it)
[18:25:16] *** Joins: lkuper (lkuper@31F4CB6.A0D37E9B.51B6877.IP)
[18:26:25] *** Quits: Yeri (jasonjasmi@41C91A8A.CE609BA5.E39FBF79.IP) (Quit: Yeri)
[18:27:03] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[18:27:18] <eddyb> strcat: well well well look who's here
[18:28:19] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[18:28:23] *** Joins: skoizza (Mibbit@9BA721F0.80BB6BFD.DDE5D3F6.IP)
[18:28:40] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[18:28:58] *** Joins: eatkinson (eatkinson@moz-261EDE03.hsd1.ca.comcast.net)
[18:29:05] *** Quits: eatkinson (eatkinson@moz-261EDE03.hsd1.ca.comcast.net) (Quit: eatkinson)
[18:29:25] *** Joins: jhenahan (jhenahan@moz-65B7D4EE.hsd1.vt.comcast.net)
[18:29:28] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[18:30:05] *** Joins: rveach|2 (kvirc@moz-7E54B3A2.hsd1.ca.comcast.net)
[18:30:22] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[18:30:22] *** Quits: rveach (kvirc@9B96775A.4E0850CE.9A53B712.IP) (Ping timeout)
[18:31:26] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[18:31:48] *** Quits: gunther (Mibbit@moz-4A19983C.ip227.fastwebnet.it) (Quit: http://www.mibbit.com ajax IRC Client)
[18:31:55] *** Joins: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com)
[18:32:00] *** Quits: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com) (Client exited)
[18:32:15] *** Quits: zeuxcg (zeuxcg@moz-5E7FDC83.dynamic.avangarddsl.ru) (Ping timeout)
[18:32:20] *** Joins: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com)
[18:32:55] <eddyb> wait, LLVM is generating position-independent code?
[18:33:12] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[18:33:13] <eddyb> it's calling the next instruction and popping the EIP off the stack, just to access globals :|
[18:33:43] <strcat> eddyb: globals defined in the same crate?
[18:33:48] <eddyb> strcat: yes
[18:33:56] *** Joins: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl)
[18:33:57] *** Joins: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net)
[18:34:02] *** Quits: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com) (Ping timeout)
[18:34:10] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Ping timeout)
[18:34:28] <eddyb> this is at codegen, before linking. the entire thing is linked with a static memory layout, using a linker script
[18:34:43] <eddyb> any chance I can tell LLVM this is not PIC?
[18:35:10] *** Quits: StarLight (StarLight@moz-8F220F46.dynamic.avangarddsl.ru) (Ping timeout)
[18:36:58] <strcat> eddyb: --llvm-args -relocation-model=static
[18:37:00] <strcat> ?
[18:37:37] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[18:37:51] <skoizza> Can you create an Arc object for a uint?
[18:38:36] <bstrie> "I wonder sometimes if maybe we've swung too far in the direction of gender equality" #shitHNsays
[18:38:51] <bstrie> reedlepee: ping
[18:38:55] <strcat> skoizza: sure, seems pointless though
[18:39:01] <strcat> unless you mean a mutable one
[18:39:14] <AmunRa> Rust 0.8: I have a &~str, how do I get a *char from it?
[18:39:15] *** Joins: maxli (maxli@moz-A607CA26.student.cs.uwaterloo.ca)
[18:39:16] *** Joins: StarLight (StarLight@moz-C8F30533.dynamic.avangarddsl.ru)
[18:39:31] <eddyb> strcat: that's what I've just tried, isn't recognized
[18:39:37] <strcat> AmunRa: you probably want to use &str, not &~str
[18:39:39] <tjc> bstrie: (╯°□°）╯︵ ┻━┻) 
[18:39:42] <strcat> &~str isn't very useful
[18:39:58] <strcat> AmunRa: do you mean you want a NUL-terminated string?
[18:40:17] <skoizza> strcat yeah thats what i meant, right now I have static mut visitor_count: uint = 0; let safe_visitor_count: = arc::Arc::new(visitor_count); and its giving me an error: expected item but found let
[18:41:21] <strcat> skoizza: I'm not sure why you'd have a global and also a wrapped one
[18:41:30] *** Quits: jhenahan (jhenahan@moz-65B7D4EE.hsd1.vt.comcast.net) (Ping timeout)
[18:41:32] <strcat> the wrapped one isn't going to observe or make changes to the global
[18:41:50] <strcat> it looks like you're missing a type signature
[18:41:56] <strcat> but you have the : there
[18:42:05] <strcat> if you remove the : you won't get a parser error
[18:42:21] <eddyb> strcat: any chance it's disabled by the rust build system? I did --llvm-args -help, looks like llc, but without relocation-model :(
[18:42:26] *** Quits: voxpopuli (fanservice@moz-CEF3689A.hsd1.pa.comcast.net) (Ping timeout)
[18:42:28] <Ms2ger> AmunRa, do foo.with_c_str |str| { bar(str) }
[18:42:34] <strcat> eddyb: dunno
[18:42:44] <strcat> eddyb: rust always passes RelocPIC
[18:42:54] <eddyb> :(
[18:43:01] <strcat> eddyb: just start building with clang, you probably don't want the segmented stack preludes either
[18:43:27] <eddyb> strcat: you mean -S --emit-llvm from rustc?
[18:43:33] <strcat> well you don't need -S
[18:43:41] <skoizza> strcat: I removed the ":" (my bad) but still had the same error
[18:43:46] <strcat> -S just makes it human readable (IR instead of bytecode)
[18:44:01] <eddyb> ah, I see
[18:44:06] <strcat> skoizza: need to see more code than that snippet then
[18:45:27] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[18:47:39] <AmunRa> arg.to_c_str().unwrap(), thanks Ms2ger pointed me to the right search through the docs
[18:48:07] <Ms2ger> Np
[18:48:59] *** Joins: DoritosMan (RitosMan@moz-111D941D.lightspeed.hstntx.sbcglobal.net)
[18:50:13] *** Joins: jmorkel (chatzilla@moz-4EBBDBAC.dynamic.isadsl.co.za)
[18:51:26] *** Joins: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP)
[18:54:25] *** Quits: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu) (Ping timeout)
[18:54:36] *** Quits: tjc (tjc@moz-6EB4E533.dsl.tsoft.com) (Quit: Places to go, people to annoy)
[18:57:00] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[18:57:04] *** Joins: myra (myra@9B9315E1.A6025CA.1C37C358.IP)
[18:57:22] *** Parts: myra (myra@9B9315E1.A6025CA.1C37C358.IP) ()
[18:57:24] <skoizza> strcat: what I am trying to do is update a global mutable uint from different tasks without the use of an unsafe block
[18:57:34] <skoizza> and i thought an arc was the way to do that
[18:58:17] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[18:59:35] *** Joins: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu)
[18:59:51] *** Joins: tiffany (kawaii@moz-28A8742A.dhcp.embarqhsd.net)
[18:59:57] *** Joins: jeaye (Jeaye@moz-34FEF2BB.hsd1.ca.comcast.net)
[19:00:56] <eddyb> strcat: woo, rs -> bs -> obj works with that extra flag :D
[19:01:13] <eddyb> strcat: most of the function is now "nop" :/. any idea why it's building a "sled"?
[19:01:49] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:01:54] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[19:02:42] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[19:02:51] *** Joins: devbug (quassel@23AC5F12.9D950176.3655BBF5.IP)
[19:03:49] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:05:09] *** Quits: ianj (ianjneu@moz-7BA002E.hsd1.ma.comcast.net) (Quit: leaving)
[19:05:28] *** Quits: tefter (tefter@B5D119DC.B856A0A1.73804765.IP) (Ping timeout)
[19:05:41] *** Joins: tefter (tefter@B5D119DC.B856A0A1.73804765.IP)
[19:06:19] *** Quits: AmunRa (Fu@moz-3B13DA05.cable.virginmedia.com) (Ping timeout)
[19:07:19] *** Quits: BizarreCake (BizarreCak@moz-361FE9B2.dynamic.barak-online.net) (Ping timeout)
[19:08:33] *** Quits: engla (engla@moz-B4C2DBB.dialup.ice.net) (Ping timeout)
[19:08:40] *** Joins: engla_ (engla@moz-9FECFD3B.dialup.ice.net)
[19:10:06] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[19:10:40] *** Joins: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com)
[19:11:52] *** Joins: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net)
[19:12:27] *** Quits: vodik (simon@moz-FD4ADBC6.cable.teksavvy.com) (Ping timeout)
[19:13:54] *** Quits: lerc (quassel@moz-1AC1A28C.telstraclear.net) (Ping timeout)
[19:15:13] <ercxx> Is there a way of doing this  my_func({name:"timmy", age: 25}) ?
[19:15:29] <ercxx> Like an anonymous struct?
[19:16:05] *** Quits: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[19:16:44] <ercxx> That doesn't make sense in rust probably.
[19:17:21] *** Joins: jeffdb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[19:17:21] *** Quits: engla_ (engla@moz-9FECFD3B.dialup.ice.net) (Ping timeout)
[19:18:43] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[19:19:27] <acrichto> ercxx: rust used to have that, but it was removed
[19:20:10] <ercxx> What was the reason?
[19:20:41] <acrichto> I'm not entirely sure, but I think it was because it's "just one more thing"
[19:20:42] *** Joins: engla (engla@moz-9FECFD3B.dialup.ice.net)
[19:21:42] *** Joins: mib (Mibbit@C25CC32F.9EA65473.DDE5D3F6.IP)
[19:22:25] <SiegeLord> It seems like a useful feature... it'd play great with default values for struct members
[19:23:06] <SiegeLord> You'd be able to do my_func({blah: 1}) to hack in default arguments
[19:23:12] <ercxx> It would be a glorified hashmap I think.
[19:23:18] <SingingBoyo> I feel like there's some major overlap with tuples in there
[19:23:20] <mib> I'm trying to get rid of an unsafe block of code, which is around a variable that acts as a counter. The counter will be incremented by multiple spawns, any idea how to do this?
[19:23:35] <SiegeLord> Kind of convenient in defining arrays of structs too
[19:23:44] <SiegeLord> Right now you kind of have to stutter a bit...
[19:23:51] <ercxx> I really liked PHP's arrays. One datatype to stuff them all.
[19:24:18] <strcat> mib: well it won't be safe if you're just naively incrementing it from multiple tasks
[19:24:44] <strcat> it could be 11, and be incremented by two at the same time and become 12 instead of 13
[19:25:03] <strcat> (or worse, if the arch doesn't read/write to that type atomically)
[19:25:14] <mib> strcat, right, so I looked into using a RWArc, would that be something to use?
[19:25:25] <strcat> for a simple counter you probably just want atomics
[19:25:51] <strcat> std::unstable::atomics
[19:26:13] <strcat> a RWArc would work but it's a bit pointless to be doing an allocation + atomic reference counting + locking just for an atomic counter
[19:27:20] <mib> strcat our professor hinted at the idea that an arc would be the easiest way to do this
[19:28:31] <ercxx> rusti: let a : HashMap<int,int>= HashMap::new();
[19:28:32] <strcat> the fastest and most flexible way will just be using a global with an atomic integer type
[19:28:35] -rusti- pastebinned 6 lines of output: http://ix.io/8E3
[19:28:49] <ercxx> let a : HashMap<int,int>= HashMap::new();
[19:29:15] *** DoritosMan is now known as RitosManAway
[19:29:20] <ercxx> > and = together is an error there.
[19:29:22] *** Joins: alisdair (textual@28441AAB.AC6E1995.F0AE27BD.IP)
[19:29:29] <strcat> known part of the grammar afaik
[19:29:42] *** Quits: engla (engla@moz-9FECFD3B.dialup.ice.net) (Ping timeout)
[19:29:48] <ercxx> Ok
[19:32:15] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[19:33:47] *** Quits: tgummerer_ (tgummerer@51D3B54.FEF996EA.EA6FEF3D.IP) (Ping timeout)
[19:34:04] *** Joins: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP)
[19:36:31] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[19:36:32] <bjz> ercxx: we used to have records, but they were removed
[19:37:19] <mib> strcat to create a new atomic int, would the syntax be static mut var_name : atomics::AtomicUint = //and we are trying to initialize it to 0
[19:37:41] <bjz> I think it was to do with weird interactions that could occur with traits
[19:38:29] <strcat> mib: you'll probably just want to use the intrinsics directly
[19:39:39] <SingingBoyo> does rust have Futures somewhere in the task/concurrency libs?
[19:40:49] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Client exited)
[19:40:56] <mib> I'm not sure I know what you mean by "intrinsics"
[19:41:10] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[19:42:00] *** Quits: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu) (Ping timeout)
[19:42:18] *** Joins: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com)
[19:42:22] <strcat> mib: std::unstable::intrinsics
[19:44:22] <ibnc> Okay, I'm kinda new to rust, and have a question. How do I copy a borrowed string to a owned string?
[19:44:48] <benh> .to_owned()
[19:44:58] *** Quits: nano (nano@moz-74CAD1CA.superkabel.de) (Connection reset by peer)
[19:45:43] <ibnc> thanks
[19:46:22] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[19:46:42] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[19:47:38] *** Joins: frau (frau@moz-BFE94859.hfc.comcastbusiness.net)
[19:48:32] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[19:49:05] <frau> Curious why, on OS X, rust installs two copies of the stdlibs into /usr/local/lib{,/x86_64-apple-darwin/lib}?
[19:49:57] <reedlepee> what is meant by  "rebase and fix the merge conflicts"?
[19:50:06] *** lbergstrom|away is now known as lbergstrom
[19:51:15] <jmorkel> reedlepee: http://git-scm.com/book/en/Git-Branching-Rebasing
[19:51:23] *** Joins: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu)
[19:52:35] <benh> frau: I think it's something like the first set is that rustc is linked against and the second set is that rustc is linking user code against
[19:52:40] *** RitosManAway is now known as DoritosMan
[19:52:41] *** Joins: int3_ (int3_@moz-D24DA61C.public.wayport.net)
[19:52:47] <benh> No idea though :)
[19:52:53] *** Joins: tgummerer_ (tgummerer@moz-5DC8FA44.tbcn.telia.com)
[19:54:01] <frau> benh: interesting, perhaps it's time to do science on those libs
[19:55:20] *** Quits: jeffdb (jeff@moz-D13B6004.hsd1.ca.comcast.net) (Quit: jeffdb)
[19:55:21] <strcat> my arch package only ships one set of libs
[19:55:56] <frau> maybe the non-target copy is historical baggage
[19:56:27] <strcat> frau: it's not really baggage
[19:56:33] <strcat> it's because it's a self-hosting compiler
[19:56:37] *** Quits: jmorkel (chatzilla@moz-4EBBDBAC.dynamic.isadsl.co.za) (Ping timeout)
[19:56:49] <strcat> the stage1 compiler builds the libs and the stage2 compiler linked against them
[19:56:57] <strcat> then the stage2 compiler builds the libs again (the target libs)
[19:57:07] *** Quits: StarLight (StarLight@moz-C8F30533.dynamic.avangarddsl.ru) (Ping timeout)
[19:57:26] <strcat> there's an optional extra stage
[19:57:59] <frau> how does your arch package only need one set of libs in that case?
[19:58:31] <strcat> I don't think the stage1/stage2 libs are ever going to be incompatible in practice.
[19:58:39] <strcat> and the stage2/stage3 ones shouldn't ever be
[19:58:46] <strcat> frau: symlinks
[19:58:47] <frau> right, kind of the point of stage3 eh
[19:58:50] <frau> ah
[19:58:51] *** Quits: int3_ (int3_@moz-D24DA61C.public.wayport.net) (Ping timeout)
[19:59:10] <frau> okay cool. that clears things up
[19:59:18] *** Joins: int3_ (int3_@moz-D24DA61C.public.wayport.net)
[19:59:29] <int3_> so I'm trying to write a simple interpreter that walks a JSON representation of an AST
[19:59:33] <int3_> is there a better / more succinct way to do it than this? http://pastebin.com/41ZCznkJ
[19:59:36] *** Joins: pudgetta (Mibbit@F8635924.EBD92228.DDE5D3F6.IP)
[19:59:43] <int3_> (sorry if I repeated myself, my connection just dropped)
[19:59:55] <mib> I'm trying to get the value of an atomic int back with the fetch and add method, but it says we need to pass it an ordering. How do we create an ordering?
[20:00:18] *** Joins: jmorkel (chatzilla@moz-4EBBDBAC.dynamic.isadsl.co.za)
[20:00:42] <int3_> in particular, I find myself having to make a bunch of calls to unwrap() and clone() to extract the string values from the JSON object, but I believe I really shouldn't have to do any copying of the AST
[20:01:19] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:01:25] <strcat1> int3_: because you're taking it by-value
[20:01:35] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (NickServ (GHOST command used by strcat1))
[20:01:38] *** strcat1 is now known as strcat
[20:01:38] *** Quits: hickorynut (Mibbit@moz-B167420D.eugn.qwest.net) (Quit: http://www.mibbit.com ajax IRC Client)
[20:02:03] <strcat> int3_: taking a type with a destructor by-value takes ownership of it
[20:02:13] <strcat> if you don't need ownership, you want to take it by-reference
[20:02:32] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[20:02:48] <jmorkel> is there a reason why rust doesn't support "for ... in" use without explicitly passing in an iterator, i.e. passing it a src_expr that is a container that has the Iterable trait?
[20:03:27] <strcat> jmorkel: because the details haven't been worked out and compiler support hasn't been added
[20:03:34] <Ms2ger> We've only just added for...in!
[20:03:43] <strcat> first step is rewriting for loops as a compiler feature instead of a parser feature
[20:03:49] <pudgetta> mib: try using the interface
[20:04:06] <jmorkel> strcat: oh, cool. I was trying to see if I could add it myself
[20:04:27] <jmorkel> I searched for related issues and didn't find anything obvious
[20:04:27] <strcat> for loops are currently implemented via desugaring in the parser
[20:04:44] *** Quits: geert (geert@moz-5EFDD81E.access.telenet.be) (Ping timeout)
[20:04:46] <pudgetta> strcat: how do you create an enum? specifically trying to create an ordering enum for atomic
[20:04:50] <strcat> they just expand to a 'let ... = ...; loop { match ... { ... } }'
[20:05:01] <int3_> strcat: right, I was trying to get that to work by having get_json_string take a &json::Json pointer. but then my pattern match fails with 'cannot move out of dereference of & pointer'. I'm guessing that I want to return a pointer to the underlying string, but I'm not sure how to do that...
[20:05:07] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[20:05:22] <jmorkel> yeah, I saw that in syntax/ext/expand.rs
[20:05:27] <strcat> int3_: your pattern match needs to be by-reference too
[20:05:38] <strcat> if you do
[20:05:58] <int3_> strcat: http://pastebin.com/svkbpYLk
[20:06:04] <strcat> match *x { Foo(y) => ..., _ => ... } where x has a destructor, you're moving out of it
[20:06:11] <strcat> and you can't move out of a borrowed ptr
[20:06:16] <KokaKiwi> Hoy, I've created a pad about the issue on default function arguments: https://pad.riseup.net/p/hvbg6dQQnEe7 If you want to argue about this feature request :)
[20:06:22] <strcat> int3_: you need 'ref s'
[20:06:47] <strcat> int3_: you probably want to match on *ast to avoid writing & a bunch of times too
[20:07:05] <jmorkel> strcat: so I guess the parser doesn't have enough information when desugaring to infer if it is an Iterable or not
[20:07:16] <strcat> jmorkel: right, it has no types
[20:07:26] <strcat> jmorkel: there are other problems due to it being in the parser too
[20:07:36] <strcat> atm it always has to borrow as &mut immediately
[20:07:56] <strcat> but if it's an lvalue, it shouldn't do that
[20:08:09] <pudgetta> help on creating an ordering enum?
[20:08:35] <int3_> strcat: hm ok I'll go read up on the ref stuff. it wasn't in the main tutorial but I just realized it's in the borrowed ptr tut
[20:08:35] <strcat> rusti: enum A { B } B
[20:08:37] -rusti- B
[20:09:06] <strcat> int3_: it just means you're extracting a binding from the pattern as a borrow instead of by-value
[20:09:41] <strcat> you won't be able to return ~str directly, you'll need to return &str if you don't want to copy
[20:11:26] <pudgetta> i'm not sure I understand whta I'm looking at
[20:12:00] <strcat> defining a type and making an instance of it
[20:12:11] <strcat> rusti: enum Foo { A, B, C } B
[20:12:12] -rusti- B
[20:12:30] *** Quits: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu) (Ping timeout)
[20:12:43] <pudgetta> so how would I use the ordering enum? enum Ordering {Relaxed} ?
[20:13:00] <pudgetta> rusti: enum Ordering{Relaxed}
[20:13:00] -rusti- ()
[20:13:41] <strcat> pudgetta: my example is defining a type
[20:13:45] <strcat> you don't need to define a type
[20:13:52] <pudgetta> yes
[20:13:54] <skoizza> strcat: we are trying to call visitor_count.fetch_add(1, Relaxed);
[20:14:20] <pudgetta> we can't figure out how to create an instance of Ordering
[20:14:23] <strcat> rusti: enum Foo { A, B, C } fn bar(x: Foo) -> Foo { x } bar(A)
[20:14:24] <skoizza> strcat: visitor_count being of type atomics::AtomicUint
[20:14:24] -rusti- A
[20:15:03] *** Joins: jeffdb (jeff@moz-D13B6004.hsd1.ca.comcast.net)
[20:15:20] <strcat> rusti: mod baz { pub enum Foo { A, B, C } } fn bar(x: baz::Foo) -> baz::Foo { x } bar(baz::A)
[20:15:21] -rusti- A
[20:15:40] <frau> oh god, I spent a whole ton of time trying to figure out why a struct wouldn't be imported, before finally realizing I put #[cfg(target_os="linux")] on it, and I'm using OS X on this computer
[20:15:43] * frau bangs head on wall
[20:15:58] <strcat> skoizza: does that make sense ^^?
[20:16:21] <pudgetta> strcat: no
[20:16:22] <skoizza> strcat: not really no
[20:16:30] <strcat> well, I don't know which part is unclear
[20:16:44] <strcat> I'm defining a type (an enum) and making an instance of it to call a function
[20:16:53] *** Joins: lenary (uid5084@moz-31ABA2C0.irccloud.com)
[20:17:31] <pudgetta> strcat: were trying to use this seld.be/rustdoc/master/std/unstable/atomics/enum.Ordering.html
[20:17:38] *** Joins: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu)
[20:17:50] <strcat> so you can use it like the example I gave
[20:18:04] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[20:18:07] <strcat> Foo is an enum like Ordering, A is a variant of that enum like Relaxed
[20:18:10] *** Joins: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se)
[20:18:50] <kimundi> rusti: let x = std::unstable::atomics::Relaxed; x
[20:18:51] -rusti- Relaxed
[20:20:34] *** Quits: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu) (Ping timeout)
[20:20:38] <pudgetta> kimundi: thanks a lot
[20:21:10] <int3_> strcat: ah. I guess I need to use named lifetimes then?
[20:21:14] <int3_> to return a borrowed pointer
[20:21:22] <strcat> int3_: yes
[20:21:36] <int3_> gotcha, thanks!
[20:21:42] *** Quits: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net) (Client exited)
[20:21:44] *** Joins: BitPuffin (isak@moz-98F8BF74.cust.tele2.se)
[20:22:02] <strcat> rusti: enum Foo { S(~str) } fn foo(x: &'a Foo) -> &'a str { match *x { S(ref s) => *s, _ => fail!() } }
[20:22:04] -rusti- pastebinned 10 lines of output: http://ix.io/8E6
[20:22:14] <strcat> rusti: enum Foo { S(~str) } fn foo<'a>(x: &'a Foo) -> &'a str { match *x { S(ref s) => *s, _ => fail!() } }
[20:22:16] -rusti- pastebinned 7 lines of output: http://ix.io/8E7
[20:22:31] <strcat> rusti: enum Foo { S(~str) } fn foo<'a>(x: &'a Foo) -> &'a str { match *x { S(ref s) => s.as_slice(), _ => fail!() } }
[20:22:33] -rusti- pastebinned 7 lines of output: http://ix.io/8E8
[20:22:41] * strcat is sill
[20:22:42] <strcat> y
[20:22:53] <strcat> rusti: enum Foo { S(~str), I(int) } fn foo<'a>(x: &'a Foo) -> &'a str { match *x { S(ref s) => s.as_slice(), _ => fail!() } }
[20:22:54] -rusti- ()
[20:23:13] <strcat> I'm not sure why slice auto-borrowing doesn't work there.... *s should work rather than as_slice
[20:23:23] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[20:23:29] *** Quits: Ms2ger (Ms2ger@moz-C96856.adsl-dyn.isp.belgacom.be) (Quit: nn)
[20:23:30] <strcat> oh well.
[20:23:47] *** Joins: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu)
[20:24:09] *** Joins: Ms2ger (Ms2ger@moz-C96856.adsl-dyn.isp.belgacom.be)
[20:25:04] *** Quits: Ms2ger (Ms2ger@moz-C96856.adsl-dyn.isp.belgacom.be) (Client exited)
[20:26:50] *** Joins: gunther (Mibbit@moz-4A19983C.ip227.fastwebnet.it)
[20:28:31] *** Quits: FrozenCow (FrozenCow@moz-B2DF4929.chello.nl) (Client exited)
[20:29:06] *** Joins: barosl (barosl@3DE683B6.E551553C.7544CABF.IP)
[20:29:38] *** Quits: Jesin (Jessin_@moz-14627F8E.cc.lehigh.edu) (Ping timeout)
[20:30:42] <int3_> strcat: I'm still fumbling with it -- http://pastebin.com/xcxHJyyk
[20:30:45] *** Quits: Jackneill (Jackneill@moz-5C16F392.pool.digikabel.hu) (Input/output error)
[20:30:51] <int3_> "mismatched types: expected `&'a str` but found `&~str` (expected &'a str but found &-ptr)"
[20:30:54] <jix> is there any downside of separating a program into many crates?
[20:31:11] <strcat> int3_: you need as_slice
[20:31:40] <strcat> int3_: really you should be able to just do *s to refer to the ~str, and it should get auto-borrowed as &str, but it doesn't work due to a bug with inference from return types
[20:32:47] <gunther> can anyone help me with a compiler error? it says "cannot borrow 'char_count' as mutable more than once" on line 21 and 22. program is here: https://gist.github.com/anonymous/4d60d60abfc1fd2c5085
[20:33:39] *** Joins: jensnockert (jensnocker@moz-90732636.mobileonline.telia.com)
[20:34:38] *** Quits: jensnockert (jensnocker@moz-90732636.mobileonline.telia.com) (Connection reset by peer)
[20:34:53] *** Quits: tgummerer_ (tgummerer@moz-5DC8FA44.tbcn.telia.com) (Ping timeout)
[20:35:05] <int3_> strcat: ahh it works now, thanks!
[20:35:37] *** Quits: pudgetta (Mibbit@F8635924.EBD92228.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:36:52] *** Joins: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca)
[20:37:03] *** Quits: tefter (tefter@B5D119DC.B856A0A1.73804765.IP) (Ping timeout)
[20:37:08] *** Quits: pyrac (pyrac@moz-E2FF17D7.w109-214.abo.wanadoo.fr) (Quit: pyrac)
[20:37:16] *** Joins: tefter (tefter@B5D119DC.B856A0A1.73804765.IP)
[20:37:34] *** Joins: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net)
[20:39:13] *** lbergstrom is now known as lbergstrom|away
[20:39:49] *** Joins: ksf_ (ksf@moz-21D3DDB.adsl.hansenet.de)
[20:39:52] *** Quits: ksf (ksf@moz-8D2477CB.adsl.hansenet.de) (Ping timeout)
[20:39:58] *** Quits: gunther (Mibbit@moz-4A19983C.ip227.fastwebnet.it) (Quit: http://www.mibbit.com ajax IRC Client)
[20:41:09] *** Quits: anshin (anshin@CD85F10D.F21429E2.354459FA.IP) (Quit: sleep)
[20:42:54] <frau> is there a list of all the #[cfg()] attributes somewhere?
[20:43:00] *** Quits: polyfractal (polyfracta@moz-4C5426D6.hsd1.sc.comcast.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[20:43:18] *** Quits: erickt1 (Adium@49C4075F.3AC15C18.2321E71E.IP) (Quit: Leaving.)
[20:46:49] <int3_> strcat: how do I do the same thing for Json::Object? http://pastebin.com/1FGHdSEA
[20:46:59] <int3_> mismatched types: expected `&'a extra::treemap::TreeMap<~str,extra::json::Json>` but found `extra::treemap::TreeMap<~str,extra::json::Json>` (expected &-ptr but found struct extra::treemap::TreeMap)
[20:47:23] <strcat> int3_: ref x => x will work
[20:47:37] <strcat> well, you're currently unwrapping it
[20:47:43] <strcat> into a treemap
[20:48:32] *** Quits: mib (Mibbit@C25CC32F.9EA65473.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:48:32] *** Quits: skoizza (Mibbit@9BA721F0.80BB6BFD.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[20:49:04] <int3_> ahh, right. I should just return the object itself.
[20:49:28] <dwrensha> gunther: I added a suggestion to that gist
[20:49:46] <strcat> int3_: there are @ patterns, to grab the whole thing from the pattern, but I'm not sure if it will let you do it by-reference
[20:49:58] <bjz> does extern mod = "..."; work yet?
[20:50:07] <strcat> int3_: I guess you do want to return a treemap, nvm
[20:50:24] <strcat> otherwise you're just going to be going json -> json
[20:51:12] <int3_> um. yeah that's right
[20:51:28] <int3_> so what should I be doing to return the treemap?
[20:52:42] <int3_> strcat: ^
[20:53:14] *** Joins: Yeri (jasonjasmi@41C91A8A.CE609BA5.E39FBF79.IP)
[20:53:50] *** Joins: tgummerer_ (tgummerer@moz-5DC8FA44.tbcn.telia.com)
[20:55:25] *** Quits: ksf_ (ksf@moz-21D3DDB.adsl.hansenet.de) (Ping timeout)
[20:55:54] <strcat> int3_: just Object(ref x) => x
[20:56:12] <strcat> only reason for the weirdness with str is that you want to be returning &str rather than &~str
[20:56:18] <strcat> just because rust has first-class slices
[20:57:07] <int3_> strcat: I'm already doing that in this paste, right? http://pastebin.com/1FGHdSEA
[20:57:16] <int3_> it's giving me the error "mismatched types: expected `&'a extra::treemap::TreeMap<~str,extra::json::Json>` but found `&~extra::treemap::TreeMap<~str,extra::json::Json>` (expected struct extra::treemap::TreeMap but found ~-ptr)"
[20:58:07] *** Joins: ksf (ksf@moz-996BD0A4.adsl.hansenet.de)
[20:58:33] <int3_> hmm. 'json::Object(ref Object) => &'a **Object' seems to work
[20:58:34] <strcat> int3_: json is being silly and adding a pointless ~ indirection to Object
[20:59:15] *** Quits: ksf (ksf@moz-996BD0A4.adsl.hansenet.de) (Connection reset by peer)
[21:00:13] *** Joins: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com)
[21:00:56] <int3_> strcat: is my way of doing it correct then? borrow a pointer to the Object, dereference it twice, and then 'cast' it to a named lifetime ptr?
[21:01:11] <jmorkel> is there a way for determining whether an object has a specific trait?
[21:01:42] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:01:46] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:01:58] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:02:09] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[21:02:18] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Client exited)
[21:02:19] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[21:02:26] *** Quits: SingingBoyo (SingingBoy@DA28FB90.A5D0D593.4F048BDC.IP) (Ping timeout)
[21:04:52] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[21:05:17] *** DoritosMan is now known as RitosManAway
[21:08:07] *** Joins: ksf (ksf@moz-B7235C30.adsl.hansenet.de)
[21:10:12] *** Joins: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP)
[21:10:31] *** Joins: nejucomo (Adium@moz-A94CACD5.dsl.pltn13.sbcglobal.net)
[21:12:22] *** Quits: ksf (ksf@moz-B7235C30.adsl.hansenet.de) (Ping timeout)
[21:13:49] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[21:14:05] *** RitosManAway is now known as DoritosMan
[21:14:27] *** Joins: bleibig (bleibig@moz-CB11172C.hsd1.ca.comcast.net)
[21:17:33] *** Joins: ksf (ksf@moz-8241DB8B.adsl.hansenet.de)
[21:18:40] *** Quits: int3_ (int3_@moz-D24DA61C.public.wayport.net) (Client exited)
[21:19:15] *** Quits: Blub\w (wry@7E3BB9D.71150E1A.237AE2BA.IP) (Quit: night)
[21:19:24] *** Quits: ksf (ksf@moz-8241DB8B.adsl.hansenet.de) (Ping timeout)
[21:21:04] <ercxx> rusti: let ip : Ipv4Addr = from_str("127.0.0.1");
[21:21:06] -rusti- pastebinned 7 lines of output: http://ix.io/8Ee
[21:23:51] *** Joins: canhtak (jeremy@moz-12EBB66A.wl.t.ulaval.ca)
[21:27:10] *** Joins: ksf (ksf@moz-AC16E64A.adsl.hansenet.de)
[21:28:02] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Quit: Konversation terminated!)
[21:28:12] *** Joins: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[21:30:19] *** Quits: eddyb (eddy@3C6E2DBB.FFB4E060.A5830293.IP) (Ping timeout)
[21:31:50] *** Quits: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP) (Ping timeout)
[21:33:20] *** Joins: eddyb9 (eddy@3C6E2DBB.FFB4E060.A5830293.IP)
[21:34:48] *** Quits: ksf (ksf@moz-AC16E64A.adsl.hansenet.de) (Client exited)
[21:35:40] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[21:35:43] *** strcat1 is now known as strcat
[21:35:50] *** Joins: ksf (ksf@moz-AC16E64A.adsl.hansenet.de)
[21:36:36] *** Quits: Ferreus (ferreus@moz-AE3CB44B.pools.arcor-ip.net) (Quit: WeeChat 0.4.2)
[21:36:59] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[21:37:57] *** Quits: tgummerer_ (tgummerer@moz-5DC8FA44.tbcn.telia.com) (Ping timeout)
[21:39:08] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Client exited)
[21:41:26] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[21:42:32] *** Quits: snadon (chatzilla@moz-3BC727E8.mc.videotron.ca) (Ping timeout)
[21:43:58] *** Quits: reedlepee (Mibbit@B424C7C1.213EDE4D.9D59D0D8.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[21:45:45] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[21:50:05] *** Joins: brson (brson@moz-BBE3ABD.mv.mozilla.com)
[21:50:05] *** ChanServ sets mode: +ao brson brson
[21:50:40] <FreeFull> Well, apparently there is a game called Rust and some people end up posting to the wrong reddit
[21:51:19] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Client exited)
[21:51:20] *** Quits: ksf (ksf@moz-AC16E64A.adsl.hansenet.de) (Connection reset by peer)
[21:52:25] *** Quits: brson (brson@moz-BBE3ABD.mv.mozilla.com) (Ping timeout)
[21:53:13] *** Joins: int3_ (int3_@122E7B1.85C3B074.CED80046.IP)
[21:54:10] *** Joins: ksf (ksf@moz-8877F010.adsl.hansenet.de)
[21:55:02] *** Quits: int3_ (int3_@122E7B1.85C3B074.CED80046.IP) (Ping timeout)
[21:55:58] *** Joins: brson (brson@981AA104.E81F12CD.76F66111.IP)
[21:55:58] *** ChanServ sets mode: +ao brson brson
[21:56:01] *** Quits: donri (donri@moz-9BB61102.tbcn.telia.com) (Client exited)
[21:59:17] *** Joins: polyfractal (polyfracta@CAF68D88.572E68FD.39C3E352.IP)
[21:59:42] *** Joins: stomper (Mibbit@moz-5AF9AA47.hsd1.va.comcast.net)
[22:00:38] *** Quits: polyfractal (polyfracta@CAF68D88.572E68FD.39C3E352.IP) (Quit: Textual IRC Client: www.textualapp.com)
[22:01:00] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:02:02] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:02:13] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:02:21] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[22:04:07] *** Joins: ross (ross@moz-5EA04060.br.br.cox.net)
[22:05:09] *** Joins: jdm (jdm@A931292E.20A5B7E6.930FA32.IP)
[22:05:09] *** ChanServ sets mode: +o jdm
[22:06:06] <Soft> hmm named lifetimes seem like magic
[22:06:14] <Soft> I have written a simple data structure that keeps its data internally in an uniquely owned vector
[22:06:20] <Soft> It also implements an get method with signature like fn get<'r>(&'r self, Coords) -> Option<&'r T>
[22:06:25] *** Quits: sebcrozet (sebcrozet@moz-87D51607.w80-13.abo.wanadoo.fr) (Ping timeout)
[22:06:26] <Soft> Is this a sensible thing to structure things?
[22:07:23] *** Joins: olsonjeffery (pf@B8927AE1.CFEFA148.239A1A9E.IP)
[22:08:11] <Soft> it seems to at least compile
[22:09:27] <SiegeLord> Seems alright to me
[22:09:51] *** Quits: CarpNet (Alasdair@moz-EF831A5E.cable.virginmedia.com) (Quit: Leaving)
[22:12:33] *** Joins: anshin (anshin@CD85F10D.F21429E2.354459FA.IP)
[22:16:36] * nejucomo wonders about the difference between Soft's example and a 'self parameter in the data structure type definition...
[22:17:02] <dbaupp> nejucomo: 'self makes things crash
[22:18:09] <dbaupp> (well, actually: 'self is the (currently only) name for borrowed pointers stored in a struct/enum; that is, if you have an data type storing things that require lifetimes, you're forced to give them lifetimes and call them 'self.)
[22:19:19] <ercxx> why whould a self.something in a fn like(&self,...) complain with this message: error: cannot move out of dereference of & pointer ??
[22:19:42] <ercxx> It works okay with self instead of &self.
[22:19:58] <dbaupp> what type is .something
[22:20:18] *** strcat1 is now known as strcat
[22:21:47] <ercxx> it's this:  let server = super::server::LaleServer::new(ip, port, router), which comes from this: pub fn new(ip: &str, port: u16, router:  super::router::Router ) -> LaleServer
[22:23:41] <dbaupp> I don't see a self.something there?
[22:23:51] <ercxx> It's actually a member of LaleServer
[22:23:53] <ercxx> one sec
[22:24:21] <ercxx> http://pastebin.mozilla.org/3300884
[22:26:22] *** Quits: skade (skade@30BBD5E6.505237C9.CAE22B62.IP) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[22:28:18] *** Quits: six600110 (six600110@moz-C663577C.hsd1.il.comcast.net) (Client exited)
[22:30:11] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[22:32:01] *** Quits: Yeri (jasonjasmi@41C91A8A.CE609BA5.E39FBF79.IP) (Quit: Yeri)
[22:32:38] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Ping timeout)
[22:33:11] *** Joins: nsf (nsf@moz-EEF3238A.convex.ru)
[22:34:29] <dbaupp> ercxx: either server or server.router must be have a type that moves ownership when used by value http://static.rust-lang.org/doc/master/tutorial.html#move-semantics , so the only way to use them in a &self method is as references
[22:35:04] <dbaupp> ercxx: either implicitly by only calling &self methods on them, or explicitly with & (in expressions) and/or `ref` (in pattern matches)
[22:35:26] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Quit: WeeChat 0.4.2)
[22:37:07] <ercxx> dbaupp: thanks
[22:40:41] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[22:42:06] *** Quits: frau (frau@moz-BFE94859.hfc.comcastbusiness.net) (Ping timeout)
[22:42:40] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[22:43:20] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[22:43:57] *** Joins: malvarez (malvarez@5E36B4FF.E5444AFD.FD1591F7.IP)
[22:44:20] *** Joins: nwmcsween (nwmcsween@E0025B86.51EE1362.3655BBF5.IP)
[22:44:40] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[22:46:14] <Thiez> can anyone tell me if the import system has changed in the past two months?
[22:46:50] *** Joins: crembo (crembo@moz-C2B364AA.vc.shawcable.net)
[22:47:11] <Thiez> I finally got a machine capable of compiling rust in less than 3 days but it seems rustray has bitrotted quite a lot since then, and the 'use' statements don't really work anymore
[22:47:33] <dbaupp> Thiez: "don't really work" is fairly non-specific
[22:47:46] <kimundi> privacy has been properly defined and enforced afaik
[22:48:57] <SiegeLord> And re-defined... the old way no longer works in some cases
[22:49:15] <Thiez> for one, it seems I can't do 'extern mod extra; use extra::sort' ?
[22:49:38] <Soft> Is there an explanation somewhere about rusts mut keyword
[22:49:40] <dbaupp> Thiez: put the `extern mod` in your crate file (i..e the one you run rustc on)
[22:49:47] *** Joins: lerc (quassel@moz-1AC1A28C.telstraclear.net)
[22:50:02] <Soft> there are only few examples in the tutorial
[22:50:04] <Thiez> oki, thanks
[22:50:25] <Thiez> and it seems all the 'mod' statements have to be in the crate file as well?
[22:50:43] <kimundi> No neither of these changes are neccessary
[22:50:53] <kimundi> 'extern mod extra; use self::extra::sort'
[22:50:57] <kimundi> should work
[22:51:07] <kimundi> in any module
[22:51:10] *** Quits: lkuper (lkuper@31F4CB6.A0D37E9B.51B6877.IP) (Quit: lkuper)
[22:51:18] *** Quits: tefter (tefter@B5D119DC.B856A0A1.73804765.IP) (Quit: Leaving)
[22:51:28] <kimundi> And mod statements don't need to be in the crate root
[22:51:29] <Soft> for example, I would like to have a field that contains an owned pointer to a vector that contains mutable structures
[22:51:46] <kimundi> It's just recommended because it'S the simplest thing to do, but the is no need for it
[22:52:23] <Soft> I tried typing something like grid: ~[mut T] but I don't think it's valid rust
[22:52:25] <Thiez> okay thanks for the advice :)
[22:52:58] *** Quits: rveach|2 (kvirc@moz-7E54B3A2.hsd1.ca.comcast.net) (Quit: KVIrc 4.2.0 Equilibrium http://www.kvirc.net/)
[22:53:05] *** Joins: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[22:53:59] <kimundi> Soft: mutability is inhertied from the owner. So in this case you would have to store the struct in a mutable location, like a 'let mut', and then you'd be able to modify a field and it's content with type ~[T]
[22:54:08] *** Quits: q66 (q66@6EE9DE40.46454B5D.33AABD5F.IP) (Quit: Leaving)
[22:54:14] <kimundi> the 'let' would be the owner
[22:54:21] <Soft> oh, okay
[22:54:26] <Soft> thanks
[22:54:42] *** Joins: BinRoot (Mibbit@E459F74D.D41652FF.DDE5D3F6.IP)
[22:55:00] <Thiez> rusti: struct S{ x: int } let mut x = ~[S{x:5}]; x[0].x += 1; x // <- like so :)
[22:55:00] -rusti- ~[main::S{x: 6}]
[22:55:19] <BinRoot> How can I view what's inside an Option<V> without owning it?
[22:55:41] <BinRoot> I want to use it later on, but rust complains that i use a moved value
[22:56:52] <Eridius> BinRoot: use .as_ref()
[22:56:58] <Eridius> that will give you an Option<&V> which you can then unwrap
[22:57:38] <BinRoot> as_ref is not implemented by my V
[22:57:45] <Eridius> BinRoot: it's implemented by Option
[22:57:46] <BinRoot> TcpStream does not implement as_ref
[22:57:52] <Eridius> you call it on the Option<V>, not on the V
[22:58:11] <strcat> BinRoot: at a language level, match can extract a binding by-ref
[22:58:25] <strcat> as_ref on Option uses that to turn Option<T> into Option<&T>
[22:58:30] <Eridius> rusti: let x = Some(~[3i]); println!("{:?}", x.as_ref().unwrap()); println!("{:?}", x.unwrap())
[22:58:31] -rusti- &~[3]
[22:58:31] -rusti- ~[3]
[22:58:32] <strcat> but you could also use it directly
[22:58:32] -rusti- ()
[22:58:46] *** Quits: stomper (Mibbit@moz-5AF9AA47.hsd1.va.comcast.net) (Quit: http://www.mibbit.com ajax IRC Client)
[22:58:58] <Eridius> strcat: any thoughts on my response regarding transmute_slice?
[22:59:39] *** Quits: Amaranth (travis@moz-D359BBDD.sxct.qwest.net) (Ping timeout)
[22:59:50] <BinRoot> std::option::Option<tcp::TcpStream>` does not implement any method in scope named `as_ref
[23:00:02] <Eridius> BinRoot: what version of rust are you using?
[23:00:05] <BinRoot> 0.8
[23:00:07] <strcat> Eridius: I don't think it's as useful as you think it is due to endianness
[23:00:08] <Eridius> ahhh
[23:00:16] <Eridius> BinRoot: check the docs. There's separate methods for extracting by-ref
[23:00:22] <strcat> I doubt there is ever going to be another correct usage of it in the codebase
[23:00:23] <BinRoot> does it work on 0.9?
[23:00:24] <malvarez> 0.8 doesn't have as_ref, does it?
[23:00:27] <strcat> and rand should be using bit shifts and &
[23:00:29] <Eridius> strcat: I wrote this because I need to transmute a slice in my own code, and it's error-prone to do by hand
[23:00:37] <strcat> Eridius: why do you need to transmute a slice?
[23:00:41] <strcat> from which type to which type?
[23:00:44] <malvarez> as_ref does show up in the docs for 0.9
[23:00:52] <Eridius> because I have an implementation of the MT19937 random number generator and I need to seed it with OSRng.new().fill_bytes()
[23:01:07] <Eridius> I need to transmute from &[u32] to &[u8] to use fill_bytes
[23:01:15] *** Joins: duaneb (textual@moz-73F5A240.hsd1.pa.comcast.net)
[23:01:19] <dwrensha> rusti: let v = ~[1]; let x = Some(v); match x { Some(ref y) => {} None => {}} x
[23:01:25] *** Joins: strcat1 (strcat@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:01:30] *** Quits: engla (engla@moz-DBD1D96E.cust.bredbandsbolaget.se) (Ping timeout)
[23:01:43] <Eridius> strcat: the whole point of all the methods in cast:: besides transmute() is in order to do certain restricted transmutes a bit more safely
[23:01:49] <strcat1> Eridius: I realize that
[23:01:51] <dwrensha> hm. rusti ignores me.
[23:01:54] <Eridius> transmuting slices seems to fall into that
[23:01:58] *** Quits: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:01:59] <strcat1> Eridius: and I don't want to add a cast that's undefined behaviour with TBAA
[23:02:06] *** Joins: rusti (rusti@moz-54F7FD49.cpe.net.cable.rogers.com)
[23:02:07] <Eridius> TBAA?
[23:02:07] <duaneb> Question, everyone: I understand I can cast from constant-integer enums to integers seamlessly, but what about in reverse? Do I have to manually write a `match`?
[23:02:08] <dwrensha> I just wanted to point out that you can put 'ref' in a pattern to avoid taking ownership
[23:02:16] <strcat1> Eridius: what you're doing is undefined behaviour in C
[23:02:21] <strcat1> because it has type punning rules
[23:02:25] *** Quits: strcat (strcat@moz-54F7FD49.cpe.net.cable.rogers.com) (Ping timeout)
[23:02:47] <Eridius> strcat1: what, casting from a a uint32_t* to a uint8_t* is undefined?
[23:02:51] <Eridius> also, why does C's behavior matter here?
[23:03:35] *** Quits: blank_name (blank_name@2E4E7E43.800E1818.31EC03F3.IP) (Quit: leaving)
[23:03:51] *** Joins: lkuper (lkuper@31F4CB6.A0D37E9B.51B6877.IP)
[23:04:02] <strcat1> Eridius: it matters because we may want to do TBAA for rust
[23:04:06] *** strcat1 is now known as strcat
[23:04:07] <Eridius> again, what is TBAA?
[23:04:11] <strcat> type-based alias analysis
[23:04:12] <FreeFull> How much undefined behaviour does Rust currently have?
[23:04:22] <strcat> FreeFull: there isn't undefined behaviour in safe code
[23:04:46] <Eridius> strcat: I'm not familiar with TBAA. Why does it prevent casting slices?
[23:04:56] <dwrensha> duaneb: FromPrimitive
[23:04:58] <FreeFull> strcat: Is that strictly true though?
[23:05:01] <strcat> Eridius: because it tells LLVM that a pointer to a u32 can't alias with a pointer to an f32
[23:05:03] <Eridius> also, people will occasionally want to cast slices, whether or not we provide the tools. If we don't provide the tools, they're just going to do so unsafely
[23:05:19] <strcat> well, people can't do it in C, so I'm not convinced it's incredibly useful
[23:05:53] <strcat> FreeFull: if all unsafe blocks are correct, there is no undefined behaviour outside of unsafe blocks
[23:05:59] *** Joins: blank_name (blank_name@2E4E7E43.800E1818.31EC03F3.IP)
[23:06:00] <strcat> it's a requirement of a memory safe language
[23:06:02] <duaneb> dwrensha: I assume that FromPrimitive needs to be defined, not derived?
[23:06:07] <strcat> undefined behaviour doesn't mean *unspecified* behaviour
[23:06:18] *** Joins: Amaranth (travis@moz-E80C96B9.sxct.qwest.net)
[23:06:19] <dwrensha> deriving should work
[23:07:05] <Eridius> strcat: what do you mean "can't do it in C"? I just wrote code that does it.
[23:07:16] <Eridius> now whether or not it does it safely in the presence of compiler optimizations, that may very well be "no"
[23:07:25] <strcat> Eridius: it's not C if you invoke undefined behaviour
[23:07:29] <strcat> Eridius: that's how C is defined.
[23:07:48] <strcat> the compiler doesn't prevent you from compiling a program that isn't valid C
[23:08:03] <benh> after reading http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_236.htm i'm not sure i understand the C aliasing rules at all
[23:08:05] <strcat> it likely offers a bunch of warnings to catch a subset of common cases, if it's a sane compiler ;p
[23:08:20] <Eridius> strcat: where can I find the restriction against this sort of cast?
[23:08:36] <duaneb> dwrensha: ahh, this is master (as opposed to 0.8); I'll upgrade accordingly. Thanks!
[23:08:38] <strcat> benh: you're reading a bug report for a specific case in the standard
[23:08:50] <strcat> Eridius: the C standard pdf?
[23:09:03] <Eridius> strcat: I'm reading it
[23:09:12] <strcat> strict aliasing, type punning
[23:09:29] <Eridius> and in fact it claims I can convert a pointer to an object/incomplete type to a pointer of a different object/incomplete type. It's undefined if the resulting pointer is not correctly aligned for the new type, but otherwise it sounds ok
[23:09:43] <benh> strcat: and the commentary and the committee response contradict my intuition :(
[23:09:43] <Eridius> section 6.3.2.3.7
[23:10:03] <Eridius> in fact it expressly defines behavior for converting a pointer to an object into a pointer to a character type
[23:10:11] <strcat> only for char though
[23:10:12] <benh> It's ok to convert them, it's not ok to dereference it, it's only ok to conert it back to the original type, pretty much
[23:10:25] <Eridius> strcat: it only claims it's undefined if the resulting pointer is not aligned
[23:10:32] <strcat> Eridius: you're not reading the right part then
[23:10:37] <Eridius> then what part should I read?
[23:11:28] *** Joins: skade (skade@moz-D8051715.pools.arcor-ip.net)
[23:11:45] <BinRoot> Eridius: thanks and_then_mut_ref works!
[23:12:32] <Eridius> strcat: reading annex J.2 Undefined Behavior, it again repeats that converting from one pointer type to another where the resulting pointer is not correctly aligned is undefined. But that's it
[23:12:40] <Eridius> I see no restriction against converting e.g. a uint32_t to a uint16_t
[23:12:41] *** Joins: curmet (Mibbit@2DF5C0E3.25827DD2.293BA0E4.IP)
[23:12:48] <Eridius> make that uint32_t* to uint16_t*
[23:12:50] *** Quits: curmet (Mibbit@2DF5C0E3.25827DD2.293BA0E4.IP) (User has been banned from Mozilla (no spamming here))
[23:13:10] *** Joins: enix (enix@moz-A50569DD.c3-0.slvr-ubr1.lnh-slvr.md.cable.rcn.com)
[23:13:10] <strcat> Eridius: because you're not reading about what happens when you read from an invalid type pun
[23:13:27] <Eridius> strcat: you keep saying I'm not reading the right part. But you won't tell me what to read
[23:13:36] <Eridius> what I'm reading right now is the list of undefined behavior, and I don't see what you're talking about
[23:13:43] *** Quits: crembo (crembo@moz-C2B364AA.vc.shawcable.net) (Client exited)
[23:13:53] <benh> Last paragraphs in 6.5. afaik
[23:14:05] <benh> like, right before the 6.5.1 heading
[23:14:17] *** Joins: frau (frau@moz-3F7DB997.hsd1.ca.comcast.net)
[23:15:02] <Eridius> benh: what are you looking at? the PDF I'm reading, which is ISO/IEC 9899:1999, the last paragraph before 6.5.1 has to do with floating expressions being contracted (whatever that is)
[23:15:06] <strcat> certain operations are invalid just when you cast/index, and others are invalid when you read/write
[23:15:15] <benh> Eridius: a few before that!
[23:15:41] <strcat> An object shall have its stored value accessed only by an lvalue expression that has one of
[23:15:43] <strcat> the following types: 88)
[23:15:45] <strcat> — a type compatible with the effective type of the object,
[23:15:47] <strcat> — a qualified version of a type compatible with the effective type of the object,
[23:15:49] <strcat> — a type that is the signed or unsigned type corresponding to the effective type of the
[23:15:51] <strcat> object,
[23:15:53] <strcat> — a type that is the signed or unsigned type corresponding to a qualified version of the
[23:15:55] <strcat> effective type of the object,
[23:15:57] <strcat> — an aggregate or union type that includes one of the aforementioned types among its
[23:15:59] <strcat> members (including, recursively, a member of a subaggregate or contained union), or
[23:16:01] <strcat> — a character type.
[23:16:10] <Eridius> you could have just said 6.5.0.7
[23:16:39] <benh> Sorry, I'm not familiar with counting/addressing paragraphs in the standard :(
[23:16:42] <strcat> it's not that number here
[23:16:48] <Eridius> strcat: what are you reading then?
[23:16:54] <strcat> this is 9899:2011
[23:17:15] <benh> Also I don't see the pointer conversion wording promise that a pointer after a cast still is a valid pointer, only that you can cast it back and get the original pointer. Except for the special case of char pointers. Am I overly pessimistic with that?
[23:17:35] <strcat> benh: well, they have trees of compatible types
[23:17:39] <strcat> generally, they are not compatible
[23:17:50] <strcat> any user-defined types are incompatible with anything but char, afaik
[23:18:07] <strcat> you can compile a program with clang and look at the TBAA tree it outputs
[23:18:12] *** Quits: lenstr_ (lenstr@AF8EB999.6049B16A.85938D85.IP) (Client exited)
[23:18:13] <Eridius> strcat: would it make you happy if I changed this to transmute_slice_to_u8()? Since that seems to be the one cast that is unambiguously allowed in C?
[23:18:20] <Eridius> since that's really the cast I need
[23:19:13] * strcat shrugs
[23:19:24] *** Joins: geoffhill (geoffhill@moz-2785B672.hsd1.wa.comcast.net)
[23:19:27] <Eridius> also where is compatible type defined?
[23:19:27] <strcat> or make that rand function not rely on this
[23:19:46] <benh> 6.2.7 apparently
[23:19:59] <strcat> my numbers are different :(
[23:20:01] <benh> I read that section like three times today and didn't understand it
[23:20:02] <Eridius> I think rand needs this, somehow. Either by transmuting slices, or by dropping down to *-pointers and doing the conversion manually. Which is even suckier
[23:20:08] <benh> Yeah, I'm also reading the C99 standard
[23:20:13] <Eridius> benh: thanks
[23:21:10] *** Quits: ksf (ksf@moz-8877F010.adsl.hansenet.de) (Ping timeout)
[23:21:20] <strcat> we don't necessarily have to worry about this but I don't want to preclude the option of doing it
[23:21:43] * strcat shrugs
[23:21:45] * benh always feels like going through the standard like this is closer to theology than anything
[23:21:52] <Eridius> strcat: my worry is if we don't provide a tool to do this, anyone who wants to do this will just use transmute(). And even if it works today, it's just a time bomb waiting to go off later
[23:22:05] <strcat> all unsafe code is a time bomb ;p
[23:22:08] <strcat> especially transmutes
[23:22:24] <Eridius> but if we provide transmute_slice() now, and we decide to introduce TBAA later, we can remove it (and document why), at which point all existing code that transmutes slices will fail to compile, which is a good thing
[23:22:30] *** Quits: earlzlap (earlz@moz-9E279EAD.neo.res.rr.com) (Ping timeout)
[23:22:51] <Eridius> furthermore, we could even provide something like a built-in trait CompatibleType<A,B> that says whether the types are compatible, which would then allow us to simply restrict transmute_slice
[23:23:15] <malvarez> Something like a weaker version of an equality type?
[23:24:16] <benh> non-symmetric :v
[23:25:09] *** Quits: geoffhill (geoffhill@moz-2785B672.hsd1.wa.comcast.net) (Quit: geoffhill)
[23:25:49] *** Quits: BinRoot (Mibbit@E459F74D.D41652FF.DDE5D3F6.IP) (Quit: http://www.mibbit.com ajax IRC Client)
[23:26:26] *** Quits: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net) (Quit: Jesse)
[23:26:44] *** Joins: Jesse (jruderman@moz-537BCF9.hsd1.ca.comcast.net)
[23:27:04] <malvarez> Wouldn't it be more general to add subtyping? Like, having a trait SubtypeOf<T1, T2> that would allow you to coerce a T1 into a T2? Would this be useful at all?
[23:27:12] <FreeFull> One of the problems with using pointers to slice u32 to u8 is endianness
[23:27:25] <strcat> right, that's why C forbids this
[23:27:29] <strcat> (well, not to char)
[23:27:30] <Eridius> strcat: except it doesn't
[23:27:33] *** Quits: jmorkel (chatzilla@moz-4EBBDBAC.dynamic.isadsl.co.za) (Ping timeout)
[23:27:47] <FreeFull> You can always do a slice operation with defined endianness that doesn't involve pointers at all
[23:27:50] *** Joins: ksf (ksf@moz-8760A414.adsl.hansenet.de)
[23:27:55] <FreeFull> Which might or might not get optimised away
[23:27:57] <Eridius> FreeFull: endianness can very well be an issue, but it's not *necessarily* an issue. What if I'm restricting myself to a process architecture? What if I don't care about endianness because I'm not relying on the byte order?
[23:27:59] <strcat> Eridius: it does forbid it in general
[23:28:10] <strcat> if you make
[23:28:16] <Eridius> strcat: not converting to char, which is what FreeFull just talkeda bout
[23:28:16] <strcat> struct Byte { char x; };
[23:28:26] <FreeFull> Eridius: If the data ever leaves the program, then endianness does become an issue
[23:28:27] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Client exited)
[23:28:34] <strcat> you can't cast uint32_t* to Byte* and read from it
[23:28:35] <strcat> it will assume it doesn't alias
[23:28:48] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[23:28:52] <Eridius> FreeFull: correct. But there are plenty of ways to write things that would be a problem if you tried to transmit it over the network to a program on another architecture
[23:29:08] <FreeFull> I mean, even writing to a file
[23:29:20] <Eridius> well only if the file is moved to a computer on a different process architecture
[23:29:31] *** Joins: ChrisMorgan (chris@moz-B3EDAB85.its.monash.edu.au)
[23:29:55] *** Quits: ksf (ksf@moz-8760A414.adsl.hansenet.de) (Ping timeout)
[23:29:57] <FreeFull> It's not too much trouble to have your endianness defined, and prevents a lot of headaches later on
[23:30:07] <Eridius> remember, we're talking about something that is explicitly unsafe code here. Saying "well it won't work as expected if you ignore endianness" isn't particularly important
[23:30:34] *** Quits: spott (spott@moz-9B11536C.hsd1.co.comcast.net) (Ping timeout)
[23:30:59] <strcat> unsafe code will have undefined behaviour if it violates any of the complex built-in LLVM aliasing/indexing rules, or if it violated TBAA enforced rules
[23:31:14] <strcat> it's not like writing unsafe code is easy
[23:31:18] <benh> (I don't know how llvm works, is TBAA like a toggle there?)
[23:31:19] *** Joins: libfud (libfud@moz-CFD886E7.res-cmts.eph2.ptd.net)
[23:31:27] <strcat> benh: we already have TBAA enabled
[23:31:32] <strcat> but we don't output type information
[23:31:44] *** Quits: DoritosMan (RitosMan@moz-111D941D.lightspeed.hstntx.sbcglobal.net) (Quit: My MacBook has gone to sleep. ZZZzzz…)
[23:31:51] <strcat> we just use the LLVM types, which are more representations than types (you can output nodes with your actual types, for TBAA to use)
[23:32:19] *** Joins: ksf (ksf@moz-6D890579.adsl.hansenet.de)
[23:32:27] <strcat> rusti: let mut x = 0 as *int; x.offset(1); x as int
[23:32:29] -rusti- pastebinned 7 lines of output: http://ix.io/8EO
[23:32:37] <strcat> rusti: let mut x = 0 as *int; unsafe { x.offset(1) }; x as int
[23:32:38] -rusti- <anon>:9:17: 9:18 warning: variable does not need to be mutable, #[warn(unused_mut)] on by default
[23:32:38] -rusti- <anon>:9          let mut x = 0 as *int; unsafe { x.offset(1) }; x as int
[23:32:38] -rusti-                           ^
[23:32:38] -rusti- 0
[23:32:48] <strcat> rusti: let mut x = 0 as *int; unsafe { x.offset(1) } as int
[23:32:50] -rusti- pastebinned 9 lines of output: http://ix.io/8EP
[23:32:56] <benh> I'm actually surprised that we don't already have a pile of tbaa-unsafe transmute calls in rustc somewhere
[23:33:16] <strcat> we had a lot before
[23:33:21] <strcat> they were from Drop taking &self
[23:33:33] <strcat> rusti: let x = 0 as *int; let y = unsafe { x.offset(1) }; y as int
[23:33:36] -rusti- 8
[23:33:43] <strcat> (that's undefined behaviour)
[23:33:51] *** Quits: ksf (ksf@moz-6D890579.adsl.hansenet.de) (Quit: Leaving)
[23:34:06] <strcat> rusti: let x = 0 as *int; let y = (x as int + 8) as *int; y as int
[23:34:07] -rusti- 8
[23:34:09] <Thiez> I have a case of 'unresolved name: `Path`' but doing 'use std::path::Path' doesn't make it go away, am I doing something wrong?
[23:34:10] <strcat> that isn't undefined behaviour
[23:34:35] <benh> Really?
[23:34:49] <benh> hm
[23:34:53] <benh> It's implementation-defined?
[23:34:59] <strcat> undefined behaviour
[23:35:02] <strcat> not implementation defined
[23:35:29] <SiegeLord> Thiez: How are you using 'Path'?
[23:35:44] <strcat> benh: I'll give you an example of how LLVM uses undefined behaviour
[23:35:47] <strcat> a C example
[23:35:52] <SiegeLord> You might have Path("blah") (it got changed to Path::new("blah")
[23:35:55] <Eridius> Thiez: are you calling Path as a function?
[23:36:03] <strcat> so, C says signed int overflow is *undefined*
[23:36:06] <benh> I wouldn't have guessed that 8 as *int is not undefined, but if it isn't, it's at least implementation defined, isn't it?
[23:36:11] <Thiez> Eridius: ah, that's it
[23:36:13] <benh> or at most
[23:36:22] <Thiez> I must ::new it of course
[23:36:25] <strcat> benh: it's well defined, if you cast pointers to/from integers they just act as addresses
[23:36:47] <strcat> benh: regular pointer arithmetic must be in-bounds of an object (or 1 byte past the end)
[23:36:50] <Thiez> this code is like two months old and it's hopelessly unusable
[23:37:01] <benh> 1 byte or one sizeof(T)-unit?
[23:37:17] <strcat> benh: 1 byte, so the next unit is fine (because the ptr would only be pointing at the start of it)
[23:37:18] <benh> or uh
[23:37:23] <benh> right
[23:37:23] <strcat> if you have
[23:37:26] <benh> "just past the end"
[23:37:33] <strcat> yeah
[23:37:42] <strcat> like if you have [int, ..3]
[23:37:44] <SiegeLord> Thiez: It used to work... there just happened to have been a rewrite of Path
[23:38:00] <benh> strcat: ... I assumed that it was only safe/defined to cast integers to pointers if you got the integer from casting a pointer in the first place
[23:38:02] <strcat> |int|int|int|one_past_the_end| is what you can index
[23:38:07] <benh> right
[23:38:14] <strcat> benh: well, I'm not talking about aliasing rules
[23:38:16] <nejucomo> I don't understand this section: http://static.rust-lang.org/doc/0.8/tutorial-ffi.html#linking
[23:38:17] <Eridius> Thiez: let me know if you have any trouble with the new Path. I wrote it ;)
[23:38:25] <benh> me either!
[23:38:27] *** Joins: spott (spott@moz-9B11536C.hsd1.co.comcast.net)
[23:38:28] <strcat> benh: it's unsafe to cast an integer to a ptr and *dereference* it, except in certain cases
[23:38:37] <nejucomo> Does this mean: extern mod Foo {…}   // -will implicitly pass -lFoo to the linker?
[23:38:42] <strcat> but it's okay to cast it as a ptr and back to an int ;p
[23:38:47] *** Parts: libfud (libfud@moz-CFD886E7.res-cmts.eph2.ptd.net) ()
[23:38:47] <Eridius> nejucomo: I believe so
[23:38:54] <SiegeLord> Isn't that syntax gone?
[23:39:01] <strcat> you can use pointers as integers as long as you never deref them or use pointer arithmetic
[23:39:07] <benh> but the value of your (null-ptr + 1)-as-int isn't specified, is it?
[23:39:10] <strcat> at least, if you use inbounds pointer arithmetic
[23:39:26] <strcat> benh: it is specified
[23:39:34] <Thiez> Eridius: I doubt it, I'm not doing anything exciting :)
[23:39:35] <strcat> dereferencing anything derived from a null ptr isn't
[23:39:42] <strcat> benh: LLVM defines null as 0
[23:39:56] <strcat> in C, it's implementation defined afaik
[23:40:03] <strcat> but we don't need to worry about that
[23:40:39] <benh> so the only thing you can do with ((null as int) + 8) as *int is to cast it back to an int, right...?
[23:40:59] <benh> can you even compare it?
[23:41:06] <Thiez> speaking of pointers, how much of rust would explode on a system that uses segments instead of the flat memory model we've all grown to love?
[23:41:32] <strcat> benh: it's okay to compare them
[23:41:47] <strcat> benh: LLVM also has an alternate form of non-inbounds pointer arithmetic
[23:41:48] *** Joins: skoizza (Mibbit@moz-C3630477.hsd1.va.comcast.net)
[23:42:00] <strcat> but C/C++ expose no way to do it, and rust won't expose it until someone identifies a real use case
[23:42:15] *** Joins: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net)
[23:42:25] <Thiez> 'is ((null as int) + 8) as *int' even legal? I thought it was forbidden to create pointers that point to nowhere
[23:42:45] <strcat> (you can just cast to/from integers, the only reason you would want the non-inbounds ptr arithmetic is to keep the stricter aliasing rules for performance)
[23:43:06] <strcat> Thiez: it is forbidden to create ptrs outside of object bounds with inbounds pointer arithmetic
[23:43:19] <strcat> and rust forbids ever creating an invalid non-raw ptr
[23:43:42] <strcat> but creating invalid raw ptrs from integer casts is totally fine
[23:43:49] *** Joins: martndemus (martndemus@moz-876695FC.sshunet.nl)
[23:43:51] <strcat> as is comparing them and casting back to integers
[23:43:55] <strcat> rusti: 0 as *int as int
[23:43:55] <Thiez> okay
[23:43:56] -rusti- 0
[23:44:55] <nejucomo> The first example of reading rl_readline_version is outside of unsafe.  What are the semantics when multiple tasks read an extern static?
[23:45:11] <nejucomo> -here: http://static.rust-lang.org/doc/0.8/tutorial-ffi.html#accessing-foreign-globals
[23:45:18] <strcat> nejucomo: statics are immutable, reading them is safe
[23:45:27] <strcat> if it's not immutable in the foreign library, the incorrect part is saying it is
[23:45:48] <nejucomo> Ah, so reading a static mut requires unsafe?
[23:45:51] <strcat> yes
[23:45:53] *** Quits: martndemus (martndemus@moz-876695FC.sshunet.nl) (Ping timeout)
[23:45:57] <strcat> reading/writing to static mut requires unsafe
[23:46:45] *** Quits: DAddYE (DAddYE@moz-98D3933F.hsd1.ca.comcast.net) (Ping timeout)
[23:46:46] <nejucomo> Actually, I haven't learned the unsafe semantics yet (such as how unsafe blocks and tasks intersect), but maybe that'll be described in FFI or another linked tutorial...
[23:46:56] *** Parts: malvarez (malvarez@5E36B4FF.E5444AFD.FD1591F7.IP) ()
[23:47:17] <nejucomo> Actually, I'm going to file a ticket for this section: http://static.rust-lang.org/doc/0.8/tutorial-ffi.html#accessing-foreign-globals
[23:47:25] *** Quits: ibnc (ibnc@moz-8A9CD85B.client.mchsi.com) (Quit: )
[23:47:37] <strcat> nejucomo: well
[23:47:42] <strcat> if you get any of the signatures wrong, that's unsafe
[23:47:45] <nejucomo> The second example only mentions *writing* static mut (and the code only writes), so it might be more helpful to mention reads and have a read example.
[23:47:52] <strcat> ah
[23:50:33] *** Joins: malvarez (malvarez@5E36B4FF.E5444AFD.FD1591F7.IP)
[23:52:23] *** Quits: skade (skade@moz-D8051715.pools.arcor-ip.net) (Quit: My MacBook Pro has gone to sleep. ZZZzzz…)
[23:54:01] *** Joins: adridu59 (Mibbit@moz-6C393FDD.rev.numericable.fr)
[23:54:16] <adridu59> cmr: r? https://github.com/mozilla/rust/pull/9960
[23:55:42] *** Quits: nsf (nsf@moz-EEF3238A.convex.ru) (Quit: WeeChat 0.4.2)
[23:57:17] *** Quits: lkuper (lkuper@31F4CB6.A0D37E9B.51B6877.IP) (Quit: lkuper)
[23:58:36] <adridu59> cmr: thanks
