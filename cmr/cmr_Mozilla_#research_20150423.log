[00:00:59] *** Quits: ehsan_ (ehsan@moz-u5pf4v.ckpj.s0pt.0450.2001.IP) (A TLS packet with unexpected length was received.)
[00:05:10] *** Joins: sav (e@moz-9u3te2.cc)
[00:06:26] *** Quits: mchang (mchang@moz-q472sa.res.rr.com) (Client exited)
[00:06:27] <roc> pcwalton: ping
[00:06:31] <pcwalton> roc: pong
[00:06:50] <roc> one part of the Houdini work is custom painting
[00:07:11] <roc> the use-cases are around things like drawing fancy animated backgrounds for buttons and the like
[00:07:47] <roc> the straightforward approach is to draw into canvases during requestAnimationFrame callbacks
[00:08:12] <pcwalton> hmm, I guess the toughest thing about that is that so far we haven't run any JS in the compositor process for security reasons
[00:08:16] <pcwalton> but we could treat it like a canvas I suppose
[00:08:25] <roc> we may not really need this in the compositor
[00:08:28] <pcwalton> the compositor process does the painting in Servo
[00:08:34] <pcwalton> (though on a separate thread from the compositing)
[00:09:04] <roc> the way you'd implement this today is to draw into a canvas during requestAnimationFrame
[00:09:26] <roc> and try to arrange that your custom paint callback runs after other callbacks that change layout
[00:09:35] <pcwalton> yeah, that's unfortunately main thread only, so I can see the use of custom painting
[00:10:20] <roc> for Gecko and Blink there isn't much advantage to going beyond that, AFAICT, other than that you can address the callback ordering problem
[00:10:36] <pcwalton> I think we could basically pretend it's a canvas, since our canvas rendering is already proxied out to a separate thread
[00:10:48] <pcwalton> it'd just be layout that kicks off the painting instead of script
[00:11:01] <roc> there are some questions about the overhead of canvas buffers vs directly drawing, but I think those can mostly be addressed by capturing drawing commands in the canvas and replaying them instead of using a buffer
[00:11:19] <pcwalton> that is, triggers the event in the isolated JS context (presumably this is isolated) that causes the custom painting
[00:11:31] *** khuey is now known as khuey|away
[00:11:40] <roc> so I think the main reason to have an isolated JS context is to allow Servo to do off-main-thread layout :-)
[00:12:10] <pcwalton> well, also you don't want callbacks to JS during layout for security reasons in Gecko and Blink? I seem to recall you said that
[00:12:21] <roc> this doesn't require callbacks to JS during layout
[00:12:44] <roc> the naive works-today approach would simply resize the canvas (if necessary) and paint it during a rAF callback
[00:12:50] <roc> the resize would flush layout
[00:12:53] <roc> well
[00:13:04] <roc> since we only need the element size, we don't need to flush all of layout
[00:13:19] <pcwalton> wouldn't that cause a flash of unrendered content?
[00:13:23] <pcwalton> unpainted content that is
[00:13:44] <roc> no, why would it?
[00:14:15] <roc> gotta go to lunch, sorry
[00:14:25] <roc> I'll read your explanation later :-)
[00:14:42] <pcwalton> I thought you meant the sequence was: layout happens -> paints and canvas resizes -> content drawn to screen -> event dispatched to script -> script draws canvas -> canvas content painted
[00:14:50] <pcwalton> the first "content drawn to screen" is unrendered
[00:14:58] <pcwalton> since the event hasn't been dispatched yet
[00:15:03] <pcwalton> but I'm probably misunderstanding
[00:15:10] <pcwalton> ok, we'll talk later :)
[00:19:04] *** Quits: brson (brson@moz-h4f.m43.48.37.IP) (Ping timeout: 121 seconds)
[00:19:22] *** Joins: brson (brson@moz-q9q.abh.232.109.IP)
[00:19:23] *** ChanServ sets mode: +o brson
[00:25:02] *** Quits: mccr8 (mccr8@moz-cfhap5.mtv2.mozilla.com) (Quit: computer sleep)
[00:25:24] *** Quits: jdm (jdm@moz-nma4vh.ckpj.s0pt.0450.2001.IP) (Quit: )
[00:31:59] *** Quits: azakai (alon@moz-e6g5n2.mh2d.1ibb.0101.2620.IP) (Ping timeout: 121 seconds)
[00:32:16] *** Joins: azakai (alon@moz-4c01db.ujol.1ibb.0101.2620.IP)
[00:35:07] *** Joins: gal (gal@moz-n65ofb.ujol.1ibb.0101.2620.IP)
[00:36:46] *** Joins: gal_ (gal@moz-cfhap5.mtv2.mozilla.com)
[00:39:13] *** Quits: gal (gal@moz-n65ofb.ujol.1ibb.0101.2620.IP) (Ping timeout: 121 seconds)
[00:39:13] *** gal_ is now known as gal
[00:44:59] *** Quits: gal (gal@moz-cfhap5.mtv2.mozilla.com) (Client exited)
[00:52:53] *** Quits: azakai (alon@moz-4c01db.ujol.1ibb.0101.2620.IP) (Quit: Ex-Chat)
[01:00:30] *** Joins: gal (gal@moz-evabkq.ujol.1ibb.0101.2620.IP)
[01:00:46] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[01:09:26] *** Joins: mchang (mchang@moz-q472sa.res.rr.com)
[01:34:04] *** Quits: gal (gal@moz-evabkq.ujol.1ibb.0101.2620.IP) (Client exited)
[01:42:31] *** Joins: azakai|2 (alon@moz-l3ofdg.sntcca.sbcglobal.net)
[01:42:48] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[01:42:48] *** ChanServ sets mode: +o pcwalton
[01:51:57] *** Quits: brson (brson@moz-q9q.abh.232.109.IP) (Quit: leaving)
[01:59:40] *** Joins: nrc (nrc@moz-9v1svd.xtra.co.nz)
[02:18:36] *** Quits: mbx (textual@moz-qjbkeh.mtv2.mozilla.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:20:12] *** Joins: mbx (textual@moz-qjbkeh.mtv2.mozilla.com)
[02:26:42] *** Joins: cjones (cjones@moz-0mk.n2o.204.201.IP)
[02:27:48] *** Quits: mbx (textual@moz-qjbkeh.mtv2.mozilla.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[02:37:41] *** khuey|away is now known as khuey
[02:37:56] *** Quits: mchang (mchang@moz-q472sa.res.rr.com) (Client exited)
[02:40:08] *** Quits: cjones (cjones@moz-0mk.n2o.204.201.IP) (Client exited)
[02:44:39] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[02:49:54] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[02:49:54] *** ChanServ sets mode: +o pcwalton
[02:50:00] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[02:55:10] *** Quits: jweathersby (Adium@moz-a67gsb.ip.windstream.net) (Quit: Leaving.)
[02:55:26] *** Joins: cjones (cjones@moz-0mk.n2o.204.201.IP)
[02:55:48] *** Joins: jweathersby (Adium@moz-a67gsb.ip.windstream.net)
[02:58:12] *** Joins: mccr8 (mccr8@moz-m84lpe.ca.comcast.net)
[03:01:17] *** Quits: mccr8 (mccr8@moz-m84lpe.ca.comcast.net) (Quit: quit)
[03:24:56] <roc> khuey: this bug causing test failures on your machine is hilarious. Want to hear it?
[03:25:24] <khuey> roc: sure
[03:26:43] <roc> our preload.c code calls a fake SYS_rrcall_init_buffers syscall, passing a pointer to a rrcall_init_buffers_params ... which is in/out
[03:27:24] <roc> Task::init_buffers_arch reads that record, modifies it, and writes it back. Which sounds fine
[03:27:36] <roc> except that on x86-64 that struct has holes
[03:27:51] <roc> and the read/write code copies that struct
[03:27:57] <roc> and the copying code doesn't copy the holes
[03:28:11] <roc> (it's just struct assignment)
[03:28:22] <khuey> mmm
[03:28:37] <roc> so we end up copying a few uninitialized bytes of the rr process memory back to the tracee
[03:28:44] <roc> which causes divergence later
[03:28:48] <khuey> fun times
[03:29:06] <roc> when the tracee happens to pass some uninitialized memory as the (unused) parameter to a system call
[03:29:52] * roc wonders what is the right way to fix this
[03:55:23] <khuey> roc: presumably you could force the struct to have no padding
[04:10:55] *** Joins: gal (gal@moz-t19.bab.126.76.IP)
[04:14:56] *** Joins: mbx (textual@moz-fjua8t.ca.comcast.net)
[04:43:07] <roc> khuey: yeah. But I'd also like to have a systematic way to avoid such bugs in the future, since they're easy to introduce
[04:43:45] <roc> I've done something not-completely-effective
[04:43:50] <roc> but it did find one other bug!
[04:49:59] *** Joins: ddamjano (Instantbird@moz-u8jps4.ehig.7h68.8388.2a02.IP)
[05:26:16] *** Quits: ddamjano (Instantbird@moz-u8jps4.ehig.7h68.8388.2a02.IP) (Ping timeout: 121 seconds)
[05:43:23] *** Quits: roc (chatzilla@moz-h8ll9b.dqqd.b0fh.0cb0.2001.IP) (Connection closed)
[05:59:30] *** Quits: gal (gal@moz-t19.bab.126.76.IP) (Client exited)
[06:08:43] *** Joins: gal (gal@moz-t19.bab.126.76.IP)
[06:15:36] *** Quits: cjones (cjones@moz-0mk.n2o.204.201.IP) (Client exited)
[06:35:54] *** Joins: ddamjano (Instantbird@moz-u8jps4.ehig.7h68.8388.2a02.IP)
[06:50:56] *** Joins: Dexter (Alessio@moz-lsijj5.retail.telecomitalia.it)
[07:14:40] *** Joins: roc (chatzilla@moz-hf0khg.orcon.net.nz)
[07:28:56] *** jandem-away is now known as jandem
[07:44:13] *** Quits: gal (gal@moz-t19.bab.126.76.IP) (Client exited)
[07:49:43] *** Quits: roc (chatzilla@moz-hf0khg.orcon.net.nz) (Connection closed)
[08:08:23] *** Joins: gds (user@moz-p2hots.cable.virginm.net)
[08:38:26] *** Joins: roc (chatzilla@moz-hf0khg.orcon.net.nz)
[09:21:18] *** Quits: mbx (textual@moz-fjua8t.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[11:14:42] *** Joins: jdm (jdm@moz-ilbt2e.cable.teksavvy.com)
[11:52:02] *** Quits: nrc (nrc@moz-9v1svd.xtra.co.nz) (Ping timeout: 121 seconds)
[12:02:16] *** Joins: till (till@moz-c2j1g4.adsl.alicedsl.de)
[12:58:36] *** Quits: gds (user@moz-p2hots.cable.virginm.net) (Quit: Going offline)
[13:00:51] *** Joins: gds (user@moz-p2hots.cable.virginm.net)
[13:25:32] *** Joins: tadh (quassel@moz-77pugv.res.rr.com)
[13:59:48] *** Quits: tadh (quassel@moz-77pugv.res.rr.com) (Ping timeout: 121 seconds)
[14:03:37] *** Joins: tadh (quassel@moz-77pugv.res.rr.com)
[14:37:44] *** Quits: tadh (quassel@moz-77pugv.res.rr.com) (Ping timeout: 121 seconds)
[14:39:42] *** Joins: tadh (quassel@moz-77pugv.res.rr.com)
[14:58:24] *** Joins: mchang (mchang@moz-q472sa.res.rr.com)
[15:05:59] *** Quits: sav (e@moz-9u3te2.cc) (Quit: Caught deadly signal: SIGSLEEP)
[15:11:07] *** Joins: sav (e@moz-qa4.jen.247.37.IP)
[15:55:02] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[16:23:05] *** Joins: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com)
[16:26:25] *** Joins: ehsan (ehsan@moz-kl4u98.ckpj.s0pt.0450.2001.IP)
[16:37:01] *** Joins: mbx (textual@moz-fjua8t.ca.comcast.net)
[16:44:29] *** Joins: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net)
[16:44:29] *** ChanServ sets mode: +o pcwalton
[16:53:42] *** Joins: brson (brson@moz-cfhap5.mtv2.mozilla.com)
[16:53:42] *** ChanServ sets mode: +o brson
[17:01:31] *** khuey is now known as khuey|away
[17:09:15] *** Quits: gds (user@moz-p2hots.cable.virginm.net) (Quit: Going offline)
[17:22:19] *** Quits: mbx (textual@moz-fjua8t.ca.comcast.net) (Quit: My Mac has gone to sleep. ZZZzzz…)
[17:28:17] *** Quits: pcwalton (pcwalton@moz-6kjabm.ca.comcast.net) (Client exited)
[17:32:05] *** Quits: azakai|2 (alon@moz-l3ofdg.sntcca.sbcglobal.net) (Quit: Ex-Chat)
[17:39:41] *** khuey|away is now known as khuey
[17:43:09] *** Joins: pcwalton (pcwalton@moz-nh2.o1i.216.216.IP)
[17:43:09] *** ChanServ sets mode: +o pcwalton
[17:44:44] *** Quits: Dexter (Alessio@moz-lsijj5.retail.telecomitalia.it) (Quit: Leaving)
[18:12:38] *** Quits: pcwalton (pcwalton@moz-nh2.o1i.216.216.IP) (Client exited)
[18:15:27] *** Joins: mbx (textual@moz-l8ebtf.sfo1.mozilla.com)
[18:16:20] *** Joins: azakai (alon@moz-qjbkeh.mtv2.mozilla.com)
[18:21:53] *** Quits: ddamjano (Instantbird@moz-u8jps4.ehig.7h68.8388.2a02.IP) (Ping timeout: 121 seconds)
[18:50:56] *** Joins: gal (gal@moz-bplmlu.ujol.1ibb.0101.2620.IP)
[18:52:17] *** Quits: Luqman (laden@moz-qhp202.csclub.uwaterloo.ca) (Ping timeout: 121 seconds)
[19:00:43] *** Quits: mbx (textual@moz-l8ebtf.sfo1.mozilla.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[19:03:49] *** Joins: mbx (textual@moz-l8ebtf.sfo1.mozilla.com)
[19:11:15] *** Quits: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com) (Quit: computer sleep)
[19:19:23] *** Joins: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com)
[19:22:39] *** Quits: tadh (quassel@moz-77pugv.res.rr.com) (Connection closed)
[19:23:27] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[19:23:27] *** ChanServ sets mode: +o pcwalton
[19:37:07] *** Quits: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com) (Quit: computer sleep)
[19:54:34] *** Quits: jdm (jdm@moz-ilbt2e.cable.teksavvy.com) (Quit: )
[19:58:27] *** Quits: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com) (Client exited)
[20:02:21] *** Quits: gal (gal@moz-bplmlu.ujol.1ibb.0101.2620.IP) (Client exited)
[20:02:59] *** Joins: nrc (nrc@moz-9v1svd.xtra.co.nz)
[20:04:19] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.5.1)
[20:04:29] *** Joins: pcwalton (pcwalton@moz-l8ebtf.sfo1.mozilla.com)
[20:04:29] *** ChanServ sets mode: +o pcwalton
[20:16:25] *** Joins: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com)
[20:19:03] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[20:23:42] *** Quits: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com) (Quit: computer sleep)
[20:25:37] *** Joins: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com)
[20:27:31] *** Joins: mccr8_ (mccr8@moz-l8ebtf.sfo1.mozilla.com)
[20:29:44] *** Quits: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[20:33:13] *** Quits: mccr8_ (mccr8@moz-l8ebtf.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[20:33:26] *** Joins: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com)
[20:34:22] *** Joins: Luqman (laden@moz-bjmiqc.csclub.uwaterloo.ca)
[20:35:49] *** Joins: gal (gal@moz-cfhap5.mtv2.mozilla.com)
[20:36:35] *** Quits: gal (gal@moz-cfhap5.mtv2.mozilla.com) (Connection closed)
[20:36:36] *** Joins: gal (gal@moz-60lve8.ujol.1ibb.0101.2620.IP)
[20:56:08] *** Quits: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com) (Ping timeout: 121 seconds)
[20:56:36] *** Joins: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com)
[20:59:56] *** Quits: gal (gal@moz-60lve8.ujol.1ibb.0101.2620.IP) (Client exited)
[21:00:34] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.5.1)
[21:01:25] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[21:05:11] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.5.1)
[21:06:16] *** Joins: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net)
[21:19:56] *** Joins: ddamjano (Instantbird@moz-ngsmqq.ehig.7h68.8388.2a02.IP)
[21:23:58] *** Quits: ddamjano (Instantbird@moz-ngsmqq.ehig.7h68.8388.2a02.IP) (Ping timeout: 121 seconds)
[21:26:23] *** Joins: ddamjano (Instantbird@moz-ngsmqq.ehig.7h68.8388.2a02.IP)
[21:35:58] *** Quits: roc (chatzilla@moz-hf0khg.orcon.net.nz) (Connection closed)
[21:37:17] *** Joins: _6a68 (sid57626@moz-hvjuan.ealing.irccloud.com)
[22:06:09] *** Quits: ddamjano (Instantbird@moz-ngsmqq.ehig.7h68.8388.2a02.IP) (Ping timeout: 121 seconds)
[22:09:09] *** Quits: pnkfelix (pnkfelix@moz-eljppb.fbx.proxad.net) (Quit: rcirc on GNU Emacs 24.5.1)
[22:20:29] *** Quits: mbx (textual@moz-l8ebtf.sfo1.mozilla.com) (Quit: My Mac has gone to sleep. ZZZzzz…)
[22:26:15] *** Joins: roc (chatzilla@moz-h8ll9b.dqqd.b0fh.0cb0.2001.IP)
[22:26:35] *** Joins: mbx (textual@moz-l8ebtf.sfo1.mozilla.com)
[22:53:31] *** Joins: gal (gal@moz-cqlp3g.ujol.1ibb.0101.2620.IP)
[23:02:47] *** Quits: gal (gal@moz-cqlp3g.ujol.1ibb.0101.2620.IP) (Client exited)
[23:30:15] *** Quits: jweathersby (Adium@moz-a67gsb.ip.windstream.net) (Quit: Leaving.)
[23:31:38] *** Quits: ehsan (ehsan@moz-kl4u98.ckpj.s0pt.0450.2001.IP) (Quit: vanished into thin air...)
[23:36:02] *** Quits: mccr8 (mccr8@moz-u3dg2t.sfo1.mozilla.com) (Quit: computer sleep)
[23:36:06] *** Quits: roc (chatzilla@moz-h8ll9b.dqqd.b0fh.0cb0.2001.IP) (Connection closed)
